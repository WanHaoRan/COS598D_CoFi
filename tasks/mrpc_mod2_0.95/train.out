Sun Apr 28 22:20:16 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/mrpc_mod2_0.95
nvidia-smi output:
Sun Apr 28 22:20:16 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:17:00.0 Off |                    0 |
| N/A   34C    P0              35W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/28/2024 22:20:20 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/28/2024 22:20:20 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/runs/Apr28_22-20-20_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/28/2024 22:20:20 - INFO - __main__ - Model Arguments:
04/28/2024 22:20:20 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/28/2024 22:20:20 - INFO - __main__ - config_name = None
04/28/2024 22:20:20 - INFO - __main__ - tokenizer_name = None
04/28/2024 22:20:20 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/28/2024 22:20:20 - INFO - __main__ - use_fast_tokenizer = True
04/28/2024 22:20:20 - INFO - __main__ - model_revision = main
04/28/2024 22:20:20 - INFO - __main__ - use_auth_token = False
04/28/2024 22:20:20 - INFO - __main__ - Data Arguments:
04/28/2024 22:20:20 - INFO - __main__ - task_name = mrpc
04/28/2024 22:20:20 - INFO - __main__ - dataset_name = None
04/28/2024 22:20:20 - INFO - __main__ - t_name = None
04/28/2024 22:20:20 - INFO - __main__ - dataset_config_name = None
04/28/2024 22:20:20 - INFO - __main__ - max_seq_length = 128
04/28/2024 22:20:20 - INFO - __main__ - overwrite_cache = False
04/28/2024 22:20:20 - INFO - __main__ - pad_to_max_length = True
04/28/2024 22:20:20 - INFO - __main__ - max_train_samples = None
04/28/2024 22:20:20 - INFO - __main__ - max_eval_samples = None
04/28/2024 22:20:20 - INFO - __main__ - max_predict_samples = None
04/28/2024 22:20:20 - INFO - __main__ - train_file = None
04/28/2024 22:20:20 - INFO - __main__ - validation_file = None
04/28/2024 22:20:20 - INFO - __main__ - test_file = None
04/28/2024 22:20:20 - INFO - __main__ - Training Arguments:
04/28/2024 22:20:20 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95
04/28/2024 22:20:20 - INFO - __main__ - overwrite_output_dir = True
04/28/2024 22:20:20 - INFO - __main__ - do_train = True
04/28/2024 22:20:20 - INFO - __main__ - do_eval = True
04/28/2024 22:20:20 - INFO - __main__ - do_predict = False
04/28/2024 22:20:20 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/28/2024 22:20:20 - INFO - __main__ - prediction_loss_only = False
04/28/2024 22:20:20 - INFO - __main__ - per_device_train_batch_size = 32
04/28/2024 22:20:20 - INFO - __main__ - per_device_eval_batch_size = 32
04/28/2024 22:20:20 - INFO - __main__ - per_gpu_train_batch_size = None
04/28/2024 22:20:20 - INFO - __main__ - per_gpu_eval_batch_size = None
04/28/2024 22:20:20 - INFO - __main__ - gradient_accumulation_steps = 1
04/28/2024 22:20:20 - INFO - __main__ - eval_accumulation_steps = None
04/28/2024 22:20:20 - INFO - __main__ - learning_rate = 2e-05
04/28/2024 22:20:20 - INFO - __main__ - weight_decay = 0.0
04/28/2024 22:20:20 - INFO - __main__ - adam_beta1 = 0.9
04/28/2024 22:20:20 - INFO - __main__ - adam_beta2 = 0.999
04/28/2024 22:20:20 - INFO - __main__ - adam_epsilon = 1e-08
04/28/2024 22:20:20 - INFO - __main__ - max_grad_norm = 1.0
04/28/2024 22:20:20 - INFO - __main__ - num_train_epochs = 100.0
04/28/2024 22:20:20 - INFO - __main__ - max_steps = -1
04/28/2024 22:20:20 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/28/2024 22:20:20 - INFO - __main__ - warmup_ratio = 0.0
04/28/2024 22:20:20 - INFO - __main__ - warmup_steps = 0
04/28/2024 22:20:20 - INFO - __main__ - log_level = -1
04/28/2024 22:20:20 - INFO - __main__ - log_level_replica = -1
04/28/2024 22:20:20 - INFO - __main__ - log_on_each_node = True
04/28/2024 22:20:20 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/runs/Apr28_22-20-20_adroit-h11g2
04/28/2024 22:20:20 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/28/2024 22:20:20 - INFO - __main__ - logging_first_step = False
04/28/2024 22:20:20 - INFO - __main__ - logging_steps = 100
04/28/2024 22:20:20 - INFO - __main__ - logging_nan_inf_filter = True
04/28/2024 22:20:20 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/28/2024 22:20:20 - INFO - __main__ - save_steps = 0
04/28/2024 22:20:20 - INFO - __main__ - save_total_limit = None
04/28/2024 22:20:20 - INFO - __main__ - save_on_each_node = False
04/28/2024 22:20:20 - INFO - __main__ - no_cuda = False
04/28/2024 22:20:20 - INFO - __main__ - seed = 57
04/28/2024 22:20:20 - INFO - __main__ - bf16 = False
04/28/2024 22:20:20 - INFO - __main__ - fp16 = False
04/28/2024 22:20:20 - INFO - __main__ - fp16_opt_level = O1
04/28/2024 22:20:20 - INFO - __main__ - half_precision_backend = auto
04/28/2024 22:20:20 - INFO - __main__ - bf16_full_eval = False
04/28/2024 22:20:20 - INFO - __main__ - fp16_full_eval = False
04/28/2024 22:20:20 - INFO - __main__ - tf32 = None
04/28/2024 22:20:20 - INFO - __main__ - local_rank = -1
04/28/2024 22:20:20 - INFO - __main__ - xpu_backend = None
04/28/2024 22:20:20 - INFO - __main__ - tpu_num_cores = None
04/28/2024 22:20:20 - INFO - __main__ - tpu_metrics_debug = False
04/28/2024 22:20:20 - INFO - __main__ - debug = []
04/28/2024 22:20:20 - INFO - __main__ - dataloader_drop_last = False
04/28/2024 22:20:20 - INFO - __main__ - eval_steps = 50
04/28/2024 22:20:20 - INFO - __main__ - dataloader_num_workers = 0
04/28/2024 22:20:20 - INFO - __main__ - past_index = -1
04/28/2024 22:20:20 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95
04/28/2024 22:20:20 - INFO - __main__ - disable_tqdm = False
04/28/2024 22:20:20 - INFO - __main__ - remove_unused_columns = True
04/28/2024 22:20:20 - INFO - __main__ - label_names = None
04/28/2024 22:20:20 - INFO - __main__ - load_best_model_at_end = False
04/28/2024 22:20:20 - INFO - __main__ - metric_for_best_model = None
04/28/2024 22:20:20 - INFO - __main__ - greater_is_better = None
04/28/2024 22:20:20 - INFO - __main__ - ignore_data_skip = False
04/28/2024 22:20:20 - INFO - __main__ - sharded_ddp = []
04/28/2024 22:20:20 - INFO - __main__ - deepspeed = None
04/28/2024 22:20:20 - INFO - __main__ - label_smoothing_factor = 0.0
04/28/2024 22:20:20 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/28/2024 22:20:20 - INFO - __main__ - adafactor = False
04/28/2024 22:20:20 - INFO - __main__ - group_by_length = False
04/28/2024 22:20:20 - INFO - __main__ - length_column_name = length
04/28/2024 22:20:20 - INFO - __main__ - report_to = []
04/28/2024 22:20:20 - INFO - __main__ - ddp_find_unused_parameters = None
04/28/2024 22:20:20 - INFO - __main__ - ddp_bucket_cap_mb = None
04/28/2024 22:20:20 - INFO - __main__ - dataloader_pin_memory = True
04/28/2024 22:20:20 - INFO - __main__ - skip_memory_metrics = True
04/28/2024 22:20:20 - INFO - __main__ - use_legacy_prediction_loop = False
04/28/2024 22:20:20 - INFO - __main__ - push_to_hub = False
04/28/2024 22:20:20 - INFO - __main__ - resume_from_checkpoint = None
04/28/2024 22:20:20 - INFO - __main__ - hub_model_id = None
04/28/2024 22:20:20 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/28/2024 22:20:20 - INFO - __main__ - hub_token = None
04/28/2024 22:20:20 - INFO - __main__ - gradient_checkpointing = False
04/28/2024 22:20:20 - INFO - __main__ - fp16_backend = auto
04/28/2024 22:20:20 - INFO - __main__ - push_to_hub_model_id = None
04/28/2024 22:20:20 - INFO - __main__ - push_to_hub_organization = None
04/28/2024 22:20:20 - INFO - __main__ - push_to_hub_token = None
04/28/2024 22:20:20 - INFO - __main__ - mp_parameters = 
04/28/2024 22:20:20 - INFO - __main__ - _n_gpu = 1
04/28/2024 22:20:20 - INFO - __main__ - __cached__setup_devices = cuda:0
04/28/2024 22:20:20 - INFO - __main__ - Additional Arguments:
04/28/2024 22:20:20 - INFO - __main__ - test = False
04/28/2024 22:20:20 - INFO - __main__ - ex_name = MRPC_sparsity0.95
04/28/2024 22:20:20 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/28/2024 22:20:20 - INFO - __main__ - reg_learning_rate = 0.01
04/28/2024 22:20:20 - INFO - __main__ - scheduler_type = linear
04/28/2024 22:20:20 - INFO - __main__ - freeze_embeddings = True
04/28/2024 22:20:20 - INFO - __main__ - pretrained_pruned_model = None
04/28/2024 22:20:20 - INFO - __main__ - droprate_init = 0.5
04/28/2024 22:20:20 - INFO - __main__ - temperature = 0.6666666666666666
04/28/2024 22:20:20 - INFO - __main__ - prepruning_finetune_epochs = 4
04/28/2024 22:20:20 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/28/2024 22:20:20 - INFO - __main__ - target_sparsity = 0.95
04/28/2024 22:20:20 - INFO - __main__ - sparsity_epsilon = 0
04/28/2024 22:20:20 - INFO - __main__ - distillation_path = Intel/bert-base-uncased-mrpc
04/28/2024 22:20:20 - INFO - __main__ - do_distill = True
04/28/2024 22:20:20 - INFO - __main__ - do_layer_distill = True
04/28/2024 22:20:20 - INFO - __main__ - layer_distill_version = 4
04/28/2024 22:20:20 - INFO - __main__ - distill_loss_alpha = 0.9
04/28/2024 22:20:20 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/28/2024 22:20:20 - INFO - __main__ - distill_temp = 2.0
04/28/2024 22:20:20 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/28/2024 22:20:20 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/28/2024 22:20:20 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/28/2024 22:20:20 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 711.22it/s]
[INFO|configuration_utils.py:648] 2024-04-28 22:20:20,862 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-28 22:20:20,862 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "mrpc",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-28 22:20:20,865 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-28 22:20:20,865 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-28 22:20:20,869 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-28 22:20:20,869 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-28 22:20:20,869 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-28 22:20:20,869 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-28 22:20:20,872 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-28 22:20:20,873 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/28/2024 22:20:29 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/28/2024 22:20:29 - INFO - __main__ - Model size: 85054464
04/28/2024 22:20:29 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14eeb009f550> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/28/2024 22:20:29 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/28/2024 22:20:29 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14eeb009f040> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/28/2024 22:20:29 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/28/2024 22:20:29 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14eeb009f550> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/28/2024 22:20:29 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/28/2024 22:20:29 - INFO - __main__ - Sample 2105 of the training set: {'sentence1': 'The Communicator can also consolidate e-mail from multiple screen names and other POP and IMAP accounts into a single application .', 'sentence2': 'AOL Communicator can consolidate e-mail from multiple AOL screen names , as well as from other POP and IMAP-based e-mail accounts .', 'label': 1, 'idx': 2338, 'input_ids': [101, 1996, 4012, 23041, 5555, 4263, 2064, 2036, 24939, 1041, 1011, 5653, 2013, 3674, 3898, 3415, 1998, 2060, 3769, 1998, 10047, 9331, 6115, 2046, 1037, 2309, 4646, 1012, 102, 20118, 2140, 4012, 23041, 5555, 4263, 2064, 24939, 1041, 1011, 5653, 2013, 3674, 20118, 2140, 3898, 3415, 1010, 2004, 2092, 2004, 2013, 2060, 3769, 1998, 10047, 9331, 1011, 2241, 1041, 1011, 5653, 6115, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/28/2024 22:20:29 - INFO - __main__ - Sample 1315 of the training set: {'sentence1': 'The dollar gained against the euro , yen and Swiss franc after September U.S. retail sales figures came in slightly weaker than consensus forecasts .', 'sentence2': 'The greenback rose steeply against the euro , yen and Swiss franc despite weaker-than-expected September U.S. retail sales figures .', 'label': 1, 'idx': 1465, 'input_ids': [101, 1996, 7922, 4227, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2044, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 2234, 1999, 3621, 15863, 2084, 10465, 19939, 2015, 1012, 102, 1996, 2665, 5963, 3123, 9561, 2135, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2750, 15863, 1011, 2084, 1011, 3517, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/28/2024 22:20:29 - INFO - __main__ - Sample 1955 of the training set: {'sentence1': "But he said he had Dr Hollingworth 's legal advice that he had been denied natural justice by the church inquiry .", 'sentence2': "Senator Brandis backed Dr Hollingworth 's claims he had been denied natural justice by the Anglican Church inquiry into the claims against him .", 'label': 0, 'idx': 2170, 'input_ids': [101, 2021, 2002, 2056, 2002, 2018, 2852, 7570, 13112, 5172, 1005, 1055, 3423, 6040, 2008, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 2277, 9934, 1012, 102, 5205, 4435, 2483, 6153, 2852, 7570, 13112, 5172, 1005, 1055, 4447, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 9437, 2277, 9934, 2046, 1996, 4447, 2114, 2032, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/28/2024 22:20:29 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/28/2024 22:20:30 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/28/2024 22:20:30 - INFO - __main__ - ************* 3668 Training Examples Loaded *************
04/28/2024 22:20:30 - INFO - __main__ - ************* 408 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-28 22:20:30,509 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 - Prepruning finetune steps: 100
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 - Lagrangian warmup steps: 2300
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 - ***** Running training *****
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 -   Num examples = 3668
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 -   Num Epochs = 100
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 -   Instantaneous batch size per device = 32
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 -   Gradient Accumulation steps = 1
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 -   Total optimization steps = 11500
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-28 22:20:30,514 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:20:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32

Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A
Evaluation:   8%|▊         | 1/13 [00:00<00:01,  6.32it/s][A
Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  8.96it/s][A
Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A
Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.05it/s][A
Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.23it/s][A
Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.34it/s][A
Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.87it/s][AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.22it/s]04/28/2024 22:20:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:20:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.3161764705882353, 'f1': 0.0, 'combined_score': 0.15808823529411764, 'eval_loss': 0.7583998, 'step': 0}


Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 22:20:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:39,  2.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.42it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:31,  3.52it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:31,  3.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:31,  3.54it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:30,  3.62it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:29,  3.69it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:27,  3.85it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:27,  3.84it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:27,  3.77it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:27,  3.79it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:27,  3.72it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:27,  3.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:25,  3.90it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:27,  3.66it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:27,  3.60it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.46it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:26,  3.58it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:26,  3.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:24,  3.75it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:24,  3.78it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.62it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.68it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:24,  3.67it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:23,  3.67it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:23,  3.75it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:22,  3.80it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:21,  3.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.08it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:21,  3.90it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:21,  3.87it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:20,  3.90it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:21,  3.75it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.89it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:20,  3.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:20,  3.74it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:20,  3.80it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:19,  3.84it/s][A
Iteration:  36%|███▌      | 41/115 [00:11<00:18,  3.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:18,  3.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:18,  3.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:18,  3.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:12<00:18,  3.89it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:17,  3.87it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:18,  3.77it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:17,  3.82it/s][A
Iteration:  43%|████▎     | 49/115 [00:13<00:18,  3.66it/s][A[INFO|trainer.py:570] 2024-04-28 22:20:45,228 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:20:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:20:45 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:20:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.60it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.60it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.58it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.49it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.53it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.76it/s]04/28/2024 22:20:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:20:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8482871125611746, 'combined_score': 0.8101729680452932, 'eval_loss': 0.47348246, 'step': 50}


Iteration:  43%|████▎     | 50/115 [00:14<00:41,  1.56it/s][A
Iteration:  44%|████▍     | 51/115 [00:14<00:33,  1.90it/s][A
Iteration:  45%|████▌     | 52/115 [00:15<00:27,  2.28it/s][A
Iteration:  46%|████▌     | 53/115 [00:15<00:24,  2.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:15<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:15<00:19,  3.06it/s][A
Iteration:  49%|████▊     | 56/115 [00:16<00:18,  3.25it/s][A
Iteration:  50%|████▉     | 57/115 [00:16<00:17,  3.40it/s][A
Iteration:  50%|█████     | 58/115 [00:16<00:16,  3.49it/s][A
Iteration:  51%|█████▏    | 59/115 [00:17<00:16,  3.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:17<00:15,  3.52it/s][A
Iteration:  53%|█████▎    | 61/115 [00:17<00:15,  3.58it/s][A
Iteration:  54%|█████▍    | 62/115 [00:17<00:15,  3.40it/s][A
Iteration:  55%|█████▍    | 63/115 [00:18<00:14,  3.52it/s][A
Iteration:  56%|█████▌    | 64/115 [00:18<00:14,  3.62it/s][A
Iteration:  57%|█████▋    | 65/115 [00:18<00:13,  3.68it/s][A
Iteration:  57%|█████▋    | 66/115 [00:18<00:13,  3.72it/s][A
Iteration:  58%|█████▊    | 67/115 [00:19<00:12,  3.71it/s][A
Iteration:  59%|█████▉    | 68/115 [00:19<00:12,  3.74it/s][A
Iteration:  60%|██████    | 69/115 [00:19<00:12,  3.79it/s][A
Iteration:  61%|██████    | 70/115 [00:20<00:12,  3.74it/s][A
Iteration:  62%|██████▏   | 71/115 [00:20<00:11,  3.74it/s][A
Iteration:  63%|██████▎   | 72/115 [00:20<00:11,  3.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:20<00:10,  3.83it/s][A
Iteration:  64%|██████▍   | 74/115 [00:21<00:10,  3.85it/s][A
Iteration:  65%|██████▌   | 75/115 [00:21<00:10,  3.87it/s][A
Iteration:  66%|██████▌   | 76/115 [00:21<00:10,  3.80it/s][A
Iteration:  67%|██████▋   | 77/115 [00:21<00:10,  3.75it/s][A
Iteration:  68%|██████▊   | 78/115 [00:22<00:09,  3.76it/s][A
Iteration:  69%|██████▊   | 79/115 [00:22<00:09,  3.75it/s][A
Iteration:  70%|██████▉   | 80/115 [00:22<00:09,  3.74it/s][A
Iteration:  70%|███████   | 81/115 [00:22<00:08,  3.80it/s][A
Iteration:  71%|███████▏  | 82/115 [00:23<00:08,  3.79it/s][A
Iteration:  72%|███████▏  | 83/115 [00:23<00:08,  3.83it/s][A
Iteration:  73%|███████▎  | 84/115 [00:23<00:08,  3.80it/s][A
Iteration:  74%|███████▍  | 85/115 [00:23<00:07,  3.75it/s][A
Iteration:  75%|███████▍  | 86/115 [00:24<00:07,  3.69it/s][A
Iteration:  76%|███████▌  | 87/115 [00:24<00:07,  3.72it/s][A
Iteration:  77%|███████▋  | 88/115 [00:24<00:06,  3.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:25<00:06,  3.86it/s][A
Iteration:  78%|███████▊  | 90/115 [00:25<00:06,  3.82it/s][A
Iteration:  79%|███████▉  | 91/115 [00:25<00:06,  3.84it/s][A
Iteration:  80%|████████  | 92/115 [00:25<00:05,  3.86it/s][A
Iteration:  81%|████████  | 93/115 [00:26<00:05,  3.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:26<00:05,  3.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:26<00:05,  3.80it/s][A
Iteration:  83%|████████▎ | 96/115 [00:26<00:04,  3.83it/s][A
Iteration:  84%|████████▍ | 97/115 [00:27<00:04,  3.71it/s][A
Iteration:  85%|████████▌ | 98/115 [00:27<00:04,  3.70it/s][A
Iteration:  86%|████████▌ | 99/115 [00:27<00:04,  3.68it/s][A[INFO|trainer.py:570] 2024-04-28 22:20:59,768 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:20:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:20:59 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:20:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.76it/s]04/28/2024 22:21:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:21:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8831168831168831, 'combined_score': 0.8533231474407945, 'eval_loss': 0.50392485, 'step': 100}


Iteration:  87%|████████▋ | 100/115 [00:29<00:09,  1.56it/s][A04/28/2024 22:21:00 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/28/2024 22:21:00 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/28/2024 22:21:00 - INFO - trainer.trainer_mod_2 - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/28/2024 22:21:00 - INFO - trainer.trainer_mod_2 - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/28/2024 22:21:00 - INFO - trainer.trainer_mod_2 - Starting l0 regularization!
04/28/2024 22:21:01 - INFO - trainer.trainer_mod_2 - v4 Global step: 100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:29<00:07,  1.79it/s][A
Iteration:  89%|████████▊ | 102/115 [00:29<00:06,  1.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:30<00:05,  2.18it/s][A
Iteration:  90%|█████████ | 104/115 [00:30<00:04,  2.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:31<00:04,  2.45it/s][A
Iteration:  92%|█████████▏| 106/115 [00:31<00:03,  2.63it/s][A
Iteration:  93%|█████████▎| 107/115 [00:31<00:02,  2.69it/s][A
Iteration:  94%|█████████▍| 108/115 [00:32<00:02,  2.73it/s][A
Iteration:  95%|█████████▍| 109/115 [00:32<00:02,  2.80it/s][A
Iteration:  96%|█████████▌| 110/115 [00:32<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:33<00:01,  2.83it/s][A
Iteration:  97%|█████████▋| 112/115 [00:33<00:01,  2.68it/s][A
Iteration:  98%|█████████▊| 113/115 [00:33<00:00,  2.74it/s][A
Iteration:  99%|█████████▉| 114/115 [00:34<00:00,  2.84it/s][A
Iteration: 100%|██████████| 115/115 [00:34<00:00,  3.05it/s][A04/28/2024 22:21:06 - INFO - trainer.trainer_mod_2 - Epoch 0 finished. Took 34.43 seconds.
Iteration: 100%|██████████| 115/115 [00:34<00:00,  3.34it/s]
Epoch:   1%|          | 1/100 [00:35<58:56, 35.73s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.13it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.78it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.87it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.90it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.87it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.85it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.77it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.77it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.78it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.87it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.76it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.75it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.79it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.92it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:34,  2.80it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.84it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.82it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.84it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.88it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.89it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.88it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.88it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.86it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.88it/s][A[INFO|trainer.py:570] 2024-04-28 22:21:18,462 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:21:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:21:18 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:21:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:21:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.50it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 22:21:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:21:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8205882352941176, 'combined_score': 0.7607843137254902, 'eval_loss': 1.3516858, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2613, 2604, 2604, 2597, 2596, 2601, 2591, 2589, 2588, 2587, 2588, 2593], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9056444, 'remaining_params': 75961156, 'pruned_model_sparsity': 0.10652434319482083, 'expected_sparsity': 0.1081, 'target_sparsity': 0.020652173913043477, 'step': 150}


Iteration:  30%|███       | 35/115 [00:13<01:01,  1.30it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:50,  1.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:43,  1.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:38,  2.01it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:34,  2.22it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:31,  2.36it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:29,  2.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:28,  2.57it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:27,  2.65it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:26,  2.71it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:25,  2.71it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.82it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.83it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.85it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.88it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.94it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.92it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.91it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.88it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.81it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.83it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.68it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.75it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.80it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.91it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.87it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.88it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.93it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.94it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.90it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  2.88it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.89it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.95it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.89it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.88it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.89it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.72it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.74it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:12,  2.61it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:11,  2.68it/s][A[INFO|trainer.py:570] 2024-04-28 22:21:37,450 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:21:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:21:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:21:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:21:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 22:21:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:21:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7524509803921569, 'f1': 0.8007889546351084, 'combined_score': 0.7766199675136326, 'eval_loss': 0.5154577, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2645, 2635, 2632, 2619, 2620, 2629, 2616, 2613, 2616, 2623, 2634, 2656], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8463560, 'remaining_params': 76554040, 'pruned_model_sparsity': 0.0995506812707016, 'expected_sparsity': 0.10115, 'target_sparsity': 0.041304347826086954, 'step': 200}


Iteration:  74%|███████▍  | 85/115 [00:32<00:23,  1.26it/s][A04/28/2024 22:21:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:32<00:19,  1.50it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:15,  1.76it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:13,  2.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:11,  2.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:10,  2.40it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:09,  2.54it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.59it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:08,  2.68it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:08,  2.61it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.66it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:07,  2.66it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.74it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.81it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.82it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.91it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.91it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.86it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.82it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.82it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.85it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.82it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.81it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.85it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.88it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.85it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.09it/s][A04/28/2024 22:21:49 - INFO - trainer.trainer_mod_2 - Epoch 1 finished. Took 43.04 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:   2%|▏         | 2/100 [01:18<1:05:23, 40.03s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.89it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.92it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.86it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:40,  2.68it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.74it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.73it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.74it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:37,  2.77it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.79it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.88it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.89it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.98it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.88it/s][A[INFO|trainer.py:570] 2024-04-28 22:21:56,333 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:21:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:21:56 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:21:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:21:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.49it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 22:21:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:21:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7622549019607843, 'f1': 0.8116504854368932, 'combined_score': 0.7869526936988387, 'eval_loss': 0.5284502, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2672, 2660, 2658, 2643, 2645, 2658, 2643, 2640, 2650, 2665, 2685, 2719], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7850760, 'remaining_params': 77166840, 'pruned_model_sparsity': 0.09234276196928635, 'expected_sparsity': 0.09391, 'target_sparsity': 0.06195652173913043, 'step': 250}


Iteration:  17%|█▋        | 20/115 [00:08<01:13,  1.29it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<01:02,  1.52it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:52,  1.77it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:45,  2.04it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:40,  2.23it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:37,  2.39it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:37,  2.39it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:34,  2.58it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:33,  2.63it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:31,  2.70it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:30,  2.78it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.80it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.80it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:28,  2.85it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.88it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.95it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.92it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.88it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.90it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.88it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:23,  2.94it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.92it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:24,  2.70it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.76it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.86it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.83it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.85it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.82it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.85it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.83it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.71it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.73it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:20,  2.76it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.81it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.83it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.87it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.83it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.85it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.83it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.88it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.85it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.81it/s][A[INFO|trainer.py:570] 2024-04-28 22:22:15,290 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:22:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:22:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:22:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:22:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.36it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.40it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.44it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.48it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.66it/s]04/28/2024 22:22:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:22:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.41911764705882354, 'f1': 0.27076923076923076, 'combined_score': 0.3449434389140271, 'eval_loss': 1.4207112, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2694, 2682, 2681, 2663, 2667, 2682, 2666, 2666, 2679, 2701, 2727, 2770], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7329880, 'remaining_params': 77687720, 'pruned_model_sparsity': 0.08621603056308341, 'expected_sparsity': 0.08783, 'target_sparsity': 0.08260869565217391, 'step': 300}


Iteration:  61%|██████    | 70/115 [00:27<00:35,  1.28it/s][A04/28/2024 22:22:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:27<00:28,  1.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:24,  1.72it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:21,  1.99it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:18,  2.18it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:17,  2.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:15,  2.48it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:14,  2.61it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:13,  2.71it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:13,  2.75it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.79it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.83it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.90it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.86it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.85it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.84it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.81it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.85it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.87it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.85it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.76it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.74it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.80it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.80it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.84it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.74it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.84it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.85it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.81it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.85it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.93it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.88it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.86it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.89it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.90it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  3.03it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.22it/s][A04/28/2024 22:22:32 - INFO - trainer.trainer_mod_2 - Epoch 2 finished. Took 43.04 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:   3%|▎         | 3/100 [02:01<1:06:56, 41.40s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 22:22:34,066 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:22:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:22:34 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:22:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:22:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 22:22:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:22:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.7397849462365591, 'combined_score': 0.7216081593927894, 'eval_loss': 0.6108272, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2713, 2702, 2701, 2682, 2686, 2703, 2687, 2685, 2704, 2731, 2760, 2809], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6893260, 'remaining_params': 78124340, 'pruned_model_sparsity': 0.08108038806082506, 'expected_sparsity': 0.08269, 'target_sparsity': 0.10326086956521738, 'step': 350}


Iteration:   4%|▍         | 5/115 [00:03<01:35,  1.16it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:14,  1.47it/s][A
Iteration:   6%|▌         | 7/115 [00:03<01:01,  1.75it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:53,  2.01it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:46,  2.26it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:43,  2.39it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:41,  2.52it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:39,  2.61it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.84it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.87it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.90it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:35,  2.72it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:35,  2.70it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:34,  2.71it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:33,  2.79it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.88it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.86it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:30,  2.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:29,  2.90it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.88it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.83it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:27,  2.94it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.95it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.85it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.83it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.84it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.81it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:27,  2.72it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:26,  2.73it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.78it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:25,  2.82it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.83it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.85it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.86it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.87it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.84it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:23,  2.74it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.76it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.82it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.81it/s][A[INFO|trainer.py:570] 2024-04-28 22:22:53,028 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:22:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:22:53 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:22:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:22:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/28/2024 22:22:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:22:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6715686274509803, 'f1': 0.6954545454545454, 'combined_score': 0.6835115864527629, 'eval_loss': 0.6840563, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2729, 2718, 2717, 2699, 2703, 2721, 2703, 2702, 2725, 2754, 2785, 2837], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6540900, 'remaining_params': 78476700, 'pruned_model_sparsity': 0.07693583446251129, 'expected_sparsity': 0.07858, 'target_sparsity': 0.12391304347826086, 'step': 400}


Iteration:  48%|████▊     | 55/115 [00:22<00:47,  1.26it/s][A04/28/2024 22:22:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:22<00:38,  1.54it/s][A
Iteration:  50%|████▉     | 57/115 [00:22<00:32,  1.78it/s][A
Iteration:  50%|█████     | 58/115 [00:23<00:28,  2.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:23<00:25,  2.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:23<00:22,  2.41it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:21,  2.54it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:20,  2.60it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:19,  2.66it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:18,  2.79it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:17,  2.79it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:17,  2.76it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:17,  2.82it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:16,  2.81it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:16,  2.85it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:15,  2.83it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.73it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.80it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.79it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:14,  2.65it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.72it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:13,  2.78it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.82it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:12,  2.91it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.84it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.92it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.89it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.89it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.85it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.86it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.93it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:07,  2.93it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.93it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  2.93it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.81it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.81it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.85it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.84it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.83it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.86it/s][A[INFO|trainer.py:570] 2024-04-28 22:23:11,874 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:23:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:23:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:23:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:23:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 22:23:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:23:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8516579406631763, 'combined_score': 0.8216623036649215, 'eval_loss': 0.42180955, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2740, 2729, 2727, 2709, 2713, 2732, 2713, 2713, 2738, 2767, 2799, 2853], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6326420, 'remaining_params': 78691180, 'pruned_model_sparsity': 0.07441306270701596, 'expected_sparsity': 0.07606, 'target_sparsity': 0.14456521739130435, 'step': 450}


Iteration:  91%|█████████▏| 105/115 [00:40<00:07,  1.30it/s][A
Iteration:  92%|█████████▏| 106/115 [00:41<00:05,  1.56it/s][A
Iteration:  93%|█████████▎| 107/115 [00:41<00:04,  1.79it/s][A
Iteration:  94%|█████████▍| 108/115 [00:42<00:03,  2.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:42<00:02,  2.21it/s][A
Iteration:  96%|█████████▌| 110/115 [00:42<00:02,  2.39it/s][A
Iteration:  97%|█████████▋| 111/115 [00:43<00:01,  2.53it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  2.60it/s][A
Iteration:  98%|█████████▊| 113/115 [00:43<00:00,  2.63it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.65it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.91it/s][A04/28/2024 22:23:16 - INFO - trainer.trainer_mod_2 - Epoch 3 finished. Took 44.41 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.59it/s]
Epoch:   4%|▍         | 4/100 [02:46<1:08:08, 42.59s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.80it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.88it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.88it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:38,  2.85it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.86it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.88it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.95it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.87it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.81it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:34,  2.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:34,  2.83it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.85it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.92it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  2.98it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.92it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.88it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:30,  2.78it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:27,  2.86it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.90it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.80it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:27,  2.75it/s][A[INFO|trainer.py:570] 2024-04-28 22:23:30,621 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:23:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:23:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:23:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:23:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 22:23:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:23:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8771929824561404, 'combined_score': 0.8528121775025801, 'eval_loss': 0.44004583, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2745, 2734, 2733, 2713, 2718, 2737, 2717, 2716, 2742, 2769, 2801, 2857], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6251352, 'remaining_params': 78766248, 'pruned_model_sparsity': 0.07353009259259259, 'expected_sparsity': 0.07523, 'target_sparsity': 0.16521739130434782, 'step': 500}


Iteration:  35%|███▍      | 40/115 [00:15<00:58,  1.28it/s][A04/28/2024 22:23:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:15<00:48,  1.54it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:40,  1.79it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:37,  1.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:33,  2.12it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:30,  2.31it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:28,  2.46it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:27,  2.51it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:27,  2.47it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:25,  2.58it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:23,  2.74it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:23,  2.74it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.84it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.84it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.84it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.86it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.84it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.84it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.88it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.86it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.88it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.82it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.84it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.85it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.85it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.86it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.82it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.81it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.85it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.84it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.87it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:13,  2.83it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.84it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.86it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.82it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.84it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.80it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.85it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.83it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.83it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.80it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.79it/s][A[INFO|trainer.py:570] 2024-04-28 22:23:49,646 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:23:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:23:49 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:23:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:23:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 22:23:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:23:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8885077186963979, 'combined_score': 0.8645969966031009, 'eval_loss': 0.55487424, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2743, 2732, 2732, 2710, 2716, 2734, 2712, 2710, 2735, 2757, 2789, 2846], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6352464, 'remaining_params': 78665136, 'pruned_model_sparsity': 0.07471939927732611, 'expected_sparsity': 0.07642, 'target_sparsity': 0.1858695652173913, 'step': 550}


Iteration:  78%|███████▊  | 90/115 [00:34<00:19,  1.29it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:15,  1.54it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:12,  1.82it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:11,  1.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:09,  2.19it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:08,  2.41it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:07,  2.54it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.63it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:06,  2.72it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.78it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.79it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:05,  2.80it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.79it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.89it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.84it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.88it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.86it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.69it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.73it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.68it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.76it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.66it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.93it/s][A04/28/2024 22:23:59 - INFO - trainer.trainer_mod_2 - Epoch 4 finished. Took 43.08 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:   5%|▌         | 5/100 [03:29<1:07:42, 42.77s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:41,  2.70it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:41,  2.72it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:41,  2.70it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.71it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.79it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:40,  2.64it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.72it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.77it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:38,  2.71it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:38,  2.72it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:38,  2.70it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:37,  2.75it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:35,  2.81it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.82it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.83it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.87it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.84it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.83it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.90it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 22:24:08,794 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:24:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:24:08 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:24:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:24:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 22:24:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:24:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8817204301075269, 'combined_score': 0.859977862112587, 'eval_loss': 0.44549572, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2735, 2723, 2727, 2700, 2707, 2725, 2698, 2692, 2714, 2724, 2753, 2811], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6669588, 'remaining_params': 78348012, 'pruned_model_sparsity': 0.07844949751580849, 'expected_sparsity': 0.0803, 'target_sparsity': 0.20652173913043476, 'step': 600}


Iteration:  22%|██▏       | 25/115 [00:10<01:10,  1.28it/s][A04/28/2024 22:24:10 - INFO - trainer.trainer_mod_2 - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<00:58,  1.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<00:50,  1.73it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:44,  1.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:38,  2.21it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:35,  2.41it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:33,  2.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:31,  2.61it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:30,  2.69it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.75it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.76it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.86it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.79it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.84it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.87it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.87it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:24,  2.89it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.87it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.84it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:24,  2.84it/s][A
Iteration:  41%|████      | 47/115 [00:18<00:23,  2.85it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 50/115 [00:19<00:23,  2.79it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:22,  2.83it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:22,  2.79it/s][A
Iteration:  46%|████▌     | 53/115 [00:20<00:22,  2.78it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.83it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:22,  2.70it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.82it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.85it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.86it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.89it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:19,  2.87it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:18,  2.90it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.91it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.83it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.84it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.88it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.81it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.84it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.74it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.80it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.83it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.82it/s][A[INFO|trainer.py:570] 2024-04-28 22:24:27,836 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:24:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:24:27 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:24:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:24:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.50it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 22:24:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:24:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8859060402684563, 'combined_score': 0.8596196868008948, 'eval_loss': 0.5009755, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2717, 2705, 2714, 2682, 2688, 2706, 2670, 2658, 2670, 2650, 2666, 2720], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7378904, 'remaining_params': 77638696, 'pruned_model_sparsity': 0.08679266410719663, 'expected_sparsity': 0.08882, 'target_sparsity': 0.22717391304347825, 'step': 650}


Iteration:  65%|██████▌   | 75/115 [00:29<00:31,  1.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:25,  1.52it/s][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:21,  1.77it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:18,  2.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:16,  2.18it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:14,  2.35it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:13,  2.47it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:12,  2.57it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:12,  2.63it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:11,  2.68it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.73it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:10,  2.74it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:10,  2.77it/s][A
Iteration:  77%|███████▋  | 88/115 [00:34<00:09,  2.78it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.80it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.80it/s][A
Iteration:  79%|███████▉  | 91/115 [00:35<00:08,  2.83it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.86it/s][A
Iteration:  82%|████████▏ | 94/115 [00:36<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.86it/s][A
Iteration:  84%|████████▍ | 97/115 [00:37<00:06,  2.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.86it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:38<00:05,  2.92it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:39<00:04,  2.99it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.90it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:40<00:03,  2.85it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.86it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.86it/s][A
Iteration:  95%|█████████▍| 109/115 [00:41<00:02,  2.85it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 111/115 [00:42<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 112/115 [00:42<00:01,  2.86it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.88it/s][A
Iteration:  99%|█████████▉| 114/115 [00:43<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:43<00:00,  3.13it/s][A04/28/2024 22:24:43 - INFO - trainer.trainer_mod_2 - Epoch 5 finished. Took 43.31 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.66it/s]
Epoch:   6%|▌         | 6/100 [04:12<1:07:17, 42.95s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.10it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.95it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.83it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:39,  2.83it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.87it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.88it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.84it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:38,  2.79it/s][A[INFO|trainer.py:570] 2024-04-28 22:24:46,625 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:24:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:24:46 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:24:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:24:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.51it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.70it/s]04/28/2024 22:24:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:24:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8857142857142857, 'combined_score': 0.8644257703081233, 'eval_loss': 0.6084006, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2687, 2674, 2688, 2650, 2657, 2673, 2624, 2600, 2584, 2492, 2455, 2458], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8917032, 'remaining_params': 76100568, 'pruned_model_sparsity': 0.10488454155374886, 'expected_sparsity': 0.10738, 'target_sparsity': 0.24782608695652172, 'step': 700}


Iteration:   9%|▊         | 10/115 [00:04<01:22,  1.27it/s][A04/28/2024 22:24:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:05<01:08,  1.51it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:58,  1.77it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:51,  1.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:46,  2.19it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:41,  2.41it/s][A
Iteration:  14%|█▍        | 16/115 [00:07<00:39,  2.51it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.61it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.70it/s][A
Iteration:  17%|█▋        | 19/115 [00:08<00:34,  2.78it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.83it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:33,  2.82it/s][A
Iteration:  19%|█▉        | 22/115 [00:09<00:33,  2.80it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.85it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:32,  2.84it/s][A
Iteration:  22%|██▏       | 25/115 [00:10<00:31,  2.84it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:31,  2.85it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.82it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:30,  2.82it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.86it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.86it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:29,  2.86it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.79it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:30,  2.65it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:29,  2.74it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.73it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:27,  2.83it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:27,  2.86it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.85it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:26,  2.87it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.88it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.85it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.89it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:24,  2.90it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.91it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:23,  2.86it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.88it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.87it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.86it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.86it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:20,  2.89it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:21,  2.71it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.77it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:19,  2.83it/s][A[INFO|trainer.py:570] 2024-04-28 22:25:05,586 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:25:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:25:05 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:25:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:25:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.53it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.54it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/28/2024 22:25:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:25:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8731942215088282, 'combined_score': 0.839783385264218, 'eval_loss': 0.92836326, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2643, 2629, 2653, 2604, 2610, 2622, 2552, 2502, 2423, 2165, 2004, 1896], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 11887580, 'remaining_params': 73130020, 'pruned_model_sparsity': 0.13982493036735924, 'expected_sparsity': 0.14433, 'target_sparsity': 0.26847826086956517, 'step': 750}


Iteration:  52%|█████▏    | 60/115 [00:23<00:42,  1.29it/s][A
Iteration:  53%|█████▎    | 61/115 [00:24<00:34,  1.55it/s][A
Iteration:  54%|█████▍    | 62/115 [00:24<00:29,  1.79it/s][A
Iteration:  55%|█████▍    | 63/115 [00:24<00:25,  2.03it/s][A
Iteration:  56%|█████▌    | 64/115 [00:25<00:22,  2.23it/s][A
Iteration:  57%|█████▋    | 65/115 [00:25<00:20,  2.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:25<00:19,  2.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:26<00:18,  2.56it/s][A
Iteration:  59%|█████▉    | 68/115 [00:26<00:17,  2.64it/s][A
Iteration:  60%|██████    | 69/115 [00:27<00:17,  2.68it/s][A
Iteration:  61%|██████    | 70/115 [00:27<00:16,  2.71it/s][A
Iteration:  62%|██████▏   | 71/115 [00:27<00:16,  2.63it/s][A
Iteration:  63%|██████▎   | 72/115 [00:28<00:15,  2.70it/s][A
Iteration:  63%|██████▎   | 73/115 [00:28<00:15,  2.74it/s][A
Iteration:  64%|██████▍   | 74/115 [00:28<00:14,  2.81it/s][A
Iteration:  65%|██████▌   | 75/115 [00:29<00:14,  2.85it/s][A
Iteration:  66%|██████▌   | 76/115 [00:29<00:13,  2.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:29<00:13,  2.87it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:12,  2.91it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:12,  2.90it/s][A
Iteration:  70%|██████▉   | 80/115 [00:30<00:11,  2.92it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:11,  2.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:10,  2.86it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:10,  2.76it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  2.80it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 89/115 [00:34<00:09,  2.84it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:08,  2.79it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:08,  2.84it/s][A
Iteration:  80%|████████  | 92/115 [00:35<00:08,  2.82it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  2.83it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:07,  2.87it/s][A
Iteration:  83%|████████▎ | 95/115 [00:36<00:06,  2.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.93it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:37<00:05,  2.88it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.89it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.89it/s][A
Iteration:  88%|████████▊ | 101/115 [00:38<00:04,  2.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.93it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.78it/s][A
Iteration:  90%|█████████ | 104/115 [00:39<00:03,  2.81it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.91it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:02,  2.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 22:25:24,404 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:25:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:25:24 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:25:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:25:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.50it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.49it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.50it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.50it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.51it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.69it/s]04/28/2024 22:25:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:25:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8865979381443299, 'combined_score': 0.8624166161309885, 'eval_loss': 0.5833188, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2580, 2564, 2603, 2539, 2544, 2553, 2448, 2355, 2170, 1744, 1457, 1293], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 15645576, 'remaining_params': 69372024, 'pruned_model_sparsity': 0.18402749548328817, 'expected_sparsity': 0.19707, 'target_sparsity': 0.2891304347826087, 'step': 800}


Iteration:  96%|█████████▌| 110/115 [00:42<00:03,  1.31it/s][A04/28/2024 22:25:25 - INFO - trainer.trainer_mod_2 - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:43<00:02,  1.56it/s][A
Iteration:  97%|█████████▋| 112/115 [00:43<00:01,  1.81it/s][A
Iteration:  98%|█████████▊| 113/115 [00:43<00:00,  2.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:44<00:00,  2.14it/s][A
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.47it/s][A04/28/2024 22:25:27 - INFO - trainer.trainer_mod_2 - Epoch 6 finished. Took 44.41 seconds.
Iteration: 100%|██████████| 115/115 [00:44<00:00,  2.59it/s]
Epoch:   7%|▋         | 7/100 [04:57<1:07:18, 43.43s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.90it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.82it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.85it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:40,  2.70it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:39,  2.76it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.83it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:39,  2.72it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:39,  2.65it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:38,  2.70it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:37,  2.75it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:37,  2.78it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.81it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:35,  2.82it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.79it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.83it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.94it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.97it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.94it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.95it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.92it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.79it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:29,  2.80it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:28,  2.87it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:28,  2.85it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.88it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.86it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.93it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.92it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.95it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:25,  2.81it/s][A[INFO|trainer.py:570] 2024-04-28 22:25:43,204 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:25:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:25:43 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:25:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:25:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.55it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.74it/s]04/28/2024 22:25:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:25:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8504901960784313, 'f1': 0.8912655971479501, 'combined_score': 0.8708778966131907, 'eval_loss': 0.5162267, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2497, 2481, 2540, 2459, 2461, 2462, 2314, 2162, 1884, 1461, 1037, 902], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11], 'pruned_params': 21435004, 'remaining_params': 63582596, 'pruned_model_sparsity': 0.2521243130834086, 'expected_sparsity': 0.25128, 'target_sparsity': 0.30978260869565216, 'step': 850}


Iteration:  39%|███▉      | 45/115 [00:17<00:53,  1.31it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:44,  1.56it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:37,  1.81it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:32,  2.04it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:28,  2.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.45it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:24,  2.61it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:24,  2.62it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:22,  2.76it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:21,  2.81it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:21,  2.81it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.85it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:20,  2.89it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:18,  2.90it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.86it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:19,  2.73it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:18,  2.77it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.79it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:17,  2.79it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:17,  2.81it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.77it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.76it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:16,  2.81it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.81it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.79it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.82it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.90it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.97it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.92it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.93it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.87it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.88it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.91it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.90it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.89it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.76it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:09,  2.78it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.84it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.81it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.84it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 22:26:02,018 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:26:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:26:02 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:26:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:26:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.58it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.58it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.76it/s]04/28/2024 22:26:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:26:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8877887788778879, 'combined_score': 0.8605610561056106, 'eval_loss': 0.69826746, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2398, 2380, 2465, 2366, 2364, 2356, 2163, 1957, 1643, 1340, 767, 719], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 12, 12, 10], 'pruned_params': 25412076, 'remaining_params': 59605524, 'pruned_model_sparsity': 0.2989037093495935, 'expected_sparsity': 0.29366, 'target_sparsity': 0.33043478260869563, 'step': 900}


Iteration:  83%|████████▎ | 95/115 [00:35<00:15,  1.31it/s][A04/28/2024 22:26:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 900, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:36<00:12,  1.56it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:09,  1.81it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:08,  2.05it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:07,  2.20it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:06,  2.40it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  2.67it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.73it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.76it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  2.87it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.88it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.87it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  2.90it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.87it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.88it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.95it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.15it/s][A04/28/2024 22:26:10 - INFO - trainer.trainer_mod_2 - Epoch 7 finished. Took 42.66 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.70it/s]
Epoch:   8%|▊         | 8/100 [05:39<1:06:12, 43.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.87it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.87it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.87it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.94it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.95it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.03it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.02it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.90it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.87it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.86it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:36,  2.78it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:35,  2.84it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:35,  2.83it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.90it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:33,  2.89it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:34,  2.76it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.91it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.89it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 22:26:20,504 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:26:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:26:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:26:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:26:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.55it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 22:26:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:26:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.891156462585034, 'combined_score': 0.8671468587434974, 'eval_loss': 0.6258331, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2285, 2270, 2377, 2261, 2258, 2239, 2002, 1755, 1437, 1280, 594, 650], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 10, 12, 12, 11, 10], 'pruned_params': 27919960, 'remaining_params': 57097640, 'pruned_model_sparsity': 0.3284021190906353, 'expected_sparsity': 0.33112, 'target_sparsity': 0.3510869565217391, 'step': 950}


Iteration:  26%|██▌       | 30/115 [00:11<01:04,  1.32it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:53,  1.58it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:44,  1.85it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:39,  2.08it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:36,  2.25it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:33,  2.42it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:30,  2.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:28,  2.71it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.77it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:27,  2.79it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:26,  2.79it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:26,  2.76it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:25,  2.83it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:25,  2.88it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.96it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.98it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.98it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.92it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.97it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:20,  2.98it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.04it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.84it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.88it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.92it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.93it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.94it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.00it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.97it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:15,  2.91it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.87it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.90it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.75it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.81it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.81it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.86it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.91it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 22:26:38,945 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:26:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:26:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:26:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:26:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.57it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.75it/s]04/28/2024 22:26:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:26:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.886326194398682, 'combined_score': 0.8586042736699293, 'eval_loss': 0.715893, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2162, 2154, 2278, 2147, 2143, 2114, 1840, 1591, 1275, 1242, 482, 617], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 11, 11, 10], 'pruned_params': 30291496, 'remaining_params': 54726104, 'pruned_model_sparsity': 0.3562967667871123, 'expected_sparsity': 0.37633, 'target_sparsity': 0.3717391304347826, 'step': 1000}


Iteration:  70%|██████▉   | 80/115 [00:30<00:26,  1.32it/s][A04/28/2024 22:26:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 1000, Alignment: tensor([ 2,  5,  6, 10], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:30<00:21,  1.60it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:17,  1.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:31<00:15,  2.11it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:13,  2.31it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:12,  2.47it/s][A
Iteration:  75%|███████▍  | 86/115 [00:32<00:11,  2.62it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:10,  2.56it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:10,  2.62it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:09,  2.72it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:09,  2.69it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.78it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:08,  2.85it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.88it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.88it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  2.91it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.91it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:06,  2.89it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.89it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:05,  2.78it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:04,  2.98it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:03,  2.95it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.97it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.96it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.79it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.81it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.87it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.07it/s][A04/28/2024 22:26:52 - INFO - trainer.trainer_mod_2 - Epoch 8 finished. Took 42.11 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:   9%|▉         | 9/100 [06:21<1:04:59, 42.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.98it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.00it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.04it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.07it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.00it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.07it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.03it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 22:26:57,287 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:26:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:26:57 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:26:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:26:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:26:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:26:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8651315789473684, 'combined_score': 0.8320755933952528, 'eval_loss': 0.5551926, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2043, 2041, 2177, 2034, 2030, 1991, 1690, 1513, 1187, 1217, 410, 598], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 11, 10, 9], 'pruned_params': 36459328, 'remaining_params': 48558272, 'pruned_model_sparsity': 0.42884447455585667, 'expected_sparsity': 0.41753, 'target_sparsity': 0.3923913043478261, 'step': 1050}


Iteration:  13%|█▎        | 15/115 [00:06<01:15,  1.33it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:01,  1.60it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:52,  1.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:45,  2.13it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:41,  2.34it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:38,  2.50it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.64it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.75it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:32,  2.82it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.86it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.96it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.80it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.85it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.00it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:28,  2.85it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:29,  2.72it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:28,  2.78it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:27,  2.82it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:26,  2.83it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.93it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.99it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.95it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.07it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.99it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  2.98it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.94it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.95it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.98it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.03it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.02it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.00it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.86it/s][A[INFO|trainer.py:570] 2024-04-28 22:27:15,646 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:27:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:27:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:27:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:27:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.52it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.56it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.58it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.61it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.61it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.78it/s]04/28/2024 22:27:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:27:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8866666666666667, 'combined_score': 0.8600000000000001, 'eval_loss': 0.58808756, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1929, 1935, 2076, 1925, 1920, 1872, 1556, 1482, 1153, 1197, 361, 585], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 9, 9], 'pruned_params': 38141464, 'remaining_params': 46876136, 'pruned_model_sparsity': 0.4486302130382415, 'expected_sparsity': 0.44386, 'target_sparsity': 0.4130434782608695, 'step': 1100}


Iteration:  57%|█████▋    | 65/115 [00:24<00:38,  1.28it/s][A04/28/2024 22:27:17 - INFO - trainer.trainer_mod_2 - v4 Global step: 1100, Alignment: tensor([ 2,  5,  6, 10], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:25<00:31,  1.55it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:27,  1.75it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:23,  1.96it/s][A
Iteration:  60%|██████    | 69/115 [00:26<00:21,  2.18it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:19,  2.36it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:17,  2.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:16,  2.67it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:15,  2.75it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:14,  2.88it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.96it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.96it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.03it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:11,  2.96it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.92it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.92it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.91it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.94it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.90it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.84it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.91it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.01it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.05it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.99it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  3.00it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.00it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.80it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.85it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.93it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.95it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 22:27:33,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:27:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:27:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:27:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:27:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.64it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:27:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:27:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8877374784110534, 'combined_score': 0.8642118764604287, 'eval_loss': 0.47901407, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1824, 1835, 1984, 1824, 1818, 1760, 1434, 1465, 1136, 1179, 328, 575], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 9, 8], 'pruned_params': 39512604, 'remaining_params': 45504996, 'pruned_model_sparsity': 0.46475793247515806, 'expected_sparsity': 0.46277, 'target_sparsity': 0.433695652173913, 'step': 1150}


Iteration: 100%|██████████| 115/115 [00:43<00:00,  1.37it/s][A04/28/2024 22:27:35 - INFO - trainer.trainer_mod_2 - Epoch 9 finished. Took 43.02 seconds.
Iteration: 100%|██████████| 115/115 [00:43<00:00,  2.67it/s]
Epoch:  10%|█         | 10/100 [07:04<1:04:21, 42.90s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.85it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.91it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.92it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.03it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.84it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.80it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.85it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.87it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:36,  2.90it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.89it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:35,  2.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:36,  2.81it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:35,  2.87it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.99it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.06it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:30,  3.04it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.04it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.00it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.81it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.88it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.93it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.95it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.04it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.03it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.04it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.02it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:26,  2.89it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.93it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:24,  2.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  3.00it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.02it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 22:27:52,282 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:27:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:27:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:27:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:27:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.61it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:27:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:27:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8853046594982079, 'combined_score': 0.8642209572000843, 'eval_loss': 0.6874052, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1725, 1744, 1894, 1729, 1724, 1655, 1325, 1453, 1125, 1162, 304, 566], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 12, 10, 9, 8], 'pruned_params': 40595728, 'remaining_params': 44421872, 'pruned_model_sparsity': 0.4774979298404095, 'expected_sparsity': 0.47966, 'target_sparsity': 0.4543478260869565, 'step': 1200}


Iteration:  43%|████▎     | 50/115 [00:18<00:49,  1.33it/s][A04/28/2024 22:27:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 1200, Alignment: tensor([ 2,  5,  6, 10], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:40,  1.59it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:34,  1.85it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:29,  2.09it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:27,  2.21it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:25,  2.39it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:23,  2.53it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:21,  2.64it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:20,  2.75it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:19,  2.80it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:20,  2.71it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.89it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  2.95it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.93it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.90it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.90it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:15,  2.79it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.86it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.96it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.94it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.91it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.96it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  2.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.95it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.97it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.94it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.95it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.93it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 22:28:10,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:28:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:28:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:28:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:28:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.62it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.82it/s]04/28/2024 22:28:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:28:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8529411764705882, 'f1': 0.8954703832752613, 'combined_score': 0.8742057798729248, 'eval_loss': 0.85945415, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1634, 1658, 1810, 1640, 1638, 1559, 1229, 1444, 1117, 1145, 286, 559], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 11, 9, 9, 8], 'pruned_params': 41977592, 'remaining_params': 43040008, 'pruned_model_sparsity': 0.4937517878651009, 'expected_sparsity': 0.49722, 'target_sparsity': 0.475, 'step': 1250}


Iteration:  87%|████████▋ | 100/115 [00:36<00:11,  1.33it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:08,  1.59it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:06,  1.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:05,  2.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:04,  2.30it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:04,  2.44it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  2.68it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.75it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.79it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.95it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.95it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.19it/s][A04/28/2024 22:28:17 - INFO - trainer.trainer_mod_2 - Epoch 10 finished. Took 41.75 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.75it/s]
Epoch:  11%|█         | 11/100 [07:46<1:03:06, 42.55s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:39,  2.91it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:41,  2.75it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:39,  2.83it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.76it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:38,  2.85it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:37,  2.91it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.90it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.93it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:36,  2.82it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:36,  2.85it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:35,  2.91it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.89it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.94it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.97it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.99it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  2.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.05it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.04it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.10it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:31,  2.87it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.90it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.87it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:30,  2.90it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.95it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 22:28:29,011 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:28:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:28:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:28:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:28:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/28/2024 22:28:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:28:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8824531516183987, 'combined_score': 0.8566677522797876, 'eval_loss': 0.59603894, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1552, 1580, 1730, 1558, 1556, 1468, 1142, 1436, 1110, 1129, 271, 552], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 11, 9, 9, 8], 'pruned_params': 44460964, 'remaining_params': 40556636, 'pruned_model_sparsity': 0.5229618808340861, 'expected_sparsity': 0.51396, 'target_sparsity': 0.49565217391304345, 'step': 1300}


Iteration:  30%|███       | 35/115 [00:13<00:59,  1.33it/s][A04/28/2024 22:28:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 1300, Alignment: tensor([ 2,  5,  6, 10], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:13<00:49,  1.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:42,  1.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:37,  2.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.30it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:30,  2.45it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:28,  2.59it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.76it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:24,  2.85it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:24,  2.88it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:23,  2.93it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.01it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.02it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.02it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:19,  3.08it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.06it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.04it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.02it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.02it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.02it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:19,  2.89it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:18,  2.90it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.98it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.02it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.10it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.05it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.87it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.92it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.92it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.91it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.93it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.02it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.98it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 22:28:47,127 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:28:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:28:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:28:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:28:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 22:28:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:28:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.8730434782608695, 'combined_score': 0.8470609548167092, 'eval_loss': 0.8797202, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1476, 1507, 1654, 1482, 1481, 1384, 1065, 1428, 1104, 1113, 260, 545], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 9, 11, 9, 9, 7], 'pruned_params': 45300500, 'remaining_params': 39717100, 'pruned_model_sparsity': 0.5328367302770249, 'expected_sparsity': 0.52799, 'target_sparsity': 0.5163043478260869, 'step': 1350}


Iteration:  74%|███████▍  | 85/115 [00:31<00:22,  1.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:17,  1.61it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:15,  1.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:12,  2.10it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:11,  2.25it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:10,  2.44it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:09,  2.59it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.75it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.80it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.91it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.96it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.97it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.97it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.93it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.93it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.95it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  2.99it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:01,  3.00it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.01it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.95it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.15it/s][A04/28/2024 22:28:58 - INFO - trainer.trainer_mod_2 - Epoch 11 finished. Took 41.44 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  12%|█▏        | 12/100 [08:27<1:01:54, 42.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.06it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.05it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.99it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:39,  2.78it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:37,  2.91it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.81it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:37,  2.84it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:36,  2.90it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  3.02it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  3.00it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 22:29:05,288 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:29:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:29:05 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:29:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:29:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 22:29:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:29:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8771929824561404, 'combined_score': 0.8528121775025801, 'eval_loss': 0.7464259, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1408, 1440, 1584, 1410, 1410, 1306, 994, 1419, 1097, 1096, 249, 538], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 11, 9, 9, 7], 'pruned_params': 46274852, 'remaining_params': 38742748, 'pruned_model_sparsity': 0.5442973219662752, 'expected_sparsity': 0.53999, 'target_sparsity': 0.5369565217391303, 'step': 1400}


Iteration:  17%|█▋        | 20/115 [00:08<01:11,  1.33it/s][A04/28/2024 22:29:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 1400, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:59,  1.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:50,  1.85it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:44,  2.09it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:41,  2.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:37,  2.38it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:34,  2.56it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:32,  2.67it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:31,  2.77it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:30,  2.81it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:29,  2.86it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:29,  2.82it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:28,  2.88it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:27,  2.88it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.86it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.07it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.04it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.05it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.98it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.99it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.07it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.05it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.05it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.98it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.95it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.96it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.96it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.96it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.93it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.81it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.85it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:16,  2.85it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.91it/s][A[INFO|trainer.py:570] 2024-04-28 22:29:23,602 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:29:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:29:23 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:29:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:29:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 22:29:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:29:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8873720136518771, 'combined_score': 0.8628036538847621, 'eval_loss': 0.7584759, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1341, 1375, 1514, 1341, 1339, 1230, 927, 1411, 1089, 1079, 240, 530], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 11, 9, 9, 7], 'pruned_params': 47031660, 'remaining_params': 37985940, 'pruned_model_sparsity': 0.553199102303523, 'expected_sparsity': 0.55104, 'target_sparsity': 0.557608695652174, 'step': 1450}


Iteration:  61%|██████    | 70/115 [00:26<00:33,  1.32it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:27,  1.59it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:23,  1.83it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:20,  2.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:18,  2.27it/s][A
Iteration:  65%|██████▌   | 75/115 [00:28<00:16,  2.43it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:15,  2.59it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:14,  2.69it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:13,  2.77it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.85it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:12,  2.88it/s][A
Iteration:  70%|███████   | 81/115 [00:30<00:12,  2.81it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:31<00:10,  2.92it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.99it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.97it/s][A
Iteration:  76%|███████▌  | 87/115 [00:32<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.96it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:33<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.91it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.91it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.97it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.98it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  3.05it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.04it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.04it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.01it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.98it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.01it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.07it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.12it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.91it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.96it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.98it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.22it/s][A04/28/2024 22:29:40 - INFO - trainer.trainer_mod_2 - Epoch 12 finished. Took 41.53 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  13%|█▎        | 13/100 [09:09<1:00:54, 42.01s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.10it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.89it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.89it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.94it/s][A[INFO|trainer.py:570] 2024-04-28 22:29:41,748 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:29:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:29:41 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:29:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:29:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.89it/s]04/28/2024 22:29:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:29:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8827586206896552, 'combined_score': 0.8580459770114943, 'eval_loss': 0.76136184, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1276, 1310, 1444, 1272, 1273, 1155, 863, 1401, 1082, 1060, 232, 522], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 9, 11, 8, 9, 7], 'pruned_params': 47966180, 'remaining_params': 37051420, 'pruned_model_sparsity': 0.5641911792381813, 'expected_sparsity': 0.56162, 'target_sparsity': 0.5782608695652174, 'step': 1500}


Iteration:   4%|▍         | 5/115 [00:03<01:31,  1.20it/s][A04/28/2024 22:29:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 1500, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:12,  1.51it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:59,  1.81it/s][A
Iteration:   7%|▋         | 8/115 [00:04<00:52,  2.05it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:47,  2.25it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:45,  2.33it/s][A
Iteration:  10%|▉         | 11/115 [00:05<00:41,  2.51it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:38,  2.65it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:37,  2.73it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:35,  2.85it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.91it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.90it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.93it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:32,  2.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:31,  3.01it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.07it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  3.01it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.97it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  2.99it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.03it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.05it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  3.03it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  3.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.01it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.07it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.04it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.05it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:25,  3.03it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  3.02it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.09it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  3.04it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.05it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.04it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.99it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.06it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.02it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:23,  2.82it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.88it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.92it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.05it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 22:29:59,825 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:29:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:29:59 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:29:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:29:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 22:30:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:30:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8877192982456141, 'combined_score': 0.8654282765737875, 'eval_loss': 0.80239815, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1212, 1247, 1374, 1204, 1207, 1083, 802, 1390, 1073, 1041, 225, 514], 'head_nums': [12, 11, 12, 12, 12, 11, 12, 9, 11, 8, 9, 7], 'pruned_params': 48883848, 'remaining_params': 36133752, 'pruned_model_sparsity': 0.5749850383920506, 'expected_sparsity': 0.57257, 'target_sparsity': 0.5989130434782609, 'step': 1550}


Iteration:  48%|████▊     | 55/115 [00:21<00:44,  1.34it/s][A
Iteration:  49%|████▊     | 56/115 [00:21<00:36,  1.62it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:30,  1.91it/s][A
Iteration:  50%|█████     | 58/115 [00:22<00:26,  2.17it/s][A
Iteration:  51%|█████▏    | 59/115 [00:22<00:23,  2.36it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:21,  2.52it/s][A
Iteration:  53%|█████▎    | 61/115 [00:23<00:20,  2.61it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:19,  2.70it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:18,  2.74it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:17,  2.86it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:17,  2.92it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  2.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:15,  2.99it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  3.07it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  2.95it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:14,  2.84it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.88it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:13,  2.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.90it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  2.96it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  2.99it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.99it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  2.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.03it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.04it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  3.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.02it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  3.01it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.98it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:07,  2.81it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  2.88it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.87it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  2.87it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.97it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.84it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.87it/s][A[INFO|trainer.py:570] 2024-04-28 22:30:18,043 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:30:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:30:18 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:30:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:30:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 22:30:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:30:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8112745098039216, 'f1': 0.8617594254937163, 'combined_score': 0.8365169676488189, 'eval_loss': 0.8532826, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1150, 1184, 1305, 1139, 1142, 1014, 743, 1379, 1064, 1020, 218, 505], 'head_nums': [12, 11, 12, 12, 12, 11, 12, 9, 10, 7, 9, 7], 'pruned_params': 49979228, 'remaining_params': 35038372, 'pruned_model_sparsity': 0.5878691941433303, 'expected_sparsity': 0.58448, 'target_sparsity': 0.6195652173913043, 'step': 1600}


Iteration:  91%|█████████▏| 105/115 [00:39<00:07,  1.33it/s][A04/28/2024 22:30:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 1600, Alignment: tensor([ 2,  4,  6, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:39<00:05,  1.60it/s][A
Iteration:  93%|█████████▎| 107/115 [00:40<00:04,  1.86it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:03,  2.10it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:02,  2.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:41<00:02,  2.46it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  2.49it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  2.63it/s][A
Iteration:  98%|█████████▊| 113/115 [00:42<00:00,  2.61it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.71it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.92it/s][A04/28/2024 22:30:22 - INFO - trainer.trainer_mod_2 - Epoch 13 finished. Took 42.78 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.69it/s]
Epoch:  14%|█▍        | 14/100 [09:52<1:00:32, 42.24s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.98it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.98it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.99it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.06it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.07it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.02it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.02it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.98it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  3.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.07it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:33,  2.88it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.90it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:32,  2.92it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:31,  2.89it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.04it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.99it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.96it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.01it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 22:30:36,253 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:30:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:30:36 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:30:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:30:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/28/2024 22:30:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:30:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8794326241134752, 'combined_score': 0.8563829787234043, 'eval_loss': 0.8204306, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1089, 1121, 1235, 1074, 1079, 945, 687, 1366, 1054, 997, 212, 495], 'head_nums': [12, 11, 12, 12, 12, 11, 12, 9, 10, 7, 9, 7], 'pruned_params': 50673224, 'remaining_params': 34344376, 'pruned_model_sparsity': 0.5960321627521831, 'expected_sparsity': 0.59553, 'target_sparsity': 0.6402173913043477, 'step': 1650}


Iteration:  35%|███▍      | 40/115 [00:14<00:56,  1.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:45,  1.62it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:38,  1.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:35,  2.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:31,  2.25it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:28,  2.42it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.56it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:25,  2.64it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:24,  2.70it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:23,  2.80it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:22,  2.84it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.86it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:22,  2.81it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.83it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:21,  2.88it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.92it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  2.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.84it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.88it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.91it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.94it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.96it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.07it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.08it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.90it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:12,  2.78it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.88it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.93it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.92it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:10,  2.95it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.83it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.89it/s][A[INFO|trainer.py:570] 2024-04-28 22:30:54,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:30:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:30:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:30:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:30:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.65it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.85it/s]04/28/2024 22:30:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:30:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8908145580589255, 'combined_score': 0.8682013966765216, 'eval_loss': 0.7895954, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1028, 1059, 1164, 1008, 1016, 877, 635, 1352, 1042, 972, 206, 485], 'head_nums': [12, 11, 12, 12, 12, 11, 11, 8, 10, 7, 9, 7], 'pruned_params': 51753284, 'remaining_params': 33264316, 'pruned_model_sparsity': 0.6087361205209274, 'expected_sparsity': 0.60796, 'target_sparsity': 0.6608695652173913, 'step': 1700}


Iteration:  78%|███████▊  | 90/115 [00:33<00:18,  1.32it/s][A04/28/2024 22:30:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 1700, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:33<00:15,  1.57it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:12,  1.83it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:10,  2.08it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:09,  2.31it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:08,  2.48it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:07,  2.60it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.70it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  2.84it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  2.96it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.97it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.98it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.97it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.99it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.02it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  3.02it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.99it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.02it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.93it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  3.05it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:00,  3.04it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  3.09it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.08it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.28it/s][A04/28/2024 22:31:04 - INFO - trainer.trainer_mod_2 - Epoch 14 finished. Took 41.42 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.78it/s]
Epoch:  15%|█▌        | 15/100 [10:33<59:29, 41.99s/it]  
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.97it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.96it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.00it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.00it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.94it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:35,  2.96it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.97it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:35,  2.94it/s][A
Iteration:  10%|█         | 12/115 [00:04<00:34,  2.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  2.99it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:33,  3.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:34,  2.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.04it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.03it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.04it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 22:31:12,635 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:31:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:31:12 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:31:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:31:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/28/2024 22:31:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:31:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.888135593220339, 'combined_score': 0.863185443668993, 'eval_loss': 0.79207325, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [967, 997, 1092, 943, 953, 810, 585, 1336, 1030, 945, 201, 473], 'head_nums': [12, 11, 12, 12, 12, 11, 11, 8, 9, 6, 8, 7], 'pruned_params': 53023312, 'remaining_params': 31994288, 'pruned_model_sparsity': 0.6236745332731105, 'expected_sparsity': 0.62231, 'target_sparsity': 0.6815217391304347, 'step': 1750}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:55,  1.60it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:47,  1.86it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.11it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:37,  2.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.47it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.60it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.68it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:29,  2.77it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:29,  2.76it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:29,  2.74it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:28,  2.82it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.87it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.90it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.94it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.97it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.99it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  3.05it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  3.01it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  3.05it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.03it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.02it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:20,  3.02it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.03it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.00it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.01it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.01it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.92it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.90it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:17,  2.89it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  2.98it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.03it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.04it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.07it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.12it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 22:31:30,755 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:31:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:31:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:31:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:31:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.66it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/28/2024 22:31:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:31:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8790035587188612, 'combined_score': 0.8561684460260972, 'eval_loss': 0.8205797, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [907, 935, 1021, 879, 891, 746, 539, 1319, 1016, 915, 196, 461], 'head_nums': [12, 11, 12, 12, 12, 11, 11, 8, 8, 6, 8, 7], 'pruned_params': 53884296, 'remaining_params': 31133304, 'pruned_model_sparsity': 0.6338016598915989, 'expected_sparsity': 0.63586, 'target_sparsity': 0.7021739130434782, 'step': 1800}


Iteration:  65%|██████▌   | 75/115 [00:27<00:29,  1.34it/s][A04/28/2024 22:31:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 1800, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:24,  1.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:20,  1.87it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:17,  2.11it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:16,  2.23it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:14,  2.42it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:13,  2.58it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:12,  2.60it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:11,  2.72it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:11,  2.77it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.84it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  2.90it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.96it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:08,  2.84it/s][A
Iteration:  81%|████████  | 93/115 [00:34<00:07,  2.86it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  2.93it/s][A
Iteration:  83%|████████▎ | 96/115 [00:35<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:06,  2.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:36<00:05,  3.01it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  2.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:37<00:04,  2.98it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:04,  2.98it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:38<00:03,  2.90it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:03,  2.94it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  2.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:02,  3.00it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.84it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.89it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.82it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.85it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.12it/s][A04/28/2024 22:31:45 - INFO - trainer.trainer_mod_2 - Epoch 15 finished. Took 41.44 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.78it/s]
Epoch:  16%|█▌        | 16/100 [11:15<58:33, 41.83s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:40,  2.76it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.88it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.93it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.96it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.01it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.08it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 22:31:49,029 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:31:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:31:49 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:31:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:31:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.68it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.69it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.70it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.71it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.90it/s]04/28/2024 22:31:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:31:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8824531516183987, 'combined_score': 0.8566677522797876, 'eval_loss': 0.8809887, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [849, 876, 952, 818, 832, 687, 497, 1299, 1001, 884, 192, 448], 'head_nums': [12, 11, 11, 12, 12, 10, 10, 8, 8, 6, 7, 7], 'pruned_params': 55298332, 'remaining_params': 29719268, 'pruned_model_sparsity': 0.6504339336796146, 'expected_sparsity': 0.6533, 'target_sparsity': 0.7228260869565217, 'step': 1850}


Iteration:   9%|▊         | 10/115 [00:04<01:19,  1.33it/s][A
Iteration:  10%|▉         | 11/115 [00:05<01:05,  1.60it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:55,  1.86it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:48,  2.10it/s][A
Iteration:  12%|█▏        | 14/115 [00:06<00:43,  2.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:40,  2.47it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:38,  2.54it/s][A
Iteration:  15%|█▍        | 17/115 [00:07<00:37,  2.62it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:35,  2.70it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.84it/s][A
Iteration:  17%|█▋        | 20/115 [00:08<00:33,  2.88it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.88it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:09<00:30,  2.97it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  2.98it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.05it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.02it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:28,  3.04it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.96it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.95it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:27,  2.98it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.99it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:27,  2.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.94it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:25,  2.96it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:23,  2.98it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.95it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:22,  2.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:21,  2.96it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:22,  2.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 22:32:07,214 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:32:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:32:07 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:32:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:32:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.65it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.66it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.67it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.68it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.86it/s]04/28/2024 22:32:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:32:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8817567567567567, 'combined_score': 0.8550940646528882, 'eval_loss': 0.83244175, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [796, 819, 887, 764, 778, 633, 461, 1277, 983, 850, 187, 434], 'head_nums': [12, 10, 10, 12, 11, 10, 10, 8, 7, 5, 6, 7], 'pruned_params': 57054004, 'remaining_params': 27963596, 'pruned_model_sparsity': 0.6710846224781692, 'expected_sparsity': 0.6738, 'target_sparsity': 0.7434782608695653, 'step': 1900}


Iteration:  52%|█████▏    | 60/115 [00:22<00:40,  1.34it/s][A04/28/2024 22:32:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 1900, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:23<00:33,  1.61it/s][A
Iteration:  54%|█████▍    | 62/115 [00:23<00:28,  1.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:24,  2.12it/s][A
Iteration:  56%|█████▌    | 64/115 [00:24<00:22,  2.31it/s][A
Iteration:  57%|█████▋    | 65/115 [00:24<00:20,  2.46it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:18,  2.59it/s][A
Iteration:  58%|█████▊    | 67/115 [00:25<00:17,  2.69it/s][A
Iteration:  59%|█████▉    | 68/115 [00:25<00:16,  2.78it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:16,  2.81it/s][A
Iteration:  61%|██████    | 70/115 [00:26<00:16,  2.73it/s][A
Iteration:  62%|██████▏   | 71/115 [00:26<00:15,  2.78it/s][A
Iteration:  63%|██████▎   | 72/115 [00:27<00:15,  2.87it/s][A
Iteration:  63%|██████▎   | 73/115 [00:27<00:14,  2.88it/s][A
Iteration:  64%|██████▍   | 74/115 [00:27<00:13,  2.93it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:28<00:13,  2.85it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:12,  2.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:29<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:11,  3.06it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:11,  3.11it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:10,  3.14it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:10,  3.08it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  3.04it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  3.05it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:09,  3.06it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.10it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.05it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.05it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.00it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:34<00:07,  2.96it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  3.04it/s][A
Iteration:  84%|████████▍ | 97/115 [00:35<00:05,  3.07it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.01it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.05it/s][A
Iteration:  87%|████████▋ | 100/115 [00:36<00:05,  2.99it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.01it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  3.01it/s][A
Iteration:  90%|████████▉ | 103/115 [00:37<00:03,  3.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.10it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  3.04it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:02,  3.03it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.06it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  2.89it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 22:32:25,232 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:32:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:32:25 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:32:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:32:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.74it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.72it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.74it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/28/2024 22:32:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:32:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8694158075601375, 'combined_score': 0.841570648878108, 'eval_loss': 0.7716657, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [746, 767, 825, 711, 726, 584, 433, 1254, 965, 815, 183, 420], 'head_nums': [12, 10, 10, 12, 11, 10, 10, 7, 6, 5, 5, 7], 'pruned_params': 59822328, 'remaining_params': 25195272, 'pruned_model_sparsity': 0.7036463979223125, 'expected_sparsity': 0.69344, 'target_sparsity': 0.7641304347826087, 'step': 1950}


Iteration:  96%|█████████▌| 110/115 [00:40<00:03,  1.35it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:02,  1.62it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:01,  1.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  2.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:42<00:00,  2.36it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.68it/s][A04/28/2024 22:32:28 - INFO - trainer.trainer_mod_2 - Epoch 16 finished. Took 42.49 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.71it/s]
Epoch:  17%|█▋        | 17/100 [11:57<58:08, 42.02s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.89it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.96it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  3.01it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.04it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.02it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.06it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.02it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  3.03it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.05it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.07it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.09it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.05it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.07it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.03it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.07it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.07it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.06it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.10it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  2.98it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.03it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:28,  2.95it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  2.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.02it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  2.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.02it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.00it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:24,  3.06it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:25,  2.90it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.94it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:25,  2.81it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:26,  2.76it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:25,  2.75it/s][A[INFO|trainer.py:570] 2024-04-28 22:32:43,231 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:32:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:32:43 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:32:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:32:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/28/2024 22:32:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:32:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8790035587188612, 'combined_score': 0.8561684460260972, 'eval_loss': 0.7969731, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [699, 719, 767, 663, 679, 539, 419, 1228, 946, 779, 180, 405], 'head_nums': [12, 10, 10, 12, 11, 10, 10, 6, 6, 5, 5, 6], 'pruned_params': 60471896, 'remaining_params': 24545704, 'pruned_model_sparsity': 0.7112867923818127, 'expected_sparsity': 0.70682, 'target_sparsity': 0.7847826086956522, 'step': 2000}


Iteration:  39%|███▉      | 45/115 [00:16<00:53,  1.31it/s][A04/28/2024 22:32:44 - INFO - trainer.trainer_mod_2 - v4 Global step: 2000, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:16<00:43,  1.58it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:36,  1.85it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:32,  2.08it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:28,  2.29it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:26,  2.47it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:24,  2.64it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:22,  2.78it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:21,  2.86it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  2.91it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:20,  2.94it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:20,  2.94it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:19,  2.93it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:18,  3.05it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.04it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.07it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.04it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:16,  3.08it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.15it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.05it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:16,  3.06it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.01it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.05it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.08it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.04it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.05it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.03it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.04it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.06it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  2.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.09it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.07it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.03it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.06it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  2.88it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:10,  2.95it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.02it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.93it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.00it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  2.99it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.01it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  2.92it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 22:33:01,109 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:33:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:33:01 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:33:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:33:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.71it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.73it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.73it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.74it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.73it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.92it/s]04/28/2024 22:33:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:33:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.8760907504363002, 'combined_score': 0.8510355712965815, 'eval_loss': 0.78766894, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [657, 675, 715, 618, 636, 498, 412, 1200, 925, 742, 177, 390], 'head_nums': [11, 10, 10, 12, 11, 10, 10, 6, 6, 5, 4, 6], 'pruned_params': 61277728, 'remaining_params': 23739872, 'pruned_model_sparsity': 0.7207652062631738, 'expected_sparsity': 0.71727, 'target_sparsity': 0.8054347826086956, 'step': 2050}


Iteration:  83%|████████▎ | 95/115 [00:34<00:14,  1.35it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:11,  1.62it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:09,  1.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:07,  2.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:06,  2.34it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:05,  2.54it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:05,  2.66it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  2.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:04,  2.85it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  2.94it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  3.06it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:02,  3.08it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:02,  3.02it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  3.06it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:01,  3.00it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.07it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  3.09it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  3.10it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.29it/s][A04/28/2024 22:33:08 - INFO - trainer.trainer_mod_2 - Epoch 17 finished. Took 40.73 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.82it/s]
Epoch:  18%|█▊        | 18/100 [12:38<56:54, 41.64s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:41,  2.76it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.91it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.04it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.00it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.07it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.15it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.03it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.93it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  2.97it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.09it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.11it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.09it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.05it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.07it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.09it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.04it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.05it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.04it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.04it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:30,  3.02it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.06it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.07it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 22:33:18,780 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:33:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:33:18 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:33:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:33:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.76it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.95it/s]04/28/2024 22:33:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:33:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.8773747841105355, 'combined_score': 0.8516775881336991, 'eval_loss': 0.81895036, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [618, 632, 666, 576, 596, 461, 408, 1169, 902, 703, 174, 375], 'head_nums': [11, 9, 10, 12, 11, 9, 10, 6, 6, 5, 4, 6], 'pruned_params': 62841900, 'remaining_params': 22175700, 'pruned_model_sparsity': 0.7391634202800361, 'expected_sparsity': 0.73047, 'target_sparsity': 0.826086956521739, 'step': 2100}


Iteration:  26%|██▌       | 30/115 [00:11<01:02,  1.35it/s][A04/28/2024 22:33:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 2100, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:11<00:52,  1.59it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:45,  1.84it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:38,  2.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:35,  2.30it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:31,  2.51it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:29,  2.67it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:28,  2.75it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:27,  2.80it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.93it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.05it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.07it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.11it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.08it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.15it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:21,  3.15it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.13it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:21,  3.05it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.07it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.03it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:21,  3.03it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.05it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  3.04it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.03it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.03it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:18,  3.06it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  3.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.04it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:18,  3.03it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.09it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.07it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:16,  3.09it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.10it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.11it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.06it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.10it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.05it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.04it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.02it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  2.94it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  3.01it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.89it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  2.96it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.83it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  2.97it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 22:33:36,591 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:33:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:33:36 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:33:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:33:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.75it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.75it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.76it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.76it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.95it/s]04/28/2024 22:33:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:33:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8561020036429872, 'combined_score': 0.8312372763312975, 'eval_loss': 0.8084573, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [582, 593, 621, 538, 558, 428, 406, 1136, 877, 664, 172, 359], 'head_nums': [11, 9, 10, 12, 11, 9, 9, 6, 5, 5, 3, 6], 'pruned_params': 63587984, 'remaining_params': 21429616, 'pruned_model_sparsity': 0.7479390620295092, 'expected_sparsity': 0.74346, 'target_sparsity': 0.8467391304347825, 'step': 2150}


Iteration:  70%|██████▉   | 80/115 [00:29<00:25,  1.35it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:21,  1.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:17,  1.85it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:15,  2.12it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:13,  2.34it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:11,  2.54it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:10,  2.68it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:10,  2.74it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.84it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:09,  2.77it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.83it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.92it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.04it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  3.12it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  3.13it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.10it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.17it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.13it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.09it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  3.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:03,  3.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.12it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  3.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:02,  3.09it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.05it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  3.05it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.08it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  3.09it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.08it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.96it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.20it/s][A04/28/2024 22:33:49 - INFO - trainer.trainer_mod_2 - Epoch 18 finished. Took 40.43 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.84it/s]
Epoch:  19%|█▉        | 19/100 [13:18<55:43, 41.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.34it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.01it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.04it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.08it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.07it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.11it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.09it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.12it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.07it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  3.02it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.06it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.03it/s][A[INFO|trainer.py:570] 2024-04-28 22:33:54,197 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:33:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:33:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:33:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:33:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.76it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.76it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.76it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.95it/s]04/28/2024 22:33:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:33:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.8805237315875613, 'combined_score': 0.8508010814800551, 'eval_loss': 0.9269726, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [548, 557, 581, 507, 524, 399, 403, 1101, 851, 624, 170, 344], 'head_nums': [11, 8, 10, 12, 10, 9, 9, 6, 5, 5, 3, 6], 'pruned_params': 64295768, 'remaining_params': 20721832, 'pruned_model_sparsity': 0.7562642088226438, 'expected_sparsity': 0.75627, 'target_sparsity': 0.867391304347826, 'step': 2200}


Iteration:  13%|█▎        | 15/115 [00:06<01:13,  1.36it/s][A04/28/2024 22:33:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 2200, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<00:59,  1.66it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:50,  1.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:44,  2.19it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:41,  2.33it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:39,  2.42it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:36,  2.58it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:34,  2.71it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.82it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.88it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.94it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:29,  2.99it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.03it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.11it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:27,  3.11it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:26,  3.17it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.20it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:26,  3.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.06it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.08it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.12it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.14it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.15it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.16it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.17it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.17it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.13it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.07it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.09it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.01it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.04it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.09it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.08it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  3.01it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.01it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  3.03it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.07it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.08it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.10it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  2.94it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.94it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.09it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  2.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:18,  2.88it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.96it/s][A[INFO|trainer.py:570] 2024-04-28 22:34:11,910 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:34:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:34:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:34:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:34:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.82it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.82it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.83it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.83it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.84it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.84it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.84it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.84it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.84it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.84it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.84it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.82it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.02it/s]04/28/2024 22:34:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:34:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.8730434782608695, 'combined_score': 0.8470609548167092, 'eval_loss': 0.6553873, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [517, 524, 544, 490, 492, 373, 400, 1063, 823, 584, 168, 329], 'head_nums': [11, 8, 10, 12, 10, 9, 9, 5, 4, 5, 3, 6], 'pruned_params': 65711336, 'remaining_params': 19306264, 'pruned_model_sparsity': 0.772914502408913, 'expected_sparsity': 0.76711, 'target_sparsity': 0.8880434782608696, 'step': 2250}


Iteration:  57%|█████▋    | 65/115 [00:23<00:36,  1.35it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:30,  1.60it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:25,  1.85it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:22,  2.08it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:19,  2.33it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:17,  2.52it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:16,  2.61it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:15,  2.76it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.85it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.90it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:13,  2.93it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:13,  2.97it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.97it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  3.00it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.04it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.02it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.10it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.17it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  3.09it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.11it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.17it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.12it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  3.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.01it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.97it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  3.08it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.04it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  3.09it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.03it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.06it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.09it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.04it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.04it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  3.07it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:03,  3.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.12it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.12it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:02,  3.11it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.10it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.10it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:01,  3.17it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.10it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.08it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.10it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 22:34:29,506 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:34:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:34:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:34:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:34:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.99it/s]04/28/2024 22:34:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:34:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8161764705882353, 'f1': 0.8730964467005077, 'combined_score': 0.8446364586443715, 'eval_loss': 0.7349272, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [489, 493, 511, 483, 463, 351, 397, 1023, 793, 545, 166, 314], 'head_nums': [11, 7, 10, 12, 8, 9, 9, 5, 4, 5, 3, 6], 'pruned_params': 66521764, 'remaining_params': 18495836, 'pruned_model_sparsity': 0.7824469756850346, 'expected_sparsity': 0.77729, 'target_sparsity': 0.908695652173913, 'step': 2300}


Iteration: 100%|██████████| 115/115 [00:41<00:00,  1.40it/s][A04/28/2024 22:34:30 - INFO - trainer.trainer_mod_2 - Epoch 19 finished. Took 41.53 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  20%|██        | 20/100 [14:00<55:08, 41.35s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 22:34:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 2300, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.11it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.10it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.14it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.14it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.08it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.05it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.06it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.07it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.09it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.11it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.11it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.18it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.18it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.15it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.89it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:30,  2.94it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.06it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:29,  2.94it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:28,  2.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.03it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.04it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:27,  3.00it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:26,  3.07it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:25,  3.06it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.05it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.06it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:24,  3.08it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.11it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.12it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:23,  3.13it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.06it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:23,  3.05it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:22,  3.07it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:22,  3.13it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.10it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:21,  3.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.15it/s][A[INFO|trainer.py:570] 2024-04-28 22:34:47,148 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:34:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:34:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:34:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:34:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.99it/s]04/28/2024 22:34:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:34:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8591549295774649, 'combined_score': 0.8315382491024579, 'eval_loss': 0.72725993, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [463, 464, 481, 480, 436, 331, 394, 980, 762, 508, 164, 300], 'head_nums': [10, 7, 9, 12, 7, 9, 8, 5, 3, 5, 3, 6], 'pruned_params': 67707532, 'remaining_params': 17310068, 'pruned_model_sparsity': 0.7963942995332731, 'expected_sparsity': 0.79003, 'target_sparsity': 0.9293478260869565, 'step': 2350}


Iteration:  43%|████▎     | 50/115 [00:17<00:47,  1.37it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:38,  1.64it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:33,  1.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:29,  2.10it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:26,  2.31it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:24,  2.46it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:22,  2.62it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:21,  2.76it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.88it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  2.91it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:18,  3.00it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  2.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  3.05it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.04it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  2.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.95it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.06it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  2.95it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  3.00it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.04it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.10it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.08it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.10it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.10it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.11it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.18it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.10it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.05it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  3.09it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.14it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  3.09it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.12it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.09it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.10it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.19it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.15it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.13it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.06it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 22:35:04,842 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:35:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:35:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:35:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:35:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.99it/s]04/28/2024 22:35:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:35:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8513761467889908, 'combined_score': 0.8264233675121424, 'eval_loss': 0.76129764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [440, 438, 454, 478, 411, 314, 391, 936, 730, 472, 163, 286], 'head_nums': [9, 7, 8, 11, 7, 9, 7, 5, 3, 5, 3, 6], 'pruned_params': 68674224, 'remaining_params': 16343376, 'pruned_model_sparsity': 0.8077647922312556, 'expected_sparsity': 0.80285, 'target_sparsity': 0.95, 'step': 2400}


Iteration:  87%|████████▋ | 100/115 [00:35<00:11,  1.35it/s][A04/28/2024 22:35:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 2400, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:35<00:08,  1.58it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:07,  1.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:05,  2.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:04,  2.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:04,  2.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:03,  2.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  2.73it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  2.77it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.85it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.94it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  2.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.02it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.22it/s][A04/28/2024 22:35:11 - INFO - trainer.trainer_mod_2 - Epoch 20 finished. Took 40.28 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.86it/s]
Epoch:  21%|██        | 21/100 [14:40<54:01, 41.03s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.18it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  3.01it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.07it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.08it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.04it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.05it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.08it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.07it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.07it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.04it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.07it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.07it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.09it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.10it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:33,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  3.00it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.98it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.07it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.09it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.08it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:30,  3.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.06it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.07it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.11it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.98it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 22:35:22,585 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:35:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:35:22 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:35:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:35:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.81it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.80it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.99it/s]04/28/2024 22:35:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:35:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8112745098039216, 'f1': 0.8688245315161841, 'combined_score': 0.8400495206600529, 'eval_loss': 0.69887066, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [419, 414, 431, 475, 389, 299, 387, 891, 698, 439, 161, 274], 'head_nums': [9, 7, 7, 11, 7, 9, 7, 4, 2, 5, 3, 6], 'pruned_params': 69426436, 'remaining_params': 15591164, 'pruned_model_sparsity': 0.8166125131737428, 'expected_sparsity': 0.81259, 'target_sparsity': 0.95, 'step': 2450}


Iteration:  30%|███       | 35/115 [00:12<00:58,  1.36it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:48,  1.63it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:41,  1.89it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:35,  2.15it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:33,  2.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:29,  2.50it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:27,  2.68it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:25,  2.87it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:24,  2.92it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:23,  2.93it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.98it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.03it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.12it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:20,  3.10it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:19,  3.16it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.19it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.05it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.04it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.05it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.13it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.08it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.11it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.08it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.05it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.09it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.08it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.08it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  3.06it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.12it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.10it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.15it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.11it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  3.03it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.08it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:13,  3.02it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.07it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.08it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.11it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  2.98it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  3.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.05it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.13it/s][A[INFO|trainer.py:570] 2024-04-28 22:35:40,209 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:35:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:35:40 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:35:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:35:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.77it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.78it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.98it/s]04/28/2024 22:35:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:35:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8513761467889908, 'combined_score': 0.8264233675121424, 'eval_loss': 0.7443811, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [400, 393, 410, 473, 368, 285, 383, 847, 666, 409, 160, 263], 'head_nums': [8, 7, 6, 11, 7, 8, 6, 4, 2, 5, 3, 6], 'pruned_params': 70359424, 'remaining_params': 14658176, 'pruned_model_sparsity': 0.8275865703101476, 'expected_sparsity': 0.82203, 'target_sparsity': 0.95, 'step': 2500}


Iteration:  74%|███████▍  | 85/115 [00:30<00:21,  1.37it/s][A04/28/2024 22:35:41 - INFO - trainer.trainer_mod_2 - v4 Global step: 2500, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:30<00:18,  1.60it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:14,  1.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:12,  2.12it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:11,  2.32it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:10,  2.48it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:09,  2.63it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:08,  2.71it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.78it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:07,  2.86it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.95it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  3.00it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.01it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:05,  3.04it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.06it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.07it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  3.05it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:03,  3.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.08it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  3.03it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:02,  3.06it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.06it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.07it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.04it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.91it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.15it/s][A04/28/2024 22:35:51 - INFO - trainer.trainer_mod_2 - Epoch 21 finished. Took 40.31 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.85it/s]
Epoch:  22%|██▏       | 22/100 [15:20<53:03, 40.82s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.02it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.97it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.03it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  3.01it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.98it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.01it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.11it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.10it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.02it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.03it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.06it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.06it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.06it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.14it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 22:35:58,008 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:35:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:35:58 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:35:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:35:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.99it/s]04/28/2024 22:35:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:35:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8088235294117647, 'f1': 0.8626760563380282, 'combined_score': 0.8357497928748965, 'eval_loss': 0.6996722, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [384, 374, 393, 470, 350, 273, 379, 803, 634, 383, 159, 253], 'head_nums': [7, 7, 6, 11, 7, 8, 6, 4, 2, 5, 3, 6], 'pruned_params': 70682676, 'remaining_params': 14334924, 'pruned_model_sparsity': 0.8313887477416441, 'expected_sparsity': 0.83072, 'target_sparsity': 0.95, 'step': 2550}


Iteration:  17%|█▋        | 20/115 [00:07<01:09,  1.37it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:57,  1.65it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:48,  1.92it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:42,  2.15it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:38,  2.36it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:34,  2.58it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:32,  2.72it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:31,  2.81it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:30,  2.88it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.96it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:28,  2.99it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  3.00it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  3.00it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.02it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  2.99it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.02it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.07it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.10it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.16it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.13it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.03it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.08it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.09it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.06it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.07it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:21,  3.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.07it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.10it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.04it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  3.07it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.08it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.06it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.06it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.07it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.10it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.08it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.10it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.11it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.10it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.04it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.09it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  2.95it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.89it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  2.96it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 22:36:15,727 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:36:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:36:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:36:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:36:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.37it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.63it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.74it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.77it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.81it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.82it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.93it/s]04/28/2024 22:36:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:36:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8630849220103985, 'combined_score': 0.8347287355150033, 'eval_loss': 0.658182, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [369, 358, 377, 467, 334, 263, 375, 762, 605, 360, 158, 244], 'head_nums': [7, 7, 5, 10, 6, 7, 6, 3, 2, 5, 3, 6], 'pruned_params': 71776524, 'remaining_params': 13241076, 'pruned_model_sparsity': 0.8442548836946703, 'expected_sparsity': 0.8403, 'target_sparsity': 0.95, 'step': 2600}


Iteration:  61%|██████    | 70/115 [00:25<00:33,  1.34it/s][A04/28/2024 22:36:17 - INFO - trainer.trainer_mod_2 - v4 Global step: 2600, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:25<00:27,  1.61it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:22,  1.89it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:19,  2.17it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:17,  2.38it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:15,  2.53it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:14,  2.68it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.80it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:12,  2.91it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:12,  2.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.04it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:11,  3.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.10it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:09,  3.14it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:08,  3.25it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.17it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.14it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.14it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.15it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.11it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  2.96it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.09it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.11it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.09it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.07it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.05it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.05it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:04,  2.87it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  2.94it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  2.91it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:03,  2.98it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.03it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.21it/s][A04/28/2024 22:36:31 - INFO - trainer.trainer_mod_2 - Epoch 22 finished. Took 40.2 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.86it/s]
Epoch:  23%|██▎       | 23/100 [16:01<52:08, 40.63s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.28it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A[INFO|trainer.py:570] 2024-04-28 22:36:33,239 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:36:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:36:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:36:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:36:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.78it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.79it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.80it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.80it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.79it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.79it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00,  9.99it/s]04/28/2024 22:36:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:36:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8561525129982669, 'combined_score': 0.8263605702246236, 'eval_loss': 0.6067871, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [356, 345, 362, 465, 320, 254, 371, 722, 576, 341, 157, 236], 'head_nums': [6, 6, 5, 9, 6, 6, 6, 3, 1, 5, 3, 6], 'pruned_params': 72856584, 'remaining_params': 12161016, 'pruned_model_sparsity': 0.8569588414634146, 'expected_sparsity': 0.85064, 'target_sparsity': 0.95, 'step': 2650}


Iteration:   4%|▍         | 5/115 [00:02<01:28,  1.24it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:10,  1.55it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:57,  1.87it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:49,  2.15it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:44,  2.39it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:40,  2.57it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:39,  2.65it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:36,  2.79it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:35,  2.90it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:34,  2.92it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:34,  2.90it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:33,  2.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  3.02it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:31,  3.07it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:31,  3.06it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:30,  3.03it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.02it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:30,  3.05it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.99it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:28,  3.07it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.11it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:27,  3.10it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.07it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:26,  3.04it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.09it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.08it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.08it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.15it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.13it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:25,  2.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.98it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.03it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.04it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.08it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:21,  3.15it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.11it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.07it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.03it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  3.02it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.02it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  3.06it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.02it/s][A[INFO|trainer.py:570] 2024-04-28 22:36:50,940 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:36:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:36:50 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:36:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:36:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.85it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.86it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.86it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.87it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.86it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.86it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.86it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.05it/s]04/28/2024 22:36:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:36:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.8073394495412843, 'combined_score': 0.7492579600647598, 'eval_loss': 0.6085813, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [345, 337, 349, 462, 307, 247, 367, 684, 549, 323, 156, 229], 'head_nums': [6, 6, 5, 8, 6, 6, 6, 3, 1, 5, 3, 6], 'pruned_params': 73846256, 'remaining_params': 11171344, 'pruned_model_sparsity': 0.8685996311352002, 'expected_sparsity': 0.8615, 'target_sparsity': 0.95, 'step': 2700}


Iteration:  48%|████▊     | 55/115 [00:20<00:44,  1.36it/s][A04/28/2024 22:36:52 - INFO - trainer.trainer_mod_2 - v4 Global step: 2700, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:20<00:36,  1.63it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:30,  1.91it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:26,  2.13it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:23,  2.39it/s][A
Iteration:  52%|█████▏    | 60/115 [00:22<00:21,  2.58it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:19,  2.77it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.87it/s][A
Iteration:  55%|█████▍    | 63/115 [00:23<00:17,  2.95it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:17,  2.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 66/115 [00:24<00:16,  3.05it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:15,  3.06it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.07it/s][A
Iteration:  60%|██████    | 69/115 [00:25<00:14,  3.09it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:15,  2.99it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.03it/s][A
Iteration:  63%|██████▎   | 72/115 [00:26<00:14,  3.05it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.06it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:12,  3.17it/s][A
Iteration:  65%|██████▌   | 75/115 [00:27<00:12,  3.16it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.06it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.10it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:11,  3.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.12it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:10,  3.20it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.14it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  3.02it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.04it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.03it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:09,  2.90it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:09,  2.84it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.91it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:08,  2.92it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:08,  2.98it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  2.98it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.02it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:06,  3.05it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.07it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.07it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.11it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.08it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.08it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.08it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:03,  3.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 22:37:08,616 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:37:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:37:08 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:37:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:37:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.85it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.87it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.87it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.87it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.86it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.87it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.87it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.87it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.87it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.86it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.87it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.06it/s]04/28/2024 22:37:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:37:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.8073394495412843, 'combined_score': 0.7492579600647598, 'eval_loss': 0.6421365, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [334, 333, 338, 459, 296, 241, 363, 649, 524, 309, 155, 222], 'head_nums': [6, 6, 4, 8, 6, 5, 6, 2, 1, 5, 3, 6], 'pruned_params': 74495824, 'remaining_params': 10521776, 'pruned_model_sparsity': 0.8762400255947004, 'expected_sparsity': 0.87101, 'target_sparsity': 0.95, 'step': 2750}


Iteration:  91%|█████████▏| 105/115 [00:38<00:07,  1.37it/s][A
Iteration:  92%|█████████▏| 106/115 [00:38<00:05,  1.64it/s][A
Iteration:  93%|█████████▎| 107/115 [00:38<00:04,  1.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:39<00:03,  2.15it/s][A
Iteration:  95%|█████████▍| 109/115 [00:39<00:02,  2.38it/s][A
Iteration:  96%|█████████▌| 110/115 [00:39<00:01,  2.56it/s][A
Iteration:  97%|█████████▋| 111/115 [00:40<00:01,  2.63it/s][A
Iteration:  97%|█████████▋| 112/115 [00:40<00:01,  2.76it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.83it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  2.92it/s][A
Iteration: 100%|██████████| 115/115 [00:41<00:00,  3.17it/s][A04/28/2024 22:37:13 - INFO - trainer.trainer_mod_2 - Epoch 23 finished. Took 41.51 seconds.
Iteration: 100%|██████████| 115/115 [00:41<00:00,  2.77it/s]
Epoch:  24%|██▍       | 24/100 [16:42<51:47, 40.89s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.07it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.14it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.12it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.12it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.08it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.11it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.11it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.07it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.08it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.03it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.11it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:34,  2.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  3.03it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.04it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.04it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:33,  2.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.96it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  3.01it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.04it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:29,  3.14it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.12it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.13it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:28,  3.13it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.07it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.07it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.08it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.10it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.12it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.08it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.10it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.12it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.08it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:25,  3.10it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:24,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 22:37:26,183 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:37:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:37:26 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:37:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:37:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.89it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.90it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.09it/s]04/28/2024 22:37:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:37:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6804841, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [325, 331, 327, 456, 285, 237, 359, 616, 500, 296, 155, 216], 'head_nums': [6, 6, 4, 7, 5, 4, 6, 2, 1, 5, 3, 6], 'pruned_params': 75500816, 'remaining_params': 9516784, 'pruned_model_sparsity': 0.8880610132490214, 'expected_sparsity': 0.88214, 'target_sparsity': 0.95, 'step': 2800}


Iteration:  35%|███▍      | 40/115 [00:14<00:54,  1.38it/s][A04/28/2024 22:37:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 2800, Alignment: tensor([ 2,  5,  6, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:14<00:44,  1.65it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:37,  1.93it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:33,  2.14it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:30,  2.36it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:27,  2.54it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:25,  2.69it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:23,  2.88it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.95it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.02it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.06it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.13it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.09it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.10it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.10it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.08it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:18,  3.16it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.16it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.22it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.15it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.07it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  3.05it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.09it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.11it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.19it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.03it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.07it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.09it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.08it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.10it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.13it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.15it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.15it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.12it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.10it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.12it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.19it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.18it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.16it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.12it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.10it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.11it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.08it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.08it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:09,  3.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 22:37:43,657 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:37:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:37:43 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:37:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:37:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.91it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.91it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.91it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.10it/s]04/28/2024 22:37:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:37:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8129602356406479, 'combined_score': 0.7508428629183632, 'eval_loss': 0.7102119, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [317, 330, 318, 453, 275, 236, 355, 585, 478, 284, 154, 210], 'head_nums': [6, 6, 3, 6, 5, 4, 5, 2, 1, 5, 3, 5], 'pruned_params': 76132000, 'remaining_params': 8885600, 'pruned_model_sparsity': 0.895485170129479, 'expected_sparsity': 0.89007, 'target_sparsity': 0.95, 'step': 2850}


Iteration:  78%|███████▊  | 90/115 [00:31<00:18,  1.37it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:14,  1.65it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:11,  1.92it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:10,  2.15it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:08,  2.37it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:07,  2.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.74it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:06,  2.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  2.92it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  2.84it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:05,  2.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  2.97it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.01it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.11it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:02,  3.07it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  2.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.07it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.15it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.28it/s][A04/28/2024 22:37:53 - INFO - trainer.trainer_mod_2 - Epoch 24 finished. Took 39.9 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.88it/s]
Epoch:  25%|██▌       | 25/100 [17:22<50:44, 40.59s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.12it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.10it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.18it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  3.01it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.03it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.07it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  2.95it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:35,  2.98it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.04it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.06it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.01it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.04it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.05it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.08it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.04it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.05it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:31,  2.97it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.04it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:32,  2.82it/s][A[INFO|trainer.py:570] 2024-04-28 22:38:01,376 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:38:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:38:01 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:38:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:38:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.90it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.90it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.09it/s]04/28/2024 22:38:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:38:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8183161004431315, 'combined_score': 0.7584227561039187, 'eval_loss': 0.66159487, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [308, 330, 308, 450, 266, 235, 350, 555, 458, 274, 154, 206], 'head_nums': [5, 5, 3, 6, 5, 4, 5, 2, 1, 4, 3, 5], 'pruned_params': 76567088, 'remaining_params': 8450512, 'pruned_model_sparsity': 0.9006027928334839, 'expected_sparsity': 0.89531, 'target_sparsity': 0.95, 'step': 2900}


Iteration:  22%|██▏       | 25/115 [00:09<01:07,  1.33it/s][A04/28/2024 22:38:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 2900, Alignment: tensor([ 2,  4,  6, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:09<00:55,  1.61it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:46,  1.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:40,  2.14it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:37,  2.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:34,  2.48it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:31,  2.63it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.78it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.03it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.04it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.09it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.07it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.10it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.11it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.07it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:22,  3.14it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.13it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.15it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.21it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.17it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.15it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.16it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.15it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:18,  3.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.13it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.13it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:17,  3.20it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.24it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.22it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.20it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.19it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.12it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.10it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.11it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.06it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.05it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.08it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.07it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.09it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.08it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.11it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 22:38:18,754 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:38:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:38:18 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:38:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:38:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.88it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.89it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.89it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.89it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.90it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.90it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.09it/s]04/28/2024 22:38:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:38:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8177777777777778, 'combined_score': 0.7581535947712419, 'eval_loss': 0.820514, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [300, 329, 299, 447, 258, 235, 346, 528, 439, 265, 153, 201], 'head_nums': [5, 5, 3, 6, 4, 4, 5, 2, 1, 4, 3, 5], 'pruned_params': 76803016, 'remaining_params': 8214584, 'pruned_model_sparsity': 0.9033778417645287, 'expected_sparsity': 0.90086, 'target_sparsity': 0.95, 'step': 2950}


Iteration:  65%|██████▌   | 75/115 [00:27<00:29,  1.37it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:23,  1.65it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:19,  1.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:16,  2.22it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:14,  2.48it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:13,  2.66it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.85it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:11,  2.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  2.98it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.01it/s][A
Iteration:  74%|███████▍  | 85/115 [00:30<00:09,  3.03it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.07it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.10it/s][A
Iteration:  77%|███████▋  | 88/115 [00:31<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.05it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.06it/s][A
Iteration:  79%|███████▉  | 91/115 [00:32<00:07,  3.09it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.05it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.05it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.10it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.10it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.10it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.18it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.19it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.15it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.08it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.10it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.11it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.10it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.08it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:03,  2.97it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.02it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  2.99it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.04it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.10it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.13it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.38it/s][A04/28/2024 22:38:32 - INFO - trainer.trainer_mod_2 - Epoch 25 finished. Took 39.77 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.89it/s]
Epoch:  26%|██▌       | 26/100 [18:02<49:45, 40.35s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.95it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.06it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.11it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.13it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.11it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.14it/s][A[INFO|trainer.py:570] 2024-04-28 22:38:36,055 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:38:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:38:36 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:38:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:38:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.94it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.95it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.95it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.95it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.95it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.95it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.95it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.14it/s]04/28/2024 22:38:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:38:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8183161004431315, 'combined_score': 0.7584227561039187, 'eval_loss': 0.7272371, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [293, 328, 291, 444, 251, 234, 342, 503, 420, 257, 153, 197], 'head_nums': [4, 4, 2, 6, 4, 3, 5, 2, 1, 4, 3, 5], 'pruned_params': 77621104, 'remaining_params': 7396496, 'pruned_model_sparsity': 0.9130004140319181, 'expected_sparsity': 0.9082, 'target_sparsity': 0.95, 'step': 3000}


Iteration:   9%|▊         | 10/115 [00:04<01:17,  1.36it/s][A04/28/2024 22:38:37 - INFO - trainer.trainer_mod_2 - v4 Global step: 3000, Alignment: tensor([ 0,  4,  6, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:04<01:02,  1.65it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:53,  1.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:46,  2.17it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:41,  2.41it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:38,  2.57it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:36,  2.72it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:35,  2.76it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:33,  2.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:33,  2.90it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:33,  2.82it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.92it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.00it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:30,  3.00it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:29,  3.10it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.06it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.92it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:28,  3.05it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.11it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:27,  3.13it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.06it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.05it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:27,  2.97it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.00it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  2.99it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:26,  3.02it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.04it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.05it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.13it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.13it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.16it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.18it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:21,  3.20it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.07it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:20,  3.15it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.08it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.10it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:19,  3.16it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.16it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.13it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:18,  3.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.15it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.14it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:17,  3.17it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.15it/s][A[INFO|trainer.py:570] 2024-04-28 22:38:53,537 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:38:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:38:53 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:38:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:38:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.90it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.12it/s]04/28/2024 22:38:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:38:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6453151, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [286, 327, 282, 440, 245, 234, 338, 480, 404, 250, 153, 193], 'head_nums': [4, 3, 2, 5, 4, 3, 5, 2, 1, 4, 3, 4], 'pruned_params': 78422340, 'remaining_params': 6595260, 'pruned_model_sparsity': 0.9224247685185185, 'expected_sparsity': 0.91547, 'target_sparsity': 0.95, 'step': 3050}


Iteration:  52%|█████▏    | 60/115 [00:22<00:39,  1.40it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:32,  1.68it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:27,  1.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:20,  2.44it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:19,  2.62it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.72it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:16,  2.85it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.99it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:14,  3.03it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:13,  3.16it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:12,  3.20it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.19it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.15it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.05it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.04it/s][A
Iteration:  69%|██████▊   | 79/115 [00:28<00:11,  3.09it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:10,  3.19it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.21it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:10,  3.14it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.17it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.18it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.11it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.15it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.13it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.14it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.22it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:05,  3.18it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.18it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.11it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.11it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:04,  3.13it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.09it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:04,  2.97it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:03,  3.05it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.07it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.10it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.11it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.10it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 22:39:10,789 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:39:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:39:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:39:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:39:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.92it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.12it/s]04/28/2024 22:39:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:39:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6845506, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [279, 327, 274, 437, 243, 234, 334, 458, 388, 243, 152, 190], 'head_nums': [4, 3, 2, 5, 4, 3, 4, 2, 1, 4, 2, 4], 'pruned_params': 78642948, 'remaining_params': 6374652, 'pruned_model_sparsity': 0.925019619467028, 'expected_sparsity': 0.92142, 'target_sparsity': 0.95, 'step': 3100}


Iteration:  96%|█████████▌| 110/115 [00:39<00:03,  1.38it/s][A04/28/2024 22:39:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 3100, Alignment: tensor([ 2,  4,  6, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:39<00:02,  1.67it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  1.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:40<00:00,  2.19it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.42it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.74it/s][A04/28/2024 22:39:13 - INFO - trainer.trainer_mod_2 - Epoch 26 finished. Took 40.82 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.82it/s]
Epoch:  27%|██▋       | 27/100 [18:43<49:15, 40.49s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.12it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.12it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.18it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.26it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.22it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.19it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.12it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.06it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  3.03it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.02it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  3.02it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.92it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.95it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:34,  2.84it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:32,  2.91it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:31,  2.98it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:29,  3.11it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.14it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.16it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.12it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.10it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.09it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.12it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.15it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.17it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.23it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:24,  3.23it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.23it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:24,  3.14it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.16it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.17it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:23,  3.17it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.17it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 22:39:28,111 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:39:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:39:28 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:39:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:39:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.13it/s]04/28/2024 22:39:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:39:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6531803, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [273, 326, 266, 434, 242, 233, 330, 437, 374, 237, 152, 187], 'head_nums': [4, 2, 2, 4, 4, 3, 4, 2, 1, 4, 2, 4], 'pruned_params': 79056588, 'remaining_params': 5961012, 'pruned_model_sparsity': 0.9298849649954833, 'expected_sparsity': 0.92454, 'target_sparsity': 0.95, 'step': 3150}


Iteration:  39%|███▉      | 45/115 [00:15<00:50,  1.40it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:40,  1.68it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:34,  1.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:30,  2.19it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:27,  2.43it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:24,  2.63it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:22,  2.78it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:21,  2.93it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.03it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.12it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.17it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.18it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.15it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.14it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.16it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.03it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  3.03it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:16,  2.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.07it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.04it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.07it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.17it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.15it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.11it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.18it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.19it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.22it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.24it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.23it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.20it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.18it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.14it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.13it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.09it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.13it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.12it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.14it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.17it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.14it/s][A[INFO|trainer.py:570] 2024-04-28 22:39:45,373 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:39:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:39:45 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:39:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:39:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.94it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.94it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.94it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.88it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.90it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.91it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.91it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.12it/s]04/28/2024 22:39:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:39:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6525728, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [268, 325, 259, 431, 242, 233, 326, 418, 361, 232, 152, 184], 'head_nums': [4, 2, 2, 4, 4, 3, 4, 2, 1, 4, 2, 4], 'pruned_params': 79074972, 'remaining_params': 5942628, 'pruned_model_sparsity': 0.9301012025745258, 'expected_sparsity': 0.92867, 'target_sparsity': 0.95, 'step': 3200}


Iteration:  83%|████████▎ | 95/115 [00:33<00:14,  1.38it/s][A04/28/2024 22:39:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 3200, Alignment: tensor([ 0,  2,  6, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:33<00:11,  1.65it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:09,  1.93it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:07,  2.18it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:06,  2.39it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.59it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:05,  2.73it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  2.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:04,  2.99it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.03it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.07it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.19it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.24it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.20it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.16it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.99it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.26it/s][A04/28/2024 22:39:53 - INFO - trainer.trainer_mod_2 - Epoch 27 finished. Took 39.37 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.92it/s]
Epoch:  28%|██▊       | 28/100 [19:22<48:11, 40.15s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.11it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.11it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.15it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.20it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.15it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.14it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.18it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.17it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:30,  3.08it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.12it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.10it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.13it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.14it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.14it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.17it/s][A[INFO|trainer.py:570] 2024-04-28 22:40:02,576 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:40:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:40:02 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:40:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:40:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.12it/s]04/28/2024 22:40:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:40:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68901914, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [262, 325, 252, 428, 241, 233, 322, 401, 348, 227, 152, 181], 'head_nums': [3, 2, 2, 4, 4, 3, 3, 2, 1, 4, 2, 4], 'pruned_params': 79487080, 'remaining_params': 5530520, 'pruned_model_sparsity': 0.9349485283047275, 'expected_sparsity': 0.93264, 'target_sparsity': 0.95, 'step': 3250}


Iteration:  26%|██▌       | 30/115 [00:10<01:01,  1.38it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:50,  1.67it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:42,  1.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:37,  2.19it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:33,  2.45it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:29,  2.71it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.82it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.00it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.04it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.06it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  2.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:23,  2.96it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:23,  2.91it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:22,  2.96it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  2.99it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.05it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.09it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.10it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.09it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.11it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.11it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  2.98it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  3.00it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.06it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.10it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.06it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.10it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.11it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.04it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.09it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.19it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.15it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.20it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.21it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.20it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.22it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.21it/s][A[INFO|trainer.py:570] 2024-04-28 22:40:20,042 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:40:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:40:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:40:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:40:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.92it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.92it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.12it/s]04/28/2024 22:40:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:40:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67815596, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [258, 324, 247, 424, 241, 232, 319, 384, 337, 222, 152, 179], 'head_nums': [3, 2, 2, 3, 4, 3, 3, 2, 1, 4, 2, 3], 'pruned_params': 79696964, 'remaining_params': 5320636, 'pruned_model_sparsity': 0.9374172406654622, 'expected_sparsity': 0.93567, 'target_sparsity': 0.95, 'step': 3300}


Iteration:  70%|██████▉   | 80/115 [00:28<00:25,  1.39it/s][A04/28/2024 22:40:21 - INFO - trainer.trainer_mod_2 - v4 Global step: 3300, Alignment: tensor([ 0,  2,  6, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:28<00:20,  1.66it/s][A
Iteration:  71%|███████▏  | 82/115 [00:29<00:17,  1.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:14,  2.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:12,  2.42it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:11,  2.56it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:10,  2.71it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  2.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.04it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.07it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.17it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.26it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:06,  3.24it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:05,  3.18it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.21it/s][A
Iteration:  85%|████████▌ | 98/115 [00:34<00:05,  3.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:04,  3.23it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.24it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.23it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.22it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.17it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.18it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.23it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  2.99it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.10it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.19it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.38it/s][A04/28/2024 22:40:32 - INFO - trainer.trainer_mod_2 - Epoch 28 finished. Took 39.36 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.92it/s]
Epoch:  29%|██▉       | 29/100 [20:01<47:13, 39.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.19it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.18it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:36,  2.98it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.95it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.04it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.10it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.14it/s][A[INFO|trainer.py:570] 2024-04-28 22:40:37,246 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:40:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:40:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:40:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:40:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.91it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.12it/s]04/28/2024 22:40:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:40:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.707736, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [253, 323, 242, 421, 241, 232, 315, 369, 326, 218, 152, 176], 'head_nums': [3, 2, 2, 3, 4, 2, 3, 2, 1, 4, 2, 2], 'pruned_params': 79908380, 'remaining_params': 5109220, 'pruned_model_sparsity': 0.9399039728244505, 'expected_sparsity': 0.93774, 'target_sparsity': 0.95, 'step': 3350}


Iteration:  13%|█▎        | 15/115 [00:06<01:12,  1.37it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<01:00,  1.65it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:50,  1.93it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:44,  2.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:39,  2.43it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:37,  2.56it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:34,  2.69it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.74it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.85it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.05it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.09it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:28,  3.10it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.11it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.21it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:26,  3.19it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.14it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.17it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:24,  3.25it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.25it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.25it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.22it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.29it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:22,  3.34it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:22,  3.29it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.21it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.19it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:22,  3.16it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.17it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.18it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.20it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.20it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.19it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.17it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.20it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  3.04it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.09it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.09it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.08it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.08it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.13it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  2.99it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  3.03it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.08it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.11it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  2.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 22:40:54,509 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:40:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:40:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:40:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:40:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.94it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.93it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.12it/s]04/28/2024 22:40:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:40:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6926643, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [249, 322, 239, 418, 240, 232, 311, 355, 316, 214, 152, 174], 'head_nums': [3, 2, 2, 3, 3, 2, 3, 2, 1, 4, 2, 2], 'pruned_params': 80115200, 'remaining_params': 4902400, 'pruned_model_sparsity': 0.9423366455886781, 'expected_sparsity': 0.94131, 'target_sparsity': 0.95, 'step': 3400}


Iteration:  57%|█████▋    | 65/115 [00:23<00:36,  1.37it/s][A04/28/2024 22:40:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 3400, Alignment: tensor([0, 2, 6, 8], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:23<00:30,  1.63it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:25,  1.91it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:21,  2.16it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:19,  2.32it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:17,  2.51it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:16,  2.63it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.76it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:14,  2.88it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  2.93it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.01it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:12,  3.07it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:11,  3.17it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.17it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.21it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:10,  3.20it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.20it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.22it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.22it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.18it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.19it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.20it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:07,  3.20it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.10it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.14it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.09it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.14it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.18it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:04,  3.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.24it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.03it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  2.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.05it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.03it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.04it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.16it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.12it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  3.13it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.17it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 22:41:11,763 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:41:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:41:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:41:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:41:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.97it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.98it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.97it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00,  9.97it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00,  9.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00,  9.93it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00,  9.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.95it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00,  9.96it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:01<00:00,  9.96it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00,  9.97it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00,  9.97it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.16it/s]04/28/2024 22:41:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:41:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8111273792093704, 'combined_score': 0.7474754543105675, 'eval_loss': 0.64454114, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 321, 236, 415, 240, 231, 307, 341, 307, 211, 152, 172], 'head_nums': [3, 2, 2, 3, 3, 2, 3, 2, 1, 4, 2, 2], 'pruned_params': 80487476, 'remaining_params': 4530124, 'pruned_model_sparsity': 0.9467154565642879, 'expected_sparsity': 0.94551, 'target_sparsity': 0.95, 'step': 3450}


Iteration: 100%|██████████| 115/115 [00:40<00:00,  1.43it/s][A04/28/2024 22:41:13 - INFO - trainer.trainer_mod_2 - Epoch 29 finished. Took 40.72 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.82it/s]
Epoch:  30%|███       | 30/100 [20:42<46:50, 40.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.20it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.13it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.01it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.05it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.11it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.10it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.08it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.15it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.09it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.11it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.13it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.15it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.14it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.13it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.17it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:29,  3.16it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.16it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.18it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.20it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.17it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.21it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.19it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.21it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.21it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:25,  3.20it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.18it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.13it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.14it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.17it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.19it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:24,  3.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:24,  3.15it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:24,  3.12it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.06it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:23,  3.06it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:23,  3.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.12it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:22,  3.14it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:22,  3.07it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:21,  3.13it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:21,  3.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.19it/s][A[INFO|trainer.py:570] 2024-04-28 22:41:28,981 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:41:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:41:28 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:41:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:41:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.97it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.02it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.21it/s]04/28/2024 22:41:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:41:30 - INFO - trainer.trainer_mod_2 - Starting saving the best from epoch 30 and step 3500
04/28/2024 22:41:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.689956, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [242, 321, 234, 411, 239, 231, 304, 329, 298, 207, 151, 170], 'head_nums': [2, 2, 2, 3, 2, 2, 3, 2, 1, 4, 2, 2], 'pruned_params': 81277988, 'remaining_params': 3739612, 'pruned_model_sparsity': 0.9560136724631135, 'expected_sparsity': 0.95059, 'target_sparsity': 0.95, 'step': 3500}
04/28/2024 22:41:30 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 30 | Step: 3500 | Model size: 3739612 | Score: 0.68382]

[INFO|configuration_utils.py:439] 2024-04-28 22:41:30,323 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 22:41:31,147 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/pytorch_model.bin

Iteration:  43%|████▎     | 50/115 [00:18<01:02,  1.04it/s][A04/28/2024 22:41:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 3500, Alignment: tensor([ 2,  3,  5, 10], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:18<00:49,  1.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:39,  1.59it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:33,  1.88it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:28,  2.14it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:25,  2.38it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:22,  2.59it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:20,  2.76it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:19,  2.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.08it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.12it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.14it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:16,  3.14it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.17it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.14it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.18it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.05it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.10it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.11it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.20it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.17it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.19it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.17it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:12,  2.93it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  2.97it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  3.07it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.09it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.14it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  3.08it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.25it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.05it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.13it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.11it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.15it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.07it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.08it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.10it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.10it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 22:41:47,143 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:41:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:41:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:41:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:41:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.01it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.20it/s]04/28/2024 22:41:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:41:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.68006635, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [238, 320, 233, 408, 239, 231, 300, 318, 290, 204, 151, 169], 'head_nums': [2, 2, 2, 3, 2, 2, 3, 2, 1, 4, 2, 2], 'pruned_params': 81284116, 'remaining_params': 3733484, 'pruned_model_sparsity': 0.9560857516561276, 'expected_sparsity': 0.95446, 'target_sparsity': 0.95, 'step': 3550}


Iteration:  87%|████████▋ | 100/115 [00:35<00:10,  1.37it/s][A
Iteration:  88%|████████▊ | 101/115 [00:35<00:08,  1.66it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:06,  1.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:05,  2.21it/s][A
Iteration:  90%|█████████ | 104/115 [00:36<00:04,  2.42it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  2.65it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:03,  2.66it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  2.67it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  2.79it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.88it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.98it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.02it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.06it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.07it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.31it/s][A04/28/2024 22:41:53 - INFO - trainer.trainer_mod_2 - Epoch 30 finished. Took 40.16 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.86it/s]
Epoch:  31%|███       | 31/100 [21:22<46:10, 40.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.17it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.20it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.16it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.18it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.13it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.16it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.19it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.27it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.24it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.20it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.11it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.13it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.12it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.21it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.17it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.21it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.27it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:29,  3.06it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.06it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:28,  3.10it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  2.98it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.04it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:27,  3.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.00it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.06it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:26,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 22:42:04,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:42:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:42:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:42:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:42:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01, 10.00it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.01it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.21it/s]04/28/2024 22:42:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:42:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6657617, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [234, 319, 232, 405, 239, 230, 297, 307, 282, 201, 151, 167], 'head_nums': [2, 2, 2, 3, 1, 2, 2, 2, 1, 4, 2, 1], 'pruned_params': 81682436, 'remaining_params': 3335164, 'pruned_model_sparsity': 0.9607708992020476, 'expected_sparsity': 0.95943, 'target_sparsity': 0.95, 'step': 3600}


Iteration:  30%|███       | 35/115 [00:12<00:57,  1.39it/s][A04/28/2024 22:42:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 3600, Alignment: tensor([ 3,  4,  5, 10], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:12<00:47,  1.67it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:39,  1.96it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:34,  2.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:30,  2.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:28,  2.64it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.80it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.94it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.02it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.07it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.13it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.18it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.13it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.17it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.14it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.15it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.18it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.18it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  2.99it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.03it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.17it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.19it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.10it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.11it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.12it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.10it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.14it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.16it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.18it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.20it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.17it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.12it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.12it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.05it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.08it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.11it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.12it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  3.09it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.14it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.14it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 22:42:21,569 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:42:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:42:21 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:42:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:42:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.01it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.02it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.21it/s]04/28/2024 22:42:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:42:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67892534, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [231, 318, 232, 401, 238, 230, 293, 298, 275, 199, 151, 166], 'head_nums': [2, 2, 2, 2, 1, 2, 2, 2, 1, 4, 2, 1], 'pruned_params': 81883128, 'remaining_params': 3134472, 'pruned_model_sparsity': 0.963131492773261, 'expected_sparsity': 0.96246, 'target_sparsity': 0.95, 'step': 3650}


Iteration:  74%|███████▍  | 85/115 [00:29<00:21,  1.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:17,  1.69it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:14,  1.98it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:12,  2.22it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.41it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:09,  2.61it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:08,  2.79it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.90it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.08it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.09it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.11it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.06it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.17it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.18it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.02it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.08it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.14it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.17it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.21it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.17it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.17it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.19it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.14it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.11it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.35it/s][A04/28/2024 22:42:32 - INFO - trainer.trainer_mod_2 - Epoch 31 finished. Took 39.15 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.94it/s]
Epoch:  32%|███▏      | 32/100 [22:01<45:10, 39.86s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.14it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.14it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.14it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.11it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.08it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.11it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.26it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.22it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.23it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.23it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.24it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.22it/s][A[INFO|trainer.py:570] 2024-04-28 22:42:38,715 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:42:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:42:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:42:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:42:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.01it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.20it/s]04/28/2024 22:42:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:42:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6537679, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 317, 231, 398, 238, 229, 290, 289, 269, 196, 151, 165], 'head_nums': [2, 2, 2, 2, 1, 2, 2, 2, 1, 4, 2, 1], 'pruned_params': 81887724, 'remaining_params': 3129876, 'pruned_model_sparsity': 0.9631855521680217, 'expected_sparsity': 0.96355, 'target_sparsity': 0.95, 'step': 3700}


Iteration:  17%|█▋        | 20/115 [00:07<01:07,  1.40it/s][A04/28/2024 22:42:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 3700, Alignment: tensor([ 2,  3,  5, 10], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:07<00:56,  1.66it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:47,  1.95it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:41,  2.21it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:37,  2.44it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:34,  2.62it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:32,  2.77it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:28,  3.03it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.08it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.08it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.10it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.18it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.17it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.10it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.02it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.11it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.06it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.07it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.11it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.18it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.99it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.05it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.08it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.11it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.15it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.25it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.24it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.05it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:20,  3.00it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.06it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.09it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.11it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.10it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.15it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.13it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.15it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.23it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.05it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.07it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.08it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 22:42:56,072 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:42:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:42:56 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:42:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:42:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01, 10.00it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.02it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.02it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.21it/s]04/28/2024 22:42:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:42:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66568935, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [226, 316, 231, 395, 238, 229, 287, 281, 262, 194, 151, 164], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 2, 1, 4, 2, 1], 'pruned_params': 82086884, 'remaining_params': 2930716, 'pruned_model_sparsity': 0.9655281259409816, 'expected_sparsity': 0.96417, 'target_sparsity': 0.95, 'step': 3750}


Iteration:  61%|██████    | 70/115 [00:24<00:32,  1.39it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:26,  1.67it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:21,  1.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:18,  2.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:16,  2.41it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:15,  2.65it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:14,  2.76it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:13,  2.89it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.00it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.08it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.11it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.20it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.18it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.17it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.14it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.25it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.26it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.25it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.21it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.04it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.11it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.02it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.15it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.17it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.18it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.20it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.22it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.16it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.06it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.19it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.16it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.12it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.11it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.12it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.15it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.12it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.16it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.43it/s][A04/28/2024 22:43:11 - INFO - trainer.trainer_mod_2 - Epoch 32 finished. Took 39.11 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.94it/s]
Epoch:  33%|███▎      | 33/100 [22:41<44:15, 39.63s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.03it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.86it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 22:43:13,150 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:43:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:43:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:43:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:43:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.99it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.00it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.20it/s]04/28/2024 22:43:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:43:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6638994, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [224, 316, 231, 392, 237, 229, 283, 273, 256, 192, 151, 163], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 2, 1, 4, 2, 1], 'pruned_params': 82089948, 'remaining_params': 2927652, 'pruned_model_sparsity': 0.9655641655374887, 'expected_sparsity': 0.96521, 'target_sparsity': 0.95, 'step': 3800}


Iteration:   4%|▍         | 5/115 [00:02<01:27,  1.25it/s][A04/28/2024 22:43:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 3800, Alignment: tensor([1, 1, 7, 8], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:09,  1.58it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:57,  1.89it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:49,  2.17it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:43,  2.42it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:40,  2.61it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:36,  2.82it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:35,  2.93it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:33,  2.98it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:33,  3.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:32,  3.02it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:31,  3.08it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:31,  3.13it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.22it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:30,  3.08it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.12it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.17it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.20it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.20it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.18it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.14it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.14it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.14it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.16it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.20it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.17it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.18it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.23it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.23it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.29it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.33it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.29it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.08it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.12it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.15it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.13it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.22it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.16it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.12it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  3.04it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 22:43:30,293 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:43:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:43:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:43:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:43:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.04it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.03it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.03it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.04it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.04it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.05it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.24it/s]04/28/2024 22:43:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:43:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8116788321167884, 'combined_score': 0.7477511807642765, 'eval_loss': 0.6797113, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [222, 315, 230, 389, 237, 228, 280, 266, 251, 189, 151, 162], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 2, 1, 4, 2, 1], 'pruned_params': 82485204, 'remaining_params': 2532396, 'pruned_model_sparsity': 0.9702132734869016, 'expected_sparsity': 0.96825, 'target_sparsity': 0.95, 'step': 3850}


Iteration:  48%|████▊     | 55/115 [00:20<00:44,  1.36it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:36,  1.63it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:29,  1.94it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:26,  2.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:23,  2.43it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:20,  2.64it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.73it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  2.99it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.18it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.20it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.04it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.09it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:13,  3.19it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.14it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.15it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.16it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.19it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.11it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.14it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.11it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.16it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.16it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.13it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.16it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.19it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.05it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.17it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.18it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.24it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.21it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.23it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:05,  3.17it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.25it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.23it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.21it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.19it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 22:43:47,457 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:43:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:43:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:43:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:43:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.05it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.05it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.24it/s]04/28/2024 22:43:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:43:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6813725490196079, 'f1': 0.8104956268221574, 'combined_score': 0.7459340879208827, 'eval_loss': 0.6701651, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [220, 314, 230, 385, 236, 228, 277, 260, 246, 187, 151, 161], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 2, 1, 4, 2, 1], 'pruned_params': 82488268, 'remaining_params': 2529332, 'pruned_model_sparsity': 0.9702493130834086, 'expected_sparsity': 0.9711, 'target_sparsity': 0.95, 'step': 3900}


Iteration:  91%|█████████▏| 105/115 [00:37<00:07,  1.38it/s][A04/28/2024 22:43:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 3900, Alignment: tensor([ 4,  5,  6, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:37<00:05,  1.65it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:04,  1.92it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:03,  2.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.41it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.53it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.67it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  2.83it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  3.02it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.30it/s][A04/28/2024 22:43:51 - INFO - trainer.trainer_mod_2 - Epoch 33 finished. Took 40.37 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.85it/s]
Epoch:  34%|███▍      | 34/100 [23:21<43:50, 39.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.27it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.24it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.29it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.22it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.22it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.17it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.16it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.16it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.05it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.16it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.15it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.14it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.10it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.14it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.23it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.14it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.22it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.23it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.14it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.17it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.24it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:25,  3.24it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.22it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.23it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.23it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.24it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.21it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.22it/s][A[INFO|trainer.py:570] 2024-04-28 22:44:04,456 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:44:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:44:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:44:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:44:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.05it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.25it/s]04/28/2024 22:44:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:44:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6813725490196079, 'f1': 0.8104956268221574, 'combined_score': 0.7459340879208827, 'eval_loss': 0.67094976, 'head_layers': [0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [218, 313, 230, 382, 236, 227, 274, 253, 241, 185, 151, 160], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 2, 1, 3, 2, 1], 'pruned_params': 82491332, 'remaining_params': 2526268, 'pruned_model_sparsity': 0.9702853526799157, 'expected_sparsity': 0.97282, 'target_sparsity': 0.95, 'step': 3950}


Iteration:  35%|███▍      | 40/115 [00:13<00:53,  1.40it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:44,  1.68it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:37,  1.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:32,  2.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:28,  2.46it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:27,  2.54it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:25,  2.70it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.97it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.02it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.09it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.15it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.17it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.21it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.23it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.22it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:19,  3.10it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.05it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.08it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.06it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.13it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.13it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.01it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.10it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.12it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.21it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.22it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.17it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.24it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.27it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.14it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.12it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.13it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.16it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.18it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.30it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.23it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.25it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.20it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.15it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.24it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.23it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.16it/s][A[INFO|trainer.py:570] 2024-04-28 22:44:21,556 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:44:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:44:21 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:44:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:44:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 22:44:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:44:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66910666, 'head_layers': [0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [216, 312, 230, 379, 236, 227, 271, 248, 237, 184, 151, 159], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 2, 1, 3, 2, 1], 'pruned_params': 82886588, 'remaining_params': 2131012, 'pruned_model_sparsity': 0.9749344606293285, 'expected_sparsity': 0.97448, 'target_sparsity': 0.95, 'step': 4000}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.40it/s][A04/28/2024 22:44:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 4000, Alignment: tensor([ 2,  4,  5, 10], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:31<00:14,  1.69it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:11,  1.97it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:10,  2.14it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:08,  2.38it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:07,  2.57it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:07,  2.71it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:06,  2.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:06,  2.82it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  2.91it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.98it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.06it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.07it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.06it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  2.93it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.02it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.07it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.10it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.12it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.16it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.22it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.24it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.33it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.30it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.35it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.60it/s][A04/28/2024 22:44:30 - INFO - trainer.trainer_mod_2 - Epoch 34 finished. Took 38.84 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  35%|███▌      | 35/100 [24:00<42:50, 39.55s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.31it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.25it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.16it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.16it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.24it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.22it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.21it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.15it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.16it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.16it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.23it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.25it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.22it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.26it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 22:44:38,530 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:44:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:44:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:44:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:44:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.08it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/28/2024 22:44:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:44:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.65528727, 'head_layers': [0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [215, 311, 229, 376, 235, 227, 268, 243, 233, 182, 151, 159], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 2, 1, 3, 2, 1], 'pruned_params': 82888120, 'remaining_params': 2129480, 'pruned_model_sparsity': 0.9749524804275821, 'expected_sparsity': 0.97529, 'target_sparsity': 0.95, 'step': 4050}


Iteration:  22%|██▏       | 25/115 [00:09<01:03,  1.41it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:52,  1.70it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:44,  1.97it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:38,  2.26it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:34,  2.49it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:32,  2.65it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:29,  2.81it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.95it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.04it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.04it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.02it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.06it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.26it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.24it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.12it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.17it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.26it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.27it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.20it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.28it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.19it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.24it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.21it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.22it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.09it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.16it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.19it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.18it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:19,  2.98it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:19,  2.88it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  2.97it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:18,  2.97it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  3.06it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.12it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.15it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.17it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.23it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.24it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.24it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.21it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.33it/s][A[INFO|trainer.py:570] 2024-04-28 22:44:55,560 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:44:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:44:55 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:44:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:44:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/28/2024 22:44:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:44:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6679435, 'head_layers': [0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [214, 310, 229, 373, 235, 226, 265, 238, 230, 180, 151, 158], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 3, 2, 1], 'pruned_params': 83085748, 'remaining_params': 1931852, 'pruned_model_sparsity': 0.9772770344022884, 'expected_sparsity': 0.97622, 'target_sparsity': 0.95, 'step': 4100}


Iteration:  65%|██████▌   | 75/115 [00:26<00:27,  1.43it/s][A04/28/2024 22:44:57 - INFO - trainer.trainer_mod_2 - v4 Global step: 4100, Alignment: tensor([ 2,  2,  5, 10], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:26<00:22,  1.71it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:19,  1.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:17,  2.15it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:15,  2.39it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:13,  2.61it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:12,  2.72it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.81it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  2.92it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.06it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.10it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.11it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.18it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.18it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.16it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.12it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.13it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.10it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.11it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.20it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.04it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.06it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.22it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.21it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.20it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.19it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.22it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.38it/s][A04/28/2024 22:45:09 - INFO - trainer.trainer_mod_2 - Epoch 35 finished. Took 38.77 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.97it/s]
Epoch:  36%|███▌      | 36/100 [24:38<41:56, 39.31s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.22it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.25it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.21it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.23it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.25it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 22:45:12,601 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:45:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:45:12 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:45:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:45:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/28/2024 22:45:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:45:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66056234, 'head_layers': [0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [212, 310, 229, 370, 234, 226, 263, 234, 227, 179, 151, 157], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], 'pruned_params': 83088812, 'remaining_params': 1928788, 'pruned_model_sparsity': 0.9773130739987955, 'expected_sparsity': 0.97712, 'target_sparsity': 0.95, 'step': 4150}


Iteration:   9%|▊         | 10/115 [00:04<01:14,  1.40it/s][A
Iteration:  10%|▉         | 11/115 [00:04<01:01,  1.70it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:52,  1.98it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:45,  2.24it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:41,  2.45it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:37,  2.64it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:37,  2.65it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.81it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:34,  2.82it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:32,  2.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:31,  2.99it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.12it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.16it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.22it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.20it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.30it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:25,  3.25it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.19it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.11it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.09it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.11it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.09it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.12it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.14it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.18it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.13it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.20it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.15it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.16it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.20it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.20it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.09it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.11it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.09it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.10it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  2.95it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.04it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.10it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.13it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.15it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:18,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 22:45:29,861 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:45:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:45:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:45:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:45:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/28/2024 22:45:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:45:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.69224674, 'head_layers': [0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [211, 309, 229, 367, 234, 225, 260, 229, 223, 178, 151, 157], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], 'pruned_params': 83090344, 'remaining_params': 1927256, 'pruned_model_sparsity': 0.9773310937970491, 'expected_sparsity': 0.97748, 'target_sparsity': 0.95, 'step': 4200}


Iteration:  52%|█████▏    | 60/115 [00:21<00:39,  1.39it/s][A04/28/2024 22:45:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 4200, Alignment: tensor([2, 2, 2, 2], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:21<00:32,  1.68it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:26,  1.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:19,  2.62it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.78it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.86it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.03it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.16it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.20it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:12,  3.27it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.27it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:11,  3.28it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.29it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.27it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:10,  3.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.20it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.19it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.26it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.26it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.10it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.15it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.18it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.11it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.09it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.06it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.03it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.09it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.08it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.07it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.06it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.15it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.20it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.18it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.23it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.19it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.17it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.13it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.16it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.13it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.15it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.30it/s][A[INFO|trainer.py:570] 2024-04-28 22:45:46,862 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:45:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:45:46 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:45:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:45:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/28/2024 22:45:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:45:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66801363, 'head_layers': [0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [209, 308, 228, 364, 234, 225, 257, 226, 220, 176, 151, 156], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], 'pruned_params': 83093408, 'remaining_params': 1924192, 'pruned_model_sparsity': 0.9773671333935562, 'expected_sparsity': 0.97772, 'target_sparsity': 0.95, 'step': 4250}


Iteration:  96%|█████████▌| 110/115 [00:38<00:03,  1.42it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:02,  1.69it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  1.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.23it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.35it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.71it/s][A04/28/2024 22:45:49 - INFO - trainer.trainer_mod_2 - Epoch 36 finished. Took 40.24 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.86it/s]
Epoch:  37%|███▋      | 37/100 [25:19<41:34, 39.59s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.31it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.28it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.21it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.31it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.25it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.30it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.22it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.30it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.29it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.21it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.22it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.13it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.10it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:31,  3.15it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.21it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.23it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.19it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.16it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.14it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.17it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.26it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.21it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.22it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.20it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:26,  3.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.11it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.16it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:25,  3.14it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:26,  2.93it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:25,  3.00it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:24,  3.08it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:23,  3.12it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:23,  3.13it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.13it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.22it/s][A[INFO|trainer.py:570] 2024-04-28 22:46:03,913 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:46:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:46:03 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:46:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:46:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/28/2024 22:46:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:46:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6759075, 'head_layers': [0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [208, 307, 228, 361, 233, 224, 255, 222, 218, 175, 151, 156], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], 'pruned_params': 83094940, 'remaining_params': 1922660, 'pruned_model_sparsity': 0.9773851531918097, 'expected_sparsity': 0.97806, 'target_sparsity': 0.95, 'step': 4300}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.41it/s][A04/28/2024 22:46:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 4300, Alignment: tensor([ 2,  2,  5, 10], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:15<00:40,  1.70it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:34,  1.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:29,  2.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.48it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:24,  2.68it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:22,  2.84it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.00it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.15it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.19it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.19it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.22it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.24it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.25it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.17it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.15it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.15it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.16it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.13it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.16it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.19it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.22it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.11it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:14,  3.04it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.10it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.14it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.16it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.12it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.14it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.19it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.05it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:11,  3.07it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.11it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.16it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.02it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.09it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:09,  3.11it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.26it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.18it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.16it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:07,  3.14it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.17it/s][A[INFO|trainer.py:570] 2024-04-28 22:46:21,014 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:46:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:46:21 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:46:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:46:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.28it/s]04/28/2024 22:46:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:46:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6700184, 'head_layers': [0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [207, 306, 228, 358, 233, 224, 252, 219, 215, 174, 151, 155], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], 'pruned_params': 83096472, 'remaining_params': 1921128, 'pruned_model_sparsity': 0.9774031729900632, 'expected_sparsity': 0.97895, 'target_sparsity': 0.95, 'step': 4350}


Iteration:  83%|████████▎ | 95/115 [00:32<00:14,  1.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.66it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:09,  1.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:07,  2.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.45it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.69it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.82it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.95it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.11it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.15it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.16it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.25it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.25it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.00it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.91it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  2.92it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.19it/s][A04/28/2024 22:46:28 - INFO - trainer.trainer_mod_2 - Epoch 37 finished. Took 38.86 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  38%|███▊      | 38/100 [25:58<40:41, 39.37s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.28it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.33it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.18it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.13it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.10it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.94it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.01it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.15it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.21it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.23it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.21it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.04it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.11it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.12it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.14it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.08it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.10it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.15it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.21it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.19it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 22:46:38,180 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:46:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:46:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:46:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:46:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.08it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 22:46:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:46:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.66531706, 'head_layers': [0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [206, 305, 228, 355, 232, 224, 250, 216, 213, 173, 151, 155], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], 'pruned_params': 83098004, 'remaining_params': 1919596, 'pruned_model_sparsity': 0.9774211927883167, 'expected_sparsity': 0.98059, 'target_sparsity': 0.95, 'step': 4400}


Iteration:  26%|██▌       | 30/115 [00:10<01:01,  1.39it/s][A04/28/2024 22:46:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 4400, Alignment: tensor([2, 2, 2, 2], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:11<00:50,  1.68it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:42,  1.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:36,  2.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:33,  2.45it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:30,  2.66it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.83it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.81it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.88it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:26,  2.85it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  2.89it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  2.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  3.03it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.06it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.13it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.14it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:21,  3.17it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.20it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:19,  3.29it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.34it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.09it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.17it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.19it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.26it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.26it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.20it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.07it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.14it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.17it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.18it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.16it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.17it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.21it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  3.03it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.01it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.09it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.13it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.07it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.04it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.14it/s][A[INFO|trainer.py:570] 2024-04-28 22:46:55,391 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:46:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:46:55 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:46:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:46:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.32it/s]04/28/2024 22:46:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:46:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.65808076, 'head_layers': [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [205, 304, 227, 352, 232, 223, 248, 213, 210, 172, 151, 154], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], 'pruned_params': 83491728, 'remaining_params': 1525872, 'pruned_model_sparsity': 0.982052280939476, 'expected_sparsity': 0.98208, 'target_sparsity': 0.95, 'step': 4450}


Iteration:  70%|██████▉   | 80/115 [00:28<00:25,  1.39it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:20,  1.68it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  1.95it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:14,  2.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:12,  2.43it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:11,  2.59it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:11,  2.64it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:10,  2.79it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  2.97it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.05it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.19it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.14it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.16it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:05,  3.25it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.24it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.15it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.19it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.20it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.23it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.22it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.24it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.30it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:02,  3.35it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.30it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.24it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.26it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.37it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.31it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.27it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.29it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.26it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.54it/s][A04/28/2024 22:47:07 - INFO - trainer.trainer_mod_2 - Epoch 38 finished. Took 38.88 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  39%|███▉      | 39/100 [26:36<39:52, 39.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.22it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.02it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.09it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.14it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.17it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.17it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.16it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 22:47:12,234 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:47:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:47:12 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:47:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:47:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 22:47:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:47:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.65505713, 'head_layers': [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [204, 304, 227, 349, 232, 223, 246, 210, 208, 171, 151, 154], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], 'pruned_params': 83493260, 'remaining_params': 1524340, 'pruned_model_sparsity': 0.9820703007377296, 'expected_sparsity': 0.98289, 'target_sparsity': 0.95, 'step': 4500}


Iteration:  13%|█▎        | 15/115 [00:06<01:11,  1.40it/s][A04/28/2024 22:47:13 - INFO - trainer.trainer_mod_2 - v4 Global step: 4500, Alignment: tensor([4, 4, 5, 7], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<00:58,  1.68it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:49,  1.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:43,  2.22it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:39,  2.43it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:36,  2.60it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.62it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.75it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.84it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  2.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.12it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.06it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.08it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.07it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.08it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.14it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.16it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.19it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.08it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.16it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.19it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.16it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:25,  3.00it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.00it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.06it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.08it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.14it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.16it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:21,  3.20it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.26it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.24it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.31it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:19,  3.31it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.36it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.31it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:18,  3.29it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.24it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.22it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.30it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.21it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.23it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:15,  3.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.21it/s][A[INFO|trainer.py:570] 2024-04-28 22:47:29,344 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:47:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:47:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:47:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:47:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.15it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.16it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.36it/s]04/28/2024 22:47:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:47:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6517506, 'head_layers': [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [204, 303, 227, 346, 231, 222, 244, 207, 206, 170, 151, 154], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], 'pruned_params': 83493260, 'remaining_params': 1524340, 'pruned_model_sparsity': 0.9820703007377296, 'expected_sparsity': 0.98327, 'target_sparsity': 0.95, 'step': 4550}


Iteration:  57%|█████▋    | 65/115 [00:23<00:35,  1.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:28,  1.71it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:20,  2.30it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.53it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:16,  2.66it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.06it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.10it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.14it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.20it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.17it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.17it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.21it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.25it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.24it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:09,  3.31it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.29it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.26it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.24it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.08it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.10it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.11it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.09it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.16it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.18it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.08it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.06it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  2.97it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.10it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.20it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.22it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.22it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.20it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.22it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.23it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.15it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.23it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.25it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.20it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.25it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.25it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.26it/s][A[INFO|trainer.py:570] 2024-04-28 22:47:46,162 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:47:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:47:46 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:47:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:47:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.08it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 22:47:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:47:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.661842, 'head_layers': [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [203, 302, 227, 344, 231, 222, 242, 205, 204, 169, 151, 153], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83494792, 'remaining_params': 1522808, 'pruned_model_sparsity': 0.9820883205359832, 'expected_sparsity': 0.98358, 'target_sparsity': 0.95, 'step': 4600}


Iteration: 100%|██████████| 115/115 [00:40<00:00,  1.46it/s][A04/28/2024 22:47:47 - INFO - trainer.trainer_mod_2 - Epoch 39 finished. Took 40.0 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.87it/s]
Epoch:  40%|████      | 40/100 [27:16<39:27, 39.46s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 22:47:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 4600, Alignment: tensor([ 4,  4,  5, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:36,  3.12it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:38,  2.90it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.04it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.08it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.11it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.19it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.17it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.07it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.17it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.15it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.24it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.23it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.15it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:32,  2.98it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.13it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.22it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:28,  3.24it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.24it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.19it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.20it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.19it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:25,  3.23it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.14it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.20it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:24,  3.23it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.25it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.24it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:25,  3.06it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.17it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.17it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:23,  3.20it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.21it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:21,  3.25it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:21,  3.26it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:20,  3.29it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:20,  3.26it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 22:48:03,218 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:48:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:48:03 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:48:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:48:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.12it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.32it/s]04/28/2024 22:48:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:48:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.65071374, 'head_layers': [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [202, 301, 226, 341, 231, 222, 240, 203, 202, 168, 150, 153], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83497856, 'remaining_params': 1519744, 'pruned_model_sparsity': 0.9821243601324902, 'expected_sparsity': 0.98408, 'target_sparsity': 0.95, 'step': 4650}


Iteration:  43%|████▎     | 50/115 [00:17<00:45,  1.42it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:37,  1.71it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:31,  1.99it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:27,  2.24it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:25,  2.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:22,  2.62it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:21,  2.78it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:20,  2.88it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.11it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.23it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:15,  3.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.27it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.20it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.19it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.21it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.23it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.24it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.24it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.21it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.19it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.17it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.18it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.20it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.11it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.17it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.21it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.20it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.26it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.22it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.23it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.18it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.22it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.15it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.14it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.16it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:05,  3.21it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.02it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.12it/s][A[INFO|trainer.py:570] 2024-04-28 22:48:20,165 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:48:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:48:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:48:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:48:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.15it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.16it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.36it/s]04/28/2024 22:48:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:48:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6659637, 'head_layers': [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [202, 300, 226, 338, 230, 221, 238, 201, 201, 167, 150, 153], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83727656, 'remaining_params': 1289944, 'pruned_model_sparsity': 0.9848273298705209, 'expected_sparsity': 0.98491, 'target_sparsity': 0.95, 'step': 4700}


Iteration:  87%|████████▋ | 100/115 [00:33<00:10,  1.40it/s][A04/28/2024 22:48:21 - INFO - trainer.trainer_mod_2 - v4 Global step: 4700, Alignment: tensor([ 2,  2,  5, 10], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:34<00:08,  1.65it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  1.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:05,  2.21it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:04,  2.42it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.63it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:03,  2.83it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.10it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.10it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.11it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.14it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.40it/s][A04/28/2024 22:48:26 - INFO - trainer.trainer_mod_2 - Epoch 40 finished. Took 38.63 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.98it/s]
Epoch:  41%|████      | 41/100 [27:55<38:33, 39.21s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.94it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.12it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.22it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.13it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.13it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.19it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.07it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.14it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.19it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.28it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.21it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.29it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.28it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.19it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.17it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.13it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.19it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.29it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.25it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.23it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.22it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:26,  3.34it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.31it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.30it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.26it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.07it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:27,  3.09it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.11it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.17it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.17it/s][A[INFO|trainer.py:570] 2024-04-28 22:48:37,054 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:48:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:48:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:48:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:48:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.16it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.36it/s]04/28/2024 22:48:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:48:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6413069, 'head_layers': [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 300, 226, 336, 230, 221, 236, 199, 199, 167, 150, 152], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83729188, 'remaining_params': 1288412, 'pruned_model_sparsity': 0.9848453496687745, 'expected_sparsity': 0.98568, 'target_sparsity': 0.95, 'step': 4750}


Iteration:  30%|███       | 35/115 [00:12<00:56,  1.43it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:46,  1.71it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:39,  1.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:34,  2.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:31,  2.41it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:28,  2.60it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.77it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.09it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  2.97it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.02it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.06it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.16it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.21it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.21it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.18it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.19it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.20it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.21it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.22it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.27it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.26it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.21it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.22it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.27it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.31it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.25it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.23it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.19it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.19it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.21it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.20it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.13it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.27it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.30it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.30it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.29it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.29it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.27it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.11it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.13it/s][A[INFO|trainer.py:570] 2024-04-28 22:48:53,955 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:48:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:48:53 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:48:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:48:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.13it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.15it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.35it/s]04/28/2024 22:48:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:48:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6614595, 'head_layers': [0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 299, 226, 333, 229, 220, 234, 197, 197, 166, 150, 152], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83729188, 'remaining_params': 1288412, 'pruned_model_sparsity': 0.9848453496687745, 'expected_sparsity': 0.9862, 'target_sparsity': 0.95, 'step': 4800}


Iteration:  74%|███████▍  | 85/115 [00:29<00:21,  1.40it/s][A04/28/2024 22:48:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 4800, Alignment: tensor([2, 2, 2, 2], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:29<00:17,  1.67it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:14,  1.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:12,  2.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.43it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:09,  2.64it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:08,  2.78it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  2.90it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.02it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.08it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.18it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.31it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.32it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.34it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.27it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.23it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.28it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.26it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.27it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.25it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.25it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.05it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.32it/s][A04/28/2024 22:49:04 - INFO - trainer.trainer_mod_2 - Epoch 41 finished. Took 38.5 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.99it/s]
Epoch:  42%|████▏     | 42/100 [28:34<37:41, 39.00s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:31,  3.61it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.42it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.36it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.32it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.29it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.21it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.25it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.23it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.19it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.20it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.26it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.25it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:29,  3.41it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.34it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.28it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.31it/s][A[INFO|trainer.py:570] 2024-04-28 22:49:10,689 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:49:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:49:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:49:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:49:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:49:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:49:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6495134, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 298, 225, 330, 229, 220, 233, 195, 196, 165, 150, 152], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83925284, 'remaining_params': 1092316, 'pruned_model_sparsity': 0.9871518838452273, 'expected_sparsity': 0.98658, 'target_sparsity': 0.95, 'step': 4850}


Iteration:  17%|█▋        | 20/115 [00:07<01:05,  1.44it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:54,  1.73it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:45,  2.02it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:39,  2.31it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:36,  2.52it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:33,  2.67it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.81it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.99it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:28,  3.10it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.15it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.13it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.05it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.16it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:27,  2.98it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.07it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.13it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.16it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.20it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.15it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.16it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.17it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:22,  3.08it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.22it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.27it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.39it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.42it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.34it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.27it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:16,  3.36it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.40it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.34it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.24it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.20it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.30it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.27it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.36it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.30it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.19it/s][A[INFO|trainer.py:570] 2024-04-28 22:49:27,455 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:49:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:49:27 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:49:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:49:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.19it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:49:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:49:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.63446945, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 297, 225, 328, 229, 220, 231, 194, 195, 165, 150, 152], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83925284, 'remaining_params': 1092316, 'pruned_model_sparsity': 0.9871518838452273, 'expected_sparsity': 0.98683, 'target_sparsity': 0.95, 'step': 4900}


Iteration:  61%|██████    | 70/115 [00:24<00:31,  1.42it/s][A04/28/2024 22:49:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 4900, Alignment: tensor([1, 1, 1, 9], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:24<00:25,  1.71it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:22,  1.93it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:19,  2.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:17,  2.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:15,  2.57it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:14,  2.77it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  2.93it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.03it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.13it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.19it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.21it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.24it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.19it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.03it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.09it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:07,  3.28it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.38it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.35it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:06,  3.34it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.32it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.28it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.29it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.33it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.29it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.36it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.34it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.14it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.13it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.21it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.23it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.29it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.31it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.24it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.29it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.25it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.22it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.47it/s][A04/28/2024 22:49:42 - INFO - trainer.trainer_mod_2 - Epoch 42 finished. Took 38.0 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.03it/s]
Epoch:  43%|████▎     | 43/100 [29:12<36:45, 38.70s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.35it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 22:49:44,170 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:49:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:49:44 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:49:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:49:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.23it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:49:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:49:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.67084485, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 297, 225, 326, 228, 219, 230, 192, 193, 164, 150, 152], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98697, 'target_sparsity': 0.95, 'step': 4950}


Iteration:   4%|▍         | 5/115 [00:02<01:26,  1.28it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:07,  1.62it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:55,  1.96it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:48,  2.20it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:43,  2.43it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:39,  2.64it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:37,  2.80it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:34,  2.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:32,  3.13it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:31,  3.20it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:31,  3.20it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:30,  3.20it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:30,  3.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:31,  3.04it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:30,  3.11it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.17it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.20it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.27it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.23it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:27,  3.25it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:26,  3.30it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:26,  3.27it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:26,  3.31it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.30it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.29it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.27it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.28it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.27it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.24it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.23it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.22it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.13it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.23it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.27it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.38it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:20,  3.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:20,  3.37it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.35it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.37it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:20,  3.33it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.42it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:18,  3.47it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:18,  3.41it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.41it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.28it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.22it/s][A[INFO|trainer.py:570] 2024-04-28 22:50:00,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:50:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:50:00 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:50:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:50:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:50:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:50:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.6517458, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 296, 225, 323, 228, 219, 228, 191, 192, 164, 150, 152], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98707, 'target_sparsity': 0.95, 'step': 5000}


Iteration:  48%|████▊     | 55/115 [00:19<00:42,  1.42it/s][A04/28/2024 22:50:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 5000, Alignment: tensor([2, 2, 2, 2], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:19<00:35,  1.66it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:29,  1.95it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:25,  2.24it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:22,  2.46it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:20,  2.67it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.84it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  2.96it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.09it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.14it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.24it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.23it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.24it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.21it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.19it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.35it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.41it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.32it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.16it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.17it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.22it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.11it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.16it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  3.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.06it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.13it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  3.08it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.13it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.08it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.16it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.20it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.18it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.21it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.03it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.14it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.20it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.06it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.10it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.15it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.19it/s][A[INFO|trainer.py:570] 2024-04-28 22:50:17,745 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:50:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:50:17 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:50:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:50:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:50:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:50:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 0.635564, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 295, 225, 321, 228, 219, 227, 190, 191, 163, 151, 152], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98714, 'target_sparsity': 0.95, 'step': 5050}


Iteration:  91%|█████████▏| 105/115 [00:36<00:07,  1.41it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:05,  1.71it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:03,  2.01it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.32it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  2.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  2.74it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.86it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.43it/s][A04/28/2024 22:50:21 - INFO - trainer.trainer_mod_2 - Epoch 43 finished. Took 39.35 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.92it/s]
Epoch:  44%|████▍     | 44/100 [29:51<36:18, 38.89s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.20it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.23it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.24it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.25it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.37it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.34it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.28it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.32it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.26it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.28it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.23it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.26it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.25it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.20it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.23it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.33it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.15it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.20it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.17it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.22it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.22it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.33it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:25,  3.40it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:25,  3.33it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.26it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.21it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.23it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.22it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.27it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.31it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 22:50:34,297 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:50:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:50:34 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:50:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:50:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/28/2024 22:50:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:50:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6862745098039216, 'f1': 0.8134110787172011, 'combined_score': 0.7498427942605613, 'eval_loss': 0.6362072, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 294, 224, 319, 227, 218, 226, 188, 190, 163, 150, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98719, 'target_sparsity': 0.95, 'step': 5100}
04/28/2024 22:50:35 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 44 | Step: 5100 | Model size: 1090784 | Score: 0.68627]

[INFO|configuration_utils.py:439] 2024-04-28 22:50:35,614 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 22:50:36,515 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/pytorch_model.bin

Iteration:  35%|███▍      | 40/115 [00:14<01:13,  1.02it/s][A04/28/2024 22:50:36 - INFO - trainer.trainer_mod_2 - v4 Global step: 5100, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:14<00:58,  1.26it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:47,  1.54it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:39,  1.82it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:33,  2.11it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:29,  2.37it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:26,  2.62it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.84it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:21,  3.02it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.13it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.21it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:20,  3.13it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.17it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.16it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:18,  3.30it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.24it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.29it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:16,  3.40it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:16,  3.32it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.24it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.22it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.26it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:15,  3.26it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.08it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.10it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.19it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.19it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.20it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.10it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.33it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.10it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.13it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.17it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.21it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.19it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.13it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.13it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.26it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.36it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.17it/s][A[INFO|trainer.py:570] 2024-04-28 22:50:52,102 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:50:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:50:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:50:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:50:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:50:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:50:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6862745098039216, 'f1': 0.8117647058823529, 'combined_score': 0.7490196078431373, 'eval_loss': 0.635753, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 294, 224, 317, 227, 218, 224, 187, 189, 162, 150, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98723, 'target_sparsity': 0.95, 'step': 5150}


Iteration:  78%|███████▊  | 90/115 [00:31<00:17,  1.41it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:14,  1.71it/s][A
Iteration:  80%|████████  | 92/115 [00:32<00:11,  1.93it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:10,  2.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:08,  2.41it/s][A
Iteration:  83%|████████▎ | 95/115 [00:33<00:07,  2.63it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  2.78it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:06,  2.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.04it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.11it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.14it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.18it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.21it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.22it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:02,  3.34it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.34it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.34it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.29it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.33it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.35it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.31it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.28it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.27it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.63it/s][A04/28/2024 22:51:00 - INFO - trainer.trainer_mod_2 - Epoch 44 finished. Took 39.0 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.95it/s]
Epoch:  45%|████▌     | 45/100 [30:30<35:40, 38.93s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.22it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.14it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.21it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.18it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.30it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.09it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.12it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.27it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:30,  3.30it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:29,  3.37it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.99it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.10it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.16it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:31,  3.00it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:30,  3.02it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.09it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.15it/s][A[INFO|trainer.py:570] 2024-04-28 22:51:08,885 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:51:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:51:08 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:51:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:51:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:51:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:51:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8203592814371258, 'combined_score': 0.7631208171891511, 'eval_loss': 0.63368076, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 293, 224, 315, 227, 218, 223, 186, 187, 162, 150, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98726, 'target_sparsity': 0.95, 'step': 5200}
04/28/2024 22:51:10 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 45 | Step: 5200 | Model size: 1090784 | Score: 0.70588]

[INFO|configuration_utils.py:439] 2024-04-28 22:51:10,203 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 22:51:11,092 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/pytorch_model.bin

Iteration:  22%|██▏       | 25/115 [00:10<01:28,  1.02it/s][A04/28/2024 22:51:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 5200, Alignment: tensor([ 1,  1,  6, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:10<01:09,  1.28it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:57,  1.53it/s][A
Iteration:  24%|██▍       | 28/115 [00:11<00:48,  1.81it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:40,  2.10it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:36,  2.33it/s][A
Iteration:  27%|██▋       | 31/115 [00:12<00:33,  2.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:30,  2.70it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.83it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.91it/s][A
Iteration:  30%|███       | 35/115 [00:13<00:26,  3.04it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.13it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.19it/s][A
Iteration:  33%|███▎      | 38/115 [00:14<00:24,  3.21it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:23,  3.18it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.25it/s][A
Iteration:  36%|███▌      | 41/115 [00:15<00:23,  3.19it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:22,  3.23it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:22,  3.25it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:21,  3.26it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:21,  3.24it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:20,  3.33it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.33it/s][A
Iteration:  42%|████▏     | 48/115 [00:17<00:20,  3.33it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:19,  3.33it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:19,  3.36it/s][A
Iteration:  44%|████▍     | 51/115 [00:18<00:19,  3.28it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:18,  3.32it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.17it/s][A
Iteration:  47%|████▋     | 54/115 [00:19<00:18,  3.23it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:18,  3.25it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:17,  3.28it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.26it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:17,  3.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:16,  3.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.29it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:16,  3.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:15,  3.33it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:15,  3.32it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:15,  3.27it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.29it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.26it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:14,  3.21it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.34it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:13,  3.41it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.38it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.37it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:12,  3.45it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.45it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.41it/s][A[INFO|trainer.py:570] 2024-04-28 22:51:26,365 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:51:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:51:26 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:51:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:51:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:51:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:51:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6862745098039216, 'f1': 0.8134110787172011, 'combined_score': 0.7498427942605613, 'eval_loss': 0.66474944, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 292, 224, 313, 226, 217, 222, 185, 186, 162, 150, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98728, 'target_sparsity': 0.95, 'step': 5250}


Iteration:  65%|██████▌   | 75/115 [00:26<00:27,  1.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:27<00:22,  1.72it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:18,  2.02it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:16,  2.25it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:14,  2.47it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:13,  2.69it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:12,  2.79it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.94it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.01it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.12it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.20it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.23it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.35it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.35it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.12it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.16it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:05,  3.21it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.21it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.17it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.20it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.24it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.33it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.20it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.25it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.28it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.37it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.33it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.31it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.30it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.25it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.24it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.26it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.57it/s][A04/28/2024 22:51:39 - INFO - trainer.trainer_mod_2 - Epoch 45 finished. Took 38.92 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.95it/s]
Epoch:  46%|████▌     | 46/100 [31:09<35:01, 38.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.36it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.34it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.34it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.27it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.04it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.07it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.18it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.16it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.14it/s][A[INFO|trainer.py:570] 2024-04-28 22:51:43,036 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:51:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:51:43 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:51:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:51:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:51:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:51:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8172362555720655, 'combined_score': 0.7578828336683856, 'eval_loss': 0.644405, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 292, 223, 311, 226, 217, 221, 184, 186, 161, 150, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98729, 'target_sparsity': 0.95, 'step': 5300}


Iteration:   9%|▊         | 10/115 [00:04<01:15,  1.39it/s][A04/28/2024 22:51:44 - INFO - trainer.trainer_mod_2 - v4 Global step: 5300, Alignment: tensor([2, 2, 5, 6], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:04<01:01,  1.70it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:51,  2.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:44,  2.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:40,  2.51it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:37,  2.69it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:35,  2.80it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:33,  2.89it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.11it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:30,  3.13it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.15it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.15it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.23it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.18it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.20it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.04it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.13it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.21it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.23it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.27it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.27it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:23,  3.35it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:23,  3.32it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.12it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.11it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.25it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.30it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.12it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.10it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.19it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.23it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.18it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.23it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.20it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.23it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.18it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.20it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.37it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.33it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.32it/s][A[INFO|trainer.py:570] 2024-04-28 22:51:59,796 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:51:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:51:59 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:51:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:51:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.23it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:52:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:52:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8183161004431315, 'combined_score': 0.7584227561039187, 'eval_loss': 0.643663, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 291, 223, 309, 226, 217, 220, 183, 185, 161, 150, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.9873, 'target_sparsity': 0.95, 'step': 5350}


Iteration:  52%|█████▏    | 60/115 [00:21<00:37,  1.46it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:30,  1.76it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:25,  2.05it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:22,  2.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:19,  2.58it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:17,  2.84it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.79it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.85it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.00it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.04it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.08it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  2.98it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.13it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.16it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:11,  3.26it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.29it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.26it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.26it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.27it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.26it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:09,  3.37it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.32it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.29it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.28it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.29it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.28it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.14it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.20it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.13it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.17it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.25it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.30it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.19it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.22it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.26it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.21it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.22it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.21it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.16it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.31it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.30it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.24it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.31it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 22:52:16,547 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:52:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:52:16 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:52:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:52:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:52:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:52:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8200589970501474, 'combined_score': 0.7605196946035051, 'eval_loss': 0.6474808, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 290, 223, 307, 225, 216, 219, 183, 184, 161, 150, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98732, 'target_sparsity': 0.95, 'step': 5400}


Iteration:  96%|█████████▌| 110/115 [00:37<00:03,  1.43it/s][A04/28/2024 22:52:17 - INFO - trainer.trainer_mod_2 - v4 Global step: 5400, Alignment: tensor([1, 1, 1, 8], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:38<00:02,  1.73it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.01it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.25it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.46it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.85it/s][A04/28/2024 22:52:19 - INFO - trainer.trainer_mod_2 - Epoch 46 finished. Took 39.44 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.92it/s]
Epoch:  47%|████▋     | 47/100 [31:48<34:31, 39.08s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.30it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.20it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:38,  2.93it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:37,  2.97it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.12it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.27it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.29it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.31it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.32it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.29it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.30it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.26it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:29,  3.36it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.34it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.25it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:31,  3.05it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.09it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.14it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.19it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.23it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.20it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.21it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.02it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.08it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:27,  3.04it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.06it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:27,  3.01it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:26,  3.07it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.15it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:25,  3.11it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.23it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.26it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.23it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.26it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.26it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:21,  3.27it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:21,  3.30it/s][A[INFO|trainer.py:570] 2024-04-28 22:52:33,428 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:52:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:52:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:52:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:52:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/28/2024 22:52:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:52:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6862745098039216, 'f1': 0.8134110787172011, 'combined_score': 0.7498427942605613, 'eval_loss': 0.66477346, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 290, 223, 306, 225, 216, 218, 182, 183, 160, 150, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98733, 'target_sparsity': 0.95, 'step': 5450}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.43it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:39,  1.73it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:33,  2.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:29,  2.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.49it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:24,  2.65it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:22,  2.80it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.05it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.15it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.13it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.13it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.16it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.16it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.22it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.30it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.24it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.14it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.12it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.18it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.16it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.07it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.20it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.32it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.19it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.04it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.08it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.22it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.25it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.18it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.21it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.16it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.13it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.13it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.32it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.31it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:06,  3.30it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.28it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.30it/s][A[INFO|trainer.py:570] 2024-04-28 22:52:50,285 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:52:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:52:50 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:52:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:52:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:52:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:52:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8185907046476761, 'combined_score': 0.761011038598348, 'eval_loss': 0.6217786, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 289, 223, 304, 225, 216, 217, 181, 182, 160, 150, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98735, 'target_sparsity': 0.95, 'step': 5500}


Iteration:  83%|████████▎ | 95/115 [00:32<00:13,  1.45it/s][A04/28/2024 22:52:51 - INFO - trainer.trainer_mod_2 - v4 Global step: 5500, Alignment: tensor([0, 0, 0, 8], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:32<00:10,  1.73it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:08,  2.03it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:07,  2.29it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.58it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.74it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.88it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.06it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.22it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.25it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.28it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.28it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.31it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.20it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.20it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.24it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.26it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.36it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.34it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.52it/s][A04/28/2024 22:52:57 - INFO - trainer.trainer_mod_2 - Epoch 47 finished. Took 38.24 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.01it/s]
Epoch:  48%|████▊     | 48/100 [32:27<33:39, 38.83s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.33it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.25it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.21it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.05it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.10it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.12it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.22it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.05it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  3.00it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.04it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.13it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.17it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.15it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.17it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.15it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.15it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:30,  3.06it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:31,  2.95it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:30,  3.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:29,  3.04it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.09it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.14it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 22:53:07,123 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:53:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:53:07 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:53:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:53:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:53:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:53:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8193832599118943, 'combined_score': 0.7589563358383, 'eval_loss': 0.6704389, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 289, 222, 303, 224, 216, 216, 181, 182, 160, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98737, 'target_sparsity': 0.95, 'step': 5550}


Iteration:  26%|██▌       | 30/115 [00:10<00:59,  1.44it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:48,  1.72it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:40,  2.03it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:35,  2.30it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:32,  2.52it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:29,  2.70it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:27,  2.84it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.07it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.22it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.22it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.21it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.18it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.31it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.31it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.11it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.12it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.18it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.18it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.19it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.24it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.20it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.15it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.16it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.20it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.18it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.16it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.19it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.28it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.21it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.25it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.26it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.17it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.08it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.22it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.22it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.18it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.28it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.14it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.21it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.12it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.16it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.29it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.32it/s][A[INFO|trainer.py:570] 2024-04-28 22:53:23,947 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:53:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:53:23 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:53:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:53:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:53:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:53:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8189910979228486, 'combined_score': 0.7599857450398557, 'eval_loss': 0.6433109, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 288, 222, 301, 224, 215, 215, 180, 181, 160, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98739, 'target_sparsity': 0.95, 'step': 5600}


Iteration:  70%|██████▉   | 80/115 [00:27<00:24,  1.42it/s][A04/28/2024 22:53:25 - INFO - trainer.trainer_mod_2 - v4 Global step: 5600, Alignment: tensor([5, 5, 6, 6], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:27<00:19,  1.71it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  1.97it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.48it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:11,  2.63it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.80it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.89it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.10it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  2.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.06it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.05it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.18it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.29it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.34it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.42it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:04,  3.40it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.37it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.36it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.29it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.31it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.41it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.47it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:02,  3.40it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.37it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.45it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.38it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.17it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.19it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.32it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.26it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.53it/s][A04/28/2024 22:53:35 - INFO - trainer.trainer_mod_2 - Epoch 48 finished. Took 38.29 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.00it/s]
Epoch:  49%|████▉     | 49/100 [33:05<32:51, 38.67s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.07it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.36it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.36it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.32it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.23it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.38it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.33it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.24it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.24it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.03it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 22:53:40,518 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:53:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:53:40 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:53:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:53:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:53:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:53:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8217967599410898, 'combined_score': 0.7626140662450547, 'eval_loss': 0.6812369, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 288, 222, 300, 224, 215, 214, 179, 180, 159, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98742, 'target_sparsity': 0.95, 'step': 5650}


Iteration:  13%|█▎        | 15/115 [00:05<01:11,  1.41it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:58,  1.70it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:51,  1.91it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:44,  2.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:39,  2.43it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:36,  2.61it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:34,  2.74it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.87it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.93it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.06it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.10it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.15it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:26,  3.28it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:26,  3.27it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.30it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.30it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.26it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.27it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.28it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.31it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.32it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.26it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.29it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.30it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.38it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.35it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:21,  3.43it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.37it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.36it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.33it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.28it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.19it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.09it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.11it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  3.03it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.11it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.15it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.17it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.18it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.22it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.20it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.26it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.24it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.25it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.18it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.16it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.24it/s][A[INFO|trainer.py:570] 2024-04-28 22:53:57,305 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:53:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:53:57 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:53:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:53:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.40it/s]04/28/2024 22:53:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:53:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8166915052160953, 'combined_score': 0.7576104584904007, 'eval_loss': 0.6493364, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 287, 222, 299, 224, 215, 214, 179, 180, 159, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98747, 'target_sparsity': 0.95, 'step': 5700}


Iteration:  57%|█████▋    | 65/115 [00:22<00:34,  1.43it/s][A04/28/2024 22:53:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 5700, Alignment: tensor([3, 3, 3, 6], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:23<00:28,  1.71it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:20,  2.28it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:17,  2.57it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:16,  2.80it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  2.95it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.08it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.14it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  3.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.09it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.06it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.07it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.16it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.23it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.28it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.28it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.25it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.20it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.07it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.09it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.10it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.21it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.16it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.21it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.33it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.30it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.30it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.34it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.16it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.21it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.18it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.31it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.32it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.30it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.32it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.39it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.35it/s][A[INFO|trainer.py:570] 2024-04-28 22:54:13,982 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:54:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:54:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:54:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:54:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.23it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:54:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:54:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8198198198198199, 'combined_score': 0.7628510863804983, 'eval_loss': 0.6333909, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 287, 222, 298, 223, 215, 213, 178, 179, 159, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98754, 'target_sparsity': 0.95, 'step': 5750}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.50it/s][A04/28/2024 22:54:15 - INFO - trainer.trainer_mod_2 - Epoch 49 finished. Took 39.42 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.92it/s]
Epoch:  50%|█████     | 50/100 [33:44<32:24, 38.89s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.97it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.26it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.29it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.30it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.26it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.26it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.31it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.32it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.20it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.29it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.32it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.33it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.25it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.25it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.07it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.12it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.17it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.20it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.20it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.22it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.22it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.25it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.22it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.27it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.31it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:24,  3.30it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:26,  3.08it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:25,  3.13it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.16it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.15it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:24,  3.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.30it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.28it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.35it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:22,  3.30it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:21,  3.23it/s][A
Iteration:  39%|███▉      | 45/115 [00:13<00:22,  3.17it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:21,  3.16it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:21,  3.14it/s][A
Iteration:  42%|████▏     | 48/115 [00:14<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 22:54:30,798 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:54:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:54:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:54:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:54:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/28/2024 22:54:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:54:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.696078431372549, 'f1': 0.8132530120481929, 'combined_score': 0.7546657217103709, 'eval_loss': 0.736559, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 286, 222, 297, 223, 214, 212, 178, 179, 159, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98765, 'target_sparsity': 0.95, 'step': 5800}


Iteration:  43%|████▎     | 50/115 [00:16<00:45,  1.43it/s][A04/28/2024 22:54:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 5800, Alignment: tensor([3, 3, 3, 6], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:17<00:37,  1.70it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:31,  2.00it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:26,  2.31it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:24,  2.46it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:22,  2.64it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:21,  2.81it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:20,  2.80it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:20,  2.83it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  2.99it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.09it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.23it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.24it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.26it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.30it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.31it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.39it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.34it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.33it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.30it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.21it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.32it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.20it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.25it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.30it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.22it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.27it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.38it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.36it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.36it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.26it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:09,  3.21it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.24it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.25it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:07,  3.24it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.22it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.14it/s][A
Iteration:  83%|████████▎ | 95/115 [00:30<00:06,  3.11it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:06,  3.13it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.21it/s][A
Iteration:  85%|████████▌ | 98/115 [00:31<00:05,  3.24it/s][A
Iteration:  86%|████████▌ | 99/115 [00:31<00:04,  3.31it/s][A[INFO|trainer.py:570] 2024-04-28 22:54:47,564 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:54:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:54:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:54:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:54:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/28/2024 22:54:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:54:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6936274509803921, 'f1': 0.8091603053435115, 'combined_score': 0.7513938781619518, 'eval_loss': 0.6650737, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 286, 222, 296, 223, 214, 212, 178, 179, 159, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.98783, 'target_sparsity': 0.95, 'step': 5850}


Iteration:  87%|████████▋ | 100/115 [00:33<00:10,  1.41it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:08,  1.71it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  2.00it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:05,  2.29it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:04,  2.58it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.75it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:03,  2.75it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  2.90it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.07it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.11it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.13it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.23it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.14it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.14it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.50it/s][A04/28/2024 22:54:53 - INFO - trainer.trainer_mod_2 - Epoch 50 finished. Took 38.09 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.02it/s]
Epoch:  51%|█████     | 51/100 [34:22<31:34, 38.65s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.20it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.23it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.22it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.35it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.22it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.26it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.06it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.24it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.30it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.34it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:30,  3.33it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.31it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.28it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.29it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.32it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.26it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.34it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:27,  3.34it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:27,  3.36it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.35it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.25it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.27it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:25,  3.34it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.36it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:24,  3.43it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:24,  3.42it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:24,  3.30it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.29it/s][A[INFO|trainer.py:570] 2024-04-28 22:55:03,995 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:55:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:55:03 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:55:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:55:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.24it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:55:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:55:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6936274509803921, 'f1': 0.8091603053435115, 'combined_score': 0.7513938781619518, 'eval_loss': 0.7169031, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 286, 222, 295, 223, 214, 211, 177, 178, 158, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84122912, 'remaining_params': 894688, 'pruned_model_sparsity': 0.9894764378199338, 'expected_sparsity': 0.98803, 'target_sparsity': 0.95, 'step': 5900}


Iteration:  30%|███       | 35/115 [00:11<00:54,  1.46it/s][A04/28/2024 22:55:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 5900, Alignment: tensor([1, 1, 1, 6], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:12<00:45,  1.74it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:38,  2.00it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:34,  2.24it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:30,  2.53it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:27,  2.69it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:25,  2.85it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.96it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.04it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.15it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:21,  3.21it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.13it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.16it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.20it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:20,  3.20it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.27it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.30it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:17,  3.38it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.30it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.27it/s][A
Iteration:  50%|█████     | 58/115 [00:18<00:17,  3.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.34it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.17it/s][A
Iteration:  53%|█████▎    | 61/115 [00:19<00:16,  3.19it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.25it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.16it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:16,  3.17it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.23it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.22it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.28it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.29it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:22<00:13,  3.33it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:12,  3.34it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.33it/s][A
Iteration:  64%|██████▍   | 74/115 [00:23<00:11,  3.43it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:11,  3.43it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.31it/s][A
Iteration:  67%|██████▋   | 77/115 [00:24<00:11,  3.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.26it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.21it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.30it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.26it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:26<00:09,  3.20it/s][A[INFO|trainer.py:570] 2024-04-28 22:55:20,644 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:55:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:55:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:55:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:55:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.23it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.24it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.44it/s]04/28/2024 22:55:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:55:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.8073394495412843, 'combined_score': 0.7492579600647598, 'eval_loss': 0.67901015, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 286, 221, 294, 223, 214, 211, 177, 178, 158, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84122912, 'remaining_params': 894688, 'pruned_model_sparsity': 0.9894764378199338, 'expected_sparsity': 0.98821, 'target_sparsity': 0.95, 'step': 5950}


Iteration:  74%|███████▍  | 85/115 [00:28<00:21,  1.43it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:16,  1.72it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:13,  2.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:11,  2.30it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:10,  2.58it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:09,  2.75it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:08,  2.94it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.03it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:07,  3.05it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:06,  3.05it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.12it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.16it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.09it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.21it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.19it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  3.20it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.23it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.29it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.29it/s][A
Iteration:  92%|█████████▏| 106/115 [00:34<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:35<00:01,  3.16it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:36<00:00,  3.05it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.18it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.25it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.56it/s][A04/28/2024 22:55:31 - INFO - trainer.trainer_mod_2 - Epoch 51 finished. Took 37.75 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.05it/s]
Epoch:  52%|█████▏    | 52/100 [35:00<30:42, 38.38s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.39it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.28it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.28it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.29it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.29it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.26it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.29it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:31,  3.40it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:30,  3.43it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:30,  3.41it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:30,  3.39it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:30,  3.37it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:30,  3.34it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.36it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.32it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.31it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.21it/s][A[INFO|trainer.py:570] 2024-04-28 22:55:37,187 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:55:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:55:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:55:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:55:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.23it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:55:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:55:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8061068702290076, 'combined_score': 0.747416180212543, 'eval_loss': 0.69820964, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [200, 285, 221, 293, 222, 214, 211, 177, 178, 158, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84122912, 'remaining_params': 894688, 'pruned_model_sparsity': 0.9894764378199338, 'expected_sparsity': 0.98832, 'target_sparsity': 0.95, 'step': 6000}


Iteration:  17%|█▋        | 20/115 [00:07<01:06,  1.42it/s][A04/28/2024 22:55:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 6000, Alignment: tensor([5, 5, 5, 9], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:07<00:54,  1.72it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:46,  1.99it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:40,  2.26it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:36,  2.52it/s][A
Iteration:  22%|██▏       | 25/115 [00:08<00:33,  2.66it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:33,  2.68it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:31,  2.82it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:28,  3.04it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.19it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.12it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.19it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.24it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.31it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:24,  3.30it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.27it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.37it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.17it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:24,  3.04it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.11it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.19it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.29it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.29it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.36it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.32it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.40it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:19,  3.37it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.45it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:17,  3.48it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:17,  3.44it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.28it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.25it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.33it/s][A
Iteration:  50%|█████     | 58/115 [00:18<00:16,  3.36it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.32it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.22it/s][A
Iteration:  53%|█████▎    | 61/115 [00:19<00:17,  3.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.15it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.19it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.28it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.25it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.19it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 22:55:53,880 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:55:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:55:53 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:55:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:55:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.24it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:55:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:55:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.806697108066971, 'combined_score': 0.7477112991315247, 'eval_loss': 0.6771267, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 285, 221, 293, 222, 214, 210, 176, 177, 158, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84121380, 'remaining_params': 896220, 'pruned_model_sparsity': 0.9894584180216802, 'expected_sparsity': 0.98838, 'target_sparsity': 0.95, 'step': 6050}


Iteration:  61%|██████    | 70/115 [00:24<00:31,  1.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:26,  1.68it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:21,  1.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:18,  2.22it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:16,  2.49it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:14,  2.68it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:13,  2.82it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.02it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:12,  2.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.09it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.16it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:11,  2.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.09it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.19it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.21it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.16it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.32it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.29it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.26it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.22it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.18it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.28it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.32it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.19it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.22it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.19it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.24it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:03,  3.27it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.20it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.17it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.22it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.24it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.30it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.33it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.42it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.39it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.32it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.34it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.32it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.54it/s][A04/28/2024 22:56:08 - INFO - trainer.trainer_mod_2 - Epoch 52 finished. Took 37.84 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.04it/s]
Epoch:  53%|█████▎    | 53/100 [35:38<29:56, 38.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.08it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.25it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.33it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.29it/s][A[INFO|trainer.py:570] 2024-04-28 22:56:10,507 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:56:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:56:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:56:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:56:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.24it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:56:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:56:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.8067484662576686, 'combined_score': 0.7489624684229519, 'eval_loss': 0.6739716, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 285, 221, 292, 222, 214, 210, 176, 177, 158, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84121380, 'remaining_params': 896220, 'pruned_model_sparsity': 0.9894584180216802, 'expected_sparsity': 0.98843, 'target_sparsity': 0.95, 'step': 6100}


Iteration:   4%|▍         | 5/115 [00:02<01:25,  1.29it/s][A04/28/2024 22:56:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 6100, Alignment: tensor([5, 5, 5, 9], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:07,  1.62it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:56,  1.92it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:48,  2.19it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:43,  2.45it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:39,  2.64it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:36,  2.83it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:35,  2.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:34,  3.00it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:33,  3.04it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:31,  3.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:31,  3.18it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:31,  3.15it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:29,  3.22it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.25it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.24it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:28,  3.26it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.23it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:27,  3.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:27,  3.27it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.23it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.25it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:26,  3.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.19it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.22it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.30it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:24,  3.40it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.37it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:23,  3.36it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:23,  3.35it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.36it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:23,  3.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.08it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.19it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.23it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.29it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.38it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.32it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:20,  3.31it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.31it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.27it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.26it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.25it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:20,  3.19it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.17it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.19it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:19,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 22:56:27,249 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:56:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:56:27 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:56:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:56:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.27it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.29it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.29it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.29it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.30it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.30it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.50it/s]04/28/2024 22:56:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:56:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.806697108066971, 'combined_score': 0.7477112991315247, 'eval_loss': 0.68433905, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 285, 221, 292, 222, 213, 210, 176, 177, 158, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84121380, 'remaining_params': 896220, 'pruned_model_sparsity': 0.9894584180216802, 'expected_sparsity': 0.98846, 'target_sparsity': 0.95, 'step': 6150}


Iteration:  48%|████▊     | 55/115 [00:19<00:42,  1.41it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:34,  1.71it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:28,  2.03it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:25,  2.20it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:22,  2.45it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:21,  2.62it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.79it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:18,  2.89it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  3.01it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.09it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.23it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:14,  3.25it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.25it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.28it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:13,  3.34it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.18it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.09it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.16it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.21it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.23it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.23it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.30it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.39it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:09,  3.36it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.33it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.42it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:08,  3.38it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.32it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.28it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:07,  3.39it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.36it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.29it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.38it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:06,  3.35it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.28it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.23it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.23it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.22it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.20it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.27it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.26it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.31it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:04,  3.19it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.17it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.21it/s][A[INFO|trainer.py:570] 2024-04-28 22:56:43,848 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:56:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:56:43 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:56:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:56:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.26it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.26it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:56:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:56:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.806697108066971, 'combined_score': 0.7477112991315247, 'eval_loss': 0.70359516, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [201, 285, 221, 291, 222, 213, 210, 176, 177, 158, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84121380, 'remaining_params': 896220, 'pruned_model_sparsity': 0.9894584180216802, 'expected_sparsity': 0.98846, 'target_sparsity': 0.95, 'step': 6200}


Iteration:  91%|█████████▏| 105/115 [00:36<00:06,  1.44it/s][A04/28/2024 22:56:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 6200, Alignment: tensor([5, 5, 5, 9], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:36<00:05,  1.74it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:03,  2.03it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.29it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  2.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  2.60it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.76it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  2.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.07it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.07it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.36it/s][A04/28/2024 22:56:48 - INFO - trainer.trainer_mod_2 - Epoch 53 finished. Took 39.2 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.93it/s]
Epoch:  54%|█████▍    | 54/100 [36:17<29:31, 38.51s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:32,  3.45it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.14it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.06it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.08it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.09it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.16it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.19it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.28it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.21it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.18it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.19it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.31it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.26it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.27it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.31it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.36it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.33it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.35it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.12it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.16it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.25it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.29it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:25,  3.39it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:25,  3.37it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:24,  3.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.32it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:24,  3.35it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:24,  3.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.36it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.27it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.26it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.28it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:22,  3.34it/s][A[INFO|trainer.py:570] 2024-04-28 22:57:00,394 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:57:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:57:00 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:57:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:57:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.24it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.24it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:57:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:57:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8055130168453293, 'combined_score': 0.7471192535207039, 'eval_loss': 0.6755649, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [202, 285, 221, 292, 222, 213, 210, 176, 177, 158, 150, 150], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84119848, 'remaining_params': 897752, 'pruned_model_sparsity': 0.9894403982234267, 'expected_sparsity': 0.98845, 'target_sparsity': 0.95, 'step': 6250}


Iteration:  35%|███▍      | 40/115 [00:13<00:51,  1.47it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:42,  1.74it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:36,  2.03it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:31,  2.29it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:27,  2.57it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:25,  2.72it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:24,  2.83it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:23,  2.84it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:22,  2.94it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.11it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:20,  3.09it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.18it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.26it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.23it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.33it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.32it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.30it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.30it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.23it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.23it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:20<00:15,  3.34it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:14,  3.42it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.37it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.32it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.33it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.34it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.32it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.18it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.16it/s][A
Iteration:  64%|██████▍   | 74/115 [00:23<00:12,  3.21it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.24it/s][A
Iteration:  67%|██████▋   | 77/115 [00:24<00:11,  3.22it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.26it/s][A
Iteration:  70%|██████▉   | 80/115 [00:25<00:10,  3.20it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.25it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.22it/s][A
Iteration:  72%|███████▏  | 83/115 [00:26<00:09,  3.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.24it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.31it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:08,  3.34it/s][A
Iteration:  76%|███████▌  | 87/115 [00:27<00:08,  3.23it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.29it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:07,  3.31it/s][A[INFO|trainer.py:570] 2024-04-28 22:57:17,046 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:57:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:57:17 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:57:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:57:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.24it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.44it/s]04/28/2024 22:57:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:57:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8061068702290076, 'combined_score': 0.747416180212543, 'eval_loss': 0.67472875, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [204, 285, 221, 292, 222, 213, 210, 176, 177, 158, 151, 151], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84116784, 'remaining_params': 900816, 'pruned_model_sparsity': 0.9894043586269196, 'expected_sparsity': 0.98839, 'target_sparsity': 0.95, 'step': 6300}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.44it/s][A04/28/2024 22:57:18 - INFO - trainer.trainer_mod_2 - v4 Global step: 6300, Alignment: tensor([ 8,  8, 10, 10], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:30<00:13,  1.74it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:11,  2.02it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:09,  2.28it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:08,  2.52it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:07,  2.71it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.82it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:06,  2.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:04,  3.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.29it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.29it/s][A
Iteration:  89%|████████▊ | 102/115 [00:33<00:03,  3.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.30it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:03,  3.29it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.26it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.37it/s][A
Iteration:  95%|█████████▍| 109/115 [00:35<00:01,  3.15it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.12it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.12it/s][A
Iteration:  97%|█████████▋| 112/115 [00:36<00:00,  3.18it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.42it/s][A04/28/2024 22:57:25 - INFO - trainer.trainer_mod_2 - Epoch 54 finished. Took 37.76 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.05it/s]
Epoch:  55%|█████▌    | 55/100 [36:55<28:43, 38.29s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.98it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.12it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.27it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.29it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.19it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.19it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.22it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.07it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.14it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.04it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.26it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:29,  3.37it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.30it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.27it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.27it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.28it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.30it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:27,  3.44it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:27,  3.42it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.34it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.26it/s][A[INFO|trainer.py:570] 2024-04-28 22:57:33,646 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:57:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:57:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:57:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:57:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.26it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:57:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:57:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6740196078431373, 'f1': 0.793798449612403, 'combined_score': 0.7339090287277701, 'eval_loss': 0.6668901, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [206, 286, 222, 292, 223, 214, 210, 177, 178, 160, 151, 152], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84113720, 'remaining_params': 903880, 'pruned_model_sparsity': 0.9893683190304126, 'expected_sparsity': 0.98823, 'target_sparsity': 0.95, 'step': 6350}


Iteration:  22%|██▏       | 25/115 [00:09<01:03,  1.42it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:53,  1.67it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:44,  1.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:39,  2.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:34,  2.48it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:31,  2.74it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:28,  2.90it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.94it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.06it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.10it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.12it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.12it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.16it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.23it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.22it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.09it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.12it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:22,  3.17it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.29it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.28it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.26it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:19,  3.36it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.27it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.23it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.21it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.21it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.21it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.10it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.24it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.37it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.32it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.31it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.33it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:15,  3.33it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.28it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.26it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.38it/s][A
Iteration:  58%|█████▊    | 67/115 [00:21<00:14,  3.34it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.29it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.30it/s][A
Iteration:  61%|██████    | 70/115 [00:22<00:13,  3.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:13,  3.22it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.30it/s][A[INFO|trainer.py:570] 2024-04-28 22:57:50,332 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:57:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:57:50 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:57:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:57:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.25it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.24it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.44it/s]04/28/2024 22:57:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:57:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.678921568627451, 'f1': 0.798151001540832, 'combined_score': 0.7385362850841415, 'eval_loss': 0.6645462, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [211, 286, 222, 293, 223, 214, 211, 178, 180, 163, 151, 156], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84106060, 'remaining_params': 911540, 'pruned_model_sparsity': 0.9892782200391448, 'expected_sparsity': 0.98793, 'target_sparsity': 0.95, 'step': 6400}


Iteration:  65%|██████▌   | 75/115 [00:25<00:27,  1.43it/s][A04/28/2024 22:57:51 - INFO - trainer.trainer_mod_2 - v4 Global step: 6400, Alignment: tensor([5, 5, 5, 9], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:25<00:22,  1.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:18,  2.02it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:16,  2.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:14,  2.49it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:12,  2.74it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:11,  2.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:11,  2.83it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  2.95it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  2.97it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.03it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.10it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.10it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.14it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.04it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.15it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.18it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.21it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.20it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.24it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.30it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.23it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.24it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.23it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.29it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.30it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.40it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.31it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.29it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.30it/s][A
Iteration:  97%|█████████▋| 111/115 [00:36<00:01,  3.31it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.27it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.27it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.33it/s][A
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.65it/s][A04/28/2024 22:58:03 - INFO - trainer.trainer_mod_2 - Epoch 55 finished. Took 37.97 seconds.
Iteration: 100%|██████████| 115/115 [00:37<00:00,  3.03it/s]
Epoch:  56%|█████▌    | 56/100 [37:33<28:00, 38.19s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.23it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.26it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.18it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.13it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 22:58:07,020 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:58:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:58:07 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:58:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:58:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.25it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:58:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:58:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8072837632776935, 'combined_score': 0.748004626736886, 'eval_loss': 0.713074, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [219, 287, 223, 294, 224, 215, 213, 181, 183, 168, 152, 161], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84093804, 'remaining_params': 923796, 'pruned_model_sparsity': 0.9891340616531166, 'expected_sparsity': 0.98742, 'target_sparsity': 0.95, 'step': 6450}


Iteration:   9%|▊         | 10/115 [00:04<01:14,  1.40it/s][A
Iteration:  10%|▉         | 11/115 [00:04<01:00,  1.72it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:51,  2.01it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:44,  2.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:41,  2.41it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:38,  2.61it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:35,  2.78it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  2.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.03it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:31,  3.09it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.16it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.15it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.16it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.17it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.26it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.19it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:26,  3.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.23it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.29it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:24,  3.36it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.32it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.24it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.15it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.20it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.14it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.34it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.32it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:21,  3.50it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.37it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:22,  3.32it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:21,  3.38it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:20,  3.46it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.36it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.16it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.22it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.20it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.26it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.37it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:18,  3.45it/s][A
Iteration:  44%|████▍     | 51/115 [00:16<00:18,  3.43it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:18,  3.34it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.41it/s][A
Iteration:  47%|████▋     | 54/115 [00:17<00:18,  3.34it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:17,  3.34it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.32it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.28it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.24it/s][A[INFO|trainer.py:570] 2024-04-28 22:58:23,576 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:58:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:58:23 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:58:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:58:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.25it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.45it/s]04/28/2024 22:58:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:58:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.806697108066971, 'combined_score': 0.7477112991315247, 'eval_loss': 0.70273465, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [230, 289, 224, 295, 225, 217, 216, 185, 188, 176, 153, 170], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84076952, 'remaining_params': 940648, 'pruned_model_sparsity': 0.9889358438723276, 'expected_sparsity': 0.98661, 'target_sparsity': 0.95, 'step': 6500}


Iteration:  52%|█████▏    | 60/115 [00:20<00:38,  1.42it/s][A04/28/2024 22:58:25 - INFO - trainer.trainer_mod_2 - v4 Global step: 6500, Alignment: tensor([5, 5, 5, 6], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:21<00:31,  1.71it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:26,  1.98it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:23,  2.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.44it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:18,  2.65it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:17,  2.84it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.08it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.14it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.19it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.02it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.09it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.18it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.24it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.15it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.23it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.35it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:09,  3.35it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.13it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.12it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.09it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.23it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.27it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.14it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.10it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.20it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.23it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.25it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.30it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.33it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.26it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.19it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.19it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.16it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.23it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.26it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.24it/s][A
Iteration:  91%|█████████▏| 105/115 [00:34<00:02,  3.34it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.29it/s][A
Iteration:  94%|█████████▍| 108/115 [00:35<00:02,  3.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.32it/s][A[INFO|trainer.py:570] 2024-04-28 22:58:40,398 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:58:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:58:40 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:58:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:58:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.27it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.29it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.29it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.29it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.29it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.29it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.50it/s]04/28/2024 22:58:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:58:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.806697108066971, 'combined_score': 0.7477112991315247, 'eval_loss': 0.70533067, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [247, 291, 225, 297, 227, 219, 220, 190, 194, 189, 154, 184], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84050908, 'remaining_params': 966692, 'pruned_model_sparsity': 0.9886295073020175, 'expected_sparsity': 0.9854, 'target_sparsity': 0.95, 'step': 6550}


Iteration:  96%|█████████▌| 110/115 [00:37<00:03,  1.45it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:02,  1.71it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  1.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  2.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.53it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.91it/s][A04/28/2024 22:58:43 - INFO - trainer.trainer_mod_2 - Epoch 56 finished. Took 39.24 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.93it/s]
Epoch:  57%|█████▋    | 57/100 [38:12<27:35, 38.51s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.17it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.12it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.26it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.08it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.12it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.96it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.00it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.07it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:34,  3.08it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.10it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.20it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.16it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.03it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.10it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.12it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.09it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:29,  3.21it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.24it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.33it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.27it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.29it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.25it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.27it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.30it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.30it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.28it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.32it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.33it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.17it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.25it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:25,  3.20it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.22it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.23it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.27it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.28it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:23,  3.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.21it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.17it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.20it/s][A[INFO|trainer.py:570] 2024-04-28 22:58:57,235 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:58:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:58:57 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:58:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:58:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.24it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.24it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.24it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.44it/s]04/28/2024 22:58:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:58:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8018433179723502, 'combined_score': 0.7428334236920575, 'eval_loss': 0.6809523, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [272, 293, 227, 300, 229, 223, 226, 198, 205, 209, 155, 206], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 84012608, 'remaining_params': 1004992, 'pruned_model_sparsity': 0.9881790123456791, 'expected_sparsity': 0.98347, 'target_sparsity': 0.95, 'step': 6600}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.42it/s][A04/28/2024 22:58:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 6600, Alignment: tensor([4, 4, 6, 6], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:15<00:40,  1.72it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:33,  2.03it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:29,  2.27it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.46it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:24,  2.62it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:23,  2.78it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:21,  2.88it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.07it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.23it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.25it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.24it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.30it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.25it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.30it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.31it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.17it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.20it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.20it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.29it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.31it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:12,  3.31it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.30it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.27it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.32it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.24it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.26it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.29it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.30it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.32it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.40it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.41it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.29it/s][A
Iteration:  75%|███████▍  | 86/115 [00:27<00:08,  3.26it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.30it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:07,  3.27it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.27it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:06,  3.31it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.31it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.33it/s][A[INFO|trainer.py:570] 2024-04-28 22:59:13,850 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:59:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:59:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:59:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:59:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/28/2024 22:59:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:59:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.8079268292682926, 'combined_score': 0.749551649928264, 'eval_loss': 0.6415822, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [308, 297, 229, 304, 231, 227, 234, 208, 220, 245, 158, 250], 'head_nums': [2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 2, 1], 'pruned_params': 83761360, 'remaining_params': 1256240, 'pruned_model_sparsity': 0.9852237654320988, 'expected_sparsity': 0.98043, 'target_sparsity': 0.95, 'step': 6650}


Iteration:  83%|████████▎ | 95/115 [00:32<00:13,  1.43it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:10,  1.73it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:08,  2.03it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:07,  2.35it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.70it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  2.85it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.96it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.01it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.04it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.11it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.16it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.12it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.13it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.11it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.01it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:37<00:00,  3.13it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.45it/s][A04/28/2024 22:59:21 - INFO - trainer.trainer_mod_2 - Epoch 57 finished. Took 38.21 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.01it/s]
Epoch:  58%|█████▊    | 58/100 [38:50<26:53, 38.42s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.07it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.19it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.20it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.29it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.24it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.24it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.22it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.26it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.31it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.17it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.07it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.11it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.21it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.22it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.21it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.23it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.24it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.27it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.27it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.26it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.25it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.29it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 22:59:30,694 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:59:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:59:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:59:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:59:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/28/2024 22:59:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:59:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.8085106382978724, 'combined_score': 0.7498435544430538, 'eval_loss': 0.65013796, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [362, 303, 231, 308, 234, 233, 247, 223, 246, 326, 160, 370], 'head_nums': [2, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 83286440, 'remaining_params': 1731160, 'pruned_model_sparsity': 0.979637627973502, 'expected_sparsity': 0.97488, 'target_sparsity': 0.95, 'step': 6700}


Iteration:  26%|██▌       | 30/115 [00:10<01:00,  1.41it/s][A04/28/2024 22:59:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 6700, Alignment: tensor([4, 4, 4, 6], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:10<00:49,  1.69it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:42,  1.96it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:36,  2.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:33,  2.45it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:30,  2.63it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.79it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.10it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.17it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.20it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.28it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.23it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.25it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.18it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.12it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.09it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.16it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.20it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.22it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.25it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.26it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.23it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.25it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.09it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.21it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.12it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.18it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.39it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:14,  3.33it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.31it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.24it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.27it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.18it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.07it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.15it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.11it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.10it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.14it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.18it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.29it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.28it/s][A[INFO|trainer.py:570] 2024-04-28 22:59:47,563 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 22:59:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 22:59:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 22:59:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 22:59:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.41it/s]04/28/2024 22:59:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 22:59:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8084464555052789, 'combined_score': 0.7485859728506787, 'eval_loss': 0.6822409, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [438, 310, 233, 312, 236, 241, 266, 244, 291, 595, 163, 877], 'head_nums': [2, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 83170008, 'remaining_params': 1847592, 'pruned_model_sparsity': 0.978268123306233, 'expected_sparsity': 0.96041, 'target_sparsity': 0.95, 'step': 6750}


Iteration:  70%|██████▉   | 80/115 [00:27<00:24,  1.42it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:20,  1.68it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  1.97it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.39it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:12,  2.46it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.66it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.01it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.05it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.08it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.15it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.09it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.03it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.05it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.12it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.09it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.11it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.95it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.10it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.10it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.07it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.16it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.28it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.19it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.19it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.08it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.11it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.12it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.44it/s][A04/28/2024 22:59:59 - INFO - trainer.trainer_mod_2 - Epoch 58 finished. Took 38.63 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.98it/s]
Epoch:  59%|█████▉    | 59/100 [39:29<26:17, 38.48s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.06it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:40,  2.82it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:37,  3.00it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:38,  2.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:35,  3.04it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.06it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.23it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.29it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.24it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.28it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.28it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.25it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.22it/s][A[INFO|trainer.py:570] 2024-04-28 23:00:04,747 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:00:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:00:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:00:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:00:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.13it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.14it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.34it/s]04/28/2024 23:00:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:00:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8166915052160953, 'combined_score': 0.7576104584904007, 'eval_loss': 0.6232552, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [499, 315, 234, 316, 238, 247, 285, 261, 345, 1163, 165, 1605], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 78443788, 'remaining_params': 6573812, 'pruned_model_sparsity': 0.922677045694068, 'expected_sparsity': 0.92949, 'target_sparsity': 0.95, 'step': 6800}


Iteration:  13%|█▎        | 15/115 [00:06<01:11,  1.41it/s][A04/28/2024 23:00:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 6800, Alignment: tensor([4, 4, 5, 6], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<00:58,  1.70it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:50,  1.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:43,  2.21it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:38,  2.50it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:35,  2.67it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.82it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:30,  3.01it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.09it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.11it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.15it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.08it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.10it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:29,  2.90it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.08it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.05it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.06it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.06it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.14it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.24it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.27it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.19it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.09it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:24,  3.02it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.08it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.02it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.02it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  3.03it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.05it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.02it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.01it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.02it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.02it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.15it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.00it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  3.02it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.09it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.11it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.20it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.22it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.08it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.12it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.11it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.12it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 23:00:22,103 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:00:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:00:22 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:00:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:00:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.14it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.15it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.35it/s]04/28/2024 23:00:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:00:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.8102409638554218, 'combined_score': 0.7507087172218285, 'eval_loss': 0.60914725, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [499, 315, 234, 316, 238, 247, 286, 263, 351, 1228, 166, 1639], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 78292120, 'remaining_params': 6725480, 'pruned_model_sparsity': 0.9208930856669678, 'expected_sparsity': 0.92688, 'target_sparsity': 0.95, 'step': 6850}


Iteration:  57%|█████▋    | 65/115 [00:23<00:35,  1.40it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:29,  1.69it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:24,  1.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:21,  2.22it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:19,  2.40it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:17,  2.56it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:16,  2.67it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.77it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  3.00it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.08it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.09it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.18it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:11,  3.19it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.13it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.10it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.03it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.06it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.12it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.21it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.14it/s][A
Iteration:  75%|███████▍  | 86/115 [00:30<00:09,  3.00it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.07it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 89/115 [00:31<00:08,  3.16it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.19it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.27it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:06,  3.30it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.18it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:07,  2.98it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.13it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.11it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.17it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.14it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.19it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  3.18it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.17it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.10it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.20it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  3.20it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.19it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.17it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.29it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.34it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.25it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 23:00:39,140 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:00:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:00:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:00:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:00:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.14it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.15it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.34it/s]04/28/2024 23:00:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:00:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.817910447761194, 'combined_score': 0.7594454199590284, 'eval_loss': 0.6296815, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [491, 315, 234, 315, 238, 247, 284, 261, 343, 1153, 165, 1597], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 78483620, 'remaining_params': 6533980, 'pruned_model_sparsity': 0.92314556044866, 'expected_sparsity': 0.93133, 'target_sparsity': 0.95, 'step': 6900}


Iteration: 100%|██████████| 115/115 [00:40<00:00,  1.47it/s][A04/28/2024 23:00:40 - INFO - trainer.trainer_mod_2 - Epoch 59 finished. Took 40.47 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.84it/s]
Epoch:  60%|██████    | 60/100 [40:09<26:03, 39.08s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 23:00:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 6900, Alignment: tensor([1, 1, 6, 8], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:36,  3.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.21it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.07it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.14it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.08it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.14it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.19it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.17it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.16it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.05it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.11it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.17it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.17it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.15it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.14it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.11it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.12it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:29,  3.10it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.08it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.09it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.07it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.08it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:28,  3.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.18it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.17it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:25,  3.20it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.17it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.13it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.18it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.30it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:24,  3.19it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.19it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.17it/s][A
Iteration:  36%|███▌      | 41/115 [00:13<00:23,  3.19it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.19it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:23,  3.12it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.11it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:22,  3.18it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:22,  3.12it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:21,  3.11it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:21,  3.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.20it/s][A[INFO|trainer.py:570] 2024-04-28 23:00:56,332 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:00:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:00:56 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:00:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:00:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.43it/s]04/28/2024 23:00:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:00:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8078668683812406, 'combined_score': 0.7482961792886595, 'eval_loss': 0.6662361, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [482, 314, 234, 315, 238, 246, 282, 259, 336, 1094, 165, 1562], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 80317424, 'remaining_params': 4700176, 'pruned_model_sparsity': 0.9447152589581451, 'expected_sparsity': 0.93498, 'target_sparsity': 0.95, 'step': 6950}


Iteration:  43%|████▎     | 50/115 [00:17<00:45,  1.41it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:37,  1.71it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:32,  1.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:27,  2.26it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:24,  2.48it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:22,  2.66it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:21,  2.80it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:21,  2.75it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:20,  2.83it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:19,  2.93it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  3.05it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.04it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.04it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.16it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.00it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.07it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.05it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:14,  2.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:13,  3.03it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.01it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.06it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:12,  2.94it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.04it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.10it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.13it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.14it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.19it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.28it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.32it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.01it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.07it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.09it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.06it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:07,  3.13it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.10it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.25it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:06,  3.16it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.16it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.14it/s][A[INFO|trainer.py:570] 2024-04-28 23:01:13,683 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:01:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:01:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:01:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:01:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.19it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.38it/s]04/28/2024 23:01:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:01:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8018433179723502, 'combined_score': 0.7428334236920575, 'eval_loss': 0.63874954, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [474, 314, 234, 314, 238, 246, 280, 257, 330, 1055, 165, 1536], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 80369512, 'remaining_params': 4648088, 'pruned_model_sparsity': 0.9453279320987654, 'expected_sparsity': 0.939, 'target_sparsity': 0.95, 'step': 7000}


Iteration:  87%|████████▋ | 100/115 [00:34<00:10,  1.39it/s][A04/28/2024 23:01:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 7000, Alignment: tensor([4, 4, 4, 6], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:34<00:08,  1.68it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:06,  1.97it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:05,  2.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:04,  2.51it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  2.65it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:03,  2.77it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:02,  2.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.12it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.12it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.29it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.23it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.29it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.24it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.34it/s][A04/28/2024 23:01:19 - INFO - trainer.trainer_mod_2 - Epoch 60 finished. Took 39.09 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.94it/s]
Epoch:  61%|██████    | 61/100 [40:49<25:24, 39.08s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.34it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:37,  3.00it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.13it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.19it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.19it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.31it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.29it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.32it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  3.02it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.04it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.08it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.06it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.07it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.11it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.11it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.11it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.14it/s][A
Iteration:  19%|█▉        | 22/115 [00:07<00:29,  3.13it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.19it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.12it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.04it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:28,  3.03it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:27,  3.04it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:27,  3.06it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.14it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 23:01:30,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:01:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:01:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:01:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:01:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.19it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/28/2024 23:01:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:01:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8055130168453293, 'combined_score': 0.7471192535207039, 'eval_loss': 0.64179176, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [469, 313, 234, 314, 238, 245, 279, 256, 327, 1039, 165, 1521], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 80400152, 'remaining_params': 4617448, 'pruned_model_sparsity': 0.9456883280638362, 'expected_sparsity': 0.94085, 'target_sparsity': 0.95, 'step': 7050}


Iteration:  30%|███       | 35/115 [00:12<00:56,  1.41it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:47,  1.67it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:39,  1.97it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:35,  2.19it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:31,  2.42it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:28,  2.61it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.74it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:24,  2.92it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.09it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.23it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.23it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.21it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.21it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.26it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.24it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.22it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.23it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.23it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.11it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.15it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.18it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.19it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.16it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.15it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.13it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.20it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  3.04it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.09it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.10it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.00it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.01it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.13it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.14it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.15it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.18it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.18it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.22it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.26it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.25it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.28it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.26it/s][A[INFO|trainer.py:570] 2024-04-28 23:01:47,714 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:01:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:01:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:01:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:01:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.19it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.39it/s]04/28/2024 23:01:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:01:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8072837632776935, 'combined_score': 0.748004626736886, 'eval_loss': 0.6637371, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [464, 313, 234, 314, 238, 245, 278, 255, 324, 1021, 165, 1509], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 80426196, 'remaining_params': 4591404, 'pruned_model_sparsity': 0.9459946646341464, 'expected_sparsity': 0.94276, 'target_sparsity': 0.95, 'step': 7100}


Iteration:  74%|███████▍  | 85/115 [00:29<00:21,  1.43it/s][A04/28/2024 23:01:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 7100, Alignment: tensor([ 2,  4,  6, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:29<00:17,  1.70it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:14,  1.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:12,  2.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.38it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:10,  2.46it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:09,  2.63it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:08,  2.76it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.88it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:07,  2.92it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.00it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.06it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.21it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.15it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.19it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.01it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.90it/s][A
Iteration:  89%|████████▊ | 102/115 [00:35<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.05it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.08it/s][A
Iteration:  91%|█████████▏| 105/115 [00:36<00:03,  3.07it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.11it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.16it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.13it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.12it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.10it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.22it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.21it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.46it/s][A04/28/2024 23:01:58 - INFO - trainer.trainer_mod_2 - Epoch 61 finished. Took 39.08 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.94it/s]
Epoch:  62%|██████▏   | 62/100 [41:28<24:45, 39.08s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.14it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.21it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.11it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.10it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.15it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.16it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.28it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.16it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.16it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.27it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.25it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.24it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.24it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.22it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.15it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.13it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 23:02:04,932 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:02:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:02:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:02:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:02:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.38it/s]04/28/2024 23:02:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:02:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.8079268292682926, 'combined_score': 0.749551649928264, 'eval_loss': 0.64793813, 'head_layers': [0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [460, 313, 234, 314, 238, 244, 276, 254, 320, 1004, 165, 1496], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 80452240, 'remaining_params': 4565360, 'pruned_model_sparsity': 0.9463010012044565, 'expected_sparsity': 0.94454, 'target_sparsity': 0.95, 'step': 7150}


Iteration:  17%|█▋        | 20/115 [00:07<01:08,  1.39it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:55,  1.68it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:47,  1.95it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:43,  2.12it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:38,  2.34it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:34,  2.59it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:32,  2.73it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.88it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.94it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:28,  3.06it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.14it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.00it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.09it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.20it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.20it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.24it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.27it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.24it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.28it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.19it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.22it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.16it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.18it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.26it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.23it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.28it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.36it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.30it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.28it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.20it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.21it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.13it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.20it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.13it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.15it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.23it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.04it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.09it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.08it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.16it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.26it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.25it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.18it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.15it/s][A[INFO|trainer.py:570] 2024-04-28 23:02:21,965 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:02:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:02:21 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:02:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:02:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.17it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.37it/s]04/28/2024 23:02:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:02:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.817910447761194, 'combined_score': 0.7594454199590284, 'eval_loss': 0.6791133, 'head_layers': [0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [456, 312, 234, 314, 238, 243, 275, 253, 317, 990, 165, 1488], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 82358048, 'remaining_params': 2659552, 'pruned_model_sparsity': 0.9687176302318579, 'expected_sparsity': 0.94552, 'target_sparsity': 0.95, 'step': 7200}


Iteration:  61%|██████    | 70/115 [00:24<00:32,  1.39it/s][A04/28/2024 23:02:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 7200, Alignment: tensor([1, 1, 5, 8], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:24<00:26,  1.66it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:22,  1.94it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:19,  2.14it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:17,  2.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:15,  2.66it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.82it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.93it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.02it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.02it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  3.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.03it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.06it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.02it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.13it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.17it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.21it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.14it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.10it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.12it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.07it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.11it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.15it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.12it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.04it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.04it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  2.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.07it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.21it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.04it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.05it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.10it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.16it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.23it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.24it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.54it/s][A04/28/2024 23:02:37 - INFO - trainer.trainer_mod_2 - Epoch 62 finished. Took 39.0 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.95it/s]
Epoch:  63%|██████▎   | 63/100 [42:07<24:05, 39.06s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.26it/s][A[INFO|trainer.py:570] 2024-04-28 23:02:39,174 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:02:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:02:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:02:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:02:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.16it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.16it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.17it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.37it/s]04/28/2024 23:02:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:02:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8055130168453293, 'combined_score': 0.7471192535207039, 'eval_loss': 0.6468415, 'head_layers': [0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [453, 312, 234, 314, 238, 243, 274, 252, 315, 979, 165, 1481], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 82362644, 'remaining_params': 2654956, 'pruned_model_sparsity': 0.9687716896266185, 'expected_sparsity': 0.94685, 'target_sparsity': 0.95, 'step': 7250}


Iteration:   4%|▍         | 5/115 [00:02<01:25,  1.28it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:10,  1.56it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:58,  1.85it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:50,  2.13it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:44,  2.40it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:40,  2.61it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:37,  2.76it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:36,  2.85it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:34,  2.97it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:33,  2.99it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:33,  3.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.90it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:33,  2.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:31,  3.04it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:31,  3.06it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:30,  3.04it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.12it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.25it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.20it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.26it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:26,  3.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.23it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:26,  3.23it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.31it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.13it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.17it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.17it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.16it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.29it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.13it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.06it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.21it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.21it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.19it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.19it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.19it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.21it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.13it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.19it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.21it/s][A[INFO|trainer.py:570] 2024-04-28 23:02:56,344 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:02:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:02:56 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:02:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:02:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.17it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.37it/s]04/28/2024 23:02:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:02:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8144796380090498, 'combined_score': 0.7565045248868778, 'eval_loss': 0.6818622, 'head_layers': [0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [449, 312, 234, 313, 238, 243, 273, 251, 312, 968, 165, 1475], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 82368772, 'remaining_params': 2648828, 'pruned_model_sparsity': 0.9688437688196326, 'expected_sparsity': 0.94728, 'target_sparsity': 0.95, 'step': 7300}


Iteration:  48%|████▊     | 55/115 [00:20<00:42,  1.41it/s][A04/28/2024 23:02:57 - INFO - trainer.trainer_mod_2 - v4 Global step: 7300, Alignment: tensor([1, 4, 6, 8], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:20<00:35,  1.68it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:29,  1.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:25,  2.22it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:23,  2.40it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:21,  2.57it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.75it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.82it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.90it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:17,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.14it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.03it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.01it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  3.06it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.09it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.29it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.30it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:12,  3.27it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.23it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.20it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.19it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.13it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.24it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:09,  3.32it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.27it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.29it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.29it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.05it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.20it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.19it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.25it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.27it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.30it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.26it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.25it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.16it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.06it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.11it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.14it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.11it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.15it/s][A[INFO|trainer.py:570] 2024-04-28 23:03:13,381 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:03:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:03:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:03:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:03:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.42it/s]04/28/2024 23:03:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:03:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8134556574923548, 'combined_score': 0.7572180248246088, 'eval_loss': 0.644805, 'head_layers': [0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [446, 312, 234, 313, 237, 242, 272, 250, 310, 957, 165, 1468], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 82373368, 'remaining_params': 2644232, 'pruned_model_sparsity': 0.9688978282143933, 'expected_sparsity': 0.94827, 'target_sparsity': 0.95, 'step': 7350}


Iteration:  91%|█████████▏| 105/115 [00:37<00:07,  1.42it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:05,  1.74it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:03,  2.03it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.27it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.66it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.75it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  2.90it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.99it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.16it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.43it/s][A04/28/2024 23:03:17 - INFO - trainer.trainer_mod_2 - Epoch 63 finished. Took 40.04 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.87it/s]
Epoch:  64%|██████▍   | 64/100 [42:47<23:36, 39.35s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.14it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.19it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.20it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.02it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.15it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.15it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.20it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.23it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.33it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.35it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.25it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.24it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.16it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.12it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:33,  2.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:32,  2.94it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.11it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.09it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.17it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.14it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.12it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.18it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.25it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.26it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.21it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:25,  3.20it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.12it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.24it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:24,  3.20it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.22it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.15it/s][A
Iteration:  33%|███▎      | 38/115 [00:12<00:24,  3.21it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 23:03:30,309 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:03:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:03:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:03:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:03:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.17it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.37it/s]04/28/2024 23:03:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:03:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8122137404580153, 'combined_score': 0.7553715761113606, 'eval_loss': 0.6315464, 'head_layers': [0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [444, 312, 234, 313, 237, 242, 271, 249, 309, 950, 165, 1463], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2], 'pruned_params': 82376432, 'remaining_params': 2641168, 'pruned_model_sparsity': 0.9689338678109003, 'expected_sparsity': 0.94847, 'target_sparsity': 0.95, 'step': 7400}


Iteration:  35%|███▍      | 40/115 [00:13<00:53,  1.41it/s][A04/28/2024 23:03:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 7400, Alignment: tensor([ 0,  0,  6, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:14<00:43,  1.72it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:36,  2.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:31,  2.27it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:28,  2.48it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:26,  2.62it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:24,  2.76it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  2.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.03it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.15it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.18it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.27it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.27it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.28it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.28it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.21it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.28it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.28it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.25it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.27it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.25it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.12it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.09it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.14it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.09it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.12it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.09it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.11it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.10it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.24it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.25it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.28it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.29it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.23it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.19it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.24it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.19it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:11,  3.02it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.10it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.12it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.25it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.05it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.12it/s][A[INFO|trainer.py:570] 2024-04-28 23:03:47,239 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:03:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:03:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:03:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:03:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.37it/s]04/28/2024 23:03:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:03:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8192771084337349, 'combined_score': 0.7625797306874558, 'eval_loss': 0.6579164, 'head_layers': [0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [442, 311, 234, 313, 237, 242, 271, 248, 308, 942, 164, 1458], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 1], 'pruned_params': 82379496, 'remaining_params': 2638104, 'pruned_model_sparsity': 0.9689699074074074, 'expected_sparsity': 0.94931, 'target_sparsity': 0.95, 'step': 7450}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.40it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:14,  1.70it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:12,  1.90it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:10,  2.15it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:08,  2.38it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:07,  2.55it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:07,  2.66it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:06,  2.80it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.05it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.14it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.13it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.07it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  2.96it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.10it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.17it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.12it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.13it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.16it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.29it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.25it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.22it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.47it/s][A04/28/2024 23:03:56 - INFO - trainer.trainer_mod_2 - Epoch 64 finished. Took 38.75 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.97it/s]
Epoch:  65%|██████▌   | 65/100 [43:25<22:51, 39.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.23it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.16it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.17it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.12it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.14it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.18it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.26it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.22it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.27it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.21it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:28,  3.36it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.28it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.27it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.30it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.29it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.16it/s][A[INFO|trainer.py:570] 2024-04-28 23:04:04,265 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:04:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:04:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:04:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:04:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.37it/s]04/28/2024 23:04:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:04:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8169440242057489, 'combined_score': 0.7601876983773843, 'eval_loss': 0.63569987, 'head_layers': [0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [441, 311, 234, 313, 237, 242, 270, 247, 307, 937, 164, 1455], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 1], 'pruned_params': 82381028, 'remaining_params': 2636572, 'pruned_model_sparsity': 0.968987927205661, 'expected_sparsity': 0.94933, 'target_sparsity': 0.95, 'step': 7500}


Iteration:  22%|██▏       | 25/115 [00:09<01:05,  1.37it/s][A04/28/2024 23:04:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 7500, Alignment: tensor([ 2,  2,  5, 10], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:09<00:53,  1.68it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:45,  1.95it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:41,  2.12it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:35,  2.42it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:32,  2.61it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:31,  2.63it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:29,  2.79it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:27,  2.93it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.99it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.05it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.10it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.11it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.14it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.21it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.11it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.19it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.27it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.23it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.21it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.20it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.12it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.09it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.17it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.17it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.17it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.14it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.03it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.00it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.07it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.10it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.10it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.11it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.09it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.19it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.24it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.20it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.17it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.11it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 23:04:21,441 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:04:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:04:21 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:04:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:04:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.16it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.17it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.37it/s]04/28/2024 23:04:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:04:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8187311178247733, 'combined_score': 0.7623067353829749, 'eval_loss': 0.6539264, 'head_layers': [0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [439, 311, 233, 313, 237, 241, 269, 247, 305, 932, 164, 1452], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 1], 'pruned_params': 82384092, 'remaining_params': 2633508, 'pruned_model_sparsity': 0.9690239668021681, 'expected_sparsity': 0.9496, 'target_sparsity': 0.95, 'step': 7550}


Iteration:  65%|██████▌   | 75/115 [00:26<00:28,  1.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:22,  1.70it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:19,  1.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:16,  2.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:14,  2.51it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:12,  2.71it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.84it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.90it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.00it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.03it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.15it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.20it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.09it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.15it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.20it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.20it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.22it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.24it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.26it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.26it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.11it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.16it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.22it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.23it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.24it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.16it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.28it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.25it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.23it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.18it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.19it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.17it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.43it/s][A04/28/2024 23:04:35 - INFO - trainer.trainer_mod_2 - Epoch 65 finished. Took 38.72 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.97it/s]
Epoch:  66%|██████▌   | 66/100 [44:04<22:07, 39.04s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:39,  2.88it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.05it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.14it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.12it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.17it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.14it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 23:04:38,411 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:04:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:04:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:04:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:04:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.12it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.14it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/28/2024 23:04:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:04:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6862745098039216, 'f1': 0.7987421383647799, 'combined_score': 0.7425083240843507, 'eval_loss': 0.6432976, 'head_layers': [0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [437, 311, 233, 313, 237, 241, 269, 246, 304, 928, 164, 1449], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 1], 'pruned_params': 81994964, 'remaining_params': 3022636, 'pruned_model_sparsity': 0.9644469380457693, 'expected_sparsity': 0.9496, 'target_sparsity': 0.95, 'step': 7600}


Iteration:   9%|▊         | 10/115 [00:04<01:17,  1.35it/s][A04/28/2024 23:04:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 7600, Alignment: tensor([1, 3, 6, 8], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:04<01:02,  1.67it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:52,  1.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:46,  2.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:41,  2.43it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:37,  2.64it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.87it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  3.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:32,  3.01it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:30,  3.12it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.16it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.17it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:27,  3.25it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:27,  3.28it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.22it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.18it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.01it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.07it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.15it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.17it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.17it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:23,  3.37it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.25it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.25it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.24it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.18it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.13it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.13it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.07it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.12it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.16it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.20it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.17it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.21it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.09it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:19,  3.08it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.14it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.22it/s][A[INFO|trainer.py:570] 2024-04-28 23:04:55,387 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:04:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:04:55 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:04:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:04:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.14it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.14it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.34it/s]04/28/2024 23:04:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:04:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6813725490196079, 'f1': 0.7943037974683544, 'combined_score': 0.7378381732439812, 'eval_loss': 0.6396846, 'head_layers': [0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [435, 311, 233, 313, 237, 241, 268, 246, 303, 925, 164, 1447], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 1], 'pruned_params': 81998028, 'remaining_params': 3019572, 'pruned_model_sparsity': 0.9644829776422764, 'expected_sparsity': 0.94996, 'target_sparsity': 0.95, 'step': 7650}


Iteration:  52%|█████▏    | 60/115 [00:21<00:39,  1.40it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:32,  1.64it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:27,  1.91it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:21,  2.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:19,  2.56it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:18,  2.64it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:17,  2.81it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  2.97it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.08it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.11it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  3.06it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.16it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:12,  3.19it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.14it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.20it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.18it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.20it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.23it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.31it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.23it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:08,  3.32it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.10it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.06it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.08it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.08it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.10it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.11it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.14it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.22it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.17it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.09it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.12it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.10it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.24it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.23it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.23it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.15it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.13it/s][A[INFO|trainer.py:570] 2024-04-28 23:05:12,538 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:05:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:05:12 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:05:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:05:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.13it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.14it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/28/2024 23:05:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:05:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8006279434850863, 'combined_score': 0.7446767168405823, 'eval_loss': 0.64919114, 'head_layers': [0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [434, 311, 233, 313, 237, 241, 268, 245, 301, 921, 164, 1445], 'head_nums': [2, 2, 2, 2, 1, 4, 3, 1, 1, 1, 2, 1], 'pruned_params': 81999560, 'remaining_params': 3018040, 'pruned_model_sparsity': 0.96450099744053, 'expected_sparsity': 0.94975, 'target_sparsity': 0.95, 'step': 7700}


Iteration:  96%|█████████▌| 110/115 [00:38<00:03,  1.41it/s][A04/28/2024 23:05:13 - INFO - trainer.trainer_mod_2 - v4 Global step: 7700, Alignment: tensor([0, 0, 5, 9], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:39<00:02,  1.68it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  1.97it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.23it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.44it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.79it/s][A04/28/2024 23:05:15 - INFO - trainer.trainer_mod_2 - Epoch 66 finished. Took 40.22 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.86it/s]
Epoch:  67%|██████▋   | 67/100 [44:44<21:39, 39.39s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.37it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.30it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.16it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.18it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.15it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.26it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.24it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.24it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.17it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.17it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.10it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.13it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.03it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.11it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.26it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.25it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.26it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.31it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.31it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.23it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.17it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.19it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.23it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.06it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:27,  3.10it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.24it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.26it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.22it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.24it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:22,  3.35it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.28it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.27it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.26it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:21,  3.35it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.17it/s][A[INFO|trainer.py:570] 2024-04-28 23:05:29,410 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:05:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:05:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:05:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:05:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.16it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.18it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.17it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.15it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.15it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.35it/s]04/28/2024 23:05:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:05:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.803125, 'combined_score': 0.7471507352941176, 'eval_loss': 0.65387774, 'head_layers': [0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [433, 310, 233, 313, 237, 240, 267, 244, 299, 915, 164, 1441], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 82197188, 'remaining_params': 2820412, 'pruned_model_sparsity': 0.9668255514152364, 'expected_sparsity': 0.94978, 'target_sparsity': 0.95, 'step': 7750}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.41it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:40,  1.69it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:34,  1.98it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:30,  2.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.44it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:24,  2.64it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:23,  2.67it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:22,  2.78it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  2.96it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.01it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.03it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:19,  3.06it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.10it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.10it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.14it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.15it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.11it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.10it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  3.04it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.07it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.11it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.12it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.17it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.15it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.02it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.02it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:14,  2.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.10it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.11it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.21it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.16it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.29it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.23it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.24it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:08,  3.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.28it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.26it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.28it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.25it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.19it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.23it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.16it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.16it/s][A[INFO|trainer.py:570] 2024-04-28 23:05:46,529 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:05:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:05:46 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:05:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:05:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.13it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.14it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.34it/s]04/28/2024 23:05:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:05:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8012519561815337, 'combined_score': 0.744988723188806, 'eval_loss': 0.6436248, 'head_layers': [0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [433, 310, 233, 313, 237, 240, 266, 243, 297, 908, 164, 1438], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 82197188, 'remaining_params': 2820412, 'pruned_model_sparsity': 0.9668255514152364, 'expected_sparsity': 0.94976, 'target_sparsity': 0.95, 'step': 7800}


Iteration:  83%|████████▎ | 95/115 [00:32<00:14,  1.41it/s][A04/28/2024 23:05:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 7800, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.68it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:09,  1.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:07,  2.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.51it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.63it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.83it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.92it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.05it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.08it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.01it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.15it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.22it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.15it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.16it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.09it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.12it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.14it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.13it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.48it/s][A04/28/2024 23:05:54 - INFO - trainer.trainer_mod_2 - Epoch 67 finished. Took 38.66 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.97it/s]
Epoch:  68%|██████▊   | 68/100 [45:23<20:53, 39.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.31it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.33it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:37,  2.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.14it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.09it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.11it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.02it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.16it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.23it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.26it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.34it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.27it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:30,  3.31it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.14it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.03it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.05it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.08it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.11it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.22it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.24it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.18it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.23it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.26it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.24it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.22it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.21it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.17it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.15it/s][A[INFO|trainer.py:570] 2024-04-28 23:06:03,464 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:06:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:06:03 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:06:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:06:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.14it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.14it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.14it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.34it/s]04/28/2024 23:06:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:06:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8018720748829954, 'combined_score': 0.745298782539537, 'eval_loss': 0.64136237, 'head_layers': [0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [432, 310, 233, 313, 237, 240, 266, 242, 295, 903, 164, 1436], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 82198720, 'remaining_params': 2818880, 'pruned_model_sparsity': 0.96684357121349, 'expected_sparsity': 0.95007, 'target_sparsity': 0.95, 'step': 7850}


Iteration:  26%|██▌       | 30/115 [00:10<01:00,  1.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:50,  1.67it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:43,  1.91it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:37,  2.18it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:33,  2.43it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:32,  2.49it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:29,  2.67it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:27,  2.81it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.90it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.94it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.02it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:23,  3.04it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.07it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.07it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.06it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.06it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.19it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.21it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.29it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.22it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.23it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.18it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.16it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.15it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:16,  3.32it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:17,  3.10it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.16it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.10it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.16it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.19it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.15it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.17it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.17it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.13it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.18it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.17it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.21it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.24it/s][A[INFO|trainer.py:570] 2024-04-28 23:06:20,698 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:06:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:06:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:06:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:06:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.13it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/28/2024 23:06:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:06:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8117283950617284, 'combined_score': 0.7563543936092956, 'eval_loss': 0.63723725, 'head_layers': [0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [432, 309, 233, 313, 237, 240, 265, 242, 295, 900, 164, 1434], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 82198720, 'remaining_params': 2818880, 'pruned_model_sparsity': 0.96684357121349, 'expected_sparsity': 0.95022, 'target_sparsity': 0.95, 'step': 7900}


Iteration:  70%|██████▉   | 80/115 [00:28<00:24,  1.41it/s][A04/28/2024 23:06:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 7900, Alignment: tensor([1, 3, 6, 7], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:28<00:19,  1.70it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  1.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:12,  2.48it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:10,  2.74it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.83it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.08it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.17it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.12it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.04it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.14it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.20it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.18it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.08it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.21it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.21it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.23it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.23it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.16it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.14it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.19it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.18it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.23it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.19it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.45it/s][A04/28/2024 23:06:32 - INFO - trainer.trainer_mod_2 - Epoch 68 finished. Took 38.86 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  69%|██████▉   | 69/100 [46:02<20:11, 39.08s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.15it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.23it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.12it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.12it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.07it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.10it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.26it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.16it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.19it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 23:06:37,573 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:06:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:06:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:06:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:06:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.13it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.33it/s]04/28/2024 23:06:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:06:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6936274509803921, 'f1': 0.8055987558320373, 'combined_score': 0.7496131034062148, 'eval_loss': 0.63348705, 'head_layers': [0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [432, 309, 233, 313, 237, 240, 265, 242, 293, 896, 164, 1435], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 82198720, 'remaining_params': 2818880, 'pruned_model_sparsity': 0.96684357121349, 'expected_sparsity': 0.94992, 'target_sparsity': 0.95, 'step': 7950}


Iteration:  13%|█▎        | 15/115 [00:06<01:09,  1.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:58,  1.69it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:50,  1.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:44,  2.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:39,  2.43it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:36,  2.60it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:34,  2.75it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.97it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.13it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.14it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.01it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:30,  2.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  2.99it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.04it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:25,  3.26it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.16it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.16it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.11it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  3.01it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.04it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.10it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.04it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.13it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.11it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.17it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.19it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:23,  3.02it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.06it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.12it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.16it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.19it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.22it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.23it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.26it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.28it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.28it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.24it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.20it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.17it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.17it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.21it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.25it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.24it/s][A[INFO|trainer.py:570] 2024-04-28 23:06:54,729 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:06:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:06:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:06:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:06:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.29it/s]04/28/2024 23:06:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:06:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.803125, 'combined_score': 0.7471507352941176, 'eval_loss': 0.6308845, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [431, 309, 233, 313, 237, 239, 264, 241, 291, 892, 164, 1432], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81808060, 'remaining_params': 3209540, 'pruned_model_sparsity': 0.9622485226588376, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 8000}


Iteration:  57%|█████▋    | 65/115 [00:23<00:35,  1.40it/s][A04/28/2024 23:06:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 8000, Alignment: tensor([0, 0, 5, 7], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:23<00:29,  1.68it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:21,  2.22it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.45it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:17,  2.63it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:16,  2.64it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.72it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:15,  2.76it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:14,  2.87it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.96it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.95it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  3.04it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  3.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.04it/s][A
Iteration:  70%|██████▉   | 80/115 [00:28<00:11,  3.09it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.09it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.11it/s][A
Iteration:  72%|███████▏  | 83/115 [00:29<00:10,  3.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.21it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.27it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.14it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.17it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.17it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.21it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.21it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:05,  3.24it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.16it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.19it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.20it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.24it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.22it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.18it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.11it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.09it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.08it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.13it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.12it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.17it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.13it/s][A[INFO|trainer.py:570] 2024-04-28 23:07:11,870 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:07:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:07:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:07:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:07:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:07:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:07:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.804915514592934, 'combined_score': 0.7468205023945063, 'eval_loss': 0.65949667, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [432, 309, 233, 313, 237, 239, 264, 241, 290, 889, 164, 1430], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81806528, 'remaining_params': 3211072, 'pruned_model_sparsity': 0.9622305028605842, 'expected_sparsity': 0.94991, 'target_sparsity': 0.95, 'step': 8050}


Iteration: 100%|██████████| 115/115 [00:40<00:00,  1.46it/s][A04/28/2024 23:07:13 - INFO - trainer.trainer_mod_2 - Epoch 69 finished. Took 40.31 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.85it/s]
Epoch:  70%|███████   | 70/100 [46:42<19:43, 39.45s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.21it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.13it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.22it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.25it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.22it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.34it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.26it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.27it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.25it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.17it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.23it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.04it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:32,  3.01it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:32,  3.02it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.20it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.21it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.20it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.18it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.20it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.15it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.15it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.14it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.13it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.18it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.09it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.15it/s][A
Iteration:  30%|███       | 35/115 [00:11<00:25,  3.12it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:25,  3.15it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.19it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:24,  3.18it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.19it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.21it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.21it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.19it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:21,  3.31it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:20,  3.29it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:20,  3.28it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.24it/s][A[INFO|trainer.py:570] 2024-04-28 23:07:28,866 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:07:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:07:28 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:07:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:07:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:07:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:07:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6936274509803921, 'f1': 0.806201550387597, 'combined_score': 0.7499145006839946, 'eval_loss': 0.6444753, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [431, 309, 233, 312, 237, 239, 263, 240, 289, 884, 164, 1428], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81808060, 'remaining_params': 3209540, 'pruned_model_sparsity': 0.9622485226588376, 'expected_sparsity': 0.94973, 'target_sparsity': 0.95, 'step': 8100}


Iteration:  43%|████▎     | 50/115 [00:16<00:45,  1.42it/s][A04/28/2024 23:07:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 8100, Alignment: tensor([ 0,  1,  6, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:17<00:37,  1.70it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:32,  1.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:27,  2.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:25,  2.42it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:23,  2.56it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:21,  2.71it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:20,  2.89it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.10it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.24it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.27it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.29it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:14,  3.34it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.14it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.13it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.16it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.21it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.19it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.20it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.31it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.34it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:12,  3.07it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:12,  2.89it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.00it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.16it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.18it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.17it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.25it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.22it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.20it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.18it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.18it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.14it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:05,  3.21it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.17it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 23:07:45,946 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:07:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:07:45 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:07:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:07:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01,  9.87it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.00it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.09it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:07:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:07:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.696078431372549, 'f1': 0.8074534161490682, 'combined_score': 0.7517659237608085, 'eval_loss': 0.6444694, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [431, 308, 233, 312, 237, 238, 262, 239, 286, 879, 164, 1426], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81808060, 'remaining_params': 3209540, 'pruned_model_sparsity': 0.9622485226588376, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 8150}


Iteration:  87%|████████▋ | 100/115 [00:34<00:10,  1.38it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:08,  1.67it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  1.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:05,  2.21it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:04,  2.45it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.67it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:03,  2.77it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  2.91it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  2.94it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.01it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.10it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.24it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.10it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.37it/s][A04/28/2024 23:07:51 - INFO - trainer.trainer_mod_2 - Epoch 70 finished. Took 38.68 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.97it/s]
Epoch:  71%|███████   | 71/100 [47:21<18:57, 39.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.42it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.35it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.27it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.27it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.27it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.13it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.09it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.24it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.22it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:34,  3.02it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.05it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.12it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.10it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.11it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.10it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.21it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.17it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.20it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.23it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.24it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.34it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.23it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.23it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.18it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.14it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.14it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.17it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:27,  3.08it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.13it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.14it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.17it/s][A[INFO|trainer.py:570] 2024-04-28 23:08:02,879 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:08:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:08:02 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:08:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:08:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:08:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:08:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6936274509803921, 'f1': 0.8049921996879874, 'combined_score': 0.7493098253341898, 'eval_loss': 0.6419108, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [431, 308, 233, 312, 237, 238, 262, 238, 285, 873, 164, 1424], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81808060, 'remaining_params': 3209540, 'pruned_model_sparsity': 0.9622485226588376, 'expected_sparsity': 0.94986, 'target_sparsity': 0.95, 'step': 8200}


Iteration:  30%|███       | 35/115 [00:12<00:56,  1.41it/s][A04/28/2024 23:08:04 - INFO - trainer.trainer_mod_2 - v4 Global step: 8200, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:12<00:46,  1.71it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:39,  1.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:34,  2.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:31,  2.44it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:28,  2.66it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.84it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:24,  2.98it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  2.99it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.05it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.09it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.07it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.13it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.17it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.15it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.17it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.15it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.02it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:19,  3.06it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.19it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.27it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.31it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.30it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.21it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.15it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.05it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  3.05it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.08it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.10it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.13it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.12it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.21it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.03it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:13,  3.07it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.12it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.02it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.06it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.03it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:11,  3.06it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.15it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:10,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 23:08:20,094 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:08:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:08:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:08:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:08:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 23:08:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:08:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8081123244929797, 'combined_score': 0.7533208681288428, 'eval_loss': 0.6384829, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [431, 307, 233, 312, 237, 238, 261, 237, 283, 867, 163, 1423], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81808060, 'remaining_params': 3209540, 'pruned_model_sparsity': 0.9622485226588376, 'expected_sparsity': 0.94964, 'target_sparsity': 0.95, 'step': 8250}


Iteration:  74%|███████▍  | 85/115 [00:29<00:21,  1.40it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:17,  1.68it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:14,  1.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:12,  2.22it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.46it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:09,  2.59it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:08,  2.74it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:08,  2.82it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  2.95it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:07,  2.99it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.03it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.17it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.23it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.18it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.16it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.10it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.17it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.18it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.19it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.16it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.18it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.21it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.27it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.56it/s][A04/28/2024 23:08:30 - INFO - trainer.trainer_mod_2 - Epoch 71 finished. Took 38.86 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  72%|███████▏  | 72/100 [48:00<18:15, 39.11s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:38,  2.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.12it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.21it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.19it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.20it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.16it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.19it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.19it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.05it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.14it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:33,  2.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.06it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:33,  2.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 23:08:37,166 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:08:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:08:37 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:08:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:08:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:08:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:08:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6936274509803921, 'f1': 0.8043818466353678, 'combined_score': 0.74900464880788, 'eval_loss': 0.63350034, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [432, 307, 233, 312, 236, 237, 260, 236, 281, 860, 163, 1419], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81806528, 'remaining_params': 3211072, 'pruned_model_sparsity': 0.9622305028605842, 'expected_sparsity': 0.94995, 'target_sparsity': 0.95, 'step': 8300}


Iteration:  17%|█▋        | 20/115 [00:07<01:08,  1.39it/s][A04/28/2024 23:08:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 8300, Alignment: tensor([1, 3, 6, 8], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:08<00:56,  1.65it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:48,  1.92it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:43,  2.13it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:37,  2.42it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:34,  2.64it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:32,  2.76it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.88it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:29,  2.92it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:28,  3.00it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.02it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.03it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.08it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.12it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.19it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.07it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.13it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.13it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.14it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:22,  3.22it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.20it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.11it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:22,  3.11it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.17it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.19it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.19it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.10it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.08it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.13it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.14it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.24it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.27it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.21it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.16it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.18it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.28it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.21it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.23it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.13it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.17it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.19it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.21it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.23it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.26it/s][A[INFO|trainer.py:570] 2024-04-28 23:08:54,236 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:08:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:08:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:08:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:08:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:08:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:08:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6911764705882353, 'f1': 0.8055555555555556, 'combined_score': 0.7483660130718954, 'eval_loss': 0.640014, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [433, 306, 233, 312, 236, 236, 259, 235, 278, 855, 163, 1416], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81804996, 'remaining_params': 3212604, 'pruned_model_sparsity': 0.9622124830623306, 'expected_sparsity': 0.95021, 'target_sparsity': 0.95, 'step': 8350}


Iteration:  61%|██████    | 70/115 [00:24<00:31,  1.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:25,  1.73it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:21,  2.00it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:18,  2.27it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:16,  2.43it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:15,  2.63it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:14,  2.75it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:12,  2.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.09it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.16it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.14it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.13it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.09it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.11it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:09,  3.08it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.11it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.12it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.19it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.20it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:07,  3.00it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:07,  2.98it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  2.97it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.12it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:06,  2.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.07it/s][A
Iteration:  86%|████████▌ | 99/115 [00:34<00:05,  3.17it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.17it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.28it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.25it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.26it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.17it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.16it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.17it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.12it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.26it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.17it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.26it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.56it/s][A04/28/2024 23:09:09 - INFO - trainer.trainer_mod_2 - Epoch 72 finished. Took 38.9 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  73%|███████▎  | 73/100 [48:39<17:34, 39.05s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.33it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.28it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 23:09:11,168 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:09:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:09:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:09:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:09:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:09:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:09:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.696078431372549, 'f1': 0.8092307692307692, 'combined_score': 0.7526546003016591, 'eval_loss': 0.64743894, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [433, 306, 233, 311, 236, 236, 259, 235, 277, 853, 163, 1414], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81804996, 'remaining_params': 3212604, 'pruned_model_sparsity': 0.9622124830623306, 'expected_sparsity': 0.95033, 'target_sparsity': 0.95, 'step': 8400}


Iteration:   4%|▍         | 5/115 [00:02<01:26,  1.27it/s][A04/28/2024 23:09:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 8400, Alignment: tensor([0, 1, 5, 7], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:08,  1.58it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:56,  1.91it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:48,  2.20it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:44,  2.41it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:40,  2.62it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:37,  2.76it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:36,  2.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:34,  2.96it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:33,  3.00it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:32,  3.06it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:31,  3.11it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:30,  3.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.11it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:30,  3.14it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.13it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.17it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.17it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.16it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.13it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.13it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:29,  3.00it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.09it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.09it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:26,  3.11it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.17it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.14it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.15it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.19it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.16it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.02it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  3.03it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.10it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.17it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.22it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.25it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.21it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.26it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.19it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.14it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.11it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.15it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.12it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.22it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 23:09:28,382 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:09:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:09:28 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:09:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:09:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:09:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:09:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8087091757387247, 'combined_score': 0.7536192937517152, 'eval_loss': 0.6372428, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [434, 305, 233, 311, 236, 236, 258, 235, 276, 849, 163, 1413], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81803464, 'remaining_params': 3214136, 'pruned_model_sparsity': 0.9621944632640771, 'expected_sparsity': 0.94996, 'target_sparsity': 0.95, 'step': 8450}


Iteration:  48%|████▊     | 55/115 [00:20<00:42,  1.40it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:34,  1.69it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:29,  1.97it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:25,  2.24it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:23,  2.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:21,  2.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.76it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.89it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:16,  3.03it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.08it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.07it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:14,  3.19it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.19it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.18it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:13,  3.08it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.12it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.24it/s][A
Iteration:  67%|██████▋   | 77/115 [00:27<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.21it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.22it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:09,  3.31it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.12it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.14it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.10it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:07,  3.15it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.18it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.22it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.10it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:06,  3.13it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.12it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.20it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.29it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.31it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.29it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 23:09:45,474 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:09:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:09:45 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:09:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:09:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:09:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:09:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8116385911179173, 'combined_score': 0.7550840014413116, 'eval_loss': 0.6524427, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [436, 305, 233, 311, 236, 236, 257, 234, 275, 846, 163, 1412], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81800400, 'remaining_params': 3217200, 'pruned_model_sparsity': 0.96215842366757, 'expected_sparsity': 0.95011, 'target_sparsity': 0.95, 'step': 8500}


Iteration:  91%|█████████▏| 105/115 [00:37<00:07,  1.40it/s][A04/28/2024 23:09:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 8500, Alignment: tensor([0, 1, 5, 8], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:37<00:05,  1.68it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:03,  2.00it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:03,  2.27it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.63it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  2.75it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  2.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.91it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  2.90it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.20it/s][A04/28/2024 23:09:49 - INFO - trainer.trainer_mod_2 - Epoch 73 finished. Took 40.25 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.86it/s]
Epoch:  74%|███████▍  | 74/100 [49:19<17:04, 39.41s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:31,  3.59it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:31,  3.55it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.13it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.18it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.12it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.24it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.21it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.19it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.21it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.11it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.19it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.19it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.11it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.16it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.25it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.33it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:26,  3.38it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:26,  3.34it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.20it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.20it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.20it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:27,  3.14it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.15it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.13it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.09it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.13it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:25,  3.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:26,  3.02it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:25,  3.09it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:24,  3.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 23:10:02,459 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:10:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:10:02 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:10:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:10:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.09it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.29it/s]04/28/2024 23:10:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:10:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8122137404580153, 'combined_score': 0.7553715761113606, 'eval_loss': 0.65173036, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [437, 304, 233, 311, 236, 236, 257, 234, 274, 843, 163, 1411], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81798868, 'remaining_params': 3218732, 'pruned_model_sparsity': 0.9621404038693164, 'expected_sparsity': 0.94973, 'target_sparsity': 0.95, 'step': 8550}


Iteration:  35%|███▍      | 40/115 [00:13<00:53,  1.40it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:44,  1.68it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:37,  1.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:32,  2.21it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:28,  2.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:25,  2.71it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:24,  2.83it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:23,  2.92it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  2.99it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.01it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.05it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.07it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.12it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  2.96it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.01it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:19,  3.05it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.05it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.19it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:18,  3.01it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:18,  2.98it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.09it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.09it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:17,  2.94it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  2.98it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:16,  3.01it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.07it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.24it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.12it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.13it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.22it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.27it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.22it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:12,  3.16it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.27it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.29it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.25it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.32it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.30it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.25it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.16it/s][A[INFO|trainer.py:570] 2024-04-28 23:10:19,612 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:10:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:10:19 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:10:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:10:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:10:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:10:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.815267175572519, 'combined_score': 0.7593492740607694, 'eval_loss': 0.6410853, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [439, 304, 233, 311, 236, 235, 256, 233, 272, 839, 163, 1408], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81795804, 'remaining_params': 3221796, 'pruned_model_sparsity': 0.9621043642728094, 'expected_sparsity': 0.94972, 'target_sparsity': 0.95, 'step': 8600}


Iteration:  78%|███████▊  | 90/115 [00:31<00:17,  1.40it/s][A04/28/2024 23:10:21 - INFO - trainer.trainer_mod_2 - v4 Global step: 8600, Alignment: tensor([ 0,  0,  5, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:31<00:14,  1.68it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:11,  1.96it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:10,  2.18it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:08,  2.44it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:07,  2.68it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.84it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:06,  2.88it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  2.97it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.04it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.04it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.09it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.12it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.11it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.19it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.13it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:01,  3.18it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.32it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.27it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.27it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.22it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.47it/s][A04/28/2024 23:10:28 - INFO - trainer.trainer_mod_2 - Epoch 74 finished. Took 38.79 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  75%|███████▌  | 75/100 [49:58<16:20, 39.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.27it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.27it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:32,  3.42it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.36it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.29it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.29it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.23it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.31it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.18it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:34,  3.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.07it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.09it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.07it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.08it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.09it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.22it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.23it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.21it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.29it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.13it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.24it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.21it/s][A[INFO|trainer.py:570] 2024-04-28 23:10:36,485 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:10:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:10:36 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:10:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:10:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:10:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:10:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.8221225710014948, 'combined_score': 0.7652279521674141, 'eval_loss': 0.6454145, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [439, 303, 232, 310, 236, 234, 255, 232, 270, 833, 163, 1405], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81331608, 'remaining_params': 3685992, 'pruned_model_sparsity': 0.9566443654019874, 'expected_sparsity': 0.9498, 'target_sparsity': 0.95, 'step': 8650}
04/28/2024 23:10:37 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 75 | Step: 8650 | Model size: 3685992 | Score: 0.70833]

[INFO|configuration_utils.py:439] 2024-04-28 23:10:37,820 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 23:10:38,474 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/pytorch_model.bin

Iteration:  22%|██▏       | 25/115 [00:09<01:21,  1.10it/s][A
Iteration:  23%|██▎       | 26/115 [00:10<01:04,  1.38it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:53,  1.64it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:45,  1.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:11<00:39,  2.18it/s][A
Iteration:  26%|██▌       | 30/115 [00:11<00:35,  2.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:32,  2.59it/s][A
Iteration:  28%|██▊       | 32/115 [00:12<00:29,  2.77it/s][A
Iteration:  29%|██▊       | 33/115 [00:12<00:28,  2.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.01it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.13it/s][A
Iteration:  31%|███▏      | 36/115 [00:13<00:25,  3.08it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:25,  3.08it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:14<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.13it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:15<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:15<00:22,  3.25it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.22it/s][A
Iteration:  39%|███▉      | 45/115 [00:16<00:21,  3.27it/s][A
Iteration:  40%|████      | 46/115 [00:16<00:20,  3.34it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.27it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:17<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.22it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.15it/s][A
Iteration:  45%|████▌     | 52/115 [00:18<00:19,  3.18it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.15it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.05it/s][A
Iteration:  48%|████▊     | 55/115 [00:19<00:19,  3.07it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.22it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.19it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:17,  3.22it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.24it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:17,  3.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:16,  3.28it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:15,  3.26it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.24it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.26it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:14,  3.35it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.28it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:13,  3.36it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.22it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.09it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  2.95it/s][A[INFO|trainer.py:570] 2024-04-28 23:10:54,187 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:10:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:10:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:10:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:10:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:10:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:10:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7107843137254902, 'f1': 0.8233532934131738, 'combined_score': 0.767068803569332, 'eval_loss': 0.64611727, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [440, 302, 232, 310, 236, 234, 254, 231, 268, 827, 163, 1402], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81331608, 'remaining_params': 3685992, 'pruned_model_sparsity': 0.9566443654019874, 'expected_sparsity': 0.9498, 'target_sparsity': 0.95, 'step': 8700}
04/28/2024 23:10:55 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 75 | Step: 8700 | Model size: 3685992 | Score: 0.71078]

[INFO|configuration_utils.py:439] 2024-04-28 23:10:55,523 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 23:10:58,243 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/pytorch_model.bin

Iteration:  65%|██████▌   | 75/115 [00:29<01:01,  1.55s/it][A04/28/2024 23:10:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 8700, Alignment: tensor([ 0,  0,  6, 10], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:29<00:45,  1.17s/it][A
Iteration:  67%|██████▋   | 77/115 [00:30<00:34,  1.09it/s][A
Iteration:  68%|██████▊   | 78/115 [00:30<00:26,  1.38it/s][A
Iteration:  69%|██████▊   | 79/115 [00:30<00:21,  1.64it/s][A
Iteration:  70%|██████▉   | 80/115 [00:31<00:18,  1.90it/s][A
Iteration:  70%|███████   | 81/115 [00:31<00:15,  2.18it/s][A
Iteration:  71%|███████▏  | 82/115 [00:31<00:13,  2.41it/s][A
Iteration:  72%|███████▏  | 83/115 [00:32<00:12,  2.61it/s][A
Iteration:  73%|███████▎  | 84/115 [00:32<00:11,  2.79it/s][A
Iteration:  74%|███████▍  | 85/115 [00:32<00:10,  2.87it/s][A
Iteration:  75%|███████▍  | 86/115 [00:33<00:09,  2.96it/s][A
Iteration:  76%|███████▌  | 87/115 [00:33<00:09,  3.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:33<00:08,  3.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:33<00:08,  3.14it/s][A
Iteration:  78%|███████▊  | 90/115 [00:34<00:07,  3.17it/s][A
Iteration:  79%|███████▉  | 91/115 [00:34<00:07,  3.13it/s][A
Iteration:  80%|████████  | 92/115 [00:34<00:07,  3.06it/s][A
Iteration:  81%|████████  | 93/115 [00:35<00:07,  3.03it/s][A
Iteration:  82%|████████▏ | 94/115 [00:35<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 95/115 [00:35<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 96/115 [00:36<00:06,  2.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:36<00:05,  3.02it/s][A
Iteration:  85%|████████▌ | 98/115 [00:36<00:05,  2.89it/s][A
Iteration:  86%|████████▌ | 99/115 [00:37<00:05,  2.92it/s][A
Iteration:  87%|████████▋ | 100/115 [00:37<00:04,  3.01it/s][A
Iteration:  88%|████████▊ | 101/115 [00:37<00:04,  3.11it/s][A
Iteration:  89%|████████▊ | 102/115 [00:38<00:04,  3.12it/s][A
Iteration:  90%|████████▉ | 103/115 [00:38<00:03,  3.14it/s][A
Iteration:  90%|█████████ | 104/115 [00:38<00:03,  3.12it/s][A
Iteration:  91%|█████████▏| 105/115 [00:39<00:03,  3.11it/s][A
Iteration:  92%|█████████▏| 106/115 [00:39<00:02,  3.10it/s][A
Iteration:  93%|█████████▎| 107/115 [00:39<00:02,  3.14it/s][A
Iteration:  94%|█████████▍| 108/115 [00:40<00:02,  3.16it/s][A
Iteration:  95%|█████████▍| 109/115 [00:40<00:01,  3.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:40<00:01,  3.25it/s][A
Iteration:  97%|█████████▋| 111/115 [00:41<00:01,  3.26it/s][A
Iteration:  97%|█████████▋| 112/115 [00:41<00:00,  3.28it/s][A
Iteration:  98%|█████████▊| 113/115 [00:41<00:00,  3.21it/s][A
Iteration:  99%|█████████▉| 114/115 [00:41<00:00,  3.32it/s][A
Iteration: 100%|██████████| 115/115 [00:42<00:00,  3.54it/s][A04/28/2024 23:11:10 - INFO - trainer.trainer_mod_2 - Epoch 75 finished. Took 42.17 seconds.
Iteration: 100%|██████████| 115/115 [00:42<00:00,  2.73it/s]
Epoch:  76%|███████▌  | 76/100 [50:40<16:02, 40.11s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:32,  3.48it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.33it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.29it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.23it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.15it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.18it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.01it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 23:11:14,016 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:11:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:11:14 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:11:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:11:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:11:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:11:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8184523809523809, 'combined_score': 0.7597163865546218, 'eval_loss': 0.66127956, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [442, 301, 232, 310, 236, 233, 253, 229, 265, 821, 162, 1397], 'head_nums': [2, 2, 2, 2, 1, 3, 3, 1, 1, 1, 2, 1], 'pruned_params': 81330076, 'remaining_params': 3687524, 'pruned_model_sparsity': 0.9566263456037338, 'expected_sparsity': 0.94959, 'target_sparsity': 0.95, 'step': 8750}


Iteration:   9%|▊         | 10/115 [00:04<01:16,  1.37it/s][A
Iteration:  10%|▉         | 11/115 [00:04<01:02,  1.66it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:52,  1.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:45,  2.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:41,  2.45it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:38,  2.61it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:35,  2.78it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  2.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  3.03it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:31,  3.07it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:32,  2.92it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:32,  2.89it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:31,  2.95it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:30,  2.99it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.98it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.04it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.13it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.25it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.26it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:25,  3.25it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.28it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:24,  3.29it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:26,  3.10it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.10it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.17it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.19it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.19it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.16it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.17it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.19it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.09it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.17it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.16it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.20it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:19,  3.29it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.20it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.25it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:18,  3.28it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.16it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.17it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.05it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.12it/s][A[INFO|trainer.py:570] 2024-04-28 23:11:31,185 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:11:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:11:31 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:11:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:11:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:11:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:11:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.8221225710014948, 'combined_score': 0.7652279521674141, 'eval_loss': 0.6572313, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [443, 300, 232, 309, 236, 233, 251, 228, 263, 814, 162, 1394], 'head_nums': [3, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 81330076, 'remaining_params': 3687524, 'pruned_model_sparsity': 0.9566263456037338, 'expected_sparsity': 0.94972, 'target_sparsity': 0.95, 'step': 8800}


Iteration:  52%|█████▏    | 60/115 [00:21<00:39,  1.39it/s][A04/28/2024 23:11:32 - INFO - trainer.trainer_mod_2 - v4 Global step: 8800, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:21<00:32,  1.68it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:27,  1.94it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.22it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:18,  2.67it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.86it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:15,  3.13it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.19it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:13,  3.28it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.32it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.29it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.36it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.31it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:11,  3.34it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.32it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:10,  3.31it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.29it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.13it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.13it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.12it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.11it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.14it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.15it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.31it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:07,  3.26it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.30it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.12it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.25it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.28it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.26it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.27it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.22it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.23it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.17it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.10it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.13it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.10it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.15it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.22it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.22it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.11it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 23:11:47,979 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:11:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:11:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:11:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:11:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:11:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:11:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8184523809523809, 'combined_score': 0.7597163865546218, 'eval_loss': 0.6761169, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [443, 300, 232, 309, 235, 232, 250, 227, 260, 809, 162, 1389], 'head_nums': [3, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 81330076, 'remaining_params': 3687524, 'pruned_model_sparsity': 0.9566263456037338, 'expected_sparsity': 0.94991, 'target_sparsity': 0.95, 'step': 8850}


Iteration:  96%|█████████▌| 110/115 [00:38<00:03,  1.42it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:02,  1.71it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  1.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.30it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.49it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.84it/s][A04/28/2024 23:11:50 - INFO - trainer.trainer_mod_2 - Epoch 76 finished. Took 39.92 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.88it/s]
Epoch:  77%|███████▋  | 77/100 [51:20<15:21, 40.05s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:40,  2.80it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.20it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.16it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.30it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.27it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.23it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.16it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.26it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.22it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:30,  3.35it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.30it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.22it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.10it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.13it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:30,  3.10it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.12it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.17it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.18it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.29it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.32it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.31it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.27it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:23,  3.37it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:23,  3.36it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.33it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.29it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.28it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.23it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.26it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:21,  3.24it/s][A[INFO|trainer.py:570] 2024-04-28 23:12:04,719 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:12:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:12:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:12:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:12:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:12:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:12:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.817910447761194, 'combined_score': 0.7594454199590284, 'eval_loss': 0.6464967, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [443, 299, 232, 309, 235, 231, 249, 225, 258, 803, 162, 1385], 'head_nums': [3, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 81331608, 'remaining_params': 3685992, 'pruned_model_sparsity': 0.9566443654019874, 'expected_sparsity': 0.94994, 'target_sparsity': 0.95, 'step': 8900}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.41it/s][A04/28/2024 23:12:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 8900, Alignment: tensor([0, 0, 5, 8], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:15<00:40,  1.71it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:34,  1.96it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:30,  2.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.47it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:24,  2.65it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:22,  2.85it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.05it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.09it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.09it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.18it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.16it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.19it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.09it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.12it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  2.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.07it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.10it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.12it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.11it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.15it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.21it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.10it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.17it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.18it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.12it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.24it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.31it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.29it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.19it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.10it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.12it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.18it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.14it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.11it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:09,  2.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.03it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.09it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:08,  2.96it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.07it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.03it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 23:12:21,943 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:12:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:12:21 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:12:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:12:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:12:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:12:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8191330343796712, 'combined_score': 0.7612822034643454, 'eval_loss': 0.6469688, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [443, 297, 232, 308, 235, 230, 248, 224, 256, 798, 162, 1377], 'head_nums': [3, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 81334672, 'remaining_params': 3682928, 'pruned_model_sparsity': 0.9566804049984944, 'expected_sparsity': 0.94989, 'target_sparsity': 0.95, 'step': 8950}


Iteration:  83%|████████▎ | 95/115 [00:32<00:14,  1.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.66it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:09,  1.94it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:08,  2.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.37it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.57it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:05,  2.71it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.11it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.13it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.13it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.17it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.24it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.25it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.24it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.32it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.15it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.37it/s][A04/28/2024 23:12:29 - INFO - trainer.trainer_mod_2 - Epoch 77 finished. Took 38.71 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.97it/s]
Epoch:  78%|███████▊  | 78/100 [51:58<14:32, 39.65s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.12it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.11it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.97it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.07it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.13it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.21it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.22it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.13it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.17it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.12it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.19it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.17it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.18it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.22it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.20it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:29,  3.02it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:29,  3.06it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.11it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:28,  3.05it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.12it/s][A[INFO|trainer.py:570] 2024-04-28 23:12:39,028 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:12:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:12:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:12:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:12:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:12:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:12:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8191330343796712, 'combined_score': 0.7612822034643454, 'eval_loss': 0.675082, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [444, 296, 232, 308, 235, 229, 246, 222, 253, 794, 161, 1373], 'head_nums': [3, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 81334672, 'remaining_params': 3682928, 'pruned_model_sparsity': 0.9566804049984944, 'expected_sparsity': 0.9501, 'target_sparsity': 0.95, 'step': 9000}


Iteration:  26%|██▌       | 30/115 [00:10<01:01,  1.39it/s][A04/28/2024 23:12:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 9000, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:11<00:50,  1.66it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:42,  1.97it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:36,  2.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:32,  2.48it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:30,  2.65it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.78it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:26,  2.91it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.07it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.13it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.20it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.22it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.23it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.06it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.08it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.12it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.15it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:22,  2.95it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:22,  2.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.08it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.12it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.23it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.27it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.30it/s][A
Iteration:  51%|█████▏    | 59/115 [00:20<00:17,  3.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.29it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.19it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.22it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.22it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.13it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.13it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.13it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.14it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.16it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.16it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.11it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.21it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.24it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.28it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.26it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.29it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.26it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 23:12:56,130 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:12:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:12:56 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:12:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:12:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:12:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:12:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8198198198198199, 'combined_score': 0.7628510863804983, 'eval_loss': 0.6460794, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [446, 297, 231, 308, 235, 229, 245, 221, 251, 789, 161, 1365], 'head_nums': [3, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 81330076, 'remaining_params': 3687524, 'pruned_model_sparsity': 0.9566263456037338, 'expected_sparsity': 0.95006, 'target_sparsity': 0.95, 'step': 9050}


Iteration:  70%|██████▉   | 80/115 [00:27<00:25,  1.38it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:20,  1.67it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  1.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:12,  2.43it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:11,  2.55it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.67it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:10,  2.78it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  2.96it/s][A
Iteration:  78%|███████▊  | 90/115 [00:31<00:08,  3.04it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.11it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.16it/s][A
Iteration:  81%|████████  | 93/115 [00:32<00:06,  3.14it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.14it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:33<00:05,  3.28it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.30it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.26it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.16it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.25it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.20it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.20it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.08it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.15it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.14it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.12it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.00it/s][A
Iteration:  95%|█████████▍| 109/115 [00:37<00:02,  3.00it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.07it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.20it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:00,  3.24it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.22it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.10it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.37it/s][A04/28/2024 23:13:08 - INFO - trainer.trainer_mod_2 - Epoch 78 finished. Took 38.98 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.95it/s]
Epoch:  79%|███████▉  | 79/100 [52:37<13:48, 39.45s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:34,  3.26it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.04it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.03it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.12it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.16it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:35,  3.00it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.13it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.15it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.25it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 23:13:13,258 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:13:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:13:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:13:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:13:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:13:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:13:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8191330343796712, 'combined_score': 0.7612822034643454, 'eval_loss': 0.6697394, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [448, 296, 231, 307, 235, 228, 244, 220, 248, 784, 161, 1361], 'head_nums': [4, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 81132448, 'remaining_params': 3885152, 'pruned_model_sparsity': 0.9543017916290274, 'expected_sparsity': 0.94968, 'target_sparsity': 0.95, 'step': 9100}


Iteration:  13%|█▎        | 15/115 [00:06<01:11,  1.39it/s][A04/28/2024 23:13:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 9100, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<00:59,  1.66it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:50,  1.94it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:43,  2.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:39,  2.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:37,  2.52it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.66it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:33,  2.75it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.87it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:30,  3.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:29,  3.07it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 27/115 [00:10<00:29,  3.03it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.07it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.11it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.14it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:26,  3.18it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.18it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:24,  3.29it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.23it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.27it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.23it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.20it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.22it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:23,  3.19it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.19it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.16it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.27it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.23it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.19it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.30it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.32it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.24it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.27it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.27it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.24it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.22it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.25it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.25it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.27it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.15it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.14it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.16it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.18it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 23:13:30,247 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:13:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:13:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:13:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:13:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:13:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:13:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8191330343796712, 'combined_score': 0.7612822034643454, 'eval_loss': 0.67174786, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [449, 295, 231, 307, 235, 228, 243, 219, 246, 779, 160, 1358], 'head_nums': [4, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 81132448, 'remaining_params': 3885152, 'pruned_model_sparsity': 0.9543017916290274, 'expected_sparsity': 0.94989, 'target_sparsity': 0.95, 'step': 9150}


Iteration:  57%|█████▋    | 65/115 [00:23<00:35,  1.41it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:29,  1.68it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:20,  2.24it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.46it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:17,  2.64it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.13it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.21it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.23it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.23it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.16it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.13it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.11it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.11it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.17it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.19it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.21it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.20it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.19it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.25it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:06,  3.36it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.18it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.25it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.30it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.39it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:04,  3.41it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.26it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.28it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.09it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.94it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:04,  2.99it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.04it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.07it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.09it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.19it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.27it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.23it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.26it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.25it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.27it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.21it/s][A[INFO|trainer.py:570] 2024-04-28 23:13:47,081 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:13:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:13:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:13:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:13:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:13:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:13:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8185907046476761, 'combined_score': 0.761011038598348, 'eval_loss': 0.6450451, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [450, 295, 231, 306, 235, 227, 241, 217, 243, 774, 160, 1354], 'head_nums': [4, 2, 2, 2, 1, 3, 2, 1, 1, 1, 2, 1], 'pruned_params': 81130916, 'remaining_params': 3886684, 'pruned_model_sparsity': 0.9542837718307738, 'expected_sparsity': 0.94986, 'target_sparsity': 0.95, 'step': 9200}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.45it/s][A04/28/2024 23:13:48 - INFO - trainer.trainer_mod_2 - Epoch 79 finished. Took 39.96 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.88it/s]
Epoch:  80%|████████  | 80/100 [53:17<13:12, 39.60s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A04/28/2024 23:13:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 9200, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:35,  3.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.05it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.23it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.30it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.26it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.19it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.22it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.25it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.28it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.09it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.17it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.22it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.21it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.26it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.24it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.11it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.20it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.20it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.13it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.25it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.32it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.19it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.13it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.18it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.20it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:26,  3.14it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.13it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.18it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.22it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.19it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.22it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.20it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:25,  2.95it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:23,  3.07it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.17it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.12it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:22,  3.15it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:22,  3.10it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:21,  3.16it/s][A
Iteration:  42%|████▏     | 48/115 [00:15<00:21,  3.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.16it/s][A[INFO|trainer.py:570] 2024-04-28 23:14:04,155 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:14:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:14:04 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:14:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:14:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:14:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:14:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8184523809523809, 'combined_score': 0.7597163865546218, 'eval_loss': 0.68651134, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [451, 294, 231, 306, 235, 226, 240, 216, 241, 769, 160, 1351], 'head_nums': [4, 2, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81327012, 'remaining_params': 3690588, 'pruned_model_sparsity': 0.9565903060072267, 'expected_sparsity': 0.95, 'target_sparsity': 0.95, 'step': 9250}


Iteration:  43%|████▎     | 50/115 [00:17<00:46,  1.40it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:39,  1.63it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:33,  1.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:28,  2.18it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:25,  2.42it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:23,  2.61it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:21,  2.70it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:20,  2.80it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:19,  2.93it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.10it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.07it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.20it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.16it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.18it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.19it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.06it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:15,  3.07it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.03it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:13,  3.08it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.06it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.11it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.15it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.26it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.28it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.18it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.20it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.20it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.22it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.04it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:09,  3.04it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.10it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.11it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.14it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.29it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.24it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:07,  3.10it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.12it/s][A
Iteration:  83%|████████▎ | 95/115 [00:31<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:05,  3.18it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.23it/s][A
Iteration:  85%|████████▌ | 98/115 [00:32<00:05,  3.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:05,  3.13it/s][A[INFO|trainer.py:570] 2024-04-28 23:14:21,328 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:14:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:14:21 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:14:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:14:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 23:14:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:14:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.817910447761194, 'combined_score': 0.7594454199590284, 'eval_loss': 0.6657791, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [451, 294, 231, 305, 235, 226, 239, 215, 239, 764, 159, 1347], 'head_nums': [4, 2, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81327012, 'remaining_params': 3690588, 'pruned_model_sparsity': 0.9565903060072267, 'expected_sparsity': 0.95019, 'target_sparsity': 0.95, 'step': 9300}


Iteration:  87%|████████▋ | 100/115 [00:34<00:10,  1.41it/s][A04/28/2024 23:14:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 9300, Alignment: tensor([ 0,  4,  5, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:34<00:08,  1.69it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  1.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:05,  2.29it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:04,  2.52it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.70it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:03,  2.87it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  2.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.08it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.15it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.22it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.21it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.23it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.32it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.60it/s][A04/28/2024 23:14:27 - INFO - trainer.trainer_mod_2 - Epoch 80 finished. Took 38.68 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.97it/s]
Epoch:  81%|████████  | 81/100 [53:56<12:27, 39.33s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.12it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.16it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.21it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.26it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:32,  3.37it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.18it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.23it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.22it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.25it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.27it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.17it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.21it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.27it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.13it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.20it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.21it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.18it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.16it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.11it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.21it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.20it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:28,  3.08it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.15it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.22it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.24it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.13it/s][A[INFO|trainer.py:570] 2024-04-28 23:14:38,036 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:14:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:14:38 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:14:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:14:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.03it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.25it/s]04/28/2024 23:14:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:14:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.696078431372549, 'f1': 0.8143712574850299, 'combined_score': 0.7552248444287895, 'eval_loss': 0.66006595, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [453, 293, 231, 305, 235, 225, 238, 214, 237, 761, 159, 1343], 'head_nums': [4, 2, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81325480, 'remaining_params': 3692120, 'pruned_model_sparsity': 0.9565722862089732, 'expected_sparsity': 0.95006, 'target_sparsity': 0.95, 'step': 9350}


Iteration:  30%|███       | 35/115 [00:12<00:56,  1.41it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:46,  1.70it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:39,  1.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:34,  2.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:30,  2.47it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:28,  2.63it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:27,  2.71it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.84it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.97it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.06it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.10it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.14it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.17it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.19it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.24it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.07it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.21it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.10it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.19it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.05it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.06it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.19it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.24it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.27it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.17it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.20it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.22it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.17it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.22it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.22it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.30it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.30it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.29it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.29it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.29it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.22it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.32it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.30it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.32it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:09,  3.31it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.20it/s][A[INFO|trainer.py:570] 2024-04-28 23:14:54,966 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:14:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:14:54 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:14:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:14:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:14:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:14:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.819672131147541, 'combined_score': 0.7615517518482804, 'eval_loss': 0.67047745, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [456, 293, 230, 304, 235, 224, 237, 213, 235, 758, 159, 1339], 'head_nums': [4, 2, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81320884, 'remaining_params': 3696716, 'pruned_model_sparsity': 0.9565182268142126, 'expected_sparsity': 0.95008, 'target_sparsity': 0.95, 'step': 9400}


Iteration:  74%|███████▍  | 85/115 [00:29<00:21,  1.40it/s][A04/28/2024 23:14:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 9400, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:29<00:17,  1.70it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:14,  1.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:12,  2.22it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.43it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:09,  2.63it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:08,  2.82it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.14it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.18it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.07it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.12it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.16it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.17it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.20it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.22it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.27it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.27it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.05it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.11it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.16it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.12it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.39it/s][A04/28/2024 23:15:05 - INFO - trainer.trainer_mod_2 - Epoch 81 finished. Took 38.55 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.98it/s]
Epoch:  82%|████████▏ | 82/100 [54:35<11:43, 39.09s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.15it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.36it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.31it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.23it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.15it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:36,  2.98it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.00it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.05it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.26it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.25it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.21it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.20it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.22it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:31,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 23:15:11,917 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:15:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:15:11 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:15:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:15:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:15:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:15:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8191330343796712, 'combined_score': 0.7612822034643454, 'eval_loss': 0.67300534, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [457, 293, 230, 304, 234, 224, 236, 212, 233, 755, 158, 1336], 'head_nums': [4, 2, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81319352, 'remaining_params': 3698248, 'pruned_model_sparsity': 0.9565002070159591, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 9450}


Iteration:  17%|█▋        | 20/115 [00:07<01:07,  1.41it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:55,  1.70it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:46,  1.98it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:40,  2.25it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:36,  2.49it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:33,  2.68it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:31,  2.81it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.93it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.01it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.08it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  3.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:27,  3.03it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.08it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.08it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:27,  2.99it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:26,  3.06it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.08it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.12it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.13it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.18it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.24it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.12it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.20it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.20it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.20it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  3.01it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.04it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.05it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:21,  3.06it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.07it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.05it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.15it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.18it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.18it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.20it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.25it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.29it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.26it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.21it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:14,  3.30it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.27it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.17it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.16it/s][A[INFO|trainer.py:570] 2024-04-28 23:15:29,028 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:15:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:15:29 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:15:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:15:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:15:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:15:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8208955223880596, 'combined_score': 0.7633889376646181, 'eval_loss': 0.6861644, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [459, 294, 230, 304, 234, 223, 236, 210, 232, 750, 158, 1334], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81118660, 'remaining_params': 3898940, 'pruned_model_sparsity': 0.9541396134447455, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 9500}


Iteration:  61%|██████    | 70/115 [00:24<00:32,  1.40it/s][A04/28/2024 23:15:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 9500, Alignment: tensor([ 0,  2,  5, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:25<00:26,  1.67it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:21,  1.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:18,  2.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:17,  2.40it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:15,  2.63it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:14,  2.77it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:13,  2.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:12,  2.97it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.01it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.04it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:11,  2.98it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.06it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.08it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.14it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.19it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.21it/s][A
Iteration:  76%|███████▌  | 87/115 [00:30<00:08,  3.23it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.22it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:07,  3.31it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.28it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.21it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.20it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.24it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.23it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.22it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.15it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.08it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.12it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.12it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.06it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.03it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.07it/s][A
Iteration:  92%|█████████▏| 106/115 [00:36<00:02,  3.15it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.24it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.19it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.17it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.29it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.09it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.46it/s][A04/28/2024 23:15:44 - INFO - trainer.trainer_mod_2 - Epoch 82 finished. Took 38.8 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.96it/s]
Epoch:  83%|████████▎ | 83/100 [55:13<11:03, 39.00s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:42,  2.67it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.20it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A[INFO|trainer.py:570] 2024-04-28 23:15:46,033 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:15:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:15:46 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:15:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:15:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   8%|▊         | 1/13 [00:00<00:01,  9.84it/s][A[A

Evaluation:  23%|██▎       | 3/13 [00:00<00:00, 10.01it/s][A[A

Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 10.05it/s][A[A

Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  85%|████████▍ | 11/13 [00:01<00:00, 10.06it/s][A[A

Evaluation: 100%|██████████| 13/13 [00:01<00:00, 10.51it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.25it/s]04/28/2024 23:15:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:15:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8172362555720655, 'combined_score': 0.7578828336683856, 'eval_loss': 0.69004756, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [461, 294, 230, 303, 234, 223, 235, 209, 231, 747, 158, 1331], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81115596, 'remaining_params': 3902004, 'pruned_model_sparsity': 0.9541035738482385, 'expected_sparsity': 0.95005, 'target_sparsity': 0.95, 'step': 9550}


Iteration:   4%|▍         | 5/115 [00:02<01:27,  1.26it/s][A
Iteration:   5%|▌         | 6/115 [00:03<01:08,  1.58it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:56,  1.90it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:49,  2.18it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:42,  2.49it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:38,  2.71it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:36,  2.88it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:34,  2.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:33,  3.04it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:32,  3.11it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:31,  3.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:30,  3.21it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:30,  3.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.22it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.22it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:28,  3.21it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.08it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.12it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.23it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.21it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:26,  3.31it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.30it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.29it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.30it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:26,  3.17it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.17it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.17it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.18it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.10it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.14it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.24it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.24it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.23it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.24it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.26it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.35it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.12it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.15it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.04it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:20,  3.03it/s][A[INFO|trainer.py:570] 2024-04-28 23:16:02,972 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:16:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:16:02 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:16:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:16:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:16:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:16:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.817910447761194, 'combined_score': 0.7594454199590284, 'eval_loss': 0.66872287, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [463, 294, 230, 303, 234, 222, 234, 207, 229, 745, 158, 1329], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81112532, 'remaining_params': 3905068, 'pruned_model_sparsity': 0.9540675342517314, 'expected_sparsity': 0.94993, 'target_sparsity': 0.95, 'step': 9600}


Iteration:  48%|████▊     | 55/115 [00:19<00:43,  1.38it/s][A04/28/2024 23:16:04 - INFO - trainer.trainer_mod_2 - v4 Global step: 9600, Alignment: tensor([0, 2, 6, 9], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:20<00:35,  1.66it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:29,  1.95it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:25,  2.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:23,  2.43it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:21,  2.57it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.75it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.85it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.96it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.04it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.19it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:15,  3.19it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.14it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.21it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.21it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.27it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.25it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.16it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.22it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.17it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.17it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:10,  3.29it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.12it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.09it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.23it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.23it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.23it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.18it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.20it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.22it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.24it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.25it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.26it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.31it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.10it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.14it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.17it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.03it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.07it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.12it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.12it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 23:16:20,008 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:16:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:16:20 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:16:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:16:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:16:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:16:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8173652694610778, 'combined_score': 0.7591728308089702, 'eval_loss': 0.66709244, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [464, 295, 230, 303, 233, 222, 233, 206, 228, 742, 158, 1327], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81109468, 'remaining_params': 3908132, 'pruned_model_sparsity': 0.9540314946552243, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 9650}


Iteration:  91%|█████████▏| 105/115 [00:36<00:07,  1.39it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:05,  1.68it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:04,  1.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.43it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.59it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.74it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  2.85it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.86it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.93it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.29it/s][A04/28/2024 23:16:24 - INFO - trainer.trainer_mod_2 - Epoch 83 finished. Took 39.99 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.88it/s]
Epoch:  84%|████████▍ | 84/100 [55:53<10:28, 39.30s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.24it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.08it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:36,  3.07it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.05it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.07it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.05it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.24it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.17it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.13it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.16it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.03it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.12it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.16it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:29,  3.32it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.26it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:29,  3.22it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.20it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.18it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.23it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.29it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.28it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.30it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:26,  3.32it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.37it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:25,  3.36it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.37it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.30it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.14it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.27it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.29it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.30it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:22,  3.37it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:22,  3.35it/s][A[INFO|trainer.py:570] 2024-04-28 23:16:36,838 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:16:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:16:36 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:16:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:16:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 23:16:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:16:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8173652694610778, 'combined_score': 0.7591728308089702, 'eval_loss': 0.6697541, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [466, 295, 230, 302, 233, 222, 232, 204, 226, 738, 157, 1325], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81106404, 'remaining_params': 3911196, 'pruned_model_sparsity': 0.9539954550587173, 'expected_sparsity': 0.94988, 'target_sparsity': 0.95, 'step': 9700}


Iteration:  35%|███▍      | 40/115 [00:13<00:53,  1.41it/s][A04/28/2024 23:16:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 9700, Alignment: tensor([ 0,  4,  5, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:14<00:43,  1.70it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:36,  2.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:32,  2.22it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:29,  2.40it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:27,  2.58it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:24,  2.77it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:23,  2.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.15it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:21,  3.09it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  2.95it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.99it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.05it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.10it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.17it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.20it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.17it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.22it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.26it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.26it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.26it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.21it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.28it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:13,  3.30it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.37it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:14,  3.05it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.20it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.27it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.28it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.31it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.24it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  3.06it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.18it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.22it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.19it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.19it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.13it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 23:16:53,775 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:16:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:16:53 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:16:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:16:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:16:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:16:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.696078431372549, 'f1': 0.8154761904761906, 'combined_score': 0.7557773109243697, 'eval_loss': 0.6839845, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [468, 295, 230, 302, 233, 221, 231, 203, 225, 735, 157, 1322], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81103340, 'remaining_params': 3914260, 'pruned_model_sparsity': 0.9539594154622102, 'expected_sparsity': 0.94997, 'target_sparsity': 0.95, 'step': 9750}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:14,  1.71it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:11,  1.98it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:10,  2.15it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:08,  2.38it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:07,  2.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.77it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  2.96it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.01it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.06it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.11it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.08it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.09it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.20it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.20it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.24it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.27it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.25it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.17it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.17it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.19it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.22it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.20it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.46it/s][A04/28/2024 23:17:02 - INFO - trainer.trainer_mod_2 - Epoch 84 finished. Took 38.46 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.99it/s]
Epoch:  85%|████████▌ | 85/100 [56:32<09:45, 39.05s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.21it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:36,  3.08it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.18it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.14it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.17it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.19it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.19it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.13it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.16it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.29it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.27it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.22it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.26it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.25it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.20it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 23:17:10,708 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:17:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:17:10 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:17:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:17:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:17:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:17:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8155922038980509, 'combined_score': 0.7570608078313783, 'eval_loss': 0.66803145, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [471, 295, 230, 302, 233, 221, 230, 202, 224, 732, 157, 1318], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81098744, 'remaining_params': 3918856, 'pruned_model_sparsity': 0.9539053560674495, 'expected_sparsity': 0.9501, 'target_sparsity': 0.95, 'step': 9800}


Iteration:  22%|██▏       | 25/115 [00:09<01:04,  1.41it/s][A04/28/2024 23:17:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 9800, Alignment: tensor([0, 1, 5, 8], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:09<00:52,  1.70it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:44,  1.98it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:38,  2.24it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:35,  2.45it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:32,  2.65it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:30,  2.78it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:28,  2.93it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.05it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.11it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.09it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.12it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.17it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.16it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.09it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.12it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.22it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.22it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.24it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.19it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.24it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.13it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.19it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.29it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.28it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.25it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.24it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.23it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.26it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.36it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.20it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.23it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.00it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:17,  3.05it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.16it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.20it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.29it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.25it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.10it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.14it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.27it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.22it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.27it/s][A[INFO|trainer.py:570] 2024-04-28 23:17:27,611 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:17:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:17:27 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:17:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:17:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:17:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:17:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8180451127819548, 'combined_score': 0.7607382426654872, 'eval_loss': 0.6710226, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [473, 295, 230, 301, 233, 221, 229, 200, 222, 729, 156, 1316], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81095680, 'remaining_params': 3921920, 'pruned_model_sparsity': 0.9538693164709425, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 9850}


Iteration:  65%|██████▌   | 75/115 [00:26<00:28,  1.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:23,  1.65it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:19,  1.91it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:17,  2.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:15,  2.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:13,  2.55it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:12,  2.73it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:11,  2.80it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:11,  2.89it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:10,  3.00it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.07it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.06it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.10it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.09it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:08,  2.94it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  2.95it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.06it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.08it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.13it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.15it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.16it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.19it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.18it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.16it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.24it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.33it/s][A
Iteration:  90%|████████▉ | 103/115 [00:35<00:03,  3.30it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.24it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.19it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.30it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.25it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.26it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.25it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.26it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.34it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.30it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.30it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.56it/s][A04/28/2024 23:17:41 - INFO - trainer.trainer_mod_2 - Epoch 85 finished. Took 38.62 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.98it/s]
Epoch:  86%|████████▌ | 86/100 [57:10<09:04, 38.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:32,  3.55it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.39it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.34it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:32,  3.42it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:32,  3.37it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.28it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.36it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.10it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 23:17:44,600 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:17:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:17:44 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:17:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:17:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:17:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:17:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8127853881278538, 'combined_score': 0.7556573999462799, 'eval_loss': 0.6503645, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [474, 296, 230, 301, 233, 221, 228, 199, 221, 725, 156, 1313], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81092616, 'remaining_params': 3924984, 'pruned_model_sparsity': 0.9538332768744354, 'expected_sparsity': 0.94981, 'target_sparsity': 0.95, 'step': 9900}


Iteration:   9%|▊         | 10/115 [00:04<01:16,  1.37it/s][A04/28/2024 23:17:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 9900, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:04<01:02,  1.66it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:52,  1.96it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:46,  2.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:40,  2.47it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:38,  2.62it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:36,  2.75it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:32,  2.97it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:30,  3.12it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:30,  3.12it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.14it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.13it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.20it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.17it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.15it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:27,  3.20it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:26,  3.24it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.22it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:27,  3.09it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.19it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.20it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.20it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.17it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.21it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.13it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.17it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.16it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.18it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.19it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.21it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.19it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.19it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.31it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.42it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.34it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.27it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:18,  3.29it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.29it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.25it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.22it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.29it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.26it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.28it/s][A[INFO|trainer.py:570] 2024-04-28 23:18:01,461 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:18:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:18:01 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:18:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:18:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:18:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:18:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8180451127819548, 'combined_score': 0.7607382426654872, 'eval_loss': 0.68172425, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [475, 296, 230, 300, 233, 221, 227, 198, 219, 721, 156, 1311], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81091084, 'remaining_params': 3926516, 'pruned_model_sparsity': 0.9538152570761819, 'expected_sparsity': 0.94976, 'target_sparsity': 0.95, 'step': 9950}


Iteration:  52%|█████▏    | 60/115 [00:21<00:38,  1.41it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:31,  1.70it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:26,  2.00it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:23,  2.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.43it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:19,  2.62it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.78it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.84it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:16,  2.92it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:15,  2.96it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:15,  2.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:14,  3.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.12it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.13it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.26it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.25it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.22it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:10,  3.28it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.19it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.20it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.11it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.00it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.10it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.18it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.17it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.23it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.16it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.20it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.17it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.01it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.06it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  2.94it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  2.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.05it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.06it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.09it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.17it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.14it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.16it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.21it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.10it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.12it/s][A[INFO|trainer.py:570] 2024-04-28 23:18:18,686 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:18:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:18:18 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:18:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:18:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:18:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:18:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8173652694610778, 'combined_score': 0.7591728308089702, 'eval_loss': 0.69924897, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [477, 295, 229, 299, 232, 220, 226, 197, 218, 717, 156, 1308], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81089552, 'remaining_params': 3928048, 'pruned_model_sparsity': 0.9537972372779283, 'expected_sparsity': 0.94979, 'target_sparsity': 0.95, 'step': 10000}


Iteration:  96%|█████████▌| 110/115 [00:38<00:03,  1.39it/s][A04/28/2024 23:18:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 10000, Alignment: tensor([0, 1, 5, 7], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:38<00:02,  1.68it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  1.95it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.21it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.45it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.85it/s][A04/28/2024 23:18:21 - INFO - trainer.trainer_mod_2 - Epoch 86 finished. Took 39.98 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.88it/s]
Epoch:  87%|████████▋ | 87/100 [57:50<08:30, 39.24s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.35it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.25it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.15it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.32it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.26it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.23it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.24it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.24it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.16it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.15it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.15it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.15it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.13it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.19it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.24it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.26it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.25it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.21it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.19it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.22it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.21it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.25it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.18it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:28,  3.05it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:28,  3.10it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.11it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.25it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:25,  3.22it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.28it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.30it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.26it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.26it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.24it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:23,  3.24it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:21,  3.35it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:21,  3.28it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:21,  3.31it/s][A[INFO|trainer.py:570] 2024-04-28 23:18:35,465 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:18:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:18:35 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:18:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:18:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:18:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:18:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8180451127819548, 'combined_score': 0.7607382426654872, 'eval_loss': 0.6827248, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [478, 295, 229, 298, 232, 220, 224, 195, 217, 712, 156, 1304], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81088020, 'remaining_params': 3929580, 'pruned_model_sparsity': 0.9537792174796748, 'expected_sparsity': 0.94998, 'target_sparsity': 0.95, 'step': 10050}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.42it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:40,  1.71it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:34,  2.00it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:29,  2.27it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:26,  2.50it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:25,  2.56it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:23,  2.72it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:21,  2.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.09it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.08it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:20,  2.93it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:19,  3.05it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.05it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.13it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.08it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.10it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.08it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.12it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:17,  3.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.08it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.08it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.01it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.06it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.07it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.08it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:14,  3.08it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:13,  3.14it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.15it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.09it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.23it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.18it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:11,  3.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.26it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.19it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.18it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:08,  3.28it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.38it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.34it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:07,  3.34it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.26it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.30it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:07,  3.25it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.23it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.26it/s][A[INFO|trainer.py:570] 2024-04-28 23:18:52,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:18:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:18:52 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:18:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:18:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 23:18:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:18:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8162650602409639, 'combined_score': 0.7586227261989134, 'eval_loss': 0.66958725, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [478, 295, 229, 298, 231, 220, 223, 194, 215, 707, 156, 1301], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81088020, 'remaining_params': 3929580, 'pruned_model_sparsity': 0.9537792174796748, 'expected_sparsity': 0.95019, 'target_sparsity': 0.95, 'step': 10100}


Iteration:  83%|████████▎ | 95/115 [00:32<00:14,  1.42it/s][A04/28/2024 23:18:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 10100, Alignment: tensor([ 0,  2,  5, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.69it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:09,  1.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:07,  2.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.39it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:05,  2.59it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:05,  2.75it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.86it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.09it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.12it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.15it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.25it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.08it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.13it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.18it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.23it/s][A
Iteration:  98%|█████████▊| 113/115 [00:38<00:00,  3.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.32it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.50it/s][A04/28/2024 23:19:00 - INFO - trainer.trainer_mod_2 - Epoch 87 finished. Took 38.58 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.98it/s]
Epoch:  88%|████████▊ | 88/100 [58:29<07:48, 39.04s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.07it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.26it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.20it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.19it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.17it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.20it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.22it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.21it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.20it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.22it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:33,  3.06it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.11it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.23it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.22it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.30it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.25it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.12it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.18it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.28it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.11it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.15it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.25it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.29it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.29it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:28,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 23:19:09,467 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:19:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:19:09 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:19:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:19:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:19:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:19:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8180451127819548, 'combined_score': 0.7607382426654872, 'eval_loss': 0.67899686, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [480, 295, 229, 297, 231, 220, 222, 194, 214, 703, 155, 1298], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81084956, 'remaining_params': 3932644, 'pruned_model_sparsity': 0.9537431778831678, 'expected_sparsity': 0.95021, 'target_sparsity': 0.95, 'step': 10150}


Iteration:  26%|██▌       | 30/115 [00:10<01:01,  1.39it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:50,  1.67it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:43,  1.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:37,  2.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:33,  2.43it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:29,  2.68it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.81it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:26,  2.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:25,  3.03it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.07it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.11it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.20it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.13it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.15it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.15it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.21it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.16it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:19,  3.34it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:19,  3.30it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.27it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.22it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.20it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.20it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.14it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:19,  3.08it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.10it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.16it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.18it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.21it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.16it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.14it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.18it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.17it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.20it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.17it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.17it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.22it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.20it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.21it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.31it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.35it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.35it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:11,  3.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:11,  3.30it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.38it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.33it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 23:19:26,348 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:19:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:19:26 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:19:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:19:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:19:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:19:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.8188736681887367, 'combined_score': 0.7636035007610351, 'eval_loss': 0.66056, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [482, 296, 229, 297, 230, 220, 222, 193, 213, 700, 155, 1295], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81080360, 'remaining_params': 3937240, 'pruned_model_sparsity': 0.9536891184884071, 'expected_sparsity': 0.95029, 'target_sparsity': 0.95, 'step': 10200}


Iteration:  70%|██████▉   | 80/115 [00:27<00:25,  1.39it/s][A04/28/2024 23:19:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 10200, Alignment: tensor([0, 1, 5, 7], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:27<00:20,  1.66it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  1.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.21it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.41it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:11,  2.60it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.81it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.92it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.05it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.05it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.10it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.14it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.11it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.27it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.27it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.32it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.29it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.24it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.25it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.26it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.35it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.35it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.31it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.27it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.30it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.34it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.15it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.14it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.17it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.19it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.19it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.20it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.38it/s][A04/28/2024 23:19:38 - INFO - trainer.trainer_mod_2 - Epoch 88 finished. Took 38.39 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.00it/s]
Epoch:  89%|████████▉ | 89/100 [59:07<07:07, 38.84s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.14it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.11it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.18it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.24it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.18it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.21it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.23it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.06it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.19it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.11it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.18it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.24it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.22it/s][A[INFO|trainer.py:570] 2024-04-28 23:19:43,187 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:19:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:19:43 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:19:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:19:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.05it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:19:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:19:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8161434977578476, 'combined_score': 0.7573364547612766, 'eval_loss': 0.6981186, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [486, 296, 229, 296, 230, 219, 222, 193, 213, 696, 155, 1292], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81074232, 'remaining_params': 3943368, 'pruned_model_sparsity': 0.953617039295393, 'expected_sparsity': 0.95015, 'target_sparsity': 0.95, 'step': 10250}


Iteration:  13%|█▎        | 15/115 [00:06<01:12,  1.38it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:58,  1.69it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:49,  1.96it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:43,  2.22it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:39,  2.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:35,  2.70it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:33,  2.81it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:32,  2.89it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:31,  2.96it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:30,  3.01it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.11it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:29,  2.99it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.05it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.11it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.08it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:27,  3.13it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:25,  3.26it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.29it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:24,  3.29it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:24,  3.29it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.29it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.23it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.24it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.28it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.28it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.28it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.15it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.27it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.24it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:20,  3.27it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.30it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.26it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.25it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.19it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.18it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.10it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.22it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.24it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.24it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.25it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.14it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:18,  2.98it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.05it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:16,  3.16it/s][A[INFO|trainer.py:570] 2024-04-28 23:20:00,099 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:20:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:20:00 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:20:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:20:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.08it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:20:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:20:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.818320610687023, 'combined_score': 0.7633269720101782, 'eval_loss': 0.65642244, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [488, 297, 229, 296, 230, 219, 221, 193, 212, 693, 156, 1290], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81069636, 'remaining_params': 3947964, 'pruned_model_sparsity': 0.9535629799006323, 'expected_sparsity': 0.95007, 'target_sparsity': 0.95, 'step': 10300}


Iteration:  57%|█████▋    | 65/115 [00:22<00:35,  1.41it/s][A04/28/2024 23:20:01 - INFO - trainer.trainer_mod_2 - v4 Global step: 10300, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:23<00:29,  1.64it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.93it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:21,  2.20it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.50it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:17,  2.64it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:16,  2.66it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:15,  2.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:14,  2.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  2.98it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  2.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.15it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  3.06it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.11it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.15it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.18it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.13it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:29<00:09,  3.15it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.15it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.19it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.14it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.18it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.17it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.24it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.20it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.26it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.21it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.23it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:34<00:04,  3.25it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.23it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.23it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.28it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.30it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.33it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.14it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.16it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.20it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.20it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.33it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.36it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.34it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.41it/s][A[INFO|trainer.py:570] 2024-04-28 23:20:16,928 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:20:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:20:16 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:20:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:20:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:20:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:20:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.8205128205128206, 'combined_score': 0.764423076923077, 'eval_loss': 0.6879358, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [492, 297, 229, 296, 230, 219, 221, 192, 211, 691, 156, 1288], 'head_nums': [4, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81063508, 'remaining_params': 3954092, 'pruned_model_sparsity': 0.9534909007076182, 'expected_sparsity': 0.94989, 'target_sparsity': 0.95, 'step': 10350}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.49it/s][A04/28/2024 23:20:18 - INFO - trainer.trainer_mod_2 - Epoch 89 finished. Took 39.81 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.89it/s]
Epoch:  90%|█████████ | 90/100 [59:47<06:31, 39.13s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.12it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:33,  3.37it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.13it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.18it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.21it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.24it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.06it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:34,  3.06it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.09it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.17it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.24it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.21it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.18it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:29,  3.31it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.11it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.12it/s][A
Iteration:  17%|█▋        | 19/115 [00:06<00:31,  3.08it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.13it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.24it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.25it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.25it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:28,  3.14it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.16it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:27,  3.19it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:27,  3.15it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.20it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.24it/s][A
Iteration:  28%|██▊       | 32/115 [00:10<00:25,  3.26it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.28it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:24,  3.27it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.26it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.37it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.26it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.25it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.31it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.27it/s][A
Iteration:  37%|███▋      | 42/115 [00:13<00:22,  3.20it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.21it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.18it/s][A
Iteration:  39%|███▉      | 45/115 [00:14<00:22,  3.13it/s][A
Iteration:  40%|████      | 46/115 [00:14<00:22,  3.12it/s][A
Iteration:  41%|████      | 47/115 [00:14<00:21,  3.13it/s][A
Iteration:  42%|████▏     | 48/115 [00:14<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:15<00:20,  3.27it/s][A[INFO|trainer.py:570] 2024-04-28 23:20:33,853 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:20:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:20:33 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:20:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:20:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:20:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:20:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.8205128205128206, 'combined_score': 0.764423076923077, 'eval_loss': 0.68781286, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [494, 297, 229, 296, 230, 219, 220, 192, 211, 688, 155, 1286], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 80864348, 'remaining_params': 4153252, 'pruned_model_sparsity': 0.9511483269346582, 'expected_sparsity': 0.94976, 'target_sparsity': 0.95, 'step': 10400}


Iteration:  43%|████▎     | 50/115 [00:16<00:45,  1.42it/s][A04/28/2024 23:20:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 10400, Alignment: tensor([ 0,  4,  5, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:17<00:36,  1.73it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:31,  2.02it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:27,  2.26it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:24,  2.47it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:21,  2.73it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:20,  2.88it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:19,  3.01it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.11it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.18it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.16it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.21it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:15,  3.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.28it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.20it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.15it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.26it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:13,  3.28it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.23it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.22it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.19it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.25it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.21it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.05it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:11,  2.97it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:11,  3.06it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.09it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.07it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:10,  3.10it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.12it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.12it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.14it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.18it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.22it/s][A
Iteration:  80%|████████  | 92/115 [00:30<00:06,  3.31it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:06,  3.37it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.32it/s][A
Iteration:  83%|████████▎ | 95/115 [00:30<00:06,  3.27it/s][A
Iteration:  83%|████████▎ | 96/115 [00:31<00:05,  3.28it/s][A
Iteration:  84%|████████▍ | 97/115 [00:31<00:05,  3.34it/s][A
Iteration:  85%|████████▌ | 98/115 [00:31<00:05,  3.32it/s][A
Iteration:  86%|████████▌ | 99/115 [00:32<00:04,  3.34it/s][A[INFO|trainer.py:570] 2024-04-28 23:20:50,682 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:20:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:20:50 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:20:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:20:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:20:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:20:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8158295281582952, 'combined_score': 0.7596304503536575, 'eval_loss': 0.6583622, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [497, 297, 229, 296, 230, 219, 220, 192, 210, 683, 155, 1283], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 80859752, 'remaining_params': 4157848, 'pruned_model_sparsity': 0.9510942675398977, 'expected_sparsity': 0.94986, 'target_sparsity': 0.95, 'step': 10450}


Iteration:  87%|████████▋ | 100/115 [00:33<00:10,  1.42it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:08,  1.71it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:06,  1.99it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:05,  2.24it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:04,  2.48it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.68it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:03,  2.84it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  2.83it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  2.78it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:02,  2.95it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.03it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.07it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:01,  2.92it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.01it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.29it/s][A04/28/2024 23:20:56 - INFO - trainer.trainer_mod_2 - Epoch 90 finished. Took 38.51 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.99it/s]
Epoch:  91%|█████████ | 91/100 [1:00:26<05:50, 38.95s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.27it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.27it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.14it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:37,  2.95it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.06it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:35,  3.08it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.09it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.12it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.26it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.29it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.20it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.26it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.27it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:31,  3.19it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:29,  3.32it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:29,  3.31it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.31it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.34it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.29it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.31it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.33it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:27,  3.26it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.21it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.18it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.24it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.29it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:25,  3.32it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.27it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.24it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.19it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 23:21:07,610 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:21:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:21:07 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:21:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:21:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.12it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 23:21:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:21:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.8205128205128206, 'combined_score': 0.764423076923077, 'eval_loss': 0.6865468, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [499, 296, 229, 296, 229, 219, 219, 191, 209, 678, 155, 1280], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 80858220, 'remaining_params': 4159380, 'pruned_model_sparsity': 0.9510762477416441, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 10500}


Iteration:  30%|███       | 35/115 [00:12<00:56,  1.41it/s][A04/28/2024 23:21:09 - INFO - trainer.trainer_mod_2 - v4 Global step: 10500, Alignment: tensor([0, 1, 5, 8], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:12<00:47,  1.66it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:39,  1.95it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:35,  2.20it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:31,  2.45it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:28,  2.62it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:24,  2.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:23,  3.03it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.08it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:22,  3.09it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.17it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.24it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.16it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.06it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.08it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.11it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.14it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.14it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:18,  3.15it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.11it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.18it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.26it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:15,  3.34it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.29it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.33it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.26it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.35it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.11it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.13it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.17it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:12,  3.37it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.40it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.36it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.27it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.37it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.43it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:10,  3.39it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.43it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.34it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.26it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.20it/s][A[INFO|trainer.py:570] 2024-04-28 23:21:24,409 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:21:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:21:24 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:21:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:21:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:21:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:21:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7107843137254902, 'f1': 0.8217522658610272, 'combined_score': 0.7662682897932587, 'eval_loss': 0.66395676, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [500, 296, 229, 295, 229, 219, 219, 190, 208, 673, 155, 1278], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 80856688, 'remaining_params': 4160912, 'pruned_model_sparsity': 0.9510582279433906, 'expected_sparsity': 0.94986, 'target_sparsity': 0.95, 'step': 10550}


Iteration:  74%|███████▍  | 85/115 [00:28<00:21,  1.42it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:16,  1.71it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:14,  1.97it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:12,  2.23it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:10,  2.47it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:09,  2.67it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:08,  2.82it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  2.99it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.07it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.09it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.06it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.13it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.07it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.00it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.02it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.12it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.04it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.03it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  2.92it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  2.96it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.06it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.08it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.16it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.20it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.31it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.36it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.32it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.59it/s][A04/28/2024 23:21:35 - INFO - trainer.trainer_mod_2 - Epoch 91 finished. Took 38.32 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.00it/s]
Epoch:  92%|█████████▏| 92/100 [1:01:04<05:10, 38.76s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.23it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.14it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.20it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:36,  3.05it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.14it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.14it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.16it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.15it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.26it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.22it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:33,  3.01it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.20it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.23it/s][A[INFO|trainer.py:570] 2024-04-28 23:21:41,395 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:21:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:21:41 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:21:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:21:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.05it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.26it/s]04/28/2024 23:21:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:21:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7107843137254902, 'f1': 0.8217522658610272, 'combined_score': 0.7662682897932587, 'eval_loss': 0.67359096, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [501, 295, 228, 295, 229, 218, 218, 189, 206, 667, 155, 1274], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 80856688, 'remaining_params': 4160912, 'pruned_model_sparsity': 0.9510582279433906, 'expected_sparsity': 0.94999, 'target_sparsity': 0.95, 'step': 10600}


Iteration:  17%|█▋        | 20/115 [00:07<01:07,  1.41it/s][A04/28/2024 23:21:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 10600, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:07<00:55,  1.69it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:47,  1.94it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:41,  2.23it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:36,  2.48it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:33,  2.65it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:32,  2.78it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:28,  3.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:29,  2.93it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:28,  2.96it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:28,  2.99it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:27,  3.00it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:26,  3.13it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.16it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.17it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.14it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.14it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.29it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.20it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.23it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:21,  3.28it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:21,  3.37it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.28it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.29it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.29it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.27it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.10it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.11it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:21,  3.02it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.09it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.19it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.24it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.32it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.32it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.30it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.26it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.28it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:15,  3.28it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.27it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.26it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:14,  3.27it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.25it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.29it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 23:21:58,299 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:21:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:21:58 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:21:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:21:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:21:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:21:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8098918083462132, 'combined_score': 0.7542106100554595, 'eval_loss': 0.7320829, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [501, 295, 228, 294, 230, 218, 217, 190, 205, 662, 155, 1270], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81052784, 'remaining_params': 3964816, 'pruned_model_sparsity': 0.9533647621198434, 'expected_sparsity': 0.95005, 'target_sparsity': 0.95, 'step': 10650}


Iteration:  61%|██████    | 70/115 [00:24<00:31,  1.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:25,  1.71it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:21,  1.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:18,  2.26it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:16,  2.52it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:14,  2.70it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:13,  2.81it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:12,  2.95it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:12,  3.03it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.02it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:11,  3.12it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.18it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.20it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.22it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.21it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.20it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.01it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.11it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.16it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.11it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.09it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.15it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.23it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.18it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.17it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.91it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.21it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.28it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.29it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.26it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.26it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.28it/s][A
Iteration:  96%|█████████▌| 110/115 [00:37<00:01,  3.38it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.34it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.32it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.32it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.29it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.51it/s][A04/28/2024 23:22:13 - INFO - trainer.trainer_mod_2 - Epoch 92 finished. Took 38.48 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.99it/s]
Epoch:  93%|█████████▎| 93/100 [1:01:43<04:30, 38.68s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.09it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.10it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.16it/s][A[INFO|trainer.py:570] 2024-04-28 23:22:15,152 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:22:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:22:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:22:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:22:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.08it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.29it/s]04/28/2024 23:22:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:22:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8081123244929797, 'combined_score': 0.7533208681288428, 'eval_loss': 0.71394295, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [503, 295, 228, 294, 230, 218, 217, 189, 204, 657, 155, 1266], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81049720, 'remaining_params': 3967880, 'pruned_model_sparsity': 0.9533287225233363, 'expected_sparsity': 0.95017, 'target_sparsity': 0.95, 'step': 10700}


Iteration:   4%|▍         | 5/115 [00:02<01:27,  1.26it/s][A04/28/2024 23:22:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 10700, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:03<01:09,  1.57it/s][A
Iteration:   6%|▌         | 7/115 [00:03<00:57,  1.88it/s][A
Iteration:   7%|▋         | 8/115 [00:03<00:49,  2.18it/s][A
Iteration:   8%|▊         | 9/115 [00:04<00:43,  2.44it/s][A
Iteration:   9%|▊         | 10/115 [00:04<00:39,  2.66it/s][A
Iteration:  10%|▉         | 11/115 [00:04<00:37,  2.77it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:35,  2.89it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:33,  3.01it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:32,  3.07it/s][A
Iteration:  13%|█▎        | 15/115 [00:06<00:31,  3.16it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:31,  3.12it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:31,  3.13it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:30,  3.21it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:29,  3.22it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:29,  3.20it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.18it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.19it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:28,  3.21it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:27,  3.22it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:26,  3.30it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:26,  3.30it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:26,  3.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:26,  3.23it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.26it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:25,  3.28it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.22it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:26,  3.08it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:25,  3.13it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:26,  2.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:25,  3.08it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.21it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:23,  3.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:22,  3.30it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:22,  3.28it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.24it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.07it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.10it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.16it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.14it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:21,  3.19it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.21it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.20it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.22it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.16it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.18it/s][A[INFO|trainer.py:570] 2024-04-28 23:22:32,101 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:22:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:22:32 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:22:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:22:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:22:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:22:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7107843137254902, 'f1': 0.8138801261829653, 'combined_score': 0.7623322199542277, 'eval_loss': 0.7091699, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [506, 295, 228, 294, 230, 218, 217, 189, 203, 653, 155, 1263], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81045124, 'remaining_params': 3972476, 'pruned_model_sparsity': 0.9532746631285758, 'expected_sparsity': 0.95013, 'target_sparsity': 0.95, 'step': 10750}


Iteration:  48%|████▊     | 55/115 [00:19<00:42,  1.41it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:34,  1.71it/s][A
Iteration:  50%|████▉     | 57/115 [00:20<00:28,  2.00it/s][A
Iteration:  50%|█████     | 58/115 [00:20<00:25,  2.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:23,  2.43it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:20,  2.65it/s][A
Iteration:  53%|█████▎    | 61/115 [00:21<00:19,  2.79it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:18,  2.89it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:17,  2.98it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:16,  3.05it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:16,  3.08it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.09it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.94it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.08it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:14,  3.20it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:14,  3.19it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.16it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.26it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:13,  3.07it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.14it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.23it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.20it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.15it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.21it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:10,  3.09it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.12it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.13it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.14it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.08it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.21it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.26it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.28it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:05,  3.38it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.28it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.25it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.26it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.20it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.21it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.27it/s][A[INFO|trainer.py:570] 2024-04-28 23:22:49,037 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:22:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:22:49 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:22:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:22:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:22:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:22:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.8125984251968503, 'combined_score': 0.7604658792650918, 'eval_loss': 0.71737057, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [509, 295, 228, 294, 230, 218, 216, 189, 203, 648, 155, 1260], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81040528, 'remaining_params': 3977072, 'pruned_model_sparsity': 0.9532206037338151, 'expected_sparsity': 0.95001, 'target_sparsity': 0.95, 'step': 10800}


Iteration:  91%|█████████▏| 105/115 [00:36<00:07,  1.42it/s][A04/28/2024 23:22:50 - INFO - trainer.trainer_mod_2 - v4 Global step: 10800, Alignment: tensor([0, 1, 5, 7], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:37<00:05,  1.71it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:04,  1.97it/s][A
Iteration:  94%|█████████▍| 108/115 [00:37<00:03,  2.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:02,  2.46it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  2.55it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:01,  2.73it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:01,  2.81it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.93it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  3.00it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  3.32it/s][A04/28/2024 23:22:53 - INFO - trainer.trainer_mod_2 - Epoch 93 finished. Took 39.89 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.88it/s]
Epoch:  94%|█████████▍| 94/100 [1:02:22<03:54, 39.04s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:36,  3.12it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:36,  3.09it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.31it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.28it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:32,  3.38it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.29it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.26it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.12it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.25it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.36it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:30,  3.43it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.28it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.26it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.22it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:32,  3.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.15it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:32,  3.01it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:31,  3.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.08it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.09it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.11it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:29,  3.13it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:26,  3.33it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:26,  3.38it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.32it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.30it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.25it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:25,  3.27it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:25,  3.23it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:25,  3.18it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.20it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.24it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:23,  3.25it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:23,  3.24it/s][A
Iteration:  34%|███▍      | 39/115 [00:12<00:23,  3.26it/s][A[INFO|trainer.py:570] 2024-04-28 23:23:05,875 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:23:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:23:05 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:23:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:23:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:23:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:23:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7107843137254902, 'f1': 0.8138801261829653, 'combined_score': 0.7623322199542277, 'eval_loss': 0.7142266, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [511, 296, 228, 294, 231, 218, 216, 189, 202, 644, 155, 1257], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81035932, 'remaining_params': 3981668, 'pruned_model_sparsity': 0.9531665443390545, 'expected_sparsity': 0.94996, 'target_sparsity': 0.95, 'step': 10850}


Iteration:  35%|███▍      | 40/115 [00:13<00:53,  1.41it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:42,  1.73it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:36,  2.00it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:32,  2.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:29,  2.38it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:27,  2.58it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:25,  2.71it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:23,  2.89it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.13it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.25it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.16it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.26it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:17,  3.32it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.32it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.23it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:16,  3.25it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.19it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:17,  3.08it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.11it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.20it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:16,  3.12it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.16it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:15,  3.17it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.17it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.15it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.17it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.24it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.23it/s][A
Iteration:  63%|██████▎   | 73/115 [00:23<00:12,  3.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.33it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:11,  3.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:11,  3.32it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.29it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.28it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.28it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.26it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:10,  3.09it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.15it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.14it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.15it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.17it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 89/115 [00:29<00:08,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 23:23:22,780 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:23:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:23:22 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:23:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:23:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.08it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.27it/s]04/28/2024 23:23:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:23:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.818320610687023, 'combined_score': 0.7633269720101782, 'eval_loss': 0.66737455, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [513, 296, 228, 293, 231, 218, 216, 188, 201, 640, 155, 1253], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 80836772, 'remaining_params': 4180828, 'pruned_model_sparsity': 0.9508239705660946, 'expected_sparsity': 0.94979, 'target_sparsity': 0.95, 'step': 10900}


Iteration:  78%|███████▊  | 90/115 [00:30<00:17,  1.39it/s][A04/28/2024 23:23:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 10900, Alignment: tensor([0, 1, 5, 7], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:30<00:14,  1.68it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:11,  1.97it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:09,  2.27it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:08,  2.48it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:07,  2.69it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  2.81it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:06,  2.91it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.01it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.01it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.91it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  2.96it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.07it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.08it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.02it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.16it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.19it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.23it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.24it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.22it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.24it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.19it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.20it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.45it/s][A04/28/2024 23:23:31 - INFO - trainer.trainer_mod_2 - Epoch 94 finished. Took 38.4 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.99it/s]
Epoch:  95%|█████████▌| 95/100 [1:03:01<03:14, 38.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:43,  2.62it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:38,  2.92it/s][A
Iteration:   3%|▎         | 3/115 [00:01<00:36,  3.08it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.10it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:35,  3.08it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:35,  3.04it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.13it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.20it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.23it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.25it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:33,  3.14it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.21it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.26it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.27it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:31,  3.17it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:30,  3.23it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.21it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.19it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.25it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:29,  3.24it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:29,  3.20it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.16it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:28,  3.18it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.30it/s][A[INFO|trainer.py:570] 2024-04-28 23:23:39,693 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:23:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:23:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:23:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:23:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:23:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:23:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7181372549019608, 'f1': 0.8177496038034865, 'combined_score': 0.7679434293527236, 'eval_loss': 0.712982, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [515, 295, 227, 293, 231, 218, 216, 188, 200, 634, 155, 1251], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81031336, 'remaining_params': 3986264, 'pruned_model_sparsity': 0.9531124849442939, 'expected_sparsity': 0.94972, 'target_sparsity': 0.95, 'step': 10950}
04/28/2024 23:23:41 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 95 | Step: 10950 | Model size: 3986264 | Score: 0.71814]

[INFO|configuration_utils.py:439] 2024-04-28 23:23:41,019 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 23:23:42,983 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/best/pytorch_model.bin

Iteration:  22%|██▏       | 25/115 [00:11<01:56,  1.29s/it][A
Iteration:  23%|██▎       | 26/115 [00:11<01:28,  1.01it/s][A
Iteration:  23%|██▎       | 27/115 [00:11<01:08,  1.28it/s][A
Iteration:  24%|██▍       | 28/115 [00:12<00:56,  1.54it/s][A
Iteration:  25%|██▌       | 29/115 [00:12<00:47,  1.82it/s][A
Iteration:  26%|██▌       | 30/115 [00:12<00:40,  2.07it/s][A
Iteration:  27%|██▋       | 31/115 [00:13<00:36,  2.31it/s][A
Iteration:  28%|██▊       | 32/115 [00:13<00:32,  2.52it/s][A
Iteration:  29%|██▊       | 33/115 [00:13<00:30,  2.71it/s][A
Iteration:  30%|██▉       | 34/115 [00:13<00:28,  2.84it/s][A
Iteration:  30%|███       | 35/115 [00:14<00:26,  2.97it/s][A
Iteration:  31%|███▏      | 36/115 [00:14<00:25,  3.06it/s][A
Iteration:  32%|███▏      | 37/115 [00:14<00:24,  3.12it/s][A
Iteration:  33%|███▎      | 38/115 [00:15<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:15<00:23,  3.22it/s][A
Iteration:  35%|███▍      | 40/115 [00:15<00:22,  3.27it/s][A
Iteration:  36%|███▌      | 41/115 [00:16<00:22,  3.30it/s][A
Iteration:  37%|███▋      | 42/115 [00:16<00:21,  3.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:16<00:21,  3.30it/s][A
Iteration:  38%|███▊      | 44/115 [00:16<00:22,  3.15it/s][A
Iteration:  39%|███▉      | 45/115 [00:17<00:22,  3.13it/s][A
Iteration:  40%|████      | 46/115 [00:17<00:22,  3.11it/s][A
Iteration:  41%|████      | 47/115 [00:17<00:21,  3.13it/s][A
Iteration:  42%|████▏     | 48/115 [00:18<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:18<00:20,  3.24it/s][A
Iteration:  43%|████▎     | 50/115 [00:18<00:19,  3.31it/s][A
Iteration:  44%|████▍     | 51/115 [00:19<00:19,  3.29it/s][A
Iteration:  45%|████▌     | 52/115 [00:19<00:19,  3.25it/s][A
Iteration:  46%|████▌     | 53/115 [00:19<00:18,  3.28it/s][A
Iteration:  47%|████▋     | 54/115 [00:20<00:18,  3.29it/s][A
Iteration:  48%|████▊     | 55/115 [00:20<00:18,  3.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:20<00:18,  3.26it/s][A
Iteration:  50%|████▉     | 57/115 [00:21<00:17,  3.23it/s][A
Iteration:  50%|█████     | 58/115 [00:21<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:21<00:17,  3.14it/s][A
Iteration:  52%|█████▏    | 60/115 [00:21<00:17,  3.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:22<00:17,  3.04it/s][A
Iteration:  54%|█████▍    | 62/115 [00:22<00:17,  3.09it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:16,  3.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:23<00:16,  3.13it/s][A
Iteration:  57%|█████▋    | 65/115 [00:23<00:15,  3.15it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:15,  3.18it/s][A
Iteration:  58%|█████▊    | 67/115 [00:24<00:14,  3.23it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:14,  3.20it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:13,  3.31it/s][A
Iteration:  61%|██████    | 70/115 [00:25<00:13,  3.25it/s][A
Iteration:  62%|██████▏   | 71/115 [00:25<00:13,  3.26it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:13,  3.30it/s][A
Iteration:  63%|██████▎   | 73/115 [00:26<00:12,  3.34it/s][A
Iteration:  64%|██████▍   | 74/115 [00:26<00:12,  3.28it/s][A[INFO|trainer.py:570] 2024-04-28 23:23:58,503 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:23:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:23:58 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:23:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:23:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 23:23:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:23:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7083333333333334, 'f1': 0.8131868131868132, 'combined_score': 0.7607600732600732, 'eval_loss': 0.7170307, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [515, 295, 227, 292, 231, 218, 216, 188, 199, 627, 155, 1245], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81031336, 'remaining_params': 3986264, 'pruned_model_sparsity': 0.9531124849442939, 'expected_sparsity': 0.94953, 'target_sparsity': 0.95, 'step': 11000}


Iteration:  65%|██████▌   | 75/115 [00:27<00:28,  1.42it/s][A04/28/2024 23:23:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 11000, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:28<00:23,  1.65it/s][A
Iteration:  67%|██████▋   | 77/115 [00:28<00:19,  1.92it/s][A
Iteration:  68%|██████▊   | 78/115 [00:28<00:17,  2.16it/s][A
Iteration:  69%|██████▊   | 79/115 [00:29<00:14,  2.41it/s][A
Iteration:  70%|██████▉   | 80/115 [00:29<00:13,  2.65it/s][A
Iteration:  70%|███████   | 81/115 [00:29<00:12,  2.79it/s][A
Iteration:  71%|███████▏  | 82/115 [00:30<00:11,  2.87it/s][A
Iteration:  72%|███████▏  | 83/115 [00:30<00:10,  2.98it/s][A
Iteration:  73%|███████▎  | 84/115 [00:30<00:10,  3.01it/s][A
Iteration:  74%|███████▍  | 85/115 [00:31<00:10,  2.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:31<00:09,  3.06it/s][A
Iteration:  76%|███████▌  | 87/115 [00:31<00:08,  3.11it/s][A
Iteration:  77%|███████▋  | 88/115 [00:32<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 89/115 [00:32<00:08,  3.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:32<00:07,  3.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:33<00:07,  3.25it/s][A
Iteration:  80%|████████  | 92/115 [00:33<00:07,  3.26it/s][A
Iteration:  81%|████████  | 93/115 [00:33<00:06,  3.34it/s][A
Iteration:  82%|████████▏ | 94/115 [00:33<00:06,  3.42it/s][A
Iteration:  83%|████████▎ | 95/115 [00:34<00:05,  3.41it/s][A
Iteration:  83%|████████▎ | 96/115 [00:34<00:05,  3.36it/s][A
Iteration:  84%|████████▍ | 97/115 [00:34<00:05,  3.28it/s][A
Iteration:  85%|████████▌ | 98/115 [00:35<00:05,  3.24it/s][A
Iteration:  86%|████████▌ | 99/115 [00:35<00:04,  3.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:35<00:04,  3.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:36<00:04,  3.22it/s][A
Iteration:  89%|████████▊ | 102/115 [00:36<00:04,  3.08it/s][A
Iteration:  90%|████████▉ | 103/115 [00:36<00:03,  3.21it/s][A
Iteration:  90%|█████████ | 104/115 [00:37<00:03,  3.22it/s][A
Iteration:  91%|█████████▏| 105/115 [00:37<00:03,  3.19it/s][A
Iteration:  92%|█████████▏| 106/115 [00:37<00:02,  3.17it/s][A
Iteration:  93%|█████████▎| 107/115 [00:37<00:02,  3.16it/s][A
Iteration:  94%|█████████▍| 108/115 [00:38<00:02,  3.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:38<00:01,  3.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:38<00:01,  3.16it/s][A
Iteration:  97%|█████████▋| 111/115 [00:39<00:01,  3.23it/s][A
Iteration:  97%|█████████▋| 112/115 [00:39<00:00,  3.04it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  3.04it/s][A
Iteration:  99%|█████████▉| 114/115 [00:40<00:00,  3.14it/s][A
Iteration: 100%|██████████| 115/115 [00:40<00:00,  3.36it/s][A04/28/2024 23:24:12 - INFO - trainer.trainer_mod_2 - Epoch 95 finished. Took 40.45 seconds.
Iteration: 100%|██████████| 115/115 [00:40<00:00,  2.84it/s]
Epoch:  96%|█████████▌| 96/100 [1:03:41<02:37, 39.33s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.18it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.19it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.23it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.28it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.30it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.28it/s][A[INFO|trainer.py:570] 2024-04-28 23:24:15,389 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:24:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:24:15 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:24:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:24:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.12it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00,  9.91it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00,  9.98it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.02it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.22it/s]04/28/2024 23:24:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:24:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.8099688473520249, 'combined_score': 0.7554746197544437, 'eval_loss': 0.7301623, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [514, 293, 227, 292, 230, 217, 215, 187, 198, 618, 155, 1238], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81035932, 'remaining_params': 3981668, 'pruned_model_sparsity': 0.9531665443390545, 'expected_sparsity': 0.94976, 'target_sparsity': 0.95, 'step': 11050}


Iteration:   9%|▊         | 10/115 [00:04<01:15,  1.39it/s][A
Iteration:  10%|▉         | 11/115 [00:04<01:02,  1.67it/s][A
Iteration:  10%|█         | 12/115 [00:05<00:51,  2.00it/s][A
Iteration:  11%|█▏        | 13/115 [00:05<00:45,  2.22it/s][A
Iteration:  12%|█▏        | 14/115 [00:05<00:40,  2.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:05<00:37,  2.66it/s][A
Iteration:  14%|█▍        | 16/115 [00:06<00:34,  2.83it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:32,  2.97it/s][A
Iteration:  16%|█▌        | 18/115 [00:06<00:31,  3.09it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:29,  3.24it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:30,  3.07it/s][A
Iteration:  18%|█▊        | 21/115 [00:07<00:29,  3.15it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:29,  3.15it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:29,  3.08it/s][A
Iteration:  21%|██        | 24/115 [00:08<00:29,  3.12it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:28,  3.12it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:27,  3.21it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:26,  3.27it/s][A
Iteration:  24%|██▍       | 28/115 [00:09<00:25,  3.38it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:25,  3.38it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:25,  3.38it/s][A
Iteration:  27%|██▋       | 31/115 [00:10<00:26,  3.17it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.22it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.19it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:25,  3.14it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.21it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:24,  3.23it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:24,  3.21it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:24,  3.17it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.15it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:23,  3.15it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.17it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:22,  3.19it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.21it/s][A
Iteration:  38%|███▊      | 44/115 [00:14<00:21,  3.30it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.16it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.14it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:21,  3.16it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:21,  3.16it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:20,  3.23it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.26it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:20,  3.05it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.14it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.18it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.20it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:16,  3.32it/s][A[INFO|trainer.py:570] 2024-04-28 23:24:32,255 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:24:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:24:32 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:24:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:24:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:24:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:24:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8100470957613815, 'combined_score': 0.7567392341552006, 'eval_loss': 0.7230247, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [513, 293, 227, 291, 229, 217, 215, 186, 196, 609, 155, 1231], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81037464, 'remaining_params': 3980136, 'pruned_model_sparsity': 0.953184564137308, 'expected_sparsity': 0.95009, 'target_sparsity': 0.95, 'step': 11100}


Iteration:  52%|█████▏    | 60/115 [00:21<00:38,  1.43it/s][A04/28/2024 23:24:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 11100, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:21<00:31,  1.71it/s][A
Iteration:  54%|█████▍    | 62/115 [00:21<00:26,  2.00it/s][A
Iteration:  55%|█████▍    | 63/115 [00:22<00:22,  2.27it/s][A
Iteration:  56%|█████▌    | 64/115 [00:22<00:20,  2.48it/s][A
Iteration:  57%|█████▋    | 65/115 [00:22<00:18,  2.65it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:17,  2.81it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:16,  2.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:23<00:15,  3.08it/s][A
Iteration:  60%|██████    | 69/115 [00:23<00:14,  3.23it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:13,  3.23it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:13,  3.31it/s][A
Iteration:  63%|██████▎   | 72/115 [00:24<00:12,  3.46it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:12,  3.31it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:12,  3.34it/s][A
Iteration:  65%|██████▌   | 75/115 [00:25<00:12,  3.27it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:11,  3.36it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.42it/s][A
Iteration:  68%|██████▊   | 78/115 [00:26<00:11,  3.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.25it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:10,  3.15it/s][A
Iteration:  71%|███████▏  | 82/115 [00:27<00:10,  3.15it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:09,  3.21it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.29it/s][A
Iteration:  74%|███████▍  | 85/115 [00:28<00:09,  3.23it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.08it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:08,  3.22it/s][A
Iteration:  77%|███████▋  | 88/115 [00:29<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.18it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.16it/s][A
Iteration:  79%|███████▉  | 91/115 [00:30<00:07,  3.18it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.07it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.15it/s][A
Iteration:  82%|████████▏ | 94/115 [00:31<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.01it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:06,  3.02it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:05,  3.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.09it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.22it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.19it/s][A
Iteration:  88%|████████▊ | 101/115 [00:33<00:04,  3.21it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.20it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.22it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.18it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.15it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.16it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.23it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.31it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.25it/s][A[INFO|trainer.py:570] 2024-04-28 23:24:49,076 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:24:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:24:49 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:24:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:24:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:24:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:24:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7034313725490197, 'f1': 0.8124031007751938, 'combined_score': 0.7579172366621068, 'eval_loss': 0.7437883, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [513, 292, 227, 291, 228, 217, 214, 186, 195, 600, 155, 1223], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81038996, 'remaining_params': 3978604, 'pruned_model_sparsity': 0.9532025839355616, 'expected_sparsity': 0.95032, 'target_sparsity': 0.95, 'step': 11150}


Iteration:  96%|█████████▌| 110/115 [00:38<00:03,  1.42it/s][A
Iteration:  97%|█████████▋| 111/115 [00:38<00:02,  1.72it/s][A
Iteration:  97%|█████████▋| 112/115 [00:38<00:01,  1.99it/s][A
Iteration:  98%|█████████▊| 113/115 [00:39<00:00,  2.23it/s][A
Iteration:  99%|█████████▉| 114/115 [00:39<00:00,  2.44it/s][A
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.82it/s][A04/28/2024 23:24:51 - INFO - trainer.trainer_mod_2 - Epoch 96 finished. Took 39.57 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.91it/s]
Epoch:  97%|█████████▋| 97/100 [1:04:21<01:58, 39.40s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:35,  3.18it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:35,  3.17it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:33,  3.36it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:33,  3.34it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:33,  3.27it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:32,  3.34it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:32,  3.29it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:32,  3.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.20it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:32,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.22it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.20it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:32,  3.15it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.22it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:30,  3.24it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:30,  3.25it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:30,  3.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.21it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.20it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:28,  3.31it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:28,  3.32it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:28,  3.31it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:27,  3.36it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:27,  3.34it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:26,  3.41it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:25,  3.44it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:25,  3.39it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:09<00:26,  3.22it/s][A
Iteration:  27%|██▋       | 31/115 [00:09<00:26,  3.18it/s][A
Iteration:  28%|██▊       | 32/115 [00:09<00:26,  3.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:10<00:26,  3.07it/s][A
Iteration:  30%|██▉       | 34/115 [00:10<00:25,  3.21it/s][A
Iteration:  30%|███       | 35/115 [00:10<00:24,  3.25it/s][A
Iteration:  31%|███▏      | 36/115 [00:11<00:24,  3.19it/s][A
Iteration:  32%|███▏      | 37/115 [00:11<00:24,  3.24it/s][A
Iteration:  33%|███▎      | 38/115 [00:11<00:22,  3.37it/s][A
Iteration:  34%|███▍      | 39/115 [00:11<00:22,  3.35it/s][A
Iteration:  35%|███▍      | 40/115 [00:12<00:22,  3.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:12<00:22,  3.23it/s][A
Iteration:  37%|███▋      | 42/115 [00:12<00:23,  3.10it/s][A
Iteration:  37%|███▋      | 43/115 [00:13<00:22,  3.17it/s][A
Iteration:  38%|███▊      | 44/115 [00:13<00:22,  3.21it/s][A[INFO|trainer.py:570] 2024-04-28 23:25:05,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:25:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:25:05 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:25:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:25:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:25:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:25:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8093023255813954, 'combined_score': 0.7539158686730506, 'eval_loss': 0.74401677, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [513, 292, 227, 290, 229, 216, 214, 185, 194, 593, 155, 1217], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81038996, 'remaining_params': 3978604, 'pruned_model_sparsity': 0.9532025839355616, 'expected_sparsity': 0.95039, 'target_sparsity': 0.95, 'step': 11200}


Iteration:  39%|███▉      | 45/115 [00:15<00:49,  1.41it/s][A04/28/2024 23:25:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 11200, Alignment: tensor([ 0,  2,  5, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:15<00:41,  1.65it/s][A
Iteration:  41%|████      | 47/115 [00:15<00:34,  1.95it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:30,  2.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:27,  2.43it/s][A
Iteration:  43%|████▎     | 50/115 [00:16<00:24,  2.61it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:23,  2.76it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:22,  2.86it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:20,  3.02it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.06it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:19,  3.06it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:18,  3.20it/s][A
Iteration:  50%|████▉     | 57/115 [00:18<00:18,  3.09it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:18,  3.03it/s][A
Iteration:  52%|█████▏    | 60/115 [00:19<00:17,  3.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:17,  3.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.21it/s][A
Iteration:  55%|█████▍    | 63/115 [00:20<00:16,  3.14it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.19it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.16it/s][A
Iteration:  57%|█████▋    | 66/115 [00:21<00:15,  3.22it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.20it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:15,  3.12it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.15it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.16it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.18it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.20it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:12,  3.30it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.38it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.31it/s][A
Iteration:  66%|██████▌   | 76/115 [00:24<00:12,  3.25it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.34it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.27it/s][A
Iteration:  69%|██████▊   | 79/115 [00:25<00:11,  3.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:26<00:10,  3.22it/s][A
Iteration:  70%|███████   | 81/115 [00:26<00:10,  3.24it/s][A
Iteration:  71%|███████▏  | 82/115 [00:26<00:10,  3.23it/s][A
Iteration:  72%|███████▏  | 83/115 [00:27<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:27<00:09,  3.21it/s][A
Iteration:  74%|███████▍  | 85/115 [00:27<00:09,  3.31it/s][A
Iteration:  75%|███████▍  | 86/115 [00:28<00:09,  3.21it/s][A
Iteration:  76%|███████▌  | 87/115 [00:28<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 88/115 [00:28<00:08,  3.15it/s][A
Iteration:  77%|███████▋  | 89/115 [00:28<00:08,  3.18it/s][A
Iteration:  78%|███████▊  | 90/115 [00:29<00:07,  3.19it/s][A
Iteration:  79%|███████▉  | 91/115 [00:29<00:07,  3.25it/s][A
Iteration:  80%|████████  | 92/115 [00:29<00:07,  3.05it/s][A
Iteration:  81%|████████  | 93/115 [00:30<00:07,  3.13it/s][A
Iteration:  82%|████████▏ | 94/115 [00:30<00:06,  3.24it/s][A[INFO|trainer.py:570] 2024-04-28 23:25:22,742 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:25:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:25:22 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:25:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:25:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 23:25:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:25:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7132352941176471, 'f1': 0.8169014084507041, 'combined_score': 0.7650683512841756, 'eval_loss': 0.73395973, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [515, 292, 227, 291, 228, 217, 213, 185, 194, 587, 155, 1212], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81035932, 'remaining_params': 3981668, 'pruned_model_sparsity': 0.9531665443390545, 'expected_sparsity': 0.95031, 'target_sparsity': 0.95, 'step': 11250}


Iteration:  83%|████████▎ | 95/115 [00:32<00:14,  1.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:11,  1.69it/s][A
Iteration:  84%|████████▍ | 97/115 [00:32<00:09,  1.97it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:07,  2.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:06,  2.46it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:05,  2.61it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:05,  2.74it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:34<00:03,  3.07it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.05it/s][A
Iteration:  93%|█████████▎| 107/115 [00:35<00:02,  3.12it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  2.97it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.07it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.15it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.22it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.25it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.41it/s][A04/28/2024 23:25:30 - INFO - trainer.trainer_mod_2 - Epoch 97 finished. Took 38.4 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.99it/s]
Epoch:  98%|█████████▊| 98/100 [1:04:59<01:18, 39.10s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:33,  3.37it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.28it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.27it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:35,  3.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:34,  3.17it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:33,  3.25it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:31,  3.34it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:32,  3.29it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.33it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:31,  3.28it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:31,  3.25it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:31,  3.22it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.21it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:32,  3.05it/s][A
Iteration:  14%|█▍        | 16/115 [00:05<00:32,  3.02it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:31,  3.09it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:30,  3.13it/s][A
Iteration:  17%|█▋        | 20/115 [00:06<00:30,  3.16it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:30,  3.05it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:29,  3.15it/s][A
Iteration:  20%|██        | 23/115 [00:07<00:30,  3.05it/s][A
Iteration:  21%|██        | 24/115 [00:07<00:29,  3.11it/s][A
Iteration:  22%|██▏       | 25/115 [00:07<00:28,  3.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:08<00:27,  3.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:08<00:27,  3.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:08<00:26,  3.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:09<00:26,  3.26it/s][A[INFO|trainer.py:570] 2024-04-28 23:25:39,674 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:25:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:25:39 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:25:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:25:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:25:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:25:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6985294117647058, 'f1': 0.8093023255813954, 'combined_score': 0.7539158686730506, 'eval_loss': 0.74072695, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [517, 293, 227, 291, 228, 216, 213, 185, 193, 583, 155, 1208], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81031336, 'remaining_params': 3986264, 'pruned_model_sparsity': 0.9531124849442939, 'expected_sparsity': 0.95008, 'target_sparsity': 0.95, 'step': 11300}


Iteration:  26%|██▌       | 30/115 [00:10<00:59,  1.43it/s][A04/28/2024 23:25:41 - INFO - trainer.trainer_mod_2 - v4 Global step: 11300, Alignment: tensor([0, 1, 5, 7], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:11<00:49,  1.71it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:41,  1.99it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:36,  2.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:11<00:32,  2.46it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:30,  2.66it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:28,  2.81it/s][A
Iteration:  32%|███▏      | 37/115 [00:12<00:28,  2.78it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:26,  2.93it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:25,  2.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:13<00:24,  3.06it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.12it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.09it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:22,  3.14it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.16it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:22,  3.15it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.15it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:22,  2.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:22,  3.04it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:21,  3.06it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.15it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:19,  3.22it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:17<00:19,  3.25it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:18,  3.26it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.30it/s][A
Iteration:  49%|████▊     | 56/115 [00:18<00:17,  3.30it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:17,  3.29it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.30it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.11it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:17,  3.13it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.21it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.21it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:16,  3.22it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.22it/s][A
Iteration:  57%|█████▋    | 65/115 [00:21<00:15,  3.16it/s][A
Iteration:  57%|█████▋    | 66/115 [00:22<00:15,  3.19it/s][A
Iteration:  58%|█████▊    | 67/115 [00:22<00:14,  3.23it/s][A
Iteration:  59%|█████▉    | 68/115 [00:22<00:14,  3.21it/s][A
Iteration:  60%|██████    | 69/115 [00:22<00:14,  3.17it/s][A
Iteration:  61%|██████    | 70/115 [00:23<00:14,  3.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:23<00:13,  3.17it/s][A
Iteration:  63%|██████▎   | 72/115 [00:23<00:13,  3.19it/s][A
Iteration:  63%|██████▎   | 73/115 [00:24<00:13,  3.22it/s][A
Iteration:  64%|██████▍   | 74/115 [00:24<00:12,  3.20it/s][A
Iteration:  65%|██████▌   | 75/115 [00:24<00:12,  3.20it/s][A
Iteration:  66%|██████▌   | 76/115 [00:25<00:12,  3.22it/s][A
Iteration:  67%|██████▋   | 77/115 [00:25<00:11,  3.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:25<00:11,  3.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:26<00:10,  3.30it/s][A[INFO|trainer.py:570] 2024-04-28 23:25:56,628 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:25:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:25:56 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:25:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:25:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.31it/s]04/28/2024 23:25:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:25:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8130841121495327, 'combined_score': 0.7594832325453547, 'eval_loss': 0.73618436, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [520, 293, 227, 290, 228, 216, 213, 184, 193, 579, 155, 1205], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81026740, 'remaining_params': 3990860, 'pruned_model_sparsity': 0.9530584255495332, 'expected_sparsity': 0.94984, 'target_sparsity': 0.95, 'step': 11350}


Iteration:  70%|██████▉   | 80/115 [00:27<00:24,  1.44it/s][A
Iteration:  70%|███████   | 81/115 [00:27<00:19,  1.72it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:16,  1.96it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:14,  2.21it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:12,  2.41it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:11,  2.59it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:10,  2.77it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  2.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:09,  2.95it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.04it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:08,  3.07it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.11it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.24it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:07,  3.05it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.19it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.21it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.26it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.28it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:04,  3.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.38it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.33it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:03,  3.31it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.37it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.30it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:03,  3.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.23it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.16it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.26it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.23it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.21it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.18it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.18it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.19it/s][A
Iteration: 100%|██████████| 115/115 [00:38<00:00,  3.38it/s][A04/28/2024 23:26:08 - INFO - trainer.trainer_mod_2 - Epoch 98 finished. Took 38.5 seconds.
Iteration: 100%|██████████| 115/115 [00:38<00:00,  2.99it/s]
Epoch:  99%|█████████▉| 99/100 [1:05:38<00:38, 38.92s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:37,  3.06it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:34,  3.25it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:34,  3.24it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:34,  3.24it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:34,  3.18it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:33,  3.24it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:34,  3.16it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.16it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:33,  3.16it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:33,  3.18it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:32,  3.23it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:32,  3.21it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.05it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:32,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 23:26:13,538 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:26:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:26:13 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:26:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:26:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:26:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:26:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8130841121495327, 'combined_score': 0.7594832325453547, 'eval_loss': 0.73721135, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [522, 293, 227, 290, 228, 216, 212, 184, 192, 574, 155, 1200], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81023676, 'remaining_params': 3993924, 'pruned_model_sparsity': 0.9530223859530262, 'expected_sparsity': 0.94975, 'target_sparsity': 0.95, 'step': 11400}


Iteration:  13%|█▎        | 15/115 [00:06<01:12,  1.38it/s][A04/28/2024 23:26:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 11400, Alignment: tensor([ 0,  1,  5, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:06<00:58,  1.68it/s][A
Iteration:  15%|█▍        | 17/115 [00:06<00:49,  1.98it/s][A
Iteration:  16%|█▌        | 18/115 [00:07<00:44,  2.16it/s][A
Iteration:  17%|█▋        | 19/115 [00:07<00:40,  2.39it/s][A
Iteration:  17%|█▋        | 20/115 [00:07<00:36,  2.58it/s][A
Iteration:  18%|█▊        | 21/115 [00:08<00:35,  2.63it/s][A
Iteration:  19%|█▉        | 22/115 [00:08<00:34,  2.72it/s][A
Iteration:  20%|██        | 23/115 [00:08<00:32,  2.80it/s][A
Iteration:  21%|██        | 24/115 [00:09<00:31,  2.92it/s][A
Iteration:  22%|██▏       | 25/115 [00:09<00:30,  2.93it/s][A
Iteration:  23%|██▎       | 26/115 [00:09<00:29,  3.03it/s][A
Iteration:  23%|██▎       | 27/115 [00:09<00:28,  3.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:10<00:27,  3.13it/s][A
Iteration:  25%|██▌       | 29/115 [00:10<00:27,  3.16it/s][A
Iteration:  26%|██▌       | 30/115 [00:10<00:26,  3.22it/s][A
Iteration:  27%|██▋       | 31/115 [00:11<00:25,  3.25it/s][A
Iteration:  28%|██▊       | 32/115 [00:11<00:25,  3.26it/s][A
Iteration:  29%|██▊       | 33/115 [00:11<00:25,  3.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:12<00:25,  3.21it/s][A
Iteration:  30%|███       | 35/115 [00:12<00:24,  3.23it/s][A
Iteration:  31%|███▏      | 36/115 [00:12<00:25,  3.15it/s][A
Iteration:  32%|███▏      | 37/115 [00:13<00:24,  3.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:13<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:13<00:24,  3.16it/s][A
Iteration:  35%|███▍      | 40/115 [00:14<00:24,  3.06it/s][A
Iteration:  36%|███▌      | 41/115 [00:14<00:23,  3.13it/s][A
Iteration:  37%|███▋      | 42/115 [00:14<00:23,  3.09it/s][A
Iteration:  37%|███▋      | 43/115 [00:14<00:23,  3.13it/s][A
Iteration:  38%|███▊      | 44/115 [00:15<00:22,  3.19it/s][A
Iteration:  39%|███▉      | 45/115 [00:15<00:21,  3.21it/s][A
Iteration:  40%|████      | 46/115 [00:15<00:21,  3.19it/s][A
Iteration:  41%|████      | 47/115 [00:16<00:20,  3.24it/s][A
Iteration:  42%|████▏     | 48/115 [00:16<00:20,  3.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:16<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:17<00:20,  3.21it/s][A
Iteration:  44%|████▍     | 51/115 [00:17<00:20,  3.20it/s][A
Iteration:  45%|████▌     | 52/115 [00:17<00:19,  3.21it/s][A
Iteration:  46%|████▌     | 53/115 [00:18<00:19,  3.17it/s][A
Iteration:  47%|████▋     | 54/115 [00:18<00:19,  3.21it/s][A
Iteration:  48%|████▊     | 55/115 [00:18<00:18,  3.19it/s][A
Iteration:  49%|████▊     | 56/115 [00:19<00:18,  3.19it/s][A
Iteration:  50%|████▉     | 57/115 [00:19<00:18,  3.21it/s][A
Iteration:  50%|█████     | 58/115 [00:19<00:17,  3.26it/s][A
Iteration:  51%|█████▏    | 59/115 [00:19<00:17,  3.29it/s][A
Iteration:  52%|█████▏    | 60/115 [00:20<00:16,  3.30it/s][A
Iteration:  53%|█████▎    | 61/115 [00:20<00:16,  3.30it/s][A
Iteration:  54%|█████▍    | 62/115 [00:20<00:16,  3.31it/s][A
Iteration:  55%|█████▍    | 63/115 [00:21<00:15,  3.39it/s][A
Iteration:  56%|█████▌    | 64/115 [00:21<00:15,  3.36it/s][A[INFO|trainer.py:570] 2024-04-28 23:26:30,491 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:26:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:26:30 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:26:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:26:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:26:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:26:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7009803921568627, 'f1': 0.81055900621118, 'combined_score': 0.7557696991840214, 'eval_loss': 0.7417006, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [524, 293, 227, 290, 227, 216, 212, 183, 192, 568, 155, 1193], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81020612, 'remaining_params': 3996988, 'pruned_model_sparsity': 0.9529863463565191, 'expected_sparsity': 0.94977, 'target_sparsity': 0.95, 'step': 11450}


Iteration:  57%|█████▋    | 65/115 [00:23<00:34,  1.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:23<00:28,  1.69it/s][A
Iteration:  58%|█████▊    | 67/115 [00:23<00:24,  1.98it/s][A
Iteration:  59%|█████▉    | 68/115 [00:24<00:21,  2.22it/s][A
Iteration:  60%|██████    | 69/115 [00:24<00:18,  2.45it/s][A
Iteration:  61%|██████    | 70/115 [00:24<00:17,  2.62it/s][A
Iteration:  62%|██████▏   | 71/115 [00:24<00:15,  2.84it/s][A
Iteration:  63%|██████▎   | 72/115 [00:25<00:14,  2.93it/s][A
Iteration:  63%|██████▎   | 73/115 [00:25<00:13,  3.02it/s][A
Iteration:  64%|██████▍   | 74/115 [00:25<00:13,  3.09it/s][A
Iteration:  65%|██████▌   | 75/115 [00:26<00:12,  3.18it/s][A
Iteration:  66%|██████▌   | 76/115 [00:26<00:12,  3.13it/s][A
Iteration:  67%|██████▋   | 77/115 [00:26<00:11,  3.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:27<00:11,  3.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:27<00:11,  3.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:27<00:10,  3.20it/s][A
Iteration:  70%|███████   | 81/115 [00:28<00:10,  3.16it/s][A
Iteration:  71%|███████▏  | 82/115 [00:28<00:10,  3.19it/s][A
Iteration:  72%|███████▏  | 83/115 [00:28<00:10,  3.04it/s][A
Iteration:  73%|███████▎  | 84/115 [00:28<00:09,  3.12it/s][A
Iteration:  74%|███████▍  | 85/115 [00:29<00:09,  3.11it/s][A
Iteration:  75%|███████▍  | 86/115 [00:29<00:09,  3.09it/s][A
Iteration:  76%|███████▌  | 87/115 [00:29<00:09,  3.10it/s][A
Iteration:  77%|███████▋  | 88/115 [00:30<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:30<00:08,  3.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:30<00:07,  3.26it/s][A
Iteration:  79%|███████▉  | 91/115 [00:31<00:07,  3.23it/s][A
Iteration:  80%|████████  | 92/115 [00:31<00:07,  3.20it/s][A
Iteration:  81%|████████  | 93/115 [00:31<00:06,  3.19it/s][A
Iteration:  82%|████████▏ | 94/115 [00:32<00:06,  3.20it/s][A
Iteration:  83%|████████▎ | 95/115 [00:32<00:06,  3.26it/s][A
Iteration:  83%|████████▎ | 96/115 [00:32<00:05,  3.30it/s][A
Iteration:  84%|████████▍ | 97/115 [00:33<00:05,  3.29it/s][A
Iteration:  85%|████████▌ | 98/115 [00:33<00:05,  3.33it/s][A
Iteration:  86%|████████▌ | 99/115 [00:33<00:05,  3.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:33<00:04,  3.21it/s][A
Iteration:  88%|████████▊ | 101/115 [00:34<00:04,  3.25it/s][A
Iteration:  89%|████████▊ | 102/115 [00:34<00:04,  3.23it/s][A
Iteration:  90%|████████▉ | 103/115 [00:34<00:03,  3.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:35<00:03,  3.35it/s][A
Iteration:  91%|█████████▏| 105/115 [00:35<00:02,  3.34it/s][A
Iteration:  92%|█████████▏| 106/115 [00:35<00:02,  3.31it/s][A
Iteration:  93%|█████████▎| 107/115 [00:36<00:02,  3.27it/s][A
Iteration:  94%|█████████▍| 108/115 [00:36<00:02,  3.32it/s][A
Iteration:  95%|█████████▍| 109/115 [00:36<00:01,  3.27it/s][A
Iteration:  96%|█████████▌| 110/115 [00:36<00:01,  3.33it/s][A
Iteration:  97%|█████████▋| 111/115 [00:37<00:01,  3.28it/s][A
Iteration:  97%|█████████▋| 112/115 [00:37<00:00,  3.23it/s][A
Iteration:  98%|█████████▊| 113/115 [00:37<00:00,  3.17it/s][A
Iteration:  99%|█████████▉| 114/115 [00:38<00:00,  3.22it/s][A[INFO|trainer.py:570] 2024-04-28 23:26:47,242 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence2, sentence1. If idx, sentence2, sentence1 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 23:26:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 23:26:47 - INFO - trainer.trainer_mod_2 -   Num examples = 408
04/28/2024 23:26:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A04/28/2024 23:26:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:01, 10.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 10.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:01<00:00, 10.11it/s][A[AEvaluation: 100%|██████████| 13/13 [00:01<00:00, 10.30it/s]04/28/2024 23:26:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
04/28/2024 23:26:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7058823529411765, 'f1': 0.8130841121495327, 'combined_score': 0.7594832325453547, 'eval_loss': 0.7394831, 'head_layers': [1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [525, 292, 226, 290, 227, 216, 211, 184, 191, 561, 155, 1187], 'head_nums': [5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 2, 1], 'pruned_params': 81020612, 'remaining_params': 3996988, 'pruned_model_sparsity': 0.9529863463565191, 'expected_sparsity': 0.94985, 'target_sparsity': 0.95, 'step': 11500}


Iteration: 100%|██████████| 115/115 [00:39<00:00,  1.47it/s][A04/28/2024 23:26:48 - INFO - trainer.trainer_mod_2 - Epoch 99 finished. Took 39.78 seconds.
Iteration: 100%|██████████| 115/115 [00:39<00:00,  2.89it/s]
Epoch: 100%|██████████| 100/100 [1:06:18<00:00, 39.18s/it]Epoch: 100%|██████████| 100/100 [1:06:18<00:00, 39.78s/it]
[INFO|configuration_utils.py:439] 2024-04-28 23:26:48,572 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 23:26:49,387 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-04-28 23:26:49,388 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-04-28 23:26:49,389 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi_mod_2/MRPC_sparsity0.95/special_tokens_map.json
04/28/2024 23:26:49 - INFO - __main__ - Training took 3988.73 seconds.
