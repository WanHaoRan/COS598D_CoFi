Sun Apr 21 15:58:37 EDT 2024
Your job is running on node(s):
adroit-h11g1
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/cola_mod_0.95
nvidia-smi output:
Sun Apr 21 15:58:37 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:CA:00.0 Off |                    0 |
| N/A   37C    P0              55W / 300W |      2MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/21/2024 15:58:39 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/21/2024 15:58:39 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95/runs/Apr21_15-58-39_adroit-h11g1,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/21/2024 15:58:39 - INFO - __main__ - Model Arguments:
04/21/2024 15:58:39 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/21/2024 15:58:39 - INFO - __main__ - config_name = None
04/21/2024 15:58:39 - INFO - __main__ - tokenizer_name = None
04/21/2024 15:58:39 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/21/2024 15:58:39 - INFO - __main__ - use_fast_tokenizer = True
04/21/2024 15:58:39 - INFO - __main__ - model_revision = main
04/21/2024 15:58:39 - INFO - __main__ - use_auth_token = False
04/21/2024 15:58:39 - INFO - __main__ - Data Arguments:
04/21/2024 15:58:39 - INFO - __main__ - task_name = cola
04/21/2024 15:58:39 - INFO - __main__ - dataset_name = None
04/21/2024 15:58:39 - INFO - __main__ - t_name = None
04/21/2024 15:58:39 - INFO - __main__ - dataset_config_name = None
04/21/2024 15:58:39 - INFO - __main__ - max_seq_length = 128
04/21/2024 15:58:39 - INFO - __main__ - overwrite_cache = False
04/21/2024 15:58:39 - INFO - __main__ - pad_to_max_length = True
04/21/2024 15:58:39 - INFO - __main__ - max_train_samples = None
04/21/2024 15:58:39 - INFO - __main__ - max_eval_samples = None
04/21/2024 15:58:39 - INFO - __main__ - max_predict_samples = None
04/21/2024 15:58:39 - INFO - __main__ - train_file = None
04/21/2024 15:58:39 - INFO - __main__ - validation_file = None
04/21/2024 15:58:39 - INFO - __main__ - test_file = None
04/21/2024 15:58:39 - INFO - __main__ - Training Arguments:
04/21/2024 15:58:39 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95
04/21/2024 15:58:39 - INFO - __main__ - overwrite_output_dir = True
04/21/2024 15:58:39 - INFO - __main__ - do_train = True
04/21/2024 15:58:39 - INFO - __main__ - do_eval = True
04/21/2024 15:58:39 - INFO - __main__ - do_predict = False
04/21/2024 15:58:39 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/21/2024 15:58:39 - INFO - __main__ - prediction_loss_only = False
04/21/2024 15:58:39 - INFO - __main__ - per_device_train_batch_size = 32
04/21/2024 15:58:39 - INFO - __main__ - per_device_eval_batch_size = 32
04/21/2024 15:58:39 - INFO - __main__ - per_gpu_train_batch_size = None
04/21/2024 15:58:39 - INFO - __main__ - per_gpu_eval_batch_size = None
04/21/2024 15:58:39 - INFO - __main__ - gradient_accumulation_steps = 1
04/21/2024 15:58:39 - INFO - __main__ - eval_accumulation_steps = None
04/21/2024 15:58:39 - INFO - __main__ - learning_rate = 2e-05
04/21/2024 15:58:39 - INFO - __main__ - weight_decay = 0.0
04/21/2024 15:58:39 - INFO - __main__ - adam_beta1 = 0.9
04/21/2024 15:58:39 - INFO - __main__ - adam_beta2 = 0.999
04/21/2024 15:58:39 - INFO - __main__ - adam_epsilon = 1e-08
04/21/2024 15:58:39 - INFO - __main__ - max_grad_norm = 1.0
04/21/2024 15:58:39 - INFO - __main__ - num_train_epochs = 100.0
04/21/2024 15:58:39 - INFO - __main__ - max_steps = -1
04/21/2024 15:58:39 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/21/2024 15:58:39 - INFO - __main__ - warmup_ratio = 0.0
04/21/2024 15:58:39 - INFO - __main__ - warmup_steps = 0
04/21/2024 15:58:39 - INFO - __main__ - log_level = -1
04/21/2024 15:58:39 - INFO - __main__ - log_level_replica = -1
04/21/2024 15:58:39 - INFO - __main__ - log_on_each_node = True
04/21/2024 15:58:39 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95/runs/Apr21_15-58-39_adroit-h11g1
04/21/2024 15:58:39 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/21/2024 15:58:39 - INFO - __main__ - logging_first_step = False
04/21/2024 15:58:39 - INFO - __main__ - logging_steps = 100
04/21/2024 15:58:39 - INFO - __main__ - logging_nan_inf_filter = True
04/21/2024 15:58:39 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/21/2024 15:58:39 - INFO - __main__ - save_steps = 0
04/21/2024 15:58:39 - INFO - __main__ - save_total_limit = None
04/21/2024 15:58:39 - INFO - __main__ - save_on_each_node = False
04/21/2024 15:58:39 - INFO - __main__ - no_cuda = False
04/21/2024 15:58:39 - INFO - __main__ - seed = 57
04/21/2024 15:58:39 - INFO - __main__ - bf16 = False
04/21/2024 15:58:39 - INFO - __main__ - fp16 = False
04/21/2024 15:58:39 - INFO - __main__ - fp16_opt_level = O1
04/21/2024 15:58:39 - INFO - __main__ - half_precision_backend = auto
04/21/2024 15:58:39 - INFO - __main__ - bf16_full_eval = False
04/21/2024 15:58:39 - INFO - __main__ - fp16_full_eval = False
04/21/2024 15:58:39 - INFO - __main__ - tf32 = None
04/21/2024 15:58:39 - INFO - __main__ - local_rank = -1
04/21/2024 15:58:39 - INFO - __main__ - xpu_backend = None
04/21/2024 15:58:39 - INFO - __main__ - tpu_num_cores = None
04/21/2024 15:58:39 - INFO - __main__ - tpu_metrics_debug = False
04/21/2024 15:58:39 - INFO - __main__ - debug = []
04/21/2024 15:58:39 - INFO - __main__ - dataloader_drop_last = False
04/21/2024 15:58:39 - INFO - __main__ - eval_steps = 50
04/21/2024 15:58:39 - INFO - __main__ - dataloader_num_workers = 0
04/21/2024 15:58:39 - INFO - __main__ - past_index = -1
04/21/2024 15:58:39 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95
04/21/2024 15:58:39 - INFO - __main__ - disable_tqdm = False
04/21/2024 15:58:39 - INFO - __main__ - remove_unused_columns = True
04/21/2024 15:58:39 - INFO - __main__ - label_names = None
04/21/2024 15:58:39 - INFO - __main__ - load_best_model_at_end = False
04/21/2024 15:58:39 - INFO - __main__ - metric_for_best_model = None
04/21/2024 15:58:39 - INFO - __main__ - greater_is_better = None
04/21/2024 15:58:39 - INFO - __main__ - ignore_data_skip = False
04/21/2024 15:58:39 - INFO - __main__ - sharded_ddp = []
04/21/2024 15:58:39 - INFO - __main__ - deepspeed = None
04/21/2024 15:58:39 - INFO - __main__ - label_smoothing_factor = 0.0
04/21/2024 15:58:39 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/21/2024 15:58:39 - INFO - __main__ - adafactor = False
04/21/2024 15:58:39 - INFO - __main__ - group_by_length = False
04/21/2024 15:58:39 - INFO - __main__ - length_column_name = length
04/21/2024 15:58:39 - INFO - __main__ - report_to = []
04/21/2024 15:58:39 - INFO - __main__ - ddp_find_unused_parameters = None
04/21/2024 15:58:39 - INFO - __main__ - ddp_bucket_cap_mb = None
04/21/2024 15:58:39 - INFO - __main__ - dataloader_pin_memory = True
04/21/2024 15:58:39 - INFO - __main__ - skip_memory_metrics = True
04/21/2024 15:58:39 - INFO - __main__ - use_legacy_prediction_loop = False
04/21/2024 15:58:39 - INFO - __main__ - push_to_hub = False
04/21/2024 15:58:39 - INFO - __main__ - resume_from_checkpoint = None
04/21/2024 15:58:39 - INFO - __main__ - hub_model_id = None
04/21/2024 15:58:39 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/21/2024 15:58:39 - INFO - __main__ - hub_token = None
04/21/2024 15:58:39 - INFO - __main__ - gradient_checkpointing = False
04/21/2024 15:58:39 - INFO - __main__ - fp16_backend = auto
04/21/2024 15:58:39 - INFO - __main__ - push_to_hub_model_id = None
04/21/2024 15:58:39 - INFO - __main__ - push_to_hub_organization = None
04/21/2024 15:58:39 - INFO - __main__ - push_to_hub_token = None
04/21/2024 15:58:39 - INFO - __main__ - mp_parameters = 
04/21/2024 15:58:39 - INFO - __main__ - _n_gpu = 1
04/21/2024 15:58:39 - INFO - __main__ - __cached__setup_devices = cuda:0
04/21/2024 15:58:39 - INFO - __main__ - Additional Arguments:
04/21/2024 15:58:39 - INFO - __main__ - test = False
04/21/2024 15:58:39 - INFO - __main__ - ex_name = CoLA_sparsity0.95
04/21/2024 15:58:39 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/21/2024 15:58:39 - INFO - __main__ - reg_learning_rate = 0.01
04/21/2024 15:58:39 - INFO - __main__ - scheduler_type = linear
04/21/2024 15:58:39 - INFO - __main__ - freeze_embeddings = True
04/21/2024 15:58:39 - INFO - __main__ - pretrained_pruned_model = None
04/21/2024 15:58:39 - INFO - __main__ - droprate_init = 0.5
04/21/2024 15:58:39 - INFO - __main__ - temperature = 0.6666666666666666
04/21/2024 15:58:39 - INFO - __main__ - prepruning_finetune_epochs = 4
04/21/2024 15:58:39 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/21/2024 15:58:39 - INFO - __main__ - target_sparsity = 0.95
04/21/2024 15:58:39 - INFO - __main__ - sparsity_epsilon = 0
04/21/2024 15:58:39 - INFO - __main__ - distillation_path = mofyrt/bert-base-uncased-finetuned-cola
04/21/2024 15:58:39 - INFO - __main__ - do_distill = True
04/21/2024 15:58:39 - INFO - __main__ - do_layer_distill = True
04/21/2024 15:58:39 - INFO - __main__ - layer_distill_version = 4
04/21/2024 15:58:39 - INFO - __main__ - distill_loss_alpha = 0.9
04/21/2024 15:58:39 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/21/2024 15:58:39 - INFO - __main__ - distill_temp = 2.0
04/21/2024 15:58:39 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/21/2024 15:58:39 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/21/2024 15:58:39 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/21/2024 15:58:39 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 1218.33it/s]
[INFO|configuration_utils.py:648] 2024-04-21 15:58:39,421 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-21 15:58:39,421 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "cola",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-21 15:58:39,422 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-21 15:58:39,422 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-21 15:58:39,424 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-21 15:58:39,424 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-21 15:58:39,424 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-21 15:58:39,424 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-21 15:58:39,425 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-21 15:58:39,426 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/21/2024 15:58:46 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/21/2024 15:58:46 - INFO - __main__ - Model size: 85054464
04/21/2024 15:58:46 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14e73c55d3a0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/21/2024 15:58:46 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/21/2024 15:58:46 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14e73c55d3a0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/21/2024 15:58:46 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/21/2024 15:58:46 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14e73c55d3a0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/21/2024 15:58:46 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/21/2024 15:58:46 - INFO - __main__ - Sample 8423 of the training set: {'sentence': 'Anson saw Anson.', 'label': 1, 'idx': 8423, 'input_ids': [101, 25435, 2387, 25435, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/21/2024 15:58:46 - INFO - __main__ - Sample 5262 of the training set: {'sentence': 'The men would not have all been working.', 'label': 1, 'idx': 5262, 'input_ids': [101, 1996, 2273, 2052, 2025, 2031, 2035, 2042, 2551, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/21/2024 15:58:46 - INFO - __main__ - Sample 7821 of the training set: {'sentence': 'Anson very happily demonized David.', 'label': 1, 'idx': 7821, 'input_ids': [101, 25435, 2200, 11361, 5698, 3550, 2585, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/21/2024 15:58:46 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/21/2024 15:58:46 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/21/2024 15:58:46 - INFO - __main__ - ************* 8551 Training Examples Loaded *************
04/21/2024 15:58:46 - INFO - __main__ - ************* 1043 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-21 15:58:46,758 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:58:46 - INFO - trainer.trainer_mod - Prepruning finetune steps: 100
04/21/2024 15:58:46 - INFO - trainer.trainer_mod - Lagrangian warmup steps: 5360
04/21/2024 15:58:46 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/21/2024 15:58:46 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/21/2024 15:58:46 - INFO - trainer.trainer_mod - ***** Running training *****
04/21/2024 15:58:46 - INFO - trainer.trainer_mod -   Num examples = 8551
04/21/2024 15:58:46 - INFO - trainer.trainer_mod -   Num Epochs = 100
04/21/2024 15:58:46 - INFO - trainer.trainer_mod -   Instantaneous batch size per device = 32
04/21/2024 15:58:46 - INFO - trainer.trainer_mod -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/21/2024 15:58:46 - INFO - trainer.trainer_mod -   Gradient Accumulation steps = 1
04/21/2024 15:58:46 - INFO - trainer.trainer_mod -   Total optimization steps = 26800
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-21 15:58:46,762 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:58:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:58:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:58:46 - INFO - trainer.trainer_mod -   Batch size = 32

Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A
Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.15it/s][A
Evaluation:   9%|▉         | 3/33 [00:00<00:02, 14.50it/s][A
Evaluation:  15%|█▌        | 5/33 [00:00<00:01, 16.27it/s][A
Evaluation:  21%|██        | 7/33 [00:00<00:01, 17.07it/s][A
Evaluation:  27%|██▋       | 9/33 [00:00<00:01, 17.52it/s][A
Evaluation:  33%|███▎      | 11/33 [00:00<00:01, 17.80it/s][A
Evaluation:  39%|███▉      | 13/33 [00:00<00:01, 17.96it/s][A
Evaluation:  45%|████▌     | 15/33 [00:00<00:00, 18.09it/s][A
Evaluation:  52%|█████▏    | 17/33 [00:00<00:00, 18.13it/s][A
Evaluation:  58%|█████▊    | 19/33 [00:01<00:00, 18.18it/s][A
Evaluation:  64%|██████▎   | 21/33 [00:01<00:00, 18.22it/s][A
Evaluation:  70%|██████▉   | 23/33 [00:01<00:00, 18.26it/s][A
Evaluation:  76%|███████▌  | 25/33 [00:01<00:00, 18.28it/s][A
Evaluation:  82%|████████▏ | 27/33 [00:01<00:00, 18.28it/s][A
Evaluation:  88%|████████▊ | 29/33 [00:01<00:00, 18.27it/s][A
Evaluation:  94%|█████████▍| 31/33 [00:01<00:00, 18.27it/s][AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.96it/s]04/21/2024 15:58:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 15:58:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': -0.015667329278145823, 'eval_loss': 0.6626569, 'step': 0}


Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/21/2024 15:58:48 - INFO - trainer.trainer_mod - v4 Global step: 0, Alignment: tensor([ 3,  5,  9, 10], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:32,  8.29it/s][A
Iteration:   1%|          | 3/268 [00:00<00:22, 11.59it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:19, 13.28it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:19, 13.61it/s][A
Iteration:   3%|▎         | 9/268 [00:00<00:22, 11.57it/s][A
Iteration:   4%|▍         | 11/268 [00:00<00:20, 12.50it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:19, 13.37it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:18, 13.52it/s][A
Iteration:   6%|▋         | 17/268 [00:01<00:18, 13.93it/s][A
Iteration:   7%|▋         | 19/268 [00:01<00:17, 14.63it/s][A
Iteration:   8%|▊         | 21/268 [00:01<00:16, 14.85it/s][A
Iteration:   9%|▊         | 23/268 [00:01<00:15, 15.42it/s][A
Iteration:   9%|▉         | 25/268 [00:01<00:16, 14.82it/s][A
Iteration:  10%|█         | 27/268 [00:01<00:17, 13.85it/s][A
Iteration:  11%|█         | 29/268 [00:02<00:16, 14.19it/s][A
Iteration:  12%|█▏        | 31/268 [00:02<00:16, 14.50it/s][A
Iteration:  12%|█▏        | 33/268 [00:02<00:16, 14.56it/s][A
Iteration:  13%|█▎        | 35/268 [00:02<00:16, 14.48it/s][A
Iteration:  14%|█▍        | 37/268 [00:02<00:15, 14.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:02<00:14, 15.29it/s][A
Iteration:  15%|█▌        | 41/268 [00:02<00:14, 15.15it/s][A
Iteration:  16%|█▌        | 43/268 [00:03<00:15, 14.73it/s][A
Iteration:  17%|█▋        | 45/268 [00:03<00:15, 14.74it/s][A
Iteration:  18%|█▊        | 47/268 [00:03<00:14, 15.20it/s][A
Iteration:  18%|█▊        | 49/268 [00:03<00:14, 15.49it/s][A[INFO|trainer.py:570] 2024-04-21 15:58:52,135 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:58:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:58:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:58:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 18.48it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 18.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 18.34it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 18.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 18.29it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 18.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 18.31it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 18.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:00<00:00, 18.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 18.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 18.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 18.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 18.31it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 18.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 18.28it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 18.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 18.51it/s]04/21/2024 15:58:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 15:58:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4420898648237221, 'eval_loss': 0.58655524, 'step': 50}


Iteration:  19%|█▉        | 51/268 [00:05<01:13,  2.96it/s][A
Iteration:  20%|█▉        | 53/268 [00:05<00:55,  3.89it/s][A
Iteration:  21%|██        | 55/268 [00:05<00:42,  5.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:05<00:33,  6.26it/s][A
Iteration:  22%|██▏       | 59/268 [00:05<00:27,  7.67it/s][A
Iteration:  23%|██▎       | 61/268 [00:06<00:22,  9.11it/s][A
Iteration:  24%|██▎       | 63/268 [00:06<00:19, 10.38it/s][A
Iteration:  24%|██▍       | 65/268 [00:06<00:17, 11.65it/s][A
Iteration:  25%|██▌       | 67/268 [00:06<00:15, 12.57it/s][A
Iteration:  26%|██▌       | 69/268 [00:06<00:14, 13.51it/s][A
Iteration:  26%|██▋       | 71/268 [00:06<00:14, 14.04it/s][A
Iteration:  27%|██▋       | 73/268 [00:06<00:13, 14.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:06<00:13, 14.74it/s][A
Iteration:  29%|██▊       | 77/268 [00:07<00:12, 14.77it/s][A
Iteration:  29%|██▉       | 79/268 [00:07<00:12, 15.19it/s][A
Iteration:  30%|███       | 81/268 [00:07<00:12, 15.51it/s][A
Iteration:  31%|███       | 83/268 [00:07<00:11, 15.77it/s][A
Iteration:  32%|███▏      | 85/268 [00:07<00:11, 15.60it/s][A
Iteration:  32%|███▏      | 87/268 [00:07<00:11, 15.09it/s][A
Iteration:  33%|███▎      | 89/268 [00:07<00:11, 15.04it/s][A
Iteration:  34%|███▍      | 91/268 [00:07<00:11, 14.97it/s][A
Iteration:  35%|███▍      | 93/268 [00:08<00:11, 14.95it/s][A
Iteration:  35%|███▌      | 95/268 [00:08<00:12, 14.33it/s][A
Iteration:  36%|███▌      | 97/268 [00:08<00:12, 14.02it/s][A
Iteration:  37%|███▋      | 99/268 [00:08<00:11, 14.43it/s][A[INFO|trainer.py:570] 2024-04-21 15:58:57,222 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:58:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:58:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:58:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:01, 18.36it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 18.31it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 18.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 18.31it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 18.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 18.32it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 18.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 18.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:00<00:00, 18.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 18.27it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 18.28it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 18.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 18.30it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 18.31it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 18.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 18.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 18.51it/s]04/21/2024 15:58:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 15:58:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.5127103010689016, 'eval_loss': 0.5428765, 'step': 100}
04/21/2024 15:58:59 - INFO - trainer.trainer_mod - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/21/2024 15:58:59 - INFO - trainer.trainer_mod - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/21/2024 15:58:59 - INFO - trainer.trainer_mod - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/21/2024 15:58:59 - INFO - trainer.trainer_mod - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/21/2024 15:58:59 - INFO - trainer.trainer_mod - Starting l0 regularization!
04/21/2024 15:58:59 - INFO - trainer.trainer_mod - v4 Global step: 100, Alignment: tensor([ 5,  7,  8, 10], device='cuda:0')


Iteration:  38%|███▊      | 101/268 [00:10<00:59,  2.82it/s][A
Iteration:  38%|███▊      | 103/268 [00:10<00:47,  3.47it/s][A
Iteration:  39%|███▉      | 104/268 [00:10<00:42,  3.83it/s][A
Iteration:  39%|███▉      | 105/268 [00:11<00:38,  4.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:11<00:34,  4.66it/s][A
Iteration:  40%|███▉      | 107/268 [00:11<00:31,  5.12it/s][A
Iteration:  40%|████      | 108/268 [00:11<00:28,  5.57it/s][A
Iteration:  41%|████      | 109/268 [00:11<00:26,  5.96it/s][A
Iteration:  41%|████      | 110/268 [00:11<00:25,  6.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:11<00:24,  6.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:12<00:23,  6.75it/s][A
Iteration:  42%|████▏     | 113/268 [00:12<00:22,  6.85it/s][A
Iteration:  43%|████▎     | 114/268 [00:12<00:22,  6.89it/s][A
Iteration:  43%|████▎     | 115/268 [00:12<00:21,  7.03it/s][A
Iteration:  43%|████▎     | 116/268 [00:12<00:21,  7.16it/s][A
Iteration:  44%|████▎     | 117/268 [00:12<00:20,  7.24it/s][A
Iteration:  44%|████▍     | 118/268 [00:12<00:21,  7.14it/s][A
Iteration:  44%|████▍     | 119/268 [00:13<00:20,  7.21it/s][A
Iteration:  45%|████▍     | 120/268 [00:13<00:20,  7.12it/s][A
Iteration:  45%|████▌     | 121/268 [00:13<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 122/268 [00:13<00:20,  7.19it/s][A
Iteration:  46%|████▌     | 123/268 [00:13<00:19,  7.28it/s][A
Iteration:  46%|████▋     | 124/268 [00:13<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:13<00:19,  7.36it/s][A
Iteration:  47%|████▋     | 126/268 [00:13<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:14<00:19,  7.35it/s][A
Iteration:  48%|████▊     | 128/268 [00:14<00:19,  7.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:14<00:18,  7.40it/s][A
Iteration:  49%|████▊     | 130/268 [00:14<00:18,  7.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:14<00:18,  7.53it/s][A
Iteration:  49%|████▉     | 132/268 [00:14<00:18,  7.51it/s][A
Iteration:  50%|████▉     | 133/268 [00:14<00:18,  7.47it/s][A
Iteration:  50%|█████     | 134/268 [00:15<00:18,  7.39it/s][A
Iteration:  50%|█████     | 135/268 [00:15<00:17,  7.56it/s][A
Iteration:  51%|█████     | 136/268 [00:15<00:17,  7.52it/s][A
Iteration:  51%|█████     | 137/268 [00:15<00:17,  7.47it/s][A
Iteration:  51%|█████▏    | 138/268 [00:15<00:17,  7.24it/s][A
Iteration:  52%|█████▏    | 139/268 [00:15<00:17,  7.31it/s][A
Iteration:  52%|█████▏    | 140/268 [00:15<00:17,  7.23it/s][A
Iteration:  53%|█████▎    | 141/268 [00:16<00:17,  7.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:16<00:17,  7.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:16<00:16,  7.57it/s][A
Iteration:  54%|█████▎    | 144/268 [00:16<00:16,  7.53it/s][A
Iteration:  54%|█████▍    | 145/268 [00:16<00:16,  7.51it/s][A
Iteration:  54%|█████▍    | 146/268 [00:16<00:16,  7.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:16<00:15,  7.62it/s][A
Iteration:  55%|█████▌    | 148/268 [00:16<00:15,  7.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:17<00:15,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 15:59:05,827 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:59:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:59:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:59:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 15:59:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.63it/s]04/21/2024 15:59:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 15:59:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0463559874942472, 'eval_loss': 0.9356063, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2583, 2582, 2582, 2583, 2583, 2581, 2578, 2578, 2580, 2592, 2604, 2600], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9247944, 'remaining_params': 75769656, 'pruned_model_sparsity': 0.1087768179765131, 'expected_sparsity': 0.11036, 'target_sparsity': 0.008861940298507462, 'step': 150}


Iteration:  56%|█████▌    | 150/268 [00:19<01:27,  1.35it/s][A
Iteration:  56%|█████▋    | 151/268 [00:19<01:05,  1.78it/s][A
Iteration:  57%|█████▋    | 152/268 [00:19<00:50,  2.31it/s][A
Iteration:  57%|█████▋    | 153/268 [00:19<00:39,  2.89it/s][A
Iteration:  57%|█████▋    | 154/268 [00:19<00:32,  3.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:19<00:27,  4.18it/s][A
Iteration:  58%|█████▊    | 156/268 [00:20<00:23,  4.71it/s][A
Iteration:  59%|█████▊    | 157/268 [00:20<00:21,  5.19it/s][A
Iteration:  59%|█████▉    | 158/268 [00:20<00:19,  5.65it/s][A
Iteration:  59%|█████▉    | 159/268 [00:20<00:17,  6.10it/s][A
Iteration:  60%|█████▉    | 160/268 [00:20<00:16,  6.45it/s][A
Iteration:  60%|██████    | 161/268 [00:20<00:15,  6.88it/s][A
Iteration:  60%|██████    | 162/268 [00:20<00:14,  7.07it/s][A
Iteration:  61%|██████    | 163/268 [00:21<00:14,  7.21it/s][A
Iteration:  61%|██████    | 164/268 [00:21<00:14,  7.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:21<00:13,  7.38it/s][A
Iteration:  62%|██████▏   | 166/268 [00:21<00:14,  7.20it/s][A
Iteration:  62%|██████▏   | 167/268 [00:21<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 168/268 [00:21<00:13,  7.34it/s][A
Iteration:  63%|██████▎   | 169/268 [00:21<00:13,  7.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:21<00:13,  7.27it/s][A
Iteration:  64%|██████▍   | 171/268 [00:22<00:13,  7.31it/s][A
Iteration:  64%|██████▍   | 172/268 [00:22<00:13,  7.38it/s][A
Iteration:  65%|██████▍   | 173/268 [00:22<00:12,  7.41it/s][A
Iteration:  65%|██████▍   | 174/268 [00:22<00:12,  7.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:22<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:22<00:12,  7.27it/s][A
Iteration:  66%|██████▌   | 177/268 [00:22<00:12,  7.23it/s][A
Iteration:  66%|██████▋   | 178/268 [00:23<00:12,  7.21it/s][A
Iteration:  67%|██████▋   | 179/268 [00:23<00:12,  7.20it/s][A
Iteration:  67%|██████▋   | 180/268 [00:23<00:12,  7.30it/s][A
Iteration:  68%|██████▊   | 181/268 [00:23<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:23<00:11,  7.46it/s][A
Iteration:  68%|██████▊   | 183/268 [00:23<00:11,  7.44it/s][A
Iteration:  69%|██████▊   | 184/268 [00:23<00:11,  7.47it/s][A
Iteration:  69%|██████▉   | 185/268 [00:24<00:11,  7.50it/s][A
Iteration:  69%|██████▉   | 186/268 [00:24<00:11,  7.36it/s][A
Iteration:  70%|██████▉   | 187/268 [00:24<00:11,  7.28it/s][A
Iteration:  70%|███████   | 188/268 [00:24<00:10,  7.36it/s][A
Iteration:  71%|███████   | 189/268 [00:24<00:10,  7.40it/s][A
Iteration:  71%|███████   | 190/268 [00:24<00:10,  7.44it/s][A
Iteration:  71%|███████▏  | 191/268 [00:24<00:10,  7.45it/s][A
Iteration:  72%|███████▏  | 192/268 [00:24<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 193/268 [00:25<00:10,  7.32it/s][A
Iteration:  72%|███████▏  | 194/268 [00:25<00:10,  7.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:25<00:09,  7.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:25<00:09,  7.45it/s][A
Iteration:  74%|███████▎  | 197/268 [00:25<00:09,  7.35it/s][A
Iteration:  74%|███████▍  | 198/268 [00:25<00:09,  7.28it/s][A
Iteration:  74%|███████▍  | 199/268 [00:25<00:09,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 15:59:14,655 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:59:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:59:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:59:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 15:59:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 15:59:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 15:59:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 1.0195842, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2609, 2605, 2603, 2603, 2600, 2597, 2591, 2592, 2603, 2628, 2657, 2674], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8733192, 'remaining_params': 76284408, 'pruned_model_sparsity': 0.1027221657633243, 'expected_sparsity': 0.10432, 'target_sparsity': 0.017723880597014924, 'step': 200}


Iteration:  75%|███████▍  | 200/268 [00:28<00:50,  1.35it/s][A04/21/2024 15:59:16 - INFO - trainer.trainer_mod - v4 Global step: 200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:28<00:37,  1.77it/s][A
Iteration:  75%|███████▌  | 202/268 [00:28<00:28,  2.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:28<00:22,  2.87it/s][A
Iteration:  76%|███████▌  | 204/268 [00:28<00:18,  3.49it/s][A
Iteration:  76%|███████▋  | 205/268 [00:28<00:15,  4.10it/s][A
Iteration:  77%|███████▋  | 206/268 [00:28<00:12,  4.82it/s][A
Iteration:  77%|███████▋  | 207/268 [00:29<00:11,  5.40it/s][A
Iteration:  78%|███████▊  | 208/268 [00:29<00:10,  5.91it/s][A
Iteration:  78%|███████▊  | 209/268 [00:29<00:09,  6.32it/s][A
Iteration:  78%|███████▊  | 210/268 [00:29<00:08,  6.63it/s][A
Iteration:  79%|███████▊  | 211/268 [00:29<00:08,  6.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:29<00:08,  6.91it/s][A
Iteration:  79%|███████▉  | 213/268 [00:29<00:07,  7.07it/s][A
Iteration:  80%|███████▉  | 214/268 [00:30<00:07,  7.00it/s][A
Iteration:  80%|████████  | 215/268 [00:30<00:07,  7.12it/s][A
Iteration:  81%|████████  | 216/268 [00:30<00:07,  7.14it/s][A
Iteration:  81%|████████  | 217/268 [00:30<00:07,  7.23it/s][A
Iteration:  81%|████████▏ | 218/268 [00:30<00:06,  7.33it/s][A
Iteration:  82%|████████▏ | 219/268 [00:30<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 220/268 [00:30<00:06,  7.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:30<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:31<00:06,  7.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:31<00:06,  7.32it/s][A
Iteration:  84%|████████▎ | 224/268 [00:31<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:31<00:05,  7.45it/s][A
Iteration:  84%|████████▍ | 226/268 [00:31<00:05,  7.44it/s][A
Iteration:  85%|████████▍ | 227/268 [00:31<00:05,  7.38it/s][A
Iteration:  85%|████████▌ | 228/268 [00:31<00:05,  7.42it/s][A
Iteration:  85%|████████▌ | 229/268 [00:32<00:05,  7.26it/s][A
Iteration:  86%|████████▌ | 230/268 [00:32<00:05,  7.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:32<00:05,  7.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:32<00:04,  7.44it/s][A
Iteration:  87%|████████▋ | 233/268 [00:32<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 234/268 [00:32<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:32<00:04,  7.47it/s][A
Iteration:  88%|████████▊ | 236/268 [00:32<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:33<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:33<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 239/268 [00:33<00:03,  7.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:33<00:03,  7.51it/s][A
Iteration:  90%|████████▉ | 241/268 [00:33<00:03,  7.52it/s][A
Iteration:  90%|█████████ | 242/268 [00:33<00:03,  7.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:33<00:03,  7.50it/s][A
Iteration:  91%|█████████ | 244/268 [00:34<00:03,  7.51it/s][A
Iteration:  91%|█████████▏| 245/268 [00:34<00:03,  7.53it/s][A
Iteration:  92%|█████████▏| 246/268 [00:34<00:03,  7.32it/s][A
Iteration:  92%|█████████▏| 247/268 [00:34<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 248/268 [00:34<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 249/268 [00:34<00:02,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 15:59:23,461 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:59:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:59:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:59:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 15:59:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 15:59:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 15:59:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.08036809130702588, 'eval_loss': 0.96048427, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2633, 2627, 2624, 2624, 2619, 2615, 2607, 2611, 2630, 2674, 2712, 2744], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8184736, 'remaining_params': 76832864, 'pruned_model_sparsity': 0.09627107798855766, 'expected_sparsity': 0.09789, 'target_sparsity': 0.02658582089552239, 'step': 250}


Iteration:  93%|█████████▎| 250/268 [00:36<00:13,  1.35it/s][A
Iteration:  94%|█████████▎| 251/268 [00:37<00:09,  1.78it/s][A
Iteration:  94%|█████████▍| 252/268 [00:37<00:06,  2.31it/s][A
Iteration:  94%|█████████▍| 253/268 [00:37<00:05,  2.91it/s][A
Iteration:  95%|█████████▍| 254/268 [00:37<00:03,  3.57it/s][A
Iteration:  95%|█████████▌| 255/268 [00:37<00:03,  4.21it/s][A
Iteration:  96%|█████████▌| 256/268 [00:37<00:02,  4.82it/s][A
Iteration:  96%|█████████▌| 257/268 [00:37<00:02,  5.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:37<00:01,  5.78it/s][A
Iteration:  97%|█████████▋| 259/268 [00:38<00:01,  6.20it/s][A
Iteration:  97%|█████████▋| 260/268 [00:38<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:38<00:01,  6.65it/s][A
Iteration:  98%|█████████▊| 262/268 [00:38<00:00,  6.88it/s][A
Iteration:  98%|█████████▊| 263/268 [00:38<00:00,  7.04it/s][A
Iteration:  99%|█████████▊| 264/268 [00:38<00:00,  7.17it/s][A
Iteration:  99%|█████████▉| 265/268 [00:38<00:00,  7.27it/s][A
Iteration:  99%|█████████▉| 266/268 [00:39<00:00,  7.17it/s][A
Iteration: 100%|█████████▉| 267/268 [00:39<00:00,  7.19it/s][A
Iteration: 100%|██████████| 268/268 [00:39<00:00,  7.71it/s][A04/21/2024 15:59:27 - INFO - trainer.trainer_mod - Epoch 0 finished. Took 39.31 seconds.
Iteration: 100%|██████████| 268/268 [00:39<00:00,  6.82it/s]
Epoch:   1%|          | 1/100 [00:41<1:07:54, 41.16s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.07it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.33it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.48it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.53it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.55it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.74it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.62it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.60it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.58it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.52it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.52it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.21it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.32it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.25it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.34it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.27it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.26it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.35it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.17it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.25it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.16it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.13it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 15:59:32,261 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:59:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:59:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:59:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 15:59:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 15:59:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 15:59:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.1030527342855949, 'eval_loss': 1.2370356, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2657, 2650, 2645, 2645, 2639, 2633, 2626, 2631, 2662, 2720, 2765, 2805], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7636280, 'remaining_params': 77381320, 'pruned_model_sparsity': 0.08981999021379103, 'expected_sparsity': 0.09145, 'target_sparsity': 0.03544776119402985, 'step': 300}


Iteration:  12%|█▏        | 32/268 [00:06<02:57,  1.33it/s][A04/21/2024 15:59:34 - INFO - trainer.trainer_mod - v4 Global step: 300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:13,  1.77it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:42,  2.29it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:20,  2.89it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:04,  3.58it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:54,  4.24it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:47,  4.88it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:42,  5.39it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:39,  5.78it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:36,  6.22it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:34,  6.55it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.83it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:31,  7.10it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.21it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.23it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.53it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.56it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.43it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.47it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.41it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.29it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.18it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.26it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.29it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.46it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.37it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.32it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.37it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.41it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.31it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.41it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.42it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.44it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.47it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.61it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.47it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.35it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.58it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 15:59:41,033 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:59:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:59:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:59:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 15:59:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.43it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]04/21/2024 15:59:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 15:59:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.17269794723842352, 'eval_loss': 1.3400071, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2679, 2671, 2665, 2665, 2656, 2651, 2638, 2647, 2693, 2762, 2811, 2852], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7158296, 'remaining_params': 77859304, 'pruned_model_sparsity': 0.08419781315868714, 'expected_sparsity': 0.08583, 'target_sparsity': 0.044309701492537316, 'step': 350}


Iteration:  31%|███       | 82/268 [00:15<02:18,  1.34it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:43,  1.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<01:20,  2.27it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:03,  2.89it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:51,  3.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:42,  4.24it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:36,  4.87it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:33,  5.38it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:30,  5.89it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:28,  6.31it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.64it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.69it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:25,  6.71it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:24,  6.94it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:24,  7.09it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  6.96it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  7.08it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.22it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.33it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.24it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  7.16it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:22,  7.24it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.31it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.37it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.37it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.07it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  7.19it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.19it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.27it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.33it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.40it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.45it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:21,  7.15it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.27it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.21it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.29it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.49it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.31it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.36it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.39it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.41it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.41it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 15:59:49,910 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:59:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:59:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:59:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 15:59:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]04/21/2024 15:59:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 15:59:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0928457264044978, 'eval_loss': 1.4299961, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2697, 2687, 2681, 2680, 2668, 2664, 2646, 2662, 2720, 2797, 2847, 2888], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6779892, 'remaining_params': 78237708, 'pruned_model_sparsity': 0.07974692299006324, 'expected_sparsity': 0.0814, 'target_sparsity': 0.05317164179104478, 'step': 400}


Iteration:  49%|████▉     | 132/268 [00:24<01:42,  1.33it/s][A04/21/2024 15:59:51 - INFO - trainer.trainer_mod - v4 Global step: 400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:24<01:16,  1.76it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:58,  2.29it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:45,  2.91it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:37,  3.54it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:31,  4.17it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:27,  4.80it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:23,  5.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:21,  5.87it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:20,  6.16it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:19,  6.45it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.04it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  7.10it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.38it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.45it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.46it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.62it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.57it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.54it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.32it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.19it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.57it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.56it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.51it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.39it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.42it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.47it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.44it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.35it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.33it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.58it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.67it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.53it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.50it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.47it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.41it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.56it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.32it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 15:59:58,670 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 15:59:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 15:59:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 15:59:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 15:59:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.57it/s]04/21/2024 16:00:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:00:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 1.3346131, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2713, 2701, 2695, 2695, 2679, 2675, 2654, 2674, 2741, 2825, 2877, 2915], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6462768, 'remaining_params': 78554832, 'pruned_model_sparsity': 0.07601682475158085, 'expected_sparsity': 0.07766, 'target_sparsity': 0.06203358208955223, 'step': 450}


Iteration:  68%|██████▊   | 182/268 [00:32<01:04,  1.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:47,  1.77it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:36,  2.31it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:28,  2.89it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:23,  3.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:19,  4.19it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:16,  4.82it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:15,  5.17it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:13,  5.80it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:12,  6.31it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:11,  6.64it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.03it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.16it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.22it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  7.20it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.26it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.44it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.45it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.44it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.44it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.35it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.39it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.16it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.26it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.33it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.39it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.45it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.46it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.43it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.21it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.17it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.27it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.41it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.42it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.32it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.16it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  6.91it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.08it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.29it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 16:00:07,520 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:00:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:00:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:00:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:00:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.58it/s]04/21/2024 16:00:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:00:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0463559874942472, 'eval_loss': 1.0340811, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2727, 2714, 2707, 2707, 2689, 2686, 2664, 2686, 2762, 2850, 2901, 2936], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6179348, 'remaining_params': 78838252, 'pruned_model_sparsity': 0.0726831620746763, 'expected_sparsity': 0.07434, 'target_sparsity': 0.0708955223880597, 'step': 500}


Iteration:  87%|████████▋ | 232/268 [00:41<00:27,  1.33it/s][A04/21/2024 16:00:09 - INFO - trainer.trainer_mod - v4 Global step: 500, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:41<00:19,  1.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:14,  2.28it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:11,  2.88it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:09,  3.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:07,  4.21it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:06,  4.85it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:05,  5.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  5.91it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:04,  6.23it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  6.66it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  6.87it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.05it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.35it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.17it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.44it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.47it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.88it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.97it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.08it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.19it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.53it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.51it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.13it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.01it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.11it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.21it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.28it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.84it/s][A04/21/2024 16:00:14 - INFO - trainer.trainer_mod - Epoch 1 finished. Took 46.5 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.76it/s]
Epoch:   2%|▏         | 2/100 [01:27<1:12:21, 44.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.50it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.04it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.36it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.26it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.29it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.29it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:37,  6.95it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.13it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.12it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.25it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 16:00:16,348 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:00:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:00:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:00:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:00:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]04/21/2024 16:00:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:00:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.1225138970340786, 'eval_loss': 1.3805137, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2740, 2726, 2719, 2717, 2697, 2692, 2671, 2696, 2779, 2868, 2920, 2952], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5952612, 'remaining_params': 79064988, 'pruned_model_sparsity': 0.07001623193315266, 'expected_sparsity': 0.07169, 'target_sparsity': 0.07975746268656717, 'step': 550}


Iteration:   5%|▌         | 14/268 [00:03<03:10,  1.33it/s][A
Iteration:   6%|▌         | 15/268 [00:04<02:22,  1.77it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:49,  2.30it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:26,  2.91it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:10,  3.56it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:58,  4.23it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:50,  4.87it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:45,  5.46it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:41,  5.94it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:38,  6.43it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.72it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.04it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.07it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.11it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.19it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.26it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.47it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.62it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.48it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.40it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.20it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.06it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.03it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  7.09it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.23it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.20it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:30,  7.30it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.45it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.48it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.51it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.52it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.32it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.39it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.42it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.33it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:28,  7.33it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.28it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.37it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:00:25,106 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:00:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:00:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:00:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:00:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]04/21/2024 16:00:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:00:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.12845843450656336, 'eval_loss': 1.3851993, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2750, 2735, 2728, 2723, 2703, 2698, 2673, 2697, 2790, 2882, 2936, 2965], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5794816, 'remaining_params': 79222784, 'pruned_model_sparsity': 0.06816019271303825, 'expected_sparsity': 0.06983, 'target_sparsity': 0.08861940298507463, 'step': 600}


Iteration:  24%|██▍       | 64/268 [00:12<02:31,  1.34it/s][A04/21/2024 16:00:27 - INFO - trainer.trainer_mod - v4 Global step: 600, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:12<01:54,  1.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<01:26,  2.32it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:08,  2.94it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:55,  3.60it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:46,  4.26it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:40,  4.90it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:36,  5.45it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:33,  5.89it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:31,  6.28it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:29,  6.59it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:28,  6.76it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  6.90it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.08it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.22it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.21it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.29it/s][A
Iteration:  30%|███       | 81/268 [00:15<00:25,  7.32it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.27it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.33it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.09it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.01it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.11it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.24it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.20it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.22it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.18it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.26it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.36it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.42it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.40it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.64it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.56it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.66it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.48it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.52it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.53it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.42it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 16:00:33,909 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:00:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:00:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:00:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:00:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.58it/s]04/21/2024 16:00:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:00:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.11385516999396013, 'eval_loss': 1.4101164, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2756, 2742, 2735, 2728, 2705, 2700, 2672, 2698, 2800, 2894, 2948, 2974], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5684512, 'remaining_params': 79333088, 'pruned_model_sparsity': 0.0668627672387835, 'expected_sparsity': 0.06855, 'target_sparsity': 0.09748134328358209, 'step': 650}


Iteration:  43%|████▎     | 114/268 [00:21<01:55,  1.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<01:26,  1.77it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<01:06,  2.28it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:52,  2.88it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:42,  3.53it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:35,  4.19it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:30,  4.85it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:27,  5.43it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:24,  5.93it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:23,  6.26it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:22,  6.32it/s][A
Iteration:  47%|████▋     | 125/268 [00:23<00:21,  6.61it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.74it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:20,  6.96it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.11it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.21it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.31it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.37it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.53it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.38it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.31it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.22it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.33it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.26it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.34it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.28it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:17,  7.35it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.39it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:18,  6.79it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.00it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  7.11it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  7.09it/s][A
Iteration:  55%|█████▍    | 147/268 [00:26<00:16,  7.21it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.30it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.14it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.36it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.45it/s][A
Iteration:  57%|█████▋    | 154/268 [00:27<00:15,  7.23it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.17it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.28it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.36it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.26it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.62it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.61it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.36it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:00:42,798 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:00:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:00:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:00:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:00:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.57it/s]04/21/2024 16:00:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:00:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0863794254719202, 'eval_loss': 1.4432415, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2762, 2747, 2738, 2733, 2708, 2702, 2673, 2697, 2805, 2901, 2957, 2982], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5603316, 'remaining_params': 79414284, 'pruned_model_sparsity': 0.06590771793134598, 'expected_sparsity': 0.06768, 'target_sparsity': 0.10634328358208955, 'step': 700}


Iteration:  61%|██████    | 164/268 [00:30<01:18,  1.33it/s][A04/21/2024 16:00:44 - INFO - trainer.trainer_mod - v4 Global step: 700, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:30<00:58,  1.76it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:44,  2.29it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:35,  2.88it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:28,  3.56it/s][A
Iteration:  63%|██████▎   | 169/268 [00:31<00:23,  4.23it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:20,  4.88it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:17,  5.46it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:16,  5.88it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:15,  6.29it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:14,  6.60it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.86it/s][A
Iteration:  66%|██████▌   | 176/268 [00:32<00:13,  7.05it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.08it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.18it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.10it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.22it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.33it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.39it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:11,  7.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.52it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.49it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.29it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.34it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.38it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.44it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.54it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.33it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.27it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.19it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.31it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.39it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  7.22it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.32it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.19it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.26it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.40it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.41it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 16:00:51,594 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:00:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:00:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:00:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:00:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.57it/s]04/21/2024 16:00:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:00:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.11716571434177496, 'eval_loss': 1.3861978, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2766, 2751, 2741, 2736, 2711, 2704, 2676, 2700, 2810, 2907, 2964, 2987], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5529780, 'remaining_params': 79487820, 'pruned_model_sparsity': 0.06504276761517615, 'expected_sparsity': 0.06681, 'target_sparsity': 0.11520522388059701, 'step': 750}


Iteration:  80%|███████▉  | 214/268 [00:39<00:40,  1.34it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:29,  1.77it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:22,  2.30it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:17,  2.91it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:14,  3.56it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:11,  4.21it/s][A
Iteration:  82%|████████▏ | 220/268 [00:40<00:10,  4.80it/s][A
Iteration:  82%|████████▏ | 221/268 [00:40<00:08,  5.28it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:07,  5.79it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:07,  6.10it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.37it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.68it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.99it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.11it/s][A
Iteration:  85%|████████▌ | 228/268 [00:41<00:05,  7.09it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.34it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.62it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.60it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.65it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:04,  7.48it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.47it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:03,  7.51it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.52it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.39it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.42it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.45it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.48it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.46it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.28it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.21it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.19it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.04it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.18it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.13it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.88it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  6.94it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.01it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.33it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:01:00,408 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:01:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:01:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:01:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:01:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.34it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]04/21/2024 16:01:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:01:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.08397945416660721, 'eval_loss': 1.4357809, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2769, 2753, 2744, 2739, 2713, 2705, 2673, 2697, 2810, 2908, 2969, 2990], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5503736, 'remaining_params': 79513864, 'pruned_model_sparsity': 0.06473643104486601, 'expected_sparsity': 0.06648, 'target_sparsity': 0.12406716417910446, 'step': 800}


Iteration:  99%|█████████▊| 264/268 [00:48<00:02,  1.34it/s][A04/21/2024 16:01:02 - INFO - trainer.trainer_mod - v4 Global step: 800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:48<00:01,  1.78it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  2.29it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  2.87it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  3.64it/s][A04/21/2024 16:01:02 - INFO - trainer.trainer_mod - Epoch 2 finished. Took 48.56 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.52it/s]
Epoch:   3%|▎         | 3/100 [02:16<1:14:45, 46.24s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.16it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.12it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.21it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.16it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.30it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.34it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.39it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.40it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.35it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.31it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.26it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.41it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.46it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.41it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.41it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.35it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.01it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.14it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.26it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.16it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.15it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.18it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.22it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.27it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.36it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.28it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.36it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:31,  7.26it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.36it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.28it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.29it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:31,  7.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:06<00:30,  7.27it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:30,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:01:09,266 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:01:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:01:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:01:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:01:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.38it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.35it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.37it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.36it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.38it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]04/21/2024 16:01:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:01:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.11382192951310593, 'eval_loss': 1.5154045, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2770, 2754, 2745, 2740, 2713, 2703, 2662, 2692, 2806, 2907, 2972, 2991], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5526716, 'remaining_params': 79490884, 'pruned_model_sparsity': 0.06500672801866908, 'expected_sparsity': 0.06674, 'target_sparsity': 0.13292910447761191, 'step': 850}


Iteration:  17%|█▋        | 46/268 [00:08<02:45,  1.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:04,  1.77it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:35,  2.30it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:15,  2.91it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:00,  3.59it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:51,  4.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:44,  4.89it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:39,  5.45it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:36,  5.82it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:34,  6.18it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:32,  6.54it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:31,  6.80it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:30,  6.99it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:29,  7.03it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.18it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.26it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.32it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.12it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.12it/s][A
Iteration:  25%|██▍       | 66/268 [00:11<00:28,  7.00it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:28,  7.12it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.23it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.22it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.29it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.38it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.46it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.44it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.28it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:26,  7.13it/s][A
Iteration:  30%|███       | 81/268 [00:13<00:25,  7.27it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.24it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.51it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.71it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.65it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.76it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:23,  7.67it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.62it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.48it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:23,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:01:18,050 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:01:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:01:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:01:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:01:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.35it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.56it/s]04/21/2024 16:01:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:01:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.0928457264044978, 'eval_loss': 1.2962613, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2770, 2753, 2745, 2739, 2710, 2699, 2655, 2684, 2800, 2904, 2973, 2990], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5577272, 'remaining_params': 79440328, 'pruned_model_sparsity': 0.06560138136103583, 'expected_sparsity': 0.06738, 'target_sparsity': 0.1417910447761194, 'step': 900}


Iteration:  36%|███▌      | 96/268 [00:17<02:08,  1.34it/s][A04/21/2024 16:01:20 - INFO - trainer.trainer_mod - v4 Global step: 900, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:17<01:36,  1.77it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<01:14,  2.29it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:58,  2.89it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:47,  3.55it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:39,  4.22it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:34,  4.81it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<00:30,  5.38it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:28,  5.81it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:26,  6.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:24,  6.55it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:23,  6.82it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.91it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:23,  6.91it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:22,  7.06it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.27it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.36it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.22it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.32it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.28it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.50it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.45it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.44it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.57it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.76it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 125/268 [00:21<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.72it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.66it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.40it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.61it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:17,  7.56it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:17,  7.67it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.63it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.47it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.61it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:16,  7.70it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:16,  7.66it/s][A
Iteration:  52%|█████▏    | 140/268 [00:23<00:17,  7.51it/s][A
Iteration:  53%|█████▎    | 141/268 [00:23<00:17,  7.40it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:16,  7.36it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.38it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 16:01:26,792 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:01:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:01:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:01:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:01:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.39it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.55it/s]04/21/2024 16:01:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:01:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.12845843450656336, 'eval_loss': 1.5801755, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2767, 2751, 2743, 2736, 2706, 2695, 2647, 2673, 2789, 2896, 2970, 2986], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5673788, 'remaining_params': 79343812, 'pruned_model_sparsity': 0.06673662865100874, 'expected_sparsity': 0.06855, 'target_sparsity': 0.15065298507462688, 'step': 950}


Iteration:  54%|█████▍    | 146/268 [00:25<01:30,  1.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<01:07,  1.78it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:51,  2.33it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:40,  2.92it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:33,  3.54it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:27,  4.18it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:24,  4.81it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:21,  5.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:19,  5.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:17,  6.38it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:16,  6.69it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:16,  6.79it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  6.99it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.04it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.28it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.18it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.09it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.19it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.18it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.31it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.26it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.40it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.45it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.21it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.08it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:13,  7.11it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.24it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.35it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.32it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.43it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.48it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:11,  7.61it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:10,  7.55it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.66it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.59it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.77it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:09,  7.81it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:09,  7.75it/s][A
Iteration:  72%|███████▏  | 192/268 [00:32<00:10,  7.57it/s][A
Iteration:  72%|███████▏  | 193/268 [00:32<00:09,  7.56it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:10,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 16:01:35,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:01:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:01:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:01:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:01:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.37it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.11it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.18it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.22it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.52it/s]04/21/2024 16:01:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:01:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.12300105566407585, 'eval_loss': 1.442957, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2764, 2747, 2740, 2734, 2700, 2687, 2631, 2652, 2771, 2878, 2964, 2978], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5846904, 'remaining_params': 79170696, 'pruned_model_sparsity': 0.06877286585365854, 'expected_sparsity': 0.07059, 'target_sparsity': 0.15951492537313433, 'step': 1000}


Iteration:  73%|███████▎  | 196/268 [00:34<00:54,  1.33it/s][A04/21/2024 16:01:37 - INFO - trainer.trainer_mod - v4 Global step: 1000, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:34<00:39,  1.78it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:30,  2.29it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:23,  2.90it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:19,  3.55it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:16,  4.18it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:13,  4.73it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:12,  5.39it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:10,  5.89it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:10,  6.28it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:09,  6.50it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:09,  6.58it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  6.76it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.75it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  6.83it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:08,  7.00it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.00it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.16it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.26it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.31it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.39it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.40it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.20it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.32it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.25it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.33it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.35it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.41it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.33it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.27it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.57it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.57it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  6.93it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:05,  7.08it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.23it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.32it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.40it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.46it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.40it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.46it/s][A
Iteration:  90%|█████████ | 242/268 [00:40<00:03,  7.32it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.36it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.41it/s][A
Iteration:  91%|█████████▏| 245/268 [00:41<00:03,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 16:01:44,451 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:01:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:01:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:01:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:01:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.36it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.35it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.57it/s]04/21/2024 16:01:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:01:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.1225138970340786, 'eval_loss': 1.3606088, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2759, 2742, 2737, 2730, 2694, 2680, 2620, 2643, 2749, 2854, 2952, 2963], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6035340, 'remaining_params': 78982260, 'pruned_model_sparsity': 0.07098930103884372, 'expected_sparsity': 0.073, 'target_sparsity': 0.16837686567164178, 'step': 1050}


Iteration:  92%|█████████▏| 246/268 [00:43<00:16,  1.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:11,  1.78it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:08,  2.30it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:06,  2.90it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:05,  3.56it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:04,  4.23it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:03,  4.82it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  5.33it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:02,  5.78it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:02,  6.23it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  6.26it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  6.60it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  6.71it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  6.96it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.12it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:01,  6.83it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  6.93it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.08it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.30it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.41it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.01it/s][A04/21/2024 16:01:49 - INFO - trainer.trainer_mod - Epoch 3 finished. Took 46.49 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.76it/s]
Epoch:   4%|▍         | 4/100 [03:02<1:14:08, 46.34s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.18it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.45it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.23it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.33it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.14it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.24it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.29it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.61it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:32,  7.78it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.45it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.43it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.35it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.29it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.38it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.44it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.46it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.47it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.49it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.35it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.38it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.45it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 16:01:53,235 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:01:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:01:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:01:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:01:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.39it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]04/21/2024 16:01:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:01:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.12043531346283944, 'eval_loss': 1.6219217, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2753, 2734, 2731, 2724, 2686, 2671, 2609, 2622, 2724, 2817, 2928, 2934], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6326420, 'remaining_params': 78691180, 'pruned_model_sparsity': 0.07441306270701596, 'expected_sparsity': 0.07657, 'target_sparsity': 0.17723880597014927, 'step': 1100}


Iteration:  10%|█         | 28/268 [00:05<02:58,  1.35it/s][A04/21/2024 16:01:55 - INFO - trainer.trainer_mod - v4 Global step: 1100, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:05<02:13,  1.79it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:42,  2.31it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:21,  2.92it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:05,  3.58it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:55,  4.24it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:47,  4.88it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:42,  5.46it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:38,  5.96it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:36,  6.34it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:35,  6.57it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:33,  6.83it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.01it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.14it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.26it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.23it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.48it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.59it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.58it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.54it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.41it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.49it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.50it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.52it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.63it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.58it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.42it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.56it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.58it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.37it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.33it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:28,  6.99it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.25it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.50it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.33it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.59it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.59it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.35it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 16:02:02,011 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:02:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:02:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:02:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:02:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.60it/s]04/21/2024 16:02:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:02:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.18811992048192397, 'eval_loss': 1.5342396, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2744, 2725, 2725, 2718, 2678, 2658, 2590, 2595, 2690, 2756, 2874, 2862], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6813596, 'remaining_params': 78204004, 'pruned_model_sparsity': 0.08014335855164108, 'expected_sparsity': 0.08329, 'target_sparsity': 0.18610074626865672, 'step': 1150}


Iteration:  29%|██▉       | 78/268 [00:14<02:23,  1.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:47,  1.76it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<01:21,  2.29it/s][A
Iteration:  30%|███       | 81/268 [00:14<01:04,  2.90it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:52,  3.53it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:43,  4.24it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:38,  4.83it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:33,  5.42it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:31,  5.86it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.26it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.59it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.82it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:25,  6.86it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  7.03it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.05it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.20it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.29it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.35it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.16it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.28it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.36it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.28it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.32it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.30it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.35it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.38it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.28it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.24it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.12it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.24it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.37it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.35it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.40it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:21,  7.18it/s][A
Iteration:  44%|████▍     | 118/268 [00:20<00:20,  7.26it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.17it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.44it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.50it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.50it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:20,  7.11it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 16:02:10,841 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:02:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:02:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:02:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:02:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.41it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.40it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.38it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.39it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.40it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.59it/s]04/21/2024 16:02:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:02:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.19409321068227886, 'eval_loss': 1.4989662, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2733, 2713, 2714, 2708, 2665, 2641, 2562, 2564, 2639, 2638, 2745, 2635], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7821652, 'remaining_params': 77195948, 'pruned_model_sparsity': 0.09200038580246914, 'expected_sparsity': 0.10461, 'target_sparsity': 0.19496268656716417, 'step': 1200}


Iteration:  48%|████▊     | 128/268 [00:23<01:44,  1.34it/s][A04/21/2024 16:02:12 - INFO - trainer.trainer_mod - v4 Global step: 1200, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:23<01:18,  1.78it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:59,  2.31it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:47,  2.90it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:38,  3.51it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:32,  4.17it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:27,  4.82it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:24,  5.32it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:22,  5.86it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:21,  6.19it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.52it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.77it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:18,  6.93it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.26it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.31it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.29it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.16it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.28it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.22it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.32it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.26it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.35it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.39it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.32it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.16it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.29it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.24it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.34it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.36it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.18it/s][A
Iteration:  60%|██████    | 162/268 [00:28<00:14,  7.39it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.43it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.21it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.31it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.39it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.28it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.26it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.36it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.40it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.38it/s][A
Iteration:  66%|██████▌   | 177/268 [00:30<00:12,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:02:19,680 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:02:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:02:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:02:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:02:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 16:02:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:02:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.18600989454236824, 'eval_loss': 1.4077088, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2721, 2700, 2704, 2697, 2651, 2622, 2531, 2523, 2571, 2445, 2513, 2264], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 12845080, 'remaining_params': 72172520, 'pruned_model_sparsity': 0.15108730427582054, 'expected_sparsity': 0.14244, 'target_sparsity': 0.20382462686567165, 'step': 1250}


Iteration:  66%|██████▋   | 178/268 [00:32<01:06,  1.34it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:50,  1.78it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:38,  2.31it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:29,  2.91it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:24,  3.54it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:20,  4.21it/s][A
Iteration:  69%|██████▊   | 184/268 [00:33<00:17,  4.91it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:15,  5.41it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:14,  5.83it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:12,  6.25it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:12,  6.58it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  6.74it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.96it/s][A
Iteration:  71%|███████▏  | 191/268 [00:34<00:10,  7.03it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.36it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.38it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.41it/s][A
Iteration:  74%|███████▍  | 199/268 [00:35<00:09,  7.30it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.37it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.39it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.43it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:08,  7.35it/s][A
Iteration:  77%|███████▋  | 207/268 [00:36<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.43it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.24it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.31it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.28it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:07,  7.37it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.44it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.46it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.29it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.17it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.26it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.10it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.04it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.30it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.25it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:02:28,493 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:02:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:02:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:02:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:02:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.64it/s]04/21/2024 16:02:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:02:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.21624904403648446, 'eval_loss': 1.3913579, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2711, 2690, 2696, 2689, 2640, 2612, 2512, 2499, 2511, 2222, 2252, 2053], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 13831688, 'remaining_params': 71185912, 'pruned_model_sparsity': 0.16269205435109907, 'expected_sparsity': 0.16261, 'target_sparsity': 0.2126865671641791, 'step': 1300}


Iteration:  85%|████████▌ | 228/268 [00:41<00:29,  1.35it/s][A04/21/2024 16:02:30 - INFO - trainer.trainer_mod - v4 Global step: 1300, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:41<00:21,  1.78it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:16,  2.31it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:12,  2.92it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:10,  3.57it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:08,  4.24it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:07,  4.78it/s][A
Iteration:  88%|████████▊ | 235/268 [00:42<00:06,  5.32it/s][A
Iteration:  88%|████████▊ | 236/268 [00:42<00:05,  5.83it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  6.24it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  6.49it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.87it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.95it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.13it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.27it/s][A
Iteration:  91%|█████████ | 243/268 [00:43<00:03,  7.21it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.29it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.10it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.14it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.25it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 250/268 [00:44<00:02,  7.39it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.48it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.38it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.28it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.42it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.32it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:01,  7.20it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.61it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.32it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.39it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.32it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.51it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.51it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.52it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.98it/s][A04/21/2024 16:02:35 - INFO - trainer.trainer_mod - Epoch 4 finished. Took 46.44 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.77it/s]
Epoch:   5%|▌         | 5/100 [03:49<1:13:26, 46.38s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.07it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.64it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.54it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.68it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.52it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 16:02:37,258 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:02:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:02:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:02:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:02:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.45it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.43it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.40it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.45it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.62it/s]04/21/2024 16:02:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:02:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2692311684125661, 'eval_loss': 1.2076745, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2700, 2679, 2688, 2680, 2630, 2599, 2493, 2472, 2447, 1992, 2021, 1938], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11], 'pruned_params': 14997540, 'remaining_params': 70020060, 'pruned_model_sparsity': 0.17640512082204154, 'expected_sparsity': 0.18686, 'target_sparsity': 0.22154850746268656, 'step': 1350}


Iteration:   4%|▎         | 10/268 [00:03<03:17,  1.31it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:26,  1.75it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:52,  2.28it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:28,  2.89it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:12,  3.51it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:00,  4.19it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:51,  4.90it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:45,  5.46it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:41,  6.03it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:39,  6.34it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.63it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  7.05it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:34,  7.08it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.08it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.03it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.16it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.09it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.21it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.29it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.35it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.37it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.32it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.30it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.36it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.44it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.41it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.49it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.32it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.58it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.67it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.61it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.60it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.69it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.78it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.32it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.40it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.59it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:02:45,997 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:02:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:02:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:02:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:02:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 16:02:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:02:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2607710380560822, 'eval_loss': 1.1538857, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2686, 2666, 2677, 2666, 2612, 2577, 2460, 2430, 2373, 1781, 1828, 1860], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 10], 'pruned_params': 18142736, 'remaining_params': 66874864, 'pruned_model_sparsity': 0.21339976663655524, 'expected_sparsity': 0.20961, 'target_sparsity': 0.23041044776119401, 'step': 1400}


Iteration:  22%|██▏       | 60/268 [00:12<02:34,  1.35it/s][A04/21/2024 16:02:48 - INFO - trainer.trainer_mod - v4 Global step: 1400, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:55,  1.79it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:29,  2.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:10,  2.92it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:57,  3.57it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:47,  4.23it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:41,  4.87it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:36,  5.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:33,  5.94it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.35it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:29,  6.64it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.91it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:27,  7.08it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:27,  7.18it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:27,  7.15it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.45it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.27it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.27it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.39it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.43it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.45it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:24,  7.48it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.52it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.51it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.49it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.34it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.43it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.45it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.48it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.53it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.61it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.57it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.54it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.56it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.68it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.65it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.65it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.60it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.61it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.35it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.59it/s][A[INFO|trainer.py:570] 2024-04-21 16:02:54,685 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:02:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:02:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:02:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:02:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 16:02:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:02:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.25932612048825193, 'eval_loss': 1.1407238, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2673, 2653, 2667, 2656, 2595, 2558, 2428, 2385, 2293, 1604, 1663, 1799], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 10], 'pruned_params': 19032828, 'remaining_params': 65984772, 'pruned_model_sparsity': 0.2238692694218609, 'expected_sparsity': 0.22251, 'target_sparsity': 0.23927238805970147, 'step': 1450}


Iteration:  41%|████      | 110/268 [00:20<01:56,  1.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<01:27,  1.79it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<01:07,  2.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:52,  2.93it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:43,  3.57it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:35,  4.25it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:31,  4.79it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:28,  5.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:25,  5.89it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:24,  6.18it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:23,  6.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  6.70it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.94it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.10it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  7.02it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.20it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.40it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.34it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.28it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.21it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.40it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.31it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.36it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.61it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.58it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.43it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.46it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.41it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.41it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.19it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.18it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.18it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.27it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.32it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.29it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.38it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.42it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.37it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:03:03,511 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:03:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:03:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:03:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:03:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 16:03:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:03:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.1664232041408147, 'eval_loss': 1.3755587, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2659, 2639, 2655, 2642, 2577, 2535, 2390, 2334, 2213, 1450, 1518, 1737], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 9], 'pruned_params': 19895344, 'remaining_params': 65122256, 'pruned_model_sparsity': 0.23401441583860283, 'expected_sparsity': 0.23369, 'target_sparsity': 0.24813432835820892, 'step': 1500}


Iteration:  60%|█████▉    | 160/268 [00:29<01:20,  1.35it/s][A04/21/2024 16:03:05 - INFO - trainer.trainer_mod - v4 Global step: 1500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:29<01:00,  1.77it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:46,  2.30it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:36,  2.87it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:29,  3.50it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:24,  4.17it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:21,  4.82it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:18,  5.39it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:16,  5.97it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:15,  6.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.65it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:14,  6.93it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.03it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.21it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.43it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.47it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.32it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.40it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:11,  7.57it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.36it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.70it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.45it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.23it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.24it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.31it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.38it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.40it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.48it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.59it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.47it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.42it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.27it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.51it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.40it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.59it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 16:03:12,265 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:03:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:03:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:03:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:03:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.49it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 16:03:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:03:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.28154538744803764, 'eval_loss': 1.1820961, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2646, 2625, 2645, 2632, 2565, 2520, 2362, 2301, 2141, 1330, 1396, 1674], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 9], 'pruned_params': 20583212, 'remaining_params': 64434388, 'pruned_model_sparsity': 0.24210530525444143, 'expected_sparsity': 0.24267, 'target_sparsity': 0.2569962686567164, 'step': 1550}


Iteration:  78%|███████▊  | 210/268 [00:38<00:43,  1.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:31,  1.78it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:24,  2.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:19,  2.84it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:15,  3.49it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:12,  4.16it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:10,  4.80it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:09,  5.32it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:08,  5.84it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.24it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.55it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:07,  6.71it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  6.93it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  6.95it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  7.12it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.26it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.35it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.37it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.45it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.10it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.20it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.21it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.29it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.48it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.29it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.31it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.36it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.45it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.36it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.40it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.20it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.29it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.55it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.43it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.37it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.28it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.32it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.45it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:03:21,095 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:03:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:03:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:03:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:03:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 16:03:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:03:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.23267650715203794, 'eval_loss': 1.3069824, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2634, 2611, 2636, 2621, 2549, 2503, 2334, 2263, 2068, 1224, 1287, 1611], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 9], 'pruned_params': 21442664, 'remaining_params': 63574936, 'pruned_model_sparsity': 0.2522144120746763, 'expected_sparsity': 0.25145, 'target_sparsity': 0.26585820895522383, 'step': 1600}


Iteration:  97%|█████████▋| 260/268 [00:47<00:05,  1.34it/s][A04/21/2024 16:03:23 - INFO - trainer.trainer_mod - v4 Global step: 1600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:47<00:03,  1.78it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:02,  2.31it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:01,  2.85it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:01,  3.48it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  4.12it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  4.72it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  5.31it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  6.11it/s][A04/21/2024 16:03:24 - INFO - trainer.trainer_mod - Epoch 5 finished. Took 48.29 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.55it/s]
Epoch:   6%|▌         | 6/100 [04:37<1:13:40, 47.03s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.77it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.41it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.44it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.61it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.61it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.60it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.58it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.35it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.41it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.45it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.49it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.49it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.46it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.33it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.41it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.43it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.46it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.47it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.48it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.34it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.40it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.18it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.21it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.36it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.39it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.35it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.28it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.53it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:03:29,842 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:03:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:03:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:03:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:03:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.45it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.43it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.41it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.44it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.65it/s]04/21/2024 16:03:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:03:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.22025931533052875, 'eval_loss': 1.366585, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2620, 2597, 2626, 2607, 2532, 2483, 2307, 2214, 1989, 1135, 1197, 1545], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 9], 'pruned_params': 22090700, 'remaining_params': 62926900, 'pruned_model_sparsity': 0.2598367867359229, 'expected_sparsity': 0.25951, 'target_sparsity': 0.2747201492537313, 'step': 1650}


Iteration:  16%|█▌        | 42/268 [00:07<02:47,  1.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<02:05,  1.79it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:36,  2.32it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<01:15,  2.94it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:02,  3.57it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:51,  4.28it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:44,  4.92it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:39,  5.49it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:37,  5.89it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:34,  6.29it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:33,  6.48it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:31,  6.73it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.86it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  7.06it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.06it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.19it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.27it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.39it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.27it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.37it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.31it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.33it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.39it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.61it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.46it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.41it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:27,  7.16it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.41it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.47it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.32it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.46it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.32it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.29it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.26it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.51it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.55it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.53it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.50it/s][A
Iteration:  33%|███▎      | 89/268 [00:14<00:23,  7.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:03:38,614 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:03:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:03:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:03:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:03:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 16:03:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:03:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.22450942913056848, 'eval_loss': 1.1455134, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2607, 2584, 2615, 2597, 2518, 2466, 2280, 2180, 1926, 1060, 1119, 1479], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 9], 'pruned_params': 22634560, 'remaining_params': 62383040, 'pruned_model_sparsity': 0.2662338151159289, 'expected_sparsity': 0.26618, 'target_sparsity': 0.2835820895522388, 'step': 1700}


Iteration:  34%|███▍      | 92/268 [00:16<02:10,  1.35it/s][A04/21/2024 16:03:40 - INFO - trainer.trainer_mod - v4 Global step: 1700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:37,  1.79it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<01:15,  2.30it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:59,  2.91it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:48,  3.57it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:40,  4.21it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:35,  4.85it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:30,  5.45it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:28,  5.95it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:25,  6.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:24,  6.71it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:24,  6.86it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  6.94it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.10it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.32it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.38it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.46it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.51it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.60it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.30it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.37it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.56it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.57it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.57it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.43it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:19,  7.26it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.25it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.51it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.69it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.63it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:17,  7.61it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.42it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.45it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.40it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.38it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:03:47,323 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:03:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:03:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:03:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:03:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.46it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.67it/s]04/21/2024 16:03:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:03:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.23273428805155744, 'eval_loss': 1.2106467, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2593, 2568, 2604, 2586, 2503, 2448, 2251, 2148, 1859, 991, 1052, 1412], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 8], 'pruned_params': 23169228, 'remaining_params': 61848372, 'pruned_model_sparsity': 0.27252272470641375, 'expected_sparsity': 0.2727, 'target_sparsity': 0.29244402985074625, 'step': 1750}


Iteration:  53%|█████▎    | 142/268 [00:25<01:33,  1.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<01:10,  1.78it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:53,  2.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:42,  2.92it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:34,  3.58it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:29,  4.12it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:25,  4.76it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:21,  5.41it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:19,  5.90it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:19,  6.14it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:17,  6.60it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:17,  6.73it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:16,  6.96it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:16,  6.96it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.12it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.22it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.20it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.30it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.51it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.66it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.44it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.51it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.66it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.64it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.49it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.62it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.28it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.27it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.26it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.34it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:13,  6.99it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:12,  7.31it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.24it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.45it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.50it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.38it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.42it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.27it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 16:03:56,114 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:03:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:03:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:03:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:03:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 16:03:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:03:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.24176551775185876, 'eval_loss': 1.3378466, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2577, 2552, 2592, 2571, 2484, 2426, 2218, 2106, 1798, 932, 994, 1344], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 8], 'pruned_params': 23710024, 'remaining_params': 61307576, 'pruned_model_sparsity': 0.2788837134899127, 'expected_sparsity': 0.27936, 'target_sparsity': 0.30130597014925375, 'step': 1800}


Iteration:  72%|███████▏  | 192/268 [00:33<00:56,  1.35it/s][A04/21/2024 16:03:58 - INFO - trainer.trainer_mod - v4 Global step: 1800, Alignment: tensor([ 3,  7,  8, 10], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:34<00:42,  1.79it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:31,  2.32it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:25,  2.91it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:20,  3.57it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:17,  4.17it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:14,  4.72it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:12,  5.32it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:11,  5.76it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:10,  6.19it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  6.65it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  6.80it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.12it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.23it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.49it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.41it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.58it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.55it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:06,  7.70it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.63it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.60it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.54it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.19it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.25it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.25it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.35it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.38it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.53it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.65it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:03,  7.56it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.58it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:04:04,837 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:04:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:04:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:04:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:04:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.44it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 16:04:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:04:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.22793121349147036, 'eval_loss': 1.3050468, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2561, 2537, 2580, 2560, 2469, 2408, 2192, 2072, 1742, 881, 945, 1277], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 12, 8], 'pruned_params': 24174220, 'remaining_params': 60843380, 'pruned_model_sparsity': 0.28434371236073475, 'expected_sparsity': 0.28533, 'target_sparsity': 0.3101679104477612, 'step': 1850}


Iteration:  90%|█████████ | 242/268 [00:42<00:19,  1.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:13,  1.79it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:10,  2.32it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:07,  2.92it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:06,  3.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:04,  4.21it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:04,  4.80it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:03,  5.40it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:03,  5.92it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  6.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  6.63it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.89it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:02,  6.88it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.06it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.22it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.27it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.47it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:01,  6.93it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.21it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.25it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.21it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.30it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.17it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.79it/s][A04/21/2024 16:04:10 - INFO - trainer.trainer_mod - Epoch 6 finished. Took 46.16 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.81it/s]
Epoch:   7%|▋         | 7/100 [05:23<1:12:27, 46.74s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:37,  7.08it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.01it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.18it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.29it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.26it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.35it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.45it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.22it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.19it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.30it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.15it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.29it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.54it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.53it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.41it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:33,  7.33it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.26it/s][A[INFO|trainer.py:570] 2024-04-21 16:04:13,651 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:04:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:04:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:04:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:04:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 16:04:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:04:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3302630322948334, 'eval_loss': 1.071336, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2547, 2524, 2570, 2551, 2459, 2395, 2173, 2046, 1691, 835, 902, 1211], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 8], 'pruned_params': 24759444, 'remaining_params': 60258156, 'pruned_model_sparsity': 0.2912272752935863, 'expected_sparsity': 0.29071, 'target_sparsity': 0.31902985074626866, 'step': 1900}


Iteration:   9%|▉         | 24/268 [00:05<03:01,  1.35it/s][A04/21/2024 16:04:15 - INFO - trainer.trainer_mod - v4 Global step: 1900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:15,  1.79it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:44,  2.32it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:22,  2.93it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:07,  3.58it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:55,  4.31it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:48,  4.86it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:43,  5.42it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:39,  5.92it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:37,  6.32it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:35,  6.63it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:34,  6.79it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:33,  7.00it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:32,  7.17it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.28it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.27it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.32it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.12it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.25it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.33it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.42it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.60it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.59it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.51it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.42it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.45it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.37it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.54it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.66it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.62it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.66it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.64it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.52it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.55it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.54it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:04:22,338 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:04:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:04:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:04:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:04:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.47it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 16:04:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:04:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2919790524372276, 'eval_loss': 1.1208998, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2530, 2508, 2556, 2536, 2439, 2373, 2139, 2003, 1636, 793, 867, 1144], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 8], 'pruned_params': 25238960, 'remaining_params': 59778640, 'pruned_model_sparsity': 0.2968674721469437, 'expected_sparsity': 0.297, 'target_sparsity': 0.3278917910447761, 'step': 1950}


Iteration:  28%|██▊       | 74/268 [00:13<02:23,  1.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:47,  1.80it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<01:23,  2.30it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:06,  2.88it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:53,  3.57it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:44,  4.21it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:39,  4.81it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:34,  5.39it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:31,  5.88it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:29,  6.30it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.63it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  6.87it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.18it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.18it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.27it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.19it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.45it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.53it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.66it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.36it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.40it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.41it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.51it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.49it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.50it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.34it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.26it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  7.18it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.29it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.40it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.34it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.70it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:18,  7.87it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.75it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.70it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.86it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.80it/s][A[INFO|trainer.py:570] 2024-04-21 16:04:31,043 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:04:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:04:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:04:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:04:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 16:04:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:04:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2466630085613332, 'eval_loss': 1.3557304, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2514, 2491, 2545, 2523, 2423, 2355, 2112, 1970, 1586, 754, 835, 1077], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 8], 'pruned_params': 25655664, 'remaining_params': 59361936, 'pruned_model_sparsity': 0.30176885727190605, 'expected_sparsity': 0.30236, 'target_sparsity': 0.33675373134328357, 'step': 2000}


Iteration:  46%|████▋     | 124/268 [00:22<01:45,  1.36it/s][A04/21/2024 16:04:33 - INFO - trainer.trainer_mod - v4 Global step: 2000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:22<01:19,  1.80it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<01:00,  2.34it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:48,  2.92it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:39,  3.58it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:32,  4.25it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:28,  4.80it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:24,  5.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:23,  5.90it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:21,  6.32it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:20,  6.67it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:19,  6.74it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  6.99it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.13it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.18it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.26it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.17it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.29it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.28it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  7.10it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.22it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.13it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.23it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.45it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.48it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.36it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.41it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.30it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.34it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.28it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.48it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.53it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.67it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.54it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.38it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.40it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.04it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:15,  6.65it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  6.90it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  6.99it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:14,  7.14it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.24it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.35it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.57it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.46it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.40it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.44it/s][A[INFO|trainer.py:570] 2024-04-21 16:04:39,871 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:04:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:04:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:04:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:04:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 16:04:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:04:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.23087386314732647, 'eval_loss': 1.379194, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2496, 2476, 2533, 2509, 2407, 2338, 2082, 1930, 1534, 719, 808, 1011], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 7], 'pruned_params': 26078496, 'remaining_params': 58939104, 'pruned_model_sparsity': 0.30674232158988257, 'expected_sparsity': 0.30784, 'target_sparsity': 0.3456156716417911, 'step': 2050}


Iteration:  65%|██████▍   | 174/268 [00:31<01:09,  1.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:52,  1.78it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:40,  2.30it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:31,  2.91it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:25,  3.56it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:21,  4.20it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:18,  4.75it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:16,  5.41it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:14,  5.90it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:13,  6.33it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.66it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:12,  6.88it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.04it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.19it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.18it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.07it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.13it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.07it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.22it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.46it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.51it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.31it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.39it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.31it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.58it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.52it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.57it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.40it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.46it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.50it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.36it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.63it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.48it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.50it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.54it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.51it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.39it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.44it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.29it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 16:04:48,656 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:04:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:04:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:04:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:04:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 16:04:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:04:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.30099390227187867, 'eval_loss': 1.2824005, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2481, 2461, 2522, 2497, 2393, 2323, 2061, 1909, 1494, 687, 784, 945], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 12, 7], 'pruned_params': 26415536, 'remaining_params': 58602064, 'pruned_model_sparsity': 0.3107066772056609, 'expected_sparsity': 0.31233, 'target_sparsity': 0.35447761194029853, 'step': 2100}


Iteration:  84%|████████▎ | 224/268 [00:40<00:32,  1.34it/s][A04/21/2024 16:04:50 - INFO - trainer.trainer_mod - v4 Global step: 2100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:40<00:24,  1.78it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:18,  2.30it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:14,  2.91it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:11,  3.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:09,  4.17it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:07,  4.77it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:06,  5.38it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:06,  5.88it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.18it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:05,  6.53it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  6.79it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.12it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.32it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.39it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.45it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.48it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.63it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.62it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.49it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.55it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.54it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.35it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.41it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.47it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.52it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.45it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.48it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.47it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.51it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.04it/s][A04/21/2024 16:04:56 - INFO - trainer.trainer_mod - Epoch 7 finished. Took 46.17 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.81it/s]
Epoch:   8%|▊         | 8/100 [06:09<1:11:23, 46.56s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 16:04:57,343 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:04:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:04:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:04:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:04:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.48it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.47it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.68it/s]04/21/2024 16:04:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:04:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3489786582473965, 'eval_loss': 0.8786529, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2464, 2443, 2508, 2483, 2378, 2305, 2031, 1880, 1449, 658, 762, 880], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 9, 12, 7], 'pruned_params': 26996164, 'remaining_params': 58021436, 'pruned_model_sparsity': 0.3175361807437519, 'expected_sparsity': 0.31764, 'target_sparsity': 0.363339552238806, 'step': 2150}


Iteration:   2%|▏         | 6/268 [00:02<03:35,  1.21it/s][A
Iteration:   3%|▎         | 7/268 [00:02<02:35,  1.68it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:56,  2.23it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:30,  2.86it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:14,  3.48it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:00,  4.21it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:53,  4.76it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:47,  5.43it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:42,  5.92it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:39,  6.42it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:37,  6.74it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:36,  6.89it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:35,  7.08it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:33,  7.35it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:33,  7.39it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:32,  7.60it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:32,  7.59it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.57it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.53it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.52it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.52it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.28it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.36it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.27it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.33it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.17it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.31it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.31it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.26it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.24it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.29it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.39it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.36it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.51it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.57it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.58it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.17it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.29it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:05:06,103 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:05:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:05:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:05:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:05:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.42it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.70it/s]04/21/2024 16:05:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:05:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.30740979092553206, 'eval_loss': 1.2599733, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2445, 2424, 2493, 2467, 2360, 2285, 2000, 1847, 1404, 631, 741, 816], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 9, 12, 6], 'pruned_params': 27400612, 'remaining_params': 57616988, 'pruned_model_sparsity': 0.3222934074826859, 'expected_sparsity': 0.32353, 'target_sparsity': 0.37220149253731344, 'step': 2200}


Iteration:  21%|██        | 56/268 [00:11<02:37,  1.34it/s][A04/21/2024 16:05:08 - INFO - trainer.trainer_mod - v4 Global step: 2200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:11<01:58,  1.78it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<01:30,  2.31it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:11,  2.93it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:57,  3.59it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:48,  4.30it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:42,  4.88it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:38,  5.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:34,  5.83it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.20it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.57it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:29,  6.83it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:28,  7.02it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.16it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.65it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.29it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.40it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.34it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.30it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.39it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.42it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.47it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.35it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.28it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.47it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.23it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.37it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.53it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.39it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.32it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.38it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.55it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.22it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.23it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:05:14,858 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:05:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:05:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:05:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:05:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 16:05:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:05:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2800760703911504, 'eval_loss': 1.227171, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2423, 2404, 2478, 2451, 2340, 2264, 1970, 1812, 1364, 607, 722, 755], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 9, 12, 6], 'pruned_params': 27801996, 'remaining_params': 57215604, 'pruned_model_sparsity': 0.3270145946251129, 'expected_sparsity': 0.3294, 'target_sparsity': 0.3810634328358209, 'step': 2250}


Iteration:  40%|███▉      | 106/268 [00:20<01:59,  1.35it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:29,  1.79it/s][A
Iteration:  40%|████      | 108/268 [00:20<01:08,  2.33it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:54,  2.92it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:44,  3.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:38,  4.08it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:32,  4.73it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:29,  5.33it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:26,  5.78it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:24,  6.21it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:23,  6.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.80it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  7.03it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:20,  7.19it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:20,  7.28it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:19,  7.37it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.43it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.38it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.45it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.39it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.43it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.26it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.36it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.43it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.36it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.43it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.59it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  7.01it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.07it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.19it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.12it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.24it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.58it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:15,  7.59it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.56it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.58it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.41it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.45it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.33it/s][A[INFO|trainer.py:570] 2024-04-21 16:05:23,652 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:05:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:05:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:05:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:05:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 16:05:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:05:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.32072758607302876, 'eval_loss': 1.2944397, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2402, 2385, 2464, 2435, 2324, 2246, 1941, 1782, 1321, 585, 704, 696], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 8, 12, 6], 'pruned_params': 28374964, 'remaining_params': 56642636, 'pruned_model_sparsity': 0.33375399917193616, 'expected_sparsity': 0.33498, 'target_sparsity': 0.38992537313432835, 'step': 2300}


Iteration:  58%|█████▊    | 156/268 [00:29<01:22,  1.35it/s][A04/21/2024 16:05:25 - INFO - trainer.trainer_mod - v4 Global step: 2300, Alignment: tensor([2, 3, 5, 6], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:29<01:02,  1.79it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:47,  2.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:37,  2.91it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:30,  3.57it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:25,  4.24it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:21,  4.88it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:19,  5.39it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:17,  5.90it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:16,  6.23it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:15,  6.49it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:15,  6.69it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.80it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  7.02it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.17it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.09it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.12it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:13,  7.14it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.15it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  7.08it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.22it/s][A
Iteration:  66%|██████▌   | 177/268 [00:32<00:12,  7.28it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:11,  7.40it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.45it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.43it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.48it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.52it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.48it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.33it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.43it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.37it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.49it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:09,  7.10it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.20it/s][A[INFO|trainer.py:570] 2024-04-21 16:05:32,460 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:05:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:05:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:05:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:05:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.71it/s]04/21/2024 16:05:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:05:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.349925899769909, 'eval_loss': 1.1734866, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2380, 2365, 2449, 2419, 2305, 2228, 1911, 1749, 1285, 566, 687, 641], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 12, 5], 'pruned_params': 28946400, 'remaining_params': 56071200, 'pruned_model_sparsity': 0.34047538392050586, 'expected_sparsity': 0.34077, 'target_sparsity': 0.3987873134328358, 'step': 2350}


Iteration:  77%|███████▋  | 206/268 [00:37<00:46,  1.34it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:34,  1.77it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:26,  2.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:20,  2.91it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:16,  3.53it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:13,  4.22it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:11,  4.85it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:10,  5.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:09,  5.93it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:08,  6.27it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  6.62it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  6.75it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.94it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.39it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.29it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.26it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.34it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.39it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.44it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.49it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.52it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.45it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.47it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.38it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.44it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.43it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.60it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.58it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.71it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.87it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.66it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.64it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.56it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.30it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.42it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.45it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.49it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:05:41,170 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:05:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:05:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:05:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:05:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.51it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.49it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.69it/s]04/21/2024 16:05:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:05:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3432977682252613, 'eval_loss': 1.1313807, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2357, 2346, 2434, 2402, 2286, 2207, 1881, 1715, 1248, 548, 671, 590], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 12, 5], 'pruned_params': 29327868, 'remaining_params': 55689732, 'pruned_model_sparsity': 0.34496231368563685, 'expected_sparsity': 0.34596, 'target_sparsity': 0.4076492537313433, 'step': 2400}


Iteration:  96%|█████████▌| 256/268 [00:46<00:08,  1.35it/s][A04/21/2024 16:05:43 - INFO - trainer.trainer_mod - v4 Global step: 2400, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:46<00:06,  1.78it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:04,  2.31it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:03,  2.91it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:02,  3.56it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  4.23it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:01,  4.82it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  5.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  6.08it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  6.38it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  6.59it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  6.75it/s][A04/21/2024 16:05:44 - INFO - trainer.trainer_mod - Epoch 8 finished. Took 48.24 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.56it/s]
Epoch:   9%|▉         | 9/100 [06:58<1:11:24, 47.09s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.96it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.45it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.72it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.54it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.30it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.36it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.37it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.38it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.31it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.17it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.07it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.58it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.49it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.43it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.59it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.49it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.31it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.52it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.51it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.66it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.60it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.49it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.52it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 16:05:49,876 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:05:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:05:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:05:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:05:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 16:05:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:05:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.312203074777117, 'eval_loss': 1.4120251, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2334, 2327, 2420, 2388, 2270, 2189, 1856, 1689, 1215, 530, 656, 543], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 12, 5], 'pruned_params': 29666440, 'remaining_params': 55351160, 'pruned_model_sparsity': 0.34894468909966875, 'expected_sparsity': 0.35035, 'target_sparsity': 0.41651119402985076, 'step': 2450}


Iteration:  14%|█▍        | 38/268 [00:07<02:50,  1.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:08,  1.79it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:38,  2.31it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:18,  2.90it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:03,  3.56it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:53,  4.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:45,  4.88it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:40,  5.45it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:37,  5.89it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:35,  6.28it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:33,  6.60it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.85it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.95it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.11it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.23it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.11it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.14it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.30it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.34it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.52it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.29it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.28it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.33it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.42it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.64it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:25,  7.72it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.56it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.29it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.19it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.10it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.24it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.19it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.31it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.52it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.43it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.32it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.23it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.33it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 16:05:58,647 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:05:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:05:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:05:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:05:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.76it/s]04/21/2024 16:06:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:06:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.31951574880896005, 'eval_loss': 1.1645732, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2307, 2305, 2402, 2370, 2249, 2166, 1824, 1654, 1181, 514, 641, 500], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 12, 5], 'pruned_params': 30066292, 'remaining_params': 54951308, 'pruned_model_sparsity': 0.3536478564438422, 'expected_sparsity': 0.35551, 'target_sparsity': 0.4253731343283582, 'step': 2500}


Iteration:  33%|███▎      | 88/268 [00:15<02:13,  1.35it/s][A04/21/2024 16:06:00 - INFO - trainer.trainer_mod - v4 Global step: 2500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:16<01:41,  1.77it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<01:17,  2.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:00,  2.91it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:49,  3.56it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:41,  4.18it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:36,  4.82it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:32,  5.40it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:28,  5.94it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:27,  6.27it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:26,  6.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.81it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.83it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:24,  6.86it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  6.96it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:23,  7.15it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:23,  7.12it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.14it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.15it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  7.09it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.13it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:22,  7.09it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.21it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.33it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.64it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.60it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.60it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.67it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.62it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.67it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.66it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.63it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.46it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.50it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.51it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.38it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:18,  7.41it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.43it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.37it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:18,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 16:06:07,437 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:06:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:06:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:06:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:06:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 16:06:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:06:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38593517571638164, 'eval_loss': 1.1874015, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2281, 2285, 2385, 2353, 2231, 2147, 1800, 1628, 1151, 499, 626, 462], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 12, 5], 'pruned_params': 30414056, 'remaining_params': 54603544, 'pruned_model_sparsity': 0.35773835064739534, 'expected_sparsity': 0.36012, 'target_sparsity': 0.43423507462686567, 'step': 2550}


Iteration:  51%|█████▏    | 138/268 [00:24<01:36,  1.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<01:12,  1.79it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:55,  2.32it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:43,  2.92it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:35,  3.54it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:29,  4.22it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:25,  4.86it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:22,  5.45it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:21,  5.79it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:19,  6.14it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:18,  6.34it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:17,  6.67it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:17,  6.81it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.01it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.27it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.35it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.23it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.29it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.22it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.32it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.24it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.16it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  7.11it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.23it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.36it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.39it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.47it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.64it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.60it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.46it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:13,  7.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.49it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.46it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.52it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.48it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.48it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:11,  7.50it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.50it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.54it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.52it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.68it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.54it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.37it/s][A
Iteration:  69%|██████▉   | 185/268 [00:31<00:11,  7.42it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:06:16,196 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:06:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:06:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:06:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:06:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 16:06:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:06:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42441007309982554, 'eval_loss': 0.9089843, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2254, 2261, 2366, 2332, 2207, 2122, 1764, 1587, 1117, 484, 611, 427], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 8, 12, 5], 'pruned_params': 30844548, 'remaining_params': 54173052, 'pruned_model_sparsity': 0.3628019139566396, 'expected_sparsity': 0.36606, 'target_sparsity': 0.4430970149253731, 'step': 2600}


Iteration:  70%|███████   | 188/268 [00:33<00:59,  1.35it/s][A04/21/2024 16:06:18 - INFO - trainer.trainer_mod - v4 Global step: 2600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:33<00:44,  1.79it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:33,  2.32it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:26,  2.91it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:21,  3.57it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:17,  4.23it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:15,  4.86it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:13,  5.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:12,  5.92it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:11,  6.32it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:10,  6.74it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  6.97it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.24it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.32it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.37it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.31it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.28it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.41it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.45it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.49it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.08it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.22it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:08,  6.77it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  6.89it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.20it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.30it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.16it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.41it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.45it/s][A
Iteration:  83%|████████▎ | 222/268 [00:38<00:06,  7.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.44it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.50it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.38it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.42it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:05,  7.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  7.30it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.47it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.63it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:04,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:06:24,956 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:06:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:06:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:06:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:06:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.51it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 16:06:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:06:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3481767776563624, 'eval_loss': 1.1864039, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2228, 2236, 2346, 2312, 2183, 2097, 1727, 1547, 1084, 471, 596, 397], 'head_nums': [12, 12, 12, 12, 12, 11, 12, 12, 11, 8, 12, 5], 'pruned_params': 31466540, 'remaining_params': 53551060, 'pruned_model_sparsity': 0.370117952047576, 'expected_sparsity': 0.37241, 'target_sparsity': 0.4519589552238806, 'step': 2650}


Iteration:  89%|████████▉ | 238/268 [00:42<00:22,  1.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:16,  1.79it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:12,  2.33it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:09,  2.92it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:07,  3.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:06,  4.15it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:05,  4.80it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:04,  5.38it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  5.89it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  6.28it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:03,  6.59it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  6.67it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  6.72it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  6.83it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.02it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.18it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.41it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.43it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.30it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.19it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.28it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.43it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.49it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.08it/s][A04/21/2024 16:06:31 - INFO - trainer.trainer_mod - Epoch 9 finished. Took 46.25 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.80it/s]
Epoch:  10%|█         | 10/100 [07:44<1:10:14, 46.83s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.50it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.36it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.52it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.35it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.20it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.30it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.35it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.40it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.44it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.46it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.31it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.24it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.24it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.14it/s][A[INFO|trainer.py:570] 2024-04-21 16:06:33,746 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:06:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:06:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:06:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:06:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 16:06:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:06:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4273689356143931, 'eval_loss': 0.9964999, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2202, 2213, 2328, 2292, 2163, 2078, 1705, 1523, 1058, 459, 584, 370], 'head_nums': [12, 12, 12, 12, 12, 11, 12, 12, 11, 8, 11, 5], 'pruned_params': 32002740, 'remaining_params': 53014860, 'pruned_model_sparsity': 0.37642488143631436, 'expected_sparsity': 0.37847, 'target_sparsity': 0.46082089552238803, 'step': 2700}


Iteration:   7%|▋         | 20/268 [00:04<03:04,  1.34it/s][A04/21/2024 16:06:35 - INFO - trainer.trainer_mod - v4 Global step: 2700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:18,  1.78it/s][A
Iteration:   8%|▊         | 22/268 [00:05<01:47,  2.30it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:24,  2.90it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:09,  3.52it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:58,  4.17it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:50,  4.81it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:45,  5.33it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:40,  5.86it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:38,  6.22it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:36,  6.55it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.73it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  6.96it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.12it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.15it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.29it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.27it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.49it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.66it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.28it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.50it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.52it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.54it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.54it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.42it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.70it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.41it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.33it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.27it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.35it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.52it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.73it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.43it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.44it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.38it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.32it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.39it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.45it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 16:06:42,503 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:06:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:06:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:06:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:06:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 16:06:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:06:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34763727465101074, 'eval_loss': 1.2695214, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2174, 2189, 2310, 2273, 2143, 2055, 1675, 1490, 1029, 447, 572, 346], 'head_nums': [12, 12, 12, 12, 12, 11, 12, 12, 10, 8, 10, 4], 'pruned_params': 32774868, 'remaining_params': 52242732, 'pruned_model_sparsity': 0.38550685975609755, 'expected_sparsity': 0.38566, 'target_sparsity': 0.46968283582089554, 'step': 2750}


Iteration:  26%|██▌       | 70/268 [00:13<02:26,  1.35it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:50,  1.79it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<01:24,  2.32it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<01:07,  2.91it/s][A
Iteration:  28%|██▊       | 74/268 [00:14<00:54,  3.55it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:45,  4.25it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:38,  4.95it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:34,  5.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:31,  6.00it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.26it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.57it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.85it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:26,  6.92it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.02it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  7.05it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.28it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.33it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.43it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.35it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.39it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.30it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.20it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.33it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:22,  7.50it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.65it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.37it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.54it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.56it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.55it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:22,  7.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.28it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.44it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.50it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.65it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.62it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.58it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.68it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:19,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:06:51,232 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:06:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:06:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:06:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:06:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 16:06:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:06:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39961633260164087, 'eval_loss': 1.1567286, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2145, 2165, 2290, 2253, 2120, 2033, 1646, 1460, 1001, 434, 559, 324], 'head_nums': [12, 12, 12, 12, 12, 11, 12, 12, 10, 8, 10, 4], 'pruned_params': 33159400, 'remaining_params': 51858200, 'pruned_model_sparsity': 0.39002982911773565, 'expected_sparsity': 0.39202, 'target_sparsity': 0.47854477611940294, 'step': 2800}


Iteration:  45%|████▍     | 120/268 [00:22<01:49,  1.35it/s][A04/21/2024 16:06:53 - INFO - trainer.trainer_mod - v4 Global step: 2800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:22<01:22,  1.79it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<01:03,  2.31it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:49,  2.92it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:40,  3.58it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:33,  4.25it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:29,  4.89it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:25,  5.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:23,  5.88it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:22,  6.10it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:21,  6.41it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:20,  6.69it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  6.85it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  7.05it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:18,  7.21it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.20it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.18it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.18it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.09it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.23it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.44it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:17,  7.44it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.45it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.50it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.53it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.55it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:15,  7.57it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.57it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.54it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.28it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  7.19it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.30it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.34it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.45it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.48it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.63it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.59it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.70it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.65it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:13,  7.62it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.47it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.38it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.45it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.68it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:06:59,978 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:06:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:06:59 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:06:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:07:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.48it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.46it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.48it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 16:07:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:07:01 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40669717854737103, 'eval_loss': 1.0569885, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2118, 2141, 2271, 2235, 2100, 2013, 1623, 1436, 976, 423, 548, 305], 'head_nums': [12, 12, 12, 12, 12, 11, 12, 12, 10, 8, 10, 3], 'pruned_params': 33499504, 'remaining_params': 51518096, 'pruned_model_sparsity': 0.39403022433002105, 'expected_sparsity': 0.39709, 'target_sparsity': 0.48740671641791045, 'step': 2850}


Iteration:  63%|██████▎   | 170/268 [00:30<01:12,  1.35it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:54,  1.79it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:41,  2.31it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:32,  2.91it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:26,  3.55it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:21,  4.27it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:18,  4.91it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:16,  5.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:15,  5.79it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:14,  6.14it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:13,  6.33it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:13,  6.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.89it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.20it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.28it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.52it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.51it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.63it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.75it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.67it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.23it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.19it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.34it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.27it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.18it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.28it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.40it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.45it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.46it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.35it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.30it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.26it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.41it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.40it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.40it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.46it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.46it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.47it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  6.91it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:07,  6.97it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.12it/s][A[INFO|trainer.py:570] 2024-04-21 16:07:08,791 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:07:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:07:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:07:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:07:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.50it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 16:07:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:07:10 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3839746567664008, 'eval_loss': 0.8414672, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2088, 2116, 2249, 2213, 2075, 1989, 1588, 1402, 948, 412, 538, 288], 'head_nums': [12, 12, 12, 12, 12, 11, 12, 12, 10, 8, 10, 3], 'pruned_params': 33907016, 'remaining_params': 51110584, 'pruned_model_sparsity': 0.3988234906654622, 'expected_sparsity': 0.40384, 'target_sparsity': 0.49626865671641784, 'step': 2900}


Iteration:  82%|████████▏ | 220/268 [00:39<00:35,  1.34it/s][A04/21/2024 16:07:10 - INFO - trainer.trainer_mod - v4 Global step: 2900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:39<00:26,  1.78it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:19,  2.30it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:15,  2.87it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:12,  3.53it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:10,  4.20it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:08,  4.80it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:07,  5.34it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:06,  5.76it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:06,  6.19it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  6.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  6.72it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.01it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.18it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.41it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:04,  7.30it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.39it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.29it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.34it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.44it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.46it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.49it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.52it/s][A
Iteration:  94%|█████████▎| 251/268 [00:44<00:02,  7.11it/s][A
Iteration:  94%|█████████▍| 252/268 [00:44<00:02,  7.12it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.36it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.42it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.47it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.46it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.61it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  7.71it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.78it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.67it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.64it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.58it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.46it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  7.51it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.02it/s][A04/21/2024 16:07:17 - INFO - trainer.trainer_mod - Epoch 10 finished. Took 46.22 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.80it/s]
Epoch:  11%|█         | 11/100 [08:30<1:09:11, 46.64s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.83it/s][A[INFO|trainer.py:570] 2024-04-21 16:07:17,523 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:07:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:07:17 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:07:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:07:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.52it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.52it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 16:07:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:07:19 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3706730963742607, 'eval_loss': 0.98028725, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2059, 2091, 2230, 2194, 2053, 1968, 1562, 1374, 923, 401, 529, 274], 'head_nums': [12, 11, 12, 12, 12, 11, 12, 12, 10, 8, 9, 3], 'pruned_params': 34657696, 'remaining_params': 50359904, 'pruned_model_sparsity': 0.4076531918096959, 'expected_sparsity': 0.41015, 'target_sparsity': 0.5051305970149254, 'step': 2950}


Iteration:   1%|          | 2/268 [00:02<05:54,  1.33s/it][A
Iteration:   1%|          | 3/268 [00:02<03:26,  1.28it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:18,  1.91it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:40,  2.61it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:18,  3.33it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:03,  4.08it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:53,  4.84it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:48,  5.39it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:43,  5.92it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:40,  6.36it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:38,  6.71it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:36,  6.93it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:35,  7.08it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:34,  7.24it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:34,  7.23it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:34,  7.32it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:33,  7.40it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:33,  7.33it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:32,  7.55it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.33it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.38it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.45it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.48it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.46it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.39it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.31it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.60it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.58it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.60it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:30,  7.71it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:30,  7.66it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.42it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.43it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.07it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:32,  7.12it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.24it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.13it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:31,  7.02it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.15it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.31it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.40it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:07:26,271 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:07:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:07:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:07:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:07:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 16:07:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:07:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3885986826036068, 'eval_loss': 1.1688621, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2031, 2066, 2212, 2174, 2034, 1948, 1540, 1350, 902, 391, 519, 261], 'head_nums': [12, 11, 12, 12, 12, 11, 12, 12, 10, 7, 9, 3], 'pruned_params': 35186236, 'remaining_params': 49831364, 'pruned_model_sparsity': 0.4138700222071665, 'expected_sparsity': 0.41666, 'target_sparsity': 0.5139925373134328, 'step': 3000}


Iteration:  19%|█▉        | 52/268 [00:11<02:39,  1.35it/s][A04/21/2024 16:07:28 - INFO - trainer.trainer_mod - v4 Global step: 3000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:11<01:59,  1.79it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:31,  2.33it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:13,  2.91it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:00,  3.53it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:49,  4.24it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:42,  4.93it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:39,  5.35it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:34,  5.94it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:33,  6.25it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:31,  6.50it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:30,  6.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:29,  6.99it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:28,  7.14it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:27,  7.29it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<00:26,  7.47it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:26,  7.44it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:26,  7.46it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.28it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.33it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.47it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.36it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.19it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.39it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.44it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.29it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.35it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.31it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.36it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.17it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.23it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:24,  7.18it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.26it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.32it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.27it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.29it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.33it/s][A
Iteration:  36%|███▌      | 96/268 [00:17<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.24it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.31it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.81it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.01it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 16:07:35,118 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:07:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:07:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:07:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:07:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.73it/s]04/21/2024 16:07:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:07:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3711525687287876, 'eval_loss': 1.1304783, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2001, 2040, 2189, 2152, 2011, 1923, 1510, 1320, 879, 381, 510, 249], 'head_nums': [12, 10, 12, 12, 12, 11, 12, 12, 10, 7, 9, 3], 'pruned_params': 35766864, 'remaining_params': 49250736, 'pruned_model_sparsity': 0.42069952574525743, 'expected_sparsity': 0.42515, 'target_sparsity': 0.5228544776119403, 'step': 3050}


Iteration:  38%|███▊      | 102/268 [00:19<02:04,  1.33it/s][A
Iteration:  38%|███▊      | 103/268 [00:20<01:33,  1.76it/s][A
Iteration:  39%|███▉      | 104/268 [00:20<01:11,  2.28it/s][A
Iteration:  39%|███▉      | 105/268 [00:20<00:56,  2.88it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<00:45,  3.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:38,  4.21it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:32,  4.85it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:29,  5.38it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:26,  5.88it/s][A
Iteration:  41%|████▏     | 111/268 [00:21<00:25,  6.21it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:23,  6.66it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:22,  7.01it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:21,  7.13it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:20,  7.33it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:19,  7.59it/s][A
Iteration:  44%|████▍     | 118/268 [00:22<00:19,  7.57it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:19,  7.57it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:19,  7.54it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:19,  7.66it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:18,  7.78it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.61it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:18,  7.50it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.41it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.45it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.28it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.11it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.09it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.22it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:18,  7.31it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:17,  7.58it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.60it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.58it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.55it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.53it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.51it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.40it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.47it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.40it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.59it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:15,  7.66it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.63it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.59it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.59it/s][A[INFO|trainer.py:570] 2024-04-21 16:07:43,808 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:07:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:07:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:07:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:07:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 16:07:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:07:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3656138669929319, 'eval_loss': 1.0803983, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1973, 2017, 2169, 2131, 1988, 1900, 1482, 1291, 858, 370, 501, 238], 'head_nums': [12, 10, 12, 12, 11, 11, 12, 12, 10, 7, 8, 2], 'pruned_params': 36520608, 'remaining_params': 48496992, 'pruned_model_sparsity': 0.4295652664859982, 'expected_sparsity': 0.43488, 'target_sparsity': 0.5317164179104477, 'step': 3100}


Iteration:  57%|█████▋    | 152/268 [00:28<01:25,  1.36it/s][A04/21/2024 16:07:45 - INFO - trainer.trainer_mod - v4 Global step: 3100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:28<01:04,  1.79it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:49,  2.32it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:38,  2.92it/s][A
Iteration:  58%|█████▊    | 156/268 [00:29<00:31,  3.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:26,  4.23it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:22,  4.83it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:20,  5.36it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:18,  5.71it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:17,  6.14it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:16,  6.43it/s][A
Iteration:  61%|██████    | 163/268 [00:30<00:15,  6.75it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:15,  6.87it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:14,  6.97it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.17it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:13,  7.29it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.16it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:31<00:13,  7.24it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:13,  7.31it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.27it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.34it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.34it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.37it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.40it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.41it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 185/268 [00:33<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.36it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.40it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.44it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.44it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 192/268 [00:34<00:10,  7.10it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:10,  7.22it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.31it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.38it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.44it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.67it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.65it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.51it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.51it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:07:52,628 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:07:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:07:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:07:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:07:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.77it/s]04/21/2024 16:07:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:07:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3953611854992157, 'eval_loss': 1.0632066, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1944, 1993, 2148, 2110, 1964, 1878, 1454, 1264, 838, 361, 492, 229], 'head_nums': [12, 10, 11, 12, 11, 11, 12, 12, 10, 7, 7, 2], 'pruned_params': 37271288, 'remaining_params': 47746312, 'pruned_model_sparsity': 0.43839496763023184, 'expected_sparsity': 0.44283, 'target_sparsity': 0.5405783582089552, 'step': 3150}


Iteration:  75%|███████▌  | 202/268 [00:37<00:49,  1.34it/s][A
Iteration:  76%|███████▌  | 203/268 [00:37<00:36,  1.77it/s][A
Iteration:  76%|███████▌  | 204/268 [00:37<00:27,  2.30it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:21,  2.88it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:17,  3.56it/s][A
Iteration:  77%|███████▋  | 207/268 [00:38<00:14,  4.19it/s][A
Iteration:  78%|███████▊  | 208/268 [00:38<00:12,  4.79it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:10,  5.37it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:09,  5.87it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:09,  6.31it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.74it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.87it/s][A
Iteration:  80%|███████▉  | 214/268 [00:39<00:07,  7.07it/s][A
Iteration:  80%|████████  | 215/268 [00:39<00:07,  7.22it/s][A
Iteration:  81%|████████  | 216/268 [00:39<00:07,  7.29it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:06,  7.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.32it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 222/268 [00:40<00:06,  7.47it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:06,  7.39it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:05,  7.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.31it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.36it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:41<00:05,  7.53it/s][A
Iteration:  86%|████████▌ | 230/268 [00:41<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.40it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.47it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.53it/s][A
Iteration:  88%|████████▊ | 237/268 [00:42<00:04,  7.53it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:03,  7.51it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.62it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.54it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.46it/s][A
Iteration:  91%|█████████ | 244/268 [00:43<00:03,  7.61it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:02,  7.71it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.65it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 16:08:01,327 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:08:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:08:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:08:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:08:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.56it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 16:08:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:08:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4221874010611623, 'eval_loss': 0.91046774, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1916, 1971, 2129, 2088, 1942, 1856, 1428, 1239, 818, 353, 484, 219], 'head_nums': [12, 9, 11, 12, 11, 11, 12, 12, 10, 6, 7, 2], 'pruned_params': 38003584, 'remaining_params': 47014016, 'pruned_model_sparsity': 0.44700843119542305, 'expected_sparsity': 0.44966, 'target_sparsity': 0.5494402985074626, 'step': 3200}


Iteration:  94%|█████████▍| 252/268 [00:46<00:11,  1.35it/s][A04/21/2024 16:08:03 - INFO - trainer.trainer_mod - v4 Global step: 3200, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:46<00:08,  1.79it/s][A
Iteration:  95%|█████████▍| 254/268 [00:46<00:06,  2.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:04,  2.92it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:03,  3.60it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:02,  4.27it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:02,  4.86it/s][A
Iteration:  97%|█████████▋| 259/268 [00:47<00:01,  5.43it/s][A
Iteration:  97%|█████████▋| 260/268 [00:47<00:01,  5.79it/s][A
Iteration:  97%|█████████▋| 261/268 [00:47<00:01,  6.16it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:00,  6.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  6.74it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  6.86it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.07it/s][A
Iteration:  99%|█████████▉| 266/268 [00:48<00:00,  7.12it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  7.11it/s][A
Iteration: 100%|██████████| 268/268 [00:48<00:00,  7.69it/s][A04/21/2024 16:08:05 - INFO - trainer.trainer_mod - Epoch 11 finished. Took 48.25 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.55it/s]
Epoch:  12%|█▏        | 12/100 [09:18<1:09:07, 47.13s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.56it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.42it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.45it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.46it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.61it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.62it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.37it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.52it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.65it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.63it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.62it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.71it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.44it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.33it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.28it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:34,  7.15it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.17it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.28it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.34it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.43it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.36it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.45it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.37it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:08:10,068 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:08:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:08:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:08:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:08:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.75it/s]04/21/2024 16:08:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:08:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3407638503899785, 'eval_loss': 1.1704628, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1887, 1946, 2110, 2068, 1920, 1836, 1405, 1215, 800, 346, 477, 211], 'head_nums': [12, 9, 11, 11, 11, 11, 12, 12, 10, 6, 7, 2], 'pruned_params': 38527528, 'remaining_params': 46490072, 'pruned_model_sparsity': 0.4531712021981331, 'expected_sparsity': 0.45661, 'target_sparsity': 0.5583022388059701, 'step': 3250}


Iteration:  13%|█▎        | 34/268 [00:06<02:53,  1.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:09,  1.79it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:40,  2.31it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<01:19,  2.90it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:04,  3.54it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:53,  4.25it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:47,  4.83it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:42,  5.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:38,  5.90it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:36,  6.23it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:34,  6.42it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:33,  6.70it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.90it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.01it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.16it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.40it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.67it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.63it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.37it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.40it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.09it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.21it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.31it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.52it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.27it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.33it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.56it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.39it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.42it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.65it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.52it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.48it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.52it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.51it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.33it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.39it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.44it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 16:08:18,820 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:08:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:08:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:08:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:08:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.50it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 16:08:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:08:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41596647053127983, 'eval_loss': 1.0605195, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1859, 1923, 2091, 2050, 1900, 1817, 1384, 1193, 783, 339, 469, 203], 'head_nums': [12, 9, 11, 11, 11, 11, 12, 11, 10, 6, 7, 2], 'pruned_params': 39033088, 'remaining_params': 45984512, 'pruned_model_sparsity': 0.45911773562180064, 'expected_sparsity': 0.46437, 'target_sparsity': 0.5671641791044776, 'step': 3300}


Iteration:  31%|███▏      | 84/268 [00:15<02:16,  1.35it/s][A04/21/2024 16:08:20 - INFO - trainer.trainer_mod - v4 Global step: 3300, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:42,  1.79it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<01:19,  2.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:02,  2.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:51,  3.50it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:42,  4.18it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:36,  4.82it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:32,  5.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:30,  5.85it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:28,  6.17it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.61it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:25,  6.76it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:24,  6.99it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:24,  7.07it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.19it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.29it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.62it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.55it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.37it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.19it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.17it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.28it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.25it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.11it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.36it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.42it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.33it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.28it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.35it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.28it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.38it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:21,  7.04it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.32it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.19it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.19it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.19it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.39it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.43it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.49it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.48it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.48it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.46it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.28it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.17it/s][A
Iteration:  50%|████▉     | 133/268 [00:22<00:19,  6.96it/s][A[INFO|trainer.py:570] 2024-04-21 16:08:27,667 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:08:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:08:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:08:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:08:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.58it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.54it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.53it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.52it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.51it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.53it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.72it/s]04/21/2024 16:08:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:08:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4313115143560251, 'eval_loss': 1.0576243, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1831, 1901, 2073, 2030, 1880, 1798, 1364, 1171, 767, 333, 462, 196], 'head_nums': [12, 9, 10, 11, 11, 11, 11, 11, 10, 6, 6, 2], 'pruned_params': 39924712, 'remaining_params': 45092888, 'pruned_model_sparsity': 0.4696052582053598, 'expected_sparsity': 0.47315, 'target_sparsity': 0.5760261194029851, 'step': 3350}


Iteration:  50%|█████     | 134/268 [00:24<01:40,  1.34it/s][A
Iteration:  50%|█████     | 135/268 [00:24<01:14,  1.77it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:57,  2.30it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:45,  2.87it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:36,  3.53it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:30,  4.16it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:26,  4.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:24,  5.22it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:21,  5.78it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:20,  6.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:19,  6.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.67it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  6.91it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  7.08it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:16,  7.29it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.30it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:27<00:15,  7.49it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.49it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.44it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.48it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.49it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.52it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.41it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.45it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.37it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.48it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.55it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.55it/s][A
Iteration:  63%|██████▎   | 170/268 [00:29<00:12,  7.59it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.77it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.70it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.68it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.78it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.72it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.66it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.52it/s][A
Iteration:  66%|██████▋   | 178/268 [00:30<00:11,  7.53it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 16:08:36,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:08:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:08:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:08:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:08:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.46it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.50it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.53it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.54it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.55it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.74it/s]04/21/2024 16:08:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:08:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41319696759502633, 'eval_loss': 0.92669827, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1804, 1879, 2054, 2010, 1860, 1778, 1344, 1150, 752, 327, 454, 190], 'head_nums': [12, 9, 10, 11, 11, 11, 11, 11, 10, 6, 6, 2], 'pruned_params': 40228048, 'remaining_params': 44789552, 'pruned_model_sparsity': 0.4731731782595604, 'expected_sparsity': 0.4841, 'target_sparsity': 0.5848880597014925, 'step': 3400}


Iteration:  69%|██████▊   | 184/268 [00:32<01:02,  1.35it/s][A04/21/2024 16:08:38 - INFO - trainer.trainer_mod - v4 Global step: 3400, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:33<00:46,  1.79it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:35,  2.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:27,  2.95it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:22,  3.61it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:18,  4.32it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:15,  4.94it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:13,  5.51it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:12,  6.07it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:12,  6.25it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:11,  6.70it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.04it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.21it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.31it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.41it/s][A
Iteration:  75%|███████▍  | 200/268 [00:35<00:09,  7.47it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.49it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.49it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.49it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.50it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.67it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.41it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.46it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.61it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.59it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.56it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.71it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.47it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.51it/s][A
Iteration:  80%|████████  | 215/268 [00:37<00:07,  7.42it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.50it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.51it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.39it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.46it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.27it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:06,  7.34it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.43it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.73it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:04,  7.82it/s][A
Iteration:  86%|████████▌ | 230/268 [00:39<00:04,  7.70it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.62it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.60it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 16:08:45,033 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:08:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:08:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:08:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:08:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 16:08:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:08:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43714765085090473, 'eval_loss': 0.9512439, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1778, 1857, 2037, 1992, 1842, 1761, 1328, 1134, 737, 321, 446, 185], 'head_nums': [12, 9, 10, 10, 11, 11, 11, 11, 10, 6, 5, 2], 'pruned_params': 42659332, 'remaining_params': 42358268, 'pruned_model_sparsity': 0.5017705980879253, 'expected_sparsity': 0.49504, 'target_sparsity': 0.59375, 'step': 3450}


Iteration:  87%|████████▋ | 234/268 [00:41<00:25,  1.36it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:18,  1.80it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:13,  2.33it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:10,  2.95it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:08,  3.61it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:06,  4.29it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:05,  4.92it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:04,  5.56it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:04,  6.01it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  6.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.65it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.06it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.08it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.22it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.33it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.38it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.43it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.38it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.39it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.40it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.26it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.32it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.41it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.44it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.46it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.50it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.54it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.76it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.92it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.81it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.13it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  7.72it/s][A04/21/2024 16:08:51 - INFO - trainer.trainer_mod - Epoch 12 finished. Took 46.06 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.82it/s]
Epoch:  13%|█▎        | 13/100 [10:04<1:07:52, 46.81s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.66it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.58it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.63it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.62it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.58it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.30it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.30it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.26it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.34it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.30it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 16:08:53,714 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:08:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:08:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:08:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:08:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 16:08:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:08:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3523220668858657, 'eval_loss': 0.9621565, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1751, 1837, 2020, 1974, 1823, 1742, 1308, 1114, 722, 315, 439, 181], 'head_nums': [12, 9, 9, 10, 11, 11, 11, 11, 10, 6, 5, 2], 'pruned_params': 43143444, 'remaining_params': 41874156, 'pruned_model_sparsity': 0.5074648543360434, 'expected_sparsity': 0.50315, 'target_sparsity': 0.6026119402985075, 'step': 3500}


Iteration:   6%|▌         | 16/268 [00:04<03:06,  1.35it/s][A04/21/2024 16:08:55 - INFO - trainer.trainer_mod - v4 Global step: 3500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:20,  1.79it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:47,  2.32it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:25,  2.90it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:10,  3.50it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:00,  4.10it/s][A
Iteration:   8%|▊         | 22/268 [00:05<00:52,  4.71it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:46,  5.31it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:41,  5.83it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:38,  6.27it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:36,  6.62it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.71it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:35,  6.86it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:34,  7.00it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.14it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.29it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.34it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.42it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.43it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:30,  7.51it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.63it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.64it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.66it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.52it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.34it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.46it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.41it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.37it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.40it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.33it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  7.20it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.30it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.26it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.25it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.38it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.47it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.42it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.53it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:09:02,475 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:09:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:09:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:09:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:09:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 16:09:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:09:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44056700494332, 'eval_loss': 1.0233577, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1724, 1817, 2003, 1954, 1806, 1725, 1292, 1096, 709, 310, 434, 177], 'head_nums': [12, 9, 9, 10, 11, 11, 11, 11, 10, 6, 5, 2], 'pruned_params': 43411544, 'remaining_params': 41606056, 'pruned_model_sparsity': 0.5106183190304125, 'expected_sparsity': 0.5094, 'target_sparsity': 0.6114738805970149, 'step': 3550}


Iteration:  25%|██▍       | 66/268 [00:12<02:28,  1.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:13<01:51,  1.81it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<01:25,  2.34it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:07,  2.96it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:54,  3.63it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:45,  4.29it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:39,  4.92it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:35,  5.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:32,  5.98it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:30,  6.38it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.70it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:28,  6.72it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:27,  6.94it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.12it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.26it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.35it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:25,  7.40it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.45it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.46it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.38it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.34it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.15it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.74it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:25,  6.97it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.14it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.27it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.32it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.36it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.40it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.43it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.46it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.56it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.54it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.48it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.47it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.29it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.37it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.46it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.41it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.43it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:19<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.30it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 16:09:11,252 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:09:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:09:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:09:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:09:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.55it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 16:09:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:09:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4409642116689209, 'eval_loss': 0.91390145, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1699, 1799, 1986, 1937, 1788, 1706, 1274, 1079, 697, 305, 428, 174], 'head_nums': [12, 9, 9, 10, 11, 11, 11, 10, 10, 6, 5, 2], 'pruned_params': 43871144, 'remaining_params': 41146456, 'pruned_model_sparsity': 0.5160242585064739, 'expected_sparsity': 0.51503, 'target_sparsity': 0.6203358208955224, 'step': 3600}


Iteration:  43%|████▎     | 116/268 [00:21<01:52,  1.35it/s][A04/21/2024 16:09:13 - INFO - trainer.trainer_mod - v4 Global step: 3600, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:21<01:24,  1.79it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<01:04,  2.32it/s][A
Iteration:  44%|████▍     | 119/268 [00:22<00:50,  2.93it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:41,  3.59it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:34,  4.27it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:30,  4.84it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:27,  5.31it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:24,  5.81it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:23,  6.18it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:21,  6.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:21,  6.67it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:20,  6.94it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.24it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.38it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.57it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.53it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:17,  7.54it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.52it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.42it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.50it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.40it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:16,  7.56it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.17it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.28it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.36it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.30it/s][A
Iteration:  55%|█████▌    | 148/268 [00:26<00:15,  7.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:15,  7.51it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.73it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.67it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.45it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:16,  7.08it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.20it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.31it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.27it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.27it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.40it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.24it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.17it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.39it/s][A
Iteration:  61%|██████    | 163/268 [00:28<00:14,  7.37it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.55it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:09:20,009 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:09:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:09:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:09:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:09:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 16:09:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:09:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3764932335906515, 'eval_loss': 1.1438946, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1674, 1780, 1967, 1919, 1769, 1686, 1255, 1059, 684, 300, 424, 172], 'head_nums': [12, 9, 9, 10, 11, 11, 11, 10, 10, 6, 5, 2], 'pruned_params': 44148436, 'remaining_params': 40869164, 'pruned_model_sparsity': 0.5192858419903643, 'expected_sparsity': 0.52075, 'target_sparsity': 0.6291977611940298, 'step': 3650}


Iteration:  62%|██████▏   | 166/268 [00:30<01:15,  1.36it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:56,  1.80it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:42,  2.33it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:33,  2.94it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:27,  3.60it/s][A
Iteration:  64%|██████▍   | 171/268 [00:31<00:22,  4.34it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:19,  4.87it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:17,  5.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:15,  6.02it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:14,  6.40it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.72it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.95it/s][A
Iteration:  66%|██████▋   | 178/268 [00:32<00:12,  7.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:12,  7.26it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.52it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.21it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.42it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.60it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:10,  7.57it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.61it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.59it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.53it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.76it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.68it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.77it/s][A
Iteration:  72%|███████▏  | 193/268 [00:34<00:09,  7.67it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.55it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.54it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.36it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.21it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.31it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.33it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.39it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.31it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.59it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.60it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.48it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.50it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.58it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:09:28,666 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:09:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:09:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:09:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:09:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 16:09:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:09:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4357053256431942, 'eval_loss': 0.8696651, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1648, 1763, 1950, 1901, 1751, 1668, 1239, 1040, 673, 295, 421, 169], 'head_nums': [12, 9, 9, 9, 11, 11, 11, 10, 10, 6, 5, 2], 'pruned_params': 44601908, 'remaining_params': 40415692, 'pruned_model_sparsity': 0.5246197022734116, 'expected_sparsity': 0.52628, 'target_sparsity': 0.6380597014925373, 'step': 3700}


Iteration:  81%|████████  | 216/268 [00:39<00:38,  1.36it/s][A04/21/2024 16:09:30 - INFO - trainer.trainer_mod - v4 Global step: 3700, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:39<00:28,  1.79it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:21,  2.32it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:16,  2.94it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:13,  3.59it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:10,  4.33it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:09,  4.95it/s][A
Iteration:  83%|████████▎ | 223/268 [00:40<00:08,  5.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:07,  5.83it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  6.19it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:06,  6.55it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  6.93it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.10it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.22it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.32it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:05,  7.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.41it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.45it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.58it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:03,  7.72it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.51it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.30it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.37it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.36it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.16it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:03,  7.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.29it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.22it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.30it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.26it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  6.99it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.15it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.49it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.36it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.46it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.47it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.26it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:09:37,423 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:09:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:09:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:09:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:09:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.57it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 16:09:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:09:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4171684288273684, 'eval_loss': 1.0296421, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1624, 1743, 1932, 1884, 1733, 1648, 1221, 1023, 662, 291, 417, 167], 'head_nums': [12, 9, 8, 9, 11, 11, 11, 9, 9, 6, 5, 1], 'pruned_params': 45452168, 'remaining_params': 39565432, 'pruned_model_sparsity': 0.5346206903041253, 'expected_sparsity': 0.53148, 'target_sparsity': 0.6469216417910447, 'step': 3750}


Iteration:  99%|█████████▉| 266/268 [00:47<00:01,  1.36it/s][A
Iteration: 100%|█████████▉| 267/268 [00:48<00:00,  1.80it/s][A04/21/2024 16:09:39 - INFO - trainer.trainer_mod - Epoch 13 finished. Took 48.11 seconds.
Iteration: 100%|██████████| 268/268 [00:48<00:00,  5.57it/s]
Epoch:  14%|█▍        | 14/100 [10:52<1:07:39, 47.20s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.50it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.56it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.62it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.57it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.58it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.49it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.42it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.36it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.62it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.75it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.69it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:31,  7.78it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.75it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.92it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.81it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.65it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.54it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.56it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.47it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.48it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.41it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.49it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:32,  7.41it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.37it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.58it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.56it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.29it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.36it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:31,  7.32it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.34it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.66it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:29,  7.65it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:28,  7.73it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:28,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 16:09:46,050 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:09:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:09:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:09:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:09:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 16:09:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:09:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38721500375896933, 'eval_loss': 1.0609574, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1600, 1726, 1916, 1868, 1715, 1631, 1206, 1008, 652, 287, 412, 164], 'head_nums': [12, 9, 8, 9, 11, 11, 11, 9, 9, 6, 5, 1], 'pruned_params': 45692692, 'remaining_params': 39324908, 'pruned_model_sparsity': 0.5374497986299307, 'expected_sparsity': 0.53594, 'target_sparsity': 0.6557835820895522, 'step': 3800}


Iteration:  18%|█▊        | 48/268 [00:08<02:41,  1.36it/s][A04/21/2024 16:09:48 - INFO - trainer.trainer_mod - v4 Global step: 3800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<02:02,  1.79it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:33,  2.32it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:14,  2.93it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:59,  3.60it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:50,  4.27it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:43,  4.92it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:38,  5.59it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:35,  5.99it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:33,  6.30it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:32,  6.54it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:30,  6.81it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:29,  7.02it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.17it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.27it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.36it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.47it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.25it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.21it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.62it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.62it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.59it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:24,  7.79it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:24,  7.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:24,  7.78it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.72it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.63it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.51it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.51it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.32it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.38it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.33it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.32it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.38it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.58it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.38it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:24,  7.44it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.60it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.59it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:22,  7.67it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.76it/s][A
Iteration:  36%|███▌      | 97/268 [00:14<00:22,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:09:54,716 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:09:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:09:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:09:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:09:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.83it/s]04/21/2024 16:09:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:09:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3952671388345171, 'eval_loss': 0.9074413, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1575, 1710, 1899, 1851, 1698, 1615, 1192, 993, 643, 283, 406, 162], 'head_nums': [12, 9, 8, 9, 11, 11, 11, 9, 9, 6, 5, 1], 'pruned_params': 45931684, 'remaining_params': 39085916, 'pruned_model_sparsity': 0.5402608871574827, 'expected_sparsity': 0.54029, 'target_sparsity': 0.6646455223880596, 'step': 3850}


Iteration:  37%|███▋      | 98/268 [00:17<02:05,  1.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<01:33,  1.80it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:11,  2.34it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:56,  2.95it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:46,  3.61it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:38,  4.25it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:33,  4.90it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:29,  5.47it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:27,  5.84it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:25,  6.29it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.72it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  6.95it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.10it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.25it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.23it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.55it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.57it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.43it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.61it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.63it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.33it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.38it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.43it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:19,  7.21it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:19,  7.32it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.17it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.27it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.56it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.59it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.60it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.54it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.47it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.53it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.44it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.47it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.48it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:17,  7.34it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:16,  7.39it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.42it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.45it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:16,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 16:10:03,448 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:10:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:10:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:10:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:10:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 16:10:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:10:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41872963209625924, 'eval_loss': 0.9563017, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1551, 1694, 1882, 1834, 1681, 1599, 1177, 978, 633, 279, 399, 161], 'head_nums': [11, 9, 8, 9, 11, 11, 11, 9, 9, 6, 5, 1], 'pruned_params': 46369836, 'remaining_params': 38647764, 'pruned_model_sparsity': 0.5454145494579946, 'expected_sparsity': 0.54463, 'target_sparsity': 0.6735074626865671, 'step': 3900}


Iteration:  55%|█████▌    | 148/268 [00:25<01:29,  1.34it/s][A04/21/2024 16:10:05 - INFO - trainer.trainer_mod - v4 Global step: 3900, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:25<01:06,  1.79it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:50,  2.32it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:40,  2.89it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:32,  3.59it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:26,  4.31it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:23,  4.89it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:20,  5.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:19,  5.62it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:19,  5.69it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:17,  6.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:17,  6.36it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:16,  6.69it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  6.82it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:15,  7.02it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.13it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.23it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.31it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:14,  7.21it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.33it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.39it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.36it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.22it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.30it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.42it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.33it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.18it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.38it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.22it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.29it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:12,  7.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.52it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.31it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.58it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.56it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.58it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.54it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.57it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.57it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.56it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.46it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:32<00:10,  7.27it/s][A
Iteration:  73%|███████▎  | 195/268 [00:32<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 196/268 [00:32<00:09,  7.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:32<00:09,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:10:12,280 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:10:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:10:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:10:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:10:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.61it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.80it/s]04/21/2024 16:10:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:10:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38229409879901805, 'eval_loss': 0.9597702, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1527, 1678, 1865, 1818, 1664, 1582, 1162, 963, 624, 275, 392, 159], 'head_nums': [11, 9, 8, 9, 11, 11, 11, 9, 9, 6, 5, 1], 'pruned_params': 46610360, 'remaining_params': 38407240, 'pruned_model_sparsity': 0.5482436577838, 'expected_sparsity': 0.54983, 'target_sparsity': 0.6823694029850745, 'step': 3950}


Iteration:  74%|███████▍  | 198/268 [00:34<00:51,  1.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:38,  1.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:29,  2.32it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:22,  2.95it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:18,  3.61it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:15,  4.29it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:12,  4.93it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:11,  5.50it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:10,  6.01it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  6.67it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  6.94it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  6.92it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:08,  7.08it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.13it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.14it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.26it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.33it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.38it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.26it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:07,  7.11it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.23it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.74it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.56it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.37it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.55it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.75it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.66it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.66it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.49it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.51it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.52it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.37it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.27it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.30it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.41it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:04,  7.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.39it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.27it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:40<00:03,  7.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.53it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.54it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.55it/s][A
Iteration:  92%|█████████▏| 246/268 [00:41<00:02,  7.58it/s][A
Iteration:  92%|█████████▏| 247/268 [00:41<00:02,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 16:10:20,972 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:10:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:10:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:10:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:10:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 16:10:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:10:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42188590917347724, 'eval_loss': 0.87204283, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1505, 1662, 1849, 1800, 1647, 1565, 1147, 948, 615, 272, 386, 157], 'head_nums': [11, 9, 8, 9, 11, 11, 11, 9, 8, 6, 4, 1], 'pruned_params': 47238480, 'remaining_params': 37779120, 'pruned_model_sparsity': 0.5556317750677506, 'expected_sparsity': 0.55511, 'target_sparsity': 0.6912313432835822, 'step': 4000}


Iteration:  93%|█████████▎| 248/268 [00:43<00:14,  1.36it/s][A04/21/2024 16:10:23 - INFO - trainer.trainer_mod - v4 Global step: 4000, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:43<00:10,  1.80it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:07,  2.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:05,  2.93it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:04,  3.57it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:03,  4.25it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:02,  4.83it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:02,  5.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:02,  5.77it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  6.23it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  6.59it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.00it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.10it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.13it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.29it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.20it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.31it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.36it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  7.99it/s][A04/21/2024 16:10:25 - INFO - trainer.trainer_mod - Epoch 14 finished. Took 45.99 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.83it/s]
Epoch:  15%|█▌        | 15/100 [11:38<1:06:21, 46.84s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.10it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.38it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.43it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.57it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.71it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.45it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.37it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.37it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.40it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.27it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.25it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.14it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.46it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.51it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.40it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.36it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.30it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:34,  7.16it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.29it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.37it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.25it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.37it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.45it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.45it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:10:29,738 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:10:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:10:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:10:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:10:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.54it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 16:10:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:10:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3999158683209528, 'eval_loss': 0.9996304, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1481, 1644, 1832, 1784, 1629, 1547, 1133, 935, 607, 268, 379, 156], 'head_nums': [11, 9, 8, 8, 11, 11, 11, 9, 8, 6, 4, 1], 'pruned_params': 47675100, 'remaining_params': 37342500, 'pruned_model_sparsity': 0.560767417570009, 'expected_sparsity': 0.56003, 'target_sparsity': 0.7000932835820896, 'step': 4050}


Iteration:  11%|█         | 30/268 [00:06<02:56,  1.35it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:12,  1.79it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:41,  2.34it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:19,  2.97it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:04,  3.60it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:54,  4.28it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:47,  4.92it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:42,  5.43it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:38,  5.95it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.36it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.69it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.93it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.94it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:32,  6.95it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.24it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.19it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.30it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.36it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.64it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:28,  7.48it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.52it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.54it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.44it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.27it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  7.00it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.16it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.40it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.27it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.34it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.08it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.21it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.30it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.29it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.41it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.63it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.51it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.51it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.49it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:12<00:25,  7.54it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.22it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.40it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 16:10:38,502 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:10:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:10:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:10:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:10:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 16:10:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:10:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.457686920201459, 'eval_loss': 0.74058986, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1458, 1628, 1814, 1766, 1611, 1531, 1119, 922, 599, 265, 373, 155], 'head_nums': [10, 9, 8, 8, 11, 11, 11, 9, 8, 6, 4, 1], 'pruned_params': 48105592, 'remaining_params': 36912008, 'pruned_model_sparsity': 0.5658309808792532, 'expected_sparsity': 0.56513, 'target_sparsity': 0.7089552238805971, 'step': 4100}


Iteration:  30%|██▉       | 80/268 [00:14<02:18,  1.36it/s][A04/21/2024 16:10:40 - INFO - trainer.trainer_mod - v4 Global step: 4100, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:14<01:44,  1.79it/s][A
Iteration:  31%|███       | 82/268 [00:15<01:19,  2.33it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:03,  2.91it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:51,  3.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:43,  4.19it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:37,  4.82it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:33,  5.39it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:30,  5.90it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:28,  6.24it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:26,  6.61it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:25,  6.85it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  7.03it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.19it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.31it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.51it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.31it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.17it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.18it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.56it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<00:21,  7.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.53it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.52it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.55it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.54it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.72it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.69it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.69it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.34it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.29it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.38it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.48it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.56it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 126/268 [00:21<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.58it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.57it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:10:47,203 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:10:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:10:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:10:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:10:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.79it/s]04/21/2024 16:10:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:10:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4694741752845684, 'eval_loss': 0.9555166, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1435, 1613, 1797, 1751, 1596, 1516, 1107, 908, 592, 263, 368, 154], 'head_nums': [10, 9, 8, 8, 10, 11, 11, 9, 8, 6, 4, 1], 'pruned_params': 48516168, 'remaining_params': 36501432, 'pruned_model_sparsity': 0.5706602868112014, 'expected_sparsity': 0.57029, 'target_sparsity': 0.7178171641791045, 'step': 4150}


Iteration:  49%|████▊     | 130/268 [00:23<01:41,  1.36it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<01:15,  1.80it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:58,  2.33it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:45,  2.97it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:37,  3.62it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:30,  4.29it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:26,  4.93it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:24,  5.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:22,  5.75it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:21,  6.13it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.48it/s][A
Iteration:  53%|█████▎    | 141/268 [00:25<00:18,  6.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.01it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.18it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.13it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.38it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.57it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.68it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.63it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.42it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.60it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.49it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.50it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:14,  7.55it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.41it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.59it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.44it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.35it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.40it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.45it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.52it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.42it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.34it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.42it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:13,  7.42it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.52it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.57it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.49it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.63it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:11,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:10:55,894 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:10:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:10:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:10:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:10:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 16:10:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:10:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42013178301366794, 'eval_loss': 0.94434243, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1412, 1596, 1780, 1735, 1580, 1500, 1093, 895, 585, 260, 364, 153], 'head_nums': [10, 9, 8, 8, 10, 11, 11, 9, 8, 6, 4, 1], 'pruned_params': 48739840, 'remaining_params': 36277760, 'pruned_model_sparsity': 0.573291177356218, 'expected_sparsity': 0.57644, 'target_sparsity': 0.726679104477612, 'step': 4200}


Iteration:  67%|██████▋   | 180/268 [00:32<01:04,  1.36it/s][A04/21/2024 16:10:57 - INFO - trainer.trainer_mod - v4 Global step: 4200, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:32<00:48,  1.80it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:37,  2.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:28,  2.95it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:22,  3.65it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:19,  4.28it/s][A
Iteration:  69%|██████▉   | 186/268 [00:33<00:16,  4.91it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:14,  5.57it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:13,  5.97it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:12,  6.29it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:11,  6.63it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.90it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.15it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:10,  7.26it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  7.02it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.15it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.25it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.38it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:08,  7.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.32it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.39it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.33it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.22it/s][A
Iteration:  78%|███████▊  | 208/268 [00:36<00:08,  7.28it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.22it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.41it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.45it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.52it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.43it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.44it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:07,  6.95it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.11it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.25it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.51it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:05,  7.66it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.64it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.60it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.59it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.57it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:11:04,636 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:11:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:11:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:11:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:11:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 16:11:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:11:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4398787374309081, 'eval_loss': 0.9222473, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1390, 1580, 1763, 1719, 1565, 1485, 1082, 884, 578, 258, 361, 153], 'head_nums': [9, 9, 8, 8, 10, 11, 11, 9, 8, 6, 3, 1], 'pruned_params': 49338852, 'remaining_params': 35678748, 'pruned_model_sparsity': 0.5803369184733514, 'expected_sparsity': 0.58264, 'target_sparsity': 0.7355410447761194, 'step': 4250}


Iteration:  86%|████████▌ | 230/268 [00:40<00:28,  1.36it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:20,  1.79it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:15,  2.32it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:11,  2.93it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:09,  3.55it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:07,  4.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:06,  4.87it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:05,  5.40it/s][A
Iteration:  89%|████████▉ | 238/268 [00:42<00:05,  5.91it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  6.33it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:04,  6.45it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  6.85it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  6.87it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.07it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.11it/s][A
Iteration:  91%|█████████▏| 245/268 [00:43<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.36it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.42it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.47it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.48it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  7.49it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.29it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.32it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.55it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.51it/s][A
Iteration:  97%|█████████▋| 260/268 [00:45<00:01,  7.51it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.47it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.54it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.52it/s][A
Iteration: 100%|██████████| 268/268 [00:46<00:00,  8.06it/s][A04/21/2024 16:11:11 - INFO - trainer.trainer_mod - Epoch 15 finished. Took 46.06 seconds.
Iteration: 100%|██████████| 268/268 [00:46<00:00,  5.82it/s]
Epoch:  16%|█▌        | 16/100 [12:24<1:05:14, 46.60s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.17it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.03it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.52it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.67it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.64it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.62it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.32it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:36,  7.14it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 16:11:13,366 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:11:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:11:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:11:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:11:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 16:11:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:11:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4608257140340363, 'eval_loss': 0.7511122, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1367, 1565, 1746, 1703, 1549, 1469, 1070, 871, 570, 255, 358, 152], 'head_nums': [9, 9, 8, 7, 10, 11, 11, 9, 8, 6, 3, 1], 'pruned_params': 49752492, 'remaining_params': 35265108, 'pruned_model_sparsity': 0.5852022640018066, 'expected_sparsity': 0.58942, 'target_sparsity': 0.7444029850746269, 'step': 4300}


Iteration:   4%|▍         | 12/268 [00:03<03:12,  1.33it/s][A04/21/2024 16:11:15 - INFO - trainer.trainer_mod - v4 Global step: 4300, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:24,  1.77it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:49,  2.31it/s][A
Iteration:   6%|▌         | 15/268 [00:04<01:26,  2.91it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:09,  3.60it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:59,  4.25it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:51,  4.82it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:45,  5.49it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:41,  5.95it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:39,  6.29it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:36,  6.74it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:35,  6.82it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.93it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.12it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.14it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.02it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.21it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.16it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:33,  7.18it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.29it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.45it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.28it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:31,  7.35it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.25it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.49it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.54it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.63it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.81it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.75it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.83it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:27,  7.78it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:27,  7.72it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.83it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.72it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.69it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.77it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.74it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.68it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.59it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:11:22,042 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:11:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:11:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:11:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:11:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 16:11:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:11:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4253527156576474, 'eval_loss': 0.96514785, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1345, 1550, 1730, 1689, 1533, 1455, 1058, 859, 563, 252, 354, 152], 'head_nums': [9, 9, 8, 7, 9, 11, 10, 8, 7, 6, 3, 1], 'pruned_params': 50743696, 'remaining_params': 34273904, 'pruned_model_sparsity': 0.5968610734718458, 'expected_sparsity': 0.59529, 'target_sparsity': 0.7532649253731343, 'step': 4350}


Iteration:  23%|██▎       | 62/268 [00:12<02:31,  1.36it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:54,  1.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<01:27,  2.34it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<01:08,  2.95it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:55,  3.61it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:46,  4.28it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:40,  4.98it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:35,  5.55it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:32,  6.02it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.27it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.59it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:27,  6.97it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:27,  7.16it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:26,  7.16it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.26it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.53it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.54it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.55it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.54it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.76it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.66it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:23,  7.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.61it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.63it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.58it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:23,  7.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.55it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.42it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.30it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.29it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.39it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.48it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.51it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.28it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.37it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.57it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 16:11:30,698 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:11:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:11:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:11:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:11:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.56it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.82it/s]04/21/2024 16:11:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:11:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4544911849560193, 'eval_loss': 0.8772721, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1323, 1536, 1714, 1674, 1517, 1440, 1047, 848, 556, 251, 350, 151], 'head_nums': [9, 9, 8, 7, 9, 11, 10, 8, 7, 6, 2, 1], 'pruned_params': 51142016, 'remaining_params': 33875584, 'pruned_model_sparsity': 0.6015462210177658, 'expected_sparsity': 0.60038, 'target_sparsity': 0.7621268656716418, 'step': 4400}


Iteration:  42%|████▏     | 112/268 [00:20<01:54,  1.36it/s][A04/21/2024 16:11:32 - INFO - trainer.trainer_mod - v4 Global step: 4400, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:21<01:26,  1.80it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<01:06,  2.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:52,  2.94it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:42,  3.61it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:35,  4.21it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:30,  4.85it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:27,  5.43it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:25,  5.91it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:22,  6.42it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:22,  6.58it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  6.95it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.48it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.64it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.59it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.61it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.46it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.52it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.53it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.50it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.51it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.38it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.61it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  7.14it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  7.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.23it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.31it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.27it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  7.23it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  7.23it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.31it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.44it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.47it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.42it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.66it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.62it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.59it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.76it/s][A[INFO|trainer.py:570] 2024-04-21 16:11:39,383 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:11:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:11:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:11:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:11:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.62it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.63it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 16:11:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:11:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4384135017689582, 'eval_loss': 0.8652935, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1301, 1519, 1697, 1658, 1502, 1425, 1035, 836, 548, 248, 346, 151], 'head_nums': [9, 9, 8, 7, 9, 11, 10, 8, 7, 6, 2, 1], 'pruned_params': 51358028, 'remaining_params': 33659572, 'pruned_model_sparsity': 0.6040870125715146, 'expected_sparsity': 0.60617, 'target_sparsity': 0.7709888059701492, 'step': 4450}


Iteration:  60%|██████    | 162/268 [00:29<01:17,  1.36it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:58,  1.80it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:44,  2.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:35,  2.94it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:28,  3.60it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:23,  4.27it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:20,  4.87it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:18,  5.32it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:16,  5.85it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:15,  6.27it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:14,  6.62it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:14,  6.78it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  7.11it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  7.13it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.36it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:12,  7.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.26it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.26it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.30it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.66it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.61it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.74it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.70it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.36it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.37it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:10,  7.09it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:10,  7.12it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.39it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.46it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.52it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.50it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.37it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.55it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.52it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.67it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.45it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 16:11:48,102 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:11:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:11:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:11:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:11:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.65it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.84it/s]04/21/2024 16:11:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:11:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4302323404760539, 'eval_loss': 0.9227177, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1279, 1503, 1680, 1644, 1487, 1412, 1024, 825, 541, 245, 342, 151], 'head_nums': [9, 9, 8, 7, 9, 11, 10, 8, 7, 6, 2, 1], 'pruned_params': 51561784, 'remaining_params': 33455816, 'pruned_model_sparsity': 0.6064836457392352, 'expected_sparsity': 0.61226, 'target_sparsity': 0.7798507462686567, 'step': 4500}


Iteration:  79%|███████▉  | 212/268 [00:38<00:41,  1.36it/s][A04/21/2024 16:11:50 - INFO - trainer.trainer_mod - v4 Global step: 4500, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:38<00:30,  1.80it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:23,  2.34it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:18,  2.92it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:14,  3.58it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:12,  4.22it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:10,  4.77it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:09,  5.28it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:08,  5.79it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:07,  6.24it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:07,  6.43it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:07,  6.27it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:06,  6.77it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:06,  7.10it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.14it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.28it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.36it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.36it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.31it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.37it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.34it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.20it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.15it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.32it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.18it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.30it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.36it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.43it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.45it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.48it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.33it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.38it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.47it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.55it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.11it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.22it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.31it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.36it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.42it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.32it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.34it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.25it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:11:56,919 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:11:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:11:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:11:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:11:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.62it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.81it/s]04/21/2024 16:11:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:11:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4479109284700106, 'eval_loss': 0.9062817, 'head_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1257, 1487, 1663, 1629, 1472, 1398, 1014, 814, 534, 243, 340, 150], 'head_nums': [9, 9, 7, 7, 9, 11, 10, 8, 7, 6, 2, 1], 'pruned_params': 51958572, 'remaining_params': 33059028, 'pruned_model_sparsity': 0.6111507734869015, 'expected_sparsity': 0.6185, 'target_sparsity': 0.7887126865671641, 'step': 4550}


Iteration:  98%|█████████▊| 262/268 [00:47<00:04,  1.36it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:02,  1.80it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:01,  2.35it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:01,  2.93it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  3.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  4.26it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.11it/s][A04/21/2024 16:11:59 - INFO - trainer.trainer_mod - Epoch 16 finished. Took 47.97 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.59it/s]
Epoch:  17%|█▋        | 17/100 [13:12<1:05:02, 47.02s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.58it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.12it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.29it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.38it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.33it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.39it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.31it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.38it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.47it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.53it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.42it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.33it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.20it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.10it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.29it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.38it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.41it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.43it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.61it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.35it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.44it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.56it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.42it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.49it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:30,  7.71it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.38it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.59it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.57it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.55it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.59it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.56it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.55it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.59it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:29,  7.71it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:29,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:12:05,596 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:12:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:12:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:12:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:12:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.89it/s]04/21/2024 16:12:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:12:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40820787289779603, 'eval_loss': 0.98705995, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1236, 1472, 1648, 1614, 1458, 1384, 1004, 804, 528, 241, 337, 150], 'head_nums': [9, 9, 7, 6, 9, 11, 9, 8, 6, 6, 2, 1], 'pruned_params': 53914936, 'remaining_params': 31102664, 'pruned_model_sparsity': 0.6341620558566696, 'expected_sparsity': 0.62546, 'target_sparsity': 0.7975746268656716, 'step': 4600}


Iteration:  16%|█▋        | 44/268 [00:07<02:44,  1.36it/s][A04/21/2024 16:12:07 - INFO - trainer.trainer_mod - v4 Global step: 4600, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:08<02:03,  1.81it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:34,  2.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:15,  2.92it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:01,  3.55it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:51,  4.26it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:44,  4.92it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:39,  5.45it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:35,  6.04it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:33,  6.41it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.69it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:30,  6.94it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.13it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.15it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.52it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.37it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.26it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.36it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.38it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.34it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.31it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.21it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.30it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.36it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.30it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.42it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:27,  7.17it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.20it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.29it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.54it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.42it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.46it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.49it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.55it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:24,  7.52it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.54it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.50it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.56it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.53it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.56it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:14<00:23,  7.57it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.59it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.60it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 16:12:14,306 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:12:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:12:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:12:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:12:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.89it/s]04/21/2024 16:12:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:12:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43846185615604477, 'eval_loss': 0.8603237, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1214, 1456, 1631, 1600, 1445, 1371, 994, 794, 521, 239, 334, 150], 'head_nums': [9, 9, 7, 6, 9, 11, 9, 8, 6, 6, 2, 1], 'pruned_params': 54109500, 'remaining_params': 30908100, 'pruned_model_sparsity': 0.6364505702348691, 'expected_sparsity': 0.6315, 'target_sparsity': 0.806436567164179, 'step': 4650}


Iteration:  35%|███▌      | 94/268 [00:16<02:07,  1.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<01:35,  1.81it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<01:13,  2.35it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:57,  2.95it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:47,  3.62it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:39,  4.27it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:34,  4.86it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:30,  5.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:30,  5.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:27,  6.02it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:25,  6.34it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:24,  6.67it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  6.81it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.13it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.26it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  7.21it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.34it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.30it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:21,  7.27it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.35it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.40it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.49it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.30it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.40it/s][A
Iteration:  44%|████▍     | 119/268 [00:20<00:20,  7.42it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.34it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.42it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.46it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.38it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.62it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.63it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.59it/s][A
Iteration:  50%|█████     | 134/268 [00:22<00:17,  7.45it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.47it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.64it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.63it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.39it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.41it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:17,  7.18it/s][A
Iteration:  53%|█████▎    | 142/268 [00:23<00:17,  7.29it/s][A
Iteration:  53%|█████▎    | 143/268 [00:23<00:17,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 16:12:23,059 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:12:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:12:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:12:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:12:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:12:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:12:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4183935375368045, 'eval_loss': 0.85534775, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1194, 1443, 1616, 1584, 1430, 1357, 985, 784, 514, 237, 332, 149], 'head_nums': [9, 9, 7, 6, 9, 11, 9, 8, 6, 6, 2, 1], 'pruned_params': 54297936, 'remaining_params': 30719664, 'pruned_model_sparsity': 0.6386670054200542, 'expected_sparsity': 0.63638, 'target_sparsity': 0.8152985074626866, 'step': 4700}


Iteration:  54%|█████▎    | 144/268 [00:25<01:31,  1.36it/s][A04/21/2024 16:12:25 - INFO - trainer.trainer_mod - v4 Global step: 4700, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:25<01:08,  1.80it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:52,  2.31it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:41,  2.89it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:34,  3.46it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:28,  4.12it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:24,  4.77it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:21,  5.33it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:20,  5.71it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:18,  6.08it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:17,  6.45it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:16,  6.78it/s][A
Iteration:  58%|█████▊    | 156/268 [00:27<00:15,  7.00it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.18it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:15,  7.29it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.29it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.36it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.41it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.24it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.37it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:14,  7.41it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.47it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.36it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.55it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.33it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.40it/s][A
Iteration:  64%|██████▍   | 171/268 [00:29<00:12,  7.57it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:12,  7.57it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.59it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.69it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.45it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.29it/s][A
Iteration:  67%|██████▋   | 179/268 [00:30<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.62it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.59it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.50it/s][A
Iteration:  69%|██████▉   | 186/268 [00:31<00:10,  7.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.51it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.43it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.46it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.41it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.56it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:10,  7.33it/s][A[INFO|trainer.py:570] 2024-04-21 16:12:31,815 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:12:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:12:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:12:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:12:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:12:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:12:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44962496864677076, 'eval_loss': 0.86389613, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1173, 1427, 1600, 1571, 1417, 1344, 976, 775, 509, 234, 331, 149], 'head_nums': [9, 9, 7, 6, 9, 11, 9, 8, 6, 6, 2, 1], 'pruned_params': 54480244, 'remaining_params': 30537356, 'pruned_model_sparsity': 0.6408113614122253, 'expected_sparsity': 0.64079, 'target_sparsity': 0.824160447761194, 'step': 4750}


Iteration:  72%|███████▏  | 194/268 [00:34<00:54,  1.36it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:40,  1.80it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:31,  2.32it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:24,  2.92it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:19,  3.55it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:16,  4.22it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:13,  4.87it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:12,  5.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:11,  5.94it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:10,  6.42it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:09,  6.70it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:09,  6.83it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.06it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.20it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.28it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:08,  7.19it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.21it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.51it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.67it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.60it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.35it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:07,  7.34it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:07,  7.21it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.44it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.30it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.40it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.63it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.64it/s][A
Iteration:  83%|████████▎ | 223/268 [00:38<00:05,  7.50it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.53it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.55it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.54it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.22it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.28it/s][A
Iteration:  86%|████████▌ | 231/268 [00:39<00:05,  6.96it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:05,  7.11it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.43it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.38it/s][A
Iteration:  89%|████████▉ | 238/268 [00:40<00:04,  7.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:40<00:03,  7.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:40<00:03,  7.50it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:40<00:03,  7.53it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 16:12:40,547 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:12:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:12:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:12:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:12:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:12:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:12:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4383718876269999, 'eval_loss': 0.9073173, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1153, 1413, 1584, 1559, 1404, 1332, 967, 766, 503, 231, 329, 149], 'head_nums': [9, 9, 7, 6, 9, 11, 9, 7, 6, 6, 2, 1], 'pruned_params': 54854052, 'remaining_params': 30163548, 'pruned_model_sparsity': 0.6452081921860885, 'expected_sparsity': 0.64531, 'target_sparsity': 0.8330223880597015, 'step': 4800}


Iteration:  91%|█████████ | 244/268 [00:42<00:17,  1.35it/s][A04/21/2024 16:12:42 - INFO - trainer.trainer_mod - v4 Global step: 4800, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:42<00:12,  1.80it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:09,  2.34it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:07,  2.95it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:05,  3.61it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:04,  4.26it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:03,  4.95it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:03,  5.53it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  5.99it/s][A
Iteration:  94%|█████████▍| 253/268 [00:44<00:02,  6.52it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:02,  6.78it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.11it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.16it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.28it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.54it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.53it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.65it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.54it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.55it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.39it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.44it/s][A04/21/2024 16:12:45 - INFO - trainer.trainer_mod - Epoch 17 finished. Took 45.99 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.83it/s]
Epoch:  18%|█▊        | 18/100 [13:58<1:03:50, 46.71s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.97it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.59it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.56it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.53it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.62it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.59it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.58it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.58it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  6.98it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.20it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.31it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.36it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.50it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.44it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.38it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.41it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.26it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.63it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 16:12:49,163 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:12:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:12:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:12:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:12:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.89it/s]04/21/2024 16:12:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:12:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4283763421190625, 'eval_loss': 0.8987939, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1133, 1398, 1568, 1546, 1390, 1320, 958, 756, 497, 230, 328, 149], 'head_nums': [9, 9, 7, 6, 9, 11, 8, 7, 6, 6, 2, 1], 'pruned_params': 55229392, 'remaining_params': 29788208, 'pruned_model_sparsity': 0.6496230427582054, 'expected_sparsity': 0.65018, 'target_sparsity': 0.8418843283582089, 'step': 4850}


Iteration:  10%|▉         | 26/268 [00:05<02:56,  1.37it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:13,  1.81it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:42,  2.34it/s][A
Iteration:  11%|█         | 29/268 [00:05<01:20,  2.97it/s][A
Iteration:  11%|█         | 30/268 [00:06<01:05,  3.62it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:55,  4.29it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:47,  4.93it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:42,  5.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:39,  5.99it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:36,  6.40it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:34,  6.74it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:33,  6.85it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.94it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.14it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.25it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.33it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.60it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.38it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.33it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.37it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.26it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.16it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.21it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.21it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.30it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.41it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.49it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.47it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.25it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.36it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.33it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.44it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.51it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.40it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.38it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.41it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:27,  7.09it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.22it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:26,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 16:12:57,926 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:12:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:12:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:12:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:12:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.89it/s]04/21/2024 16:12:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:12:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45314237018673453, 'eval_loss': 0.92615074, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1114, 1384, 1551, 1534, 1376, 1307, 949, 747, 491, 228, 326, 148], 'head_nums': [8, 9, 7, 6, 9, 11, 8, 6, 6, 6, 2, 1], 'pruned_params': 55800828, 'remaining_params': 29216772, 'pruned_model_sparsity': 0.656344427506775, 'expected_sparsity': 0.65483, 'target_sparsity': 0.8507462686567164, 'step': 4900}


Iteration:  28%|██▊       | 76/268 [00:14<02:21,  1.36it/s][A04/21/2024 16:12:59 - INFO - trainer.trainer_mod - v4 Global step: 4900, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:14<01:46,  1.79it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<01:21,  2.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:04,  2.93it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:52,  3.60it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:43,  4.26it/s][A
Iteration:  31%|███       | 82/268 [00:15<00:38,  4.80it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:34,  5.40it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:30,  6.02it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.69it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.70it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.78it/s][A
Iteration:  33%|███▎      | 89/268 [00:16<00:26,  6.81it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.15it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.28it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.18it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.21it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.41it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.46it/s][A
Iteration:  36%|███▌      | 97/268 [00:17<00:22,  7.63it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:21,  7.77it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:21,  7.71it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.68it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.64it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.76it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:20,  7.92it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:20,  7.82it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.61it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.48it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.66it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.64it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.62it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.52it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.58it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.56it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.56it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.53it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.40it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.61it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.49it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.40it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.25it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 16:13:06,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:13:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:13:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:13:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:13:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.64it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.64it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.86it/s]04/21/2024 16:13:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:13:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4289749717610334, 'eval_loss': 0.9360099, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1095, 1369, 1535, 1521, 1362, 1294, 940, 738, 485, 227, 325, 148], 'head_nums': [8, 9, 7, 6, 9, 11, 8, 6, 6, 5, 2, 1], 'pruned_params': 56174636, 'remaining_params': 28842964, 'pruned_model_sparsity': 0.6607412582806383, 'expected_sparsity': 0.6596, 'target_sparsity': 0.8596082089552238, 'step': 4950}


Iteration:  47%|████▋     | 126/268 [00:22<01:45,  1.35it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<01:19,  1.78it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<01:00,  2.32it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:47,  2.92it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:38,  3.59it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:32,  4.23it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:28,  4.84it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:25,  5.37it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:22,  5.87it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:21,  6.29it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:19,  6.76it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  6.95it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.00it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  7.05it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.20it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.35it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.39it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.59it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.49it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.46it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.49it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.51it/s][A
Iteration:  56%|█████▌    | 149/268 [00:26<00:16,  7.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.57it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.70it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.57it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.59it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.61it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.57it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.44it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.33it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.41it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.23it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.54it/s][A
Iteration:  61%|██████    | 164/268 [00:28<00:13,  7.56it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:14,  7.34it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.33it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.19it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.22it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.34it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.29it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.50it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.53it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:13:15,332 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:13:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:13:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:13:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:13:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.89it/s]04/21/2024 16:13:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:13:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.45550061449184215, 'eval_loss': 0.81729203, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1076, 1354, 1518, 1508, 1349, 1281, 932, 730, 481, 226, 324, 148], 'head_nums': [8, 9, 7, 6, 9, 11, 8, 6, 6, 5, 2, 1], 'pruned_params': 56346220, 'remaining_params': 28671380, 'pruned_model_sparsity': 0.6627594756850347, 'expected_sparsity': 0.66524, 'target_sparsity': 0.8684701492537313, 'step': 5000}


Iteration:  66%|██████▌   | 176/268 [00:31<01:07,  1.36it/s][A04/21/2024 16:13:17 - INFO - trainer.trainer_mod - v4 Global step: 5000, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:31<00:50,  1.80it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:38,  2.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:32<00:30,  2.92it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:24,  3.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:20,  4.26it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:17,  4.89it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:15,  5.41it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:14,  5.91it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:13,  6.34it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:12,  6.66it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:12,  6.71it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:11,  7.06it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.21it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.11it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.17it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:34<00:09,  7.44it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.40it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:35<00:09,  7.39it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  7.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  7.14it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.34it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.46it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:36<00:07,  7.51it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.52it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.41it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.60it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.59it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.58it/s][A
Iteration:  81%|████████  | 216/268 [00:37<00:06,  7.50it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.65it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.47it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.49it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.53it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.47it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:05,  7.53it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:13:24,048 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:13:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:13:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:13:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:13:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:13:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:13:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42144345984531967, 'eval_loss': 0.8836725, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1058, 1339, 1502, 1495, 1335, 1269, 923, 722, 477, 224, 323, 148], 'head_nums': [7, 9, 6, 6, 9, 10, 8, 6, 6, 4, 2, 1], 'pruned_params': 57302188, 'remaining_params': 27715412, 'pruned_model_sparsity': 0.6740038297952424, 'expected_sparsity': 0.67122, 'target_sparsity': 0.8773320895522387, 'step': 5050}


Iteration:  84%|████████▍ | 226/268 [00:40<00:30,  1.36it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:22,  1.80it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:17,  2.33it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:13,  2.95it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:10,  3.57it/s][A
Iteration:  86%|████████▌ | 231/268 [00:41<00:08,  4.21it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:07,  4.85it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:06,  5.43it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:05,  5.93it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:05,  6.42it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  6.63it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  6.89it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  6.93it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:04,  7.10it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.39it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.24it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.32it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.37it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:43<00:02,  7.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.46it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.43it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.53it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.56it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.56it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.59it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.42it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.44it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.51it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.53it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.68it/s][A
Iteration:  97%|█████████▋| 261/268 [00:45<00:00,  7.67it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.62it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.82it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.79it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.71it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.72it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.57it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.14it/s][A04/21/2024 16:13:31 - INFO - trainer.trainer_mod - Epoch 18 finished. Took 45.92 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.84it/s]
Epoch:  19%|█▉        | 19/100 [14:44<1:02:44, 46.47s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.99it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.75it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.66it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.59it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.39it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.15it/s][A[INFO|trainer.py:570] 2024-04-21 16:13:32,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:13:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:13:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:13:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:13:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:13:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:13:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42144345984531967, 'eval_loss': 0.9693454, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1040, 1325, 1487, 1483, 1322, 1257, 914, 714, 473, 223, 321, 148], 'head_nums': [7, 9, 6, 6, 9, 10, 8, 6, 6, 4, 2, 1], 'pruned_params': 57467644, 'remaining_params': 27549956, 'pruned_model_sparsity': 0.6759499680066245, 'expected_sparsity': 0.67621, 'target_sparsity': 0.8861940298507462, 'step': 5100}


Iteration:   3%|▎         | 8/268 [00:03<03:22,  1.28it/s][A04/21/2024 16:13:34 - INFO - trainer.trainer_mod - v4 Global step: 5100, Alignment: tensor([ 0,  2,  8, 10], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:30,  1.73it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:53,  2.27it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:29,  2.88it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:12,  3.54it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:59,  4.27it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:51,  4.97it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:45,  5.56it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:41,  6.03it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.42it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:38,  6.44it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:36,  6.77it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  7.00it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.28it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:32,  7.54it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.53it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.53it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.36it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.29it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.30it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.51it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.55it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:31,  7.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:30,  7.67it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:30,  7.65it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.44it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.64it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:29,  7.80it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.59it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.57it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.39it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.69it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.64it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.64it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.83it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.76it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.60it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.59it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.71it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.72it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.65it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.37it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.46it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.53it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.67it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.75it/s][A[INFO|trainer.py:570] 2024-04-21 16:13:41,308 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:13:41 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:13:41 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:13:41 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:13:41 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:13:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:13:43 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.372792517506349, 'eval_loss': 1.0606725, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1021, 1309, 1471, 1471, 1309, 1245, 906, 706, 468, 221, 319, 148], 'head_nums': [7, 9, 6, 6, 9, 10, 8, 6, 6, 4, 2, 1], 'pruned_params': 57640760, 'remaining_params': 27376840, 'pruned_model_sparsity': 0.6779862052092743, 'expected_sparsity': 0.6809, 'target_sparsity': 0.8950559701492536, 'step': 5150}


Iteration:  22%|██▏       | 58/268 [00:11<02:33,  1.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:55,  1.82it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<01:28,  2.36it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:09,  2.97it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:56,  3.65it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:47,  4.32it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:41,  4.95it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:37,  5.37it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:35,  5.74it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:32,  6.27it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:30,  6.62it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  6.90it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.10it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.26it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.38it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.31it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.41it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.60it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.57it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.41it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.41it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.45it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.35it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:25,  7.42it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:25,  7.32it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.28it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.35it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.42it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.27it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.27it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.26it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.63it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.63it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.62it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.60it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.62it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.60it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.36it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.45it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 16:13:50,031 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:13:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:13:50 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:13:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:13:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.75it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.93it/s]04/21/2024 16:13:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:13:52 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4309672444395815, 'eval_loss': 0.89061475, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1004, 1295, 1456, 1460, 1297, 1234, 898, 699, 463, 220, 317, 148], 'head_nums': [7, 8, 6, 6, 8, 10, 8, 6, 6, 4, 2, 1], 'pruned_params': 57994652, 'remaining_params': 27022948, 'pruned_model_sparsity': 0.6821487786058417, 'expected_sparsity': 0.68498, 'target_sparsity': 0.9039179104477612, 'step': 5200}


Iteration:  40%|████      | 108/268 [00:20<01:58,  1.35it/s][A04/21/2024 16:13:52 - INFO - trainer.trainer_mod - v4 Global step: 5200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:20<01:29,  1.78it/s][A
Iteration:  41%|████      | 110/268 [00:20<01:08,  2.30it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:53,  2.91it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:43,  3.57it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:36,  4.23it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:31,  4.87it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:28,  5.37it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:26,  5.78it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:24,  6.23it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:23,  6.52it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.71it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:21,  6.94it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:21,  7.00it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.15it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.08it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  7.13it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.26it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:18,  7.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:18,  7.48it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.54it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.48it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.30it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.40it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.45it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.45it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.24it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.39it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.42it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.40it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.52it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:16,  7.42it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.51it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.54it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.62it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.65it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.54it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.44it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  6.97it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  7.14it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.25it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.38it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:13:58,782 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:13:58 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:13:58 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:13:58 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:13:58 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:14:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:14:00 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4123772629669354, 'eval_loss': 0.94880277, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [987, 1279, 1440, 1448, 1284, 1222, 890, 691, 458, 219, 315, 148], 'head_nums': [6, 8, 6, 6, 8, 10, 8, 5, 6, 3, 2, 1], 'pruned_params': 58751460, 'remaining_params': 26266140, 'pruned_model_sparsity': 0.6910505589430894, 'expected_sparsity': 0.6886, 'target_sparsity': 0.9127798507462686, 'step': 5250}


Iteration:  59%|█████▉    | 158/268 [00:29<01:20,  1.36it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<01:00,  1.80it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:46,  2.34it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:36,  2.94it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:29,  3.63it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:24,  4.25it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:21,  4.91it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:18,  5.47it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:17,  5.96it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:16,  6.23it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:15,  6.60it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.79it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  7.00it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.15it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:13,  7.30it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.39it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.64it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.60it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.49it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.56it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.56it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.56it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.45it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.49it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.24it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.22it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.35it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.58it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.49it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.48it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.50it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.72it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.56it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.55it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.47it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.47it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.53it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.51it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.42it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:14:07,461 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:14:07 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:14:07 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:14:07 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:14:07 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.73it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.92it/s]04/21/2024 16:14:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:14:09 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43794163748101905, 'eval_loss': 0.94616663, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [970, 1265, 1424, 1436, 1272, 1210, 883, 684, 453, 218, 313, 148], 'head_nums': [6, 8, 6, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 59108416, 'remaining_params': 25909184, 'pruned_model_sparsity': 0.6952491719361638, 'expected_sparsity': 0.69161, 'target_sparsity': 0.9216417910447761, 'step': 5300}


Iteration:  78%|███████▊  | 208/268 [00:37<00:44,  1.36it/s][A04/21/2024 16:14:09 - INFO - trainer.trainer_mod - v4 Global step: 5300, Alignment: tensor([ 0,  2,  8, 10], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:37<00:32,  1.81it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:24,  2.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:19,  2.98it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:15,  3.65it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:12,  4.33it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:10,  4.97it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:09,  5.42it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:08,  5.91it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:08,  6.33it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:07,  6.65it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:07,  6.92it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.10it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.13it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.26it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.34it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.29it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.30it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.19it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.33it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.16it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.29it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.37it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.29it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:04,  7.35it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.63it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.44it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.48it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.48it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.43it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.63it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.38it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.35it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.17it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.41it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.45it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.47it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.18it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.29it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.50it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.52it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.55it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.46it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.49it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 16:14:16,173 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:14:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:14:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:14:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:14:16 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.91it/s]04/21/2024 16:14:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:14:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4305531663459449, 'eval_loss': 0.9038734, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [953, 1250, 1409, 1424, 1259, 1200, 876, 677, 448, 217, 311, 148], 'head_nums': [6, 8, 6, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 59267744, 'remaining_params': 25749856, 'pruned_model_sparsity': 0.6971232309545318, 'expected_sparsity': 0.69446, 'target_sparsity': 0.9305037313432835, 'step': 5350}


Iteration:  96%|█████████▋| 258/268 [00:46<00:07,  1.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:04,  1.81it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:03,  2.35it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:02,  2.92it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:01,  3.59it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:01,  4.26it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  4.89it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  5.46it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  5.98it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  6.32it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.05it/s][A04/21/2024 16:14:19 - INFO - trainer.trainer_mod - Epoch 19 finished. Took 47.88 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.60it/s]
Epoch:  20%|██        | 20/100 [15:32<1:02:31, 46.89s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.70it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.61it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.56it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.60it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.47it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.49it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.40it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.26it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.33it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.54it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.57it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.60it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.48it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.71it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.66it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.50it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.55it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.52it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.53it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.42it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.61it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.50it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.37it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.40it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.24it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.53it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.67it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.61it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.79it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.51it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.66it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:29,  7.78it/s][A[INFO|trainer.py:570] 2024-04-21 16:14:24,795 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:14:24 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:14:24 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:14:24 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:14:24 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:14:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:14:26 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.41805487373984124, 'eval_loss': 0.94567853, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [937, 1236, 1393, 1412, 1247, 1188, 868, 670, 443, 215, 309, 148], 'head_nums': [6, 8, 6, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 59430136, 'remaining_params': 25587464, 'pruned_model_sparsity': 0.6990333295694068, 'expected_sparsity': 0.69706, 'target_sparsity': 0.9393656716417911, 'step': 5400}


Iteration:  15%|█▍        | 40/268 [00:07<02:47,  1.36it/s][A04/21/2024 16:14:26 - INFO - trainer.trainer_mod - v4 Global step: 5400, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:05,  1.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:36,  2.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<01:16,  2.95it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:01,  3.65it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:51,  4.31it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:44,  4.97it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:39,  5.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:36,  5.96it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:34,  6.36it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:32,  6.69it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:31,  6.91it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:30,  7.10it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.25it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.27it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.18it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.21it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.31it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.44it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.59it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.56it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.49it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.52it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.26it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.40it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.32it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.30it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.42it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.65it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.59it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.55it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.57it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.60it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.58it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.56it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.33it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.16it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:25,  7.18it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.29it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.39it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:24,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 16:14:33,499 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:14:33 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:14:33 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:14:33 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:14:33 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.91it/s]04/21/2024 16:14:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:14:35 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4153896652547264, 'eval_loss': 0.9683512, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [921, 1220, 1377, 1401, 1235, 1177, 860, 663, 438, 213, 306, 148], 'head_nums': [6, 8, 5, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 59790156, 'remaining_params': 25227444, 'pruned_model_sparsity': 0.7032679821589882, 'expected_sparsity': 0.69947, 'target_sparsity': 0.9482276119402985, 'step': 5450}


Iteration:  34%|███▎      | 90/268 [00:16<02:10,  1.36it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:39,  1.78it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<01:16,  2.31it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:59,  2.94it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:48,  3.60it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:40,  4.29it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:34,  4.93it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:31,  5.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:28,  5.87it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:26,  6.31it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:25,  6.64it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:24,  6.90it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  7.06it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:23,  7.10it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.25it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.32it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.35it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.31it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.39it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.43it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.38it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.37it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.40it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.34it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:21,  7.18it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.43it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.45it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.46it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.47it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.50it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.61it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.36it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:18,  7.29it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:18,  7.35it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.40it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:16,  7.73it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:16,  7.84it/s][A[INFO|trainer.py:570] 2024-04-21 16:14:42,202 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:14:42 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:14:42 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:14:42 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:14:42 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.73it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.93it/s]04/21/2024 16:14:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:14:44 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4269401120627051, 'eval_loss': 0.85738873, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [906, 1206, 1362, 1390, 1223, 1166, 853, 657, 433, 212, 304, 148], 'head_nums': [6, 8, 5, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 59941824, 'remaining_params': 25075776, 'pruned_model_sparsity': 0.7050519421860886, 'expected_sparsity': 0.70182, 'target_sparsity': 0.95, 'step': 5500}


Iteration:  52%|█████▏    | 140/268 [00:24<01:33,  1.37it/s][A04/21/2024 16:14:44 - INFO - trainer.trainer_mod - v4 Global step: 5500, Alignment: tensor([ 0,  2,  8, 10], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:24<01:09,  1.81it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:53,  2.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:42,  2.96it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:34,  3.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:28,  4.29it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:24,  4.94it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:21,  5.54it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:20,  5.90it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:18,  6.27it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:18,  6.47it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:17,  6.68it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  6.92it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  6.96it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:16,  7.10it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.15it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.22it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:15,  7.35it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.36it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.42it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.46it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.53it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.56it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.57it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.56it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.70it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.47it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.53it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:14,  6.97it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.15it/s][A
Iteration:  64%|██████▍   | 172/268 [00:29<00:13,  7.16it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:13,  7.28it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.48it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.37it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.54it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.53it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.60it/s][A
Iteration:  70%|██████▉   | 187/268 [00:31<00:10,  7.48it/s][A
Iteration:  70%|███████   | 188/268 [00:31<00:10,  7.28it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 16:14:50,932 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:14:50 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:14:50 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:14:50 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:14:50 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.91it/s]04/21/2024 16:14:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:14:52 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4636216536931484, 'eval_loss': 0.81629455, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [892, 1191, 1347, 1378, 1210, 1155, 846, 650, 428, 211, 302, 148], 'head_nums': [6, 8, 5, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 60098088, 'remaining_params': 24919512, 'pruned_model_sparsity': 0.7068899616079494, 'expected_sparsity': 0.70413, 'target_sparsity': 0.95, 'step': 5550}


Iteration:  71%|███████   | 190/268 [00:33<00:57,  1.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:42,  1.80it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:32,  2.33it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:25,  2.94it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:20,  3.60it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:16,  4.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:14,  4.87it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:13,  5.36it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:11,  5.95it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:11,  6.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:10,  6.62it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  6.80it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:09,  6.86it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:09,  6.96it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.26it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.33it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.40it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.66it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.63it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.63it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.52it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.71it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.58it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.58it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.70it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.81it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.58it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.50it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.43it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.21it/s][A
Iteration:  84%|████████▎ | 224/268 [00:38<00:06,  7.20it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.33it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.37it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.47it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.42it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.44it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.68it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.46it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.47it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:14:59,628 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:14:59 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:14:59 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:14:59 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:14:59 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.73it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.92it/s]04/21/2024 16:15:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:15:01 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38281296016649696, 'eval_loss': 1.1357925, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [878, 1176, 1332, 1367, 1198, 1144, 839, 644, 422, 209, 299, 148], 'head_nums': [6, 8, 5, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 60254352, 'remaining_params': 24763248, 'pruned_model_sparsity': 0.7087279810298103, 'expected_sparsity': 0.70624, 'target_sparsity': 0.95, 'step': 5600}


Iteration:  90%|████████▉ | 240/268 [00:42<00:20,  1.36it/s][A04/21/2024 16:15:01 - INFO - trainer.trainer_mod - v4 Global step: 5600, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:42<00:15,  1.78it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:11,  2.31it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:08,  2.93it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:06,  3.60it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:05,  4.23it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:04,  4.87it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  5.46it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:03,  5.96it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  6.50it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  6.78it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.05it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.14it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.30it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.40it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.45it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.36it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.42it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.03it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.15it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.31it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.33it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.38it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  7.91it/s][A04/21/2024 16:15:05 - INFO - trainer.trainer_mod - Epoch 20 finished. Took 45.88 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.84it/s]
Epoch:  21%|██        | 21/100 [16:18<1:01:20, 46.59s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.73it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.58it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.44it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.49it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.51it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.45it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.46it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.37it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.58it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.64it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.48it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.28it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.09it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:35,  7.00it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.14it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.24it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 16:15:08,344 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:15:08 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:15:08 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:15:08 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:15:08 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.91it/s]04/21/2024 16:15:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:15:10 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4072976782543235, 'eval_loss': 0.9659185, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [864, 1162, 1318, 1356, 1187, 1134, 833, 639, 418, 208, 297, 147], 'head_nums': [6, 8, 5, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 60395296, 'remaining_params': 24622304, 'pruned_model_sparsity': 0.7103858024691359, 'expected_sparsity': 0.70831, 'target_sparsity': 0.95, 'step': 5650}


Iteration:   8%|▊         | 22/268 [00:04<03:02,  1.35it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:16,  1.79it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:45,  2.32it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:23,  2.93it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:08,  3.56it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:57,  4.20it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:50,  4.80it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:44,  5.33it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:40,  5.86it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.37it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:34,  6.79it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.01it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.31it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.51it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.68it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.45it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.51it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.45it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.71it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.39it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.46it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.33it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.37it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.57it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.54it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.76it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.73it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.65it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.64it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.64it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.65it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.67it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.63it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.56it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.61it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.50it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.46it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.51it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.30it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.40it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.48it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.49it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 16:15:16,986 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:15:16 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:15:16 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:15:16 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:15:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.73it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.93it/s]04/21/2024 16:15:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:15:18 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4526195252024402, 'eval_loss': 0.8756471, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [851, 1148, 1304, 1345, 1175, 1124, 826, 634, 414, 207, 294, 147], 'head_nums': [6, 8, 5, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 60539304, 'remaining_params': 24478296, 'pruned_model_sparsity': 0.7120796635049684, 'expected_sparsity': 0.71066, 'target_sparsity': 0.95, 'step': 5700}


Iteration:  27%|██▋       | 72/268 [00:13<02:23,  1.37it/s][A04/21/2024 16:15:19 - INFO - trainer.trainer_mod - v4 Global step: 5700, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:13<01:48,  1.80it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<01:22,  2.34it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<01:05,  2.95it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:53,  3.61it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:44,  4.28it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:38,  4.92it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:34,  5.51it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:31,  5.99it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.47it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.63it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  6.90it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.13it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.25it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.34it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.60it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.57it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.56it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.54it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:22,  7.70it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:22,  7.67it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.76it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.73it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.71it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.70it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.53it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  7.07it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:23,  7.10it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.17it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.29it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.56it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.49it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.19it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.32it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.30it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.40it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.46it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.51it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.44it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:15:25,653 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:15:25 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:15:25 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:15:25 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:15:25 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.73it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.92it/s]04/21/2024 16:15:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:15:27 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44158634577419253, 'eval_loss': 0.84691083, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [838, 1134, 1289, 1334, 1164, 1114, 820, 629, 410, 207, 291, 147], 'head_nums': [6, 8, 5, 6, 8, 10, 8, 5, 5, 3, 2, 1], 'pruned_params': 60680248, 'remaining_params': 24337352, 'pruned_model_sparsity': 0.7137374849442939, 'expected_sparsity': 0.71318, 'target_sparsity': 0.95, 'step': 5750}


Iteration:  46%|████▌     | 122/268 [00:22<01:47,  1.36it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<01:20,  1.80it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<01:01,  2.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:48,  2.93it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:39,  3.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:32,  4.32it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:28,  4.88it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:25,  5.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:22,  6.04it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:21,  6.37it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.79it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.89it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.08it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:18,  7.24it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.17it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.19it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.28it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.48it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.50it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.52it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.69it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.66it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.20it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.11it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.27it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.34it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.27it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.34it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.58it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.79it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.75it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.68it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.55it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.43it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.30it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.16it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.26it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.37it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:14,  6.82it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.04it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.09it/s][A[INFO|trainer.py:570] 2024-04-21 16:15:34,403 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:15:34 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:15:34 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:15:34 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:15:34 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.92it/s]04/21/2024 16:15:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:15:36 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4180756988290547, 'eval_loss': 1.007132, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [827, 1120, 1275, 1323, 1153, 1103, 813, 624, 406, 206, 288, 147], 'head_nums': [6, 8, 5, 6, 8, 10, 8, 4, 5, 3, 2, 1], 'pruned_params': 61017288, 'remaining_params': 24000312, 'pruned_model_sparsity': 0.7177018405600722, 'expected_sparsity': 0.71606, 'target_sparsity': 0.95, 'step': 5800}


Iteration:  64%|██████▍   | 172/268 [00:31<01:10,  1.36it/s][A04/21/2024 16:15:36 - INFO - trainer.trainer_mod - v4 Global step: 5800, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:31<00:52,  1.80it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:39,  2.36it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:31,  2.97it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:25,  3.63it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:21,  4.30it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:18,  4.89it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:16,  5.41it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:14,  5.93it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:13,  6.33it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:13,  6.57it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.88it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.06it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.20it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.16it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:11,  7.24it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.36it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.42it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.48it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.58it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.47it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.44it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.53it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.58it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.57it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.50it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.45it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.38it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.47it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.59it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.49it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.40it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.46it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.59it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.53it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.12it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 16:15:43,085 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:15:43 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:15:43 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:15:43 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:15:43 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.73it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.93it/s]04/21/2024 16:15:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:15:45 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42097986053121045, 'eval_loss': 0.9598285, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [815, 1106, 1261, 1314, 1143, 1094, 807, 619, 403, 206, 287, 147], 'head_nums': [6, 8, 5, 6, 8, 9, 8, 4, 5, 3, 2, 1], 'pruned_params': 61340540, 'remaining_params': 23677060, 'pruned_model_sparsity': 0.7215040179915688, 'expected_sparsity': 0.71852, 'target_sparsity': 0.95, 'step': 5850}


Iteration:  83%|████████▎ | 222/268 [00:39<00:33,  1.36it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:25,  1.80it/s][A
Iteration:  84%|████████▎ | 224/268 [00:40<00:19,  2.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:14,  2.90it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:11,  3.51it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:09,  4.19it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:08,  4.77it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:07,  5.36it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:06,  5.91it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.41it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:05,  6.66it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.85it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.88it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.23it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.35it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.48it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.51it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.54it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.69it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.67it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.66it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.63it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.60it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.60it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.56it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.48it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.40it/s][A
Iteration:  95%|█████████▍| 254/268 [00:44<00:01,  7.37it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.42it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.35it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.51it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.39it/s][A
Iteration:  98%|█████████▊| 262/268 [00:45<00:00,  7.45it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.31it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  7.94it/s][A04/21/2024 16:15:51 - INFO - trainer.trainer_mod - Epoch 21 finished. Took 45.86 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.84it/s]
Epoch:  22%|██▏       | 22/100 [17:04<1:00:16, 46.37s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:39,  6.82it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 16:15:51,771 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:15:51 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:15:51 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:15:51 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:15:51 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.75it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.94it/s]04/21/2024 16:15:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:15:53 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44429652763655303, 'eval_loss': 0.88275677, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [804, 1094, 1248, 1303, 1132, 1085, 801, 614, 399, 205, 285, 147], 'head_nums': [6, 8, 5, 6, 8, 9, 8, 4, 5, 3, 2, 1], 'pruned_params': 61470760, 'remaining_params': 23546840, 'pruned_model_sparsity': 0.7230357008431195, 'expected_sparsity': 0.72073, 'target_sparsity': 0.95, 'step': 5900}


Iteration:   1%|▏         | 4/268 [00:02<04:03,  1.09it/s][A04/21/2024 16:15:53 - INFO - trainer.trainer_mod - v4 Global step: 5900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:47,  1.57it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:01,  2.15it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:33,  2.80it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:14,  3.48it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:02,  4.16it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:53,  4.83it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:46,  5.52it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:42,  6.02it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:40,  6.26it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:38,  6.59it/s][A
Iteration:   6%|▌         | 15/268 [00:04<00:36,  6.85it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:35,  7.04it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:35,  7.09it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.24it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.32it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.29it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.20it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.30it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.20it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.13it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.25it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.34it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.22it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.31it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.38it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:32,  7.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.50it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.48it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.33it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.49it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.42it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.48it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.28it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.27it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:31,  7.19it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:30,  7.29it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.35it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.43it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.62it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.35it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:27,  7.74it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:27,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 16:16:00,501 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:16:00 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:16:00 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:16:00 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:16:00 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.73it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.93it/s]04/21/2024 16:16:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:16:02 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4304260866765428, 'eval_loss': 0.88999075, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [792, 1081, 1234, 1294, 1123, 1077, 795, 609, 396, 204, 283, 147], 'head_nums': [6, 8, 5, 6, 8, 9, 8, 4, 5, 3, 2, 1], 'pruned_params': 61596384, 'remaining_params': 23421216, 'pruned_model_sparsity': 0.7245133242999097, 'expected_sparsity': 0.72314, 'target_sparsity': 0.95, 'step': 5950}


Iteration:  20%|██        | 54/268 [00:11<02:36,  1.37it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:57,  1.81it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:30,  2.35it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<01:11,  2.94it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:58,  3.61it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:48,  4.33it/s][A
Iteration:  22%|██▏       | 60/268 [00:12<00:41,  4.97it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:37,  5.49it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:34,  5.99it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.40it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:29,  6.84it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:28,  7.06it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:28,  7.13it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:27,  7.43it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:26,  7.45it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.35it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.54it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.53it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.53it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:25,  7.60it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.56it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.58it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.28it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.25it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.53it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.56it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.46it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.52it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.41it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.37it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.37it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.31it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.26it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.44it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.48it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.52it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.56it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 16:16:09,170 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:16:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:16:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:16:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:16:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.71it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.92it/s]04/21/2024 16:16:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:16:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.44394828853094276, 'eval_loss': 0.8984314, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [782, 1068, 1221, 1285, 1113, 1068, 790, 605, 393, 204, 282, 147], 'head_nums': [6, 8, 5, 6, 8, 9, 8, 4, 5, 3, 2, 1], 'pruned_params': 61714348, 'remaining_params': 23303252, 'pruned_model_sparsity': 0.7259008487654321, 'expected_sparsity': 0.72543, 'target_sparsity': 0.95, 'step': 6000}


Iteration:  39%|███▉      | 104/268 [00:19<02:00,  1.36it/s][A04/21/2024 16:16:11 - INFO - trainer.trainer_mod - v4 Global step: 6000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:20<01:31,  1.79it/s][A
Iteration:  40%|███▉      | 106/268 [00:20<01:09,  2.32it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:55,  2.92it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:44,  3.56it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:37,  4.22it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:32,  4.86it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:28,  5.51it/s][A
Iteration:  42%|████▏     | 112/268 [00:21<00:25,  6.11it/s][A
Iteration:  42%|████▏     | 113/268 [00:21<00:23,  6.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.74it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  6.96it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  7.07it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.44it/s][A
Iteration:  45%|████▍     | 120/268 [00:22<00:19,  7.51it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:18,  7.71it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:18,  7.69it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.23it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:18,  7.51it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:19,  7.42it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:19,  7.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.29it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.48it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.44it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.69it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.67it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:17,  7.42it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.48it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.45it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.48it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.48it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.49it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.24it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.45it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.25it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.54it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:15,  7.60it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.58it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.58it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:16:17,875 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:16:17 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:16:17 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:16:17 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:16:17 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.91it/s]04/21/2024 16:16:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:16:19 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4535057217805826, 'eval_loss': 0.7750515, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [772, 1056, 1209, 1275, 1104, 1060, 785, 600, 390, 203, 280, 147], 'head_nums': [6, 8, 5, 6, 8, 9, 8, 4, 5, 3, 2, 1], 'pruned_params': 61832312, 'remaining_params': 23185288, 'pruned_model_sparsity': 0.7272883732309545, 'expected_sparsity': 0.72751, 'target_sparsity': 0.95, 'step': 6050}


Iteration:  57%|█████▋    | 154/268 [00:28<01:23,  1.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<01:02,  1.80it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:48,  2.33it/s][A
Iteration:  59%|█████▊    | 157/268 [00:29<00:37,  2.92it/s][A
Iteration:  59%|█████▉    | 158/268 [00:29<00:30,  3.58it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:25,  4.26it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:22,  4.90it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:19,  5.48it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:18,  5.74it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:17,  6.12it/s][A
Iteration:  61%|██████    | 164/268 [00:30<00:16,  6.49it/s][A
Iteration:  62%|██████▏   | 165/268 [00:30<00:15,  6.77it/s][A
Iteration:  62%|██████▏   | 166/268 [00:30<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.18it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.29it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.39it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.46it/s][A
Iteration:  64%|██████▍   | 172/268 [00:31<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:12,  7.55it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.47it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.51it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.66it/s][A
Iteration:  67%|██████▋   | 180/268 [00:32<00:11,  7.61it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:11,  7.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.58it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.54it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.59it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.46it/s][A
Iteration:  70%|██████▉   | 187/268 [00:33<00:10,  7.48it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.48it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.51it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.54it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.54it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.57it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.66it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.64it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.60it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.38it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.43it/s][A
Iteration:  75%|███████▌  | 202/268 [00:35<00:08,  7.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:16:26,563 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:16:26 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:16:26 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:16:26 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:16:26 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.92it/s]04/21/2024 16:16:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:16:28 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43566147276776424, 'eval_loss': 0.84423184, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [761, 1043, 1197, 1266, 1094, 1052, 779, 596, 388, 202, 277, 147], 'head_nums': [6, 7, 5, 5, 8, 9, 8, 4, 5, 3, 2, 1], 'pruned_params': 61953340, 'remaining_params': 23064260, 'pruned_model_sparsity': 0.728711937292984, 'expected_sparsity': 0.73012, 'target_sparsity': 0.95, 'step': 6100}


Iteration:  76%|███████▌  | 204/268 [00:37<00:47,  1.35it/s][A04/21/2024 16:16:28 - INFO - trainer.trainer_mod - v4 Global step: 6100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:37<00:35,  1.79it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:26,  2.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:20,  2.93it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:16,  3.57it/s][A
Iteration:  78%|███████▊  | 209/268 [00:38<00:13,  4.25it/s][A
Iteration:  78%|███████▊  | 210/268 [00:38<00:11,  4.90it/s][A
Iteration:  79%|███████▊  | 211/268 [00:38<00:10,  5.58it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:09,  6.06it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.44it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:08,  6.74it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  6.96it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  6.93it/s][A
Iteration:  81%|████████  | 217/268 [00:39<00:07,  7.11it/s][A
Iteration:  81%|████████▏ | 218/268 [00:39<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:06,  7.34it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.40it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.34it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.36it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.55it/s][A
Iteration:  84%|████████▍ | 225/268 [00:40<00:05,  7.68it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:05,  7.68it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.61it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.58it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.61it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.49it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:41<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:41<00:05,  6.95it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.13it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.16it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.27it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.56it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.60it/s][A
Iteration:  89%|████████▉ | 239/268 [00:42<00:03,  7.49it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:03,  7.41it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.46it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.51it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.30it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.13it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.30it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.42it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.39it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 16:16:35,264 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:16:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:16:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:16:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:16:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.56it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:16:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:16:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42631677443771676, 'eval_loss': 0.8372341, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [751, 1032, 1186, 1257, 1085, 1044, 775, 593, 386, 201, 276, 147], 'head_nums': [6, 7, 5, 5, 8, 9, 8, 4, 5, 3, 2, 1], 'pruned_params': 62059048, 'remaining_params': 22958552, 'pruned_model_sparsity': 0.7299553033724782, 'expected_sparsity': 0.73274, 'target_sparsity': 0.95, 'step': 6150}


Iteration:  95%|█████████▍| 254/268 [00:46<00:10,  1.36it/s][A
Iteration:  95%|█████████▌| 255/268 [00:46<00:07,  1.80it/s][A
Iteration:  96%|█████████▌| 256/268 [00:46<00:05,  2.31it/s][A
Iteration:  96%|█████████▌| 257/268 [00:46<00:03,  2.92it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:02,  3.53it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:02,  4.20it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  4.85it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  5.42it/s][A
Iteration:  98%|█████████▊| 262/268 [00:47<00:01,  5.92it/s][A
Iteration:  98%|█████████▊| 263/268 [00:47<00:00,  6.33it/s][A
Iteration:  99%|█████████▊| 264/268 [00:47<00:00,  6.64it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.01it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.11it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.22it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.84it/s][A04/21/2024 16:16:39 - INFO - trainer.trainer_mod - Epoch 22 finished. Took 47.89 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.60it/s]
Epoch:  23%|██▎       | 23/100 [17:52<1:00:05, 46.83s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|          | 3/268 [00:00<00:38,  6.88it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.18it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:37,  7.10it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:36,  7.13it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.14it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.24it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.32it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.35it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.33it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.23it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:37,  6.76it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  6.87it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  6.99it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.09it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.12it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.38it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.23it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.22it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.44it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:32,  7.46it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.39it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.60it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.59it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.46it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.38it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.50it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.52it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.52it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.53it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.57it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:16:44,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:16:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:16:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:16:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:16:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.74it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.94it/s]04/21/2024 16:16:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:16:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.43322527079405493, 'eval_loss': 0.89362925, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [742, 1021, 1174, 1248, 1076, 1036, 770, 589, 383, 200, 274, 147], 'head_nums': [6, 7, 5, 5, 8, 8, 8, 4, 5, 3, 2, 1], 'pruned_params': 62366980, 'remaining_params': 22650620, 'pruned_model_sparsity': 0.7335772828214393, 'expected_sparsity': 0.73531, 'target_sparsity': 0.95, 'step': 6200}


Iteration:  13%|█▎        | 36/268 [00:06<02:49,  1.37it/s][A04/21/2024 16:16:46 - INFO - trainer.trainer_mod - v4 Global step: 6200, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:07<02:07,  1.81it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:36,  2.38it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:16,  2.99it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:02,  3.63it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:52,  4.35it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:45,  5.00it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:40,  5.57it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:37,  5.93it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.79it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:32,  6.83it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  7.04it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.31it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.25it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.27it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:29,  7.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.05it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.08it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.35it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.49it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.42it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.47it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.67it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:25,  7.88it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.79it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.62it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:26,  7.50it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.57it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.60it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.59it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.59it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.44it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.31it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.39it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.43it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.30it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:16:52,662 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:16:52 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:16:52 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:16:52 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:16:52 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.74it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.71it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.92it/s]04/21/2024 16:16:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:16:54 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42432694712156455, 'eval_loss': 0.87094605, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [733, 1010, 1163, 1239, 1068, 1028, 764, 585, 381, 200, 273, 147], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 4, 5, 3, 2, 1], 'pruned_params': 62668784, 'remaining_params': 22348816, 'pruned_model_sparsity': 0.7371271830773863, 'expected_sparsity': 0.73825, 'target_sparsity': 0.95, 'step': 6250}


Iteration:  32%|███▏      | 86/268 [00:15<02:13,  1.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:39,  1.81it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<01:16,  2.35it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<01:00,  2.96it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:49,  3.62it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:41,  4.30it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:35,  4.92it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:31,  5.57it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:28,  6.18it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.44it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:24,  6.86it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:24,  6.92it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.09it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.37it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.30it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.28it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.36it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.44it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.41it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.43it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.59it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.57it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 112/268 [00:19<00:20,  7.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.55it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.46it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.51it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.32it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.38it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:20,  7.34it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:20,  7.32it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.50it/s][A
Iteration:  47%|████▋     | 127/268 [00:21<00:18,  7.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.51it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.38it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.35it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.55it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.60it/s][A
Iteration:  50%|█████     | 135/268 [00:22<00:17,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:17:01,335 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:17:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:17:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:17:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:17:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.77it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.73it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.93it/s]04/21/2024 16:17:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:17:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40345980880864174, 'eval_loss': 0.9195524, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [724, 1001, 1152, 1231, 1059, 1020, 760, 581, 379, 199, 273, 147], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 4, 5, 3, 2, 1], 'pruned_params': 62768364, 'remaining_params': 22249236, 'pruned_model_sparsity': 0.7382984699638663, 'expected_sparsity': 0.74229, 'target_sparsity': 0.95, 'step': 6300}


Iteration:  51%|█████     | 136/268 [00:24<01:36,  1.37it/s][A04/21/2024 16:17:03 - INFO - trainer.trainer_mod - v4 Global step: 6300, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:24<01:12,  1.81it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:55,  2.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:43,  2.93it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:35,  3.60it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:29,  4.26it/s][A
Iteration:  53%|█████▎    | 142/268 [00:25<00:26,  4.84it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:23,  5.42it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:20,  5.91it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:19,  6.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:18,  6.68it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  7.10it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:17,  7.03it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.11it/s][A
Iteration:  56%|█████▌    | 150/268 [00:26<00:16,  7.27it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.33it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.56it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.56it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.63it/s][A
Iteration:  59%|█████▊    | 157/268 [00:27<00:14,  7.48it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.67it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.53it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.52it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.66it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.66it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.37it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:28<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:12,  7.72it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.82it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.67it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.56it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.59it/s][A
Iteration:  65%|██████▍   | 173/268 [00:29<00:12,  7.60it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.39it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.65it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.63it/s][A
Iteration:  67%|██████▋   | 180/268 [00:30<00:11,  7.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.54it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.70it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.62it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 16:17:09,952 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:17:09 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:17:09 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:17:09 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:17:09 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.74it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.73it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.71it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.72it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.73it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.70it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.70it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.90it/s]04/21/2024 16:17:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:17:11 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37358284821510174, 'eval_loss': 0.97849625, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [716, 993, 1141, 1223, 1051, 1014, 755, 577, 376, 199, 273, 147], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 4, 5, 3, 2, 1], 'pruned_params': 62861816, 'remaining_params': 22155784, 'pruned_model_sparsity': 0.7393976776573321, 'expected_sparsity': 0.7476, 'target_sparsity': 0.95, 'step': 6350}


Iteration:  69%|██████▉   | 186/268 [00:32<00:59,  1.37it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:44,  1.81it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:33,  2.36it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:26,  2.98it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:21,  3.63it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:17,  4.31it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:15,  4.96it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:13,  5.56it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:12,  5.90it/s][A
Iteration:  73%|███████▎  | 195/268 [00:34<00:11,  6.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:11,  6.48it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  6.72it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:10,  6.89it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:10,  6.82it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.04it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.21it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:09,  7.21it/s][A
Iteration:  76%|███████▌  | 203/268 [00:35<00:08,  7.29it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.38it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.46it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.34it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.42it/s][A
Iteration:  78%|███████▊  | 210/268 [00:36<00:07,  7.39it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.34it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.23it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.32it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.56it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.60it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.63it/s][A
Iteration:  81%|████████  | 217/268 [00:37<00:06,  7.61it/s][A
Iteration:  81%|████████▏ | 218/268 [00:37<00:06,  7.62it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.52it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.40it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.36it/s][A
Iteration:  84%|████████▍ | 225/268 [00:38<00:05,  7.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.33it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.31it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.25it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.50it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.52it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.69it/s][A
Iteration:  87%|████████▋ | 232/268 [00:39<00:04,  7.66it/s][A
Iteration:  87%|████████▋ | 233/268 [00:39<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 16:17:18,658 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:17:18 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:17:18 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:17:18 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:17:18 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.80it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.81it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.77it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.98it/s]04/21/2024 16:17:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:17:20 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40200223868227586, 'eval_loss': 0.88662666, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [709, 987, 1132, 1215, 1045, 1007, 750, 574, 374, 198, 272, 147], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 4, 5, 3, 2, 1], 'pruned_params': 64458160, 'remaining_params': 20559440, 'pruned_model_sparsity': 0.7581743074375188, 'expected_sparsity': 0.75356, 'target_sparsity': 0.95, 'step': 6400}


Iteration:  88%|████████▊ | 236/268 [00:41<00:23,  1.37it/s][A04/21/2024 16:17:20 - INFO - trainer.trainer_mod - v4 Global step: 6400, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:41<00:17,  1.81it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:12,  2.34it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:09,  2.96it/s][A
Iteration:  90%|████████▉ | 240/268 [00:42<00:07,  3.63it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:06,  4.27it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:05,  4.89it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:04,  5.45it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:04,  5.97it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  6.38it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  6.68it/s][A
Iteration:  92%|█████████▏| 247/268 [00:43<00:03,  6.95it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.03it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.31it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.34it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.31it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.40it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.47it/s][A
Iteration:  95%|█████████▌| 255/268 [00:44<00:01,  7.49it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.52it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.68it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.63it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.58it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.55it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.56it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.57it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  7.85it/s][A04/21/2024 16:17:24 - INFO - trainer.trainer_mod - Epoch 23 finished. Took 45.76 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.86it/s]
Epoch:  24%|██▍       | 24/100 [18:38<58:54, 46.51s/it]  
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  7.97it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.72it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.28it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.47it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.49it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.34it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.21it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:35,  7.20it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.31it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.37it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.30it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.21it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.26it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:17:27,306 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:17:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:17:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:17:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:17:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.83it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.80it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.81it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.99it/s]04/21/2024 16:17:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:17:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38843429684891484, 'eval_loss': 0.8602265, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [702, 983, 1122, 1208, 1038, 1001, 745, 571, 372, 198, 271, 147], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 3, 5, 3, 2, 1], 'pruned_params': 64727792, 'remaining_params': 20289808, 'pruned_model_sparsity': 0.7613457919301415, 'expected_sparsity': 0.75888, 'target_sparsity': 0.95, 'step': 6450}


Iteration:   7%|▋         | 18/268 [00:04<03:02,  1.37it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:16,  1.82it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:45,  2.35it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:23,  2.96it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:07,  3.62it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:56,  4.31it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:49,  4.95it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:43,  5.59it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:39,  6.09it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:37,  6.45it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:35,  6.85it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:35,  6.74it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:35,  6.74it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.94it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.23it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.43it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.58it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.62it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.75it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.56it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.70it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.75it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:28,  7.92it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.75it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.70it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.54it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.43it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.44it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.54it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.53it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.39it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.33it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.40it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.24it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.19it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.28it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.35it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.42it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.32it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 16:17:35,972 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:17:35 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:17:35 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:17:35 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:17:35 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.83it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.80it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.75it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.80it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.97it/s]04/21/2024 16:17:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:17:37 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40085080763525827, 'eval_loss': 0.80147284, 'head_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [695, 981, 1113, 1200, 1031, 994, 741, 568, 369, 198, 270, 147], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 3, 5, 3, 2, 1], 'pruned_params': 64802860, 'remaining_params': 20214740, 'pruned_model_sparsity': 0.7622287620445649, 'expected_sparsity': 0.76368, 'target_sparsity': 0.95, 'step': 6500}


Iteration:  25%|██▌       | 68/268 [00:13<02:26,  1.37it/s][A04/21/2024 16:17:38 - INFO - trainer.trainer_mod - v4 Global step: 6500, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:13<01:50,  1.81it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<01:24,  2.34it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:06,  2.96it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:54,  3.60it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:45,  4.24it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:39,  4.86it/s][A
Iteration:  28%|██▊       | 75/268 [00:14<00:35,  5.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:32,  5.92it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.37it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.68it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:28,  6.74it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  6.99it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:26,  7.15it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:25,  7.41it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.46it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.50it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.52it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.30it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.37it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.47it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.50it/s][A
Iteration:  34%|███▎      | 90/268 [00:16<00:24,  7.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.40it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.63it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.73it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.72it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.57it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.60it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.64it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.55it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:21,  7.41it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.57it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.59it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.59it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.80it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.73it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:19,  7.89it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:19,  7.81it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:19,  7.72it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.59it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:17:44,596 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:17:44 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:17:44 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:17:44 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:17:44 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.80it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.04it/s]04/21/2024 16:17:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:17:46 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.32464169804074816, 'eval_loss': 0.965526, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [688, 980, 1104, 1192, 1025, 988, 736, 565, 367, 197, 269, 146], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 3, 5, 3, 2, 1], 'pruned_params': 66445164, 'remaining_params': 18572436, 'pruned_model_sparsity': 0.7815459857723577, 'expected_sparsity': 0.76907, 'target_sparsity': 0.95, 'step': 6550}


Iteration:  44%|████▍     | 118/268 [00:21<01:49,  1.37it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<01:21,  1.82it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<01:02,  2.36it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:49,  2.97it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:41,  3.49it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:34,  4.19it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:30,  4.76it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:26,  5.33it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:24,  5.85it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:21,  6.43it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:21,  6.56it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.74it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  6.95it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.11it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.27it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.26it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.45it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.50it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.53it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.55it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.72it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.73it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.66it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.60it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.55it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.49it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.52it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.63it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.49it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.72it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.80it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.78it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.64it/s][A
Iteration:  59%|█████▉    | 158/268 [00:27<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.51it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.51it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.18it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.32it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.31it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.32it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:17:53,261 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:17:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:17:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:17:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:17:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.04it/s]04/21/2024 16:17:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:17:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35833423979893186, 'eval_loss': 0.7993621, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [682, 979, 1095, 1184, 1018, 982, 731, 562, 364, 197, 268, 146], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 3, 5, 3, 2, 1], 'pruned_params': 66518700, 'remaining_params': 18498900, 'pruned_model_sparsity': 0.7824109360885275, 'expected_sparsity': 0.77255, 'target_sparsity': 0.95, 'step': 6600}


Iteration:  63%|██████▎   | 168/268 [00:30<01:13,  1.36it/s][A04/21/2024 16:17:55 - INFO - trainer.trainer_mod - v4 Global step: 6600, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:30<00:54,  1.81it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:42,  2.33it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:32,  2.96it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:26,  3.66it/s][A
Iteration:  65%|██████▍   | 173/268 [00:31<00:21,  4.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:18,  4.98it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:16,  5.50it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:15,  5.91it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:14,  6.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.60it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  6.87it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:12,  7.14it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.24it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.24it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.38it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.50it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.55it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.47it/s][A
Iteration:  70%|███████   | 188/268 [00:33<00:10,  7.37it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.58it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.73it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:09,  7.70it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.66it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.65it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.67it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.54it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.72it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.82it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:08,  7.88it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.63it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.65it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.66it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.63it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.66it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.56it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.52it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.46it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.54it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.42it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.54it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.46it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.50it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:18:01,866 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:18:01 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:18:01 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:18:01 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:18:01 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.83it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.04it/s]04/21/2024 16:18:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:18:03 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3490763804757191, 'eval_loss': 0.85464597, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [677, 978, 1086, 1176, 1011, 976, 727, 559, 362, 196, 267, 146], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 3, 5, 3, 2, 1], 'pruned_params': 66589172, 'remaining_params': 18428428, 'pruned_model_sparsity': 0.7832398468081903, 'expected_sparsity': 0.77569, 'target_sparsity': 0.95, 'step': 6650}


Iteration:  81%|████████▏ | 218/268 [00:38<00:36,  1.38it/s][A
Iteration:  82%|████████▏ | 219/268 [00:39<00:26,  1.83it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:20,  2.37it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:15,  2.96it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:12,  3.61it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:10,  4.31it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:08,  5.01it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:07,  5.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:40<00:07,  5.69it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:06,  6.09it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:06,  6.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  6.70it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  6.88it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.98it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.20it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.44it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.32it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.40it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.50it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:42<00:03,  7.43it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.24it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.32it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.41it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 248/268 [00:43<00:02,  7.29it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.45it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.55it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.58it/s][A
Iteration:  96%|█████████▌| 256/268 [00:44<00:01,  7.31it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.40it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.47it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.51it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.44it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.51it/s][A
Iteration:  98%|█████████▊| 263/268 [00:45<00:00,  7.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.56it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.58it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 16:18:10,544 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:18:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:18:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:18:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:18:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:18:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:18:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.32212459585412984, 'eval_loss': 0.8820756, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [670, 978, 1078, 1169, 1005, 972, 724, 557, 359, 196, 266, 146], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 3, 5, 3, 2, 1], 'pruned_params': 66651984, 'remaining_params': 18365616, 'pruned_model_sparsity': 0.7839786585365853, 'expected_sparsity': 0.77788, 'target_sparsity': 0.95, 'step': 6700}


Iteration: 100%|██████████| 268/268 [00:47<00:00,  1.40it/s][A04/21/2024 16:18:12 - INFO - trainer.trainer_mod - Epoch 24 finished. Took 47.65 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.62it/s]
Epoch:  25%|██▌       | 25/100 [19:25<58:33, 46.85s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/21/2024 16:18:12 - INFO - trainer.trainer_mod - v4 Global step: 6700, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.58it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.33it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.41it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.68it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.39it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.64it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.47it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.63it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.60it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.58it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.49it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.49it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.15it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.11it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:34,  7.15it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:34,  7.16it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.30it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.41it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.54it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.56it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.54it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.51it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.48it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.51it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.45it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.39it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.57it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.60it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.37it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.45it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.52it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:29,  7.54it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:29,  7.54it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:28,  7.66it/s][A
Iteration:  18%|█▊        | 48/268 [00:06<00:28,  7.68it/s][A
Iteration:  18%|█▊        | 49/268 [00:06<00:29,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:18:19,199 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:18:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:18:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:18:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:18:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.83it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.04it/s]04/21/2024 16:18:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:18:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3417099112893187, 'eval_loss': 0.7914352, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [664, 977, 1070, 1161, 998, 967, 720, 554, 357, 195, 265, 146], 'head_nums': [6, 7, 4, 5, 8, 8, 8, 3, 5, 3, 2, 1], 'pruned_params': 66720924, 'remaining_params': 18296676, 'pruned_model_sparsity': 0.7847895494579946, 'expected_sparsity': 0.77967, 'target_sparsity': 0.95, 'step': 6750}


Iteration:  19%|█▊        | 50/268 [00:08<02:37,  1.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:58,  1.83it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<01:31,  2.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:11,  2.99it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:58,  3.66it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:48,  4.38it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:42,  4.97it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:38,  5.51it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:34,  6.01it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:32,  6.42it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:31,  6.59it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.77it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:29,  7.00it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.29it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.36it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.18it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.46it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.34it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.27it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.35it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.45it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.44it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.54it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.47it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.27it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.40it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.46it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.50it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.67it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.66it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.53it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.68it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.58it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.41it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.64it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.54it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.41it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.59it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:22,  7.58it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:22,  7.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.64it/s][A
Iteration:  36%|███▌      | 97/268 [00:14<00:22,  7.65it/s][A
Iteration:  37%|███▋      | 98/268 [00:15<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 99/268 [00:15<00:22,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 16:18:27,830 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:18:27 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:18:27 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:18:27 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:18:27 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.05it/s]04/21/2024 16:18:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:18:29 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3415196305775373, 'eval_loss': 0.9260837, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [659, 976, 1062, 1154, 993, 961, 715, 552, 353, 195, 265, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 7, 3, 5, 3, 2, 1], 'pruned_params': 66981364, 'remaining_params': 18036236, 'pruned_model_sparsity': 0.787852915161096, 'expected_sparsity': 0.7811, 'target_sparsity': 0.95, 'step': 6800}


Iteration:  37%|███▋      | 100/268 [00:17<02:02,  1.38it/s][A04/21/2024 16:18:29 - INFO - trainer.trainer_mod - v4 Global step: 6800, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:17<01:31,  1.82it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<01:09,  2.38it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:55,  2.99it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:44,  3.66it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:37,  4.33it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:32,  5.02it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:28,  5.61it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:25,  6.18it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:24,  6.50it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:23,  6.79it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:22,  6.99it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.14it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.44it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.47it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.77it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.74it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.67it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.83it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.55it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.57it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.43it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.55it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.38it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.45it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.51it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.61it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.64it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.42it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.28it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.40it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.51it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:16,  7.56it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.70it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.79it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.59it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.74it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:15,  7.69it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.40it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:16,  7.51it/s][A
Iteration:  55%|█████▌    | 148/268 [00:23<00:15,  7.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:23<00:15,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:18:36,400 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:18:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:18:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:18:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:18:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.81it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.03it/s]04/21/2024 16:18:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:18:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40529661158227454, 'eval_loss': 0.75750256, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [654, 976, 1053, 1147, 987, 956, 711, 549, 350, 195, 264, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 7, 3, 5, 3, 2, 1], 'pruned_params': 67047240, 'remaining_params': 17970360, 'pruned_model_sparsity': 0.7886277664859982, 'expected_sparsity': 0.78251, 'target_sparsity': 0.95, 'step': 6850}


Iteration:  56%|█████▌    | 150/268 [00:25<01:25,  1.37it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<01:04,  1.82it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:49,  2.36it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:38,  2.96it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:31,  3.61it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:26,  4.28it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:22,  4.93it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:20,  5.48it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:18,  5.89it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:16,  6.48it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  6.76it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  6.91it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:15,  6.94it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.03it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.20it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:14,  7.33it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.37it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.43it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.48it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.38it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.43it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:13,  7.38it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.44it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.49it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.32it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.38it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:12,  7.34it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:12,  7.31it/s][A
Iteration:  68%|██████▊   | 181/268 [00:30<00:11,  7.27it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.36it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.42it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.26it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.37it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.41it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.63it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.38it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:09,  7.54it/s][A
Iteration:  72%|███████▏  | 194/268 [00:31<00:10,  7.26it/s][A
Iteration:  73%|███████▎  | 195/268 [00:31<00:10,  7.00it/s][A
Iteration:  73%|███████▎  | 196/268 [00:32<00:10,  7.19it/s][A
Iteration:  74%|███████▎  | 197/268 [00:32<00:09,  7.29it/s][A
Iteration:  74%|███████▍  | 198/268 [00:32<00:09,  7.36it/s][A
Iteration:  74%|███████▍  | 199/268 [00:32<00:09,  7.19it/s][A[INFO|trainer.py:570] 2024-04-21 16:18:45,138 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:18:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:18:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:18:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:18:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:18:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:18:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34139440645936486, 'eval_loss': 0.91909486, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [649, 975, 1045, 1140, 981, 950, 707, 547, 348, 194, 263, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 7, 3, 5, 3, 2, 1], 'pruned_params': 67111584, 'remaining_params': 17906016, 'pruned_model_sparsity': 0.7893845980126468, 'expected_sparsity': 0.78396, 'target_sparsity': 0.95, 'step': 6900}


Iteration:  75%|███████▍  | 200/268 [00:34<00:49,  1.37it/s][A04/21/2024 16:18:47 - INFO - trainer.trainer_mod - v4 Global step: 6900, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:34<00:36,  1.81it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:28,  2.35it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:21,  2.96it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:17,  3.63it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:15,  4.11it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:12,  4.83it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:11,  5.43it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:10,  5.96it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:09,  6.40it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:08,  6.73it/s][A
Iteration:  79%|███████▊  | 211/268 [00:36<00:08,  6.82it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.03it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.22it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.26it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.46it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.53it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.43it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.38it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.50it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.75it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.74it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.70it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:04,  7.89it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.66it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.64it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.64it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.63it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.51it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.58it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.55it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:40<00:03,  7.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:40<00:03,  7.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.55it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.59it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:02,  7.72it/s][A
Iteration:  92%|█████████▏| 246/268 [00:40<00:02,  7.74it/s][A
Iteration:  92%|█████████▏| 247/268 [00:40<00:02,  7.68it/s][A
Iteration:  93%|█████████▎| 248/268 [00:40<00:02,  7.42it/s][A
Iteration:  93%|█████████▎| 249/268 [00:41<00:02,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:18:53,738 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:18:53 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:18:53 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:18:53 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:18:53 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:18:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:18:55 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36408077921591914, 'eval_loss': 0.8620494, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [644, 975, 1038, 1132, 976, 944, 704, 545, 345, 194, 261, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 7, 3, 5, 3, 2, 1], 'pruned_params': 67174396, 'remaining_params': 17843204, 'pruned_model_sparsity': 0.7901234097410419, 'expected_sparsity': 0.78553, 'target_sparsity': 0.95, 'step': 6950}


Iteration:  93%|█████████▎| 250/268 [00:43<00:13,  1.38it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:09,  1.83it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:06,  2.38it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:05,  3.00it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:03,  3.64it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:02,  4.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:02,  5.03it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  5.58it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  5.91it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  6.33it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  6.68it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:01,  6.95it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  6.98it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.16it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.10it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.26it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.37it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.45it/s][A04/21/2024 16:18:58 - INFO - trainer.trainer_mod - Epoch 25 finished. Took 45.55 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.88it/s]
Epoch:  26%|██▌       | 26/100 [20:11<57:17, 46.46s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.66it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.37it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.61it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.63it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.65it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.79it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.71it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.83it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.79it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.69it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.59it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.52it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.38it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.78it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.65it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.55it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.50it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.56it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.33it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.39it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.44it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.43it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.46it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.54it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 16:19:02,309 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:19:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:19:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:19:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:19:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:19:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:19:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4035045391984504, 'eval_loss': 0.78261065, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [639, 974, 1031, 1125, 971, 939, 701, 543, 343, 194, 260, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 7, 3, 5, 3, 2, 1], 'pruned_params': 67231080, 'remaining_params': 17786520, 'pruned_model_sparsity': 0.7907901422764227, 'expected_sparsity': 0.78722, 'target_sparsity': 0.95, 'step': 7000}


Iteration:  12%|█▏        | 32/268 [00:06<02:51,  1.37it/s][A04/21/2024 16:19:04 - INFO - trainer.trainer_mod - v4 Global step: 7000, Alignment: tensor([ 4,  7,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:09,  1.81it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:40,  2.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:19,  2.95it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:04,  3.62it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:52,  4.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:46,  4.90it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:41,  5.50it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:38,  5.98it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:35,  6.38it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:33,  6.71it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.90it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:32,  6.92it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:31,  7.12it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.25it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.36it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.35it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.60it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.50it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.50it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.36it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.47it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.56it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.59it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.56it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.58it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.60it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.59it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.66it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.63it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:25,  7.85it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.81it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.77it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.72it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.69it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.68it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:27,  7.05it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:27,  7.03it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:27,  7.07it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.14it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.36it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.57it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 16:19:10,958 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:19:10 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:19:10 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:19:10 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:19:10 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:19:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:19:12 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3496254088060252, 'eval_loss': 0.97075516, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [634, 973, 1023, 1119, 967, 934, 698, 541, 340, 194, 259, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 7, 3, 5, 3, 2, 1], 'pruned_params': 67287764, 'remaining_params': 17729836, 'pruned_model_sparsity': 0.7914568748118037, 'expected_sparsity': 0.78885, 'target_sparsity': 0.95, 'step': 7050}


Iteration:  31%|███       | 82/268 [00:14<02:14,  1.38it/s][A
Iteration:  31%|███       | 83/268 [00:15<01:41,  1.82it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<01:18,  2.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:01,  2.95it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:50,  3.61it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:41,  4.33it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:37,  4.86it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:32,  5.45it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:29,  6.03it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:28,  6.15it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:26,  6.56it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.85it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.01it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:24,  7.10it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:24,  7.11it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.24it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.56it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.61it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.76it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.72it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.68it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.68it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.55it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.46it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.46it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.49it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.35it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.31it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.26it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.39it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.58it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:19,  7.81it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.62it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.49it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:20,  7.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.46it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.35it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.49it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.63it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.56it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.68it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.69it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 16:19:19,616 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:19:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:19:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:19:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:19:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.87it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:19:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:19:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3540349775999284, 'eval_loss': 0.9826653, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [629, 972, 1016, 1111, 962, 929, 694, 538, 339, 193, 258, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 7, 3, 4, 3, 2, 1], 'pruned_params': 67545140, 'remaining_params': 17472460, 'pruned_model_sparsity': 0.7944842009183981, 'expected_sparsity': 0.7902, 'target_sparsity': 0.95, 'step': 7100}


Iteration:  49%|████▉     | 132/268 [00:23<01:39,  1.37it/s][A04/21/2024 16:19:21 - INFO - trainer.trainer_mod - v4 Global step: 7100, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:23<01:14,  1.82it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:57,  2.35it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:44,  2.97it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:36,  3.64it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:30,  4.32it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:26,  4.97it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:23,  5.58it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:20,  6.15it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:19,  6.51it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.83it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.02it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:17,  7.20it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.35it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.53it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.34it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.59it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.61it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.62it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:14,  7.83it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:14,  7.98it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.89it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.69it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.65it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.77it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.76it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.71it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.82it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.52it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.44it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.68it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.67it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.80it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.66it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.67it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.63it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.61it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.58it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.59it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.57it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.49it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.55it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.61it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.49it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.55it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:19:28,125 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:19:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:19:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:19:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:19:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.81it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:19:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:19:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3615267708087633, 'eval_loss': 0.9179006, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [624, 972, 1009, 1105, 957, 923, 691, 536, 337, 193, 257, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 6, 3, 4, 3, 2, 1], 'pruned_params': 67797920, 'remaining_params': 17219680, 'pruned_model_sparsity': 0.7974574676302318, 'expected_sparsity': 0.79138, 'target_sparsity': 0.95, 'step': 7150}


Iteration:  68%|██████▊   | 182/268 [00:32<01:02,  1.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:46,  1.81it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:35,  2.33it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:28,  2.96it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:22,  3.60it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:18,  4.27it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:16,  4.93it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:14,  5.46it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:13,  5.97it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.46it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.04it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.20it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.45it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:08,  7.68it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.58it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.58it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.62it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.62it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.62it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.55it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.59it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.44it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.39it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.31it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.38it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.40it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.55it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.70it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.45it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.45it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.63it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.56it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.61it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.35it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.30it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.25it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.34it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.28it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:05,  7.24it/s][A[INFO|trainer.py:570] 2024-04-21 16:19:36,783 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:19:36 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:19:36 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:19:36 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:19:36 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.17it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.42it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.55it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.76it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 16.94it/s]04/21/2024 16:19:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:19:38 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37970719979984185, 'eval_loss': 0.90503466, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [620, 971, 1002, 1098, 953, 919, 688, 534, 335, 193, 256, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 6, 3, 4, 3, 2, 1], 'pruned_params': 67850008, 'remaining_params': 17167592, 'pruned_model_sparsity': 0.7980701407708521, 'expected_sparsity': 0.79245, 'target_sparsity': 0.95, 'step': 7200}


Iteration:  87%|████████▋ | 232/268 [00:40<00:26,  1.36it/s][A04/21/2024 16:19:38 - INFO - trainer.trainer_mod - v4 Global step: 7200, Alignment: tensor([ 4,  7,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:40<00:19,  1.80it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:14,  2.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:11,  2.94it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:08,  3.59it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:07,  4.14it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:06,  4.80it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:05,  5.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:04,  5.91it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:04,  6.33it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  6.67it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  6.94it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.01it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.16it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.06it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.18it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.11it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.23it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.26it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.16it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.31it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.31it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.30it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.47it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.46it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.48it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.46it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.55it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.58it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.60it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.48it/s][A04/21/2024 16:19:43 - INFO - trainer.trainer_mod - Epoch 26 finished. Took 45.54 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.89it/s]
Epoch:  27%|██▋       | 27/100 [20:56<56:11, 46.18s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.66it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.67it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.64it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.58it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.57it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.33it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.49it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 16:19:45,479 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:19:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:19:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:19:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:19:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:19:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:19:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38271077502257855, 'eval_loss': 0.88804644, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [616, 970, 995, 1092, 948, 914, 685, 533, 334, 193, 255, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 6, 3, 4, 3, 2, 1], 'pruned_params': 67900564, 'remaining_params': 17117036, 'pruned_model_sparsity': 0.7986647941132189, 'expected_sparsity': 0.79361, 'target_sparsity': 0.95, 'step': 7250}


Iteration:   5%|▌         | 14/268 [00:03<03:06,  1.36it/s][A
Iteration:   6%|▌         | 15/268 [00:03<02:19,  1.81it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:47,  2.35it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:24,  2.98it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:08,  3.66it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:57,  4.34it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:49,  5.05it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:43,  5.73it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:40,  6.15it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.55it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.87it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:35,  6.85it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:34,  7.08it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.15it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.21it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.32it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.65it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.67it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.46it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.37it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.53it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.57it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.72it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.67it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.67it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.35it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.69it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.67it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.50it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.49it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.46it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.64it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.58it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.53it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.61it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.65it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.55it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.35it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.23it/s][A[INFO|trainer.py:570] 2024-04-21 16:19:54,082 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:19:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:19:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:19:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:19:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.89it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.09it/s]04/21/2024 16:19:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:19:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3496254088060252, 'eval_loss': 0.9665044, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [612, 969, 988, 1085, 944, 909, 681, 530, 333, 192, 255, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 6, 3, 4, 3, 2, 1], 'pruned_params': 67955716, 'remaining_params': 17061884, 'pruned_model_sparsity': 0.7993135068503463, 'expected_sparsity': 0.79492, 'target_sparsity': 0.95, 'step': 7300}


Iteration:  24%|██▍       | 64/268 [00:12<02:28,  1.37it/s][A04/21/2024 16:19:56 - INFO - trainer.trainer_mod - v4 Global step: 7300, Alignment: tensor([ 1,  2,  8, 10], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:12<01:51,  1.83it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<01:25,  2.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<01:07,  2.98it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:54,  3.64it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:45,  4.33it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:40,  4.95it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:35,  5.52it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:32,  6.11it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.47it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.63it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.79it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  6.94it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.17it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.26it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.39it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.60it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.61it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:23,  7.80it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:23,  7.77it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.49it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.39it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.34it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.60it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.48it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.72it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.69it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.68it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.55it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.39it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.20it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.30it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.29it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.23it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.41it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.50it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.65it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.79it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.58it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:20:02,698 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:20:02 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:20:02 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:20:02 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:20:02 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:20:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:20:04 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3366917730011535, 'eval_loss': 0.94817954, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [608, 968, 981, 1079, 940, 904, 678, 529, 331, 192, 254, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 6, 3, 4, 3, 2, 1], 'pruned_params': 68006272, 'remaining_params': 17011328, 'pruned_model_sparsity': 0.799908160192713, 'expected_sparsity': 0.79625, 'target_sparsity': 0.95, 'step': 7350}


Iteration:  43%|████▎     | 114/268 [00:21<01:51,  1.38it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<01:24,  1.82it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<01:04,  2.35it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:51,  2.95it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:41,  3.61it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:34,  4.30it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:29,  5.00it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:26,  5.57it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:24,  6.03it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.78it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  7.04it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.23it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.21it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.46it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.48it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.50it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.33it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.39it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.50it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.58it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.57it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.44it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.69it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.67it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.51it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.36it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.37it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.33it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.46it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.42it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.47it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.43it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.38it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.10it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.28it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.48it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.75it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.85it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.78it/s][A[INFO|trainer.py:570] 2024-04-21 16:20:11,325 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:20:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:20:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:20:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:20:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.87it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:20:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:20:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.352519256043119, 'eval_loss': 0.78233624, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [604, 967, 975, 1072, 936, 900, 675, 527, 329, 192, 254, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 6, 3, 4, 3, 2, 1], 'pruned_params': 68055296, 'remaining_params': 16962304, 'pruned_model_sparsity': 0.8004847937368262, 'expected_sparsity': 0.79783, 'target_sparsity': 0.95, 'step': 7400}


Iteration:  61%|██████    | 164/268 [00:29<01:15,  1.38it/s][A04/21/2024 16:20:13 - INFO - trainer.trainer_mod - v4 Global step: 7400, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:29<00:56,  1.84it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:42,  2.39it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:33,  3.02it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:27,  3.68it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:22,  4.35it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:20,  4.88it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:17,  5.46it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:16,  5.99it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:14,  6.41it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:13,  6.74it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.90it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.13it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.14it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.30it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.39it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.47it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.60it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.63it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.63it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.67it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.65it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.63it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:09,  7.74it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.60it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.62it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.63it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.63it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.62it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.58it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.73it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.54it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.57it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.60it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.64it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.66it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.61it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.48it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.49it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.55it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.45it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.47it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.37it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:20:19,904 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:20:19 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:20:19 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:20:19 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:20:19 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.83it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.87it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:20:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:20:21 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39745362806120205, 'eval_loss': 0.8358846, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [600, 966, 969, 1066, 932, 896, 672, 525, 328, 192, 253, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 6, 3, 4, 3, 2, 1], 'pruned_params': 68102788, 'remaining_params': 16914812, 'pruned_model_sparsity': 0.801043407482686, 'expected_sparsity': 0.7991, 'target_sparsity': 0.95, 'step': 7450}


Iteration:  80%|███████▉  | 214/268 [00:38<00:39,  1.38it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:29,  1.83it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:22,  2.36it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:17,  2.98it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:13,  3.68it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:11,  4.34it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:09,  5.00it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:08,  5.25it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:07,  5.77it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:07,  6.22it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  6.49it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  6.72it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:06,  6.93it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.06it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.25it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.34it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.45it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.58it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.46it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.53it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.50it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.56it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.59it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.25it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.53it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.48it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.37it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.44it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.46it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.16it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.27it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.37it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.35it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.46it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.56it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.56it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.44it/s][A[INFO|trainer.py:570] 2024-04-21 16:20:28,604 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:20:28 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:20:28 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:20:28 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:20:28 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.83it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.05it/s]04/21/2024 16:20:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:20:30 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4194617148915591, 'eval_loss': 0.7822201, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [597, 965, 963, 1061, 928, 892, 670, 523, 326, 192, 252, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 6, 3, 4, 3, 2, 1], 'pruned_params': 68147216, 'remaining_params': 16870384, 'pruned_model_sparsity': 0.8015659816320385, 'expected_sparsity': 0.80033, 'target_sparsity': 0.95, 'step': 7500}


Iteration:  99%|█████████▊| 264/268 [00:46<00:02,  1.37it/s][A04/21/2024 16:20:30 - INFO - trainer.trainer_mod - v4 Global step: 7500, Alignment: tensor([ 0,  1,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:47<00:01,  1.81it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  2.33it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  2.94it/s][A04/21/2024 16:20:31 - INFO - trainer.trainer_mod - Epoch 27 finished. Took 47.48 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.64it/s]
Epoch:  28%|██▊       | 28/100 [21:44<55:53, 46.57s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.69it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.61it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.28it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.41it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.48it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.48it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.44it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.27it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.46it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.66it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.65it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.66it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:32,  7.68it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.06it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.33it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:35,  7.06it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.25it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.26it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.40it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.26it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.30it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:33,  7.30it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.42it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.62it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.64it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.44it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.27it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.66it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:29,  7.78it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.52it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.29it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.46it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.48it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:06<00:28,  7.71it/s][A[INFO|trainer.py:570] 2024-04-21 16:20:37,269 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:20:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:20:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:20:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:20:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:20:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:20:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40942096590221383, 'eval_loss': 0.75419843, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [593, 964, 957, 1055, 924, 888, 666, 522, 325, 191, 252, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68586900, 'remaining_params': 16430700, 'pruned_model_sparsity': 0.806737663730804, 'expected_sparsity': 0.80127, 'target_sparsity': 0.95, 'step': 7550}


Iteration:  17%|█▋        | 46/268 [00:08<02:41,  1.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:02,  1.81it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:33,  2.35it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:14,  2.94it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:00,  3.61it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:50,  4.29it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:43,  4.95it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:38,  5.53it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:35,  5.99it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:32,  6.50it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:31,  6.79it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.05it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:29,  7.19it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.59it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.73it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.71it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.66it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.46it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.64it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.44it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:27,  7.22it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.62it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.60it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.64it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.83it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:23,  7.81it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.60it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.62it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.42it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.46it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:24,  7.34it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.50it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.47it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:23,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:20:45,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:20:45 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:20:45 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:20:45 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:20:45 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.87it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:20:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:20:47 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3773118498171989, 'eval_loss': 0.90327376, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [590, 963, 952, 1049, 921, 884, 664, 520, 324, 191, 251, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68628264, 'remaining_params': 16389336, 'pruned_model_sparsity': 0.8072241982836496, 'expected_sparsity': 0.80204, 'target_sparsity': 0.95, 'step': 7600}


Iteration:  36%|███▌      | 96/268 [00:16<02:05,  1.38it/s][A04/21/2024 16:20:47 - INFO - trainer.trainer_mod - v4 Global step: 7600, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:16<01:33,  1.82it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<01:11,  2.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:56,  2.98it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:46,  3.64it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:38,  4.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:33,  4.96it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:29,  5.61it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:26,  6.21it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:25,  6.39it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:23,  6.83it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.22it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.33it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.30it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.58it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.48it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.44it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.58it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.51it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.55it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.60it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.57it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.55it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.61it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.57it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:19,  7.38it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:19,  7.34it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.53it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.55it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.59it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.55it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.58it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.55it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.54it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.51it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:20:54,470 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:20:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:20:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:20:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:20:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:20:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:20:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3740512162075218, 'eval_loss': 0.89187837, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [587, 962, 946, 1043, 917, 880, 661, 518, 322, 191, 250, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68675756, 'remaining_params': 16341844, 'pruned_model_sparsity': 0.8077828120295092, 'expected_sparsity': 0.80283, 'target_sparsity': 0.95, 'step': 7650}


Iteration:  54%|█████▍    | 146/268 [00:25<01:28,  1.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<01:06,  1.82it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:50,  2.36it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:39,  2.98it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:32,  3.64it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:27,  4.32it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:23,  4.93it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:20,  5.51it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:19,  5.94it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:17,  6.31it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:17,  6.54it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:16,  6.84it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.08it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.14it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.26it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.27it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.49it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.58it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.59it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.53it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.56it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.60it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.54it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.58it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.79it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.73it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.56it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.58it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.43it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.52it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.53it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.71it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.71it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.82it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.71it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.50it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.45it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.43it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.52it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.54it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.60it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:09,  7.75it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:09,  7.73it/s][A
Iteration:  72%|███████▏  | 194/268 [00:31<00:09,  7.70it/s][A
Iteration:  73%|███████▎  | 195/268 [00:31<00:09,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:21:03,059 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:21:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:21:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:21:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:21:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.81it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.87it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.05it/s]04/21/2024 16:21:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:21:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3773118498171989, 'eval_loss': 0.9388538, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [583, 961, 941, 1037, 914, 876, 658, 516, 320, 191, 249, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68721716, 'remaining_params': 16295884, 'pruned_model_sparsity': 0.8083234059771153, 'expected_sparsity': 0.80373, 'target_sparsity': 0.95, 'step': 7700}


Iteration:  73%|███████▎  | 196/268 [00:33<00:52,  1.37it/s][A04/21/2024 16:21:05 - INFO - trainer.trainer_mod - v4 Global step: 7700, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:34<00:39,  1.81it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:29,  2.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:23,  2.97it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:18,  3.61it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:15,  4.26it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:13,  4.92it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:11,  5.49it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:10,  5.91it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:09,  6.33it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:09,  6.58it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  6.90it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.09it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.15it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.32it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.44it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.38it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.44it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.39it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.47it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.36it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.57it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.53it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.55it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.54it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.59it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.79it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.73it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.61it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.63it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.61it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.50it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:05,  7.39it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.21it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.32it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.32it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.52it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.50it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.56it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.62it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.57it/s][A
Iteration:  90%|█████████ | 242/268 [00:40<00:03,  7.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.38it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.27it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 16:21:11,723 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:21:11 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:21:11 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:21:11 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:21:11 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:21:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:21:13 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39573142544458445, 'eval_loss': 0.724782, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [580, 960, 936, 1032, 910, 872, 656, 515, 319, 191, 248, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68761548, 'remaining_params': 16256052, 'pruned_model_sparsity': 0.8087919207317074, 'expected_sparsity': 0.8045, 'target_sparsity': 0.95, 'step': 7750}


Iteration:  92%|█████████▏| 246/268 [00:42<00:16,  1.37it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:11,  1.81it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:08,  2.35it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:06,  2.96it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:05,  3.60it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:03,  4.27it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:03,  4.93it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  5.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:02,  5.91it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:02,  6.13it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  6.41it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  6.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  6.75it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  6.97it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.30it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.43it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.63it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.64it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.47it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.27it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.39it/s][A04/21/2024 16:21:16 - INFO - trainer.trainer_mod - Epoch 28 finished. Took 45.55 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.88it/s]
Epoch:  29%|██▉       | 29/100 [22:29<54:44, 46.27s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.43it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.65it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.65it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.46it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.35it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.32it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.49it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.54it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.55it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.68it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.65it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.44it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.64it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.68it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.67it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.65it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.65it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.56it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.47it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:21:20,355 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:21:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:21:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:21:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:21:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:21:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:21:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.369870679490583, 'eval_loss': 0.81443125, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [577, 959, 930, 1027, 907, 868, 653, 513, 317, 190, 247, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68807508, 'remaining_params': 16210092, 'pruned_model_sparsity': 0.8093325146793134, 'expected_sparsity': 0.80559, 'target_sparsity': 0.95, 'step': 7800}


Iteration:  10%|█         | 28/268 [00:05<02:54,  1.38it/s][A04/21/2024 16:21:22 - INFO - trainer.trainer_mod - v4 Global step: 7800, Alignment: tensor([ 4,  7,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:05<02:11,  1.81it/s][A
Iteration:  11%|█         | 30/268 [00:05<01:43,  2.31it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:21,  2.92it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:05,  3.58it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:55,  4.22it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:48,  4.86it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:42,  5.45it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:39,  5.80it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:37,  6.20it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:34,  6.57it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.01it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.20it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.17it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.32it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.23it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.33it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.52it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.43it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.47it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.34it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.43it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.39it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.23it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.37it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.37it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.32it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.37it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.48it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.54it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.45it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.56it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.54it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.57it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.53it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.59it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.54it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.57it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.61it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:21:29,060 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:21:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:21:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:21:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:21:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.87it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.08it/s]04/21/2024 16:21:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:21:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3747952386175926, 'eval_loss': 0.9672999, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [574, 958, 925, 1021, 903, 864, 651, 511, 316, 190, 246, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68850404, 'remaining_params': 16167196, 'pruned_model_sparsity': 0.8098370690304125, 'expected_sparsity': 0.80723, 'target_sparsity': 0.95, 'step': 7850}


Iteration:  29%|██▉       | 78/268 [00:14<02:18,  1.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:43,  1.82it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<01:19,  2.36it/s][A
Iteration:  30%|███       | 81/268 [00:14<01:02,  2.98it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:51,  3.64it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:43,  4.26it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:37,  4.89it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:32,  5.60it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:30,  6.06it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:27,  6.48it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.79it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:25,  7.04it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.18it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.19it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.16it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.55it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.45it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.20it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.50it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.58it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.57it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.44it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.57it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.63it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.61it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.75it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.72it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.64it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.50it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:19,  7.75it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.68it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.56it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.70it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.68it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.64it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:18,  7.76it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.69it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.65it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.32it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:19,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 16:21:37,648 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:21:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:21:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:21:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:21:37 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.90it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.08it/s]04/21/2024 16:21:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:21:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3964131900128417, 'eval_loss': 0.87227833, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [571, 957, 919, 1015, 899, 861, 648, 509, 315, 190, 246, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68893300, 'remaining_params': 16124300, 'pruned_model_sparsity': 0.8103416233815116, 'expected_sparsity': 0.80849, 'target_sparsity': 0.95, 'step': 7900}


Iteration:  48%|████▊     | 128/268 [00:22<01:41,  1.38it/s][A04/21/2024 16:21:39 - INFO - trainer.trainer_mod - v4 Global step: 7900, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:23<01:16,  1.82it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:58,  2.36it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:45,  3.00it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:37,  3.66it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:31,  4.30it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:27,  4.95it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:24,  5.46it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:22,  5.98it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:20,  6.34it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.70it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.60it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.71it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.98it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.09it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:17,  7.23it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.53it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.58it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.45it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.71it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.66it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:14,  7.78it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.73it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.55it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.23it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.25it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.48it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.47it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.53it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.58it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.60it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.61it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.57it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.52it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.55it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.35it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.28it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.46it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.53it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.38it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.39it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:21:46,315 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:21:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:21:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:21:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:21:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.87it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:21:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:21:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4061962871709606, 'eval_loss': 0.87917596, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [569, 955, 915, 1009, 896, 857, 646, 508, 314, 190, 245, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68930068, 'remaining_params': 16087532, 'pruned_model_sparsity': 0.8107740985395965, 'expected_sparsity': 0.80925, 'target_sparsity': 0.95, 'step': 7950}


Iteration:  66%|██████▋   | 178/268 [00:31<01:05,  1.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:48,  1.82it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:37,  2.37it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:28,  3.02it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:23,  3.72it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:19,  4.40it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:16,  5.06it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:14,  5.64it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:13,  6.20it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:12,  6.55it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  6.74it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:11,  7.11it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.23it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.31it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.43it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.49it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.55it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.60it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.64it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:08,  7.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.63it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.53it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.62it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.77it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.47it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.56it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.62it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.58it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.61it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.52it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.41it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.47it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.56it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.36it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.29it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.52it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.45it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.34it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.40it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.44it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.46it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  6.93it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:06,  7.04it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.23it/s][A
Iteration:  84%|████████▍ | 226/268 [00:38<00:05,  7.16it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.08it/s][A[INFO|trainer.py:570] 2024-04-21 16:21:54,954 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:21:54 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:21:54 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:21:54 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:21:54 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.80it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.05it/s]04/21/2024 16:21:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:21:56 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39252769826868733, 'eval_loss': 0.9225398, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [566, 954, 910, 1004, 892, 853, 643, 506, 313, 190, 245, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 68971432, 'remaining_params': 16046168, 'pruned_model_sparsity': 0.811260633092442, 'expected_sparsity': 0.81004, 'target_sparsity': 0.95, 'step': 8000}


Iteration:  85%|████████▌ | 228/268 [00:40<00:29,  1.36it/s][A04/21/2024 16:21:56 - INFO - trainer.trainer_mod - v4 Global step: 8000, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:40<00:21,  1.80it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:16,  2.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:12,  2.96it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:09,  3.62it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:08,  4.29it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:06,  4.94it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:05,  5.52it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:05,  6.15it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  6.56it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  6.98it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.03it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.21it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.26it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.31it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.41it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.40it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.48it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.40it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.60it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.54it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.58it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.58it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.57it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.52it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.70it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.89it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.57it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:45<00:00,  7.51it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.37it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.37it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.43it/s][A04/21/2024 16:22:02 - INFO - trainer.trainer_mod - Epoch 29 finished. Took 45.54 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.89it/s]
Epoch:  30%|███       | 30/100 [23:15<53:43, 46.05s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.30it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.65it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.80it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.42it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.38it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:22:03,519 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:22:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:22:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:22:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:22:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:22:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:22:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3889821098967852, 'eval_loss': 0.8511653, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [563, 953, 905, 999, 889, 850, 641, 505, 312, 190, 244, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 69008200, 'remaining_params': 16009400, 'pruned_model_sparsity': 0.811693108250527, 'expected_sparsity': 0.81081, 'target_sparsity': 0.95, 'step': 8050}


Iteration:   4%|▎         | 10/268 [00:03<03:12,  1.34it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:22,  1.80it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:49,  2.35it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:25,  2.98it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:09,  3.65it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:58,  4.30it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:50,  5.03it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:44,  5.58it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:41,  6.06it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.47it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  6.93it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.12it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.25it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.05it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.07it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.24it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.36it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.46it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.50it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.49it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.49it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.44it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.49it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:30,  7.67it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:29,  7.86it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:29,  7.77it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.53it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.56it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.55it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.55it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.58it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.09it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.14it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.27it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.61it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.61it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.64it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.77it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.77it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.88it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:27,  7.84it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.90it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.84it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.78it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.77it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:26,  7.87it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.61it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 16:22:12,073 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:22:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:22:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:22:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:22:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.83it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.05it/s]04/21/2024 16:22:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:22:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3982431900151971, 'eval_loss': 0.97015405, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [560, 951, 900, 994, 885, 846, 639, 504, 310, 190, 244, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 69048032, 'remaining_params': 15969568, 'pruned_model_sparsity': 0.812161623005119, 'expected_sparsity': 0.81153, 'target_sparsity': 0.95, 'step': 8100}


Iteration:  22%|██▏       | 60/268 [00:11<02:31,  1.38it/s][A04/21/2024 16:22:14 - INFO - trainer.trainer_mod - v4 Global step: 8100, Alignment: tensor([ 6,  7,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:53,  1.82it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:26,  2.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:09,  2.96it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:56,  3.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:47,  4.28it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:40,  4.93it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:36,  5.53it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:32,  6.07it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:30,  6.44it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:29,  6.74it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  7.01it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.32it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.38it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:25,  7.53it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.57it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.38it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.23it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:26,  7.13it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:25,  7.26it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:25,  7.39it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.36it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.26it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.47it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.57it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.60it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.65it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.80it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.76it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.58it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.33it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.30it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.52it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.57it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.42it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.56it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.59it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:22:20,713 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:22:20 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:22:20 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:22:20 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:22:20 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.80it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.05it/s]04/21/2024 16:22:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:22:22 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3762843529965962, 'eval_loss': 0.91892344, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [558, 950, 896, 989, 882, 843, 636, 502, 309, 190, 244, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 69083268, 'remaining_params': 15934332, 'pruned_model_sparsity': 0.8125760783649503, 'expected_sparsity': 0.81209, 'target_sparsity': 0.95, 'step': 8150}


Iteration:  41%|████      | 110/268 [00:20<01:55,  1.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<01:26,  1.82it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<01:05,  2.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:51,  3.02it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:41,  3.71it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:34,  4.38it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:30,  4.98it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:27,  5.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:25,  5.96it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:23,  6.36it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.67it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.10it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.22it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.32it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.40it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.64it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.69it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.70it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.61it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.53it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.46it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.51it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.39it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.38it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.41it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.49it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.71it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.66it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.67it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:15,  7.77it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:15,  7.76it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.74it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.71it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.57it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.51it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.59it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.63it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.65it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.75it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.67it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.64it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 16:22:29,250 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:22:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:22:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:22:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:22:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:22:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:22:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.42108781728525657, 'eval_loss': 0.8835139, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [555, 949, 891, 984, 878, 839, 634, 501, 308, 189, 244, 146], 'head_nums': [6, 6, 4, 5, 8, 8, 5, 3, 4, 2, 2, 1], 'pruned_params': 69123100, 'remaining_params': 15894500, 'pruned_model_sparsity': 0.8130445931195424, 'expected_sparsity': 0.81285, 'target_sparsity': 0.95, 'step': 8200}


Iteration:  60%|█████▉    | 160/268 [00:29<01:18,  1.38it/s][A04/21/2024 16:22:31 - INFO - trainer.trainer_mod - v4 Global step: 8200, Alignment: tensor([ 6,  7,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:29<00:59,  1.81it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:45,  2.35it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:35,  2.97it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:28,  3.63it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:24,  4.22it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:21,  4.79it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:18,  5.41it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:16,  5.92it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:15,  6.35it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.69it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.88it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.06it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.07it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.46it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:11,  7.71it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.45it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.49it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.47it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.34it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.45it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.57it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.62it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.60it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.40it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.53it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.19it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.31it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.59it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.62it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.39it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.48it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.54it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.45it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.47it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.24it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.26it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  6.92it/s][A[INFO|trainer.py:570] 2024-04-21 16:22:37,982 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:22:37 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:22:37 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:22:37 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:22:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.08it/s]04/21/2024 16:22:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:22:39 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37001238174729834, 'eval_loss': 0.9069113, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [553, 947, 886, 979, 875, 836, 632, 499, 307, 189, 243, 146], 'head_nums': [6, 6, 4, 4, 8, 8, 5, 2, 4, 2, 2, 1], 'pruned_params': 69355964, 'remaining_params': 15661636, 'pruned_model_sparsity': 0.8157836024540801, 'expected_sparsity': 0.81358, 'target_sparsity': 0.95, 'step': 8250}


Iteration:  78%|███████▊  | 210/268 [00:37<00:42,  1.36it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:31,  1.81it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:23,  2.35it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:18,  2.96it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:15,  3.58it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:12,  4.25it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:10,  4.83it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:09,  5.36it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:08,  5.97it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.36it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:07,  6.71it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.96it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  6.92it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.25it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.34it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.41it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.38it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.45it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.28it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.27it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.43it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.21it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.44it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.35it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.40it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.47it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.51it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.58it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.61it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.47it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.51it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.74it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.58it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.61it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.48it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.54it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.31it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:22:46,659 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:22:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:22:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:22:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:22:46 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.87it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:22:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:22:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4062251681307222, 'eval_loss': 0.83094096, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [550, 946, 882, 973, 872, 833, 630, 498, 306, 189, 243, 146], 'head_nums': [6, 6, 4, 4, 8, 8, 5, 2, 4, 2, 2, 1], 'pruned_params': 69391200, 'remaining_params': 15626400, 'pruned_model_sparsity': 0.8161980578139115, 'expected_sparsity': 0.8144, 'target_sparsity': 0.95, 'step': 8300}


Iteration:  97%|█████████▋| 260/268 [00:46<00:05,  1.37it/s][A04/21/2024 16:22:48 - INFO - trainer.trainer_mod - v4 Global step: 8300, Alignment: tensor([ 1,  2,  8, 10], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:46<00:03,  1.82it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:02,  2.36it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:01,  2.95it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:01,  3.62it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  4.29it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  4.90it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  5.49it/s][A04/21/2024 16:22:49 - INFO - trainer.trainer_mod - Epoch 30 finished. Took 47.49 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.64it/s]
Epoch:  31%|███       | 31/100 [24:02<53:27, 46.48s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.66it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.30it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.42it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.50it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:38,  6.87it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.13it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:36,  7.17it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.30it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.55it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.36it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.46it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.33it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.62it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.74it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.73it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.71it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.69it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.54it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.47it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.43it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.47it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.53it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.42it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.45it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:30,  7.69it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:30,  7.80it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:30,  7.64it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.67it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.77it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.65it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.57it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:29,  7.75it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:29,  7.73it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:29,  7.79it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:29,  7.77it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 16:22:55,245 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:22:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:22:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:22:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:22:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.85it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:22:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:22:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37937514113428183, 'eval_loss': 0.87911725, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [547, 945, 877, 969, 869, 830, 628, 496, 305, 189, 243, 146], 'head_nums': [6, 6, 4, 4, 8, 8, 5, 2, 4, 2, 2, 1], 'pruned_params': 69426436, 'remaining_params': 15591164, 'pruned_model_sparsity': 0.8166125131737428, 'expected_sparsity': 0.81496, 'target_sparsity': 0.95, 'step': 8350}


Iteration:  16%|█▌        | 42/268 [00:07<02:44,  1.38it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<02:02,  1.83it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:34,  2.36it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<01:14,  2.97it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:01,  3.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:52,  4.23it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:45,  4.87it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:40,  5.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:36,  5.97it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:34,  6.31it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:31,  6.81it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.02it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.06it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.40it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.53it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.72it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:26,  7.74it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.82it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.76it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.62it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.54it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.61it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.60it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.62it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.41it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.60it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:24,  7.69it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.81it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.25it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.39it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.47it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.40it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.44it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.53it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.62it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.63it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.62it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:23:03,829 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:23:03 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:23:03 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:23:03 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:23:03 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.87it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.07it/s]04/21/2024 16:23:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:23:05 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3573595140412857, 'eval_loss': 1.0000198, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [545, 943, 873, 964, 866, 827, 626, 495, 304, 189, 243, 146], 'head_nums': [6, 6, 4, 4, 8, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 69654704, 'remaining_params': 15362896, 'pruned_model_sparsity': 0.81929746311352, 'expected_sparsity': 0.81569, 'target_sparsity': 0.95, 'step': 8400}


Iteration:  34%|███▍      | 92/268 [00:16<02:07,  1.38it/s][A04/21/2024 16:23:05 - INFO - trainer.trainer_mod - v4 Global step: 8400, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:35,  1.83it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<01:13,  2.37it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:58,  2.95it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:47,  3.62it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:39,  4.29it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:34,  4.95it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:30,  5.54it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:27,  6.06it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:26,  6.40it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:25,  6.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:24,  6.71it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:23,  6.85it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:22,  7.10it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.35it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.44it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.53it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.56it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.60it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.42it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.37it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.31it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.50it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.44it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.53it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.53it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.58it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.61it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.43it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.48it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.53it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.44it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.57it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.46it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.63it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.66it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.63it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.62it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.59it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:16,  7.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.45it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:23:12,475 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:23:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:23:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:23:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:23:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.08it/s]04/21/2024 16:23:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:23:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39745362806120205, 'eval_loss': 0.8416795, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [543, 942, 869, 960, 863, 824, 624, 493, 303, 189, 242, 146], 'head_nums': [6, 6, 4, 4, 8, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 69688408, 'remaining_params': 15329192, 'pruned_model_sparsity': 0.8196938986750979, 'expected_sparsity': 0.81666, 'target_sparsity': 0.95, 'step': 8450}


Iteration:  53%|█████▎    | 142/268 [00:24<01:31,  1.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<01:08,  1.82it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:52,  2.35it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:41,  2.97it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:33,  3.61it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:28,  4.29it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:24,  4.94it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:21,  5.52it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:19,  5.99it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:18,  6.39it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:17,  6.75it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  7.01it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:16,  7.07it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.34it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.42it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.46it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.25it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.37it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.43it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.61it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.60it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.30it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.55it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.55it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.55it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.62it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.62it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:13,  7.24it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.52it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.57it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.55it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.55it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.46it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.55it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.65it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.76it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.63it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.63it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.62it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 16:23:21,109 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:23:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:23:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:23:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:23:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.89it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.11it/s]04/21/2024 16:23:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:23:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3549012373122867, 'eval_loss': 0.8838516, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [540, 940, 864, 955, 861, 821, 622, 491, 302, 189, 242, 146], 'head_nums': [6, 6, 4, 4, 8, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 69723644, 'remaining_params': 15293956, 'pruned_model_sparsity': 0.8201083540349292, 'expected_sparsity': 0.81792, 'target_sparsity': 0.95, 'step': 8500}


Iteration:  72%|███████▏  | 192/268 [00:33<00:55,  1.38it/s][A04/21/2024 16:23:23 - INFO - trainer.trainer_mod - v4 Global step: 8500, Alignment: tensor([ 4,  7,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:33<00:41,  1.82it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:31,  2.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:24,  2.95it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:19,  3.63it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:16,  4.28it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:14,  4.93it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:12,  5.51it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:11,  6.02it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:10,  6.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:09,  6.60it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:09,  6.80it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:09,  6.87it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.08it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.25it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.27it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:08,  7.19it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.34it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.40it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.47it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.55it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.42it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.43it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.42it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.23it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.22it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.36it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.46it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.51it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.44it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.46it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.55it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.47it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.37it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.66it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.67it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.39it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:39<00:04,  7.53it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.59it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.52it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.52it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.56it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:23:29,792 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:23:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:23:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:23:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:23:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.82it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:23:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:23:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3928456704665347, 'eval_loss': 0.8760769, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [538, 939, 860, 950, 858, 817, 619, 489, 300, 189, 241, 146], 'head_nums': [6, 6, 4, 4, 8, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 69763476, 'remaining_params': 15254124, 'pruned_model_sparsity': 0.8205768687895212, 'expected_sparsity': 0.81965, 'target_sparsity': 0.95, 'step': 8550}


Iteration:  90%|█████████ | 242/268 [00:42<00:18,  1.38it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:13,  1.81it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:10,  2.37it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:07,  2.96it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:06,  3.61it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:04,  4.31it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:04,  4.96it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:03,  5.50it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  6.09it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  6.50it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  6.82it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  6.83it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.07it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.65it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.61it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.61it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.65it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.77it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.74it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.68it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.65it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.67it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.69it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.60it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.59it/s][A04/21/2024 16:23:35 - INFO - trainer.trainer_mod - Epoch 31 finished. Took 45.48 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.89it/s]
Epoch:  32%|███▏      | 32/100 [24:48<52:20, 46.18s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.31it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.45it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.36it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.52it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.59it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.64it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.56it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.56it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.51it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.35it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.35it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.50it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.69it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.71it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.48it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.43it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:23:38,342 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:23:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:23:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:23:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:23:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.80it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.06it/s]04/21/2024 16:23:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:23:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.374958568308545, 'eval_loss': 0.9003094, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [536, 937, 856, 946, 855, 814, 617, 488, 299, 189, 241, 146], 'head_nums': [6, 6, 4, 4, 8, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 69794116, 'remaining_params': 15223484, 'pruned_model_sparsity': 0.8209372647545919, 'expected_sparsity': 0.8212, 'target_sparsity': 0.95, 'step': 8600}


Iteration:   9%|▉         | 24/268 [00:05<02:57,  1.37it/s][A04/21/2024 16:23:40 - INFO - trainer.trainer_mod - v4 Global step: 8600, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:13,  1.82it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:42,  2.36it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:21,  2.96it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:06,  3.64it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:55,  4.32it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:47,  5.02it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:42,  5.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:39,  5.94it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:36,  6.37it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.71it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  6.97it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.15it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.24it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.39it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.33it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.19it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.22it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.34it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.28it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.36it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.43it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.32it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.30it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.35it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.26it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.23it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.35it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.42it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.55it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.55it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.32it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.43it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.50it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.56it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.52it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.67it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:25,  7.69it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.89it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.82it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.54it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.70it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 16:23:46,996 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:23:46 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:23:46 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:23:46 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:23:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.82it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.05it/s]04/21/2024 16:23:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:23:48 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3738415333970797, 'eval_loss': 0.94053525, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [535, 935, 852, 943, 852, 811, 615, 487, 298, 189, 241, 146], 'head_nums': [6, 6, 4, 4, 8, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 69821692, 'remaining_params': 15195908, 'pruned_model_sparsity': 0.8212616211231557, 'expected_sparsity': 0.82362, 'target_sparsity': 0.95, 'step': 8650}


Iteration:  28%|██▊       | 74/268 [00:13<02:22,  1.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<01:46,  1.81it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<01:21,  2.34it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:04,  2.96it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:53,  3.54it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:44,  4.22it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:38,  4.87it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:34,  5.44it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:31,  5.95it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:28,  6.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.75it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  6.96it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.96it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:26,  6.91it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:25,  7.12it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.39it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.39it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.33it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.39it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.77it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:21,  7.74it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:21,  7.73it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.72it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.76it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.59it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.41it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.50it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.52it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.50it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.44it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.50it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.43it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.27it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.16it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:21,  7.30it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.33it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.50it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.58it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.51it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.54it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:23:55,676 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:23:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:23:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:23:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:23:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:23:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:23:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3840902665419466, 'eval_loss': 0.69335103, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [532, 933, 848, 940, 850, 809, 614, 486, 297, 189, 240, 146], 'head_nums': [6, 6, 4, 4, 8, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71289348, 'remaining_params': 13728252, 'pruned_model_sparsity': 0.8385245878500451, 'expected_sparsity': 0.82694, 'target_sparsity': 0.95, 'step': 8700}


Iteration:  46%|████▋     | 124/268 [00:22<01:44,  1.38it/s][A04/21/2024 16:23:57 - INFO - trainer.trainer_mod - v4 Global step: 8700, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:22<01:17,  1.83it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:59,  2.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:47,  2.99it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:38,  3.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:32,  4.30it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:28,  4.84it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:25,  5.42it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:22,  5.94it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:21,  6.37it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:20,  6.68it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.95it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:18,  7.06it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  7.08it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.16it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.31it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.23it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.25it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.36it/s][A
Iteration:  53%|█████▎    | 143/268 [00:25<00:16,  7.46it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.64it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.89it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.70it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.67it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.51it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.69it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.72it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.64it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.76it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.60it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.79it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.67it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:13,  7.79it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.69it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.50it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.56it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.49it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.51it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.58it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.56it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.40it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.31it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.41it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.47it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:24:04,271 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:24:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:24:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:24:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:24:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:24:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:24:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3714926317628813, 'eval_loss': 0.9474257, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [530, 931, 844, 938, 846, 806, 611, 484, 295, 189, 240, 146], 'head_nums': [6, 6, 4, 4, 8, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71319988, 'remaining_params': 13697612, 'pruned_model_sparsity': 0.8388849838151159, 'expected_sparsity': 0.8298, 'target_sparsity': 0.95, 'step': 8750}


Iteration:  65%|██████▍   | 174/268 [00:31<01:08,  1.38it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:50,  1.83it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:38,  2.37it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:31,  2.93it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:25,  3.59it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:20,  4.27it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:17,  4.91it/s][A
Iteration:  68%|██████▊   | 181/268 [00:32<00:16,  5.42it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:14,  5.80it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:13,  6.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.63it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  6.92it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.12it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.25it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.38it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.58it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.61it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.54it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.76it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.73it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.69it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.71it/s][A
Iteration:  73%|███████▎  | 196/268 [00:34<00:09,  7.44it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.35it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.41it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.60it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.59it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.66it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.65it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.47it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.54it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.56it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.62it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.56it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.57it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.58it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.57it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.70it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.70it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.65it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.51it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.58it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.81it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.76it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:07,  7.10it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:07,  7.00it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.23it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.28it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:24:12,901 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:24:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:24:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:24:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:24:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:24:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:24:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36677168221902623, 'eval_loss': 0.9848675, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [529, 929, 841, 936, 844, 803, 609, 483, 294, 188, 240, 146], 'head_nums': [6, 6, 4, 4, 8, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71341436, 'remaining_params': 13676164, 'pruned_model_sparsity': 0.8391372609906654, 'expected_sparsity': 0.83137, 'target_sparsity': 0.95, 'step': 8800}


Iteration:  84%|████████▎ | 224/268 [00:39<00:31,  1.38it/s][A04/21/2024 16:24:14 - INFO - trainer.trainer_mod - v4 Global step: 8800, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:39<00:23,  1.82it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:17,  2.36it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:13,  2.98it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:11,  3.61it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:09,  4.25it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:07,  4.88it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:06,  5.41it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:06,  6.00it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:05,  6.51it/s][A
Iteration:  87%|████████▋ | 234/268 [00:41<00:04,  6.84it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.05it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.25it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.37it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.45it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.30it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.41it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.58it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.64it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.59it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.60it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:43<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.72it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.74it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.84it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.77it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.77it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.69it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.80it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.74it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.72it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.74it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.70it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.81it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.66it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.67it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.56it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.49it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.09it/s][A04/21/2024 16:24:20 - INFO - trainer.trainer_mod - Epoch 32 finished. Took 45.47 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.89it/s]
Epoch:  33%|███▎      | 33/100 [25:33<51:19, 45.97s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.73it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.92it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.67it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.66it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.94it/s][A[INFO|trainer.py:570] 2024-04-21 16:24:21,388 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:24:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:24:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:24:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:24:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:24:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:24:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37295439300651745, 'eval_loss': 0.95221746, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [527, 928, 837, 935, 841, 800, 607, 482, 292, 188, 239, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71369012, 'remaining_params': 13648588, 'pruned_model_sparsity': 0.8394616173592292, 'expected_sparsity': 0.83272, 'target_sparsity': 0.95, 'step': 8850}


Iteration:   2%|▏         | 6/268 [00:02<03:29,  1.25it/s][A
Iteration:   3%|▎         | 7/268 [00:02<02:31,  1.72it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:53,  2.28it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:28,  2.92it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:10,  3.64it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:59,  4.30it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:51,  4.95it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:46,  5.53it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:41,  6.07it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:39,  6.47it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:37,  6.76it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:35,  7.03it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.24it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:33,  7.34it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.23it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.34it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.35it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:32,  7.49it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:31,  7.68it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.56it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:31,  7.63it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:31,  7.59it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.61it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.56it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.59it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:30,  7.66it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.66it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.55it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.55it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.55it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.56it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.49it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.54it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.54it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.70it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.70it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.67it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.63it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:28,  7.79it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.76it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.64it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.50it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.55it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.49it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.54it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 16:24:29,942 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:24:29 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:24:29 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:24:29 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:24:29 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.89it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.91it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.13it/s]04/21/2024 16:24:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:24:31 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3604656141863881, 'eval_loss': 0.9587455, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [526, 926, 834, 934, 838, 797, 605, 481, 291, 188, 239, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71390460, 'remaining_params': 13627140, 'pruned_model_sparsity': 0.8397138945347786, 'expected_sparsity': 0.83363, 'target_sparsity': 0.95, 'step': 8900}


Iteration:  21%|██        | 56/268 [00:11<02:33,  1.38it/s][A04/21/2024 16:24:31 - INFO - trainer.trainer_mod - v4 Global step: 8900, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:11<01:55,  1.83it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<01:29,  2.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:09,  2.99it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:56,  3.66it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:48,  4.27it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:41,  4.91it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:38,  5.27it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:35,  5.81it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:32,  6.24it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:30,  6.62it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.90it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:28,  7.09it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.34it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.73it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.75it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:24,  7.74it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:24,  7.70it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.62it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.54it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.40it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.36it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.45it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:25,  7.34it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.45it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.40it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.35it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.52it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.62it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.57it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.51it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:22,  7.69it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.45it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.48it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.64it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.45it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.33it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.30it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.56it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.69it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.68it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.57it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:20,  7.77it/s][A[INFO|trainer.py:570] 2024-04-21 16:24:38,540 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:24:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:24:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:24:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:24:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.92it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.11it/s]04/21/2024 16:24:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:24:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3972655223454204, 'eval_loss': 0.8798117, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [525, 924, 831, 934, 836, 794, 603, 480, 290, 188, 239, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71410376, 'remaining_params': 13607224, 'pruned_model_sparsity': 0.8399481519120747, 'expected_sparsity': 0.83446, 'target_sparsity': 0.95, 'step': 8950}


Iteration:  40%|███▉      | 106/268 [00:19<01:57,  1.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:27,  1.83it/s][A
Iteration:  40%|████      | 108/268 [00:20<01:07,  2.39it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:52,  3.01it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:42,  3.68it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:36,  4.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:31,  5.01it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:27,  5.57it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:25,  6.08it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.68it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  6.94it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  7.06it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.26it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.19it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.80it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.04it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.26it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.36it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.36it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.27it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.20it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.27it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.51it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.53it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.54it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.53it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.58it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.59it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.62it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.58it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.56it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.50it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.34it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.42it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.39it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.60it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.62it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.62it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.63it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:24:47,170 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:24:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:24:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:24:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:24:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.00it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:24:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:24:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40200223868227586, 'eval_loss': 0.79956275, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [523, 922, 828, 933, 833, 791, 601, 478, 289, 188, 239, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71434888, 'remaining_params': 13582712, 'pruned_model_sparsity': 0.8402364686841313, 'expected_sparsity': 0.83524, 'target_sparsity': 0.95, 'step': 9000}


Iteration:  58%|█████▊    | 156/268 [00:28<01:20,  1.39it/s][A04/21/2024 16:24:49 - INFO - trainer.trainer_mod - v4 Global step: 9000, Alignment: tensor([ 1,  7,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:28<01:00,  1.83it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:46,  2.36it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:36,  3.00it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:29,  3.67it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:24,  4.34it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:21,  4.99it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:18,  5.56it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:16,  6.14it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.82it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  6.91it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.22it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.44it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.45it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.42it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.34it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.52it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.47it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.58it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.70it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.67it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.68it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:10,  7.81it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.77it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.57it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.49it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.67it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.47it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.53it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.54it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.71it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.71it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.51it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.55it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.47it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.50it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.42it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.38it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.47it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.65it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.66it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.44it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:24:55,734 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:24:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:24:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:24:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:24:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.92it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:24:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:24:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3573595140412857, 'eval_loss': 0.9535387, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [521, 920, 824, 933, 831, 788, 599, 477, 289, 188, 239, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71456336, 'remaining_params': 13561264, 'pruned_model_sparsity': 0.8404887458596808, 'expected_sparsity': 0.83594, 'target_sparsity': 0.95, 'step': 9050}


Iteration:  77%|███████▋  | 206/268 [00:37<00:44,  1.38it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:33,  1.82it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:25,  2.33it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:20,  2.95it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:16,  3.60it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:13,  4.32it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:11,  4.96it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:09,  5.62it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:08,  6.15it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:08,  6.44it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  6.76it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.02it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.19it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.97it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.15it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.27it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.31it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.44it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.41it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.41it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.49it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.56it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.53it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.71it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.50it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.31it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.21it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.24it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.40it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.56it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.42it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.47it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.52it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.58it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.58it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.42it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.49it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.73it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.67it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.83it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.74it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.55it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.71it/s][A[INFO|trainer.py:570] 2024-04-21 16:25:04,355 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:25:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:25:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:25:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:25:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.12it/s]04/21/2024 16:25:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:25:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38512055344294677, 'eval_loss': 0.8584848, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [520, 918, 821, 932, 828, 786, 597, 476, 288, 188, 238, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71477784, 'remaining_params': 13539816, 'pruned_model_sparsity': 0.8407410230352304, 'expected_sparsity': 0.83648, 'target_sparsity': 0.95, 'step': 9100}


Iteration:  96%|█████████▌| 256/268 [00:45<00:08,  1.39it/s][A04/21/2024 16:25:06 - INFO - trainer.trainer_mod - v4 Global step: 9100, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:45<00:05,  1.84it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:04,  2.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:02,  3.01it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:02,  3.64it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  4.33it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:01,  4.97it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  5.39it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  5.75it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.15it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  6.47it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  6.81it/s][A04/21/2024 16:25:07 - INFO - trainer.trainer_mod - Epoch 33 finished. Took 47.3 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  34%|███▍      | 34/100 [26:21<51:00, 46.37s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  7.02it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.41it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.59it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.65it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.65it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.63it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.62it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.60it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.76it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.74it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.73it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.61it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.42it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.47it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.41it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.49it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.53it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.54it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.60it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.40it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.42it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.53it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.58it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.52it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.53it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:30,  7.78it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.48it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.59it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.54it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.58it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:25:12,950 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:25:12 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:25:12 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:25:12 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:25:12 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:25:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:25:14 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36184579111803034, 'eval_loss': 0.789641, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [518, 916, 819, 932, 826, 783, 595, 475, 287, 188, 238, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71497700, 'remaining_params': 13519900, 'pruned_model_sparsity': 0.8409752804125263, 'expected_sparsity': 0.83692, 'target_sparsity': 0.95, 'step': 9150}


Iteration:  14%|█▍        | 38/268 [00:07<02:46,  1.38it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:05,  1.83it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:36,  2.36it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:15,  3.01it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:01,  3.65it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:51,  4.34it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:45,  4.98it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:40,  5.56it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:36,  6.14it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.85it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.99it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.17it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.35it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.43it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.33it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.60it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.66it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.69it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.61it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.67it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.58it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.63it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.55it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.47it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.50it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.57it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.74it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.60it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.34it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.41it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.47it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.43it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.55it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.59it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.57it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.61it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.63it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.63it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.60it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.61it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.82it/s][A[INFO|trainer.py:570] 2024-04-21 16:25:21,504 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:25:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:25:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:25:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:25:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:25:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:25:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3472635288979699, 'eval_loss': 1.0633162, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [516, 914, 815, 932, 824, 780, 594, 474, 286, 188, 238, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71519148, 'remaining_params': 13498452, 'pruned_model_sparsity': 0.8412275575880759, 'expected_sparsity': 0.83739, 'target_sparsity': 0.95, 'step': 9200}


Iteration:  33%|███▎      | 88/268 [00:15<02:09,  1.39it/s][A04/21/2024 16:25:23 - INFO - trainer.trainer_mod - v4 Global step: 9200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:15<01:37,  1.84it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<01:14,  2.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:59,  2.99it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:47,  3.69it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:40,  4.36it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:35,  4.92it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:31,  5.56it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:28,  6.01it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:27,  6.30it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:25,  6.63it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.92it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.10it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.23it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.37it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.59it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.64it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.65it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.64it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.55it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.57it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.58it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.61it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.59it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.48it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.36it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.57it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.47it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.53it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.45it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.33it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.42it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.39it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:20,  6.95it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:19,  7.06it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:19,  7.25it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.37it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.36it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.41it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:18,  7.10it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.40it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.43it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 16:25:30,166 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:25:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:25:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:25:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:25:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:25:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:25:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3629573913728164, 'eval_loss': 0.85443145, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [515, 912, 812, 931, 821, 778, 592, 473, 286, 188, 237, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71539064, 'remaining_params': 13478536, 'pruned_model_sparsity': 0.8414618149653719, 'expected_sparsity': 0.8378, 'target_sparsity': 0.95, 'step': 9250}


Iteration:  51%|█████▏    | 138/268 [00:24<01:34,  1.37it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<01:10,  1.82it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:54,  2.37it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:42,  2.96it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:34,  3.63it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:28,  4.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:25,  4.92it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:22,  5.52it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:20,  6.02it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:18,  6.42it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:17,  6.85it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.10it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:16,  7.25it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:16,  7.30it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.45it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.56it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.58it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.62it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.67it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.57it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.57it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.56it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.59it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.57it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:14,  7.16it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.25it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.17it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.28it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.21it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:13,  7.36it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.57it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.51it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.66it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.49it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.70it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.66it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.52it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.57it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:25:38,775 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:25:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:25:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:25:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:25:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.91it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.13it/s]04/21/2024 16:25:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:25:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3728512069258359, 'eval_loss': 0.8624043, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [513, 909, 809, 931, 820, 775, 591, 472, 285, 188, 237, 146], 'head_nums': [6, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71557448, 'remaining_params': 13460152, 'pruned_model_sparsity': 0.8416780525444143, 'expected_sparsity': 0.83815, 'target_sparsity': 0.95, 'step': 9300}


Iteration:  70%|███████   | 188/268 [00:32<00:57,  1.39it/s][A04/21/2024 16:25:40 - INFO - trainer.trainer_mod - v4 Global step: 9300, Alignment: tensor([ 0,  3,  8, 10], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:32<00:42,  1.84it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:32,  2.37it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:25,  2.99it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:20,  3.64it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:17,  4.33it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:14,  5.03it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:13,  5.61it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:11,  6.13it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  6.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:10,  6.99it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.27it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.39it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.48it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.59it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.59it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.62it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.52it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.58it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.52it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.53it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.61it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.64it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.66it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.66it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.67it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.68it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.60it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.63it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.54it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.55it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.58it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.54it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.46it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.34it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.45it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.34it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:05,  7.35it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.40it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.51it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:25:47,342 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:25:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:25:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:25:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:25:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:25:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:25:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3380661613082518, 'eval_loss': 1.0721079, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [511, 907, 807, 931, 818, 773, 589, 471, 285, 188, 237, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71770396, 'remaining_params': 13247204, 'pruned_model_sparsity': 0.8441828045016562, 'expected_sparsity': 0.83851, 'target_sparsity': 0.95, 'step': 9350}


Iteration:  89%|████████▉ | 238/268 [00:41<00:21,  1.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:15,  1.82it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:11,  2.36it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:09,  2.95it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:07,  3.62it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:05,  4.34it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:04,  5.00it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:04,  5.60it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  6.10it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  6.83it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.09it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.16it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.34it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.58it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.59it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.63it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.65it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.67it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.51it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.53it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.52it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.43it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.68it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.64it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.74it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.66it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.71it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.68it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.66it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.23it/s][A04/21/2024 16:25:53 - INFO - trainer.trainer_mod - Epoch 34 finished. Took 45.29 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  35%|███▌      | 35/100 [27:06<49:52, 46.04s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.82it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.45it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.56it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.45it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.45it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.49it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.52it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.38it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.62it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.64it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:32,  7.78it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.72it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:32,  7.73it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.68it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.81it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:31,  7.92it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:31,  7.88it/s][A[INFO|trainer.py:570] 2024-04-21 16:25:55,821 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:25:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:25:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:25:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:25:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:25:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:25:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3432606327845655, 'eval_loss': 0.94495004, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [510, 905, 804, 930, 815, 770, 588, 470, 284, 188, 236, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71791844, 'remaining_params': 13225756, 'pruned_model_sparsity': 0.8444350816772057, 'expected_sparsity': 0.8389, 'target_sparsity': 0.95, 'step': 9400}


Iteration:   7%|▋         | 20/268 [00:04<02:58,  1.39it/s][A04/21/2024 16:25:57 - INFO - trainer.trainer_mod - v4 Global step: 9400, Alignment: tensor([ 1,  3,  8, 10], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:14,  1.84it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:43,  2.37it/s][A
Iteration:   9%|▊         | 23/268 [00:04<01:21,  2.99it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:06,  3.67it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:55,  4.35it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:48,  4.97it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:43,  5.49it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:39,  6.02it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:37,  6.44it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:36,  6.46it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:35,  6.74it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  6.95it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  7.06it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.73it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.56it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.59it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.00it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.24it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.38it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.51it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.38it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.46it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.31it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.28it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.39it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.44it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.49it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.74it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.75it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.47it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.56it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.62it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.49it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.73it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.64it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.64it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.60it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.34it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.36it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:26:04,473 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:26:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:26:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:26:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:26:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.13it/s]04/21/2024 16:26:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:26:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3694171254720073, 'eval_loss': 0.8816837, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [509, 902, 801, 930, 813, 768, 586, 469, 284, 188, 236, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71808696, 'remaining_params': 13208904, 'pruned_model_sparsity': 0.8446332994579946, 'expected_sparsity': 0.83927, 'target_sparsity': 0.95, 'step': 9450}


Iteration:  26%|██▌       | 70/268 [00:13<02:23,  1.38it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:47,  1.83it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<01:22,  2.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<01:05,  2.99it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:52,  3.66it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:44,  4.38it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:38,  4.98it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:34,  5.46it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:31,  5.98it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.33it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.68it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.87it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:26,  7.07it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:25,  7.18it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.39it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.47it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.70it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.60it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.66it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.51it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.53it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.51it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.57it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.61it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.55it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.70it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.59it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.64it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.56it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.31it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.41it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.38it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.36it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.41it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.47it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.40it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:26:13,091 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:26:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:26:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:26:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:26:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:26:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:26:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3490763804757191, 'eval_loss': 1.0686765, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [507, 900, 798, 930, 811, 765, 584, 468, 284, 188, 236, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71828612, 'remaining_params': 13188988, 'pruned_model_sparsity': 0.8448675568352906, 'expected_sparsity': 0.83965, 'target_sparsity': 0.95, 'step': 9500}


Iteration:  45%|████▍     | 120/268 [00:21<01:47,  1.38it/s][A04/21/2024 16:26:15 - INFO - trainer.trainer_mod - v4 Global step: 9500, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:21<01:20,  1.83it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<01:01,  2.38it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:48,  3.00it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:39,  3.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:33,  4.33it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:28,  4.93it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:25,  5.60it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:23,  6.08it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.80it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.02it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:19,  7.11it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.16it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.42it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.51it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.75it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:16,  7.72it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.54it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.60it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.77it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.75it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.74it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.76it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:15,  7.86it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.63it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.64it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.47it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.66it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.72it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.82it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.74it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.59it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.62it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.65it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.77it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.75it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.73it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.48it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.48it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:26:21,608 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:26:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:26:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:26:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:26:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:26:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:26:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3786836037420869, 'eval_loss': 0.88599664, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [506, 898, 796, 929, 809, 763, 582, 467, 283, 188, 236, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71845464, 'remaining_params': 13172136, 'pruned_model_sparsity': 0.8450657746160795, 'expected_sparsity': 0.84001, 'target_sparsity': 0.95, 'step': 9550}


Iteration:  63%|██████▎   | 170/268 [00:30<01:10,  1.39it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:52,  1.84it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:40,  2.36it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:32,  2.92it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:26,  3.59it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:21,  4.33it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:18,  4.90it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:16,  5.39it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:15,  5.91it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:14,  6.25it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:13,  6.62it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.02it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.12it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.31it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.37it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.34it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.29it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.31it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.54it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.68it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.66it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.79it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.73it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.73it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.68it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.66it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.66it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.66it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.25it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.20it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.29it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.35it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.43it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.35it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.55it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.60it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.79it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.87it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  8.01it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.88it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.95it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.81it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:06,  7.73it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.53it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.74it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.69it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.68it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:26:30,193 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:26:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:26:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:26:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:26:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:26:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:26:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.361285146113674, 'eval_loss': 0.9025557, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [505, 895, 794, 929, 806, 761, 581, 465, 283, 188, 235, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71863848, 'remaining_params': 13153752, 'pruned_model_sparsity': 0.845282012195122, 'expected_sparsity': 0.84035, 'target_sparsity': 0.95, 'step': 9600}


Iteration:  82%|████████▏ | 220/268 [00:38<00:34,  1.38it/s][A04/21/2024 16:26:32 - INFO - trainer.trainer_mod - v4 Global step: 9600, Alignment: tensor([ 1,  7,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:39<00:25,  1.83it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:19,  2.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:15,  2.99it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:12,  3.66it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:09,  4.34it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:08,  4.93it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:07,  5.52it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:06,  6.11it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:06,  6.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  6.64it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.93it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.14it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.15it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.17it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.26it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.66it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.69it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.70it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.68it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.64it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.62it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:02,  7.77it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.61it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.51it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.68it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.56it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.54it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.59it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.41it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.32it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.39it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.45it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.47it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.30it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.59it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.74it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.73it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.52it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.42it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.47it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.02it/s][A04/21/2024 16:26:38 - INFO - trainer.trainer_mod - Epoch 35 finished. Took 45.29 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  36%|███▌      | 36/100 [27:51<48:52, 45.82s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:26:38,763 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:26:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:26:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:26:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:26:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:26:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:26:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3787953243004096, 'eval_loss': 0.8307258, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [503, 892, 791, 928, 804, 759, 580, 464, 283, 188, 235, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71880700, 'remaining_params': 13136900, 'pruned_model_sparsity': 0.8454802299759109, 'expected_sparsity': 0.8408, 'target_sparsity': 0.95, 'step': 9650}


Iteration:   1%|          | 2/268 [00:02<05:44,  1.29s/it][A
Iteration:   1%|          | 3/268 [00:02<03:22,  1.31it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:15,  1.95it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:38,  2.67it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:16,  3.42it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:02,  4.17it/s][A
Iteration:   3%|▎         | 8/268 [00:03<00:53,  4.87it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:47,  5.48it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:42,  6.01it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:39,  6.43it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:37,  6.75it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:36,  6.91it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:35,  7.10it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:34,  7.23it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:34,  7.34it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:34,  7.32it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.26it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:33,  7.35it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:33,  7.43it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.38it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.43it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.63it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.49it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.48it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:31,  7.59it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:31,  7.54it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.49it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.30it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.41it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.37it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.43it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.48it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.52it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:29,  7.77it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:29,  7.79it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.74it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.70it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.70it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.48it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.64it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.65it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.51it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.57it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.80it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.76it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.75it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.72it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:26:47,345 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:26:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:26:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:26:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:26:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 16:26:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:26:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3509417839484213, 'eval_loss': 1.0888035, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [502, 890, 789, 928, 802, 757, 578, 463, 282, 187, 235, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71899084, 'remaining_params': 13118516, 'pruned_model_sparsity': 0.8456964675549533, 'expected_sparsity': 0.84122, 'target_sparsity': 0.95, 'step': 9700}


Iteration:  19%|█▉        | 52/268 [00:10<02:36,  1.38it/s][A04/21/2024 16:26:49 - INFO - trainer.trainer_mod - v4 Global step: 9700, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:10<01:57,  1.83it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:30,  2.37it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:11,  2.99it/s][A
Iteration:  21%|██        | 56/268 [00:11<00:58,  3.61it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:49,  4.26it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:42,  4.92it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:38,  5.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:34,  5.95it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:32,  6.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:30,  6.68it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:30,  6.70it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:29,  6.87it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:28,  7.08it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:27,  7.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:26,  7.46it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:26,  7.46it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:25,  7.77it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.12it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:27,  7.09it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.27it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.49it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.43it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.45it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.53it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.47it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.49it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:23,  7.73it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:23,  7.73it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.58it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.61it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.65it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.77it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.71it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.74it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:22,  7.73it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:22,  7.69it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.86it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.83it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.76it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.72it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.60it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.55it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.59it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.62it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.67it/s][A[INFO|trainer.py:570] 2024-04-21 16:26:55,928 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:26:55 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:26:55 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:26:55 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:26:55 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:26:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:26:57 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40034234133166496, 'eval_loss': 0.7218466, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [501, 887, 786, 927, 801, 755, 577, 462, 282, 187, 235, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71912872, 'remaining_params': 13104728, 'pruned_model_sparsity': 0.8458586457392352, 'expected_sparsity': 0.84165, 'target_sparsity': 0.95, 'step': 9750}


Iteration:  38%|███▊      | 102/268 [00:19<01:59,  1.39it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<01:29,  1.84it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<01:09,  2.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:54,  3.00it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:44,  3.62it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:37,  4.29it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:32,  4.94it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:29,  5.41it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:26,  5.93it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.31it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.68it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.97it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:21,  7.12it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  7.21it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:20,  7.22it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.29it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:19,  7.52it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:19,  7.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:19,  7.56it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.44it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.62it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:18,  7.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:18,  7.67it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:18,  7.68it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.71it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.71it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.68it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.23it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.30it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.28it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.18it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.31it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.39it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.38it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.34it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.45it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.49it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.44it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.54it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.39it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.51it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.56it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.43it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:27:04,564 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:27:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:27:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:27:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:27:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:27:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:27:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4028076174767321, 'eval_loss': 0.81337106, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [499, 884, 783, 927, 799, 752, 575, 461, 282, 187, 234, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71934320, 'remaining_params': 13083280, 'pruned_model_sparsity': 0.8461109229147847, 'expected_sparsity': 0.8421, 'target_sparsity': 0.95, 'step': 9800}


Iteration:  57%|█████▋    | 152/268 [00:28<01:23,  1.39it/s][A04/21/2024 16:27:06 - INFO - trainer.trainer_mod - v4 Global step: 9800, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:28<01:02,  1.84it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:48,  2.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:37,  2.99it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:30,  3.69it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:25,  4.29it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:22,  4.93it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:19,  5.48it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:17,  6.06it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.50it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.85it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.04it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.34it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.35it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.04it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.20it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.36it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.43it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:12,  7.64it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:12,  7.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.55it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.58it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.61it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.59it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.42it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.46it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.44it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.50it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.45it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.40it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.48it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.51it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.47it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.28it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.38it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.45it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.41it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.34it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.31it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.54it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.44it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:27:13,214 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:27:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:27:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:27:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:27:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.92it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:27:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:27:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3314112125378819, 'eval_loss': 0.96939206, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [498, 881, 780, 927, 797, 750, 574, 460, 281, 187, 234, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71951172, 'remaining_params': 13066428, 'pruned_model_sparsity': 0.8463091406955736, 'expected_sparsity': 0.8426, 'target_sparsity': 0.95, 'step': 9850}


Iteration:  75%|███████▌  | 202/268 [00:36<00:48,  1.37it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:35,  1.82it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:27,  2.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:37<00:21,  2.96it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:17,  3.63it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:14,  4.32it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:12,  4.98it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:10,  5.57it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:09,  6.07it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:08,  6.75it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  7.10it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.18it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.27it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.14it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.22it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.23it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.26it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.56it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:05,  7.56it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.71it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.70it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.82it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.90it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.84it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:04,  7.82it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:04,  7.92it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.74it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.70it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.69it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.67it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.64it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.47it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.28it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.43it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.52it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.61it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.60it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.68it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.60it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.55it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.58it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 16:27:21,772 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:27:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:27:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:27:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:27:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:27:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:27:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3617901024526905, 'eval_loss': 0.9106182, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [498, 879, 778, 926, 795, 748, 572, 459, 281, 187, 233, 146], 'head_nums': [5, 6, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71966492, 'remaining_params': 13051108, 'pruned_model_sparsity': 0.846489338678109, 'expected_sparsity': 0.84307, 'target_sparsity': 0.95, 'step': 9900}


Iteration:  94%|█████████▍| 252/268 [00:45<00:11,  1.38it/s][A04/21/2024 16:27:23 - INFO - trainer.trainer_mod - v4 Global step: 9900, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:45<00:08,  1.82it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:05,  2.37it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:04,  2.98it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:03,  3.65it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:02,  4.29it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:02,  5.00it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  5.57it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.00it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.40it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.74it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.00it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.29it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.37it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.47it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.50it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  8.08it/s][A04/21/2024 16:27:25 - INFO - trainer.trainer_mod - Epoch 36 finished. Took 47.32 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  37%|███▋      | 37/100 [28:39<48:34, 46.27s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.72it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.64it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.93it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:32,  8.03it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.71it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.72it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.58it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.35it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.55it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.73it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.71it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.66it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.65it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.69it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.71it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.72it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.72it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.58it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.50it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.58it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.61it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.62it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.62it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.64it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.77it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.63it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:30,  7.78it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.54it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.59it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:27:30,273 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:27:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:27:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:27:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:27:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:27:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:27:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3580290125823658, 'eval_loss': 1.0428936, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [497, 876, 776, 926, 793, 746, 571, 459, 281, 187, 233, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71978748, 'remaining_params': 13038852, 'pruned_model_sparsity': 0.8466334970641373, 'expected_sparsity': 0.84343, 'target_sparsity': 0.95, 'step': 9950}


Iteration:  13%|█▎        | 34/268 [00:06<02:49,  1.38it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:07,  1.83it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:38,  2.36it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<01:17,  2.98it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<01:03,  3.63it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:53,  4.30it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:46,  4.94it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:41,  5.53it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:38,  5.87it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:35,  6.41it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:33,  6.75it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:31,  7.01it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.08it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.16it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.13it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.14it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.27it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.46it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.50it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.53it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.53it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.53it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.35it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.43it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.38it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.59it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.62it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.65it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.66it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.66it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.64it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.69it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.61it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.66it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.57it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.43it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.54it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:24,  7.72it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.57it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.46it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.28it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.35it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.45it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:27:38,895 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:27:38 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:27:38 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:27:38 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:27:38 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:27:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:27:40 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3639324656122657, 'eval_loss': 1.0170451, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [495, 873, 774, 925, 791, 744, 570, 458, 280, 187, 232, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 71997132, 'remaining_params': 13020468, 'pruned_model_sparsity': 0.8468497346431798, 'expected_sparsity': 0.84381, 'target_sparsity': 0.95, 'step': 10000}


Iteration:  31%|███▏      | 84/268 [00:15<02:13,  1.38it/s][A04/21/2024 16:27:40 - INFO - trainer.trainer_mod - v4 Global step: 10000, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:40,  1.83it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<01:17,  2.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:00,  2.97it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:49,  3.64it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:41,  4.31it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:35,  4.97it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:31,  5.57it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:28,  6.09it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.33it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.58it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:25,  6.84it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:24,  7.08it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.24it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.37it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.39it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.50it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.59it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.62it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.15it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.29it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.43it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.40it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.27it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.28it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.37it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.48it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.51it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.68it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.51it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.61it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.57it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.58it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.57it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.56it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.44it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.53it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.55it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:17,  7.71it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.67it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.70it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:27:47,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:27:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:27:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:27:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:27:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.91it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:27:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:27:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3321668227239448, 'eval_loss': 1.0341705, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [494, 870, 772, 924, 790, 742, 569, 457, 280, 187, 232, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 4, 2, 2, 1], 'pruned_params': 72009388, 'remaining_params': 13008212, 'pruned_model_sparsity': 0.846993893029208, 'expected_sparsity': 0.84407, 'target_sparsity': 0.95, 'step': 10050}


Iteration:  50%|█████     | 134/268 [00:23<01:37,  1.38it/s][A
Iteration:  50%|█████     | 135/268 [00:23<01:12,  1.84it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:55,  2.37it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:43,  2.99it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:35,  3.62it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:30,  4.26it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:25,  4.97it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:22,  5.57it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:20,  6.15it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:19,  6.51it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:18,  6.75it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  6.83it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  7.10it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.29it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.50it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.54it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.61it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.62it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.54it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.55it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.47it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.42it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.36it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.41it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.36it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.46it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.50it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.46it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.49it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:14,  7.33it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.55it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.62it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.59it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.54it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.49it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.50it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.44it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.63it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.63it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.42it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.60it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.58it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.61it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.61it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.63it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:27:56,101 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:27:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:27:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:27:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:27:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:27:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:27:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39015788988520905, 'eval_loss': 0.9145832, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [493, 868, 770, 924, 788, 741, 567, 457, 280, 186, 231, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72220804, 'remaining_params': 12796796, 'pruned_model_sparsity': 0.8494806251881963, 'expected_sparsity': 0.84434, 'target_sparsity': 0.95, 'step': 10100}


Iteration:  69%|██████▊   | 184/268 [00:32<01:00,  1.38it/s][A04/21/2024 16:27:58 - INFO - trainer.trainer_mod - v4 Global step: 10100, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:32<00:44,  1.85it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:34,  2.39it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:26,  3.03it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:21,  3.67it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:18,  4.37it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:15,  4.92it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:14,  5.46it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:12,  5.87it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:12,  6.13it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:11,  6.43it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  6.68it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:10,  6.85it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  6.91it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.15it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.29it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.60it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.58it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.79it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.63it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.63it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.40it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.60it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.60it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.66it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.43it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.52it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.59it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.75it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.72it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.90it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:05,  8.02it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.89it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.97it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.80it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.60it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.62it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.62it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.64it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.79it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.62it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:05,  7.04it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.24it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 16:28:04,700 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:28:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:28:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:28:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:28:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:28:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:28:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38035614823798886, 'eval_loss': 0.9193429, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [492, 865, 767, 923, 786, 739, 566, 456, 279, 186, 231, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72237656, 'remaining_params': 12779944, 'pruned_model_sparsity': 0.8496788429689852, 'expected_sparsity': 0.84466, 'target_sparsity': 0.95, 'step': 10150}


Iteration:  87%|████████▋ | 234/268 [00:40<00:24,  1.37it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:18,  1.82it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:13,  2.34it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:10,  2.96it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:08,  3.59it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:06,  4.27it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:05,  4.92it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:04,  5.56it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:04,  6.15it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  6.45it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.75it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  6.90it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.04it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.28it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.69it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.48it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.52it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.59it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.64it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.70it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.66it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.66it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.66it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.64it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.50it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.55it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.51it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.45it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.49it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.68it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.70it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.23it/s][A04/21/2024 16:28:11 - INFO - trainer.trainer_mod - Epoch 37 finished. Took 45.3 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  38%|███▊      | 38/100 [29:24<47:30, 45.98s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:32,  8.31it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.98it/s][A
Iteration:   1%|          | 3/268 [00:00<00:32,  8.06it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.85it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.92it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:32,  7.97it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.83it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.80it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:32,  7.92it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:32,  7.85it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.68it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.67it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.71it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.90it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.67it/s][A[INFO|trainer.py:570] 2024-04-21 16:28:13,172 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:28:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:28:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:28:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:28:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:28:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:28:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3805000111450827, 'eval_loss': 0.9511227, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [490, 861, 765, 922, 783, 737, 565, 455, 279, 186, 231, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72254508, 'remaining_params': 12763092, 'pruned_model_sparsity': 0.8498770607497742, 'expected_sparsity': 0.8449, 'target_sparsity': 0.95, 'step': 10200}


Iteration:   6%|▌         | 16/268 [00:04<03:02,  1.38it/s][A04/21/2024 16:28:15 - INFO - trainer.trainer_mod - v4 Global step: 10200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:17,  1.82it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:45,  2.37it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:24,  2.95it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:08,  3.61it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:57,  4.30it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:49,  4.97it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:43,  5.63it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:39,  6.19it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:36,  6.58it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.76it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  6.93it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.97it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.14it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:33,  7.18it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.28it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.20it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.31it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.44it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.41it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.46it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.44it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.45it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.41it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.23it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.61it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.76it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:27,  7.87it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.78it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.33it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:29,  7.38it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.58it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.61it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.50it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.55it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.19it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.46it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:29,  6.93it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:28,  7.04it/s][A[INFO|trainer.py:570] 2024-04-21 16:28:21,857 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:28:21 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:28:21 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:28:21 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:28:21 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.13it/s]04/21/2024 16:28:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:28:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36663351111692266, 'eval_loss': 1.0103443, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [490, 859, 764, 922, 782, 735, 564, 455, 279, 186, 231, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72262168, 'remaining_params': 12755432, 'pruned_model_sparsity': 0.8499671597410419, 'expected_sparsity': 0.84515, 'target_sparsity': 0.95, 'step': 10250}


Iteration:  25%|██▍       | 66/268 [00:12<02:27,  1.37it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<01:50,  1.81it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<01:25,  2.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:07,  2.93it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:55,  3.60it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:45,  4.29it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:40,  4.87it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:35,  5.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:32,  5.98it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.41it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.76it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  6.92it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.22it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.32it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.39it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.47it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.50it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.46it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.47it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.35it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.34it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.32it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.39it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.37it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.43it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.59it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.62it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.55it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.69it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.68it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.70it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.69it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.58it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.60it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.65it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.62it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.76it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:19,  7.86it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.65it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 16:28:30,468 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:28:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:28:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:28:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:28:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:28:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:28:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3829388732719194, 'eval_loss': 0.9612178, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [489, 856, 761, 921, 779, 733, 562, 455, 278, 186, 230, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72282084, 'remaining_params': 12735516, 'pruned_model_sparsity': 0.8502014171183379, 'expected_sparsity': 0.8455, 'target_sparsity': 0.95, 'step': 10300}


Iteration:  43%|████▎     | 116/268 [00:21<01:50,  1.38it/s][A04/21/2024 16:28:32 - INFO - trainer.trainer_mod - v4 Global step: 10300, Alignment: tensor([ 1,  7,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:21<01:22,  1.84it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<01:02,  2.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:49,  3.01it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:40,  3.69it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:33,  4.38it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:29,  4.99it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:25,  5.65it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:23,  6.07it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:22,  6.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.72it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.95it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.96it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  6.98it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.03it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.20it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.31it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.23it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.37it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.42it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.50it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.44it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.42it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.26it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.30it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.69it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.58it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.57it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.39it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.49it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.52it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.66it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.69it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.70it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:14,  7.77it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.73it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.72it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.69it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.68it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.70it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.62it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.60it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.60it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.39it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.44it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.33it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 16:28:39,064 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:28:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:28:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:28:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:28:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:28:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:28:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3510164570717426, 'eval_loss': 0.91354406, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [487, 852, 759, 921, 777, 731, 560, 454, 278, 186, 230, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72298936, 'remaining_params': 12718664, 'pruned_model_sparsity': 0.8503996348991267, 'expected_sparsity': 0.84582, 'target_sparsity': 0.95, 'step': 10350}


Iteration:  62%|██████▏   | 166/268 [00:29<01:13,  1.38it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:55,  1.82it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:42,  2.36it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:33,  2.98it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:27,  3.63it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:22,  4.35it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:19,  5.02it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:16,  5.60it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:15,  6.10it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:14,  6.64it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.85it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.87it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.06it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.27it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.59it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.74it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.49it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.58it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.60it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.47it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.51it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.57it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.60it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.51it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.62it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.62it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.42it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.46it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.53it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.58it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.45it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.37it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.46it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.56it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.60it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.50it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.39it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.47it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:28:47,653 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:28:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:28:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:28:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:28:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 16:28:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:28:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37123829045278356, 'eval_loss': 0.9508669, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [486, 849, 757, 920, 775, 730, 559, 454, 278, 186, 230, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72309660, 'remaining_params': 12707940, 'pruned_model_sparsity': 0.8505257734869015, 'expected_sparsity': 0.846, 'target_sparsity': 0.95, 'step': 10400}


Iteration:  81%|████████  | 216/268 [00:38<00:37,  1.38it/s][A04/21/2024 16:28:49 - INFO - trainer.trainer_mod - v4 Global step: 10400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:38<00:27,  1.83it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:20,  2.38it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:16,  3.00it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:13,  3.67it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:10,  4.35it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:09,  5.01it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:07,  5.67it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:07,  6.16it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  6.53it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:06,  6.82it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.03it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.17it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.21it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.48it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.61it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.63it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.64it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.52it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.38it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.51it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.53it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.31it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.41it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.46it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.43it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.54it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.46it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.56it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.47it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.61it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.59it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.39it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.45it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.40it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.42it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.69it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.72it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.35it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.37it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.47it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:28:56,242 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:28:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:28:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:28:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:28:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.13it/s]04/21/2024 16:28:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:28:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34435064580910596, 'eval_loss': 0.9973257, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [485, 846, 755, 920, 774, 728, 558, 453, 278, 186, 229, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72323448, 'remaining_params': 12694152, 'pruned_model_sparsity': 0.8506879516711834, 'expected_sparsity': 0.84627, 'target_sparsity': 0.95, 'step': 10450}


Iteration:  99%|█████████▉| 266/268 [00:47<00:01,  1.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  1.82it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  2.41it/s][A04/21/2024 16:28:58 - INFO - trainer.trainer_mod - Epoch 38 finished. Took 47.34 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  39%|███▉      | 39/100 [30:11<47:09, 46.39s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  8.08it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.78it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.94it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.72it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.87it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.62it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.57it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.66it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.58it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.48it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:34,  7.33it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.41it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.51it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.52it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.38it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.39it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.45it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.47it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.70it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.62it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.54it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.60it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.59it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.60it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.65it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.62it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:30,  7.74it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.54it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.46it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.55it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.54it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.57it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:29,  7.63it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.66it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:29,  7.58it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:29,  7.63it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.66it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:29,  7.68it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:28,  7.70it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:28,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:29:04,795 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:29:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:29:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:29:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:29:04 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:29:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:29:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.2995749581321486, 'eval_loss': 1.1723695, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [484, 842, 753, 919, 772, 726, 557, 452, 277, 186, 229, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72338768, 'remaining_params': 12678832, 'pruned_model_sparsity': 0.8508681496537187, 'expected_sparsity': 0.84648, 'target_sparsity': 0.95, 'step': 10500}


Iteration:  18%|█▊        | 48/268 [00:08<02:38,  1.39it/s][A04/21/2024 16:29:06 - INFO - trainer.trainer_mod - v4 Global step: 10500, Alignment: tensor([ 1,  3,  8, 10], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<01:59,  1.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:32,  2.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:12,  3.00it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:58,  3.69it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:48,  4.41it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:42,  5.00it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:38,  5.59it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:35,  5.96it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:33,  6.38it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:31,  6.72it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:29,  7.08it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:29,  7.08it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.22it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.25it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.46it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.39it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.54it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.46it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:28,  6.93it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.30it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.60it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.53it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.59it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.78it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.75it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.46it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.50it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.54it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.63it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:23,  7.84it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.66it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.49it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.63it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.63it/s][A
Iteration:  34%|███▍      | 91/268 [00:13<00:23,  7.66it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.64it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:22,  7.62it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:22,  7.67it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:22,  7.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:14<00:22,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:29:13,384 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:29:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:29:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:29:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:29:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:29:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:29:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3252245307577427, 'eval_loss': 0.94910604, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [483, 839, 751, 918, 770, 724, 555, 451, 277, 186, 229, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72354088, 'remaining_params': 12663512, 'pruned_model_sparsity': 0.8510483476362541, 'expected_sparsity': 0.8467, 'target_sparsity': 0.95, 'step': 10550}


Iteration:  37%|███▋      | 98/268 [00:16<02:03,  1.38it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<01:32,  1.83it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:11,  2.36it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:55,  2.98it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:45,  3.65it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:38,  4.33it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:32,  5.00it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:29,  5.53it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:27,  5.98it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:25,  6.31it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:24,  6.63it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  6.94it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.12it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.16it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:22,  6.95it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.19it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.34it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.46it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.38it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.30it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.41it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:20,  7.34it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.37it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.61it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.75it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.60it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:17,  7.79it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:17,  7.73it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:17,  7.69it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.59it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.58it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.63it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.46it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:18,  7.33it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.41it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.38it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.48it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:16,  7.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.71it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.70it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.63it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.37it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.43it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:16,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:29:22,008 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:29:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:29:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:29:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:29:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.91it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.12it/s]04/21/2024 16:29:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:29:23 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3900481307068223, 'eval_loss': 0.9064615, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [482, 836, 749, 918, 768, 723, 554, 451, 277, 186, 229, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72364812, 'remaining_params': 12652788, 'pruned_model_sparsity': 0.8511744862240289, 'expected_sparsity': 0.84691, 'target_sparsity': 0.95, 'step': 10600}


Iteration:  55%|█████▌    | 148/268 [00:25<01:27,  1.38it/s][A04/21/2024 16:29:24 - INFO - trainer.trainer_mod - v4 Global step: 10600, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:25<01:05,  1.82it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:50,  2.36it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:39,  2.98it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:32,  3.62it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:26,  4.27it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:23,  4.89it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:20,  5.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:19,  5.81it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:17,  6.25it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:16,  6.56it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  6.89it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  6.87it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  7.04it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.20it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.33it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.44it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:14,  7.31it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.39it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.46it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.65it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.62it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.53it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.58it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.39it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.53it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.69it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.66it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.63it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.59it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.48it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.42it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.36it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.65it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.63it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.50it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.69it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.63it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.65it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:09,  7.66it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 194/268 [00:31<00:10,  7.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:31<00:09,  7.48it/s][A
Iteration:  73%|███████▎  | 196/268 [00:31<00:09,  7.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:32<00:09,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:29:30,647 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:29:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:29:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:29:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:29:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:29:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:29:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4063664761456974, 'eval_loss': 0.9151013, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [480, 832, 747, 917, 766, 721, 552, 450, 276, 186, 228, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72384728, 'remaining_params': 12632872, 'pruned_model_sparsity': 0.8514087436013249, 'expected_sparsity': 0.84723, 'target_sparsity': 0.95, 'step': 10650}


Iteration:  74%|███████▍  | 198/268 [00:34<00:50,  1.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:37,  1.83it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:28,  2.38it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:22,  3.00it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:18,  3.66it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:14,  4.35it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:12,  4.93it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:11,  5.58it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:10,  6.08it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:09,  6.50it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:09,  6.67it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  6.82it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:08,  6.97it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.17it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.29it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.39it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.39it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.49it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.67it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.62it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.59it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.76it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.73it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.56it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.59it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.48it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.55it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.62it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.50it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.74it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.68it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.59it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.55it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.55it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.68it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.64it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.58it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.49it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.56it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.46it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.53it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.36it/s][A
Iteration:  92%|█████████▏| 246/268 [00:40<00:02,  7.65it/s][A
Iteration:  92%|█████████▏| 247/268 [00:40<00:02,  7.77it/s][A[INFO|trainer.py:570] 2024-04-21 16:29:39,207 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:29:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:29:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:29:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:29:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.92it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:29:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:29:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4030553918803409, 'eval_loss': 0.9240108, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [479, 829, 745, 916, 764, 719, 551, 449, 276, 186, 228, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72398516, 'remaining_params': 12619084, 'pruned_model_sparsity': 0.8515709217856068, 'expected_sparsity': 0.8475, 'target_sparsity': 0.95, 'step': 10700}


Iteration:  93%|█████████▎| 248/268 [00:42<00:14,  1.39it/s][A04/21/2024 16:29:41 - INFO - trainer.trainer_mod - v4 Global step: 10700, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:42<00:10,  1.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:07,  2.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:05,  2.98it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:04,  3.68it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:03,  4.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:02,  5.01it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:02,  5.60it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  6.17it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  6.55it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  6.86it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.05it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.19it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.25it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.41it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.31it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.01it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.31it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.33it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  7.76it/s][A04/21/2024 16:29:43 - INFO - trainer.trainer_mod - Epoch 39 finished. Took 45.36 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.91it/s]
Epoch:  40%|████      | 40/100 [30:57<46:04, 46.08s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.67it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.91it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.23it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.42it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.52it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.72it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.55it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.55it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.60it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.39it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.36it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.49it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.55it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.50it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.58it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.70it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:31,  7.80it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.77it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.78it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.77it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.75it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.74it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.74it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.71it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.71it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 16:29:47,764 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:29:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:29:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:29:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:29:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:29:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:29:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3952359020227402, 'eval_loss': 0.8740061, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [478, 826, 744, 916, 762, 718, 550, 449, 276, 186, 227, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72409240, 'remaining_params': 12608360, 'pruned_model_sparsity': 0.8516970603733816, 'expected_sparsity': 0.84777, 'target_sparsity': 0.95, 'step': 10750}


Iteration:  11%|█         | 30/268 [00:05<02:52,  1.38it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:08,  1.84it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:39,  2.37it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:19,  2.97it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:04,  3.64it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:53,  4.35it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:46,  5.01it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:41,  5.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:38,  6.03it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.32it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:35,  6.50it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:34,  6.65it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:32,  6.93it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.18it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.33it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.44it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.52it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.99it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.04it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.31it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.26it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.55it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.49it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.54it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.70it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.59it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.41it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.46it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.60it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.60it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.51it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.45it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.44it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.54it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.50it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.54it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.52it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 16:29:56,404 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:29:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:29:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:29:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:29:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:29:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:29:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39015788988520905, 'eval_loss': 0.95345855, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [477, 823, 742, 915, 760, 716, 549, 448, 275, 186, 227, 146], 'head_nums': [5, 5, 4, 4, 7, 7, 5, 2, 3, 2, 2, 1], 'pruned_params': 72424560, 'remaining_params': 12593040, 'pruned_model_sparsity': 0.8518772583559169, 'expected_sparsity': 0.84804, 'target_sparsity': 0.95, 'step': 10800}


Iteration:  30%|██▉       | 80/268 [00:14<02:15,  1.38it/s][A04/21/2024 16:29:58 - INFO - trainer.trainer_mod - v4 Global step: 10800, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:14<01:42,  1.83it/s][A
Iteration:  31%|███       | 82/268 [00:14<01:18,  2.37it/s][A
Iteration:  31%|███       | 83/268 [00:14<01:01,  3.02it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:49,  3.68it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:42,  4.34it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:36,  4.99it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:33,  5.48it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:30,  5.95it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.41it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  6.91it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.09it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.17it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.28it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.48it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.54it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.48it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.63it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.44it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.31it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.24it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.41it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.47it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.70it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.55it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.49it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.55it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.62it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.64it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.46it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.53it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.70it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.70it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.58it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.58it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.63it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.60it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.56it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.57it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:30:04,987 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:30:04 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:30:04 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:30:04 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:30:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:30:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:30:06 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.391243912243602, 'eval_loss': 0.98178136, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [476, 819, 740, 914, 759, 715, 548, 448, 275, 185, 226, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72632912, 'remaining_params': 12384688, 'pruned_model_sparsity': 0.8543279509183981, 'expected_sparsity': 0.8483, 'target_sparsity': 0.95, 'step': 10850}


Iteration:  49%|████▊     | 130/268 [00:23<01:40,  1.38it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<01:14,  1.83it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:57,  2.35it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:45,  2.96it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:36,  3.64it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:30,  4.33it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:26,  5.03it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:23,  5.61it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:21,  6.02it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.53it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:18,  6.80it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.83it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.04it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.25it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.69it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.91it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.87it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.77it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.60it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.64it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.65it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.75it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.74it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.72it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.70it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.64it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.65it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.64it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.65it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.55it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.54it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.56it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.56it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.50it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.57it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.60it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.61it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.57it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.61it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.76it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.74it/s][A[INFO|trainer.py:570] 2024-04-21 16:30:13,511 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:30:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:30:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:30:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:30:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:30:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:30:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36733776473014473, 'eval_loss': 1.0705792, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [475, 817, 739, 914, 757, 713, 547, 447, 275, 185, 226, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72645168, 'remaining_params': 12372432, 'pruned_model_sparsity': 0.8544721093044264, 'expected_sparsity': 0.84858, 'target_sparsity': 0.95, 'step': 10900}


Iteration:  67%|██████▋   | 180/268 [00:31<01:03,  1.38it/s][A04/21/2024 16:30:15 - INFO - trainer.trainer_mod - v4 Global step: 10900, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:31<00:47,  1.83it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:36,  2.37it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:28,  3.00it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:22,  3.67it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:19,  4.32it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:16,  4.96it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:14,  5.55it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:13,  6.06it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:12,  6.56it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:11,  6.73it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.96it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.56it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.44it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.53it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.43it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.49it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.24it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.28it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.43it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.47it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.47it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.50it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.43it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.48it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.48it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.59it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.61it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.64it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.66it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.59it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.54it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.59it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.73it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.68it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.70it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.51it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.69it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 16:30:22,104 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:30:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:30:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:30:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:30:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:30:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:30:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3724067509797974, 'eval_loss': 0.88888735, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [474, 814, 737, 913, 756, 711, 546, 446, 274, 185, 225, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72660488, 'remaining_params': 12357112, 'pruned_model_sparsity': 0.8546523072869617, 'expected_sparsity': 0.84893, 'target_sparsity': 0.95, 'step': 10950}


Iteration:  86%|████████▌ | 230/268 [00:40<00:27,  1.38it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:20,  1.83it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:15,  2.35it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:11,  2.95it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:09,  3.60it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:07,  4.29it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:06,  4.84it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:05,  5.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:05,  5.95it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  6.31it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:04,  6.65it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  6.84it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.06it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.23it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.63it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.49it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.63it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.43it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.43it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.53it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.58it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.74it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.59it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.16it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.30it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.42it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.53it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.71it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.63it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.60it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.72it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.75it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.53it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.10it/s][A04/21/2024 16:30:29 - INFO - trainer.trainer_mod - Epoch 40 finished. Took 45.28 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  41%|████      | 41/100 [31:42<45:04, 45.84s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.72it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.46it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.34it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.43it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.50it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.68it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 16:30:30,701 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:30:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:30:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:30:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:30:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:30:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:30:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37155149802094173, 'eval_loss': 0.7698428, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [473, 811, 736, 912, 754, 709, 545, 445, 274, 185, 225, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72672744, 'remaining_params': 12344856, 'pruned_model_sparsity': 0.8547964656729901, 'expected_sparsity': 0.84912, 'target_sparsity': 0.95, 'step': 11000}


Iteration:   4%|▍         | 12/268 [00:03<03:08,  1.36it/s][A04/21/2024 16:30:32 - INFO - trainer.trainer_mod - v4 Global step: 11000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:20,  1.81it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:48,  2.35it/s][A
Iteration:   6%|▌         | 15/268 [00:03<01:25,  2.94it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:08,  3.66it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:57,  4.34it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:49,  5.00it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:44,  5.60it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:40,  6.09it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:39,  6.32it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:37,  6.48it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:36,  6.66it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.91it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.09it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.23it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.35it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.32it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.40it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.50it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.54it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:30,  7.70it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.66it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.68it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.66it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.69it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:29,  7.82it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:28,  7.90it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.81it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.73it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.60it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.59it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.63it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.47it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.65it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.64it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.39it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.46it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.31it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.53it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.51it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.68it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.67it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:26,  7.79it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.75it/s][A[INFO|trainer.py:570] 2024-04-21 16:30:39,276 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:30:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:30:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:30:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:30:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:30:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:30:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36682471355725066, 'eval_loss': 0.905094, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [472, 807, 734, 911, 753, 708, 543, 445, 274, 185, 224, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72685000, 'remaining_params': 12332600, 'pruned_model_sparsity': 0.8549406240590184, 'expected_sparsity': 0.84946, 'target_sparsity': 0.95, 'step': 11050}


Iteration:  23%|██▎       | 62/268 [00:12<02:29,  1.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:51,  1.84it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<01:25,  2.37it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<01:07,  3.00it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:55,  3.67it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:46,  4.30it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:40,  4.94it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:35,  5.58it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:32,  6.10it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:30,  6.36it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.69it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:28,  6.78it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:27,  7.02it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:27,  7.13it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.27it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.54it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.53it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.57it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.75it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.74it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:23,  7.77it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:23,  7.90it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:23,  7.80it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.78it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.65it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.61it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.54it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.47it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.42it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.38it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:25,  6.92it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:24,  7.05it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:24,  7.04it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:24,  6.85it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:24,  6.93it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.09it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.25it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.30it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.36it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.57it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.61it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.59it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.66it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.55it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:30:47,914 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:30:47 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:30:47 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:30:47 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:30:47 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:30:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:30:49 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3365773234369755, 'eval_loss': 1.0540757, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [470, 804, 733, 910, 751, 706, 542, 444, 274, 185, 223, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72700320, 'remaining_params': 12317280, 'pruned_model_sparsity': 0.8551208220415537, 'expected_sparsity': 0.84983, 'target_sparsity': 0.95, 'step': 11100}


Iteration:  42%|████▏     | 112/268 [00:20<01:52,  1.38it/s][A04/21/2024 16:30:49 - INFO - trainer.trainer_mod - v4 Global step: 11100, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:20<01:24,  1.83it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<01:05,  2.36it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:51,  2.98it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:41,  3.65it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:34,  4.33it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:30,  4.96it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:26,  5.55it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:24,  6.03it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:23,  6.35it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.72it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.90it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  7.04it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  7.09it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.24it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.22it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.34it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.33it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.43it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.63it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.61it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.65it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.63it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.36it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.41it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.45it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.47it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.51it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.68it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.52it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.60it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.77it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:14,  7.76it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.59it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.51it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.56it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.45it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.50it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.57it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.46it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.71it/s][A[INFO|trainer.py:570] 2024-04-21 16:30:56,522 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:30:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:30:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:30:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:30:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.12it/s]04/21/2024 16:30:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:30:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3694171254720073, 'eval_loss': 1.089089, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [470, 801, 731, 909, 749, 704, 542, 443, 273, 185, 222, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72714108, 'remaining_params': 12303492, 'pruned_model_sparsity': 0.8552830002258356, 'expected_sparsity': 0.8501, 'target_sparsity': 0.95, 'step': 11150}


Iteration:  60%|██████    | 162/268 [00:29<01:16,  1.39it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:57,  1.84it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:43,  2.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:34,  2.97it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:27,  3.68it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:23,  4.37it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:20,  4.98it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:17,  5.53it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:16,  5.98it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.49it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.73it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  6.95it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.29it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.40it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.51it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.37it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.46it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.60it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.64it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.60it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.62it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.66it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.46it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.46it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.35it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.63it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.56it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.62it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.50it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.15it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.19it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.21it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.35it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:09,  7.31it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.55it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.56it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.54it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.44it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.52it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.57it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.52it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:31:05,140 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:31:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:31:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:31:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:31:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.13it/s]04/21/2024 16:31:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:31:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3389885306211284, 'eval_loss': 0.9931478, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [469, 798, 730, 909, 747, 703, 541, 442, 273, 185, 222, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72724832, 'remaining_params': 12292768, 'pruned_model_sparsity': 0.8554091388136104, 'expected_sparsity': 0.85043, 'target_sparsity': 0.95, 'step': 11200}


Iteration:  79%|███████▉  | 212/268 [00:38<00:40,  1.38it/s][A04/21/2024 16:31:07 - INFO - trainer.trainer_mod - v4 Global step: 11200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:38<00:30,  1.81it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:22,  2.36it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:17,  2.98it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:14,  3.65it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:11,  4.37it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:09,  5.01it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:08,  5.59it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:08,  5.94it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:07,  6.41it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  6.84it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  6.97it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.08it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.16it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.33it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.54it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.47it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.49it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.56it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.63it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.61it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.58it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.58it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.57it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.44it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.48it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.52it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.70it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.66it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.62it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.52it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.60it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.61it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.76it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.57it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.41it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.38it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.35it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.44it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.51it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.56it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.56it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.72it/s][A[INFO|trainer.py:570] 2024-04-21 16:31:13,730 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:31:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:31:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:31:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:31:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:31:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:31:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3490196502696348, 'eval_loss': 0.9848764, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [468, 795, 729, 908, 746, 701, 540, 442, 273, 185, 221, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72735556, 'remaining_params': 12282044, 'pruned_model_sparsity': 0.8555352774013851, 'expected_sparsity': 0.85075, 'target_sparsity': 0.95, 'step': 11250}


Iteration:  98%|█████████▊| 262/268 [00:46<00:04,  1.38it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:02,  1.83it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:01,  2.37it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:01,  2.99it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  3.64it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  4.28it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.13it/s][A04/21/2024 16:31:16 - INFO - trainer.trainer_mod - Epoch 41 finished. Took 47.37 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  42%|████▏     | 42/100 [32:29<44:45, 46.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.24it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.14it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.04it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.37it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.31it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.19it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.35it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.40it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.46it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.70it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.60it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.59it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.52it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.55it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.60it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.73it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.58it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.63it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.61it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.73it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.55it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.55it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.55it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.56it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.63it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.49it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:30,  7.70it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.61it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:30,  7.61it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.52it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.57it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.58it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.47it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.43it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:31,  7.35it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:31,  7.33it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.46it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:31:22,335 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:31:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:31:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:31:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:31:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:31:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:31:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3563414498340501, 'eval_loss': 0.94892097, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [467, 791, 728, 907, 744, 699, 539, 441, 273, 184, 221, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72749344, 'remaining_params': 12268256, 'pruned_model_sparsity': 0.855697455585667, 'expected_sparsity': 0.85115, 'target_sparsity': 0.95, 'step': 11300}


Iteration:  16%|█▋        | 44/268 [00:07<02:42,  1.38it/s][A04/21/2024 16:31:24 - INFO - trainer.trainer_mod - v4 Global step: 11300, Alignment: tensor([ 1,  3,  8, 10], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:07<02:02,  1.83it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:34,  2.34it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:15,  2.94it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:01,  3.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:51,  4.23it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:44,  4.88it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:39,  5.43it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:36,  5.89it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:34,  6.23it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:34,  6.14it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:32,  6.51it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:31,  6.80it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.14it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.19it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.48it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:27,  7.67it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.64it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.79it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.76it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.71it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.70it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.69it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:25,  7.78it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:25,  7.77it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.86it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.72it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.69it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.70it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.53it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.56it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.59it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.64it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.60it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.83it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.77it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.61it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.65it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.64it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.66it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.62it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.77it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.73it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.69it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:24,  7.29it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.43it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.51it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.48it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:31:30,937 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:31:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:31:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:31:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:31:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.93it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:31:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:31:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3495279845461152, 'eval_loss': 1.0342562, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [466, 788, 726, 906, 742, 698, 538, 441, 273, 184, 220, 146], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72761600, 'remaining_params': 12256000, 'pruned_model_sparsity': 0.8558416139716952, 'expected_sparsity': 0.85155, 'target_sparsity': 0.95, 'step': 11350}


Iteration:  35%|███▌      | 94/268 [00:16<02:06,  1.38it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<01:34,  1.83it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<01:12,  2.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:57,  2.98it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:46,  3.63it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:39,  4.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:34,  4.92it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:30,  5.52it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:27,  5.95it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:25,  6.45it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:24,  6.58it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:23,  6.98it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.74it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.73it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.71it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.73it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.62it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.68it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.69it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.60it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.75it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.69it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:18,  7.90it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.72it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:18,  7.84it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.74it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.71it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:19,  7.40it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.42it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.49it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.47it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.39it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:18,  7.38it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:18,  7.30it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.49it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.53it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:18,  7.21it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.34it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.49it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.43it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 16:31:39,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:31:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:31:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:31:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:31:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:31:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:31:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.32394179731057016, 'eval_loss': 0.98663825, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [465, 785, 724, 905, 740, 696, 537, 440, 272, 184, 220, 145], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72776920, 'remaining_params': 12240680, 'pruned_model_sparsity': 0.8560218119542307, 'expected_sparsity': 0.85195, 'target_sparsity': 0.95, 'step': 11400}


Iteration:  54%|█████▎    | 144/268 [00:25<01:30,  1.37it/s][A04/21/2024 16:31:41 - INFO - trainer.trainer_mod - v4 Global step: 11400, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:25<01:07,  1.82it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:51,  2.35it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:40,  2.97it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:32,  3.64it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:27,  4.29it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:23,  4.99it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:20,  5.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:19,  6.02it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:17,  6.42it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:16,  6.73it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:16,  6.91it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.15it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.32it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.52it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.58it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.62it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.64it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.55it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.37it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:14,  7.21it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.34it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.42it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.42it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.47it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.53it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.52it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.54it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.57it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.59it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.50it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.58it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.57it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.54it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.62it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.66it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.64it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.61it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.82it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.80it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.78it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.71it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.67it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:09,  7.64it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:09,  7.79it/s][A[INFO|trainer.py:570] 2024-04-21 16:31:48,097 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:31:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:31:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:31:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:31:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:31:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:31:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3447208135052164, 'eval_loss': 0.99805176, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [464, 782, 724, 904, 739, 694, 536, 439, 272, 184, 219, 145], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72787644, 'remaining_params': 12229956, 'pruned_model_sparsity': 0.8561479505420054, 'expected_sparsity': 0.85231, 'target_sparsity': 0.95, 'step': 11450}


Iteration:  72%|███████▏  | 194/268 [00:33<00:53,  1.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:39,  1.83it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:30,  2.38it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:23,  3.00it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:19,  3.63it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:16,  4.24it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:14,  4.83it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:12,  5.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:11,  5.96it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:10,  6.22it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:09,  6.56it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:09,  6.84it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:09,  6.88it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.10it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.18it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.19it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.29it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.51it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.54it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.44it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.37it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.47it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.66it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.79it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.66it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.61it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.60it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.51it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.56it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.71it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.57it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.63it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.64it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.64it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.60it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.64it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.62it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.65it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.68it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.70it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.88it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.73it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.82it/s][A[INFO|trainer.py:570] 2024-04-21 16:31:56,704 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:31:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:31:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:31:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:31:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:31:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:31:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3574189041936963, 'eval_loss': 1.0887499, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [464, 779, 722, 903, 737, 693, 535, 439, 272, 184, 219, 145], 'head_nums': [5, 5, 4, 4, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72796836, 'remaining_params': 12220764, 'pruned_model_sparsity': 0.8562560693315266, 'expected_sparsity': 0.85276, 'target_sparsity': 0.95, 'step': 11500}


Iteration:  91%|█████████ | 244/268 [00:42<00:17,  1.38it/s][A04/21/2024 16:31:58 - INFO - trainer.trainer_mod - v4 Global step: 11500, Alignment: tensor([ 1,  3,  8, 10], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:42<00:12,  1.83it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:09,  2.37it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:06,  3.01it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:05,  3.68it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:04,  4.32it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:03,  4.94it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:03,  5.45it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  5.98it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  6.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:02,  6.73it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  6.86it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.09it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.23it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.21it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.25it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.50it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.57it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.45it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.62it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.63it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.62it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.60it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.58it/s][A04/21/2024 16:32:01 - INFO - trainer.trainer_mod - Epoch 42 finished. Took 45.34 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.91it/s]
Epoch:  43%|████▎     | 43/100 [33:15<43:42, 46.01s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.43it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.34it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.39it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.52it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.54it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.57it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:32,  7.81it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.57it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.62it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.58it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.47it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.43it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.50it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.52it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.54it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:32:05,267 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:32:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:32:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:32:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:32:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.01it/s]04/21/2024 16:32:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:32:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3629573913728164, 'eval_loss': 1.0357665, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [463, 776, 721, 902, 736, 692, 534, 438, 272, 184, 219, 145], 'head_nums': [5, 5, 4, 3, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72806028, 'remaining_params': 12211572, 'pruned_model_sparsity': 0.8563641881210479, 'expected_sparsity': 0.85305, 'target_sparsity': 0.95, 'step': 11550}


Iteration:  10%|▉         | 26/268 [00:05<02:56,  1.37it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:12,  1.82it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:41,  2.36it/s][A
Iteration:  11%|█         | 29/268 [00:05<01:20,  2.99it/s][A
Iteration:  11%|█         | 30/268 [00:05<01:06,  3.60it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:54,  4.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:50,  4.71it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:44,  5.28it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:40,  5.72it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:37,  6.14it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:35,  6.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:34,  6.77it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:32,  7.02it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.15it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.33it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.51it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.52it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.18it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.34it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.57it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.62it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.75it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.72it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.71it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:26,  7.82it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.69it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.55it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:26,  7.71it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.72it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.66it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.67it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.64it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.63it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.66it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.67it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:25,  7.82it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.51it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.57it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.71it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.67it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:24,  7.79it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.65it/s][A[INFO|trainer.py:570] 2024-04-21 16:32:13,880 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:32:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:32:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:32:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:32:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:32:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:32:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3683318994242006, 'eval_loss': 0.9491064, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [462, 773, 720, 901, 735, 691, 534, 438, 272, 184, 219, 145], 'head_nums': [5, 5, 4, 3, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72812156, 'remaining_params': 12205444, 'pruned_model_sparsity': 0.8564362673140621, 'expected_sparsity': 0.85337, 'target_sparsity': 0.95, 'step': 11600}


Iteration:  28%|██▊       | 76/268 [00:14<02:19,  1.38it/s][A04/21/2024 16:32:15 - INFO - trainer.trainer_mod - v4 Global step: 11600, Alignment: tensor([ 2,  7,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:14<01:44,  1.82it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<01:20,  2.37it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:02,  3.01it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:51,  3.67it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:42,  4.35it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:37,  5.01it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:33,  5.58it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:30,  6.09it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.50it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.70it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  6.98it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:26,  6.78it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:25,  6.96it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  7.08it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.63it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.64it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.42it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.30it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.30it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.21it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.37it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.36it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.46it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.54it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.60it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.57it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.43it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.62it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.62it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.83it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.79it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.60it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.50it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.53it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.47it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.50it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.56it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.46it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.70it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:18,  7.89it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.80it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.90it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.73it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.84it/s][A[INFO|trainer.py:570] 2024-04-21 16:32:22,457 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:32:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:32:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:32:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:32:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:32:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:32:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3540349775999284, 'eval_loss': 1.006166, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [461, 770, 718, 900, 733, 689, 533, 437, 271, 184, 218, 145], 'head_nums': [5, 5, 4, 3, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72829008, 'remaining_params': 12188592, 'pruned_model_sparsity': 0.856634485094851, 'expected_sparsity': 0.85383, 'target_sparsity': 0.95, 'step': 11650}


Iteration:  47%|████▋     | 126/268 [00:22<01:42,  1.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<01:16,  1.84it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:59,  2.37it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:46,  2.99it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:37,  3.65it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:31,  4.28it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:27,  4.92it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:24,  5.50it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:22,  6.03it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:20,  6.45it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.79it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.87it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.10it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.52it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.69it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.64it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.42it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.38it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.60it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.63it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.54it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.45it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.45it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.46it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.69it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.71it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.54it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.68it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.65it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.54it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.58it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.47it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.51it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.58it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.61it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.65it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.68it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.69it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.69it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.66it/s][A[INFO|trainer.py:570] 2024-04-21 16:32:31,042 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:32:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:32:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:32:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:32:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:32:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:32:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35439889645187594, 'eval_loss': 0.9516852, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [460, 768, 717, 899, 731, 687, 531, 436, 271, 184, 218, 145], 'head_nums': [5, 5, 4, 3, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72842796, 'remaining_params': 12174804, 'pruned_model_sparsity': 0.8567966632791328, 'expected_sparsity': 0.85415, 'target_sparsity': 0.95, 'step': 11700}


Iteration:  66%|██████▌   | 176/268 [00:31<01:06,  1.38it/s][A04/21/2024 16:32:33 - INFO - trainer.trainer_mod - v4 Global step: 11700, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:31<00:49,  1.83it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:38,  2.37it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:30,  2.95it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:24,  3.63it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:20,  4.31it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:17,  4.87it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:15,  5.45it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:14,  5.98it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.40it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:12,  6.74it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  6.85it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.11it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.39it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.48it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.39it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.52it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.40it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.26it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.24it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.36it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.34it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.27it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.34it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.38it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.44it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.51it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.54it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.37it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.34it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.46it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.51it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.55it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.60it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.42it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.49it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.53it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.61it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.54it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.53it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.72it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.95it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.70it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.69it/s][A[INFO|trainer.py:570] 2024-04-21 16:32:39,669 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:32:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:32:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:32:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:32:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:32:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:32:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3345270218519135, 'eval_loss': 1.0274119, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [460, 765, 716, 897, 729, 685, 530, 435, 271, 184, 218, 145], 'head_nums': [5, 5, 4, 3, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 72853520, 'remaining_params': 12164080, 'pruned_model_sparsity': 0.8569228018669076, 'expected_sparsity': 0.85461, 'target_sparsity': 0.95, 'step': 11750}


Iteration:  84%|████████▍ | 226/268 [00:39<00:30,  1.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:22,  1.84it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:16,  2.38it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:13,  2.99it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:10,  3.68it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:08,  4.36it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:07,  4.96it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:06,  5.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:05,  5.93it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:05,  6.34it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  6.62it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  6.92it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.14it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.16it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.34it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.47it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.61it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:02,  7.74it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.76it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.78it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.50it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.49it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.56it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.55it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.55it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.72it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.68it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.89it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.68it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.66it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.63it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.60it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.46it/s][A04/21/2024 16:32:47 - INFO - trainer.trainer_mod - Epoch 43 finished. Took 45.34 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.91it/s]
Epoch:  44%|████▍     | 44/100 [34:00<42:45, 45.81s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:31,  8.43it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  8.04it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.90it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.77it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.88it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.77it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.74it/s][A[INFO|trainer.py:570] 2024-04-21 16:32:48,212 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:32:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:32:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:32:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:32:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:32:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:32:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39024243626799876, 'eval_loss': 0.89892745, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [459, 762, 715, 896, 728, 684, 529, 435, 271, 184, 217, 145], 'head_nums': [5, 5, 3, 3, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73058808, 'remaining_params': 11958792, 'pruned_model_sparsity': 0.8593374548328817, 'expected_sparsity': 0.85487, 'target_sparsity': 0.95, 'step': 11800}


Iteration:   3%|▎         | 8/268 [00:03<03:19,  1.30it/s][A04/21/2024 16:32:50 - INFO - trainer.trainer_mod - v4 Global step: 11800, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:28,  1.74it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:52,  2.29it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:28,  2.92it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:10,  3.62it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:58,  4.32it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:51,  4.94it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:45,  5.54it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:43,  5.78it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:40,  6.24it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:37,  6.63it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:35,  6.94it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:35,  7.07it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.14it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.42it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.40it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.49it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.56it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:31,  7.58it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:31,  7.62it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:30,  7.76it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:29,  8.00it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:30,  7.92it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:30,  7.76it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:30,  7.76it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:30,  7.71it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.67it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.68it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.69it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.56it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.62it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.62it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.77it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.79it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.72it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:28,  7.84it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:28,  7.76it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.74it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:28,  7.71it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.65it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.64it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.57it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.55it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.56it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.56it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.56it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.51it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 16:32:56,747 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:32:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:32:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:32:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:32:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.13it/s]04/21/2024 16:32:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:32:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3728512069258359, 'eval_loss': 0.99433935, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [458, 759, 714, 895, 726, 683, 529, 434, 271, 184, 216, 145], 'head_nums': [5, 5, 3, 3, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73069532, 'remaining_params': 11948068, 'pruned_model_sparsity': 0.8594635934206565, 'expected_sparsity': 0.85526, 'target_sparsity': 0.95, 'step': 11850}


Iteration:  22%|██▏       | 58/268 [00:11<02:32,  1.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:53,  1.84it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<01:26,  2.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<01:08,  3.04it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:55,  3.71it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:46,  4.39it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:41,  4.93it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:36,  5.50it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:34,  5.94it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.37it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.81it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:29,  6.85it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:28,  7.03it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.11it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:27,  7.14it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.47it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.45it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:25,  7.53it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.57it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:24,  7.62it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.43it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.34it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:26,  7.18it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:25,  7.44it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:25,  7.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.47it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.70it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.68it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.57it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.61it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.51it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.36it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.40it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.61it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.56it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.32it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.33it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.41it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.60it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.48it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:33:05,394 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:33:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:33:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:33:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:33:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.11it/s]04/21/2024 16:33:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:33:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3779933152656192, 'eval_loss': 0.93717223, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [457, 756, 713, 894, 725, 681, 528, 434, 270, 184, 216, 145], 'head_nums': [5, 5, 3, 3, 7, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73080256, 'remaining_params': 11937344, 'pruned_model_sparsity': 0.8595897320084311, 'expected_sparsity': 0.85551, 'target_sparsity': 0.95, 'step': 11900}


Iteration:  40%|████      | 108/268 [00:20<01:56,  1.37it/s][A04/21/2024 16:33:07 - INFO - trainer.trainer_mod - v4 Global step: 11900, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:20<01:27,  1.81it/s][A
Iteration:  41%|████      | 110/268 [00:20<01:07,  2.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:52,  2.99it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:42,  3.64it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:35,  4.32it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:30,  4.98it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:27,  5.56it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:25,  6.08it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.49it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.84it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.07it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.23it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.26it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:18,  7.72it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:18,  7.74it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:18,  7.86it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.80it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:17,  7.79it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:17,  7.73it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.47it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.45it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.53it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.54it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.50it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.59it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.60it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.40it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.49it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.46it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.23it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.51it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.68it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.70it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.69it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.71it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.71it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.68it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.71it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.66it/s][A[INFO|trainer.py:570] 2024-04-21 16:33:13,942 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:33:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:33:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:33:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:33:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:33:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:33:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3604176175199513, 'eval_loss': 1.0419418, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [456, 753, 712, 893, 724, 680, 527, 433, 270, 184, 215, 145], 'head_nums': [5, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73090980, 'remaining_params': 11926620, 'pruned_model_sparsity': 0.8597158705962059, 'expected_sparsity': 0.85573, 'target_sparsity': 0.95, 'step': 11950}


Iteration:  59%|█████▉    | 158/268 [00:28<01:19,  1.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:59,  1.83it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:45,  2.36it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:35,  2.98it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:28,  3.68it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:24,  4.36it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:20,  5.02it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:18,  5.52it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:16,  6.05it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:16,  6.29it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:15,  6.62it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.91it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.09it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.25it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.17it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.26it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.24it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.18it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.17it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.18it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.20it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.34it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.64it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.67it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.69it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:10,  7.72it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.71it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.74it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.74it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.73it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.72it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.71it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.59it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.61it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.49it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.54it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.46it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.41it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.46it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.60it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.76it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:07,  7.77it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.72it/s][A[INFO|trainer.py:570] 2024-04-21 16:33:22,539 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:33:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:33:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:33:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:33:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:33:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:33:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3747715062858422, 'eval_loss': 0.9118078, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [456, 750, 711, 892, 722, 678, 526, 432, 270, 184, 214, 145], 'head_nums': [5, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73103236, 'remaining_params': 11914364, 'pruned_model_sparsity': 0.8598600289822342, 'expected_sparsity': 0.85596, 'target_sparsity': 0.95, 'step': 12000}


Iteration:  78%|███████▊  | 208/268 [00:37<00:43,  1.39it/s][A04/21/2024 16:33:24 - INFO - trainer.trainer_mod - v4 Global step: 12000, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:37<00:32,  1.83it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:24,  2.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:19,  3.00it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:15,  3.67it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:12,  4.28it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:10,  4.95it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:09,  5.43it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:08,  5.96it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:08,  6.31it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.61it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  6.92it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  6.94it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.17it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.20it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.33it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.53it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.55it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.74it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.74it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:04,  7.73it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.61it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.46it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.46it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.64it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.66it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.62it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.64it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.53it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.58it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.70it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.32it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.29it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.41it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.72it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.57it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.73it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.75it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.56it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.51it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.55it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 16:33:31,164 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:33:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:33:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:33:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:33:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:33:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:33:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35295074211030203, 'eval_loss': 1.0789484, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [456, 748, 710, 891, 720, 676, 525, 432, 269, 184, 214, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73310056, 'remaining_params': 11707544, 'pruned_model_sparsity': 0.8622927017464619, 'expected_sparsity': 0.85619, 'target_sparsity': 0.95, 'step': 12050}


Iteration:  96%|█████████▋| 258/268 [00:45<00:07,  1.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:04,  1.83it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:03,  2.38it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:02,  2.99it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:01,  3.63it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:01,  4.32it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  4.93it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  5.49it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  5.97it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  6.37it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.12it/s][A04/21/2024 16:33:34 - INFO - trainer.trainer_mod - Epoch 44 finished. Took 47.29 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  45%|████▌     | 45/100 [34:47<42:23, 46.25s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.10it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.58it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.45it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.66it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.66it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.64it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.62it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.76it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.75it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.36it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:36,  7.04it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.13it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.31it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.30it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.40it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.62it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.55it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.56it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.61it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.60it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.52it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.45it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.44it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.42it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.48it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:33,  7.15it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:32,  7.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:32,  7.14it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:32,  7.12it/s][A
Iteration:  14%|█▍        | 37/268 [00:05<00:33,  6.97it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:33,  6.90it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:32,  7.02it/s][A[INFO|trainer.py:570] 2024-04-21 16:33:39,872 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:33:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:33:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:33:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:33:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:33:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:33:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35863795532263415, 'eval_loss': 0.9674585, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [455, 747, 710, 889, 719, 675, 524, 431, 269, 184, 213, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73319248, 'remaining_params': 11698352, 'pruned_model_sparsity': 0.8624008205359831, 'expected_sparsity': 0.85633, 'target_sparsity': 0.95, 'step': 12100}


Iteration:  15%|█▍        | 40/268 [00:07<02:46,  1.37it/s][A04/21/2024 16:33:41 - INFO - trainer.trainer_mod - v4 Global step: 12100, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:05,  1.82it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:36,  2.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<01:15,  2.97it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:01,  3.63it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:51,  4.31it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:44,  4.95it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:40,  5.48it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:36,  6.00it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:34,  6.35it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:33,  6.60it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:31,  6.81it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<00:30,  6.99it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.10it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.27it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.36it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.33it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.25it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.54it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.63it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.62it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.63it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.62it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:11<00:27,  7.35it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.48it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.36it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.34it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.52it/s][A
Iteration:  28%|██▊       | 75/268 [00:12<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.54it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.80it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.53it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.34it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.41it/s][A
Iteration:  31%|███       | 82/268 [00:13<00:25,  7.40it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.52it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.40it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.53it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 16:33:48,514 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:33:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:33:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:33:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:33:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:33:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:33:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.374958568308545, 'eval_loss': 0.9807083, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [454, 744, 708, 888, 718, 674, 524, 431, 269, 184, 213, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73326908, 'remaining_params': 11690692, 'pruned_model_sparsity': 0.8624909195272509, 'expected_sparsity': 0.85656, 'target_sparsity': 0.95, 'step': 12150}


Iteration:  34%|███▎      | 90/268 [00:16<02:08,  1.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:35,  1.85it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<01:13,  2.38it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:58,  3.01it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:47,  3.67it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:39,  4.34it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:34,  4.98it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:30,  5.56it/s][A
Iteration:  37%|███▋      | 98/268 [00:17<00:28,  6.05it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:26,  6.44it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:25,  6.71it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:24,  6.79it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  7.06it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:23,  7.02it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.22it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:22,  7.30it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.42it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.40it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.46it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.53it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.57it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.73it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.56it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.59it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.57it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.43it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.46it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.55it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.58it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.49it/s][A
Iteration:  45%|████▍     | 120/268 [00:20<00:19,  7.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:18,  7.74it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.65it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.82it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.79it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.74it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.72it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:21<00:18,  7.63it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.52it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.42it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.46it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.51it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.67it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.69it/s][A
Iteration:  51%|█████     | 136/268 [00:22<00:17,  7.64it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:16,  7.86it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:16,  7.78it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:16,  7.92it/s][A[INFO|trainer.py:570] 2024-04-21 16:33:57,052 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:33:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:33:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:33:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:33:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:33:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:33:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38090385891883066, 'eval_loss': 0.94385815, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [453, 741, 707, 886, 717, 673, 523, 430, 269, 184, 213, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73336100, 'remaining_params': 11681500, 'pruned_model_sparsity': 0.8625990383167721, 'expected_sparsity': 0.85675, 'target_sparsity': 0.95, 'step': 12200}


Iteration:  52%|█████▏    | 140/268 [00:24<01:32,  1.39it/s][A04/21/2024 16:33:59 - INFO - trainer.trainer_mod - v4 Global step: 12200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:24<01:09,  1.84it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:52,  2.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:41,  3.00it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:33,  3.70it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:28,  4.34it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:24,  4.90it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:22,  5.38it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:20,  5.89it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:19,  6.23it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:17,  6.61it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:16,  6.93it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:16,  7.16it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.48it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.37it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.43it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.63it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:13,  7.74it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.70it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.89it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.79it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.78it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.77it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.70it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.46it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.70it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.66it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.44it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.51it/s][A
Iteration:  65%|██████▍   | 174/268 [00:29<00:12,  7.70it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.63it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.53it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.57it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.53it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.67it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.69it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:10,  7.88it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:10,  7.78it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.73it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.68it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.80it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.95it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.85it/s][A
Iteration:  71%|███████   | 189/268 [00:31<00:10,  7.79it/s][A[INFO|trainer.py:570] 2024-04-21 16:34:05,566 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:34:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:34:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:34:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:34:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.11it/s]04/21/2024 16:34:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:34:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36638858080273085, 'eval_loss': 1.0223851, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [453, 740, 706, 885, 715, 672, 522, 430, 268, 184, 212, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73346824, 'remaining_params': 11670776, 'pruned_model_sparsity': 0.8627251769045469, 'expected_sparsity': 0.85688, 'target_sparsity': 0.95, 'step': 12250}


Iteration:  71%|███████   | 190/268 [00:33<00:56,  1.39it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:41,  1.84it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:31,  2.40it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:24,  3.02it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:20,  3.70it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:16,  4.37it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:14,  5.02it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:12,  5.59it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:11,  6.08it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:10,  6.47it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:10,  6.80it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.03it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:09,  7.17it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.32it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.42it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.38it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.27it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.22it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.45it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.48it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.41it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.48it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.50it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.53it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.58it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.58it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.59it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.70it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.55it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.63it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.53it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.49it/s][A
Iteration:  85%|████████▍ | 227/268 [00:38<00:05,  7.46it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.43it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.53it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.54it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.59it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.80it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.62it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:34:14,147 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:34:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:34:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:34:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:34:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 16:34:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:34:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35439889645187594, 'eval_loss': 0.96422774, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [452, 738, 704, 884, 714, 670, 520, 429, 268, 184, 212, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73360612, 'remaining_params': 11656988, 'pruned_model_sparsity': 0.8628873550888286, 'expected_sparsity': 0.85709, 'target_sparsity': 0.95, 'step': 12300}


Iteration:  90%|████████▉ | 240/268 [00:41<00:20,  1.39it/s][A04/21/2024 16:34:16 - INFO - trainer.trainer_mod - v4 Global step: 12300, Alignment: tensor([ 2,  7,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:41<00:14,  1.84it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:10,  2.40it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:08,  3.02it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:06,  3.70it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:05,  4.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:04,  5.00it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:03,  5.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:03,  5.99it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  6.42it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  6.90it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.13it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.38it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.43it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  6.87it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.10it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.23it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.47it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.52it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.57it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.64it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.64it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.43it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.51it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.56it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.56it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.10it/s][A04/21/2024 16:34:19 - INFO - trainer.trainer_mod - Epoch 45 finished. Took 45.35 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.91it/s]
Epoch:  46%|████▌     | 46/100 [35:33<41:23, 45.98s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:41,  6.48it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.02it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.36it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.66it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.65it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.66it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.57it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.59it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.58it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.60it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.65it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.66it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.62it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.44it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.34it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.47it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.42it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.52it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:34:22,710 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:34:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:34:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:34:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:34:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:34:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:34:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34821575954561074, 'eval_loss': 1.0139159, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [451, 736, 703, 882, 713, 669, 520, 428, 268, 184, 211, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73369804, 'remaining_params': 11647796, 'pruned_model_sparsity': 0.8629954738783499, 'expected_sparsity': 0.85729, 'target_sparsity': 0.95, 'step': 12350}


Iteration:   8%|▊         | 22/268 [00:04<02:57,  1.39it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:13,  1.84it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:42,  2.38it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:21,  2.99it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:06,  3.65it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:56,  4.30it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:48,  4.95it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:43,  5.53it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:38,  6.13it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.47it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.61it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:33,  6.91it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  7.03it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.21it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.17it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.43it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.49it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.68it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.68it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.71it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.67it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.67it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.70it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.56it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.61it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.65it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.63it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.61it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.55it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.56it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.63it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.51it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.25it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.53it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.34it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:28,  7.17it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.24it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.36it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.17it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:27,  7.10it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:27,  7.17it/s][A[INFO|trainer.py:570] 2024-04-21 16:34:31,372 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:34:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:34:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:34:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:34:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:34:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:34:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3826539195274126, 'eval_loss': 0.9875821, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [450, 734, 702, 881, 711, 668, 519, 428, 268, 184, 211, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73378996, 'remaining_params': 11638604, 'pruned_model_sparsity': 0.8631035926678712, 'expected_sparsity': 0.85742, 'target_sparsity': 0.95, 'step': 12400}


Iteration:  27%|██▋       | 72/268 [00:13<02:23,  1.37it/s][A04/21/2024 16:34:33 - INFO - trainer.trainer_mod - v4 Global step: 12400, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:13<01:47,  1.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<01:22,  2.35it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<01:05,  2.95it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:52,  3.65it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:44,  4.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:38,  4.92it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:34,  5.52it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:31,  6.00it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:29,  6.32it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.76it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:26,  7.03it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.14it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.40it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.46it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.53it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.48it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.44it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.31it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.51it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.65it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.61it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.40it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.48it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.40it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.49it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.40it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.57it/s][A
Iteration:  42%|████▏     | 113/268 [00:19<00:20,  7.44it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.46it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.44it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.49it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.54it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.55it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:20<00:19,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:34:39,989 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:34:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:34:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:34:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:34:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:34:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:34:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37001238174729834, 'eval_loss': 0.9679682, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [449, 732, 701, 880, 709, 666, 518, 428, 267, 184, 210, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73392784, 'remaining_params': 11624816, 'pruned_model_sparsity': 0.863265770852153, 'expected_sparsity': 0.85759, 'target_sparsity': 0.95, 'step': 12450}


Iteration:  46%|████▌     | 122/268 [00:22<01:45,  1.38it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<01:19,  1.83it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<01:00,  2.36it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:48,  2.95it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:39,  3.62it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:32,  4.28it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:28,  4.99it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:25,  5.56it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:22,  6.02it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:21,  6.43it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.75it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.94it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.25it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.18it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.43it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.52it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:16,  7.68it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.66it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.47it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.50it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.52it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.54it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.52it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.51it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.56it/s][A
Iteration:  56%|█████▋    | 151/268 [00:26<00:15,  7.58it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.49it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.38it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.46it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:14,  7.55it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.51it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.51it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.51it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.70it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.59it/s][A
Iteration:  62%|██████▏   | 166/268 [00:28<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.53it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.57it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:34:48,595 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:34:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:34:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:34:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:34:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:34:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:34:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3437141097506875, 'eval_loss': 0.97935957, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [448, 730, 700, 879, 708, 665, 517, 427, 267, 184, 210, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73401976, 'remaining_params': 11615624, 'pruned_model_sparsity': 0.8633738896416742, 'expected_sparsity': 0.85771, 'target_sparsity': 0.95, 'step': 12500}


Iteration:  64%|██████▍   | 172/268 [00:30<01:09,  1.38it/s][A04/21/2024 16:34:50 - INFO - trainer.trainer_mod - v4 Global step: 12500, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:30<00:52,  1.81it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:40,  2.33it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:31,  2.97it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:25,  3.63it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:21,  4.27it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:18,  4.90it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:16,  5.43it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:14,  6.06it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:13,  6.34it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:12,  6.68it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.98it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.17it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.55it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.50it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.67it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.64it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.62it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.44it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.53it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.57it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:10,  7.00it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:10,  7.10it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.29it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.44it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.51it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.53it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.41it/s][A
Iteration:  76%|███████▌  | 204/268 [00:35<00:08,  7.48it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.42it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.36it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.34it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.42it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.48it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.51it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.64it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.64it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.64it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.68it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.69it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 219/268 [00:37<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.42it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:34:57,244 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:34:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:34:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:34:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:34:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.92it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:34:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:34:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3441813057924696, 'eval_loss': 0.97726214, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [448, 727, 699, 878, 707, 664, 517, 427, 266, 184, 210, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73408104, 'remaining_params': 11609496, 'pruned_model_sparsity': 0.8634459688346884, 'expected_sparsity': 0.85785, 'target_sparsity': 0.95, 'step': 12550}


Iteration:  83%|████████▎ | 222/268 [00:39<00:33,  1.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:24,  1.82it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:18,  2.36it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:14,  2.94it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:11,  3.61it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:09,  4.30it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:08,  4.90it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:07,  5.46it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:06,  6.06it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.77it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.18it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.36it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.61it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.61it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.55it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.50it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.57it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.70it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.54it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.58it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.67it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.63it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.65it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.63it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.61it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.60it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.45it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.50it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.40it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.49it/s][A
Iteration:  96%|█████████▌| 257/268 [00:44<00:01,  7.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.36it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.71it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.77it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.87it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.79it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.54it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.58it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.17it/s][A04/21/2024 16:35:05 - INFO - trainer.trainer_mod - Epoch 46 finished. Took 45.45 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.90it/s]
Epoch:  47%|████▋     | 47/100 [36:18<40:28, 45.82s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.57it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 16:35:05,782 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:35:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:35:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:35:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:35:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.00it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.76it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.83it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.89it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.10it/s]04/21/2024 16:35:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:35:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36509955122006726, 'eval_loss': 0.9397251, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [447, 726, 698, 876, 705, 663, 516, 427, 266, 184, 209, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73418828, 'remaining_params': 11598772, 'pruned_model_sparsity': 0.8635721074224632, 'expected_sparsity': 0.85802, 'target_sparsity': 0.95, 'step': 12600}


Iteration:   1%|▏         | 4/268 [00:02<04:02,  1.09it/s][A04/21/2024 16:35:07 - INFO - trainer.trainer_mod - v4 Global step: 12600, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:46,  1.58it/s][A
Iteration:   2%|▏         | 6/268 [00:02<02:01,  2.16it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:32,  2.82it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:14,  3.51it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:00,  4.26it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:51,  4.97it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:46,  5.59it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:42,  6.08it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:39,  6.48it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:37,  6.75it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:36,  6.99it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:35,  7.09it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:35,  7.16it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.20it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.18it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:33,  7.43it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.27it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.26it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.37it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.46it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:31,  7.70it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:31,  7.66it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:30,  7.79it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:30,  7.89it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:30,  7.82it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:30,  7.73it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.08it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.15it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.30it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.43it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.32it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.40it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.46it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.61it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.54it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.54it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.57it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.55it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.56it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.81it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:27,  7.75it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:35:14,388 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:35:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:35:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:35:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:35:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:35:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:35:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36209284693594596, 'eval_loss': 0.98303, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [446, 724, 697, 875, 704, 661, 515, 426, 266, 184, 209, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73429552, 'remaining_params': 11588048, 'pruned_model_sparsity': 0.8636982460102379, 'expected_sparsity': 0.85812, 'target_sparsity': 0.95, 'step': 12650}


Iteration:  20%|██        | 54/268 [00:11<02:34,  1.38it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:56,  1.83it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:29,  2.38it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<01:10,  2.99it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:57,  3.67it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:48,  4.35it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:41,  4.97it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:37,  5.51it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:34,  6.00it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:32,  6.38it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.70it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:29,  6.93it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:28,  6.97it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:27,  7.18it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:27,  7.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.49it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.30it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:26,  7.40it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:26,  7.36it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.46it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.53it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.57it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.57it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.51it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.54it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.58it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.60it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.51it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.32it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.43it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.50it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.42it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.60it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:22,  7.81it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.37it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.39it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.46it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:21,  7.78it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.62it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.61it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.59it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:35:23,001 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:35:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:35:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:35:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:35:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:35:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:35:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36687779463304676, 'eval_loss': 0.968807, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [445, 722, 696, 873, 703, 660, 514, 426, 266, 184, 208, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73438744, 'remaining_params': 11578856, 'pruned_model_sparsity': 0.8638063647997591, 'expected_sparsity': 0.85825, 'target_sparsity': 0.95, 'step': 12700}


Iteration:  39%|███▉      | 104/268 [00:19<01:58,  1.38it/s][A04/21/2024 16:35:25 - INFO - trainer.trainer_mod - v4 Global step: 12700, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:19<01:28,  1.83it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<01:08,  2.37it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:53,  2.99it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:43,  3.64it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:36,  4.31it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:32,  4.88it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:28,  5.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:26,  6.00it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:24,  6.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:23,  6.68it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:21,  6.97it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  7.06it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:20,  7.21it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  7.14it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.26it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.32it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:19,  7.43it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.48it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.47it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.44it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.32it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.49it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:17,  7.62it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.24it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.24it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.25it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.52it/s][A
Iteration:  51%|█████     | 136/268 [00:24<00:17,  7.57it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.47it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.55it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.48it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.47it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.41it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.45it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.48it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.66it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.57it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.67it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:14,  7.81it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.69it/s][A[INFO|trainer.py:570] 2024-04-21 16:35:31,624 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:35:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:35:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:35:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:35:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:35:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:35:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3699415677046556, 'eval_loss': 1.0038724, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [444, 721, 696, 872, 702, 659, 514, 425, 266, 184, 208, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73444872, 'remaining_params': 11572728, 'pruned_model_sparsity': 0.8638784439927732, 'expected_sparsity': 0.85835, 'target_sparsity': 0.95, 'step': 12750}


Iteration:  57%|█████▋    | 154/268 [00:28<01:22,  1.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<01:01,  1.84it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:47,  2.37it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:37,  2.98it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:30,  3.61it/s][A
Iteration:  59%|█████▉    | 159/268 [00:29<00:25,  4.29it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:21,  4.94it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:19,  5.51it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:17,  5.99it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:16,  6.39it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.64it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.84it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.07it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:13,  7.24it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.53it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.47it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:12,  7.65it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.45it/s][A
Iteration:  65%|██████▍   | 174/268 [00:31<00:12,  7.32it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.38it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.54it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.56it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.32it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.42it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.33it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.10it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.37it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.38it/s][A
Iteration:  71%|███████   | 189/268 [00:33<00:10,  7.41it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.59it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.62it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.65it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.65it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.67it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.44it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.49it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.54it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.55it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.57it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.56it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.60it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.54it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 16:35:40,271 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:35:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:35:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:35:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:35:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.18it/s]04/21/2024 16:35:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:35:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3927674381319123, 'eval_loss': 0.9348657, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [444, 719, 695, 870, 700, 658, 513, 424, 265, 184, 208, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73455596, 'remaining_params': 11562004, 'pruned_model_sparsity': 0.864004582580548, 'expected_sparsity': 0.85853, 'target_sparsity': 0.95, 'step': 12800}


Iteration:  76%|███████▌  | 204/268 [00:36<00:46,  1.38it/s][A04/21/2024 16:35:42 - INFO - trainer.trainer_mod - v4 Global step: 12800, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:37<00:34,  1.83it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:26,  2.37it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:20,  2.98it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:16,  3.65it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:13,  4.33it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:11,  4.96it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:10,  5.47it/s][A
Iteration:  79%|███████▉  | 212/268 [00:38<00:09,  5.94it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.36it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:08,  6.74it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  6.98it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.15it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.30it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.41it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:06,  7.48it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.55it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.59it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:05,  7.63it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.67it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.57it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:40<00:05,  7.51it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.41it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.61it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.39it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.45it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.47it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.70it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.67it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.67it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:03,  7.81it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.73it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.72it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.70it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.72it/s][A
Iteration:  90%|█████████ | 242/268 [00:42<00:03,  7.48it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.38it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.43it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.40it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.67it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.68it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.50it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.51it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.56it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 16:35:48,849 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:35:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:35:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:35:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:35:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:35:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:35:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3809615036075187, 'eval_loss': 0.8456253, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [443, 717, 694, 869, 699, 657, 513, 424, 265, 184, 207, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73463256, 'remaining_params': 11554344, 'pruned_model_sparsity': 0.8640946815718157, 'expected_sparsity': 0.8587, 'target_sparsity': 0.95, 'step': 12850}


Iteration:  95%|█████████▍| 254/268 [00:45<00:10,  1.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:07,  1.81it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:05,  2.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:03,  2.99it/s][A
Iteration:  96%|█████████▋| 258/268 [00:46<00:02,  3.64it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:02,  4.29it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  4.95it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  5.50it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.00it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.42it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  6.85it/s][A
Iteration:  99%|█████████▉| 265/268 [00:47<00:00,  7.07it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  7.03it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.21it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.83it/s][A04/21/2024 16:35:52 - INFO - trainer.trainer_mod - Epoch 47 finished. Took 47.41 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.65it/s]
Epoch:  48%|████▊     | 48/100 [37:05<40:07, 46.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.69it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.41it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.62it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.53it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.45it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.36it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.65it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.62it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.52it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.54it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.60it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.59it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.54it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.74it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.63it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.62it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.60it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.74it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.56it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.59it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.38it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.42it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.48it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.43it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.48it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.54it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.70it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:35:57,414 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:35:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:35:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:35:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:35:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 16:35:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:35:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34515526818119835, 'eval_loss': 0.9817371, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [442, 715, 693, 868, 697, 656, 512, 423, 265, 184, 207, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73473980, 'remaining_params': 11543620, 'pruned_model_sparsity': 0.8642208201595905, 'expected_sparsity': 0.8588, 'target_sparsity': 0.95, 'step': 12900}


Iteration:  13%|█▎        | 36/268 [00:06<02:47,  1.38it/s][A04/21/2024 16:35:59 - INFO - trainer.trainer_mod - v4 Global step: 12900, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:06<02:05,  1.84it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<01:36,  2.38it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:15,  3.01it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:02,  3.65it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:52,  4.32it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:46,  4.90it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:40,  5.49it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:36,  6.09it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:34,  6.48it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.62it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:31,  6.95it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.14it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.21it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:30,  7.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.31it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:29,  7.21it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.19it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.34it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.71it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:26,  7.72it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.91it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:25,  8.04it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:25,  8.07it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.79it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.76it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.63it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:25,  7.73it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.66it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.68it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.65it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.67it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.63it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.41it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.51it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.61it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.67it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.65it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:26,  7.05it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.24it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:25,  7.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:36:06,017 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:36:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:36:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:36:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:36:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.82it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.13it/s]04/21/2024 16:36:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:36:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3302018892609736, 'eval_loss': 0.96029025, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [441, 713, 692, 866, 696, 655, 511, 423, 265, 184, 206, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73483172, 'remaining_params': 11534428, 'pruned_model_sparsity': 0.8643289389491117, 'expected_sparsity': 0.85892, 'target_sparsity': 0.95, 'step': 12950}


Iteration:  32%|███▏      | 86/268 [00:15<02:12,  1.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:39,  1.82it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<01:16,  2.37it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<01:00,  2.98it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:48,  3.69it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:40,  4.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:35,  4.97it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:31,  5.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:28,  6.04it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.45it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.65it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:24,  6.85it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.23it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.17it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.29it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.50it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.68it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.57it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:20,  7.80it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.79it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.66it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.60it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.63it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.64it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.66it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.46it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.30it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.20it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.32it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.58it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.75it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.74it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:17,  7.85it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.67it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:17,  7.85it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:17,  7.78it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.76it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.57it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.46it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:18,  7.09it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:18,  7.22it/s][A[INFO|trainer.py:570] 2024-04-21 16:36:14,607 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:36:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:36:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:36:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:36:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:36:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:36:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36184579111803034, 'eval_loss': 1.0268224, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [441, 711, 691, 865, 695, 654, 510, 423, 265, 184, 206, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73489300, 'remaining_params': 11528300, 'pruned_model_sparsity': 0.8644010181421259, 'expected_sparsity': 0.85903, 'target_sparsity': 0.95, 'step': 13000}


Iteration:  51%|█████     | 136/268 [00:23<01:35,  1.38it/s][A04/21/2024 16:36:16 - INFO - trainer.trainer_mod - v4 Global step: 13000, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:24<01:12,  1.81it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:55,  2.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:43,  2.96it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:34,  3.67it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:29,  4.34it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:25,  4.95it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:22,  5.61it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:20,  6.09it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:18,  6.49it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:18,  6.71it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.14it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.31it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.41it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.45it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.39it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.34it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.51it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.59it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.58it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.61it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.66it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.62it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.65it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.52it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.59it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.64it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.77it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.70it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.42it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.30it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.30it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.36it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.42it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.46it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.32it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.53it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.41it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.27it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:12,  7.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.47it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.53it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.57it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.63it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.75it/s][A[INFO|trainer.py:570] 2024-04-21 16:36:23,182 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:36:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:36:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:36:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:36:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:36:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:36:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35823474778962877, 'eval_loss': 0.92407507, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [440, 710, 690, 863, 694, 653, 510, 422, 265, 184, 206, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73496960, 'remaining_params': 11520640, 'pruned_model_sparsity': 0.8644911171333935, 'expected_sparsity': 0.85912, 'target_sparsity': 0.95, 'step': 13050}


Iteration:  69%|██████▉   | 186/268 [00:32<00:59,  1.39it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:43,  1.85it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:33,  2.37it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:26,  2.99it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:21,  3.65it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:17,  4.34it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:15,  4.97it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:13,  5.62it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:12,  6.07it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:11,  6.61it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:10,  6.89it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:10,  7.08it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.27it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.26it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.53it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.63it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.23it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.46it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.73it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.67it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.79it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.79it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.65it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.63it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.54it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.58it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.63it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.74it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.59it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.53it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.57it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.44it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.49it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.58it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.66it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.59it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.63it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.66it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.68it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.58it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.58it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.58it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 16:36:31,727 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:36:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:36:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:36:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:36:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 16:36:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:36:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3623190551265996, 'eval_loss': 0.9569146, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [439, 708, 689, 862, 692, 652, 509, 422, 264, 184, 205, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73509216, 'remaining_params': 11508384, 'pruned_model_sparsity': 0.8646352755194219, 'expected_sparsity': 0.85931, 'target_sparsity': 0.95, 'step': 13100}


Iteration:  88%|████████▊ | 236/268 [00:41<00:23,  1.38it/s][A04/21/2024 16:36:33 - INFO - trainer.trainer_mod - v4 Global step: 13100, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:41<00:17,  1.82it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:12,  2.36it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:09,  2.99it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:07,  3.63it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:06,  4.35it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:05,  5.00it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:04,  5.56it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.14it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  6.50it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  6.73it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:03,  6.99it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.12it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.61it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.48it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.40it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.25it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.28it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.38it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.37it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.47it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.41it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.46it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.53it/s][A04/21/2024 16:36:37 - INFO - trainer.trainer_mod - Epoch 48 finished. Took 45.27 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  49%|████▉     | 49/100 [37:51<39:05, 45.99s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.39it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.72it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.97it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.86it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.79it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.74it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.72it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.71it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.60it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.60it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.51it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.54it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.46it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.36it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.27it/s][A[INFO|trainer.py:570] 2024-04-21 16:36:40,312 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:36:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:36:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:36:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:36:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.18it/s]04/21/2024 16:36:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:36:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3408529915520382, 'eval_loss': 1.1186837, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [439, 706, 689, 860, 691, 651, 508, 422, 264, 184, 204, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73515344, 'remaining_params': 11502256, 'pruned_model_sparsity': 0.864707354712436, 'expected_sparsity': 0.85948, 'target_sparsity': 0.95, 'step': 13150}


Iteration:   7%|▋         | 18/268 [00:04<03:02,  1.37it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:16,  1.82it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:45,  2.36it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:23,  2.95it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:08,  3.58it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:57,  4.26it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:50,  4.83it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:44,  5.42it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:41,  5.87it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:38,  6.25it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:36,  6.61it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:35,  6.81it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:34,  6.96it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  7.16it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.26it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.50it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.58it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.46it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.54it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.56it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.46it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.62it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.76it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.73it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.82it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.78it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.77it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.76it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:27,  7.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.70it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.72it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.61it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.66it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.67it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:26,  7.79it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.61it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.68it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.67it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.53it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.53it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.50it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:36:48,904 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:36:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:36:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:36:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:36:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:36:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:36:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3683318994242006, 'eval_loss': 1.0574605, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [438, 704, 688, 858, 689, 650, 507, 421, 264, 184, 204, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73526068, 'remaining_params': 11491532, 'pruned_model_sparsity': 0.8648334933002108, 'expected_sparsity': 0.85964, 'target_sparsity': 0.95, 'step': 13200}


Iteration:  25%|██▌       | 68/268 [00:12<02:25,  1.38it/s][A04/21/2024 16:36:50 - INFO - trainer.trainer_mod - v4 Global step: 13200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:13<01:49,  1.82it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<01:23,  2.37it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:05,  2.99it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:53,  3.66it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:45,  4.33it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:38,  4.98it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:34,  5.58it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:31,  6.06it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.48it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.62it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:27,  6.93it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:27,  6.94it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:26,  7.11it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:25,  7.35it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.41it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.39it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.37it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.54it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.43it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.49it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.39it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.54it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.58it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.55it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.43it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.56it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.45it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.63it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.50it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.61it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.42it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.66it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.69it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.68it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.66it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.54it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 16:36:57,500 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:36:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:36:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:36:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:36:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.99it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.18it/s]04/21/2024 16:36:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:36:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3737883970394527, 'eval_loss': 0.9350191, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [438, 702, 687, 857, 688, 649, 507, 421, 264, 184, 204, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73530664, 'remaining_params': 11486936, 'pruned_model_sparsity': 0.8648875526949714, 'expected_sparsity': 0.85974, 'target_sparsity': 0.95, 'step': 13250}


Iteration:  44%|████▍     | 118/268 [00:21<01:48,  1.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<01:21,  1.82it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<01:02,  2.36it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:49,  2.99it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:40,  3.62it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:33,  4.30it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:29,  4.89it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:26,  5.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:23,  5.96it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:21,  6.42it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.68it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:20,  6.83it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.08it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.16it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.20it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.32it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.22it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.24it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.39it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.46it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.52it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.57it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.59it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.45it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.38it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.45it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.50it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.52it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.54it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.54it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.68it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.60it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.56it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.44it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.47it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  6.95it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  7.24it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.37it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.43it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.45it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.71it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.79it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.75it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.60it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 16:37:06,151 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:37:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:37:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:37:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:37:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:37:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:37:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3543275001853642, 'eval_loss': 1.0315893, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [437, 700, 686, 856, 687, 648, 506, 420, 263, 184, 204, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73541388, 'remaining_params': 11476212, 'pruned_model_sparsity': 0.8650136912827462, 'expected_sparsity': 0.8599, 'target_sparsity': 0.95, 'step': 13300}


Iteration:  63%|██████▎   | 168/268 [00:30<01:12,  1.38it/s][A04/21/2024 16:37:08 - INFO - trainer.trainer_mod - v4 Global step: 13300, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:30<00:54,  1.82it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:41,  2.37it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:32,  2.99it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:26,  3.65it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:21,  4.37it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:18,  5.02it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:16,  5.62it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:15,  6.02it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:14,  6.41it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.74it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.00it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.18it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.10it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.18it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.48it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:10,  7.67it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.64it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.63it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.58it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.63it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.64it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.65it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.61it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.59it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.62it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.22it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.32it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.46it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.48it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.45it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.59it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.47it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.59it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.60it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.65it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.68it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.80it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.76it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:06,  7.72it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.48it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.41it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.33it/s][A[INFO|trainer.py:570] 2024-04-21 16:37:14,736 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:37:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:37:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:37:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:37:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 16:37:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:37:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37001238174729834, 'eval_loss': 0.99956137, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [437, 697, 684, 854, 685, 647, 505, 420, 263, 184, 204, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73550580, 'remaining_params': 11467020, 'pruned_model_sparsity': 0.8651218100722674, 'expected_sparsity': 0.86005, 'target_sparsity': 0.95, 'step': 13350}


Iteration:  81%|████████▏ | 218/268 [00:38<00:36,  1.38it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:27,  1.81it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:20,  2.35it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:15,  2.96it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:12,  3.61it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:10,  4.28it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:08,  4.91it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:07,  5.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:07,  5.95it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:06,  6.33it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:06,  6.66it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  6.85it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.23it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.19it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.36it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.55it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.73it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.53it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.47it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.52it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.55it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.56it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.59it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.70it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.51it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.48it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.56it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.82it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.76it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.68it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.62it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.42it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.35it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.36it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.31it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.61it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.57it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.61it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.81it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.57it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.17it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.22it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.33it/s][A
Iteration:  99%|█████████▉| 265/268 [00:45<00:00,  7.27it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.37it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:37:23,339 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:37:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:37:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:37:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:37:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.18it/s]04/21/2024 16:37:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:37:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.386056793755423, 'eval_loss': 1.029178, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [436, 695, 684, 852, 684, 646, 505, 419, 263, 184, 204, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73556708, 'remaining_params': 11460892, 'pruned_model_sparsity': 0.8651938892652815, 'expected_sparsity': 0.86016, 'target_sparsity': 0.95, 'step': 13400}


Iteration: 100%|██████████| 268/268 [00:47<00:00,  1.40it/s][A04/21/2024 16:37:25 - INFO - trainer.trainer_mod - Epoch 49 finished. Took 47.39 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.66it/s]
Epoch:  50%|█████     | 50/100 [38:38<38:40, 46.41s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/21/2024 16:37:25 - INFO - trainer.trainer_mod - v4 Global step: 13400, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.67it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.64it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.66it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.61it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.60it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.42it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.52it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.68it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.58it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.57it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.62it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.46it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.52it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.53it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.50it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.45it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.47it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.42it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.47it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:35,  6.92it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:34,  7.05it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:33,  7.24it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.49it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.40it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.51it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.57it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.59it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:29,  7.74it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:28,  7.87it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.79it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:29,  7.75it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:29,  7.53it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:29,  7.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:30,  7.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:30,  7.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:06<00:29,  7.37it/s][A
Iteration:  18%|█▊        | 49/268 [00:06<00:29,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 16:37:31,974 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:37:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:37:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:37:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:37:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.95it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:37:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:37:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3723251047469222, 'eval_loss': 1.0459965, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [435, 693, 683, 850, 682, 645, 504, 419, 262, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73568964, 'remaining_params': 11448636, 'pruned_model_sparsity': 0.8653380476513098, 'expected_sparsity': 0.86037, 'target_sparsity': 0.95, 'step': 13450}


Iteration:  19%|█▊        | 50/268 [00:08<02:38,  1.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:58,  1.83it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<01:31,  2.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:11,  2.99it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:58,  3.65it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:49,  4.34it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:42,  5.00it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:37,  5.58it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:35,  5.94it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:32,  6.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:31,  6.66it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.92it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.23it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.31it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.31it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.35it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.29it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.41it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.37it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.42it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:26,  7.42it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.38it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.44it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.51it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.68it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.68it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:24,  7.53it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.53it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.42it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.38it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.65it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.68it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.66it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.64it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:22,  7.66it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:22,  7.66it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:22,  7.56it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.64it/s][A
Iteration:  36%|███▌      | 97/268 [00:14<00:22,  7.60it/s][A
Iteration:  37%|███▋      | 98/268 [00:15<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:15<00:22,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:37:40,593 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:37:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:37:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:37:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:37:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.02it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.18it/s]04/21/2024 16:37:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:37:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3857386052431007, 'eval_loss': 0.9673753, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [435, 692, 682, 848, 681, 644, 503, 418, 262, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73576624, 'remaining_params': 11440976, 'pruned_model_sparsity': 0.8654281466425775, 'expected_sparsity': 0.86053, 'target_sparsity': 0.95, 'step': 13500}


Iteration:  37%|███▋      | 100/268 [00:17<02:01,  1.38it/s][A04/21/2024 16:37:42 - INFO - trainer.trainer_mod - v4 Global step: 13500, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:17<01:31,  1.83it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<01:09,  2.37it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:55,  2.99it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:44,  3.67it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:37,  4.34it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:32,  4.98it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:28,  5.57it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:26,  6.05it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:24,  6.48it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:23,  6.83it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.19it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.45it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.50it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.69it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.70it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.57it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.59it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.66it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.63it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.79it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.67it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.52it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.56it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.60it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.37it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.37it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.34it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.57it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.46it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.54it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.71it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.67it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.47it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.54it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.48it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.43it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.48it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.41it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.36it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.45it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:16,  7.53it/s][A
Iteration:  55%|█████▌    | 148/268 [00:23<00:15,  7.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:23<00:15,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:37:49,153 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:37:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:37:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:37:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:37:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 16:37:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:37:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37001238174729834, 'eval_loss': 1.0024881, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [434, 690, 681, 846, 681, 643, 502, 418, 262, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73582752, 'remaining_params': 11434848, 'pruned_model_sparsity': 0.8655002258355917, 'expected_sparsity': 0.86069, 'target_sparsity': 0.95, 'step': 13550}


Iteration:  56%|█████▌    | 150/268 [00:25<01:25,  1.38it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<01:03,  1.84it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:48,  2.38it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:38,  2.99it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:31,  3.66it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:26,  4.30it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:22,  4.92it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:20,  5.52it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:18,  6.03it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:16,  6.46it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:16,  6.74it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  7.00it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.17it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.16it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:14,  7.11it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.34it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.63it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.78it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.72it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.67it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.69it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.72it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.50it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.50it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.40it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.32it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.55it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.70it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.63it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.55it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.59it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.51it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.71it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.69it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.57it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.54it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.58it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:10,  7.44it/s][A
Iteration:  72%|███████▏  | 194/268 [00:31<00:10,  7.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:31<00:09,  7.31it/s][A
Iteration:  73%|███████▎  | 196/268 [00:31<00:09,  7.56it/s][A
Iteration:  74%|███████▎  | 197/268 [00:32<00:09,  7.80it/s][A
Iteration:  74%|███████▍  | 198/268 [00:32<00:09,  7.58it/s][A
Iteration:  74%|███████▍  | 199/268 [00:32<00:09,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:37:57,731 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:37:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:37:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:37:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:37:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 16:37:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:37:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3363939714878474, 'eval_loss': 1.0753399, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [434, 687, 680, 845, 679, 642, 502, 418, 262, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73588880, 'remaining_params': 11428720, 'pruned_model_sparsity': 0.8655723050286058, 'expected_sparsity': 0.86095, 'target_sparsity': 0.95, 'step': 13600}


Iteration:  75%|███████▍  | 200/268 [00:34<00:49,  1.38it/s][A04/21/2024 16:37:59 - INFO - trainer.trainer_mod - v4 Global step: 13600, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:34<00:36,  1.85it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:27,  2.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:21,  3.03it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:17,  3.70it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:14,  4.38it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:12,  5.02it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:11,  5.39it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:10,  5.91it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:09,  6.36it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:08,  6.60it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:08,  6.89it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.09it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.15it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.14it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.27it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.36it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.44it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.53it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.58it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.60it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.60it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.68it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.52it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.35it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.46it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.65it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.61it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.64it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.61it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.31it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.63it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.60it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.64it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.55it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.55it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.58it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.50it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.42it/s][A
Iteration:  92%|█████████▏| 246/268 [00:40<00:02,  7.47it/s][A
Iteration:  92%|█████████▏| 247/268 [00:40<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:40<00:02,  7.54it/s][A
Iteration:  93%|█████████▎| 249/268 [00:40<00:02,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:38:06,311 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:38:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:38:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:38:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:38:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.96it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.15it/s]04/21/2024 16:38:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:38:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.349232944017668, 'eval_loss': 0.98238117, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [433, 685, 679, 843, 678, 641, 501, 417, 261, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73599604, 'remaining_params': 11417996, 'pruned_model_sparsity': 0.8656984436163806, 'expected_sparsity': 0.86114, 'target_sparsity': 0.95, 'step': 13650}


Iteration:  93%|█████████▎| 250/268 [00:42<00:12,  1.39it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:09,  1.84it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:06,  2.37it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:04,  3.02it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:03,  3.68it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:03,  4.32it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:02,  4.97it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  5.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  5.97it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  6.40it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:01,  6.95it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.23it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.31it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.08it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.02it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.09it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.05it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  7.66it/s][A04/21/2024 16:38:10 - INFO - trainer.trainer_mod - Epoch 50 finished. Took 45.37 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.91it/s]
Epoch:  51%|█████     | 51/100 [39:23<37:38, 46.10s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  8.04it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.02it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:36,  7.29it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.44it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.44it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.31it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.42it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.39it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.51it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.53it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.58it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.61it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.69it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.50it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.57it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.58it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.61it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.60it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.59it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.58it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.75it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.63it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.60it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.62it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:38:14,932 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:38:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:38:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:38:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:38:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:38:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:38:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3615223384776978, 'eval_loss': 1.059387, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [432, 683, 678, 842, 677, 640, 501, 417, 261, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73605732, 'remaining_params': 11411868, 'pruned_model_sparsity': 0.8657705228093948, 'expected_sparsity': 0.86134, 'target_sparsity': 0.95, 'step': 13700}


Iteration:  12%|█▏        | 32/268 [00:06<02:51,  1.38it/s][A04/21/2024 16:38:16 - INFO - trainer.trainer_mod - v4 Global step: 13700, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:08,  1.83it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:38,  2.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:17,  3.01it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:02,  3.68it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:55,  4.15it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:48,  4.78it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:42,  5.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:39,  5.83it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:36,  6.30it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:34,  6.63it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.03it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:31,  7.13it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.25it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.61it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:27,  7.82it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.74it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.73it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.56it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.60it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.59it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.38it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.35it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.73it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.61it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.55it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.53it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.54it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.60it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.63it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.64it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.66it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.54it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.57it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.29it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.39it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.59it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.51it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.45it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.54it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.55it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:38:23,520 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:38:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:38:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:38:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:38:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:38:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:38:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3579742226481367, 'eval_loss': 1.1250204, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [432, 682, 677, 840, 676, 639, 500, 416, 261, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73613392, 'remaining_params': 11404208, 'pruned_model_sparsity': 0.8658606218006625, 'expected_sparsity': 0.86164, 'target_sparsity': 0.95, 'step': 13750}


Iteration:  31%|███       | 82/268 [00:14<02:13,  1.39it/s][A
Iteration:  31%|███       | 83/268 [00:14<01:40,  1.84it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<01:17,  2.38it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:00,  3.00it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:49,  3.66it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:42,  4.29it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:36,  4.93it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:32,  5.49it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:29,  5.98it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:28,  6.31it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:27,  6.49it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.65it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.01it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:24,  7.16it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.32it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.61it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:21,  7.76it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.85it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.94it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.87it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.59it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.62it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.62it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.58it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.55it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.60it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.48it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.64it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.61it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.67it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.57it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.74it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.74it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.67it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.53it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.45it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.59it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.61it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.46it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.44it/s][A[INFO|trainer.py:570] 2024-04-21 16:38:32,096 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:38:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:38:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:38:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:38:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:38:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:38:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34550903174440106, 'eval_loss': 1.0836227, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [432, 679, 676, 838, 674, 638, 499, 416, 261, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73621052, 'remaining_params': 11396548, 'pruned_model_sparsity': 0.8659507207919301, 'expected_sparsity': 0.8619, 'target_sparsity': 0.95, 'step': 13800}


Iteration:  49%|████▉     | 132/268 [00:23<01:38,  1.38it/s][A04/21/2024 16:38:34 - INFO - trainer.trainer_mod - v4 Global step: 13800, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:23<01:13,  1.83it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:56,  2.36it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:44,  3.01it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:36,  3.65it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:30,  4.30it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:25,  5.04it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:22,  5.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:20,  6.13it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:19,  6.53it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.84it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  6.96it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:17,  7.27it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  7.14it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.50it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.57it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.57it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.57it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.49it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.33it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.17it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.18it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.32it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.39it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.43it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.45it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.48it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.53it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.76it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.58it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.64it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.43it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.42it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.37it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.51it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.58it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.42it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.49it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.49it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.38it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.44it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 16:38:40,723 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:38:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:38:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:38:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:38:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.94it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:38:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:38:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.33390117475907616, 'eval_loss': 1.0847454, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [431, 677, 675, 836, 673, 637, 498, 415, 261, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73630244, 'remaining_params': 11387356, 'pruned_model_sparsity': 0.8660588395814514, 'expected_sparsity': 0.86225, 'target_sparsity': 0.95, 'step': 13850}


Iteration:  68%|██████▊   | 182/268 [00:32<01:02,  1.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:46,  1.82it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:35,  2.35it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:28,  2.96it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:22,  3.61it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:18,  4.28it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:16,  4.88it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:14,  5.50it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:13,  5.92it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:12,  6.25it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.60it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  6.99it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.64it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.48it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.49it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.37it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.55it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.44it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.29it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.42it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.51it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.57it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.54it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.56it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.70it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.57it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.50it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.53it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.54it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.47it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.41it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.55it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.58it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.60it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.59it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.53it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.45it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.51it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.55it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.73it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.67it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.66it/s][A[INFO|trainer.py:570] 2024-04-21 16:38:49,342 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:38:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:38:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:38:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:38:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:38:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:38:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37330557017038596, 'eval_loss': 1.0621572, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [430, 676, 674, 834, 672, 636, 497, 414, 261, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73639436, 'remaining_params': 11378164, 'pruned_model_sparsity': 0.8661669583709726, 'expected_sparsity': 0.86278, 'target_sparsity': 0.95, 'step': 13900}


Iteration:  87%|████████▋ | 232/268 [00:40<00:26,  1.38it/s][A04/21/2024 16:38:51 - INFO - trainer.trainer_mod - v4 Global step: 13900, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:40<00:19,  1.81it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:14,  2.33it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:11,  2.94it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:08,  3.59it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:07,  4.32it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:06,  4.97it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:05,  5.57it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:04,  6.04it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:04,  6.52it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  6.85it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.07it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.44it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.15it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.26it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.61it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:43<00:02,  7.44it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.48it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.51it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.55it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.44it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.51it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.51it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.52it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.60it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.63it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.62it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.65it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.64it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.66it/s][A04/21/2024 16:38:56 - INFO - trainer.trainer_mod - Epoch 51 finished. Took 45.36 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.91it/s]
Epoch:  52%|█████▏    | 52/100 [40:09<36:42, 45.88s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:33,  8.01it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.37it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.48it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.48it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  6.91it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:37,  7.00it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.23it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.38it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.46it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.64it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.42it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 16:38:57,930 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:38:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:38:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:38:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:38:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.99it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.18it/s]04/21/2024 16:38:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:38:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37874357276848103, 'eval_loss': 1.0420249, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [430, 674, 674, 832, 670, 635, 497, 414, 260, 184, 203, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73645564, 'remaining_params': 11372036, 'pruned_model_sparsity': 0.8662390375639868, 'expected_sparsity': 0.86339, 'target_sparsity': 0.95, 'step': 13950}


Iteration:   5%|▌         | 14/268 [00:03<03:04,  1.37it/s][A
Iteration:   6%|▌         | 15/268 [00:03<02:18,  1.82it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:46,  2.37it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:24,  2.96it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:08,  3.64it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:56,  4.40it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:48,  5.09it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:43,  5.65it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:40,  6.14it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:37,  6.52it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:35,  6.81it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.08it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.23it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.24it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:33,  7.23it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.18it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.23it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:33,  6.99it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:32,  7.31it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.53it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.34it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.35it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.57it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.62it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.58it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.41it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.47it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.52it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.30it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.18it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.47it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.53it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.41it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.50it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.49it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.50it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.50it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.68it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.43it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.46it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.67it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:39:06,560 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:39:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:39:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:39:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:39:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.99it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.16it/s]04/21/2024 16:39:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:39:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3724067509797974, 'eval_loss': 1.034489, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [429, 672, 672, 830, 669, 634, 496, 413, 260, 184, 202, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73657820, 'remaining_params': 11359780, 'pruned_model_sparsity': 0.866383195950015, 'expected_sparsity': 0.86418, 'target_sparsity': 0.95, 'step': 14000}


Iteration:  24%|██▍       | 64/268 [00:12<02:28,  1.38it/s][A04/21/2024 16:39:08 - INFO - trainer.trainer_mod - v4 Global step: 14000, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:12<01:51,  1.82it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<01:25,  2.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<01:07,  2.98it/s][A
Iteration:  25%|██▌       | 68/268 [00:13<00:54,  3.65it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:46,  4.32it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:39,  5.03it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:35,  5.57it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:33,  5.91it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:31,  6.27it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:29,  6.61it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:28,  6.82it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:27,  7.08it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.25it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.29it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.32it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.42it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.66it/s][A
Iteration:  31%|███       | 83/268 [00:15<00:24,  7.69it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.59it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.75it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.71it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.74it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.41it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:24,  7.34it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.40it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.44it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.51it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.69it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:21,  7.87it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.78it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.74it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.74it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.75it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.73it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:20,  7.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:20,  7.83it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:20,  7.88it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.87it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.80it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.75it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.66it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.63it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 16:39:15,105 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:39:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:39:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:39:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:39:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:39:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:39:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37393643494578427, 'eval_loss': 1.075462, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [429, 670, 672, 828, 667, 633, 496, 413, 260, 184, 202, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73971880, 'remaining_params': 11045720, 'pruned_model_sparsity': 0.8700772545919904, 'expected_sparsity': 0.86485, 'target_sparsity': 0.95, 'step': 14050}


Iteration:  43%|████▎     | 114/268 [00:21<01:50,  1.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<01:23,  1.84it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<01:03,  2.38it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:50,  3.00it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:40,  3.68it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:34,  4.33it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:29,  5.03it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:26,  5.59it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:23,  6.16it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:21,  6.70it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  6.96it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.26it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.38it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.29it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.60it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.48it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.42it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.49it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.67it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.66it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.56it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.64it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.61it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.60it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.58it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.69it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.72it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.29it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.51it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.54it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.60it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.60it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.58it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.59it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.48it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.38it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.39it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.31it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.43it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.53it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.58it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:39:23,648 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:39:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:39:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:39:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:39:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:39:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:39:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34747470112452616, 'eval_loss': 1.0552093, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [428, 668, 671, 826, 666, 632, 495, 412, 260, 184, 202, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73981072, 'remaining_params': 11036528, 'pruned_model_sparsity': 0.8701853733815116, 'expected_sparsity': 0.86554, 'target_sparsity': 0.95, 'step': 14100}


Iteration:  61%|██████    | 164/268 [00:29<01:14,  1.39it/s][A04/21/2024 16:39:25 - INFO - trainer.trainer_mod - v4 Global step: 14100, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:29<00:55,  1.84it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:42,  2.40it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:33,  3.02it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:27,  3.66it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:22,  4.34it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:19,  4.94it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:17,  5.59it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:15,  6.09it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:14,  6.50it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:14,  6.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.83it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  7.07it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.23it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.36it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.48it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.62it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.58it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.59it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.65it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.67it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.58it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.51it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.58it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.58it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.56it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.53it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.24it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.39it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.47it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.46it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.49it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.49it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.45it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.54it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.57it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.49it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.75it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.69it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.58it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 16:39:32,232 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:39:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:39:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:39:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:39:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.02it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.01it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:39:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:39:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35295074211030203, 'eval_loss': 0.98234, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [428, 666, 669, 824, 664, 631, 494, 411, 260, 184, 202, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 73991796, 'remaining_params': 11025804, 'pruned_model_sparsity': 0.8703115119692864, 'expected_sparsity': 0.86606, 'target_sparsity': 0.95, 'step': 14150}


Iteration:  80%|███████▉  | 214/268 [00:38<00:39,  1.38it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:28,  1.83it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:21,  2.37it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:17,  2.99it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:13,  3.66it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:11,  4.34it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:09,  4.90it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:08,  5.43it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:07,  5.95it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:07,  6.35it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  6.67it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  6.86it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.09it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.27it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.48it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.72it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.68it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.55it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.44it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.67it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.61it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.65it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.54it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.55it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.45it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.35it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.35it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.33it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.25it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.24it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.34it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.69it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.68it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.70it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.60it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.55it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.58it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.64it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.79it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.77it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.73it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.58it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.62it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.66it/s][A[INFO|trainer.py:570] 2024-04-21 16:39:40,812 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:39:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:39:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:39:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:39:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.01it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:39:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:39:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37081606385229765, 'eval_loss': 0.95723325, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [427, 664, 668, 823, 663, 630, 494, 410, 259, 184, 202, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74000988, 'remaining_params': 11016612, 'pruned_model_sparsity': 0.8704196307588076, 'expected_sparsity': 0.86641, 'target_sparsity': 0.95, 'step': 14200}


Iteration:  99%|█████████▊| 264/268 [00:46<00:02,  1.39it/s][A04/21/2024 16:39:42 - INFO - trainer.trainer_mod - v4 Global step: 14200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:46<00:01,  1.84it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  2.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  3.00it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  3.80it/s][A04/21/2024 16:39:43 - INFO - trainer.trainer_mod - Epoch 52 finished. Took 47.23 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  53%|█████▎    | 53/100 [40:56<36:15, 46.28s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.65it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.78it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.96it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.87it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.81it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.74it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.72it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.66it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.68it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.68it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.68it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.70it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:32,  7.82it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.79it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:32,  7.72it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.60it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.60it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.53it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:31,  7.78it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.72it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.55it/s][A
Iteration:   9%|▊         | 23/268 [00:02<00:32,  7.62it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.78it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.78it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.78it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:30,  7.89it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:30,  7.81it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.59it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.61it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:30,  7.62it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.64it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.61it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.61it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.65it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.64it/s][A
Iteration:  14%|█▍        | 38/268 [00:04<00:30,  7.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.54it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.51it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.49it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:30,  7.39it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:30,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:39:49,299 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:39:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:39:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:39:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:39:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.20it/s]04/21/2024 16:39:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:39:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3792448946547048, 'eval_loss': 1.0661249, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [426, 663, 667, 822, 662, 629, 493, 409, 259, 184, 202, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74010180, 'remaining_params': 11007420, 'pruned_model_sparsity': 0.8705277495483288, 'expected_sparsity': 0.86672, 'target_sparsity': 0.95, 'step': 14250}


Iteration:  17%|█▋        | 46/268 [00:07<02:41,  1.38it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:00,  1.83it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:33,  2.35it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:13,  2.97it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:00,  3.62it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:50,  4.29it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:44,  4.90it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:39,  5.51it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:35,  6.01it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:33,  6.44it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:31,  6.81it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.92it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.27it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.36it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.58it/s][A
Iteration:  23%|██▎       | 61/268 [00:09<00:27,  7.52it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.33it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.45it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.50it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.61it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:25,  7.83it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:25,  7.77it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.77it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.77it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.77it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.71it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.71it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.72it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.68it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:25,  7.40it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.59it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.60it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.64it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:23,  7.89it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:23,  7.84it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:23,  7.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:12<00:23,  7.69it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.59it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.49it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.28it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:24,  7.40it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:13<00:24,  7.13it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.40it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:24,  7.26it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:23,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:39:57,873 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:39:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:39:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:39:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:39:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.03it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:39:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:39:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38091498870387097, 'eval_loss': 0.97926486, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [426, 661, 666, 820, 661, 628, 493, 409, 258, 184, 202, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74016308, 'remaining_params': 11001292, 'pruned_model_sparsity': 0.870599828741343, 'expected_sparsity': 0.86705, 'target_sparsity': 0.95, 'step': 14300}


Iteration:  36%|███▌      | 96/268 [00:16<02:04,  1.38it/s][A04/21/2024 16:39:59 - INFO - trainer.trainer_mod - v4 Global step: 14300, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:16<01:33,  1.83it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<01:11,  2.37it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:56,  3.01it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:45,  3.72it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:38,  4.32it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:33,  4.98it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:29,  5.55it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:27,  6.05it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:25,  6.46it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:23,  6.77it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.01it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.11it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  7.16it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.26it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.50it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.58it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.37it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  7.07it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.25it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.30it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.32it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.34it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:20,  7.37it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.60it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.46it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.72it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.57it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.55it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.61it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.57it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.58it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.52it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.55it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.63it/s][A
Iteration:  51%|█████     | 137/268 [00:21<00:17,  7.68it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:16,  7.68it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:16,  7.67it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.71it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.59it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.63it/s][A
Iteration:  54%|█████▎    | 144/268 [00:22<00:16,  7.62it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 16:40:06,452 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:40:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:40:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:40:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:40:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.18it/s]04/21/2024 16:40:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:40:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3643540897764592, 'eval_loss': 1.0036178, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [425, 659, 665, 818, 659, 627, 492, 408, 258, 184, 202, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74027032, 'remaining_params': 10990568, 'pruned_model_sparsity': 0.8707259673291178, 'expected_sparsity': 0.86736, 'target_sparsity': 0.95, 'step': 14350}


Iteration:  54%|█████▍    | 146/268 [00:25<01:28,  1.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<01:06,  1.82it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:50,  2.36it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:39,  3.00it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:32,  3.68it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:26,  4.36it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:23,  5.02it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:20,  5.62it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:18,  6.05it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:17,  6.35it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:16,  6.66it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:16,  6.92it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.14it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.31it/s][A
Iteration:  60%|█████▉    | 160/268 [00:26<00:14,  7.41it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.36it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.30it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.38it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.49it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.45it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.56it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.58it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.42it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.47it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:13,  6.95it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.17it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.32it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.41it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.50it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.68it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.33it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.28it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.55it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.58it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.47it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.38it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.25it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:10,  7.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:31<00:09,  7.43it/s][A
Iteration:  73%|███████▎  | 195/268 [00:31<00:09,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 16:40:15,113 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:40:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:40:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:40:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:40:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:40:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:40:17 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36184579111803034, 'eval_loss': 0.9997351, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [425, 657, 664, 816, 658, 626, 491, 407, 257, 184, 201, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74036224, 'remaining_params': 10981376, 'pruned_model_sparsity': 0.870834086118639, 'expected_sparsity': 0.86763, 'target_sparsity': 0.95, 'step': 14400}


Iteration:  73%|███████▎  | 196/268 [00:33<00:52,  1.38it/s][A04/21/2024 16:40:17 - INFO - trainer.trainer_mod - v4 Global step: 14400, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:33<00:38,  1.83it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:29,  2.38it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:22,  3.00it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:18,  3.68it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:15,  4.34it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:13,  4.98it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:11,  5.57it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:10,  6.05it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:09,  6.38it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:09,  6.71it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.07it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.21it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.36it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.47it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.45it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.52it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.45it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.50it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.54it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.60it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.39it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.42it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.51it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.69it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.69it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.69it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.60it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.61it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.63it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.63it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.62it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.69it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.52it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.59it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.63it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.47it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:04,  7.35it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.50it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.48it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.66it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.66it/s][A
Iteration:  91%|█████████ | 243/268 [00:39<00:03,  7.65it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.58it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:40:23,663 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:40:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:40:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:40:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:40:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.01it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:40:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:40:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37414263466434683, 'eval_loss': 0.9748215, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [424, 655, 663, 814, 656, 625, 491, 406, 257, 184, 201, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74045416, 'remaining_params': 10972184, 'pruned_model_sparsity': 0.8709422049081602, 'expected_sparsity': 0.8679, 'target_sparsity': 0.95, 'step': 14450}


Iteration:  92%|█████████▏| 246/268 [00:42<00:15,  1.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:11,  1.83it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:08,  2.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:06,  3.04it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:04,  3.74it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:03,  4.37it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:03,  4.93it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  5.54it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:02,  6.04it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:02,  6.29it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  6.64it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  6.95it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.02it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  6.99it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.12it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.29it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.40it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.46it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.66it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.68it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.66it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.56it/s][A04/21/2024 16:40:28 - INFO - trainer.trainer_mod - Epoch 53 finished. Took 45.23 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  54%|█████▍    | 54/100 [41:41<35:14, 45.97s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.30it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.43it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.57it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.63it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.33it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.69it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.60it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.51it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.52it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.54it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.49it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.52it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.52it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.60it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.76it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.92it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.84it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.74it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.74it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.56it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:40:32,203 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:40:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:40:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:40:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:40:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.00it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:40:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:40:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38360514223980213, 'eval_loss': 0.96516204, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [423, 654, 662, 812, 655, 624, 490, 406, 256, 184, 201, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74054608, 'remaining_params': 10962992, 'pruned_model_sparsity': 0.8710503236976814, 'expected_sparsity': 0.86817, 'target_sparsity': 0.95, 'step': 14500}


Iteration:  10%|█         | 28/268 [00:05<02:53,  1.38it/s][A04/21/2024 16:40:34 - INFO - trainer.trainer_mod - v4 Global step: 14500, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:05<02:10,  1.83it/s][A
Iteration:  11%|█         | 30/268 [00:05<01:40,  2.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:20,  2.96it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:05,  3.63it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:54,  4.28it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:46,  4.99it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:41,  5.59it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:38,  6.08it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:35,  6.49it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:33,  6.82it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.05it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.23it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.35it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.25it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.35it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.58it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.57it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.41it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.55it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.52it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.59it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.81it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.66it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.42it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.50it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.48it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.54it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.54it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.57it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.62it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.65it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.57it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:25,  7.70it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.70it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.69it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.31it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.33it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.44it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.46it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:40:40,785 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:40:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:40:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:40:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:40:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.99it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.21it/s]04/21/2024 16:40:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:40:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3601876966679831, 'eval_loss': 1.1096497, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [423, 652, 661, 810, 653, 623, 489, 405, 256, 184, 201, 145], 'head_nums': [4, 5, 3, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74063800, 'remaining_params': 10953800, 'pruned_model_sparsity': 0.8711584424872026, 'expected_sparsity': 0.86844, 'target_sparsity': 0.95, 'step': 14550}


Iteration:  29%|██▉       | 78/268 [00:14<02:17,  1.38it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:43,  1.83it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<01:19,  2.37it/s][A
Iteration:  30%|███       | 81/268 [00:14<01:02,  2.99it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:51,  3.63it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:43,  4.29it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:37,  4.95it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:32,  5.55it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:30,  5.98it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:28,  6.40it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.83it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  6.99it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.08it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.27it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.69it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.50it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.56it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.42it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.56it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.55it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.61it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.65it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.66it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.62it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.61it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:20,  7.72it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.81it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.91it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.85it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.77it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.63it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.64it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.67it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.64it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.67it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.85it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:18,  8.03it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.82it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.55it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.56it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.51it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 16:40:49,333 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:40:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:40:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:40:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:40:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:40:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:40:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36902140791515037, 'eval_loss': 1.0888307, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [422, 650, 660, 808, 652, 621, 488, 404, 256, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74270620, 'remaining_params': 10746980, 'pruned_model_sparsity': 0.8735911152514303, 'expected_sparsity': 0.86874, 'target_sparsity': 0.95, 'step': 14600}


Iteration:  48%|████▊     | 128/268 [00:22<01:41,  1.39it/s][A04/21/2024 16:40:51 - INFO - trainer.trainer_mod - v4 Global step: 14600, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:22<01:15,  1.84it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:57,  2.38it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:45,  2.99it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:36,  3.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:30,  4.37it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:26,  5.02it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:23,  5.55it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:21,  6.04it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:20,  6.43it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  6.87it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.19it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  7.00it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.18it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:17,  7.22it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.54it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.55it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.56it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.60it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.49it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.42it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.60it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.39it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.50it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.52it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.57it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:13,  7.74it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.86it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.78it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.46it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.75it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.56it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.66it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.54it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.56it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.58it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.41it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.50it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.43it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.43it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:40:57,899 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:40:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:40:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:40:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:40:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:40:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:40:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37870155291000146, 'eval_loss': 1.0123986, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [421, 648, 660, 806, 650, 621, 488, 404, 255, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74276748, 'remaining_params': 10740852, 'pruned_model_sparsity': 0.8736631944444444, 'expected_sparsity': 0.86897, 'target_sparsity': 0.95, 'step': 14650}


Iteration:  66%|██████▋   | 178/268 [00:31<01:04,  1.39it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:48,  1.84it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:36,  2.39it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:28,  3.04it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:23,  3.71it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:19,  4.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:16,  5.09it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:14,  5.66it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:13,  6.23it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:12,  6.59it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  6.80it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  6.91it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:11,  7.06it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.16it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.23it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.52it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.47it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.40it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.50it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.45it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.48it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.58it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.64it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.68it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.65it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.79it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.73it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.84it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.82it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.56it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.59it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.38it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.45it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.53it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.59it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.59it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.74it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.62it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.55it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.60it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.63it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.49it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.66it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.63it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.70it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.71it/s][A[INFO|trainer.py:570] 2024-04-21 16:41:06,425 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:41:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:41:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:41:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:41:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.93it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.20it/s]04/21/2024 16:41:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:41:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3560083973163597, 'eval_loss': 1.0767605, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [421, 646, 659, 805, 649, 620, 487, 403, 255, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74284408, 'remaining_params': 10733192, 'pruned_model_sparsity': 0.8737532934357122, 'expected_sparsity': 0.86921, 'target_sparsity': 0.95, 'step': 14700}


Iteration:  85%|████████▌ | 228/268 [00:39<00:28,  1.39it/s][A04/21/2024 16:41:08 - INFO - trainer.trainer_mod - v4 Global step: 14700, Alignment: tensor([ 1,  3,  8, 10], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:40<00:21,  1.83it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:16,  2.37it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:12,  2.96it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:09,  3.62it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:08,  4.30it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:06,  4.92it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:06,  5.48it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:05,  5.95it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  6.28it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  6.47it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  6.81it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.02it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.19it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.33it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.53it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.74it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:02,  7.68it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.68it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.49it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.68it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.66it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.07it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.27it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.31it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.25it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.47it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.49it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.62it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.56it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.60it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.50it/s][A04/21/2024 16:41:13 - INFO - trainer.trainer_mod - Epoch 54 finished. Took 45.2 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  55%|█████▌    | 55/100 [42:26<34:18, 45.74s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.40it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.58it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.59it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.64it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.53it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.73it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.59it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:41:15,020 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:41:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:41:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:41:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:41:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:41:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:41:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3538552540687091, 'eval_loss': 1.009415, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [420, 644, 658, 803, 648, 619, 486, 403, 255, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74292068, 'remaining_params': 10725532, 'pruned_model_sparsity': 0.8738433924269798, 'expected_sparsity': 0.8694, 'target_sparsity': 0.95, 'step': 14750}


Iteration:   4%|▎         | 10/268 [00:03<03:10,  1.35it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:22,  1.80it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:48,  2.36it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:26,  2.93it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:10,  3.61it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:58,  4.29it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:52,  4.76it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:47,  5.32it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:43,  5.80it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:39,  6.23it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.58it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:35,  6.90it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:34,  7.08it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.35it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.58it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.51it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:31,  7.68it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:31,  7.58it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.64it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.66it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.68it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:30,  7.65it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.34it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.42it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.48it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.51it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.47it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.42it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.55it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.54it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.45it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.70it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.88it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.86it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.80it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.80it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.69it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.56it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.56it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.45it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.37it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.49it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.53it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:41:23,611 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:41:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:41:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:41:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:41:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:41:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:41:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3673501324020106, 'eval_loss': 1.0246446, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [420, 642, 657, 801, 647, 618, 486, 402, 254, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74299728, 'remaining_params': 10717872, 'pruned_model_sparsity': 0.8739334914182475, 'expected_sparsity': 0.86965, 'target_sparsity': 0.95, 'step': 14800}


Iteration:  22%|██▏       | 60/268 [00:11<02:29,  1.39it/s][A04/21/2024 16:41:25 - INFO - trainer.trainer_mod - v4 Global step: 14800, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:52,  1.84it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:26,  2.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:07,  3.03it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:55,  3.68it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:46,  4.36it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:40,  5.00it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:36,  5.44it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:33,  5.96it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:31,  6.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:28,  6.86it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.11it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.35it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.45it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:25,  7.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.43it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.69it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.70it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:23,  7.82it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.54it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.53it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.42it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:25,  6.98it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.18it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.32it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.22it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.70it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.71it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.61it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:21,  7.81it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:21,  7.90it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.64it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.47it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.55it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.54it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:22,  7.40it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.41it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.40it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.61it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:41:32,181 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:41:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:41:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:41:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:41:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.02it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:41:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:41:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3840987438011726, 'eval_loss': 0.9780705, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [419, 640, 656, 799, 646, 617, 485, 402, 254, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74307388, 'remaining_params': 10710212, 'pruned_model_sparsity': 0.8740235904095152, 'expected_sparsity': 0.86993, 'target_sparsity': 0.95, 'step': 14850}


Iteration:  41%|████      | 110/268 [00:20<01:53,  1.39it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<01:25,  1.84it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<01:05,  2.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:51,  3.00it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:41,  3.68it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:34,  4.40it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:30,  4.97it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:26,  5.62it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:24,  6.11it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:23,  6.43it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.76it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.02it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  7.20it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.20it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.24it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.23it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.43it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.32it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.56it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.59it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.48it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.44it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.43it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.43it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.55it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.56it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.63it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.78it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.49it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.56it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.59it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.59it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.58it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.65it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.67it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.42it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.53it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.46it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.60it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.52it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.56it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.69it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.67it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:13,  7.84it/s][A[INFO|trainer.py:570] 2024-04-21 16:41:40,743 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:41:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:41:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:41:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:41:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:41:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:41:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3896355231376236, 'eval_loss': 0.95763534, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [419, 638, 655, 797, 644, 616, 484, 401, 254, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74316580, 'remaining_params': 10701020, 'pruned_model_sparsity': 0.8741317091990365, 'expected_sparsity': 0.87031, 'target_sparsity': 0.95, 'step': 14900}


Iteration:  60%|█████▉    | 160/268 [00:29<01:17,  1.39it/s][A04/21/2024 16:41:42 - INFO - trainer.trainer_mod - v4 Global step: 14900, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:29<00:58,  1.84it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:44,  2.38it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:34,  3.00it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:28,  3.68it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:23,  4.35it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:20,  5.00it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:18,  5.57it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:16,  6.07it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:15,  6.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.72it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.90it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.07it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.15it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.32it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.32it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.39it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.57it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.57it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.56it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.73it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.67it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.49it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.53it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.59it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.60it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.62it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.73it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.64it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.57it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.72it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.72it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.63it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.62it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.62it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.48it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.67it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.81it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.72it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.84it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.73it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:07,  7.93it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.84it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 16:41:49,292 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:41:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:41:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:41:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:41:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:41:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:41:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3563414498340501, 'eval_loss': 1.159727, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [418, 636, 653, 795, 643, 615, 484, 401, 254, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74324240, 'remaining_params': 10693360, 'pruned_model_sparsity': 0.8742218081903042, 'expected_sparsity': 0.8707, 'target_sparsity': 0.95, 'step': 14950}


Iteration:  78%|███████▊  | 210/268 [00:37<00:41,  1.38it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:30,  1.85it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:23,  2.39it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:18,  3.01it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:14,  3.66it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:12,  4.27it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:10,  4.93it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:09,  5.53it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:08,  6.02it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.43it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:07,  6.77it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.02it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.18it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.35it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.45it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.37it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.35it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.43it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.26it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.43it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.27it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.57it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.63it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.50it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.48it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.52it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.78it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.73it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:02,  7.70it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.73it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.54it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.57it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.58it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.65it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.56it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.55it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.58it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.48it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.48it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.44it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 16:41:57,878 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:41:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:41:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:41:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:41:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:41:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:41:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3482229035873249, 'eval_loss': 1.0902337, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [418, 635, 653, 794, 642, 614, 483, 400, 253, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74331900, 'remaining_params': 10685700, 'pruned_model_sparsity': 0.8743119071815718, 'expected_sparsity': 0.87104, 'target_sparsity': 0.95, 'step': 15000}


Iteration:  97%|█████████▋| 260/268 [00:46<00:05,  1.39it/s][A04/21/2024 16:41:59 - INFO - trainer.trainer_mod - v4 Global step: 15000, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:46<00:03,  1.84it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:02,  2.38it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:01,  3.00it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:01,  3.71it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  4.38it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  5.09it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  5.61it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  6.44it/s][A04/21/2024 16:42:00 - INFO - trainer.trainer_mod - Epoch 55 finished. Took 47.15 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  56%|█████▌    | 56/100 [43:14<33:51, 46.16s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.99it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.18it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.63it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.44it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.67it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.70it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.71it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.74it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.75it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.64it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.50it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.57it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.59it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.51it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.58it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.50it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.69it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.69it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.71it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.72it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.71it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.70it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.66it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.80it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.73it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:30,  7.74it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:30,  7.73it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.59it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.52it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.72it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:29,  7.83it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:29,  7.79it/s][A
Iteration:  14%|█▍        | 38/268 [00:04<00:30,  7.45it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.41it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.46it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 16:42:06,364 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:42:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:42:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:42:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:42:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.21it/s]04/21/2024 16:42:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:42:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35481258251848646, 'eval_loss': 1.0757679, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [417, 634, 652, 792, 640, 613, 482, 400, 253, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74341092, 'remaining_params': 10676508, 'pruned_model_sparsity': 0.874420025971093, 'expected_sparsity': 0.87141, 'target_sparsity': 0.95, 'step': 15050}


Iteration:  16%|█▌        | 42/268 [00:07<02:43,  1.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<02:02,  1.83it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:34,  2.36it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<01:14,  3.01it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:00,  3.68it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:51,  4.31it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:44,  4.97it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:38,  5.62it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:35,  6.12it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:33,  6.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:31,  6.81it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:30,  7.01it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:30,  7.09it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.17it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.30it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.48it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.51it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.44it/s][A
Iteration:  23%|██▎       | 61/268 [00:09<00:27,  7.51it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.53it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.60it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:25,  7.85it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.64it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.65it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:25,  7.80it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.75it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.88it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.84it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:24,  7.93it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:24,  7.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:26,  7.37it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:25,  7.55it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.60it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.63it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.65it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.48it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.54it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.70it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.61it/s][A
Iteration:  31%|███▏      | 84/268 [00:12<00:24,  7.55it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.63it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.61it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:24,  7.23it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:24,  7.34it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.46it/s][A
Iteration:  34%|███▍      | 91/268 [00:13<00:23,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:42:14,922 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:42:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:42:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:42:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:42:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:42:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:42:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37197230635330797, 'eval_loss': 1.0847114, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [417, 632, 650, 791, 639, 612, 482, 400, 253, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74347220, 'remaining_params': 10670380, 'pruned_model_sparsity': 0.8744921051641072, 'expected_sparsity': 0.87172, 'target_sparsity': 0.95, 'step': 15100}


Iteration:  34%|███▍      | 92/268 [00:16<02:07,  1.38it/s][A04/21/2024 16:42:16 - INFO - trainer.trainer_mod - v4 Global step: 15100, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:35,  1.82it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<01:13,  2.37it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:57,  2.99it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:47,  3.66it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:39,  4.35it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:34,  4.93it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:30,  5.54it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:27,  6.13it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:25,  6.47it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:24,  6.69it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:23,  7.01it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:23,  7.01it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:23,  7.08it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:22,  7.16it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.23it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.18it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.32it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.59it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.36it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.45it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.50it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.56it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.49it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.67it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.55it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.56it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.36it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.43it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.52it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.59it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.46it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.54it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.61it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.76it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.61it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.66it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.61it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.62it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.53it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.44it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:42:23,517 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:42:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:42:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:42:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:42:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:42:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:42:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35823474778962877, 'eval_loss': 1.0829757, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [416, 630, 650, 789, 638, 611, 481, 399, 253, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 6, 5, 2, 3, 2, 2, 1], 'pruned_params': 74354880, 'remaining_params': 10662720, 'pruned_model_sparsity': 0.8745822041553749, 'expected_sparsity': 0.87201, 'target_sparsity': 0.95, 'step': 15150}


Iteration:  53%|█████▎    | 142/268 [00:24<01:30,  1.39it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<01:07,  1.85it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:52,  2.38it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:40,  3.00it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:32,  3.70it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:27,  4.40it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:24,  4.99it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:20,  5.67it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:19,  6.14it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:17,  6.57it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:16,  7.04it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  7.13it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.41it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.34it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.37it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.51it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.58it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.61it/s][A
Iteration:  60%|█████▉    | 160/268 [00:26<00:14,  7.55it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  6.98it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.20it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.29it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.20it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:14,  6.98it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:14,  7.07it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:14,  7.16it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.45it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.52it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.53it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.52it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.53it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.48it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.32it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.43it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.72it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.69it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.62it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.57it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.43it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.27it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.48it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.67it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.62it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.49it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.50it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:42:32,142 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:42:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:42:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:42:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:42:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.01it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:42:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:42:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35279279696239413, 'eval_loss': 1.0385711, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [416, 628, 649, 787, 637, 610, 481, 399, 252, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74557104, 'remaining_params': 10460496, 'pruned_model_sparsity': 0.8769608175248419, 'expected_sparsity': 0.87228, 'target_sparsity': 0.95, 'step': 15200}


Iteration:  72%|███████▏  | 192/268 [00:33<00:54,  1.38it/s][A04/21/2024 16:42:34 - INFO - trainer.trainer_mod - v4 Global step: 15200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:33<00:40,  1.83it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:31,  2.37it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:24,  2.99it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:19,  3.62it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:16,  4.29it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:14,  5.00it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:12,  5.59it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:11,  6.17it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:10,  6.46it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:09,  6.78it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:09,  6.99it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:09,  7.06it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.13it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.19it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.23it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.28it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.41it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.48it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.61it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.62it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.76it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.67it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.56it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.58it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.62it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.67it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.69it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.54it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.48it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.53it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.35it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.37it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.45it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.42it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.48it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.57it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.61it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.52it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.60it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.65it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.51it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.69it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.82it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:42:40,718 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:42:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:42:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:42:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:42:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:42:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:42:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3423965414912931, 'eval_loss': 1.0774754, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [415, 626, 648, 785, 636, 609, 480, 399, 252, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 6, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74564764, 'remaining_params': 10452836, 'pruned_model_sparsity': 0.8770509165161096, 'expected_sparsity': 0.87253, 'target_sparsity': 0.95, 'step': 15250}


Iteration:  90%|█████████ | 242/268 [00:41<00:18,  1.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:13,  1.83it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:10,  2.37it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:07,  3.01it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:06,  3.66it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:04,  4.34it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:04,  4.98it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:03,  5.57it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  6.06it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  6.47it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  6.75it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  6.92it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.12it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.29it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.35it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.55it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.59it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.64it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.55it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.69it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.68it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.58it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.54it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.09it/s][A04/21/2024 16:42:46 - INFO - trainer.trainer_mod - Epoch 56 finished. Took 45.22 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  57%|█████▋    | 57/100 [43:59<32:52, 45.88s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.45it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.65it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.47it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.50it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.42it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.27it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.39it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.65it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:31,  7.81it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:31,  7.91it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.83it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.61it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:42:49,249 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:42:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:42:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:42:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:42:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:42:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:42:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38035614823798886, 'eval_loss': 0.99149793, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [415, 625, 647, 784, 635, 608, 480, 398, 251, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74572424, 'remaining_params': 10445176, 'pruned_model_sparsity': 0.8771410155073773, 'expected_sparsity': 0.87272, 'target_sparsity': 0.95, 'step': 15300}


Iteration:   9%|▉         | 24/268 [00:05<02:55,  1.39it/s][A04/21/2024 16:42:51 - INFO - trainer.trainer_mod - v4 Global step: 15300, Alignment: tensor([1, 1, 3, 8], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:11,  1.85it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:42,  2.37it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:20,  2.98it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:05,  3.65it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:55,  4.34it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:47,  5.05it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:42,  5.63it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:38,  6.11it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:36,  6.49it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.71it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  6.89it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:34,  6.74it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:33,  6.98it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.19it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.32it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.56it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.70it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.68it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.70it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.71it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.72it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.85it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.61it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.64it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.65it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.66it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.69it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.59it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.49it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.57it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.72it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.71it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.70it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.49it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.52it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.57it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.59it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.61it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.60it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.54it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.48it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.50it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.54it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.59it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.62it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 16:42:57,788 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:42:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:42:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:42:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:42:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:42:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:42:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36553896706317673, 'eval_loss': 1.1130018, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [415, 623, 646, 782, 634, 607, 479, 398, 251, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74578552, 'remaining_params': 10439048, 'pruned_model_sparsity': 0.8772130947003914, 'expected_sparsity': 0.87288, 'target_sparsity': 0.95, 'step': 15350}


Iteration:  28%|██▊       | 74/268 [00:13<02:18,  1.40it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<01:44,  1.85it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<01:20,  2.40it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:03,  3.01it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:51,  3.69it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:42,  4.43it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:37,  5.08it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:33,  5.65it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:30,  6.11it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:29,  6.32it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:27,  6.63it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:27,  6.71it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.97it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.19it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.29it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.25it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.40it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.36it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.21it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.46it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.42it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.52it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.58it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.57it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.80it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:20,  7.96it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:20,  7.86it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:20,  7.84it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.79it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.54it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.59it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.61it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.64it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.56it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.56it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.73it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.72it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.61it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.51it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.35it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:43:06,362 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:43:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:43:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:43:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:43:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.03it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:43:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:43:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3783588149699711, 'eval_loss': 1.0733386, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [414, 622, 645, 780, 632, 606, 479, 398, 250, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74587744, 'remaining_params': 10429856, 'pruned_model_sparsity': 0.8773212134899127, 'expected_sparsity': 0.87306, 'target_sparsity': 0.95, 'step': 15400}


Iteration:  46%|████▋     | 124/268 [00:22<01:43,  1.39it/s][A04/21/2024 16:43:08 - INFO - trainer.trainer_mod - v4 Global step: 15400, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:22<01:18,  1.83it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:59,  2.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:46,  3.00it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:38,  3.62it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:31,  4.35it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:27,  4.95it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:24,  5.61it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:21,  6.21it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:21,  6.36it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:20,  6.68it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:19,  6.84it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:20,  6.53it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.84it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.05it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  7.10it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.52it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.42it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.53it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.61it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.73it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.74it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.42it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.58it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.47it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.52it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.56it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.52it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.57it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.61it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.58it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.57it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.58it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.57it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.42it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:14,  7.32it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.36it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.65it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.64it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.63it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.41it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.66it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.79it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.65it/s][A[INFO|trainer.py:570] 2024-04-21 16:43:14,980 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:43:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:43:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:43:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:43:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:43:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:43:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34304246160206686, 'eval_loss': 1.0319555, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [414, 620, 644, 778, 631, 605, 478, 397, 250, 184, 201, 145], 'head_nums': [4, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74595404, 'remaining_params': 10422196, 'pruned_model_sparsity': 0.8774113124811803, 'expected_sparsity': 0.8732, 'target_sparsity': 0.95, 'step': 15450}


Iteration:  65%|██████▍   | 174/268 [00:30<01:07,  1.38it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:50,  1.83it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:39,  2.35it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:30,  2.97it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:24,  3.61it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:20,  4.24it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:18,  4.72it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:16,  5.28it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:14,  5.90it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:13,  6.42it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.78it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  6.95it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.10it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.29it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.37it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.65it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.57it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.55it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.63it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.56it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.59it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.63it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.63it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.53it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.46it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.62it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.66it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.64it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.79it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.70it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.64it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.67it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.61it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.61it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.63it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.60it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.59it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.63it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.55it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.49it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.51it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.45it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 16:43:23,567 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:43:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:43:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:43:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:43:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:43:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:43:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38219688346762354, 'eval_loss': 1.1152332, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [413, 619, 643, 776, 630, 604, 478, 397, 250, 184, 201, 145], 'head_nums': [3, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74797628, 'remaining_params': 10219972, 'pruned_model_sparsity': 0.8797899258506474, 'expected_sparsity': 0.87335, 'target_sparsity': 0.95, 'step': 15500}


Iteration:  84%|████████▎ | 224/268 [00:39<00:31,  1.39it/s][A04/21/2024 16:43:25 - INFO - trainer.trainer_mod - v4 Global step: 15500, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:39<00:23,  1.85it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:17,  2.40it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:13,  3.02it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:10,  3.68it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:08,  4.40it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:07,  5.04it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:06,  5.61it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.10it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:05,  6.47it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:05,  6.79it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.02it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.09it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.26it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.34it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.57it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.57it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.64it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.64it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.57it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.67it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.58it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.67it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.66it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.51it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.58it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.51it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.56it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.59it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.55it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.56it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.26it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.50it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.40it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.33it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.54it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.59it/s][A04/21/2024 16:43:31 - INFO - trainer.trainer_mod - Epoch 57 finished. Took 45.23 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  58%|█████▊    | 58/100 [44:44<31:58, 45.68s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.72it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.97it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.60it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.58it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:43:32,092 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:43:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:43:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:43:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:43:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:43:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:43:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.396232439045943, 'eval_loss': 1.0896447, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [413, 616, 642, 774, 629, 603, 478, 397, 249, 184, 201, 145], 'head_nums': [3, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74803756, 'remaining_params': 10213844, 'pruned_model_sparsity': 0.8798620050436615, 'expected_sparsity': 0.8735, 'target_sparsity': 0.95, 'step': 15550}


Iteration:   2%|▏         | 6/268 [00:02<03:29,  1.25it/s][A
Iteration:   3%|▎         | 7/268 [00:02<02:31,  1.72it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:53,  2.28it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:27,  2.95it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:10,  3.65it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:59,  4.30it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:51,  4.95it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:46,  5.53it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:43,  5.89it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:39,  6.33it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:37,  6.68it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:36,  6.90it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:35,  7.02it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.23it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.26it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.33it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.43it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.42it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.42it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.59it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:30,  7.81it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:30,  7.80it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:30,  7.77it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:30,  7.74it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.52it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.53it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.61it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:30,  7.59it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.62it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.56it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.63it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.51it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.54it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.45it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.42it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.38it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.51it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.47it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.55it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.55it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.74it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.59it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.60it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:27,  7.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.76it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.63it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 16:43:40,665 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:43:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:43:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:43:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:43:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:43:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:43:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3767520669807055, 'eval_loss': 0.9884568, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [412, 614, 641, 772, 628, 601, 477, 396, 249, 184, 201, 145], 'head_nums': [3, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74814480, 'remaining_params': 10203120, 'pruned_model_sparsity': 0.8799881436314363, 'expected_sparsity': 0.87365, 'target_sparsity': 0.95, 'step': 15600}


Iteration:  21%|██        | 56/268 [00:11<02:33,  1.38it/s][A04/21/2024 16:43:42 - INFO - trainer.trainer_mod - v4 Global step: 15600, Alignment: tensor([ 3,  3,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:11<01:55,  1.83it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<01:28,  2.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:09,  3.01it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:56,  3.66it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:47,  4.34it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:41,  4.92it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:37,  5.52it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:33,  6.01it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.46it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:29,  6.76it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:28,  6.98it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:27,  7.18it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.34it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.53it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:25,  7.67it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:24,  7.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.60it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:25,  7.64it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.59it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:24,  7.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.76it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.72it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.71it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.72it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:23,  7.72it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:24,  7.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.11it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.16it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.28it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:25,  7.13it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  7.08it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.24it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.16it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.33it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.38it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.38it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.48it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.57it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.42it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.50it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.52it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 16:43:49,278 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:43:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:43:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:43:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:43:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:43:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:43:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3417099112893187, 'eval_loss': 1.129886, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [412, 612, 641, 770, 627, 601, 477, 396, 249, 184, 201, 145], 'head_nums': [3, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74816012, 'remaining_params': 10201588, 'pruned_model_sparsity': 0.8800061634296898, 'expected_sparsity': 0.87375, 'target_sparsity': 0.95, 'step': 15650}


Iteration:  40%|███▉      | 106/268 [00:19<01:57,  1.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:27,  1.84it/s][A
Iteration:  40%|████      | 108/268 [00:20<01:06,  2.39it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:52,  3.01it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:43,  3.59it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:37,  4.20it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:32,  4.81it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:29,  5.32it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:26,  5.75it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:24,  6.22it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.61it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:22,  6.79it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:21,  6.97it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  7.07it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.16it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.33it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.57it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.50it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.52it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.35it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.48it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:18,  7.56it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.48it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.57it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.60it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.65it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.70it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:16,  7.84it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:16,  7.81it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.74it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.71it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.72it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.72it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.67it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.46it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.52it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.57it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.62it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.45it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.49it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.67it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.57it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.54it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:43:57,887 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:43:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:43:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:43:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:43:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.15it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:43:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:43:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3487217667464579, 'eval_loss': 1.1566825, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [411, 610, 640, 768, 626, 600, 476, 396, 248, 184, 201, 145], 'head_nums': [3, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74825204, 'remaining_params': 10192396, 'pruned_model_sparsity': 0.8801142822192111, 'expected_sparsity': 0.87389, 'target_sparsity': 0.95, 'step': 15700}


Iteration:  58%|█████▊    | 156/268 [00:28<01:20,  1.39it/s][A04/21/2024 16:43:59 - INFO - trainer.trainer_mod - v4 Global step: 15700, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:28<01:00,  1.83it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:46,  2.37it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:36,  2.97it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:29,  3.60it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:25,  4.25it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:21,  4.92it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:18,  5.54it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:17,  6.06it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.48it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:15,  6.80it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:14,  7.01it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.19it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.31it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.25it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.39it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.47it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.53it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.48it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.53it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.60it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.64it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.53it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.58it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.60it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.62it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.72it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.71it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.76it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.71it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.64it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.65it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.65it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.65it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.66it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.68it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.69it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.70it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.66it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.58it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.51it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.55it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.58it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.58it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.50it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.66it/s][A[INFO|trainer.py:570] 2024-04-21 16:44:06,433 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:44:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:44:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:44:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:44:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.20it/s]04/21/2024 16:44:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:44:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3598794855637006, 'eval_loss': 1.0602556, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [411, 610, 639, 766, 625, 599, 476, 396, 248, 184, 201, 145], 'head_nums': [3, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74829800, 'remaining_params': 10187800, 'pruned_model_sparsity': 0.8801683416139717, 'expected_sparsity': 0.87401, 'target_sparsity': 0.95, 'step': 15750}


Iteration:  77%|███████▋  | 206/268 [00:37<00:44,  1.39it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:33,  1.84it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:24,  2.41it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:19,  3.04it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:15,  3.68it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:13,  4.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:11,  4.95it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:10,  5.44it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:08,  6.07it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:08,  6.39it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  6.66it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  6.91it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  7.11it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.50it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.55it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.56it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:05,  7.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.56it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.70it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.57it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.74it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.69it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.51it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.35it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.45it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.43it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.46it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.35it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.74it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.72it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.72it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.74it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.74it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.75it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.74it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.86it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:02,  7.82it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.52it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.46it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.70it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.65it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.66it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.68it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.68it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.73it/s][A[INFO|trainer.py:570] 2024-04-21 16:44:14,955 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:44:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:44:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:44:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:44:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.03it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:44:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:44:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37033710191144653, 'eval_loss': 0.9163629, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [410, 607, 638, 764, 624, 598, 475, 395, 247, 184, 200, 145], 'head_nums': [3, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74840524, 'remaining_params': 10177076, 'pruned_model_sparsity': 0.8802944802017465, 'expected_sparsity': 0.87415, 'target_sparsity': 0.95, 'step': 15800}


Iteration:  96%|█████████▌| 256/268 [00:45<00:08,  1.39it/s][A04/21/2024 16:44:16 - INFO - trainer.trainer_mod - v4 Global step: 15800, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:45<00:05,  1.85it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:04,  2.40it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:03,  2.98it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:02,  3.63it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  4.30it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:01,  4.87it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  5.46it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  5.87it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.30it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  6.21it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  6.59it/s][A04/21/2024 16:44:18 - INFO - trainer.trainer_mod - Epoch 58 finished. Took 47.22 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  59%|█████▉    | 59/100 [45:31<31:31, 46.15s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.84it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.81it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.66it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.81it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.61it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.51it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.70it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.70it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:32,  7.81it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:32,  7.89it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:32,  7.83it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.81it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:32,  7.80it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.77it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.74it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.62it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.44it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.70it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.72it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.92it/s][A
Iteration:   9%|▊         | 23/268 [00:02<00:31,  7.87it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.84it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.56it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.37it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.31it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.33it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.42it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:32,  7.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.47it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.55it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.45it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.53it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.71it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:29,  7.71it/s][A[INFO|trainer.py:570] 2024-04-21 16:44:23,494 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:44:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:44:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:44:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:44:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:44:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:44:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37285447368599084, 'eval_loss': 1.0483706, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [410, 606, 637, 763, 622, 597, 475, 395, 247, 184, 200, 145], 'head_nums': [3, 5, 2, 3, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74846652, 'remaining_params': 10170948, 'pruned_model_sparsity': 0.8803665593947606, 'expected_sparsity': 0.87416, 'target_sparsity': 0.95, 'step': 15850}


Iteration:  14%|█▍        | 38/268 [00:06<02:45,  1.39it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:04,  1.84it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:35,  2.38it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:15,  3.01it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:01,  3.69it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:51,  4.36it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:44,  5.01it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:39,  5.58it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:37,  5.98it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:33,  6.50it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.81it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  7.03it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.22it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.46it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.69it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.67it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.78it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:26,  7.94it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:26,  7.87it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:26,  7.80it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:26,  7.81it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.58it/s][A
Iteration:  23%|██▎       | 61/268 [00:09<00:27,  7.47it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.56it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.67it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.61it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.63it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.68it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.65it/s][A
Iteration:  26%|██▌       | 69/268 [00:10<00:26,  7.59it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.61it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.60it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.34it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:26,  7.30it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:26,  7.39it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:25,  7.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.36it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.41it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.47it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.53it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.56it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.58it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.60it/s][A
Iteration:  31%|███▏      | 84/268 [00:12<00:23,  7.67it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.64it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 16:44:32,043 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:44:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:44:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:44:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:44:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:44:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:44:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37155283492651514, 'eval_loss': 1.0616894, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [410, 604, 637, 761, 621, 596, 474, 395, 246, 184, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74852780, 'remaining_params': 10164820, 'pruned_model_sparsity': 0.8804386385877747, 'expected_sparsity': 0.87437, 'target_sparsity': 0.95, 'step': 15900}


Iteration:  33%|███▎      | 88/268 [00:15<02:10,  1.38it/s][A04/21/2024 16:44:34 - INFO - trainer.trainer_mod - v4 Global step: 15900, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:15<01:37,  1.83it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<01:15,  2.37it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:59,  2.99it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:47,  3.69it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:40,  4.36it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:34,  4.97it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:31,  5.56it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:28,  6.06it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:26,  6.40it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:25,  6.75it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:24,  6.98it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.30it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.61it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.43it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.51it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.70it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.67it/s][A
Iteration:  40%|███▉      | 107/268 [00:17<00:20,  7.68it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.54it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.43it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.52it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.60it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.44it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:20,  7.27it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.51it/s][A
Iteration:  46%|████▌     | 122/268 [00:19<00:19,  7.55it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.48it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.45it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.54it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.48it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.40it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.36it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.33it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.53it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.54it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.78it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.62it/s][A
Iteration:  51%|█████     | 137/268 [00:21<00:16,  7.77it/s][A[INFO|trainer.py:570] 2024-04-21 16:44:40,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:44:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:44:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:44:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:44:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:44:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:44:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3568992381406405, 'eval_loss': 1.0678295, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [409, 602, 636, 760, 620, 595, 474, 394, 245, 184, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74861972, 'remaining_params': 10155628, 'pruned_model_sparsity': 0.880546757377296, 'expected_sparsity': 0.87444, 'target_sparsity': 0.95, 'step': 15950}


Iteration:  51%|█████▏    | 138/268 [00:24<01:33,  1.38it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<01:10,  1.83it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:53,  2.39it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:42,  3.01it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:33,  3.71it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:28,  4.42it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:24,  5.02it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:21,  5.61it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:20,  6.03it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:18,  6.44it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:17,  6.77it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:17,  6.90it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:16,  7.02it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:16,  7.03it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:16,  7.01it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  7.04it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.23it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.46it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.42it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.49it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.45it/s][A
Iteration:  60%|█████▉    | 160/268 [00:26<00:14,  7.70it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.67it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.55it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.59it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.59it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.64it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.55it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.56it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.50it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.67it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:13,  6.96it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:13,  6.99it/s][A
Iteration:  65%|██████▌   | 175/268 [00:28<00:12,  7.21it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.30it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.22it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.37it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.49it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.78it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:10,  7.97it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:10,  7.87it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.71it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.72it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.72it/s][A[INFO|trainer.py:570] 2024-04-21 16:44:49,199 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:44:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:44:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:44:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:44:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:44:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:44:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3521021677658903, 'eval_loss': 0.9915796, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [409, 600, 635, 758, 619, 594, 474, 394, 245, 184, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74866568, 'remaining_params': 10151032, 'pruned_model_sparsity': 0.8806008167720566, 'expected_sparsity': 0.87459, 'target_sparsity': 0.95, 'step': 16000}


Iteration:  70%|███████   | 188/268 [00:32<00:57,  1.39it/s][A04/21/2024 16:44:51 - INFO - trainer.trainer_mod - v4 Global step: 16000, Alignment: tensor([ 1,  3,  8, 10], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:32<00:42,  1.84it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:32,  2.37it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:25,  2.98it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:20,  3.65it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:17,  4.30it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:14,  4.96it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:13,  5.50it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:11,  6.10it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:11,  6.43it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:10,  6.67it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  6.93it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.17it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.33it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.48it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.54it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.58it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.73it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.71it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.60it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.39it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.36it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.36it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.43it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.41it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.66it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.58it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.62it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.47it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.50it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.41it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.50it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.68it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.72it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.67it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.65it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.67it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.53it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.61it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.62it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.70it/s][A
Iteration:  88%|████████▊ | 236/268 [00:38<00:04,  7.70it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.72it/s][A[INFO|trainer.py:570] 2024-04-21 16:44:57,753 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:44:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:44:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:44:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:44:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:44:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:44:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3613488382862961, 'eval_loss': 1.0402043, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [408, 598, 634, 755, 618, 593, 473, 393, 245, 184, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74875760, 'remaining_params': 10141840, 'pruned_model_sparsity': 0.8807089355615778, 'expected_sparsity': 0.8747, 'target_sparsity': 0.95, 'step': 16050}


Iteration:  89%|████████▉ | 238/268 [00:41<00:21,  1.40it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:15,  1.85it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:11,  2.39it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:08,  3.02it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:07,  3.70it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:05,  4.33it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:04,  4.99it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:04,  5.57it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  6.00it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:03,  6.22it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  6.67it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  6.94it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.02it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.20it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.34it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.43it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.54it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.63it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.67it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.56it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.54it/s][A
Iteration:  97%|█████████▋| 259/268 [00:43<00:01,  7.60it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.61it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.65it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.56it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.71it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.54it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.69it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.20it/s][A04/21/2024 16:45:03 - INFO - trainer.trainer_mod - Epoch 59 finished. Took 45.11 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.94it/s]
Epoch:  60%|██████    | 60/100 [46:16<30:33, 45.84s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.96it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.62it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.72it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.67it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:37,  7.01it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.22it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.24it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.39it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.56it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:32,  7.80it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.76it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.65it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.65it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.53it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:45:06,300 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:45:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:45:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:45:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:45:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.84it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.20it/s]04/21/2024 16:45:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:45:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3551738104338051, 'eval_loss': 0.9768693, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [408, 597, 633, 754, 617, 593, 473, 393, 245, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74880356, 'remaining_params': 10137244, 'pruned_model_sparsity': 0.8807629949563385, 'expected_sparsity': 0.87473, 'target_sparsity': 0.95, 'step': 16100}


Iteration:   7%|▋         | 20/268 [00:04<02:59,  1.38it/s][A04/21/2024 16:45:08 - INFO - trainer.trainer_mod - v4 Global step: 16100, Alignment: tensor([ 6,  7,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:14,  1.83it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:44,  2.36it/s][A
Iteration:   9%|▊         | 23/268 [00:05<01:22,  2.97it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:07,  3.64it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:56,  4.27it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:49,  4.94it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:43,  5.59it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:39,  6.06it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:37,  6.42it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:35,  6.76it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.11it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.41it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.49it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.51it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.52it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:29,  7.71it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.64it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.64it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.63it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.66it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.62it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.61it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.60it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.63it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.68it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.69it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:27,  7.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:27,  7.81it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.78it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.75it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.75it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.72it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.69it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.67it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.72it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.67it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.69it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.60it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.52it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.56it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.63it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.55it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.61it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 16:45:14,830 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:45:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:45:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:45:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:45:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:45:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:45:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3834646636732988, 'eval_loss': 0.97199124, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [408, 595, 632, 753, 616, 592, 472, 392, 245, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74888016, 'remaining_params': 10129584, 'pruned_model_sparsity': 0.8808530939476061, 'expected_sparsity': 0.87486, 'target_sparsity': 0.95, 'step': 16150}


Iteration:  26%|██▌       | 70/268 [00:13<02:22,  1.39it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:47,  1.84it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<01:22,  2.38it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<01:04,  3.00it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:52,  3.68it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:45,  4.27it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:39,  4.88it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:35,  5.43it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:31,  5.95it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:29,  6.32it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.68it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.93it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:26,  7.12it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:25,  7.29it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.68it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.66it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:22,  7.87it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:22,  7.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:22,  7.76it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:22,  7.78it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.54it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.62it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.65it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.58it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.70it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.45it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:22,  7.68it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.65it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.57it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.56it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.59it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.45it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.52it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.55it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.49it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.31it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.65it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.65it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.56it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.61it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.66it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:45:23,395 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:45:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:45:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:45:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:45:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:45:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:45:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37037472291796913, 'eval_loss': 1.0038142, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [407, 593, 632, 751, 615, 591, 472, 392, 244, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74894144, 'remaining_params': 10123456, 'pruned_model_sparsity': 0.8809251731406202, 'expected_sparsity': 0.87491, 'target_sparsity': 0.95, 'step': 16200}


Iteration:  45%|████▍     | 120/268 [00:21<01:47,  1.38it/s][A04/21/2024 16:45:25 - INFO - trainer.trainer_mod - v4 Global step: 16200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:21<01:20,  1.83it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<01:01,  2.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:49,  2.94it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:40,  3.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:33,  4.28it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:29,  4.89it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:25,  5.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:23,  5.95it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:21,  6.38it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.71it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  6.98it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.18it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.41it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.49it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.42it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.50it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.57it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.57it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.51it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.45it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.59it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.62it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.44it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.68it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.57it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.62it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.63it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.59it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.59it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.62it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.55it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.57it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.60it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.41it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.49it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.54it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.57it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.59it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.75it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.73it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.70it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.69it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.60it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:45:31,970 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:45:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:45:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:45:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:45:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:45:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:45:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38638285517962173, 'eval_loss': 0.8856109, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [407, 592, 631, 749, 613, 590, 471, 391, 244, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74903336, 'remaining_params': 10114264, 'pruned_model_sparsity': 0.8810332919301416, 'expected_sparsity': 0.87506, 'target_sparsity': 0.95, 'step': 16250}


Iteration:  63%|██████▎   | 170/268 [00:30<01:10,  1.39it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:53,  1.83it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:40,  2.37it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:32,  2.96it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:26,  3.57it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:21,  4.24it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:19,  4.81it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:17,  5.33it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:15,  5.94it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:13,  6.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  6.80it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  6.95it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  7.16it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.19it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.21it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.21it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.32it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.43it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.42it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.46it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.55it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.20it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.32it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.14it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.42it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.67it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.69it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:08,  7.78it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.66it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.71it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.68it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.52it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.56it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.60it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.57it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.49it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.47it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.44it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.52it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.77it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.30it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.28it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.19it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.33it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.31it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:45:40,651 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:45:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:45:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:45:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:45:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:45:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:45:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3914586136930734, 'eval_loss': 0.96910733, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [406, 590, 631, 747, 612, 589, 471, 391, 244, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74907932, 'remaining_params': 10109668, 'pruned_model_sparsity': 0.8810873513249021, 'expected_sparsity': 0.87513, 'target_sparsity': 0.95, 'step': 16300}


Iteration:  82%|████████▏ | 220/268 [00:38<00:34,  1.38it/s][A04/21/2024 16:45:42 - INFO - trainer.trainer_mod - v4 Global step: 16300, Alignment: tensor([ 1,  3,  8, 10], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:39<00:25,  1.83it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:19,  2.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:15,  2.99it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:12,  3.64it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:10,  4.26it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:08,  4.87it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:07,  5.48it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:06,  5.99it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:06,  6.42it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  6.68it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.97it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.06it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.12it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.41it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.33it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.42it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.49it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.52it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.42it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.52it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.60it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.63it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:02,  7.68it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.68it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.68it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.63it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.55it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.60it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.64it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.62it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.64it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.54it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.62it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.68it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.80it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.59it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.46it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.53it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.42it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.48it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.46it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.53it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.70it/s][A04/21/2024 16:45:48 - INFO - trainer.trainer_mod - Epoch 60 finished. Took 45.29 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  61%|██████    | 61/100 [47:02<29:41, 45.67s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:32,  8.16it/s][A[INFO|trainer.py:570] 2024-04-21 16:45:49,179 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:45:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:45:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:45:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:45:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:45:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:45:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36936108535409234, 'eval_loss': 1.0514119, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [406, 588, 629, 745, 611, 588, 471, 391, 244, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74914060, 'remaining_params': 10103540, 'pruned_model_sparsity': 0.8811594305179163, 'expected_sparsity': 0.87519, 'target_sparsity': 0.95, 'step': 16350}


Iteration:   1%|          | 2/268 [00:02<05:40,  1.28s/it][A
Iteration:   1%|          | 3/268 [00:02<03:20,  1.32it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:14,  1.96it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:38,  2.67it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:15,  3.47it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:01,  4.23it/s][A
Iteration:   3%|▎         | 8/268 [00:02<00:52,  4.91it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:46,  5.53it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:43,  5.95it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:40,  6.34it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:38,  6.70it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:35,  7.09it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:35,  7.25it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:35,  7.20it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:34,  7.35it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:34,  7.36it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:33,  7.47it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:33,  7.53it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:32,  7.58it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:32,  7.60it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.42it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:33,  7.36it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.44it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.42it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.51it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:31,  7.59it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.59it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.48it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.38it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.47it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.35it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.52it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.56it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.56it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.58it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.62it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.50it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.54it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.44it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.41it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.36it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.31it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.41it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.50it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:45:57,789 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:45:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:45:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:45:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:45:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:45:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:45:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.369870679490583, 'eval_loss': 1.0119559, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [405, 586, 628, 743, 610, 587, 470, 390, 243, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 5, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74924784, 'remaining_params': 10092816, 'pruned_model_sparsity': 0.881285569105691, 'expected_sparsity': 0.87532, 'target_sparsity': 0.95, 'step': 16400}


Iteration:  19%|█▉        | 52/268 [00:10<02:35,  1.39it/s][A04/21/2024 16:45:59 - INFO - trainer.trainer_mod - v4 Global step: 16400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:10<01:57,  1.83it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:29,  2.38it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:11,  3.00it/s][A
Iteration:  21%|██        | 56/268 [00:11<00:58,  3.64it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:48,  4.32it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:42,  4.97it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:38,  5.50it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:35,  5.78it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:33,  6.21it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:31,  6.57it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:29,  6.87it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:28,  7.08it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:28,  7.21it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:28,  7.17it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:27,  7.21it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:27,  7.35it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:26,  7.41it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.35it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:27,  7.28it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:26,  7.49it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.65it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:24,  7.65it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.53it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.62it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.66it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.76it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:23,  7.76it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:23,  7.84it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:23,  7.81it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.78it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.72it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.69it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:22,  7.93it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:22,  7.82it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:22,  7.80it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.66it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.58it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.24it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.39it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.63it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 16:46:06,375 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:46:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:46:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:46:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:46:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.98it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:46:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:46:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3573647697270512, 'eval_loss': 1.0322022, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [405, 584, 627, 742, 609, 586, 469, 390, 243, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74930912, 'remaining_params': 10086688, 'pruned_model_sparsity': 0.8813576482987052, 'expected_sparsity': 0.87537, 'target_sparsity': 0.95, 'step': 16450}


Iteration:  38%|███▊      | 102/268 [00:19<01:59,  1.39it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<01:29,  1.84it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<01:08,  2.38it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:53,  3.02it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:44,  3.67it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:36,  4.35it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:32,  4.95it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:28,  5.49it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:26,  5.95it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:22,  6.77it/s][A
Iteration:  43%|████▎     | 114/268 [00:21<00:22,  6.93it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:21,  7.16it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:20,  7.33it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:20,  7.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:19,  7.54it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:19,  7.57it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:19,  7.57it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.59it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.39it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.60it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.65it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:17,  7.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.56it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.64it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.67it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.68it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.69it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:16,  7.74it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:16,  7.71it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.61it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.52it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.72it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.61it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.56it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.62it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.60it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.49it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.53it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:46:14,961 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:46:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:46:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:46:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:46:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:46:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:46:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3688407112239893, 'eval_loss': 1.0392, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [405, 582, 627, 740, 608, 585, 469, 390, 243, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74933976, 'remaining_params': 10083624, 'pruned_model_sparsity': 0.8813936878952123, 'expected_sparsity': 0.87544, 'target_sparsity': 0.95, 'step': 16500}


Iteration:  57%|█████▋    | 152/268 [00:27<01:24,  1.38it/s][A04/21/2024 16:46:16 - INFO - trainer.trainer_mod - v4 Global step: 16500, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:28<01:02,  1.83it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:48,  2.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:37,  2.99it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:30,  3.64it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:25,  4.30it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:22,  4.94it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:19,  5.53it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:18,  5.92it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.36it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.75it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.96it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.17it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.19it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.34it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:12,  7.74it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.32it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.41it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.38it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.30it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.30it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.37it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.38it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.55it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.78it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.75it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.74it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.63it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.47it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.51it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.70it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.67it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.65it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.66it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.66it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.53it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.52it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.59it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.62it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.66it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.69it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.54it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.36it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:46:23,552 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:46:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:46:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:46:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:46:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:46:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:46:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35227643702682615, 'eval_loss': 1.0033864, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [404, 580, 625, 738, 607, 584, 468, 389, 243, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74944700, 'remaining_params': 10072900, 'pruned_model_sparsity': 0.8815198264829871, 'expected_sparsity': 0.87555, 'target_sparsity': 0.95, 'step': 16550}


Iteration:  75%|███████▌  | 202/268 [00:36<00:47,  1.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:35,  1.83it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:26,  2.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:21,  3.00it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:16,  3.67it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:14,  4.35it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:11,  5.01it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:10,  5.70it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:09,  6.11it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.52it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.79it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:07,  6.90it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.97it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.34it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:06,  7.44it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.43it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.34it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.42it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.38it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.46it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.49it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.44it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.49it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.44it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.50it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.69it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:04,  7.70it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.59it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.60it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.60it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.78it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.68it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.61it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.61it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.51it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.70it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.72it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.53it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.57it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.52it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.77it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.89it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.68it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.70it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.71it/s][A[INFO|trainer.py:570] 2024-04-21 16:46:32,090 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:46:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:46:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:46:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:46:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:46:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:46:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3689767835483015, 'eval_loss': 1.0477355, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [404, 578, 625, 736, 606, 583, 468, 389, 243, 183, 200, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74947764, 'remaining_params': 10069836, 'pruned_model_sparsity': 0.8815558660794941, 'expected_sparsity': 0.87563, 'target_sparsity': 0.95, 'step': 16600}


Iteration:  94%|█████████▍| 252/268 [00:45<00:11,  1.39it/s][A04/21/2024 16:46:34 - INFO - trainer.trainer_mod - v4 Global step: 16600, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:45<00:08,  1.84it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:05,  2.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:04,  2.99it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:03,  3.70it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:02,  4.34it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:02,  4.94it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:01,  5.52it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.01it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  7.16it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.32it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.87it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.09it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.26it/s][A04/21/2024 16:46:36 - INFO - trainer.trainer_mod - Epoch 61 finished. Took 47.22 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  62%|██████▏   | 62/100 [47:49<29:13, 46.14s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.72it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.76it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.71it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.56it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.42it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.64it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.66it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.71it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.65it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.52it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.57it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.50it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.52it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.57it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.64it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.54it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.55it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.61it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.67it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.57it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.61it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.55it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.61it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:30,  7.76it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.63it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:33,  7.02it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:33,  7.13it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 16:46:40,661 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:46:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:46:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:46:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:46:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.01it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:46:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:46:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3472635288979699, 'eval_loss': 0.9119144, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [404, 577, 624, 734, 605, 582, 467, 388, 242, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74956956, 'remaining_params': 10060644, 'pruned_model_sparsity': 0.8816639848690153, 'expected_sparsity': 0.8757, 'target_sparsity': 0.95, 'step': 16650}


Iteration:  13%|█▎        | 34/268 [00:06<02:49,  1.38it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:07,  1.83it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:38,  2.35it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<01:17,  2.99it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:02,  3.65it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:52,  4.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:45,  4.98it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:41,  5.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:37,  5.98it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:36,  6.24it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:33,  6.71it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:31,  6.99it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.20it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.38it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.50it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.69it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.49it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.55it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.70it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.56it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.77it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.71it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.30it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.66it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.57it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.58it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.41it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.59it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.62it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.69it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:24,  7.89it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.68it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:24,  7.89it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:24,  7.87it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:24,  7.85it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.76it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.63it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.54it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.61it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.51it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.52it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.59it/s][A[INFO|trainer.py:570] 2024-04-21 16:46:49,205 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:46:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:46:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:46:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:46:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:46:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:46:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3423965414912931, 'eval_loss': 1.0885077, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [403, 575, 623, 733, 604, 581, 467, 388, 242, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74963084, 'remaining_params': 10054516, 'pruned_model_sparsity': 0.8817360640620295, 'expected_sparsity': 0.87578, 'target_sparsity': 0.95, 'step': 16700}


Iteration:  31%|███▏      | 84/268 [00:15<02:12,  1.39it/s][A04/21/2024 16:46:51 - INFO - trainer.trainer_mod - v4 Global step: 16700, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:39,  1.84it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<01:16,  2.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:00,  3.00it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:49,  3.67it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:41,  4.31it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:36,  4.92it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:31,  5.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:29,  6.05it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:26,  6.58it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:25,  6.79it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:24,  7.05it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.33it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.40it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.48it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:22,  7.41it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.46it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.52it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.56it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.60it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.59it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.57it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.56it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.61it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.58it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.46it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.39it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.43it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:19,  7.76it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.60it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.55it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.37it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.28it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.39it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.42it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.43it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.63it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.63it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.68it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.61it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.55it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.64it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.69it/s][A[INFO|trainer.py:570] 2024-04-21 16:46:57,765 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:46:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:46:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:46:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:46:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:46:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:46:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34821575954561074, 'eval_loss': 1.1456349, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [403, 574, 622, 731, 604, 581, 466, 387, 242, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74967680, 'remaining_params': 10049920, 'pruned_model_sparsity': 0.8817901234567901, 'expected_sparsity': 0.87584, 'target_sparsity': 0.95, 'step': 16750}


Iteration:  50%|█████     | 134/268 [00:23<01:36,  1.39it/s][A
Iteration:  50%|█████     | 135/268 [00:23<01:12,  1.85it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:55,  2.39it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:43,  3.04it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:35,  3.70it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:29,  4.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:25,  5.00it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:23,  5.51it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:21,  5.92it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:19,  6.34it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:18,  6.61it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  6.90it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  7.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.29it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.29it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.36it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.59it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.56it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.54it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.48it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.29it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.32it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.34it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.45it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.14it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.31it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.33it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.59it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.62it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.64it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:12,  7.80it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:12,  7.70it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.84it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.44it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.64it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.59it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.58it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.40it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:12,  7.34it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:12,  7.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.64it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:47:06,369 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:47:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:47:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:47:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:47:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.44it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.63it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:47:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:47:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3613488382862961, 'eval_loss': 1.1048745, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [402, 572, 622, 729, 603, 580, 466, 387, 242, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74972276, 'remaining_params': 10045324, 'pruned_model_sparsity': 0.8818441828515508, 'expected_sparsity': 0.87592, 'target_sparsity': 0.95, 'step': 16800}


Iteration:  69%|██████▊   | 184/268 [00:32<01:00,  1.38it/s][A04/21/2024 16:47:08 - INFO - trainer.trainer_mod - v4 Global step: 16800, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:32<00:45,  1.83it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:34,  2.36it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:27,  2.98it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:21,  3.64it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:18,  4.30it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:15,  4.97it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:13,  5.53it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:12,  6.02it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:11,  6.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  6.78it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.25it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.53it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.57it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.47it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.52it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.75it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.71it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.84it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.83it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.80it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.80it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.74it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.69it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.81it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.95it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  8.04it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.81it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.67it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.80it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.65it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.52it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.46it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.54it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.56it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.78it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.90it/s][A
Iteration:  82%|████████▏ | 221/268 [00:36<00:05,  7.86it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.81it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.54it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.47it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.48it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.52it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.57it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.62it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.46it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.43it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.59it/s][A[INFO|trainer.py:570] 2024-04-21 16:47:14,861 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:47:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:47:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:47:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:47:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:47:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:47:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3616215924267866, 'eval_loss': 1.0282066, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [402, 571, 622, 727, 602, 580, 465, 386, 241, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74978404, 'remaining_params': 10039196, 'pruned_model_sparsity': 0.8819162620445649, 'expected_sparsity': 0.87597, 'target_sparsity': 0.95, 'step': 16850}


Iteration:  87%|████████▋ | 234/268 [00:40<00:24,  1.39it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:17,  1.83it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:13,  2.38it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:10,  3.00it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:08,  3.68it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:06,  4.33it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:05,  4.98it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:04,  5.57it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:04,  5.99it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  6.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  6.75it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.03it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.22it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.26it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.60it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.63it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.40it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.49it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.53it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.32it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.19it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.31it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:43<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.51it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.58it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.62it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.56it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.50it/s][A04/21/2024 16:47:21 - INFO - trainer.trainer_mod - Epoch 62 finished. Took 45.14 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.94it/s]
Epoch:  63%|██████▎   | 63/100 [48:34<28:16, 45.84s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.60it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.95it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.66it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.58it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.63it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.66it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.66it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.64it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.65it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:32,  7.80it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.66it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.65it/s][A[INFO|trainer.py:570] 2024-04-21 16:47:23,386 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:47:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:47:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:47:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:47:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:47:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:47:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36641825548181356, 'eval_loss': 1.0418702, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [402, 570, 621, 725, 601, 579, 465, 386, 241, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74983000, 'remaining_params': 10034600, 'pruned_model_sparsity': 0.8819703214393255, 'expected_sparsity': 0.87606, 'target_sparsity': 0.95, 'step': 16900}


Iteration:   6%|▌         | 16/268 [00:04<03:01,  1.38it/s][A04/21/2024 16:47:25 - INFO - trainer.trainer_mod - v4 Global step: 16900, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:16,  1.84it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:44,  2.38it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:23,  2.99it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:07,  3.67it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:56,  4.36it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:49,  5.00it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:44,  5.53it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:40,  5.99it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:38,  6.28it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:37,  6.48it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:35,  6.84it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  6.95it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:33,  7.16it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:33,  7.18it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.31it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.43it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.48it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.68it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.70it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:29,  7.82it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:29,  7.78it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.57it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.59it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.52it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.62it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.54it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.58it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.64it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.63it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.80it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:27,  7.78it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.73it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.67it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.67it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.54it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.50it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.66it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:26,  7.76it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:26,  7.74it/s][A
Iteration:  23%|██▎       | 61/268 [00:09<00:27,  7.63it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.60it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.54it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 16:47:31,934 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:47:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:47:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:47:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:47:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:47:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:47:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37538726920470683, 'eval_loss': 1.0409182, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [401, 568, 619, 723, 600, 578, 464, 385, 241, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74993724, 'remaining_params': 10023876, 'pruned_model_sparsity': 0.8820964600271003, 'expected_sparsity': 0.87617, 'target_sparsity': 0.95, 'step': 16950}


Iteration:  25%|██▍       | 66/268 [00:12<02:25,  1.39it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<01:49,  1.84it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<01:24,  2.38it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<01:06,  3.01it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:53,  3.72it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:44,  4.40it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:39,  5.02it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:35,  5.54it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:31,  6.13it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:29,  6.52it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:28,  6.84it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.09it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.24it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.26it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.23it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.38it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.51it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.48it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:24,  7.48it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.49it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.32it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.31it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.41it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.49it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.41it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.48it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.61it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.66it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.69it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.69it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.57it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.61it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.60it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.60it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.74it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.61it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:17<00:20,  7.76it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.58it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.62it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.61it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.59it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.41it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.27it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 16:47:40,509 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:47:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:47:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:47:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:47:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:47:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:47:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3790304256906935, 'eval_loss': 1.0175402, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [401, 567, 619, 722, 599, 577, 464, 385, 241, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 74996788, 'remaining_params': 10020812, 'pruned_model_sparsity': 0.8821324996236074, 'expected_sparsity': 0.87623, 'target_sparsity': 0.95, 'step': 17000}


Iteration:  43%|████▎     | 116/268 [00:21<01:50,  1.38it/s][A04/21/2024 16:47:42 - INFO - trainer.trainer_mod - v4 Global step: 17000, Alignment: tensor([ 2,  7,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:21<01:22,  1.83it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<01:03,  2.36it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:49,  3.00it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:40,  3.68it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:33,  4.36it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:29,  4.94it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:26,  5.53it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:23,  6.06it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:22,  6.34it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.68it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.94it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.05it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.05it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.07it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.19it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.38it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.42it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.10it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.17it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.31it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.45it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.37it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.48it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.64it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.64it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:15,  7.85it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.69it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:15,  7.80it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.81it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.36it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.54it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.38it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.44it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.48it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.25it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.39it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.56it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.49it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.56it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.33it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 16:47:49,142 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:47:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:47:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:47:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:47:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:47:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:47:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36512082602825974, 'eval_loss': 1.0756814, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [401, 565, 618, 720, 598, 576, 463, 384, 241, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75004448, 'remaining_params': 10013152, 'pruned_model_sparsity': 0.8822225986148751, 'expected_sparsity': 0.87628, 'target_sparsity': 0.95, 'step': 17050}


Iteration:  62%|██████▏   | 166/268 [00:29<01:13,  1.38it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:55,  1.83it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:42,  2.37it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:33,  2.99it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:26,  3.64it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:22,  4.32it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:19,  4.98it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:17,  5.57it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:15,  6.11it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:14,  6.51it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.71it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.93it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.12it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.28it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.70it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.59it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:10,  7.76it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:10,  7.73it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.82it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.66it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.68it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.48it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.53it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.56it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.60it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.46it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.52it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.59it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.55it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.60it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.61it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.63it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.55it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.62it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.77it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.75it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.74it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.85it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.79it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.66it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.64it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.67it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.68it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.48it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:47:57,672 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:47:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:47:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:47:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:47:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:47:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:47:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3723251047469222, 'eval_loss': 1.0749979, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [400, 563, 617, 718, 597, 576, 463, 384, 241, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75009044, 'remaining_params': 10008556, 'pruned_model_sparsity': 0.8822766580096356, 'expected_sparsity': 0.87636, 'target_sparsity': 0.95, 'step': 17100}


Iteration:  81%|████████  | 216/268 [00:38<00:37,  1.38it/s][A04/21/2024 16:47:59 - INFO - trainer.trainer_mod - v4 Global step: 17100, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:38<00:27,  1.83it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:21,  2.37it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:16,  2.98it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:13,  3.66it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:10,  4.32it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:09,  4.93it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:07,  5.63it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:07,  6.13it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  6.56it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:06,  6.85it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  6.95it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.16it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.27it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.39it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.40it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.62it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.78it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.52it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  6.96it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.16it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.21it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.21it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.29it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.25it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.99it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.30it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.29it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.40it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.47it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.64it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.55it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.58it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.35it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.55it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.46it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.72it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.51it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.51it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.55it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.71it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.61it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.40it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:48:06,303 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:48:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:48:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:48:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:48:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.75it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.87it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.18it/s]04/21/2024 16:48:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:48:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3591167121379829, 'eval_loss': 1.0724502, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [400, 562, 616, 717, 596, 575, 463, 383, 241, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75015172, 'remaining_params': 10002428, 'pruned_model_sparsity': 0.8823487372026498, 'expected_sparsity': 0.87637, 'target_sparsity': 0.95, 'step': 17150}


Iteration:  99%|█████████▉| 266/268 [00:46<00:01,  1.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  1.83it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  2.41it/s][A04/21/2024 16:48:08 - INFO - trainer.trainer_mod - Epoch 63 finished. Took 47.22 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  64%|██████▍   | 64/100 [49:21<27:45, 46.25s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.50it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.57it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.65it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.67it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.65it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.72it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.67it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.69it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.57it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.56it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.73it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.52it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.14it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:34,  7.28it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.38it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.38it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.36it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.41it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.45it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.50it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.54it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.54it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.52it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.57it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.71it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.61it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.63it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.38it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.45it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.40it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.51it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.37it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.41it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.49it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.56it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.71it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:29,  7.67it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:29,  7.62it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:28,  7.74it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:29,  7.62it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:29,  7.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:29,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 16:48:14,889 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:48:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:48:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:48:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:48:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:48:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:48:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37033710191144653, 'eval_loss': 1.1272694, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [400, 560, 616, 717, 595, 574, 463, 383, 241, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75018236, 'remaining_params': 9999364, 'pruned_model_sparsity': 0.8823847767991568, 'expected_sparsity': 0.87645, 'target_sparsity': 0.95, 'step': 17200}


Iteration:  18%|█▊        | 48/268 [00:08<02:38,  1.39it/s][A04/21/2024 16:48:16 - INFO - trainer.trainer_mod - v4 Global step: 17200, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<01:59,  1.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:31,  2.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:12,  2.99it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:59,  3.65it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:49,  4.33it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:43,  4.94it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:38,  5.51it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:35,  5.95it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:33,  6.39it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:30,  6.93it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:29,  6.98it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  7.05it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.33it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.44it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.53it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.73it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.57it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.64it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.54it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.45it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.51it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.45it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.54it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.78it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.64it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.52it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.56it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.62it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.59it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.51it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:26,  7.04it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.23it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.36it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.41it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.49it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.72it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.63it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.79it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.76it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.61it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.67it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.69it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.51it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.56it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.37it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:22,  7.64it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.63it/s][A
Iteration:  36%|███▌      | 97/268 [00:14<00:21,  7.79it/s][A[INFO|trainer.py:570] 2024-04-21 16:48:23,449 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:48:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:48:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:48:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:48:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:48:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:48:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3777241051741919, 'eval_loss': 0.93147236, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [400, 559, 615, 715, 594, 573, 462, 382, 241, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75025896, 'remaining_params': 9991704, 'pruned_model_sparsity': 0.8824748757904246, 'expected_sparsity': 0.87658, 'target_sparsity': 0.95, 'step': 17250}


Iteration:  37%|███▋      | 98/268 [00:16<02:01,  1.40it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<01:30,  1.87it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:09,  2.41it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:55,  3.03it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:44,  3.70it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:37,  4.41it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:33,  4.96it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:29,  5.56it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:26,  6.08it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:24,  6.47it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:23,  6.82it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:22,  7.03it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.07it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:22,  7.11it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.23it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.35it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.45it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.56it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.40it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.51it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.32it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.53it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:20,  7.34it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.43it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.30it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.32it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.55it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.55it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.57it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.59it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.53it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.42it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.51it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.54it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.61it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.56it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.72it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.71it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.64it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:16,  7.60it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:16,  7.63it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:17,  7.46it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.48it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.44it/s][A
Iteration:  54%|█████▎    | 144/268 [00:22<00:16,  7.49it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.49it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.56it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:15,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 16:48:32,032 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:48:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:48:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:48:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:48:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:48:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:48:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3723251047469222, 'eval_loss': 1.0540289, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [399, 557, 614, 713, 593, 572, 462, 382, 240, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75033556, 'remaining_params': 9984044, 'pruned_model_sparsity': 0.8825649747816923, 'expected_sparsity': 0.87663, 'target_sparsity': 0.95, 'step': 17300}


Iteration:  55%|█████▌    | 148/268 [00:25<01:26,  1.39it/s][A04/21/2024 16:48:34 - INFO - trainer.trainer_mod - v4 Global step: 17300, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:25<01:04,  1.84it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:49,  2.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:38,  3.00it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:31,  3.65it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:26,  4.28it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:23,  4.94it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:20,  5.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:18,  6.22it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:16,  6.59it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:16,  6.87it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:15,  7.10it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.24it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.38it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.46it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.38it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.37it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.57it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.73it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.70it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.59it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.51it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.56it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:13,  7.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.43it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.47it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.51it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.58it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.60it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.60it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.42it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.60it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.59it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.61it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.59it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.51it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.53it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.42it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.41it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.24it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.27it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:31<00:10,  7.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:31<00:09,  7.48it/s][A
Iteration:  73%|███████▎  | 196/268 [00:31<00:09,  7.58it/s][A
Iteration:  74%|███████▎  | 197/268 [00:31<00:09,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 16:48:40,602 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:48:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:48:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:48:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:48:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:48:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:48:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35134333629790343, 'eval_loss': 1.0435375, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [399, 557, 614, 711, 592, 572, 461, 381, 240, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75038152, 'remaining_params': 9979448, 'pruned_model_sparsity': 0.8826190341764528, 'expected_sparsity': 0.87674, 'target_sparsity': 0.95, 'step': 17350}


Iteration:  74%|███████▍  | 198/268 [00:34<00:50,  1.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:37,  1.83it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:28,  2.35it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:22,  2.94it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:18,  3.61it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:14,  4.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:12,  4.98it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:11,  5.51it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:10,  6.03it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:09,  6.43it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  6.85it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.06it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:08,  7.23it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.37it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.30it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.43it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.50it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.54it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.57it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.58it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.62it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.62it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.65it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.63it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.78it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.79it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.74it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.74it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.73it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.72it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.70it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.68it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.70it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.70it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.73it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.70it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:04,  7.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.14it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.28it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.37it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.26it/s][A
Iteration:  92%|█████████▏| 246/268 [00:40<00:03,  7.22it/s][A
Iteration:  92%|█████████▏| 247/268 [00:40<00:02,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 16:48:49,198 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:48:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:48:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:48:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:48:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:48:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:48:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3508011277661142, 'eval_loss': 1.1047378, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [398, 556, 613, 710, 591, 571, 461, 381, 240, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75044280, 'remaining_params': 9973320, 'pruned_model_sparsity': 0.882691113369467, 'expected_sparsity': 0.87679, 'target_sparsity': 0.95, 'step': 17400}


Iteration:  93%|█████████▎| 248/268 [00:42<00:14,  1.38it/s][A04/21/2024 16:48:51 - INFO - trainer.trainer_mod - v4 Global step: 17400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:42<00:10,  1.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:07,  2.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:05,  2.95it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:04,  3.62it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:03,  4.25it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:02,  4.96it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:02,  5.56it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  6.05it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  6.46it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  6.62it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  6.87it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.10it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.25it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.36it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.63it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.63it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.51it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.68it/s][A04/21/2024 16:48:53 - INFO - trainer.trainer_mod - Epoch 64 finished. Took 45.25 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  65%|██████▌   | 65/100 [50:07<26:48, 45.95s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.37it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.57it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.77it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.57it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.50it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.56it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.61it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.68it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.68it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:32,  7.86it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.54it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.59it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.64it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.43it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.67it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:31,  7.80it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.63it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.60it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.76it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.64it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.61it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.52it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.47it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:48:57,715 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:48:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:48:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:48:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:48:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:48:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:48:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35863795532263415, 'eval_loss': 1.1906431, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [398, 555, 613, 709, 590, 571, 461, 380, 240, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75047344, 'remaining_params': 9970256, 'pruned_model_sparsity': 0.8827271529659741, 'expected_sparsity': 0.87685, 'target_sparsity': 0.95, 'step': 17450}


Iteration:  11%|█         | 30/268 [00:05<02:51,  1.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:09,  1.84it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:38,  2.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:17,  3.02it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:03,  3.70it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:53,  4.38it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:46,  5.03it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:41,  5.51it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:38,  6.01it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:35,  6.42it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:33,  6.75it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:32,  6.96it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.08it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.23it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.35it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.43it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.49it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.59it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.60it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.61it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.62it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.54it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.36it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.36it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.38it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.55it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.60it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.65it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.67it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.70it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.59it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.72it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.69it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:25,  7.70it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.67it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.59it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.61it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.66it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.69it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:24,  7.81it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:24,  7.78it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:24,  7.72it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.53it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.73it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.73it/s][A[INFO|trainer.py:570] 2024-04-21 16:49:06,238 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:49:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:49:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:49:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:49:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.78it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.90it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.19it/s]04/21/2024 16:49:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:49:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3588375000623354, 'eval_loss': 1.0765299, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [398, 553, 612, 707, 589, 570, 460, 380, 240, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75053472, 'remaining_params': 9964128, 'pruned_model_sparsity': 0.8827992321589883, 'expected_sparsity': 0.87692, 'target_sparsity': 0.95, 'step': 17500}


Iteration:  30%|██▉       | 80/268 [00:14<02:15,  1.39it/s][A04/21/2024 16:49:08 - INFO - trainer.trainer_mod - v4 Global step: 17500, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:14<01:41,  1.84it/s][A
Iteration:  31%|███       | 82/268 [00:14<01:17,  2.39it/s][A
Iteration:  31%|███       | 83/268 [00:14<01:02,  2.97it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:50,  3.64it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:42,  4.32it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:36,  4.96it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:32,  5.64it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:29,  6.04it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.48it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:26,  6.78it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  6.87it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.06it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.26it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.54it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.56it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.57it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.63it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:23,  7.14it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.41it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.46it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.57it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.49it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.68it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.69it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.58it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.66it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.68it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.70it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.61it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.49it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.54it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.53it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.46it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.54it/s][A
Iteration:  46%|████▌     | 122/268 [00:19<00:19,  7.41it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.53it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.54it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.49it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.56it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 16:49:14,817 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:49:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:49:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:49:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:49:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:49:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:49:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.369870679490583, 'eval_loss': 1.0149932, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [398, 552, 611, 705, 588, 569, 460, 379, 240, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75059600, 'remaining_params': 9958000, 'pruned_model_sparsity': 0.8828713113520024, 'expected_sparsity': 0.87699, 'target_sparsity': 0.95, 'step': 17550}


Iteration:  49%|████▊     | 130/268 [00:23<01:39,  1.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<01:14,  1.84it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:57,  2.38it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:45,  3.00it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:36,  3.67it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:30,  4.36it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:26,  5.06it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:23,  5.64it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:21,  6.14it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:20,  6.35it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.72it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.99it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.20it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.16it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.32it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.54it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.60it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.62it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.54it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.61it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.60it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:14,  7.76it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.87it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.60it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.58it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.63it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.62it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:15,  7.25it/s][A
Iteration:  60%|█████▉    | 160/268 [00:26<00:14,  7.31it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.29it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.38it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.36it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.26it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.40it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.39it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.58it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.63it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.63it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.50it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.54it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:28<00:12,  7.39it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.32it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.44it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:12,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 16:49:23,431 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:49:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:49:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:49:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:49:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.01it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:49:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:49:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39723975487692054, 'eval_loss': 0.952212, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [397, 550, 610, 704, 587, 569, 460, 379, 240, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75064196, 'remaining_params': 9953404, 'pruned_model_sparsity': 0.882925370746763, 'expected_sparsity': 0.87703, 'target_sparsity': 0.95, 'step': 17600}


Iteration:  67%|██████▋   | 180/268 [00:31<01:03,  1.38it/s][A04/21/2024 16:49:25 - INFO - trainer.trainer_mod - v4 Global step: 17600, Alignment: tensor([ 2,  7,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:31<00:47,  1.82it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:36,  2.36it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:28,  2.98it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:23,  3.64it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:19,  4.34it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:16,  4.93it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:14,  5.50it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:13,  6.03it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:12,  6.45it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:11,  6.66it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.96it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.08it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.26it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.38it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.21it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:10,  6.81it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.06it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.16it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:09,  7.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.38it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.49it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.52it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.48it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.56it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.62it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.75it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.70it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.45it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.70it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.57it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.59it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.44it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.64it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.65it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.61it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.82it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.95it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.84it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.55it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.46it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.54it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 16:49:32,038 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:49:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:49:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:49:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:49:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:49:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:49:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36855001301858165, 'eval_loss': 1.0867581, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [397, 549, 610, 702, 586, 567, 459, 379, 239, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75071856, 'remaining_params': 9945744, 'pruned_model_sparsity': 0.8830154697380307, 'expected_sparsity': 0.87714, 'target_sparsity': 0.95, 'step': 17650}


Iteration:  86%|████████▌ | 230/268 [00:40<00:27,  1.39it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:20,  1.83it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:15,  2.36it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:11,  2.96it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:09,  3.60it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:07,  4.29it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:06,  4.93it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:05,  5.43it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:05,  5.96it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  6.40it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:04,  6.73it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.01it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.12it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.12it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.20it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.48it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.66it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.54it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.78it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.76it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.75it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.73it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.69it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.80it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.64it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.54it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.71it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.69it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.81it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.73it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.68it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.68it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.70it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.86it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.55it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.60it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.66it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.80it/s][A04/21/2024 16:49:38 - INFO - trainer.trainer_mod - Epoch 65 finished. Took 45.18 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  66%|██████▌   | 66/100 [50:52<25:54, 45.72s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.45it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.76it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.69it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.71it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.61it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.56it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.61it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:49:40,531 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:49:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:49:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:49:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:49:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:49:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:49:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3588375000623354, 'eval_loss': 1.1174468, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [396, 547, 609, 700, 585, 567, 459, 378, 239, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75077984, 'remaining_params': 9939616, 'pruned_model_sparsity': 0.8830875489310449, 'expected_sparsity': 0.87722, 'target_sparsity': 0.95, 'step': 17700}


Iteration:   4%|▍         | 12/268 [00:03<03:06,  1.37it/s][A04/21/2024 16:49:42 - INFO - trainer.trainer_mod - v4 Global step: 17700, Alignment: tensor([ 0,  3,  8, 10], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:19,  1.83it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:47,  2.37it/s][A
Iteration:   6%|▌         | 15/268 [00:03<01:24,  2.98it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:09,  3.62it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:58,  4.30it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:50,  4.94it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:46,  5.41it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:41,  5.95it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:38,  6.36it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:35,  6.85it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.07it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:34,  7.15it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.33it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.41it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.49it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.69it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.71it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.46it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.46it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.33it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.42it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.50it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.56it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.55it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.50it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.67it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.68it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.67it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.67it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.76it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.73it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.74it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.71it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.70it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.62it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.55it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.47it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.52it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.56it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:26,  7.75it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:49:49,105 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:49:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:49:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:49:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:49:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:49:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:49:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35279279696239413, 'eval_loss': 1.0537888, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [396, 546, 609, 698, 585, 566, 459, 378, 238, 183, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75081048, 'remaining_params': 9936552, 'pruned_model_sparsity': 0.8831235885275519, 'expected_sparsity': 0.87728, 'target_sparsity': 0.95, 'step': 17750}


Iteration:  23%|██▎       | 62/268 [00:12<02:28,  1.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:51,  1.84it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<01:25,  2.37it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<01:07,  2.99it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:55,  3.67it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:46,  4.29it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:41,  4.85it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:36,  5.49it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:33,  5.89it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.26it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.64it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:28,  6.94it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:27,  7.14it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:26,  7.17it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:26,  7.33it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.29it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.54it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.57it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.51it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.59it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.59it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.52it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.55it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.62it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:22,  7.86it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:22,  7.77it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.61it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.76it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.40it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.31it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.39it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.48it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:21,  7.73it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.63it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.48it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.54it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.43it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.45it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.55it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.60it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.55it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.55it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.55it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.73it/s][A[INFO|trainer.py:570] 2024-04-21 16:49:57,690 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:49:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:49:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:49:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:49:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:49:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:49:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3386480011243414, 'eval_loss': 1.0823206, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [396, 545, 608, 697, 583, 565, 458, 377, 238, 183, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75090240, 'remaining_params': 9927360, 'pruned_model_sparsity': 0.8832317073170731, 'expected_sparsity': 0.87738, 'target_sparsity': 0.95, 'step': 17800}


Iteration:  42%|████▏     | 112/268 [00:20<01:52,  1.39it/s][A04/21/2024 16:49:59 - INFO - trainer.trainer_mod - v4 Global step: 17800, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:20<01:24,  1.84it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<01:05,  2.37it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:51,  2.99it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:41,  3.66it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:34,  4.34it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:30,  4.94it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:27,  5.50it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:24,  5.96it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:22,  6.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.76it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.04it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.21it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.22it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.23it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.46it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.37it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.35it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.64it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.68it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.72it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.68it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:16,  7.81it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.63it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.61it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.64it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.66it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.50it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.41it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.40it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.36it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.45it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.42it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.56it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.58it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.60it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.62it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.44it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.44it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.49it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.13it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.31it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.22it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:50:06,290 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:50:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:50:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:50:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:50:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.49it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.14it/s]04/21/2024 16:50:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:50:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3644798574300347, 'eval_loss': 0.9209702, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [395, 543, 607, 695, 583, 565, 458, 377, 237, 183, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75094836, 'remaining_params': 9922764, 'pruned_model_sparsity': 0.8832857667118338, 'expected_sparsity': 0.87745, 'target_sparsity': 0.95, 'step': 17850}


Iteration:  60%|██████    | 162/268 [00:29<01:16,  1.39it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:57,  1.83it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:43,  2.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:34,  3.00it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:27,  3.68it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:23,  4.28it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:20,  4.99it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:17,  5.51it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:16,  5.87it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:15,  6.31it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.67it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  6.93it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  6.95it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  7.12it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.29it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.44it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.44it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.61it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.66it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.58it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.73it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.61it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.65it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.69it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.73it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.69it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.85it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.81it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.82it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.75it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.72it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.10it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.26it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.40it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.67it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.70it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.69it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.73it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.66it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.68it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.53it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.26it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.31it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.44it/s][A[INFO|trainer.py:570] 2024-04-21 16:50:14,878 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:50:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:50:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:50:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:50:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:50:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:50:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37130725049378743, 'eval_loss': 1.0496664, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [395, 542, 607, 693, 581, 564, 457, 376, 237, 183, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75102496, 'remaining_params': 9915104, 'pruned_model_sparsity': 0.8833758657031014, 'expected_sparsity': 0.87751, 'target_sparsity': 0.95, 'step': 17900}


Iteration:  79%|███████▉  | 212/268 [00:37<00:40,  1.39it/s][A04/21/2024 16:50:16 - INFO - trainer.trainer_mod - v4 Global step: 17900, Alignment: tensor([ 0,  3,  8, 10], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:38<00:30,  1.83it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:22,  2.37it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:17,  2.97it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:14,  3.65it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:11,  4.39it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:10,  4.97it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:08,  5.48it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:08,  5.99it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:07,  6.32it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  6.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  6.69it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  6.96it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.13it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.17it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.29it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.41it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.47it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.50it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.57it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.40it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.51it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.41it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.58it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.62it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.59it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.60it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.58it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.62it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.50it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.40it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.46it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.65it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.43it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.39it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.43it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.61it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.53it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.59it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.52it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.57it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.59it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.54it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.78it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.79it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.73it/s][A[INFO|trainer.py:570] 2024-04-21 16:50:23,471 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:50:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:50:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:50:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:50:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:50:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:50:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3838291781460529, 'eval_loss': 0.98820585, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [394, 540, 606, 692, 581, 563, 457, 376, 236, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75108624, 'remaining_params': 9908976, 'pruned_model_sparsity': 0.8834479448961157, 'expected_sparsity': 0.8776, 'target_sparsity': 0.95, 'step': 17950}


Iteration:  98%|█████████▊| 262/268 [00:46<00:04,  1.39it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:02,  1.85it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:01,  2.38it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  3.00it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  3.68it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  4.37it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.23it/s][A04/21/2024 16:50:26 - INFO - trainer.trainer_mod - Epoch 66 finished. Took 47.25 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  67%|██████▋   | 67/100 [51:39<25:23, 46.18s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.42it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.73it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.65it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.61it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.56it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.45it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.39it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.45it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.55it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.58it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.60it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.62it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.77it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.77it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:31,  7.76it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.53it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.57it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.58it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.56it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:34,  7.01it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:33,  7.22it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.38it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.47it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.48it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.51it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.53it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.57it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.60it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.48it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.40it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.57it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.49it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.49it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.52it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:29,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:50:32,044 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:50:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:50:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:50:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:50:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:50:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:50:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3694171254720073, 'eval_loss': 1.112492, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [394, 539, 605, 690, 580, 563, 457, 376, 236, 183, 199, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75111688, 'remaining_params': 9905912, 'pruned_model_sparsity': 0.8834839844926227, 'expected_sparsity': 0.87764, 'target_sparsity': 0.95, 'step': 18000}


Iteration:  16%|█▋        | 44/268 [00:07<02:41,  1.39it/s][A04/21/2024 16:50:34 - INFO - trainer.trainer_mod - v4 Global step: 18000, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:07<02:01,  1.84it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:33,  2.37it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:13,  3.02it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:59,  3.69it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:51,  4.29it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:44,  4.95it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:39,  5.55it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:35,  6.01it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:33,  6.37it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.72it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:32,  6.62it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  6.91it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.06it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:29,  7.23it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.45it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.38it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.30it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.50it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.60it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.40it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.49it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.55it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.58it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.64it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.48it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:26,  7.32it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.43it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.51it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.52it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.70it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.58it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.44it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.46it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.55it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.49it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.56it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.50it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.49it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.47it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 16:50:40,679 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:50:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:50:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:50:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:50:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:50:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:50:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3549728010330333, 'eval_loss': 1.0060475, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [394, 537, 605, 689, 579, 562, 457, 375, 236, 183, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75116284, 'remaining_params': 9901316, 'pruned_model_sparsity': 0.8835380438873833, 'expected_sparsity': 0.8777, 'target_sparsity': 0.95, 'step': 18050}


Iteration:  35%|███▌      | 94/268 [00:16<02:05,  1.39it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<01:34,  1.84it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<01:12,  2.37it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:57,  3.00it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:46,  3.67it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:38,  4.35it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:33,  5.05it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:29,  5.63it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:27,  6.09it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:25,  6.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:24,  6.79it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:23,  7.03it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.37it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.32it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.34it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.47it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.56it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.44it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.58it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.61it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.62it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.64it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.29it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.40it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.50it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.50it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.56it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.60it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.51it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.54it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.57it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.38it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.42it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.50it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.75it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.50it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.65it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:16,  7.85it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.65it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.39it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.46it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.53it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:17,  7.33it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.42it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 16:50:49,254 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:50:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:50:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:50:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:50:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:50:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:50:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.375280761108447, 'eval_loss': 1.029547, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [393, 536, 604, 687, 578, 561, 456, 375, 236, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75125476, 'remaining_params': 9892124, 'pruned_model_sparsity': 0.8836461626769045, 'expected_sparsity': 0.87772, 'target_sparsity': 0.95, 'step': 18100}


Iteration:  54%|█████▎    | 144/268 [00:25<01:29,  1.38it/s][A04/21/2024 16:50:51 - INFO - trainer.trainer_mod - v4 Global step: 18100, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:25<01:06,  1.84it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:51,  2.38it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:40,  2.99it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:32,  3.66it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:27,  4.28it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:23,  4.95it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:21,  5.52it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:19,  5.98it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:18,  6.25it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:16,  6.79it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.12it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.46it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.61it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:13,  7.84it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.76it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.71it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.51it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.42it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.42it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.50it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.64it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.57it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.61it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.65it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.67it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.57it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.59it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.57it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.44it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.51it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:12,  7.35it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:12,  7.27it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.36it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.47it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.45it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.43it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.54it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.59it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.66it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.50it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.19it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:10,  7.28it/s][A[INFO|trainer.py:570] 2024-04-21 16:50:57,861 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:50:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:50:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:50:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:50:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:50:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:50:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3489429072751036, 'eval_loss': 1.0485084, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [393, 535, 603, 686, 577, 561, 456, 375, 236, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75128540, 'remaining_params': 9889060, 'pruned_model_sparsity': 0.8836822022734117, 'expected_sparsity': 0.8778, 'target_sparsity': 0.95, 'step': 18150}


Iteration:  72%|███████▏  | 194/268 [00:33<00:53,  1.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:39,  1.83it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:30,  2.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:23,  2.99it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:19,  3.66it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:15,  4.34it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:13,  4.89it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:12,  5.43it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:11,  5.96it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:10,  6.31it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:09,  6.66it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:09,  6.92it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.15it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.18it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.24it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.35it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.48it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.44it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.48it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.51it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.57it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.72it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.70it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.72it/s][A
Iteration:  82%|████████▏ | 220/268 [00:37<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.62it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.77it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.89it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.81it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.77it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.70it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.71it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.58it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.43it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:39<00:04,  7.65it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.67it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.70it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.82it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.76it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.77it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.70it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.72it/s][A
Iteration:  91%|█████████ | 243/268 [00:40<00:03,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:51:06,394 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:51:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:51:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:51:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:51:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:51:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:51:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3459141688557483, 'eval_loss': 1.0221218, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [393, 533, 603, 684, 577, 561, 456, 374, 236, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75130072, 'remaining_params': 9887528, 'pruned_model_sparsity': 0.8837002220716652, 'expected_sparsity': 0.87787, 'target_sparsity': 0.95, 'step': 18200}


Iteration:  91%|█████████ | 244/268 [00:42<00:17,  1.39it/s][A04/21/2024 16:51:08 - INFO - trainer.trainer_mod - v4 Global step: 18200, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:42<00:12,  1.84it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:09,  2.38it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:06,  3.01it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:05,  3.71it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:04,  4.36it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:03,  5.07it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:03,  5.65it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  6.12it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  6.53it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:02,  6.77it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.14it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.28it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.29it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.40it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.47it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.52it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.52it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.55it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.26it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.33it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  7.91it/s][A04/21/2024 16:51:11 - INFO - trainer.trainer_mod - Epoch 67 finished. Took 45.29 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  68%|██████▊   | 68/100 [52:24<24:29, 45.91s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.62it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.62it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.50it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.55it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.56it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.62it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.64it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.69it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.67it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.65it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.66it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:32,  7.80it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.69it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.55it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.56it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.53it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.57it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.60it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.74it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.73it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.75it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:51:14,907 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:51:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:51:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:51:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:51:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:51:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:51:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3325542907739164, 'eval_loss': 1.2245433, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [393, 532, 602, 682, 576, 560, 455, 374, 236, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75136200, 'remaining_params': 9881400, 'pruned_model_sparsity': 0.8837723012646793, 'expected_sparsity': 0.87792, 'target_sparsity': 0.95, 'step': 18250}


Iteration:  10%|▉         | 26/268 [00:05<02:54,  1.39it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:10,  1.85it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:40,  2.38it/s][A
Iteration:  11%|█         | 29/268 [00:05<01:19,  2.99it/s][A
Iteration:  11%|█         | 30/268 [00:05<01:05,  3.66it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:54,  4.35it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:47,  5.00it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:41,  5.60it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:38,  6.08it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:35,  6.48it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:34,  6.81it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:32,  7.06it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:31,  7.23it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.46it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.42it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.59it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.63it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:28,  7.77it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:27,  7.93it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.68it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.59it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.61it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.62it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.57it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.60it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.35it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.48it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.59it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.64it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.50it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:29,  6.94it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.16it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.22it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.13it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.27it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.42it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.49it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.57it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.61it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:51:23,492 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:51:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:51:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:51:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:51:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:51:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:51:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3629573913728164, 'eval_loss': 1.0933727, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [393, 531, 602, 680, 576, 559, 455, 374, 235, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75139264, 'remaining_params': 9878336, 'pruned_model_sparsity': 0.8838083408611864, 'expected_sparsity': 0.87791, 'target_sparsity': 0.95, 'step': 18300}


Iteration:  28%|██▊       | 76/268 [00:13<02:18,  1.38it/s][A04/21/2024 16:51:25 - INFO - trainer.trainer_mod - v4 Global step: 18300, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:14<01:44,  1.83it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<01:20,  2.35it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:03,  2.97it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:51,  3.64it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:43,  4.28it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:38,  4.88it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:33,  5.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:31,  5.90it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.48it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:26,  6.96it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:25,  7.08it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:25,  7.04it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.20it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.26it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.25it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.30it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.39it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.45it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.30it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.37it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.29it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.38it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.54it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.35it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.58it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.62it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.68it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:20,  7.68it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.66it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.75it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.32it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.40it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.31it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.41it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.62it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.54it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.61it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.62it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.65it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.67it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.69it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.64it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.60it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.83it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.75it/s][A[INFO|trainer.py:570] 2024-04-21 16:51:32,088 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:51:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:51:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:51:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:51:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:51:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:51:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37130725049378743, 'eval_loss': 1.0108169, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [392, 529, 601, 678, 575, 559, 455, 373, 235, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75145392, 'remaining_params': 9872208, 'pruned_model_sparsity': 0.8838804200542005, 'expected_sparsity': 0.87803, 'target_sparsity': 0.95, 'step': 18350}


Iteration:  47%|████▋     | 126/268 [00:22<01:41,  1.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<01:16,  1.85it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:58,  2.39it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:46,  2.99it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:37,  3.66it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:31,  4.30it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:27,  5.01it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:24,  5.55it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:22,  5.90it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:20,  6.36it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.72it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  6.99it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.08it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.25it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.50it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.45it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.50it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.62it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.55it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.55it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.50it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.67it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.60it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.35it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.42it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.41it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.64it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.60it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.54it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.57it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.59it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.51it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.53it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.42it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.41it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.43it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.52it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.71it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.64it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.74it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.60it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 16:51:40,680 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:51:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:51:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:51:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:51:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:51:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:51:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3459260851053814, 'eval_loss': 1.1746514, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [392, 528, 600, 676, 574, 558, 454, 373, 235, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75151520, 'remaining_params': 9866080, 'pruned_model_sparsity': 0.8839524992472146, 'expected_sparsity': 0.87813, 'target_sparsity': 0.95, 'step': 18400}


Iteration:  66%|██████▌   | 176/268 [00:31<01:06,  1.39it/s][A04/21/2024 16:51:42 - INFO - trainer.trainer_mod - v4 Global step: 18400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:31<00:49,  1.84it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:37,  2.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:29,  2.99it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:24,  3.65it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:20,  4.31it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:17,  4.95it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:15,  5.44it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:14,  5.95it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:13,  6.29it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:12,  6.53it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  6.82it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.05it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.25it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.39it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.53it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.40it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.47it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.53it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.59it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.59it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.54it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.58it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.60it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.60it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.66it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.62it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.51it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.51it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.55it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.57it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.71it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.67it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.53it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.70it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.68it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.56it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.56it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.59it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.76it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.60it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.62it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 16:51:49,261 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:51:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:51:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:51:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:51:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:51:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:51:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34680376429660925, 'eval_loss': 1.1120102, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [391, 527, 599, 675, 573, 557, 454, 372, 235, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75159180, 'remaining_params': 9858420, 'pruned_model_sparsity': 0.8840425982384824, 'expected_sparsity': 0.87821, 'target_sparsity': 0.95, 'step': 18450}


Iteration:  84%|████████▍ | 226/268 [00:39<00:30,  1.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:22,  1.85it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:16,  2.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:12,  3.00it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:10,  3.68it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:08,  4.36it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:07,  5.01it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:06,  5.58it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:05,  6.07it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:05,  6.45it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  6.91it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.13it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.31it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.45it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.56it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.78it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.74it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.55it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.57it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.57it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.22it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.54it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.47it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.55it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.52it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.53it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.44it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.69it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.59it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.52it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.53it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.55it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.55it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.41it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.46it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.40it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  7.98it/s][A04/21/2024 16:51:56 - INFO - trainer.trainer_mod - Epoch 68 finished. Took 45.24 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  69%|██████▉   | 69/100 [53:09<23:37, 45.71s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.38it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.76it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.78it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.89it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.67it/s][A[INFO|trainer.py:570] 2024-04-21 16:51:57,770 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:51:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:51:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:51:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:51:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:51:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:51:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37538726920470683, 'eval_loss': 1.0589913, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [391, 526, 599, 673, 573, 557, 454, 373, 235, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75157648, 'remaining_params': 9859952, 'pruned_model_sparsity': 0.8840245784402289, 'expected_sparsity': 0.87823, 'target_sparsity': 0.95, 'step': 18500}


Iteration:   3%|▎         | 8/268 [00:03<03:15,  1.33it/s][A04/21/2024 16:51:59 - INFO - trainer.trainer_mod - v4 Global step: 18500, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:24,  1.79it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:49,  2.35it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:26,  2.97it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:10,  3.64it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:58,  4.33it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:51,  4.94it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:45,  5.53it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:42,  5.96it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:39,  6.41it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:37,  6.68it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:36,  6.86it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.19it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:34,  7.24it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.33it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:34,  7.06it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:33,  7.25it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  7.14it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.20it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.37it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.45it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.50it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.41it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.47it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:30,  7.72it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:30,  7.69it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.69it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.69it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.69it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:29,  7.70it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:29,  7.68it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.68it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.71it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.50it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.54it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.72it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.71it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.75it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.78it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.53it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.43it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.50it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.16it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:29,  7.18it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.25it/s][A[INFO|trainer.py:570] 2024-04-21 16:52:06,378 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:52:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:52:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:52:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:52:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.00it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:52:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:52:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3553101537388247, 'eval_loss': 1.0553722, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [391, 525, 598, 671, 572, 556, 454, 372, 235, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75163776, 'remaining_params': 9853824, 'pruned_model_sparsity': 0.884096657633243, 'expected_sparsity': 0.87824, 'target_sparsity': 0.95, 'step': 18550}


Iteration:  22%|██▏       | 58/268 [00:11<02:31,  1.38it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:54,  1.83it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<01:27,  2.38it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<01:09,  3.00it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:56,  3.67it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:46,  4.40it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:41,  4.96it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:36,  5.57it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:33,  6.07it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.46it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:29,  6.81it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  7.06it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.24it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.47it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.56it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.57it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.64it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:25,  7.51it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.57it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.44it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.63it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.61it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.61it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.63it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.63it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.62it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.62it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.61it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.63it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.51it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.33it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.44it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.54it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.58it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.52it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.55it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:21,  7.68it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.69it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.81it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.51it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.77it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.64it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:22,  7.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.32it/s][A[INFO|trainer.py:570] 2024-04-21 16:52:14,933 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:52:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:52:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:52:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:52:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:52:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:52:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3868137302138668, 'eval_loss': 1.0721122, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [390, 523, 597, 670, 572, 555, 453, 372, 235, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75169904, 'remaining_params': 9847696, 'pruned_model_sparsity': 0.8841687368262572, 'expected_sparsity': 0.87836, 'target_sparsity': 0.95, 'step': 18600}


Iteration:  40%|████      | 108/268 [00:20<01:56,  1.38it/s][A04/21/2024 16:52:16 - INFO - trainer.trainer_mod - v4 Global step: 18600, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:20<01:26,  1.83it/s][A
Iteration:  41%|████      | 110/268 [00:20<01:06,  2.38it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:51,  3.02it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:42,  3.70it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:35,  4.32it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:31,  4.94it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:27,  5.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:25,  5.99it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.44it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.68it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.98it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:22,  6.60it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:21,  6.70it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:20,  6.97it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.20it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.31it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.42it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.37it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.50it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.39it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.48it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.70it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.80it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.68it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.66it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.45it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.40it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.51it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.59it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.52it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.55it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.60it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.50it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.59it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.41it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.50it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.56it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.72it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.70it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.70it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.74it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.55it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.49it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 16:52:23,544 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:52:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:52:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:52:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:52:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:52:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:52:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35863795532263415, 'eval_loss': 1.1222341, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [390, 522, 597, 668, 571, 555, 453, 371, 235, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75172968, 'remaining_params': 9844632, 'pruned_model_sparsity': 0.8842047764227642, 'expected_sparsity': 0.87841, 'target_sparsity': 0.95, 'step': 18650}


Iteration:  59%|█████▉    | 158/268 [00:28<01:19,  1.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:59,  1.83it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:45,  2.37it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:35,  3.02it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:28,  3.67it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:24,  4.35it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:20,  4.98it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:18,  5.55it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:16,  6.03it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:15,  6.53it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:14,  6.81it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:14,  6.99it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.17it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.16it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.16it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  7.28it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.53it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.60it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.54it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.49it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.30it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.31it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.51it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.58it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.66it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.44it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.45it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.56it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.48it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.57it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.49it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.49it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.55it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.69it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.89it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.67it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.66it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.80it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.58it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.60it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.54it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.53it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.44it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.19it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.31it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.36it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 16:52:32,127 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:52:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:52:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:52:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:52:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:52:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:52:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3634100013744764, 'eval_loss': 1.0583498, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [390, 521, 596, 666, 570, 554, 453, 371, 235, 182, 198, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75177564, 'remaining_params': 9840036, 'pruned_model_sparsity': 0.8842588358175248, 'expected_sparsity': 0.87844, 'target_sparsity': 0.95, 'step': 18700}


Iteration:  78%|███████▊  | 208/268 [00:37<00:43,  1.39it/s][A04/21/2024 16:52:34 - INFO - trainer.trainer_mod - v4 Global step: 18700, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:37<00:32,  1.83it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:24,  2.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:19,  2.99it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:15,  3.67it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:12,  4.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:10,  5.02it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:09,  5.58it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:08,  5.97it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  6.40it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.63it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.06it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.18it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.21it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.48it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.57it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.72it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.67it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.55it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.71it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.57it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:04,  7.62it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.41it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.46it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.45it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.67it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.59it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.62it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.50it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.59it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.62it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.62it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.60it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.50it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.49it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.50it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.42it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.38it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.47it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.50it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.57it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.43it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 16:52:40,707 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:52:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:52:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:52:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:52:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:52:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:52:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35784321920065126, 'eval_loss': 1.0341552, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [390, 519, 596, 665, 570, 554, 453, 371, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75177564, 'remaining_params': 9840036, 'pruned_model_sparsity': 0.8842588358175248, 'expected_sparsity': 0.87848, 'target_sparsity': 0.95, 'step': 18750}


Iteration:  96%|█████████▋| 258/268 [00:45<00:07,  1.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:04,  1.84it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:03,  2.36it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:02,  2.98it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:01,  3.64it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:01,  4.32it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  4.98it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  5.56it/s][A
Iteration:  99%|█████████▉| 266/268 [00:47<00:00,  5.98it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  6.42it/s][A04/21/2024 16:52:43 - INFO - trainer.trainer_mod - Epoch 69 finished. Took 47.24 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  70%|███████   | 70/100 [53:57<23:05, 46.17s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.32it/s][A
Iteration:   1%|          | 2/268 [00:00<00:37,  7.11it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.39it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.57it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.61it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.49it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.44it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.54it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:32,  7.78it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.74it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:32,  7.70it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.61it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.59it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.47it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.53it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.56it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.79it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.38it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.44it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.20it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.54it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.54it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.47it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.56it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.60it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.51it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.53it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.48it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.54it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.58it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.41it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.38it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.47it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 16:52:49,282 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:52:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:52:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:52:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:52:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:52:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:52:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3608642046103191, 'eval_loss': 1.0176284, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [390, 518, 596, 663, 570, 553, 452, 371, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75180628, 'remaining_params': 9836972, 'pruned_model_sparsity': 0.884294875414032, 'expected_sparsity': 0.87851, 'target_sparsity': 0.95, 'step': 18800}


Iteration:  15%|█▍        | 40/268 [00:07<02:44,  1.39it/s][A04/21/2024 16:52:51 - INFO - trainer.trainer_mod - v4 Global step: 18800, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:02,  1.85it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:35,  2.38it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<01:14,  3.02it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:00,  3.70it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:51,  4.35it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:44,  4.96it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:40,  5.52it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:36,  5.99it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:34,  6.30it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:32,  6.80it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:31,  6.90it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:30,  7.12it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:29,  7.25it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.33it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.39it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.30it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.65it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:26,  7.68it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.69it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.57it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.60it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.54it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:28,  6.98it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:27,  7.28it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:27,  7.34it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.52it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.53it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.68it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.69it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:24,  7.68it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.67it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.63it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:26,  7.19it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.28it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.40it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.49it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.60it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.64it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.51it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:52:57,875 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:52:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:52:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:52:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:52:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:52:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:52:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37772427171600165, 'eval_loss': 0.9965281, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [389, 518, 595, 661, 569, 552, 452, 370, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75188288, 'remaining_params': 9829312, 'pruned_model_sparsity': 0.8843849744052996, 'expected_sparsity': 0.87858, 'target_sparsity': 0.95, 'step': 18850}


Iteration:  34%|███▎      | 90/268 [00:15<02:07,  1.39it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<01:36,  1.84it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<01:14,  2.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:59,  2.95it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:48,  3.61it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:40,  4.30it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:34,  4.93it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:30,  5.62it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:27,  6.14it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:25,  6.50it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.79it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.03it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.46it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.39it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:22,  7.32it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.57it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.46it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.46it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.56it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.48it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.51it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.45it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.67it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.70it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.83it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.82it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.73it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.73it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.64it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.56it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:19,  7.42it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.38it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.68it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.66it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.68it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.69it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:16,  7.89it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.59it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:16,  7.78it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:16,  7.75it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:16,  7.76it/s][A[INFO|trainer.py:570] 2024-04-21 16:53:06,406 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:53:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:53:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:53:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:53:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:53:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:53:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3494439600922463, 'eval_loss': 1.0416353, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [389, 516, 594, 659, 569, 551, 451, 370, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75192884, 'remaining_params': 9824716, 'pruned_model_sparsity': 0.8844390338000602, 'expected_sparsity': 0.87866, 'target_sparsity': 0.95, 'step': 18900}


Iteration:  52%|█████▏    | 140/268 [00:24<01:31,  1.39it/s][A04/21/2024 16:53:08 - INFO - trainer.trainer_mod - v4 Global step: 18900, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:24<01:08,  1.85it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:52,  2.39it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:41,  3.04it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:33,  3.71it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:28,  4.36it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:24,  4.96it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:21,  5.61it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:19,  6.12it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:18,  6.49it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:17,  6.83it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:16,  7.05it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:16,  7.15it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.20it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.21it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.32it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.55it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.59it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.59it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.61it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.63it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.67it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.72it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.50it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.57it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.38it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.51it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.60it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.59it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.62it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.67it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.83it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.65it/s][A
Iteration:  65%|██████▌   | 175/268 [00:28<00:12,  7.63it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.64it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.46it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.55it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.61it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.50it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.59it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.59it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.58it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.52it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.55it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.47it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.53it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 16:53:14,938 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:53:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:53:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:53:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:53:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:53:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:53:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35481258251848646, 'eval_loss': 1.0199093, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [388, 514, 593, 658, 568, 551, 451, 370, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75197480, 'remaining_params': 9820120, 'pruned_model_sparsity': 0.8844930931948208, 'expected_sparsity': 0.87873, 'target_sparsity': 0.95, 'step': 18950}


Iteration:  71%|███████   | 190/268 [00:32<00:55,  1.39it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:41,  1.85it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:31,  2.42it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:24,  3.04it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:20,  3.68it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:16,  4.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:14,  5.00it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:12,  5.58it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:11,  6.11it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:10,  6.51it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:10,  6.74it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  6.96it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:09,  7.07it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:09,  7.03it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.15it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.16it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.31it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.45it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.55it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.56it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.61it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.47it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.52it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.55it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.39it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.25it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.48it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.45it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.56it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.61it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.61it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.67it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.68it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.66it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.66it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.54it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.57it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.63it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.60it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.57it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.42it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.48it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.55it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:04,  7.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:53:23,514 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:53:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:53:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:53:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:53:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:53:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:53:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37197230635330797, 'eval_loss': 1.0221719, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [388, 513, 593, 656, 567, 551, 451, 370, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75199012, 'remaining_params': 9818588, 'pruned_model_sparsity': 0.8845111129930744, 'expected_sparsity': 0.87875, 'target_sparsity': 0.95, 'step': 19000}


Iteration:  90%|████████▉ | 240/268 [00:41<00:20,  1.39it/s][A04/21/2024 16:53:25 - INFO - trainer.trainer_mod - v4 Global step: 19000, Alignment: tensor([ 0,  3,  8, 10], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:41<00:14,  1.83it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:10,  2.39it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:08,  3.00it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:06,  3.65it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:05,  4.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:04,  4.99it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:03,  5.47it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:03,  5.97it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  6.37it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  6.74it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  6.99it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.08it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.27it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.39it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.47it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.50it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.70it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.69it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.69it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.51it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.38it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.26it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.28it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.38it/s][A04/21/2024 16:53:29 - INFO - trainer.trainer_mod - Epoch 70 finished. Took 45.2 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  71%|███████   | 71/100 [54:42<22:10, 45.88s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.27it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.41it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.49it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.84it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.76it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.48it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:35,  7.34it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.46it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.40it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.45it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.48it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.52it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.43it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.21it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.17it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:34,  7.21it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.21it/s][A[INFO|trainer.py:570] 2024-04-21 16:53:32,156 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:53:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:53:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:53:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:53:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:53:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:53:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3767520669807055, 'eval_loss': 1.0422088, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [388, 513, 593, 654, 567, 551, 451, 370, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75199012, 'remaining_params': 9818588, 'pruned_model_sparsity': 0.8845111129930744, 'expected_sparsity': 0.8787, 'target_sparsity': 0.95, 'step': 19050}


Iteration:   8%|▊         | 22/268 [00:04<02:59,  1.37it/s][A
Iteration:   9%|▊         | 23/268 [00:05<02:15,  1.81it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:43,  2.35it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:21,  2.98it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:07,  3.60it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:55,  4.34it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:48,  4.91it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:43,  5.49it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:39,  6.01it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:36,  6.41it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.70it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.84it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.95it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.18it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.33it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.27it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.37it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.44it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.38it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.44it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.47it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.51it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.54it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:29,  7.52it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.62it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.77it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:27,  7.89it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:27,  7.86it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.70it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.67it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.40it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.31it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.41it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.36it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.30it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.34it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.48it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.54it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.62it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.50it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.54it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.59it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:26,  7.51it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.57it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.76it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 16:53:40,751 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:53:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:53:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:53:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:53:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:53:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:53:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3904332987871741, 'eval_loss': 0.96634436, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [388, 511, 592, 652, 566, 550, 451, 369, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75205140, 'remaining_params': 9812460, 'pruned_model_sparsity': 0.8845831921860885, 'expected_sparsity': 0.87882, 'target_sparsity': 0.95, 'step': 19100}


Iteration:  27%|██▋       | 72/268 [00:13<02:21,  1.39it/s][A04/21/2024 16:53:42 - INFO - trainer.trainer_mod - v4 Global step: 19100, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:13<01:45,  1.84it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<01:21,  2.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<01:04,  3.00it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:52,  3.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:43,  4.37it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:38,  5.00it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:33,  5.57it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:30,  6.15it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:28,  6.53it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:27,  6.86it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:26,  7.11it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.27it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.36it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.43it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.52it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.57it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.60it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.57it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.61it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.61it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.55it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.62it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.62it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.62it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.55it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.41it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.53it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.48it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:20,  7.82it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.75it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.88it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:19,  7.84it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.63it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.66it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.77it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.75it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.90it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.17it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.32it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:20,  7.33it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:53:49,288 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:53:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:53:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:53:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:53:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:53:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:53:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3609036607753639, 'eval_loss': 1.070938, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [387, 510, 591, 650, 566, 550, 451, 369, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75208204, 'remaining_params': 9809396, 'pruned_model_sparsity': 0.8846192317825956, 'expected_sparsity': 0.87887, 'target_sparsity': 0.95, 'step': 19150}


Iteration:  46%|████▌     | 122/268 [00:22<01:45,  1.38it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<01:19,  1.83it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<01:00,  2.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:47,  2.98it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:38,  3.68it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:32,  4.36it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:28,  4.95it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:25,  5.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:22,  6.08it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:21,  6.35it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  6.86it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:19,  6.87it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.19it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.23it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.48it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.42it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.29it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.39it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.45it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.50it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.65it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.58it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.57it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.55it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.50it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.51it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.59it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.64it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.67it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.69it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.68it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.58it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.73it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.75it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.72it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.66it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.63it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.68it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.79it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.86it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.81it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.77it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.62it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.65it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.56it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.72it/s][A[INFO|trainer.py:570] 2024-04-21 16:53:57,822 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:53:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:53:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:53:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:53:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:53:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:53:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3643251685349662, 'eval_loss': 1.0875708, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [387, 509, 591, 648, 565, 549, 451, 369, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75211268, 'remaining_params': 9806332, 'pruned_model_sparsity': 0.8846552713791027, 'expected_sparsity': 0.87892, 'target_sparsity': 0.95, 'step': 19200}


Iteration:  64%|██████▍   | 172/268 [00:30<01:08,  1.39it/s][A04/21/2024 16:53:59 - INFO - trainer.trainer_mod - v4 Global step: 19200, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:30<00:51,  1.84it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:39,  2.39it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:30,  3.03it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:25,  3.66it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:20,  4.34it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:18,  4.97it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:15,  5.57it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:14,  6.04it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:13,  6.40it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  6.71it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.95it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.13it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.32it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.41it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.48it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.56it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.56it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:09,  7.71it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.49it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.67it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.68it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.65it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.65it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.69it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.68it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.44it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.52it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.59it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.63it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.72it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.53it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.49it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.53it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.42it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.48it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.38it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.37it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.28it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.39it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.48it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.64it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.64it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.67it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.69it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 16:54:06,381 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:54:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:54:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:54:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:54:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.94it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:54:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:54:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3996145901095533, 'eval_loss': 1.0107632, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [387, 509, 590, 646, 565, 549, 451, 368, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75214332, 'remaining_params': 9803268, 'pruned_model_sparsity': 0.8846913109756097, 'expected_sparsity': 0.87899, 'target_sparsity': 0.95, 'step': 19250}


Iteration:  83%|████████▎ | 222/268 [00:39<00:33,  1.39it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:24,  1.84it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:18,  2.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:14,  2.94it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:11,  3.61it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:09,  4.24it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:08,  4.88it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:07,  5.49it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:06,  6.00it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.42it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.67it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:05,  6.96it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.13it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.30it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.41it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.52it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.61it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.63it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.54it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.57it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.56it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.55it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:02,  7.72it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.74it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.60it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.30it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.39it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.42it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.50it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.40it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.50it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.67it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.67it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.67it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.67it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.77it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.69it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.69it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.55it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.34it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.30it/s][A04/21/2024 16:54:14 - INFO - trainer.trainer_mod - Epoch 71 finished. Took 45.25 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  72%|███████▏  | 72/100 [55:27<21:19, 45.69s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:32,  8.29it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.86it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 16:54:14,941 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:54:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:54:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:54:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:54:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:54:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:54:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40052105090542706, 'eval_loss': 0.91192144, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [387, 507, 590, 645, 564, 548, 450, 368, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75218928, 'remaining_params': 9798672, 'pruned_model_sparsity': 0.8847453703703704, 'expected_sparsity': 0.87899, 'target_sparsity': 0.95, 'step': 19300}


Iteration:   1%|▏         | 4/268 [00:02<03:59,  1.10it/s][A04/21/2024 16:54:16 - INFO - trainer.trainer_mod - v4 Global step: 19300, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:44,  1.60it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:59,  2.18it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:31,  2.85it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:13,  3.53it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:01,  4.22it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:53,  4.81it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:48,  5.33it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:43,  5.86it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:40,  6.31it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:38,  6.65it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:36,  6.91it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:35,  7.03it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:35,  7.11it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.28it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.26it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.27it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.37it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:32,  7.49it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:32,  7.52it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.55it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.47it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.44it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:31,  7.55it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.56it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.60it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.59it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.58it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:30,  7.62it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:30,  7.76it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.75it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.77it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:29,  7.77it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.65it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.64it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.66it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.52it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.38it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.54it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.55it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.45it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.40it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.47it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.53it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.72it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.67it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.68it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.66it/s][A[INFO|trainer.py:570] 2024-04-21 16:54:23,546 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:54:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:54:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:54:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:54:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:54:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:54:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38729558335377673, 'eval_loss': 0.99568063, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [386, 506, 589, 643, 563, 548, 450, 368, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75223524, 'remaining_params': 9794076, 'pruned_model_sparsity': 0.8847994297651309, 'expected_sparsity': 0.87912, 'target_sparsity': 0.95, 'step': 19350}


Iteration:  20%|██        | 54/268 [00:11<02:34,  1.39it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:56,  1.83it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:29,  2.37it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<01:10,  2.99it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:57,  3.66it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:47,  4.39it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:41,  5.00it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:37,  5.53it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:33,  6.18it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:31,  6.57it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.78it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:28,  7.05it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:27,  7.24it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:27,  7.35it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:27,  7.27it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.37it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.48it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.44it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.46it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:26,  7.28it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.47it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.43it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.48it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.45it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.54it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.59it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.46it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.38it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.47it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.50it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.45it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.53it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.53it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.53it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.51it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.54it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.59it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.65it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.57it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.72it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.69it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:54:32,121 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:54:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:54:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:54:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:54:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:54:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:54:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3868137302138668, 'eval_loss': 1.0603462, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [386, 504, 588, 641, 563, 547, 449, 367, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75229652, 'remaining_params': 9787948, 'pruned_model_sparsity': 0.8848715089581451, 'expected_sparsity': 0.87918, 'target_sparsity': 0.95, 'step': 19400}


Iteration:  39%|███▉      | 104/268 [00:19<01:57,  1.39it/s][A04/21/2024 16:54:34 - INFO - trainer.trainer_mod - v4 Global step: 19400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:19<01:28,  1.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<01:08,  2.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:53,  3.00it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:43,  3.71it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:36,  4.37it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:32,  4.92it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:28,  5.52it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:25,  6.01it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:24,  6.45it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:23,  6.62it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.82it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  7.15it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:20,  7.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:19,  7.51it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.37it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.37it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:19,  7.36it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.36it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.59it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:18,  7.82it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:18,  7.64it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:18,  7.54it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.58it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.47it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.50it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.22it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.38it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.40it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.37it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.49it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.43it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  6.97it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.18it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.39it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.32it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.34it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.55it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.56it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.64it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.65it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.86it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.84it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.56it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.67it/s][A[INFO|trainer.py:570] 2024-04-21 16:54:40,732 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:54:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:54:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:54:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:54:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:54:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:54:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39057368837569445, 'eval_loss': 1.0485808, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [385, 503, 588, 639, 562, 546, 449, 367, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75234248, 'remaining_params': 9783352, 'pruned_model_sparsity': 0.8849255683529057, 'expected_sparsity': 0.87921, 'target_sparsity': 0.95, 'step': 19450}


Iteration:  57%|█████▋    | 154/268 [00:28<01:21,  1.39it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<01:01,  1.85it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:46,  2.39it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:36,  3.02it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:29,  3.68it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:25,  4.35it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:21,  4.99it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:19,  5.59it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:17,  6.07it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:16,  6.46it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.76it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  6.87it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  7.11it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.27it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.35it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.43it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.50it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:12,  7.55it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.55it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.55it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.42it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.29it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.54it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.60it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.76it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.52it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.57it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.51it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.55it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.76it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.75it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.77it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.74it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.71it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.68it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.70it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.66it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.59it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.62it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.61it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.57it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.58it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.62it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:08,  7.68it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.22it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.36it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.46it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:54:49,286 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:54:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:54:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:54:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:54:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.00it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:54:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:54:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38975570944863003, 'eval_loss': 1.0229138, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [385, 502, 587, 637, 562, 546, 449, 367, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75235780, 'remaining_params': 9781820, 'pruned_model_sparsity': 0.8849435881511593, 'expected_sparsity': 0.87927, 'target_sparsity': 0.95, 'step': 19500}


Iteration:  76%|███████▌  | 204/268 [00:36<00:46,  1.39it/s][A04/21/2024 16:54:51 - INFO - trainer.trainer_mod - v4 Global step: 19500, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:36<00:34,  1.84it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:26,  2.38it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:20,  3.00it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:16,  3.66it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:13,  4.31it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:11,  4.96it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:10,  5.66it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:09,  6.14it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:08,  6.54it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  6.83it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.03it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.33it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.45it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.66it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.65it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.62it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.61it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.60it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:05,  7.63it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.67it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.57it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.56it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.44it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.50it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.58it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.73it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.75it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.78it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.51it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.61it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.53it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.47it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.47it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.67it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.55it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.60it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.65it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.63it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.63it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.64it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.67it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.36it/s][A[INFO|trainer.py:570] 2024-04-21 16:54:57,821 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:54:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:54:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:54:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:54:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:54:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:54:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37973525631011207, 'eval_loss': 1.1068969, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [385, 500, 586, 635, 561, 545, 449, 366, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75241908, 'remaining_params': 9775692, 'pruned_model_sparsity': 0.8850156673441735, 'expected_sparsity': 0.87931, 'target_sparsity': 0.95, 'step': 19550}


Iteration:  95%|█████████▍| 254/268 [00:45<00:10,  1.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:07,  1.83it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:05,  2.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:03,  3.00it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:02,  3.65it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:02,  4.26it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  4.89it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  5.37it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:01,  5.91it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.26it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  6.63it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.79it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.00it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.18it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.76it/s][A04/21/2024 16:55:01 - INFO - trainer.trainer_mod - Epoch 72 finished. Took 47.21 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  73%|███████▎  | 73/100 [56:14<20:45, 46.15s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.36it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.43it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.49it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.52it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.52it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.55it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.46it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.44it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.49it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:36,  6.95it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.08it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.14it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.20it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.22it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.32it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.43it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.52it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.46it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.43it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.49it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.42it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.52it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.67it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.51it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.57it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.37it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.44it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.47it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.63it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.61it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 16:55:06,477 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:55:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:55:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:55:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:55:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 16.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.88it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.18it/s]04/21/2024 16:55:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:55:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37970719979984185, 'eval_loss': 1.0612526, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [385, 499, 586, 633, 561, 544, 449, 366, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75243440, 'remaining_params': 9774160, 'pruned_model_sparsity': 0.885033687142427, 'expected_sparsity': 0.87933, 'target_sparsity': 0.95, 'step': 19600}


Iteration:  13%|█▎        | 36/268 [00:06<02:47,  1.38it/s][A04/21/2024 16:55:08 - INFO - trainer.trainer_mod - v4 Global step: 19600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:06<02:06,  1.83it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<01:37,  2.37it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:17,  2.96it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:03,  3.62it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:52,  4.29it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:45,  4.94it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:40,  5.54it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:36,  6.12it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:34,  6.44it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:33,  6.68it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  6.96it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.18it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.37it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.46it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.54it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.46it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.55it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.54it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.34it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.58it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.58it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.64it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.54it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.37it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.51it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.58it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.64it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:25,  7.77it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.71it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.71it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.70it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.63it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.67it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.68it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.66it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:24,  7.87it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.78it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.61it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.82it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.78it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:23,  7.85it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.70it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.48it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:25,  7.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 16:55:15,027 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:55:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:55:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:55:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:55:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:55:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:55:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36387568263546954, 'eval_loss': 1.0184356, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [385, 497, 586, 631, 560, 544, 448, 366, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75246504, 'remaining_params': 9771096, 'pruned_model_sparsity': 0.885069726738934, 'expected_sparsity': 0.87942, 'target_sparsity': 0.95, 'step': 19650}


Iteration:  32%|███▏      | 86/268 [00:15<02:11,  1.39it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:38,  1.83it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<01:15,  2.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<01:00,  2.98it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:48,  3.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:40,  4.34it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:35,  4.93it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:31,  5.52it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:28,  6.13it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.53it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:25,  6.84it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:24,  6.99it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.21it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.22it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.46it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.55it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.71it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.69it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.69it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.48it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.65it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.67it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.57it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.73it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:19,  7.75it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:19,  7.72it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.69it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.74it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.73it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.84it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.77it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.70it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.60it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.62it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.64it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.56it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.42it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.52it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.54it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.57it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.56it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.40it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.31it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.36it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.48it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:55:23,569 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:55:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:55:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:55:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:55:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:55:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:55:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3813215207797267, 'eval_loss': 1.0044104, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [384, 496, 585, 630, 559, 543, 448, 365, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 4, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75254164, 'remaining_params': 9763436, 'pruned_model_sparsity': 0.8851598257302018, 'expected_sparsity': 0.87949, 'target_sparsity': 0.95, 'step': 19700}


Iteration:  51%|█████     | 136/268 [00:23<01:35,  1.39it/s][A04/21/2024 16:55:25 - INFO - trainer.trainer_mod - v4 Global step: 19700, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:24<01:11,  1.84it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:54,  2.38it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:43,  2.97it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:35,  3.64it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:29,  4.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:25,  4.92it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:22,  5.52it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:21,  5.86it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:19,  6.31it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:18,  6.63it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  6.92it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:17,  7.03it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.23it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:16,  7.35it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.45it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.59it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.66it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.49it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.51it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.47it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.54it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.55it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.58it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.49it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.59it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.81it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.74it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:12,  7.71it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.88it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.66it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.67it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.67it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.52it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.52it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.54it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.57it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.81it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.73it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.68it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.76it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.65it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 16:55:32,125 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:55:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:55:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:55:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:55:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:55:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:55:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35481258251848646, 'eval_loss': 1.068827, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [384, 495, 585, 628, 559, 543, 448, 365, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75254164, 'remaining_params': 9763436, 'pruned_model_sparsity': 0.8851598257302018, 'expected_sparsity': 0.87948, 'target_sparsity': 0.95, 'step': 19750}


Iteration:  69%|██████▉   | 186/268 [00:32<00:59,  1.39it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:44,  1.84it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:33,  2.37it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:26,  2.95it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:21,  3.66it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:17,  4.31it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:15,  4.98it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:13,  5.55it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:12,  6.07it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:11,  6.47it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:10,  6.89it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:10,  7.04it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.21it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.31it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.60it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.59it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.74it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.70it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.73it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.50it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.16it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.28it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.35it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.37it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.33it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.45it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.45it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.54it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.56it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.56it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.59it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.66it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.88it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.69it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.71it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.59it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.55it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.60it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.49it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.70it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.70it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.59it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 16:55:40,686 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:55:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:55:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:55:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:55:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:55:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:55:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3865334830326713, 'eval_loss': 1.034169, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [384, 494, 584, 626, 558, 542, 447, 365, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75260292, 'remaining_params': 9757308, 'pruned_model_sparsity': 0.8852319049232159, 'expected_sparsity': 0.87957, 'target_sparsity': 0.95, 'step': 19800}


Iteration:  88%|████████▊ | 236/268 [00:41<00:22,  1.39it/s][A04/21/2024 16:55:42 - INFO - trainer.trainer_mod - v4 Global step: 19800, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:41<00:16,  1.83it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:12,  2.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:09,  3.02it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:07,  3.69it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:06,  4.39it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:05,  5.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:04,  5.62it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.19it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  6.44it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  6.59it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:03,  6.87it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.01it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.19it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.24it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  6.99it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.07it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.25it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.39it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.59it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.46it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.50it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.46it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.51it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.65it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.51it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.42it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.39it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.49it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.58it/s][A04/21/2024 16:55:46 - INFO - trainer.trainer_mod - Epoch 73 finished. Took 45.25 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  74%|███████▍  | 74/100 [57:00<19:52, 45.88s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.34it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.41it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.79it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.64it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.66it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.65it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.63it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.63it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:32,  7.82it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.72it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.58it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.64it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.53it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.55it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.61it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:55:49,243 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:55:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:55:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:55:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:55:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:55:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:55:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36813718963746117, 'eval_loss': 1.049461, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [384, 493, 584, 624, 558, 542, 447, 364, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75261824, 'remaining_params': 9755776, 'pruned_model_sparsity': 0.8852499247214695, 'expected_sparsity': 0.87959, 'target_sparsity': 0.95, 'step': 19850}


Iteration:   7%|▋         | 18/268 [00:04<03:00,  1.39it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:15,  1.84it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:44,  2.37it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:23,  2.97it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:08,  3.62it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:56,  4.30it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:49,  4.94it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:43,  5.55it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:39,  6.06it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:37,  6.45it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:35,  6.78it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:34,  7.03it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:33,  7.16it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.32it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.41it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:32,  7.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.21it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.32it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.43it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.53it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.51it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.47it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.63it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.77it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.73it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.71it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.75it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.75it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.69it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.65it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:27,  7.89it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:27,  7.83it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.89it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:27,  7.83it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.76it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.69it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.70it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.81it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:26,  7.97it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:26,  7.90it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.70it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:29,  7.12it/s][A
Iteration:  23%|██▎       | 61/268 [00:09<00:28,  7.26it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.17it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.30it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.41it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.46it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:55:57,804 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:55:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:55:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:55:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:55:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:55:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:55:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3904332987871741, 'eval_loss': 0.9853773, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [383, 491, 583, 622, 558, 541, 447, 364, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75266420, 'remaining_params': 9751180, 'pruned_model_sparsity': 0.88530398411623, 'expected_sparsity': 0.87966, 'target_sparsity': 0.95, 'step': 19900}


Iteration:  25%|██▌       | 68/268 [00:12<02:24,  1.39it/s][A04/21/2024 16:55:59 - INFO - trainer.trainer_mod - v4 Global step: 19900, Alignment: tensor([ 0,  7,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:13<01:48,  1.83it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<01:22,  2.39it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:04,  3.03it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:53,  3.63it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:45,  4.33it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:38,  4.99it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:34,  5.59it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:31,  6.00it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:29,  6.45it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.77it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.00it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.14it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.24it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:25,  7.32it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:25,  7.28it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.47it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.33it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.41it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.47it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.55it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.57it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.48it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:22,  7.71it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.81it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.81it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.78it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.72it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.75it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.67it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.45it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.57it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.59it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.51it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.50it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.37it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.33it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.55it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.72it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:19,  7.74it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.63it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.60it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 16:56:06,359 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:56:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:56:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:56:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:56:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.95it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:56:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:56:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3876416999545416, 'eval_loss': 1.0381652, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [383, 490, 583, 621, 557, 541, 447, 364, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75267952, 'remaining_params': 9749648, 'pruned_model_sparsity': 0.8853220039144836, 'expected_sparsity': 0.8797, 'target_sparsity': 0.95, 'step': 19950}


Iteration:  44%|████▍     | 118/268 [00:21<01:48,  1.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<01:21,  1.84it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<01:02,  2.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:49,  2.98it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:39,  3.67it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:33,  4.34it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:28,  5.00it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:25,  5.58it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:23,  6.11it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:21,  6.44it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:21,  6.59it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:20,  6.87it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.09it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.43it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.37it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.35it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.47it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.64it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.54it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.54it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.58it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.69it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.60it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.53it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.55it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.69it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:16,  7.68it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.65it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.53it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.57it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.21it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:16,  7.33it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.44it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.56it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.62it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.54it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.59it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.29it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:15,  7.24it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  6.96it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  7.07it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.16it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.31it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.25it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:14,  7.34it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.32it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.30it/s][A[INFO|trainer.py:570] 2024-04-21 16:56:15,003 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:56:15 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:56:15 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:56:15 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:56:15 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:56:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:56:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3817526421408947, 'eval_loss': 1.0134604, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [383, 488, 582, 619, 557, 540, 446, 364, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75272548, 'remaining_params': 9745052, 'pruned_model_sparsity': 0.8853760633092442, 'expected_sparsity': 0.87976, 'target_sparsity': 0.95, 'step': 20000}


Iteration:  63%|██████▎   | 168/268 [00:30<01:12,  1.38it/s][A04/21/2024 16:56:17 - INFO - trainer.trainer_mod - v4 Global step: 20000, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:30<00:54,  1.82it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:41,  2.37it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:32,  3.00it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:25,  3.71it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:21,  4.38it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:18,  5.01it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:16,  5.61it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:15,  6.04it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:14,  6.42it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.73it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.02it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.19it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.23it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.34it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.61it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:10,  7.76it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.99it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  8.05it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.83it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.81it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.74it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.58it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.50it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.53it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.47it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.69it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.73it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:08,  7.75it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.91it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.79it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.74it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.71it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.49it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.32it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.41it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.49it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.57it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.50it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.31it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.40it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.47it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.43it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.52it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 16:56:23,520 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:56:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:56:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:56:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:56:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:56:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:56:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39435907755376837, 'eval_loss': 1.0072886, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [382, 487, 582, 617, 556, 540, 446, 363, 235, 182, 197, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75277144, 'remaining_params': 9740456, 'pruned_model_sparsity': 0.8854301227040048, 'expected_sparsity': 0.8798, 'target_sparsity': 0.95, 'step': 20050}


Iteration:  81%|████████▏ | 218/268 [00:38<00:35,  1.39it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:26,  1.84it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:20,  2.37it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:15,  3.01it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:12,  3.69it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:10,  4.36it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:08,  4.95it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:07,  5.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:07,  5.93it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:06,  6.36it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  6.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  6.90it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.12it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  7.18it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.33it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.26it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.29it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.50it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.60it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.63it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.66it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.66it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.54it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.59it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.43it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.33it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.43it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.31it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.55it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.60it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.60it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.56it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.72it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.69it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.55it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.75it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.71it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.71it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.69it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.68it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.82it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.65it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 16:56:32,074 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:56:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:56:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:56:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:56:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:56:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:56:34 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.33885473296475527, 'eval_loss': 1.0437646, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [382, 486, 581, 615, 555, 539, 445, 363, 235, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75283272, 'remaining_params': 9734328, 'pruned_model_sparsity': 0.885502201897019, 'expected_sparsity': 0.87987, 'target_sparsity': 0.95, 'step': 20100}


Iteration: 100%|██████████| 268/268 [00:47<00:00,  1.41it/s][A04/21/2024 16:56:34 - INFO - trainer.trainer_mod - Epoch 74 finished. Took 47.15 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  75%|███████▌  | 75/100 [57:47<19:16, 46.26s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/21/2024 16:56:34 - INFO - trainer.trainer_mod - v4 Global step: 20100, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:35,  7.60it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.48it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.44it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:36,  7.28it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.42it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.33it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.44it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.53it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:37,  6.96it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:36,  7.14it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.30it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.59it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.76it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:32,  7.78it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.68it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:31,  7.88it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:31,  7.83it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.67it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.81it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.88it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.83it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.61it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.57it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.62it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.61it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.56it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.38it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.45it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.48it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.55it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.66it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.59it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.61it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.53it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.45it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.46it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:29,  7.57it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:29,  7.64it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.63it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:29,  7.50it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:29,  7.59it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:29,  7.53it/s][A
Iteration:  18%|█▊        | 48/268 [00:06<00:30,  7.27it/s][A
Iteration:  18%|█▊        | 49/268 [00:06<00:29,  7.31it/s][A[INFO|trainer.py:570] 2024-04-21 16:56:40,677 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:56:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:56:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:56:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:56:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:56:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:56:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39847442224438806, 'eval_loss': 0.9812074, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [382, 485, 581, 614, 555, 538, 445, 363, 235, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75284804, 'remaining_params': 9732796, 'pruned_model_sparsity': 0.8855202216952726, 'expected_sparsity': 0.87992, 'target_sparsity': 0.95, 'step': 20150}


Iteration:  19%|█▊        | 50/268 [00:08<02:37,  1.38it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:58,  1.83it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<01:31,  2.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<01:11,  3.01it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:58,  3.68it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:48,  4.35it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:42,  5.00it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:37,  5.56it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:34,  6.08it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:32,  6.38it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:31,  6.58it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:30,  6.87it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:28,  7.19it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.34it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.45it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.54it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.59it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.60it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:27,  7.39it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.46it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.47it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.45it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.70it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.52it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.57it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.58it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.57it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.59it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.45it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.38it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.42it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.59it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.58it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.59it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.47it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.53it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.50it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.53it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:22,  7.58it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.64it/s][A
Iteration:  36%|███▌      | 97/268 [00:14<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 98/268 [00:14<00:22,  7.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:15<00:22,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 16:56:49,252 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:56:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:56:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:56:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:56:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:56:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:56:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35169991580782367, 'eval_loss': 1.108563, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [381, 483, 580, 612, 554, 538, 445, 362, 235, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75290932, 'remaining_params': 9726668, 'pruned_model_sparsity': 0.8855923008882867, 'expected_sparsity': 0.87994, 'target_sparsity': 0.95, 'step': 20200}


Iteration:  37%|███▋      | 100/268 [00:17<02:01,  1.39it/s][A04/21/2024 16:56:51 - INFO - trainer.trainer_mod - v4 Global step: 20200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:17<01:30,  1.85it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<01:09,  2.40it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:54,  3.00it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:44,  3.68it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:37,  4.32it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:33,  4.90it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:29,  5.50it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:26,  6.00it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:24,  6.41it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:23,  6.76it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:22,  6.93it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.18it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.26it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.38it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.37it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.34it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.42it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.42it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.45it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:20,  7.33it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.45it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.38it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.29it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:19,  7.37it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.56it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.42it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.47it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.50it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.66it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:18,  7.36it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.43it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.48it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.66it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:16,  7.60it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.64it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.66it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.47it/s][A
Iteration:  54%|█████▎    | 144/268 [00:23<00:16,  7.54it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:16,  7.59it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:16,  7.47it/s][A
Iteration:  55%|█████▌    | 148/268 [00:23<00:15,  7.54it/s][A
Iteration:  56%|█████▌    | 149/268 [00:23<00:15,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 16:56:57,867 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:56:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:56:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:56:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:56:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:56:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:56:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3885226056541606, 'eval_loss': 1.0606674, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [381, 482, 580, 610, 554, 537, 445, 362, 235, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75292464, 'remaining_params': 9725136, 'pruned_model_sparsity': 0.8856103206865402, 'expected_sparsity': 0.87995, 'target_sparsity': 0.95, 'step': 20250}


Iteration:  56%|█████▌    | 150/268 [00:25<01:25,  1.38it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<01:03,  1.84it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:48,  2.38it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:38,  2.98it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:30,  3.68it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:26,  4.34it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:22,  4.99it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:19,  5.59it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:18,  6.07it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:17,  6.35it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:16,  6.64it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  6.94it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.16it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.42it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:14,  7.10it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.52it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.61it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.53it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.69it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.59it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.62it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.54it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.41it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.53it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.55it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.48it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.64it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.63it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.61it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.53it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:10,  7.78it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.75it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.74it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.86it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.66it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.66it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.66it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.68it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.49it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.51it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:09,  7.59it/s][A
Iteration:  72%|███████▏  | 194/268 [00:31<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:31<00:09,  7.68it/s][A
Iteration:  73%|███████▎  | 196/268 [00:31<00:09,  7.69it/s][A
Iteration:  74%|███████▎  | 197/268 [00:31<00:09,  7.70it/s][A
Iteration:  74%|███████▍  | 198/268 [00:32<00:09,  7.66it/s][A
Iteration:  74%|███████▍  | 199/268 [00:32<00:09,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:57:06,403 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:57:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:57:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:57:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:57:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.99it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.21it/s]04/21/2024 16:57:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:57:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38604145398162043, 'eval_loss': 1.1039817, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [381, 481, 580, 609, 553, 537, 445, 362, 235, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75293996, 'remaining_params': 9723604, 'pruned_model_sparsity': 0.8856283404847938, 'expected_sparsity': 0.88006, 'target_sparsity': 0.95, 'step': 20300}


Iteration:  75%|███████▍  | 200/268 [00:34<00:49,  1.39it/s][A04/21/2024 16:57:08 - INFO - trainer.trainer_mod - v4 Global step: 20300, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:34<00:36,  1.84it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:27,  2.38it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:21,  2.99it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:17,  3.67it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:14,  4.35it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:12,  4.96it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:10,  5.61it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:09,  6.04it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:09,  6.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:08,  6.76it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:08,  7.00it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.01it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.26it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.19it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.33it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:07,  7.24it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.49it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.56it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.76it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.73it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.83it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.81it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.83it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.93it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.86it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.83it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:04,  7.94it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.87it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.85it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.79it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.70it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.58it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.61it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.40it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.42it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:04,  7.49it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.64it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.67it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.54it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.57it/s][A
Iteration:  91%|█████████ | 243/268 [00:39<00:03,  7.59it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.53it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.60it/s][A
Iteration:  92%|█████████▏| 246/268 [00:40<00:02,  7.72it/s][A
Iteration:  92%|█████████▏| 247/268 [00:40<00:02,  7.69it/s][A
Iteration:  93%|█████████▎| 248/268 [00:40<00:02,  7.69it/s][A
Iteration:  93%|█████████▎| 249/268 [00:40<00:02,  7.74it/s][A[INFO|trainer.py:570] 2024-04-21 16:57:14,906 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:57:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:57:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:57:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:57:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:57:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:57:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3447208135052164, 'eval_loss': 1.1387404, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [381, 479, 579, 607, 553, 536, 444, 362, 235, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75298592, 'remaining_params': 9719008, 'pruned_model_sparsity': 0.8856823998795543, 'expected_sparsity': 0.8801, 'target_sparsity': 0.95, 'step': 20350}


Iteration:  93%|█████████▎| 250/268 [00:42<00:12,  1.39it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:09,  1.85it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:06,  2.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:04,  3.01it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:03,  3.65it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:03,  4.33it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:02,  4.99it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:02,  5.49it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  5.99it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  6.54it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  6.84it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:01,  6.75it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  6.98it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.06it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.21it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.26it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.19it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.31it/s][A04/21/2024 16:57:19 - INFO - trainer.trainer_mod - Epoch 75 finished. Took 45.21 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  76%|███████▌  | 76/100 [58:32<18:22, 45.94s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.61it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.42it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.41it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.73it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.60it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.34it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.42it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.38it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.37it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:35,  7.24it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.38it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.37it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:34,  7.42it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.37it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.59it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.61it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.60it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.65it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.64it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.76it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.57it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.52it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.69it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.58it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:30,  7.78it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.52it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.59it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:30,  7.71it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:30,  7.69it/s][A[INFO|trainer.py:570] 2024-04-21 16:57:23,479 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:57:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:57:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:57:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:57:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:57:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:57:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3834646636732988, 'eval_loss': 1.0198499, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [380, 479, 579, 606, 552, 536, 444, 361, 235, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75303188, 'remaining_params': 9714412, 'pruned_model_sparsity': 0.885736459274315, 'expected_sparsity': 0.88013, 'target_sparsity': 0.95, 'step': 20400}


Iteration:  12%|█▏        | 32/268 [00:06<02:49,  1.39it/s][A04/21/2024 16:57:25 - INFO - trainer.trainer_mod - v4 Global step: 20400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:06<02:07,  1.84it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:38,  2.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<01:18,  2.98it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:03,  3.64it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:53,  4.33it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:46,  4.99it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:41,  5.58it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:37,  6.09it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:35,  6.38it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:33,  6.69it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:32,  6.97it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:31,  7.18it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.33it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.43it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.58it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.33it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.34it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.57it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.60it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.59it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.77it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.73it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:26,  7.89it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:26,  7.82it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.57it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.62it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.62it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.56it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.52it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.47it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.65it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.66it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:25,  7.70it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.69it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.69it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.71it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.71it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:24,  7.83it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.70it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.69it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:24,  7.71it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.71it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.57it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.71it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.63it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.67it/s][A[INFO|trainer.py:570] 2024-04-21 16:57:31,988 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:57:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:57:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:57:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:57:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:57:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:57:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3771311365217601, 'eval_loss': 1.0677646, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [380, 478, 578, 604, 552, 535, 443, 361, 235, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75307784, 'remaining_params': 9709816, 'pruned_model_sparsity': 0.8857905186690755, 'expected_sparsity': 0.88021, 'target_sparsity': 0.95, 'step': 20450}


Iteration:  31%|███       | 82/268 [00:14<02:12,  1.40it/s][A
Iteration:  31%|███       | 83/268 [00:14<01:39,  1.85it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<01:17,  2.38it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<01:01,  3.00it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:49,  3.66it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:42,  4.30it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:36,  4.93it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:32,  5.54it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:29,  6.13it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:27,  6.52it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:25,  6.81it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:25,  6.96it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.16it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.28it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.31it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.37it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:23,  7.28it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.39it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.33it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.24it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:22,  7.25it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:22,  7.31it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.37it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.59it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.57it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.63it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.60it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.62it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.64it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.66it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.50it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.62it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.76it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.34it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.43it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.41it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.52it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.55it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.59it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.48it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.52it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 16:57:40,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:57:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:57:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:57:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:57:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:57:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:57:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38945391483386416, 'eval_loss': 0.98171276, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [380, 477, 577, 603, 551, 534, 443, 361, 234, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75313912, 'remaining_params': 9703688, 'pruned_model_sparsity': 0.8858625978620898, 'expected_sparsity': 0.88026, 'target_sparsity': 0.95, 'step': 20500}


Iteration:  49%|████▉     | 132/268 [00:23<01:38,  1.39it/s][A04/21/2024 16:57:42 - INFO - trainer.trainer_mod - v4 Global step: 20500, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:23<01:13,  1.84it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:56,  2.38it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:44,  2.99it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:36,  3.66it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:29,  4.40it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:25,  5.04it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:22,  5.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:20,  6.22it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.70it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:18,  6.99it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.38it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:16,  7.47it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.53it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.58it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.61it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.65it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.79it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.31it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.48it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:16,  6.96it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.29it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.57it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.56it/s][A
Iteration:  60%|█████▉    | 160/268 [00:26<00:14,  7.68it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.69it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.66it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.53it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.70it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.69it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.56it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.39it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.32it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.44it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.35it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.44it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.65it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.56it/s][A
Iteration:  65%|██████▌   | 175/268 [00:28<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.29it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.52it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.55it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.49it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.52it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 16:57:49,167 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:57:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:57:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:57:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:57:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:57:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:57:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36168168621477015, 'eval_loss': 1.0364774, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [379, 476, 577, 601, 551, 534, 443, 361, 234, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75315444, 'remaining_params': 9702156, 'pruned_model_sparsity': 0.8858806176603433, 'expected_sparsity': 0.8803, 'target_sparsity': 0.95, 'step': 20550}


Iteration:  68%|██████▊   | 182/268 [00:31<01:01,  1.39it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:46,  1.85it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:35,  2.39it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:27,  3.01it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:22,  3.68it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:18,  4.32it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:15,  5.02it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:14,  5.61it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:12,  6.09it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.52it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:11,  6.74it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.00it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.21it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.35it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.40it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.62it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.63it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.56it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.59it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.60it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.62it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.65it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.66it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.53it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.40it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.52it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.71it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.57it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.58it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.51it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.45it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.56it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.59it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.61it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.63it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.83it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.80it/s][A
Iteration:  82%|████████▏ | 221/268 [00:36<00:06,  7.73it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.62it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.61it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.61it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.50it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.42it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.44it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.70it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.69it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.70it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.86it/s][A[INFO|trainer.py:570] 2024-04-21 16:57:57,686 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:57:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:57:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:57:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:57:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:57:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:57:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3349053283899286, 'eval_loss': 1.1245244, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [379, 474, 577, 599, 550, 533, 443, 361, 234, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75318508, 'remaining_params': 9699092, 'pruned_model_sparsity': 0.8859166572568503, 'expected_sparsity': 0.88034, 'target_sparsity': 0.95, 'step': 20600}


Iteration:  87%|████████▋ | 232/268 [00:40<00:25,  1.39it/s][A04/21/2024 16:57:59 - INFO - trainer.trainer_mod - v4 Global step: 20600, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:40<00:19,  1.84it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:14,  2.38it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:11,  2.99it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:08,  3.64it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:07,  4.27it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:06,  4.83it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:05,  5.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:04,  5.99it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:04,  6.35it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  6.70it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  6.98it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.29it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.24it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.36it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.41it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.45it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.48it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.51it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.33it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.40it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.51it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.58it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.51it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.44it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.34it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.34it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.43it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.52it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.60it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.52it/s][A04/21/2024 16:58:04 - INFO - trainer.trainer_mod - Epoch 76 finished. Took 45.17 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  77%|███████▋  | 77/100 [59:17<17:31, 45.71s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.81it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.57it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.55it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.61it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.64it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.65it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.48it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 16:58:06,273 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:58:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:58:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:58:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:58:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.81it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 16:58:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:58:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3573647697270512, 'eval_loss': 1.0549747, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [379, 473, 576, 597, 550, 533, 442, 360, 234, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75323104, 'remaining_params': 9694496, 'pruned_model_sparsity': 0.885970716651611, 'expected_sparsity': 0.88042, 'target_sparsity': 0.95, 'step': 20650}


Iteration:   5%|▌         | 14/268 [00:03<03:04,  1.38it/s][A
Iteration:   6%|▌         | 15/268 [00:03<02:19,  1.82it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:46,  2.36it/s][A
Iteration:   6%|▋         | 17/268 [00:04<01:24,  2.96it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:09,  3.60it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:58,  4.26it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:50,  4.92it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:44,  5.53it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:41,  5.89it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:39,  6.24it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:36,  6.73it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:34,  6.96it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.17it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.20it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.32it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.40it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.34it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.40it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.49it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.76it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:29,  7.76it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:29,  7.70it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:30,  7.60it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.44it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.35it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.56it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.53it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.70it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.47it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.57it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.76it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.87it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:27,  7.94it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:27,  7.88it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.69it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.66it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.69it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.56it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.59it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.42it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.50it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.52it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.41it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.61it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.64it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 16:58:14,853 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:58:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:58:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:58:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:58:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:58:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:58:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36773870652086177, 'eval_loss': 1.0437483, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [379, 471, 576, 595, 550, 532, 442, 360, 234, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75324636, 'remaining_params': 9692964, 'pruned_model_sparsity': 0.8859887364498645, 'expected_sparsity': 0.88045, 'target_sparsity': 0.95, 'step': 20700}


Iteration:  24%|██▍       | 64/268 [00:12<02:26,  1.39it/s][A04/21/2024 16:58:16 - INFO - trainer.trainer_mod - v4 Global step: 20700, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:12<01:49,  1.85it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<01:24,  2.39it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<01:06,  3.01it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:54,  3.68it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:45,  4.36it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:39,  5.01it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:35,  5.59it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:32,  6.08it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:30,  6.32it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:28,  6.76it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:27,  6.92it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:26,  7.14it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:26,  7.31it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.40it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.11it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.28it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:25,  7.32it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.41it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.66it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.80it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.49it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.44it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.47it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.52it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.45it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.52it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.56it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.63it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.77it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.60it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.64it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.55it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.55it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.63it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.61it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.63it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.66it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.70it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.55it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.69it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.58it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.55it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.57it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.69it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 16:58:23,400 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:58:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:58:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:58:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:58:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:58:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:58:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.352519256043119, 'eval_loss': 1.0107312, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [378, 470, 575, 594, 549, 532, 442, 360, 233, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75330764, 'remaining_params': 9686836, 'pruned_model_sparsity': 0.8860608156428786, 'expected_sparsity': 0.88051, 'target_sparsity': 0.95, 'step': 20750}


Iteration:  43%|████▎     | 114/268 [00:20<01:50,  1.39it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<01:23,  1.84it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<01:03,  2.39it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:50,  2.99it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:40,  3.67it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:34,  4.34it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:30,  4.93it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:26,  5.58it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:24,  6.08it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:22,  6.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:21,  6.62it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:20,  6.91it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:20,  7.02it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.99it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.17it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.16it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.37it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.32it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.37it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.29it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.42it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.25it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.35it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.61it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.59it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.59it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.03it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.25it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.54it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.57it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.62it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.56it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.62it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.52it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.46it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.54it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.62it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.63it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.61it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.63it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.55it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.67it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.66it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.53it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.55it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 16:58:32,029 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:58:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:58:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:58:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:58:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:58:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:58:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3573647697270512, 'eval_loss': 1.1048973, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [378, 469, 575, 593, 549, 532, 442, 360, 233, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75330764, 'remaining_params': 9686836, 'pruned_model_sparsity': 0.8860608156428786, 'expected_sparsity': 0.88056, 'target_sparsity': 0.95, 'step': 20800}


Iteration:  61%|██████    | 164/268 [00:29<01:14,  1.39it/s][A04/21/2024 16:58:34 - INFO - trainer.trainer_mod - v4 Global step: 20800, Alignment: tensor([ 0,  7,  8, 10], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:29<00:55,  1.84it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:42,  2.38it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:33,  3.01it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:27,  3.66it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:22,  4.33it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:19,  4.98it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:17,  5.57it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:16,  5.94it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:15,  6.31it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:14,  6.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:13,  6.88it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.11it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.40it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.68it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.69it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.68it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.50it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.58it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.55it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.37it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.48it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.38it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.44it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.46it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.71it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.59it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.58it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.64it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.59it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.59it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.65it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.66it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.49it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.58it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.62it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.55it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.54it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.69it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.55it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.62it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.63it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.57it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 16:58:40,591 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:58:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:58:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:58:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:58:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:58:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:58:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36209284693594596, 'eval_loss': 1.0905066, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [378, 469, 574, 592, 548, 531, 441, 359, 233, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75338424, 'remaining_params': 9679176, 'pruned_model_sparsity': 0.8861509146341463, 'expected_sparsity': 0.88061, 'target_sparsity': 0.95, 'step': 20850}


Iteration:  80%|███████▉  | 214/268 [00:38<00:38,  1.39it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:28,  1.84it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:21,  2.38it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:16,  3.01it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:13,  3.71it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:11,  4.26it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:09,  4.88it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:08,  5.42it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:07,  5.92it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:07,  6.30it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  6.67it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  6.99it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.02it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.19it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.30it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.23it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.48it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.38it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.60it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.61it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.53it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.72it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.55it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.69it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.66it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.70it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.53it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.42it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.53it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.59it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.58it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.70it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.62it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.63it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.69it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.65it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.65it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.44it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.37it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.46it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.44it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.34it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.66it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.55it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.72it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.73it/s][A[INFO|trainer.py:570] 2024-04-21 16:58:49,166 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:58:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:58:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:58:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:58:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:58:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:58:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34988258589953775, 'eval_loss': 1.028637, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [377, 467, 574, 589, 548, 530, 441, 359, 232, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75343020, 'remaining_params': 9674580, 'pruned_model_sparsity': 0.886204974028907, 'expected_sparsity': 0.88068, 'target_sparsity': 0.95, 'step': 20900}


Iteration:  99%|█████████▊| 264/268 [00:46<00:02,  1.39it/s][A04/21/2024 16:58:51 - INFO - trainer.trainer_mod - v4 Global step: 20900, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [00:46<00:01,  1.84it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  2.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  2.99it/s][A04/21/2024 16:58:51 - INFO - trainer.trainer_mod - Epoch 77 finished. Took 47.21 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  78%|███████▊  | 78/100 [1:00:04<16:55, 46.16s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.40it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.49it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.59it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.77it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.76it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.73it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.70it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.63it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.65it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.61it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.42it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.48it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.57it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.62it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.67it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.64it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.69it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.89it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:30,  7.95it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.68it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.66it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.55it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:33,  7.19it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:33,  7.23it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:32,  7.24it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.37it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.51it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.54it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.77it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.69it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.67it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.64it/s][A
Iteration:  14%|█▍        | 38/268 [00:04<00:29,  7.81it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:29,  7.79it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.57it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.58it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:29,  7.58it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:30,  7.40it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.60it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:29,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 16:58:57,687 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:58:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:58:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:58:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:58:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:58:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:58:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3594876045500933, 'eval_loss': 1.0752943, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [377, 466, 574, 588, 547, 530, 441, 359, 232, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75344552, 'remaining_params': 9673048, 'pruned_model_sparsity': 0.8862229938271605, 'expected_sparsity': 0.88071, 'target_sparsity': 0.95, 'step': 20950}


Iteration:  17%|█▋        | 46/268 [00:08<02:39,  1.39it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<02:00,  1.84it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:32,  2.38it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<01:12,  3.00it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:59,  3.65it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:51,  4.19it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:44,  4.82it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:39,  5.41it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:35,  6.00it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:33,  6.41it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:31,  6.74it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:30,  6.98it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.29it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.32it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.40it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.44it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.46it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.58it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.52it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.59it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.47it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.36it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.51it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.44it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.64it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.69it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:24,  7.72it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.67it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.44it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.64it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.64it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.46it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.42it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.47it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.41it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.52it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.48it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.66it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.69it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.71it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.71it/s][A
Iteration:  34%|███▍      | 91/268 [00:13<00:22,  7.85it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.63it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:23,  7.36it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.43it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:23,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 16:59:06,279 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:59:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:59:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:59:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:59:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 16:59:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:59:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3397051032517386, 'eval_loss': 1.1362756, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [377, 465, 573, 587, 547, 529, 441, 359, 232, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75347616, 'remaining_params': 9669984, 'pruned_model_sparsity': 0.8862590334236675, 'expected_sparsity': 0.88077, 'target_sparsity': 0.95, 'step': 21000}


Iteration:  36%|███▌      | 96/268 [00:16<02:04,  1.38it/s][A04/21/2024 16:59:08 - INFO - trainer.trainer_mod - v4 Global step: 21000, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:16<01:33,  1.83it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<01:12,  2.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:57,  2.96it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:45,  3.66it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:38,  4.34it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:33,  4.97it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:30,  5.47it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:27,  5.92it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:25,  6.29it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:24,  6.54it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:23,  6.84it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.05it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.24it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.38it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.63it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.77it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.62it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.64it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.66it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.67it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.69it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.72it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.57it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.47it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.57it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.59it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.52it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.58it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.58it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.60it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.65it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.64it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:17,  7.68it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.84it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.80it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.60it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.50it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.70it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.66it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.67it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:16,  7.80it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:17,  7.46it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:18,  6.94it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:17,  7.13it/s][A
Iteration:  54%|█████▎    | 144/268 [00:22<00:16,  7.39it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 16:59:14,859 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:59:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:59:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:59:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:59:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:59:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:59:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35905571282366544, 'eval_loss': 1.1391826, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [377, 463, 573, 585, 546, 529, 440, 359, 231, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75352212, 'remaining_params': 9665388, 'pruned_model_sparsity': 0.8863130928184282, 'expected_sparsity': 0.8808, 'target_sparsity': 0.95, 'step': 21050}


Iteration:  54%|█████▍    | 146/268 [00:25<01:27,  1.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<01:05,  1.85it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:50,  2.39it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:39,  3.01it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:32,  3.67it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:26,  4.38it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:23,  5.02it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:21,  5.47it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:19,  5.98it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:17,  6.50it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:16,  6.82it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:16,  6.90it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.04it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:15,  7.10it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.24it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.39it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.58it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.58it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.75it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.76it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.76it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.53it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.57it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.53it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.56it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.50it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.56it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.47it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.52it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.43it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.51it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.55it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.50it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.62it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.64it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.64it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.68it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.71it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.47it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.54it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.47it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.69it/s][A
Iteration:  71%|███████   | 190/268 [00:30<00:10,  7.66it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.69it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.53it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:09,  7.56it/s][A
Iteration:  72%|███████▏  | 194/268 [00:31<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:31<00:09,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 16:59:23,422 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:59:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:59:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:59:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:59:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 16:59:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:59:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37538726920470683, 'eval_loss': 1.1148338, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [377, 463, 572, 583, 546, 528, 440, 358, 231, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75356808, 'remaining_params': 9660792, 'pruned_model_sparsity': 0.8863671522131888, 'expected_sparsity': 0.88089, 'target_sparsity': 0.95, 'step': 21100}


Iteration:  73%|███████▎  | 196/268 [00:33<00:52,  1.38it/s][A04/21/2024 16:59:25 - INFO - trainer.trainer_mod - v4 Global step: 21100, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:33<00:38,  1.83it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:29,  2.37it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:23,  2.95it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:18,  3.62it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:15,  4.26it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:13,  4.91it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:11,  5.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:10,  6.10it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:09,  6.43it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:09,  6.70it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  6.89it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.11it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.41it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.50it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.66it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.47it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.57it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.56it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.57it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.59it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.58it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.59it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.46it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.38it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.49it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.54it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.62it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.49it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.57it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.60it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.50it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.47it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.60it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.74it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.69it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.71it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.55it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.36it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.43it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.51it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.58it/s][A
Iteration:  91%|█████████ | 243/268 [00:39<00:03,  7.57it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.40it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 16:59:32,009 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:59:32 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:59:32 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:59:32 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:59:32 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 16:59:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:59:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3568992381406405, 'eval_loss': 1.1164085, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [377, 461, 572, 581, 545, 528, 440, 358, 231, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75358340, 'remaining_params': 9659260, 'pruned_model_sparsity': 0.8863851720114423, 'expected_sparsity': 0.88097, 'target_sparsity': 0.95, 'step': 21150}


Iteration:  92%|█████████▏| 246/268 [00:42<00:15,  1.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:11,  1.84it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:08,  2.38it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:06,  3.01it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:04,  3.69it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:03,  4.44it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:03,  5.06it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  5.63it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:02,  6.05it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  6.54it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  6.83it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.05it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.33it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.27it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.48it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.72it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.62it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.76it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.73it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.72it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.23it/s][A04/21/2024 16:59:36 - INFO - trainer.trainer_mod - Epoch 78 finished. Took 45.17 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  79%|███████▉  | 79/100 [1:00:50<16:03, 45.87s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.13it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.38it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.32it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.35it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.31it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:35,  7.31it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.42it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.33it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.27it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.49it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.57it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:36,  7.01it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:35,  7.15it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.15it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:35,  7.13it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:34,  7.41it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.49it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.58it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:31,  7.82it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:31,  7.81it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.73it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.60it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.80it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.80it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.75it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.70it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:59:40,540 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:59:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:59:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:59:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:59:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:59:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:59:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36813718963746117, 'eval_loss': 1.060449, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [376, 460, 572, 580, 545, 527, 440, 358, 231, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75361404, 'remaining_params': 9656196, 'pruned_model_sparsity': 0.8864212116079494, 'expected_sparsity': 0.881, 'target_sparsity': 0.95, 'step': 21200}


Iteration:  10%|█         | 28/268 [00:05<02:52,  1.39it/s][A04/21/2024 16:59:42 - INFO - trainer.trainer_mod - v4 Global step: 21200, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:05<02:09,  1.85it/s][A
Iteration:  11%|█         | 30/268 [00:05<01:39,  2.39it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<01:19,  3.00it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:04,  3.67it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:54,  4.35it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:47,  4.96it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:41,  5.60it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:38,  6.08it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:35,  6.45it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:33,  6.88it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:32,  7.06it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.11it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.28it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.48it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.51it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.53it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.58it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.61it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.60it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.53it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.63it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.66it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.66it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.57it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.70it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.70it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.73it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.73it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.62it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.66it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.59it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.62it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.78it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:28,  7.26it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.38it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.49it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.54it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.60it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.76it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.70it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.68it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.57it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.72it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:24,  7.69it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.41it/s][A[INFO|trainer.py:570] 2024-04-21 16:59:49,069 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:59:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:59:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:59:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:59:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 16:59:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:59:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35033510841794924, 'eval_loss': 1.0742745, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [376, 459, 572, 579, 544, 527, 439, 358, 231, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75364468, 'remaining_params': 9653132, 'pruned_model_sparsity': 0.8864572512044565, 'expected_sparsity': 0.88108, 'target_sparsity': 0.95, 'step': 21250}


Iteration:  29%|██▉       | 78/268 [00:14<02:17,  1.39it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:42,  1.84it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<01:19,  2.37it/s][A
Iteration:  30%|███       | 81/268 [00:14<01:02,  2.98it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:51,  3.65it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:43,  4.27it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:37,  4.93it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:34,  5.32it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:31,  5.73it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:29,  6.21it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:27,  6.55it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:26,  6.83it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  7.04it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.33it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.21it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:24,  7.24it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.34it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.31it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.45it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.64it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.53it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.32it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.31it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.48it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.56it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.57it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.55it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.60it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.63it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:20,  7.63it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.50it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.51it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.42it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.44it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:21,  7.32it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.32it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.32it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.43it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.53it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.59it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.59it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.62it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.65it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.69it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.70it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.61it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 16:59:57,708 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 16:59:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 16:59:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 16:59:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 16:59:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 16:59:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 16:59:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.369870679490583, 'eval_loss': 1.0625502, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [376, 458, 571, 577, 544, 526, 439, 358, 231, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75367532, 'remaining_params': 9650068, 'pruned_model_sparsity': 0.8864932908009636, 'expected_sparsity': 0.88113, 'target_sparsity': 0.95, 'step': 21300}


Iteration:  48%|████▊     | 128/268 [00:22<01:40,  1.39it/s][A04/21/2024 16:59:59 - INFO - trainer.trainer_mod - v4 Global step: 21300, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:23<01:15,  1.83it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:58,  2.37it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:45,  2.98it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:36,  3.69it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:30,  4.37it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:26,  5.01it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:23,  5.59it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:21,  6.08it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:20,  6.49it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:19,  6.80it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  7.07it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.15it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.09it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.37it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.39it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.49it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.46it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.50it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.54it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.65it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.69it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.70it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.72it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.74it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.71it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.69it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.45it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.53it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.38it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.46it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.44it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.61it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.63it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.36it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.45it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.52it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.46it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.49it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.43it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.51it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.34it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.44it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 17:00:06,288 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:00:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:00:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:00:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:00:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.93it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 17:00:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:00:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.378228174582819, 'eval_loss': 1.0651875, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [376, 457, 571, 577, 543, 526, 439, 357, 231, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75370596, 'remaining_params': 9647004, 'pruned_model_sparsity': 0.8865293303974706, 'expected_sparsity': 0.8812, 'target_sparsity': 0.95, 'step': 21350}


Iteration:  66%|██████▋   | 178/268 [00:31<01:05,  1.38it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:48,  1.82it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:37,  2.36it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:29,  2.98it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:23,  3.68it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:19,  4.36it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:16,  5.00it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:14,  5.61it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:13,  6.04it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:12,  6.35it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  6.67it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  6.95it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.19it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.21it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.33it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.47it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.60it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.62it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.65it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.77it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.85it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.79it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.64it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.82it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.78it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:07,  7.76it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.78it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.58it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.40it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.49it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.54it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.59it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.62it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.78it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.74it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.68it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.67it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.70it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.72it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.57it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.59it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.61it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 17:00:14,804 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:00:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:00:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:00:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:00:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:00:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:00:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37001238174729834, 'eval_loss': 1.1592289, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [376, 456, 571, 576, 543, 526, 439, 358, 231, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75369064, 'remaining_params': 9648536, 'pruned_model_sparsity': 0.8865113105992171, 'expected_sparsity': 0.88121, 'target_sparsity': 0.95, 'step': 21400}


Iteration:  85%|████████▌ | 228/268 [00:39<00:28,  1.39it/s][A04/21/2024 17:00:16 - INFO - trainer.trainer_mod - v4 Global step: 21400, Alignment: tensor([0, 1, 3, 8], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [00:40<00:21,  1.84it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:15,  2.41it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:12,  3.03it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:09,  3.67it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:08,  4.35it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:06,  4.92it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:05,  5.50it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:05,  5.96it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  6.32it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  6.68it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  6.93it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.09it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.09it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.07it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.07it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.39it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.44it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.46it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.53it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.60it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.65it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.53it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.41it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.68it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.70it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.70it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.91it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.75it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.60it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.56it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.56it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.48it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.42it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.53it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.57it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.49it/s][A04/21/2024 17:00:22 - INFO - trainer.trainer_mod - Epoch 79 finished. Took 45.24 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  80%|████████  | 80/100 [1:01:35<15:13, 45.68s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.71it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.50it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.61it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.43it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.49it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.40it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 17:00:23,370 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:00:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:00:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:00:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:00:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:00:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:00:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37033710191144653, 'eval_loss': 1.027309, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [376, 455, 571, 575, 543, 526, 439, 357, 231, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75370596, 'remaining_params': 9647004, 'pruned_model_sparsity': 0.8865293303974706, 'expected_sparsity': 0.88134, 'target_sparsity': 0.95, 'step': 21450}


Iteration:   4%|▎         | 10/268 [00:03<03:10,  1.36it/s][A
Iteration:   4%|▍         | 11/268 [00:03<02:22,  1.80it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:47,  2.37it/s][A
Iteration:   5%|▍         | 13/268 [00:03<01:25,  2.99it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:09,  3.67it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:57,  4.39it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:50,  5.02it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:44,  5.61it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:40,  6.11it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:38,  6.51it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:37,  6.65it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:36,  6.86it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:35,  6.99it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:33,  7.31it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.43it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.52it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.33it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.32it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.31it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.31it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.38it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.35it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.41it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.44it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.64it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:29,  7.85it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:29,  7.70it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.71it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.53it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.47it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.53it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.55it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.55it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.58it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.52it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.48it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.54it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.58it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.79it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.54it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.58it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.61it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.62it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.53it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.49it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 17:00:31,947 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:00:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:00:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:00:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:00:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.15it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:00:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:00:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36773870652086177, 'eval_loss': 1.0539137, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [375, 455, 570, 574, 543, 525, 438, 357, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75378256, 'remaining_params': 9639344, 'pruned_model_sparsity': 0.8866194293887383, 'expected_sparsity': 0.88156, 'target_sparsity': 0.95, 'step': 21500}


Iteration:  22%|██▏       | 60/268 [00:11<02:29,  1.39it/s][A04/21/2024 17:00:33 - INFO - trainer.trainer_mod - v4 Global step: 21500, Alignment: tensor([0, 0, 3, 8], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:12<01:52,  1.84it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<01:27,  2.37it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:08,  2.99it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:55,  3.65it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:46,  4.37it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:40,  5.03it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:35,  5.59it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:32,  6.08it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:30,  6.47it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:29,  6.77it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:28,  6.88it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:27,  7.07it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:27,  7.11it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.27it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.43it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:25,  7.53it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.55it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.61it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.65it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.64it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.68it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.69it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:23,  7.74it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.66it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.64it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.56it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.46it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.54it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.71it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.68it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:22,  7.82it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.41it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.47it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.66it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.71it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.66it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.51it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.58it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.44it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.52it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.59it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.65it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:20,  7.77it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.55it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 17:00:40,494 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:00:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:00:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:00:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:00:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:00:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:00:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37427395551191556, 'eval_loss': 1.0293392, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [375, 454, 569, 573, 542, 524, 438, 357, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75382852, 'remaining_params': 9634748, 'pruned_model_sparsity': 0.8866734887834989, 'expected_sparsity': 0.88185, 'target_sparsity': 0.95, 'step': 21550}


Iteration:  41%|████      | 110/268 [00:20<01:53,  1.39it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<01:25,  1.84it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<01:05,  2.38it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:51,  3.01it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:42,  3.64it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:35,  4.32it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:30,  4.98it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:27,  5.58it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:24,  6.16it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:22,  6.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:21,  6.86it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.02it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:20,  7.00it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.08it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.37it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.27it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.40it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.40it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.49it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.54it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.58it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.64it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.58it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.57it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.56it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.60it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.62it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:16,  7.74it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.73it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.85it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.94it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.87it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.76it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:15,  7.75it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:15,  7.76it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.65it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.63it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.67it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.65it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.55it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.79it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.67it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.63it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.50it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.58it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.63it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.61it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 17:00:49,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:00:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:00:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:00:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:00:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:00:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:00:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36395023953613853, 'eval_loss': 1.0707914, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [375, 452, 569, 571, 542, 524, 438, 357, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75382852, 'remaining_params': 9634748, 'pruned_model_sparsity': 0.8866734887834989, 'expected_sparsity': 0.88237, 'target_sparsity': 0.95, 'step': 21600}


Iteration:  60%|█████▉    | 160/268 [00:28<01:18,  1.38it/s][A04/21/2024 17:00:51 - INFO - trainer.trainer_mod - v4 Global step: 21600, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:29<00:58,  1.83it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:44,  2.37it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:35,  2.98it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:28,  3.62it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:24,  4.25it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:21,  4.84it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:18,  5.45it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:16,  5.96it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:15,  6.46it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:14,  6.78it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:13,  7.04it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.23it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.32it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.56it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.53it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.53it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.55it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.33it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.29it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.37it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.46it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.52it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.56it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.61it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.62it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.63it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.67it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.57it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.41it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.43it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.49it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.66it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.68it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.68it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.51it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.45it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.33it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.38it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.44it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.41it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.52it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.70it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.66it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.67it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.67it/s][A[INFO|trainer.py:570] 2024-04-21 17:00:57,611 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:00:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:00:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:00:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:00:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:00:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:00:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3694171254720073, 'eval_loss': 1.0949476, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [375, 451, 569, 570, 542, 524, 438, 357, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75382852, 'remaining_params': 9634748, 'pruned_model_sparsity': 0.8866734887834989, 'expected_sparsity': 0.88288, 'target_sparsity': 0.95, 'step': 21650}


Iteration:  78%|███████▊  | 210/268 [00:37<00:41,  1.39it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:30,  1.84it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:23,  2.38it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:18,  3.04it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:14,  3.71it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:12,  4.33it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:10,  5.03it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:09,  5.55it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:08,  6.04it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:07,  6.39it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:07,  6.56it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  6.94it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.13it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.31it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  6.87it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.04it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.34it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.45it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.36it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.30it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.45it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.52it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.43it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.53it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.50it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.63it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.65it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.70it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.71it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.82it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.42it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.51it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.55it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.42it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.34it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.42it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.60it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.62it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.65it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.71it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.72it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.68it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.35it/s][A[INFO|trainer.py:570] 2024-04-21 17:01:06,212 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:01:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:01:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:01:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:01:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.92it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 17:01:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:01:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3714926317628813, 'eval_loss': 1.1308692, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [375, 450, 569, 568, 541, 523, 438, 357, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75385916, 'remaining_params': 9631684, 'pruned_model_sparsity': 0.886709528380006, 'expected_sparsity': 0.88317, 'target_sparsity': 0.95, 'step': 21700}


Iteration:  97%|█████████▋| 260/268 [00:46<00:05,  1.39it/s][A04/21/2024 17:01:08 - INFO - trainer.trainer_mod - v4 Global step: 21700, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [00:46<00:03,  1.83it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:02,  2.38it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:01,  3.02it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:01,  3.67it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  4.40it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  5.10it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  5.61it/s][A04/21/2024 17:01:09 - INFO - trainer.trainer_mod - Epoch 80 finished. Took 47.14 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  81%|████████  | 81/100 [1:02:22<14:36, 46.12s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.57it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.72it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.74it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.88it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.53it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.57it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.42it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.52it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.50it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.58it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.62it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.54it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.59it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.53it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.59it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.66it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.67it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.69it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.71it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.63it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.66it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.54it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.32it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.43it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.52it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.39it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.48it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.50it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:32,  7.40it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.48it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.48it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.43it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:32,  7.07it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:31,  7.23it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.41it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.48it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.43it/s][A[INFO|trainer.py:570] 2024-04-21 17:01:14,772 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:01:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:01:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:01:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:01:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:01:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:01:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35905571282366544, 'eval_loss': 1.02957, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [374, 449, 568, 568, 541, 523, 437, 357, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75390512, 'remaining_params': 9627088, 'pruned_model_sparsity': 0.8867635877747666, 'expected_sparsity': 0.88329, 'target_sparsity': 0.95, 'step': 21750}


Iteration:  16%|█▌        | 42/268 [00:07<02:43,  1.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<02:02,  1.84it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:33,  2.38it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<01:13,  3.03it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:00,  3.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:50,  4.34it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:43,  5.05it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:38,  5.62it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:35,  6.09it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:33,  6.43it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:31,  6.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:30,  7.02it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.24it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.31it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.60it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.45it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.43it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.38it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.43it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.47it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.51it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.33it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.34it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.35it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.51it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.55it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.57it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.60it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.64it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.69it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.71it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:24,  7.81it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:24,  7.74it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.42it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.42it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.32it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.53it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.55it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:23,  7.75it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:23,  7.86it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.68it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.70it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.72it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.72it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.47it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.55it/s][A
Iteration:  34%|███▍      | 91/268 [00:14<00:23,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 17:01:23,323 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:01:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:01:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:01:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:01:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.28it/s]04/21/2024 17:01:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:01:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36663351111692266, 'eval_loss': 1.1030474, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [374, 447, 568, 567, 541, 522, 437, 356, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 3, 2, 2, 1], 'pruned_params': 75393576, 'remaining_params': 9624024, 'pruned_model_sparsity': 0.8867996273712737, 'expected_sparsity': 0.88347, 'target_sparsity': 0.95, 'step': 21800}


Iteration:  34%|███▍      | 92/268 [00:16<02:06,  1.39it/s][A04/21/2024 17:01:25 - INFO - trainer.trainer_mod - v4 Global step: 21800, Alignment: tensor([ 0,  7,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:16<01:34,  1.85it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<01:12,  2.39it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:57,  3.01it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:46,  3.66it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:39,  4.36it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:34,  4.96it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:30,  5.53it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:27,  6.04it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:25,  6.45it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:24,  6.80it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:24,  6.71it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:23,  6.88it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:22,  7.12it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:23,  6.79it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:22,  7.05it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:22,  7.26it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.38it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.47it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.52it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.55it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.62it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.67it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.72it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.84it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.76it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.76it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:18,  7.86it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.77it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.57it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.59it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.57it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.40it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.33it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.32it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.42it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.49it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.55it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.61it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.65it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.66it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.58it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.60it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.59it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:17,  7.42it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:17,  7.38it/s][A[INFO|trainer.py:570] 2024-04-21 17:01:31,906 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:01:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:01:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:01:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:01:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:01:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:01:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37197230635330797, 'eval_loss': 1.099205, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [374, 446, 567, 566, 540, 521, 437, 356, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75594268, 'remaining_params': 9423332, 'pruned_model_sparsity': 0.8891602209424873, 'expected_sparsity': 0.88354, 'target_sparsity': 0.95, 'step': 21850}


Iteration:  53%|█████▎    | 142/268 [00:24<01:30,  1.39it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<01:07,  1.84it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:52,  2.38it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:40,  3.02it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:33,  3.68it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:28,  4.31it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:24,  4.96it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:21,  5.62it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:19,  6.10it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:18,  6.37it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:17,  6.72it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  7.01it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.22it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.37it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.48it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.52it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.49it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.66it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.65it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.55it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.62it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.68it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.55it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.51it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.39it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.28it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.28it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.36it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.57it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.74it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.75it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.62it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.62it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.65it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.53it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.59it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.63it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.55it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.53it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.51it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.58it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.56it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.55it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.60it/s][A
Iteration:  71%|███████   | 190/268 [00:31<00:10,  7.61it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.65it/s][A[INFO|trainer.py:570] 2024-04-21 17:01:40,451 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:01:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:01:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:01:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:01:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 17:01:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:01:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.353043514617452, 'eval_loss': 1.1419228, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [374, 445, 567, 565, 539, 520, 436, 356, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75598864, 'remaining_params': 9418736, 'pruned_model_sparsity': 0.8892142803372478, 'expected_sparsity': 0.88364, 'target_sparsity': 0.95, 'step': 21900}


Iteration:  72%|███████▏  | 192/268 [00:33<00:54,  1.39it/s][A04/21/2024 17:01:42 - INFO - trainer.trainer_mod - v4 Global step: 21900, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:33<00:40,  1.84it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:30,  2.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:24,  2.99it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:19,  3.66it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:16,  4.32it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:14,  4.93it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:12,  5.50it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:11,  5.88it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:10,  6.31it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:09,  6.82it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:09,  7.05it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.13it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.17it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.14it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.12it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.29it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.42it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.46it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.50it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.38it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.41it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.46it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.36it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.37it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.26it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.41it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.35it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.30it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.52it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.45it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.38it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.50it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.55it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.59it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.60it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.49it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.59it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.61it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.65it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.62it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.59it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.64it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.66it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.71it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.71it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.74it/s][A[INFO|trainer.py:570] 2024-04-21 17:01:49,052 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:01:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:01:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:01:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:01:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 17:01:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:01:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3451071124679131, 'eval_loss': 1.0994151, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [374, 444, 566, 563, 539, 520, 436, 356, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75600396, 'remaining_params': 9417204, 'pruned_model_sparsity': 0.8892323001355014, 'expected_sparsity': 0.8837, 'target_sparsity': 0.95, 'step': 21950}


Iteration:  90%|█████████ | 242/268 [00:41<00:18,  1.40it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:13,  1.85it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:10,  2.39it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:07,  3.02it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:05,  3.70it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:04,  4.31it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:04,  4.96it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:03,  5.55it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:03,  6.00it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  6.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  6.86it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  6.98it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.14it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.20it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.32it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.55it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.63it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.74it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.61it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.50it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.67it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.58it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.59it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.63it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.56it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.50it/s][A04/21/2024 17:01:54 - INFO - trainer.trainer_mod - Epoch 81 finished. Took 45.23 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  82%|████████▏ | 82/100 [1:03:07<13:45, 45.85s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.98it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.35it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.42it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.53it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.56it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.63it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:36,  7.22it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.32it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.54it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.61it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.49it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.42it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.38it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.30it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:33,  7.44it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.48it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.58it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.52it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.58it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.62it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 17:01:57,598 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:01:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:01:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:01:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:01:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.14it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:01:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:01:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35863795532263415, 'eval_loss': 1.05966, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [373, 443, 566, 563, 538, 519, 436, 356, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75604992, 'remaining_params': 9412608, 'pruned_model_sparsity': 0.8892863595302619, 'expected_sparsity': 0.88373, 'target_sparsity': 0.95, 'step': 22000}


Iteration:   9%|▉         | 24/268 [00:05<02:55,  1.39it/s][A04/21/2024 17:01:59 - INFO - trainer.trainer_mod - v4 Global step: 22000, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:05<02:11,  1.85it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:40,  2.40it/s][A
Iteration:  10%|█         | 27/268 [00:05<01:19,  3.02it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:06,  3.63it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:56,  4.22it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:48,  4.90it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:43,  5.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:39,  6.04it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:35,  6.55it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:34,  6.83it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:33,  6.99it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.20it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.24it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.39it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.44it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.34it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.28it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.36it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.65it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.79it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.78it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.64it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.80it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:27,  7.79it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.53it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.59it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.62it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.47it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.55it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.45it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.44it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.43it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.35it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.42it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.49it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.48it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.55it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.50it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.56it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.64it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.67it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.57it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.61it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 17:02:06,185 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:02:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:02:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:02:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:02:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:01, 16.91it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 17:02:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:02:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3842755168745198, 'eval_loss': 1.0128489, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [373, 442, 566, 562, 538, 519, 436, 355, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75606524, 'remaining_params': 9411076, 'pruned_model_sparsity': 0.8893043793285155, 'expected_sparsity': 0.88377, 'target_sparsity': 0.95, 'step': 22050}


Iteration:  28%|██▊       | 74/268 [00:13<02:20,  1.38it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<01:45,  1.83it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<01:21,  2.36it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<01:04,  2.98it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:51,  3.65it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:43,  4.37it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:37,  4.98it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:33,  5.57it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:30,  6.07it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:28,  6.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:27,  6.80it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:26,  7.04it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:25,  7.22it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.26it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.34it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.45it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.54it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:22,  7.72it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:22,  7.85it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.77it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.74it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.67it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.69it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.56it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.62it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.67it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.64it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.57it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.75it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.75it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.71it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.62it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.51it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.53it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.34it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.46it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.49it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.56it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:19,  7.79it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.61it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.62it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.66it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.54it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.51it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.55it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.72it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.62it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 17:02:14,712 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:02:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:02:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:02:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:02:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:02:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:02:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35169991580782367, 'eval_loss': 1.0830593, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [373, 440, 565, 561, 538, 519, 435, 355, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75609588, 'remaining_params': 9408012, 'pruned_model_sparsity': 0.8893404189250226, 'expected_sparsity': 0.88382, 'target_sparsity': 0.95, 'step': 22100}


Iteration:  46%|████▋     | 124/268 [00:22<01:43,  1.39it/s][A04/21/2024 17:02:16 - INFO - trainer.trainer_mod - v4 Global step: 22100, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:22<01:17,  1.84it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:59,  2.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:46,  3.00it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:38,  3.67it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:32,  4.27it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:28,  4.93it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:24,  5.58it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:22,  6.06it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:21,  6.35it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:20,  6.68it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:20,  6.44it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.69it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:19,  6.89it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:18,  7.08it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:18,  7.09it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.38it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.45it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.35it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.27it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:17,  7.22it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.32it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.45it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.57it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.59it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.61it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.64it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.62it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.26it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.44it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.53it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.59it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.74it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.73it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:13,  7.86it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.79it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.65it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.68it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.70it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.67it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.66it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.67it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.62it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.65it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.81it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.76it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.76it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 17:02:23,298 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:02:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:02:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:02:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:02:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.11it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:02:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:02:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3629573913728164, 'eval_loss': 1.0962168, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [373, 439, 565, 560, 537, 518, 435, 355, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75612652, 'remaining_params': 9404948, 'pruned_model_sparsity': 0.8893764585215297, 'expected_sparsity': 0.88389, 'target_sparsity': 0.95, 'step': 22150}


Iteration:  65%|██████▍   | 174/268 [00:30<01:07,  1.40it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:50,  1.84it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:38,  2.37it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:30,  2.98it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:24,  3.65it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:20,  4.33it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:17,  4.99it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:15,  5.59it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:13,  6.15it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.63it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:12,  6.73it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  6.98it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.20it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.37it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.24it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.35it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.57it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.80it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.67it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.67it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.71it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.69it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.60it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.51it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.70it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.54it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.55it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.41it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.61it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.63it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.56it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.80it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.50it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.43it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.51it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.45it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.55it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.59it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.60it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.48it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.44it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.55it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.58it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.58it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:06,  7.39it/s][A[INFO|trainer.py:570] 2024-04-21 17:02:31,865 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:02:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:02:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:02:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:02:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:02:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:02:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35823474778962877, 'eval_loss': 1.1122503, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [372, 438, 564, 559, 536, 518, 435, 355, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75617248, 'remaining_params': 9400352, 'pruned_model_sparsity': 0.8894305179162902, 'expected_sparsity': 0.88392, 'target_sparsity': 0.95, 'step': 22200}


Iteration:  84%|████████▎ | 224/268 [00:39<00:31,  1.39it/s][A04/21/2024 17:02:33 - INFO - trainer.trainer_mod - v4 Global step: 22200, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [00:39<00:23,  1.84it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:17,  2.38it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:13,  3.01it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:10,  3.66it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:08,  4.38it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:07,  4.98it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:06,  5.59it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.08it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:05,  6.39it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:05,  6.54it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  6.82it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.07it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.22it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.27it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.30it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.43it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.51it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.48it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.56it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.53it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.50it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.54it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.53it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.42it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.18it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.29it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.42it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.51it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.59it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.73it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.63it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.65it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.63it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.69it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.82it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.69it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.49it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.43it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.42it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.63it/s][A04/21/2024 17:02:39 - INFO - trainer.trainer_mod - Epoch 82 finished. Took 45.21 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  83%|████████▎ | 83/100 [1:03:52<12:56, 45.66s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.78it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.74it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.38it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.43it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 17:02:40,412 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:02:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:02:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:02:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:02:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.12it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:02:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:02:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.353356742759104, 'eval_loss': 1.149266, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [373, 437, 565, 559, 537, 518, 435, 355, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75612652, 'remaining_params': 9404948, 'pruned_model_sparsity': 0.8893764585215297, 'expected_sparsity': 0.88388, 'target_sparsity': 0.95, 'step': 22250}


Iteration:   2%|▏         | 6/268 [00:02<03:29,  1.25it/s][A
Iteration:   3%|▎         | 7/268 [00:02<02:32,  1.71it/s][A
Iteration:   3%|▎         | 8/268 [00:03<01:54,  2.28it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:28,  2.92it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:11,  3.62it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:00,  4.28it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:52,  4.84it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:47,  5.39it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:42,  5.95it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:39,  6.36it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:36,  6.85it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:36,  6.96it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.17it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:34,  7.21it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:33,  7.34it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.36it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.44it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:33,  7.35it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.55it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:31,  7.60it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:31,  7.64it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.50it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.57it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:31,  7.61it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.35it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.45it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.47it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.49it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.31it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.42it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.43it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.54it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.63it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.69it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.70it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:28,  7.66it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.63it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.54it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.57it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.59it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.64it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:30,  7.01it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:30,  7.09it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.27it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:29,  7.29it/s][A[INFO|trainer.py:570] 2024-04-21 17:02:49,050 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:02:49 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:02:49 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:02:49 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:02:49 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:02:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:02:51 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.346198242698375, 'eval_loss': 1.1569656, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [373, 437, 564, 558, 536, 517, 435, 355, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75617248, 'remaining_params': 9400352, 'pruned_model_sparsity': 0.8894305179162902, 'expected_sparsity': 0.88394, 'target_sparsity': 0.95, 'step': 22300}


Iteration:  21%|██        | 56/268 [00:11<02:33,  1.38it/s][A04/21/2024 17:02:51 - INFO - trainer.trainer_mod - v4 Global step: 22300, Alignment: tensor([ 0,  7,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:11<01:55,  1.83it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<01:28,  2.36it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:10,  2.96it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:57,  3.63it/s][A
Iteration:  23%|██▎       | 61/268 [00:12<00:48,  4.28it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:41,  4.94it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:37,  5.54it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:33,  6.06it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:31,  6.49it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:29,  6.78it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:29,  6.86it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:28,  7.11it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.29it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:26,  7.42it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.54it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:25,  7.79it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.67it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.69it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.44it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:25,  7.48it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.45it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.55it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.57it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.49it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.42it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.47it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.54it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.73it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.58it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.52it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.48it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:23,  7.44it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.53it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.71it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.73it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.71it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:21,  7.83it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.76it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:21,  7.74it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.52it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.59it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.78it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.74it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.73it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.61it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 17:02:57,588 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:02:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:02:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:02:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:02:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:02:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:02:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3306219515641091, 'eval_loss': 1.168755, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [373, 437, 564, 557, 536, 516, 435, 354, 230, 182, 196, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75620312, 'remaining_params': 9397288, 'pruned_model_sparsity': 0.8894665575127974, 'expected_sparsity': 0.88398, 'target_sparsity': 0.95, 'step': 22350}


Iteration:  40%|███▉      | 106/268 [00:19<01:56,  1.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<01:27,  1.84it/s][A
Iteration:  40%|████      | 108/268 [00:20<01:07,  2.38it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:53,  3.00it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:42,  3.68it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:36,  4.35it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:31,  4.94it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:28,  5.53it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:25,  5.97it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:24,  6.33it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:22,  6.70it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  6.97it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.18it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.30it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.33it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.29it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.40it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.38it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:18,  7.48it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.55it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.62it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.65it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.64it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:17,  7.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.67it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.59it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.43it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.48it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.33it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.45it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.50it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.56it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.76it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.61it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.66it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.54it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.60it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.61it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.64it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.67it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.56it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.45it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.38it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.38it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.47it/s][A[INFO|trainer.py:570] 2024-04-21 17:03:06,174 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:03:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:03:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:03:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:03:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.14it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.84it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.20it/s]04/21/2024 17:03:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:03:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36663351111692266, 'eval_loss': 1.1145991, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [372, 436, 564, 556, 535, 516, 434, 354, 230, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75624908, 'remaining_params': 9392692, 'pruned_model_sparsity': 0.889520616907558, 'expected_sparsity': 0.88399, 'target_sparsity': 0.95, 'step': 22400}


Iteration:  58%|█████▊    | 156/268 [00:28<01:20,  1.38it/s][A04/21/2024 17:03:08 - INFO - trainer.trainer_mod - v4 Global step: 22400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:28<01:00,  1.83it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:46,  2.37it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:36,  2.99it/s][A
Iteration:  60%|█████▉    | 160/268 [00:29<00:29,  3.63it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:25,  4.28it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:21,  4.94it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:18,  5.54it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:17,  6.05it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:15,  6.56it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:15,  6.77it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.04it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.23it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.36it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.47it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:12,  7.51it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.60it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.39it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.49it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:12,  7.53it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.49it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.52it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.66it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.67it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.54it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.58it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.71it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:10,  7.74it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.50it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.51it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.60it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.65it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:09,  7.82it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.77it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.78it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.86it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.71it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.59it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.60it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.55it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.59it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.46it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.44it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 17:03:14,746 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:03:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:03:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:03:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:03:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:03:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:03:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3574737465102659, 'eval_loss': 1.1217794, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [372, 434, 563, 555, 535, 515, 434, 354, 229, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75629504, 'remaining_params': 9388096, 'pruned_model_sparsity': 0.8895746763023186, 'expected_sparsity': 0.88402, 'target_sparsity': 0.95, 'step': 22450}


Iteration:  77%|███████▋  | 206/268 [00:37<00:45,  1.37it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:33,  1.82it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:25,  2.36it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:19,  2.98it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:15,  3.64it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:13,  4.32it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:11,  4.98it/s][A
Iteration:  79%|███████▉  | 213/268 [00:38<00:09,  5.56it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:09,  5.96it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:08,  6.30it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  6.74it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.00it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.16it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.31it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.56it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:05,  7.71it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:05,  7.72it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.72it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.57it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.50it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.43it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.64it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.54it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.58it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.58it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.24it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.48it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.59it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.59it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.74it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.60it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.62it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.84it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.55it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.42it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.27it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.44it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.54it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.70it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.74it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.57it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.62it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.45it/s][A[INFO|trainer.py:570] 2024-04-21 17:03:23,308 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:03:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:03:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:03:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:03:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:03:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:03:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3758293113455866, 'eval_loss': 1.0441608, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [372, 433, 563, 554, 535, 515, 434, 354, 229, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75629504, 'remaining_params': 9388096, 'pruned_model_sparsity': 0.8895746763023186, 'expected_sparsity': 0.88409, 'target_sparsity': 0.95, 'step': 22500}


Iteration:  96%|█████████▌| 256/268 [00:45<00:08,  1.39it/s][A04/21/2024 17:03:25 - INFO - trainer.trainer_mod - v4 Global step: 22500, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [00:45<00:05,  1.84it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:04,  2.39it/s][A
Iteration:  97%|█████████▋| 259/268 [00:46<00:02,  3.05it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:02,  3.72it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  4.39it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:01,  5.03it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  5.61it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  6.11it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.49it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  6.82it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.06it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.69it/s][A04/21/2024 17:03:26 - INFO - trainer.trainer_mod - Epoch 83 finished. Took 47.18 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  84%|████████▍ | 84/100 [1:04:40<12:17, 46.11s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.66it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.37it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.75it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.68it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.59it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.66it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.56it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.59it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.39it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.38it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:34,  7.38it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.46it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.45it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.39it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.45it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.51it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.42it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.48it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.56it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.49it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.56it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.62it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.35it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.41it/s][A
Iteration:  11%|█         | 30/268 [00:04<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.46it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.50it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.49it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:31,  7.48it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 17:03:31,847 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:03:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:03:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:03:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:03:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:03:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:03:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3767520669807055, 'eval_loss': 0.99946207, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [372, 432, 562, 554, 534, 514, 433, 354, 229, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75635632, 'remaining_params': 9381968, 'pruned_model_sparsity': 0.8896467554953328, 'expected_sparsity': 0.88416, 'target_sparsity': 0.95, 'step': 22550}


Iteration:  14%|█▍        | 38/268 [00:07<02:45,  1.39it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<02:04,  1.83it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:36,  2.36it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<01:16,  2.97it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:01,  3.67it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:51,  4.36it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:44,  5.02it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:39,  5.60it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:37,  5.99it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:34,  6.43it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:32,  6.78it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:31,  6.94it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:30,  7.13it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.30it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.44it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.52it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.58it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.63it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.78it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.77it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.75it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.62it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.57it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.59it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.74it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.62it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.67it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.44it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.55it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:25,  7.71it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.85it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.70it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.70it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.65it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:24,  7.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:24,  7.81it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:24,  7.78it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:25,  7.57it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.57it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.58it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.58it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.61it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.62it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.66it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.46it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.49it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:24,  7.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:24,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 17:03:40,383 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:03:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:03:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:03:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:03:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.28it/s]04/21/2024 17:03:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:03:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.373028264011591, 'eval_loss': 1.0350095, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [371, 431, 562, 552, 534, 514, 433, 353, 229, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75638696, 'remaining_params': 9378904, 'pruned_model_sparsity': 0.8896827950918398, 'expected_sparsity': 0.88418, 'target_sparsity': 0.95, 'step': 22600}


Iteration:  33%|███▎      | 88/268 [00:15<02:09,  1.39it/s][A04/21/2024 17:03:42 - INFO - trainer.trainer_mod - v4 Global step: 22600, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:15<01:37,  1.85it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<01:14,  2.39it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:58,  3.02it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:47,  3.69it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:39,  4.44it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:35,  4.89it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:31,  5.49it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:29,  5.89it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:27,  6.25it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:25,  6.55it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:24,  6.84it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:24,  6.95it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.14it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:23,  7.18it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.32it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.44it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.50it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.50it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.54it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.45it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.56it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.72it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.85it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.77it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.68it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.62it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:19,  7.85it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.92it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.85it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:18,  7.92it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:18,  7.79it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.71it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.71it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.54it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.34it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.46it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.50it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:19,  7.35it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.46it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.49it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.57it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.58it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.60it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.54it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.56it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.55it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.56it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 17:03:48,934 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:03:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:03:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:03:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:03:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:03:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:03:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37037472291796913, 'eval_loss': 1.0747818, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [371, 430, 562, 551, 533, 513, 433, 353, 229, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75641760, 'remaining_params': 9375840, 'pruned_model_sparsity': 0.8897188346883469, 'expected_sparsity': 0.88427, 'target_sparsity': 0.95, 'step': 22650}


Iteration:  51%|█████▏    | 138/268 [00:24<01:33,  1.39it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<01:10,  1.83it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:53,  2.38it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:42,  3.00it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:34,  3.69it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:28,  4.40it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:24,  5.09it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:21,  5.66it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:19,  6.15it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:18,  6.53it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:18,  6.34it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:17,  6.79it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:16,  7.22it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.35it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.43it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:16,  7.11it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.24it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.25it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.36it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.46it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.51it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.68it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.51it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.54it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.60it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.41it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.66it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.64it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.59it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.58it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.74it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.69it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.71it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.53it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.48it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.69it/s][A
Iteration:  65%|██████▌   | 175/268 [00:28<00:12,  7.68it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:11,  7.69it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.56it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.47it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.70it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.83it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.76it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.76it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.71it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.67it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.50it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.60it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 17:03:57,472 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:03:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:03:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:03:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:03:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:03:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:03:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38235616737989553, 'eval_loss': 1.1002384, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [371, 429, 561, 550, 533, 512, 432, 353, 229, 182, 195, 145], 'head_nums': [3, 5, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75646356, 'remaining_params': 9371244, 'pruned_model_sparsity': 0.8897728940831074, 'expected_sparsity': 0.88433, 'target_sparsity': 0.95, 'step': 22700}


Iteration:  70%|███████   | 188/268 [00:32<00:57,  1.39it/s][A04/21/2024 17:03:59 - INFO - trainer.trainer_mod - v4 Global step: 22700, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:32<00:43,  1.84it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:32,  2.39it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:25,  2.99it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:20,  3.63it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:17,  4.29it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:14,  4.99it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:13,  5.48it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:12,  5.99it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:11,  6.30it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:10,  6.63it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:10,  6.75it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.11it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.52it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.50it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.40it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.53it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.56it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.61it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.56it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.63it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.76it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.54it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.56it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.58it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.60it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.62it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.51it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.55it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.49it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.55it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.72it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.60it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.64it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.68it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.59it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.61it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.53it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.53it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.58it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.74it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.72it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.44it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.51it/s][A
Iteration:  88%|████████▊ | 236/268 [00:38<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.59it/s][A[INFO|trainer.py:570] 2024-04-21 17:04:06,038 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:04:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:04:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:04:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:04:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.20it/s]04/21/2024 17:04:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:04:08 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36735497511318055, 'eval_loss': 1.1160825, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [371, 428, 561, 548, 532, 512, 432, 353, 229, 182, 195, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75647888, 'remaining_params': 9369712, 'pruned_model_sparsity': 0.889790913881361, 'expected_sparsity': 0.88436, 'target_sparsity': 0.95, 'step': 22750}


Iteration:  89%|████████▉ | 238/268 [00:41<00:21,  1.38it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:15,  1.83it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:11,  2.38it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:08,  3.00it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:07,  3.67it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:05,  4.36it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:04,  5.01it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:04,  5.60it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  6.10it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:03,  6.51it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  6.81it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.05it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.15it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.49it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.58it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.64it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.76it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.76it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.72it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.54it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.45it/s][A
Iteration:  97%|█████████▋| 259/268 [00:43<00:01,  7.44it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.50it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.51it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.53it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.56it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.50it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.52it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.35it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.42it/s][A04/21/2024 17:04:11 - INFO - trainer.trainer_mod - Epoch 84 finished. Took 45.12 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.94it/s]
Epoch:  85%|████████▌ | 85/100 [1:05:25<11:27, 45.82s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.63it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.71it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.90it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.81it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.76it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.75it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.90it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.85it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.78it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.71it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.61it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.66it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.63it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:34,  7.39it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.45it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.28it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.60it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 17:04:14,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:04:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:04:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:04:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:04:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:04:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:04:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37375616538587153, 'eval_loss': 1.070054, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [370, 427, 560, 547, 532, 512, 432, 353, 229, 182, 195, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75650952, 'remaining_params': 9366648, 'pruned_model_sparsity': 0.8898269534778681, 'expected_sparsity': 0.8844, 'target_sparsity': 0.95, 'step': 22800}


Iteration:   7%|▋         | 20/268 [00:04<02:57,  1.39it/s][A04/21/2024 17:04:16 - INFO - trainer.trainer_mod - v4 Global step: 22800, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:04<02:14,  1.84it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:43,  2.37it/s][A
Iteration:   9%|▊         | 23/268 [00:04<01:22,  2.98it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:06,  3.65it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:56,  4.30it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:48,  4.94it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:44,  5.48it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:40,  6.00it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:37,  6.34it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:35,  6.72it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:34,  6.88it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:33,  7.02it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.39it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.37it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.35it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.30it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:32,  7.20it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:31,  7.35it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.27it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.28it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.29it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.37it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.38it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.70it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.57it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.52it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.45it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.66it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.76it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:27,  7.78it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:27,  7.76it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.77it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.71it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:27,  7.70it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.71it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.72it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.76it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.70it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.59it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.60it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.40it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.34it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.33it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.29it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.45it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.59it/s][A[INFO|trainer.py:570] 2024-04-21 17:04:23,121 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:04:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:04:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:04:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:04:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:04:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:04:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36813718963746117, 'eval_loss': 1.0373375, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [370, 426, 560, 547, 532, 512, 432, 353, 229, 182, 195, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75663180, 'remaining_params': 9354420, 'pruned_model_sparsity': 0.8899707825203252, 'expected_sparsity': 0.88442, 'target_sparsity': 0.95, 'step': 22850}


Iteration:  26%|██▌       | 70/268 [00:13<02:22,  1.39it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:47,  1.84it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<01:22,  2.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<01:05,  3.00it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:53,  3.64it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:44,  4.31it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:38,  4.92it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:34,  5.52it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:31,  6.00it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:30,  6.22it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:28,  6.59it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:27,  6.74it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:26,  6.96it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:25,  7.20it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.28it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.45it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:24,  7.49it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.17it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.31it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.56it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.59it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.60it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.50it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.54it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.59it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.44it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.57it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.59it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.43it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.35it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:23,  6.95it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:22,  7.26it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.32it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.44it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.65it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.65it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.43it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.52it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.49it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.44it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.52it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.58it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.49it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 17:04:31,782 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:04:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:04:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:04:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:04:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:04:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:04:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3439971465943615, 'eval_loss': 1.1479876, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [371, 426, 560, 546, 531, 511, 432, 352, 228, 182, 195, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75667770, 'remaining_params': 9349830, 'pruned_model_sparsity': 0.8900247713414634, 'expected_sparsity': 0.88445, 'target_sparsity': 0.95, 'step': 22900}


Iteration:  45%|████▍     | 120/268 [00:21<01:46,  1.39it/s][A04/21/2024 17:04:33 - INFO - trainer.trainer_mod - v4 Global step: 22900, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:21<01:19,  1.84it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<01:01,  2.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:48,  2.99it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:39,  3.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:33,  4.28it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:28,  4.94it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:25,  5.53it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:23,  5.98it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:21,  6.43it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:20,  6.65it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:19,  7.04it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.37it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.45it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.51it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.58it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.60it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:16,  7.74it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.64it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.60it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.60it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.59it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.62it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.53it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.71it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.61it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.60it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.54it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.56it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.62it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.79it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.77it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.64it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.63it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.64it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.56it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.61it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.45it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.52it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.57it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.40it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.38it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.44it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.50it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.41it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.36it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.37it/s][A[INFO|trainer.py:570] 2024-04-21 17:04:40,341 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:04:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:04:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:04:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:04:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:04:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:04:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3694171254720073, 'eval_loss': 1.0963033, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [370, 425, 559, 545, 531, 511, 431, 352, 228, 182, 195, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75672360, 'remaining_params': 9345240, 'pruned_model_sparsity': 0.8900787601626017, 'expected_sparsity': 0.88452, 'target_sparsity': 0.95, 'step': 22950}


Iteration:  63%|██████▎   | 170/268 [00:30<01:10,  1.39it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:52,  1.84it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:40,  2.38it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:31,  3.00it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:25,  3.62it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:21,  4.34it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:18,  4.89it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:16,  5.50it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:15,  5.93it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:13,  6.37it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:13,  6.70it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.08it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.20it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.47it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.46it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.52it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.56it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.51it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.56it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.57it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.62it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.74it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.75it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.70it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.71it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.71it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.75it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:08,  7.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.69it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.66it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.50it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.59it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.65it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.70it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.69it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.67it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.87it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.82it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.74it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.71it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.61it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.44it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.52it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.42it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.46it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.46it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 17:04:48,873 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:04:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:04:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:04:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:04:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.28it/s]04/21/2024 17:04:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:04:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3439971465943615, 'eval_loss': 1.1410336, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [370, 423, 559, 544, 530, 510, 431, 352, 228, 182, 195, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75675420, 'remaining_params': 9342180, 'pruned_model_sparsity': 0.890114752710027, 'expected_sparsity': 0.88457, 'target_sparsity': 0.95, 'step': 23000}


Iteration:  82%|████████▏ | 220/268 [00:38<00:34,  1.38it/s][A04/21/2024 17:04:50 - INFO - trainer.trainer_mod - v4 Global step: 23000, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [00:39<00:25,  1.83it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:19,  2.37it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:15,  2.97it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:12,  3.61it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:10,  4.29it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:08,  4.90it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:07,  5.42it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:06,  5.92it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:06,  6.30it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  6.65it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.72it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.87it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.10it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.24it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.40it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.61it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.41it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.29it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.44it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.54it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.71it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.65it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.24it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.48it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.58it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.66it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.48it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.54it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.58it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.53it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.62it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.62it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.53it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.57it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.62it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.77it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.73it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.62it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.55it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.62it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.61it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.62it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.63it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.47it/s][A
Iteration:  99%|█████████▉| 266/268 [00:45<00:00,  7.50it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.58it/s][A04/21/2024 17:04:57 - INFO - trainer.trainer_mod - Epoch 85 finished. Took 45.27 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.92it/s]
Epoch:  86%|████████▌ | 86/100 [1:06:10<10:39, 45.65s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:38,  6.96it/s][A[INFO|trainer.py:570] 2024-04-21 17:04:57,454 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:04:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:04:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:04:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:04:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:04:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:04:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36511995503147754, 'eval_loss': 1.1036912, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [370, 422, 559, 543, 530, 510, 431, 352, 228, 182, 195, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75675420, 'remaining_params': 9342180, 'pruned_model_sparsity': 0.890114752710027, 'expected_sparsity': 0.8846, 'target_sparsity': 0.95, 'step': 23050}


Iteration:   1%|          | 2/268 [00:02<05:43,  1.29s/it][A
Iteration:   1%|          | 3/268 [00:02<03:21,  1.31it/s][A
Iteration:   1%|▏         | 4/268 [00:02<02:15,  1.95it/s][A
Iteration:   2%|▏         | 5/268 [00:02<01:37,  2.70it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:14,  3.49it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:01,  4.26it/s][A
Iteration:   3%|▎         | 8/268 [00:02<00:52,  4.98it/s][A
Iteration:   3%|▎         | 9/268 [00:03<00:47,  5.50it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:42,  6.06it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:40,  6.41it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:37,  6.76it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:36,  6.91it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:36,  6.98it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:35,  7.20it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:34,  7.34it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:34,  7.36it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:33,  7.45it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:33,  7.43it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:33,  7.50it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:32,  7.57it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:32,  7.60it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:32,  7.60it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:31,  7.63it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.55it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:31,  7.59it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:31,  7.76it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:30,  7.76it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:30,  7.75it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:30,  7.72it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:30,  7.84it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:30,  7.62it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:30,  7.65it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.64it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.69it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.66it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.65it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:29,  7.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.65it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.67it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.66it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.64it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.55it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.56it/s][A
Iteration:  17%|█▋        | 46/268 [00:07<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.12it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.43it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 17:05:05,982 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:05:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:05:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:05:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:05:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:05:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:05:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3553401042863062, 'eval_loss': 1.1544621, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 421, 559, 543, 529, 510, 431, 352, 228, 182, 194, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75678480, 'remaining_params': 9339120, 'pruned_model_sparsity': 0.8901507452574525, 'expected_sparsity': 0.88466, 'target_sparsity': 0.95, 'step': 23100}


Iteration:  19%|█▉        | 52/268 [00:10<02:35,  1.39it/s][A04/21/2024 17:05:07 - INFO - trainer.trainer_mod - v4 Global step: 23100, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:10<01:57,  1.84it/s][A
Iteration:  20%|██        | 54/268 [00:11<01:30,  2.38it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:10,  3.01it/s][A
Iteration:  21%|██        | 56/268 [00:11<00:57,  3.68it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<00:47,  4.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:41,  5.04it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:36,  5.68it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:33,  6.18it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:31,  6.56it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:30,  6.72it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:29,  7.00it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:28,  7.20it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:27,  7.51it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:26,  7.56it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:26,  7.60it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:26,  7.67it/s][A
Iteration:  26%|██▌       | 69/268 [00:12<00:25,  7.66it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:25,  7.65it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:25,  7.66it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:25,  7.65it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.54it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:25,  7.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.54it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.58it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.35it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.60it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.61it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:23,  7.76it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.52it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:23,  7.74it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.63it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.65it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.65it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.64it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.67it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.68it/s][A
Iteration:  34%|███▍      | 92/268 [00:15<00:22,  7.68it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.66it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.44it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.53it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.58it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.59it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.67it/s][A[INFO|trainer.py:570] 2024-04-21 17:05:14,487 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:05:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:05:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:05:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:05:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:05:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:05:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3696657312826483, 'eval_loss': 1.0561218, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 420, 558, 542, 529, 509, 430, 352, 228, 182, 194, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75683070, 'remaining_params': 9334530, 'pruned_model_sparsity': 0.8902047340785908, 'expected_sparsity': 0.88472, 'target_sparsity': 0.95, 'step': 23150}


Iteration:  38%|███▊      | 102/268 [00:19<01:59,  1.39it/s][A
Iteration:  38%|███▊      | 103/268 [00:19<01:30,  1.82it/s][A
Iteration:  39%|███▉      | 104/268 [00:19<01:09,  2.37it/s][A
Iteration:  39%|███▉      | 105/268 [00:19<00:54,  2.99it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:44,  3.65it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:37,  4.33it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:32,  4.99it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:28,  5.57it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:26,  6.00it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:24,  6.42it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:23,  6.74it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:21,  7.18it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:20,  7.35it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:20,  7.35it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:20,  7.47it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:20,  7.52it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:19,  7.59it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.45it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.39it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.33it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:19,  7.41it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.40it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.33it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:19,  7.27it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.31it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.44it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:18,  7.53it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.58it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.38it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.46it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.53it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.52it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.55it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:16,  7.73it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.63it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.66it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.69it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.82it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.77it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.61it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.59it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:16,  7.61it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.48it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.55it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.50it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.44it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 17:05:23,076 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:05:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:05:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:05:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:05:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:05:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:05:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37037472291796913, 'eval_loss': 1.043307, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 419, 558, 540, 528, 509, 430, 351, 228, 182, 194, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75686130, 'remaining_params': 9331470, 'pruned_model_sparsity': 0.8902407266260163, 'expected_sparsity': 0.88476, 'target_sparsity': 0.95, 'step': 23200}


Iteration:  57%|█████▋    | 152/268 [00:27<01:23,  1.39it/s][A04/21/2024 17:05:25 - INFO - trainer.trainer_mod - v4 Global step: 23200, Alignment: tensor([ 0,  3,  8, 10], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:27<01:02,  1.83it/s][A
Iteration:  57%|█████▋    | 154/268 [00:28<00:47,  2.38it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<00:37,  3.03it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:30,  3.71it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:25,  4.40it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:21,  5.05it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:19,  5.57it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:17,  6.06it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:16,  6.61it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:15,  6.90it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:14,  7.02it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:14,  7.16it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.30it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:13,  7.39it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:13,  7.47it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:13,  7.42it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.46it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.52it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:12,  7.58it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.57it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.58it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.63it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:11,  7.78it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.61it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:11,  7.59it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.65it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.70it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.60it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.53it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.49it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.45it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.55it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.70it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.84it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.81it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.69it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.57it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.49it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.46it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.56it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.69it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.09it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.49it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.60it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.62it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 17:05:31,616 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:05:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:05:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:05:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:05:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:05:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:05:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34988258589953775, 'eval_loss': 1.0691994, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 418, 557, 539, 528, 509, 430, 351, 227, 182, 194, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75689190, 'remaining_params': 9328410, 'pruned_model_sparsity': 0.8902767191734418, 'expected_sparsity': 0.8848, 'target_sparsity': 0.95, 'step': 23250}


Iteration:  75%|███████▌  | 202/268 [00:36<00:47,  1.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:36<00:35,  1.83it/s][A
Iteration:  76%|███████▌  | 204/268 [00:36<00:27,  2.33it/s][A
Iteration:  76%|███████▋  | 205/268 [00:36<00:21,  2.93it/s][A
Iteration:  77%|███████▋  | 206/268 [00:36<00:17,  3.59it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:14,  4.26it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:12,  4.90it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:10,  5.38it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:09,  5.91it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:08,  6.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:08,  6.79it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:07,  7.03it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:07,  7.23it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  7.27it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.42it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:06,  7.50it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.59it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.61it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.62it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.49it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.53it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.48it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.57it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.60it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.54it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.52it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.44it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.34it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.44it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.35it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.26it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.27it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.19it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.51it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.37it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.35it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.31it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.42it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.62it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.63it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.61it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.58it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.64it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.68it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 17:05:40,273 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:05:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:05:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:05:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:05:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:05:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:05:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3412145324546455, 'eval_loss': 1.1281092, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 418, 557, 538, 528, 508, 429, 351, 227, 182, 194, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75692250, 'remaining_params': 9325350, 'pruned_model_sparsity': 0.8903127117208672, 'expected_sparsity': 0.88478, 'target_sparsity': 0.95, 'step': 23300}


Iteration:  94%|█████████▍| 252/268 [00:45<00:11,  1.38it/s][A04/21/2024 17:05:42 - INFO - trainer.trainer_mod - v4 Global step: 23300, Alignment: tensor([ 0,  7,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [00:45<00:08,  1.83it/s][A
Iteration:  95%|█████████▍| 254/268 [00:45<00:05,  2.38it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:04,  3.00it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:03,  3.67it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:02,  4.35it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:02,  4.99it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:01,  5.58it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  6.15it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  6.41it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:00,  6.58it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.84it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  7.00it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  7.30it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.38it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.48it/s][A04/21/2024 17:05:44 - INFO - trainer.trainer_mod - Epoch 86 finished. Took 47.13 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  87%|████████▋ | 87/100 [1:06:57<09:59, 46.09s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.66it/s][A
Iteration:   1%|          | 2/268 [00:00<00:36,  7.28it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.46it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.52it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.59it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.66it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.65it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.71it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:33,  7.71it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.61it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.43it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.51it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.42it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.50it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.57it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.63it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.64it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:31,  7.83it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.20it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:34,  7.21it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.47it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.45it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.57it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.61it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.51it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.61it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.65it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.54it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:30,  7.70it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 17:05:48,798 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:05:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:05:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:05:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:05:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:05:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:05:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3447208135052164, 'eval_loss': 1.1080296, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 418, 557, 536, 528, 508, 429, 351, 227, 182, 194, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75692250, 'remaining_params': 9325350, 'pruned_model_sparsity': 0.8903127117208672, 'expected_sparsity': 0.88484, 'target_sparsity': 0.95, 'step': 23350}


Iteration:  13%|█▎        | 34/268 [00:06<02:48,  1.39it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<02:06,  1.84it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<01:37,  2.39it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<01:16,  3.01it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<01:02,  3.69it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:52,  4.36it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:45,  5.06it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:40,  5.64it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:36,  6.13it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:34,  6.44it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:33,  6.68it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:32,  6.89it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:31,  7.10it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.23it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.28it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.43it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.50it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.58it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.44it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.50it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.45it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.32it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.31it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.28it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.57it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.49it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.67it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.58it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.63it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.63it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.67it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.67it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.69it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.67it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.65it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:25,  7.64it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:25,  7.59it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.61it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.57it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.56it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.51it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.53it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.55it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.58it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.53it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.71it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.66it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.70it/s][A[INFO|trainer.py:570] 2024-04-21 17:05:57,352 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:05:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:05:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:05:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:05:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:05:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:05:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3594876045500933, 'eval_loss': 1.039127, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 417, 557, 535, 527, 507, 429, 351, 227, 182, 194, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75695310, 'remaining_params': 9322290, 'pruned_model_sparsity': 0.8903487042682927, 'expected_sparsity': 0.88489, 'target_sparsity': 0.95, 'step': 23400}


Iteration:  31%|███▏      | 84/268 [00:15<02:12,  1.39it/s][A04/21/2024 17:05:59 - INFO - trainer.trainer_mod - v4 Global step: 23400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:15<01:40,  1.83it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<01:16,  2.37it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:59,  3.02it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:48,  3.69it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:41,  4.34it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:35,  4.98it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:31,  5.57it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:28,  6.11it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:27,  6.31it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:26,  6.51it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:24,  6.97it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.17it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.34it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.31it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:23,  7.26it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.28it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.28it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.42it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.61it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.63it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.61it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.54it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.58it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:21,  7.43it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.55it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.57it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.55it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.51it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.57it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.60it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.61it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.42it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.49it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.68it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.65it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.54it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.68it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.68it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.66it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.50it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.67it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.62it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.61it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 17:06:05,924 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:06:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:06:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:06:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:06:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.87it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.94it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.98it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.17it/s]04/21/2024 17:06:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:06:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3490196502696348, 'eval_loss': 1.069348, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 416, 556, 535, 527, 507, 429, 351, 227, 182, 194, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75696840, 'remaining_params': 9320760, 'pruned_model_sparsity': 0.8903667005420054, 'expected_sparsity': 0.88496, 'target_sparsity': 0.95, 'step': 23450}


Iteration:  50%|█████     | 134/268 [00:23<01:36,  1.39it/s][A
Iteration:  50%|█████     | 135/268 [00:23<01:12,  1.84it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:55,  2.37it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:43,  2.99it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:35,  3.65it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:29,  4.31it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:25,  4.93it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:22,  5.59it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:20,  6.04it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:19,  6.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:18,  6.70it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:17,  6.94it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:17,  7.15it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.36it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.52it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.46it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.59it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.51it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.50it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.28it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.27it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.37it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.49it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.58it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.63it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.64it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.65it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.67it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.59it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.82it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.76it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.71it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.68it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.57it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.58it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.62it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:11,  7.75it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.70it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.60it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.80it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.75it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.72it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:10,  7.78it/s][A[INFO|trainer.py:570] 2024-04-21 17:06:14,487 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:06:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:06:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:06:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:06:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:06:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:06:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35823474778962877, 'eval_loss': 1.0743946, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 415, 556, 534, 526, 506, 428, 350, 226, 182, 195, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75704490, 'remaining_params': 9313110, 'pruned_model_sparsity': 0.8904566819105691, 'expected_sparsity': 0.88499, 'target_sparsity': 0.95, 'step': 23500}


Iteration:  69%|██████▊   | 184/268 [00:32<01:00,  1.39it/s][A04/21/2024 17:06:16 - INFO - trainer.trainer_mod - v4 Global step: 23500, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:32<00:45,  1.84it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:34,  2.38it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:26,  3.01it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:21,  3.66it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:18,  4.36it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:15,  5.01it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:13,  5.62it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:12,  6.04it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:11,  6.36it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:11,  6.53it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  6.99it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:10,  6.78it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:10,  6.88it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.01it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.09it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.30it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.31it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.40it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.47it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.51it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.58it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.58it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.54it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.35it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.48it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.52it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.56it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.48it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.54it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.49it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.52it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.73it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.70it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.72it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.81it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.79it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.66it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.53it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.55it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 228/268 [00:38<00:05,  7.46it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.67it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:04,  7.68it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.53it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 17:06:23,083 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:06:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:06:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:06:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:06:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:06:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:06:25 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3509417839484213, 'eval_loss': 1.0937862, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [369, 414, 556, 532, 526, 506, 428, 350, 226, 182, 194, 145], 'head_nums': [3, 4, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75704490, 'remaining_params': 9313110, 'pruned_model_sparsity': 0.8904566819105691, 'expected_sparsity': 0.88502, 'target_sparsity': 0.95, 'step': 23550}


Iteration:  87%|████████▋ | 234/268 [00:40<00:24,  1.39it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:17,  1.84it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:13,  2.41it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:10,  3.03it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:08,  3.70it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:06,  4.39it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:05,  5.03it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:04,  5.62it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:04,  6.11it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  6.49it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.84it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.06it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  7.18it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.32it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.29it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.42it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.31it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.54it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.72it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.73it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.49it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.40it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.38it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.37it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.48it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.52it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.70it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.61it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.44it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.54it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.77it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.89it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.96it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.88it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.36it/s][A04/21/2024 17:06:29 - INFO - trainer.trainer_mod - Epoch 87 finished. Took 45.15 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.94it/s]
Epoch:  88%|████████▊ | 88/100 [1:07:42<09:09, 45.81s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.50it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.77it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.78it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.54it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.56it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.50it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.45it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.39it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.46it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.58it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.59it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.49it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.56it/s][A[INFO|trainer.py:570] 2024-04-21 17:06:31,576 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:06:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:06:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:06:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:06:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.01it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 17:06:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:06:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3647152178708173, 'eval_loss': 1.0128316, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [368, 413, 555, 531, 525, 506, 428, 350, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75709080, 'remaining_params': 9308520, 'pruned_model_sparsity': 0.8905106707317073, 'expected_sparsity': 0.8851, 'target_sparsity': 0.95, 'step': 23600}


Iteration:   6%|▌         | 16/268 [00:04<03:02,  1.38it/s][A04/21/2024 17:06:33 - INFO - trainer.trainer_mod - v4 Global step: 23600, Alignment: tensor([ 3,  7,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:04<02:17,  1.83it/s][A
Iteration:   7%|▋         | 18/268 [00:04<01:45,  2.37it/s][A
Iteration:   7%|▋         | 19/268 [00:04<01:23,  2.99it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:07,  3.69it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:55,  4.42it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:48,  5.07it/s][A
Iteration:   9%|▊         | 23/268 [00:05<00:44,  5.50it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:41,  5.95it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:37,  6.40it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:35,  6.72it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:34,  7.03it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:34,  7.05it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.26it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.36it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.43it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.60it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.52it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:30,  7.59it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.59it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.58it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.59it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:29,  7.62it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.62it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.49it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.50it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.48it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.39it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.35it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.32it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.33it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:30,  7.25it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.32it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.58it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.60it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.64it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.57it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.50it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.45it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.37it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.48it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.54it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:26,  7.73it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.63it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.65it/s][A[INFO|trainer.py:570] 2024-04-21 17:06:40,151 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:06:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:06:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:06:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:06:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:06:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:06:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3632475772127081, 'eval_loss': 1.058371, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [368, 412, 555, 530, 525, 505, 427, 350, 226, 182, 195, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75712140, 'remaining_params': 9305460, 'pruned_model_sparsity': 0.8905466632791328, 'expected_sparsity': 0.88515, 'target_sparsity': 0.95, 'step': 23650}


Iteration:  25%|██▍       | 66/268 [00:12<02:24,  1.40it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<01:49,  1.84it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<01:23,  2.38it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<01:06,  3.00it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:54,  3.62it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:46,  4.24it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:40,  4.89it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:35,  5.48it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:32,  5.98it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:30,  6.34it/s][A
Iteration:  28%|██▊       | 76/268 [00:14<00:28,  6.69it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:27,  6.85it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:26,  7.12it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:27,  6.93it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:26,  7.17it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.33it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.45it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:25,  7.35it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:24,  7.44it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.49it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.59it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.82it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.75it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.56it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.56it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:22,  7.72it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.57it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.42it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.40it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.31it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.40it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.40it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.38it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.45it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.46it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.55it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.51it/s][A
Iteration:  40%|███▉      | 106/268 [00:18<00:21,  7.60it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.61it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.60it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.50it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.57it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.61it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.53it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.59it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 17:06:48,780 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:06:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:06:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:06:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:06:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:06:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:06:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3571168887297259, 'eval_loss': 1.085607, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [368, 412, 554, 529, 524, 505, 427, 350, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75715200, 'remaining_params': 9302400, 'pruned_model_sparsity': 0.8905826558265583, 'expected_sparsity': 0.8852, 'target_sparsity': 0.95, 'step': 23700}


Iteration:  43%|████▎     | 116/268 [00:21<01:49,  1.39it/s][A04/21/2024 17:06:50 - INFO - trainer.trainer_mod - v4 Global step: 23700, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:21<01:21,  1.85it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<01:02,  2.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:49,  3.02it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:40,  3.68it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:34,  4.32it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:29,  4.87it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:26,  5.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:24,  5.94it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:22,  6.34it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:21,  6.69it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:20,  6.87it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:19,  7.10it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:19,  7.11it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.23it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.55it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.45it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.53it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.55it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.43it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.33it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.43it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.39it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:17,  7.46it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.40it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:25<00:16,  7.53it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.54it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.73it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.81it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.79it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.73it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.71it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.72it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.74it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.56it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.36it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.43it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.05it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:15,  7.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:27<00:15,  6.86it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  6.97it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:15,  6.96it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.17it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.30it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:14,  7.40it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 17:06:57,427 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:06:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:06:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:06:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:06:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:06:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:06:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3540349775999284, 'eval_loss': 1.1005155, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [368, 412, 554, 528, 524, 505, 426, 350, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75716730, 'remaining_params': 9300870, 'pruned_model_sparsity': 0.890600652100271, 'expected_sparsity': 0.88518, 'target_sparsity': 0.95, 'step': 23750}


Iteration:  62%|██████▏   | 166/268 [00:29<01:13,  1.39it/s][A
Iteration:  62%|██████▏   | 167/268 [00:30<00:55,  1.83it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:42,  2.38it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:32,  3.02it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:26,  3.70it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:22,  4.37it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:19,  5.01it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:16,  5.60it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:15,  6.18it/s][A
Iteration:  65%|██████▌   | 175/268 [00:31<00:14,  6.56it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:13,  6.85it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.93it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.11it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.09it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.40it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:11,  7.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.53it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.27it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.35it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.45it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.30it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.22it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.24it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.37it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.46it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.51it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.58it/s][A
Iteration:  74%|███████▎  | 197/268 [00:34<00:09,  7.59it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.49it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.50it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.58it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.44it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.47it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.66it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.64it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.62it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.65it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.65it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:36<00:07,  7.52it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.50it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:06,  7.73it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.72it/s][A[INFO|trainer.py:570] 2024-04-21 17:07:06,013 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:07:06 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:07:06 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:07:06 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:07:06 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 16.95it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:07:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:07:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36209284693594596, 'eval_loss': 1.0731984, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [368, 412, 554, 527, 524, 504, 426, 349, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75719790, 'remaining_params': 9297810, 'pruned_model_sparsity': 0.8906366446476964, 'expected_sparsity': 0.88524, 'target_sparsity': 0.95, 'step': 23800}


Iteration:  81%|████████  | 216/268 [00:38<00:37,  1.39it/s][A04/21/2024 17:07:08 - INFO - trainer.trainer_mod - v4 Global step: 23800, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:38<00:27,  1.84it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:21,  2.38it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:16,  3.00it/s][A
Iteration:  82%|████████▏ | 220/268 [00:39<00:13,  3.68it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:10,  4.35it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:09,  5.05it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:08,  5.60it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:07,  5.97it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  6.50it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:06,  6.89it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.12it/s][A
Iteration:  85%|████████▌ | 228/268 [00:40<00:05,  7.17it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.33it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.48it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.59it/s][A
Iteration:  88%|████████▊ | 235/268 [00:41<00:04,  7.62it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.49it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.55it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.49it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.56it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.63it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.53it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:42<00:03,  7.73it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.59it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.58it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.61it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.76it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.86it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.94it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  8.01it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.92it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.84it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.82it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.82it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.57it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.62it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.50it/s][A
Iteration:  96%|█████████▋| 258/268 [00:44<00:01,  7.60it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.62it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.86it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.69it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.53it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.57it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.65it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.78it/s][A[INFO|trainer.py:570] 2024-04-21 17:07:14,502 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:07:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:07:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:07:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:07:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:07:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:07:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38308040809629684, 'eval_loss': 1.0568386, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 410, 553, 525, 523, 504, 426, 349, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75724380, 'remaining_params': 9293220, 'pruned_model_sparsity': 0.8906906334688347, 'expected_sparsity': 0.88532, 'target_sparsity': 0.95, 'step': 23850}


Iteration:  99%|█████████▉| 266/268 [00:47<00:01,  1.39it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  1.85it/s][A04/21/2024 17:07:16 - INFO - trainer.trainer_mod - Epoch 88 finished. Took 47.24 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.67it/s]
Epoch:  89%|████████▉ | 89/100 [1:08:29<08:28, 46.24s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.65it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.54it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.60it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.66it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.68it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.80it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.68it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.54it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.47it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.60it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:32,  7.79it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.77it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:32,  7.75it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.73it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.55it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.49it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.69it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.64it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.53it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.57it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.61it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.64it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.66it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.60it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.52it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.59it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.64it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:31,  7.43it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.64it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:29,  7.85it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.69it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.60it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.62it/s][A
Iteration:  14%|█▍        | 38/268 [00:04<00:30,  7.49it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:30,  7.52it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:30,  7.48it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:30,  7.48it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.53it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:29,  7.56it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:29,  7.57it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:31,  7.19it/s][A
Iteration:  17%|█▋        | 46/268 [00:06<00:30,  7.35it/s][A
Iteration:  18%|█▊        | 47/268 [00:06<00:29,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 17:07:23,033 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:07:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:07:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:07:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:07:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:07:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:07:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36933524222021563, 'eval_loss': 1.1113695, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 409, 553, 524, 523, 503, 425, 349, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75727440, 'remaining_params': 9290160, 'pruned_model_sparsity': 0.8907266260162602, 'expected_sparsity': 0.88536, 'target_sparsity': 0.95, 'step': 23900}


Iteration:  18%|█▊        | 48/268 [00:08<02:39,  1.38it/s][A04/21/2024 17:07:25 - INFO - trainer.trainer_mod - v4 Global step: 23900, Alignment: tensor([ 0,  3,  8, 10], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:08<01:59,  1.83it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<01:31,  2.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<01:13,  2.97it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:59,  3.64it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:49,  4.33it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:43,  4.96it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:38,  5.52it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:35,  5.96it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:33,  6.36it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:31,  6.73it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:29,  7.02it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.33it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.44it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.54it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.63it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.73it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.70it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:25,  7.72it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.59it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.58it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.52it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.71it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:26,  7.46it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.49it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.52it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:24,  7.70it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:26,  7.29it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:26,  7.26it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.36it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.65it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.78it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:23,  7.86it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:23,  7.76it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:23,  7.77it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.60it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.61it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.52it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.50it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:13<00:23,  7.55it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:23,  7.57it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:22,  7.65it/s][A
Iteration:  35%|███▌      | 94/268 [00:14<00:23,  7.51it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:22,  7.57it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.59it/s][A
Iteration:  36%|███▌      | 97/268 [00:14<00:22,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 17:07:31,560 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:07:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:07:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:07:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:07:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.97it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:07:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:07:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35784652591733207, 'eval_loss': 1.113564, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 408, 553, 523, 522, 503, 425, 349, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75728970, 'remaining_params': 9288630, 'pruned_model_sparsity': 0.8907446222899729, 'expected_sparsity': 0.88542, 'target_sparsity': 0.95, 'step': 23950}


Iteration:  37%|███▋      | 98/268 [00:16<02:02,  1.39it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<01:31,  1.84it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<01:10,  2.38it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:55,  3.02it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:45,  3.69it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:37,  4.37it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:33,  4.90it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:30,  5.39it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:27,  5.91it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:25,  6.21it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:24,  6.58it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:23,  6.79it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:22,  7.02it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:22,  7.05it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.11it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:21,  7.19it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:21,  7.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.45it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.42it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.35it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.42it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.40it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.49it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.51it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.35it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.44it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.48it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.55it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.57it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.57it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.59it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.63it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.69it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.69it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.55it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.57it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.49it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.53it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.60it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.50it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.59it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:16,  7.82it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.59it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.53it/s][A
Iteration:  54%|█████▎    | 144/268 [00:22<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:23<00:16,  7.67it/s][A
Iteration:  54%|█████▍    | 146/268 [00:23<00:15,  7.68it/s][A
Iteration:  55%|█████▍    | 147/268 [00:23<00:15,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 17:07:40,175 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:07:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:07:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:07:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:07:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:07:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:07:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3451071124679131, 'eval_loss': 1.1110109, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 408, 553, 522, 523, 503, 425, 349, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75727440, 'remaining_params': 9290160, 'pruned_model_sparsity': 0.8907266260162602, 'expected_sparsity': 0.88541, 'target_sparsity': 0.95, 'step': 24000}


Iteration:  55%|█████▌    | 148/268 [00:25<01:26,  1.39it/s][A04/21/2024 17:07:42 - INFO - trainer.trainer_mod - v4 Global step: 24000, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:25<01:04,  1.84it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:49,  2.38it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:38,  3.00it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:31,  3.68it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:26,  4.36it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:22,  5.01it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:20,  5.47it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:18,  5.96it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:17,  6.35it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:16,  6.70it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:15,  7.00it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:15,  7.16it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.45it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.41it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.47it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.55it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.78it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:12,  7.89it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:12,  7.85it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.64it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.43it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.49it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.59it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.61it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.57it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.45it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.36it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.45it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.43it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.45it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.54it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.56it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.61it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.62it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:10,  7.77it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.93it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.76it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.72it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.71it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.63it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.63it/s][A
Iteration:  71%|███████   | 190/268 [00:30<00:10,  7.55it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:11,  6.98it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.29it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:10,  7.26it/s][A
Iteration:  72%|███████▏  | 194/268 [00:31<00:10,  7.28it/s][A
Iteration:  73%|███████▎  | 195/268 [00:31<00:09,  7.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:31<00:09,  7.39it/s][A
Iteration:  74%|███████▎  | 197/268 [00:31<00:09,  7.42it/s][A[INFO|trainer.py:570] 2024-04-21 17:07:48,746 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:07:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:07:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:07:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:07:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:07:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:07:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3509417839484213, 'eval_loss': 1.0951667, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 407, 552, 521, 522, 502, 425, 348, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75733560, 'remaining_params': 9284040, 'pruned_model_sparsity': 0.8907986111111111, 'expected_sparsity': 0.88549, 'target_sparsity': 0.95, 'step': 24050}


Iteration:  74%|███████▍  | 198/268 [00:34<00:50,  1.39it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:37,  1.83it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:28,  2.37it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:22,  2.96it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:18,  3.62it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:15,  4.31it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:12,  5.04it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:11,  5.62it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:10,  6.04it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:09,  6.53it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  6.70it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:08,  6.78it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:08,  7.04it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.32it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.71it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.69it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.66it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.56it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.60it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.72it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.70it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.72it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.83it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.70it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.69it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.68it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.50it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.54it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.49it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.54it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.56it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.60it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.61it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.70it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.68it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.50it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.33it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:04,  7.46it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.26it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.18it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.27it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.42it/s][A
Iteration:  91%|█████████ | 243/268 [00:39<00:03,  7.40it/s][A
Iteration:  91%|█████████ | 244/268 [00:40<00:03,  7.49it/s][A
Iteration:  91%|█████████▏| 245/268 [00:40<00:03,  7.44it/s][A
Iteration:  92%|█████████▏| 246/268 [00:40<00:02,  7.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:40<00:02,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 17:07:57,325 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:07:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:07:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:07:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:07:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:07:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:07:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36168168621477015, 'eval_loss': 1.0479314, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 406, 552, 519, 522, 502, 424, 348, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75735090, 'remaining_params': 9282510, 'pruned_model_sparsity': 0.8908166073848238, 'expected_sparsity': 0.88552, 'target_sparsity': 0.95, 'step': 24100}


Iteration:  93%|█████████▎| 248/268 [00:42<00:14,  1.39it/s][A04/21/2024 17:07:59 - INFO - trainer.trainer_mod - v4 Global step: 24100, Alignment: tensor([ 0,  3,  8, 10], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [00:42<00:10,  1.83it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:07,  2.36it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:05,  2.98it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:04,  3.65it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:03,  4.30it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:02,  4.96it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:02,  5.54it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  6.06it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  6.40it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  6.74it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  6.99it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.03it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.20it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.31it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.39it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.58it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.65it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.61it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.66it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.20it/s][A04/21/2024 17:08:01 - INFO - trainer.trainer_mod - Epoch 89 finished. Took 45.2 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  90%|█████████ | 90/100 [1:09:15<07:39, 45.93s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.72it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.78it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.55it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.80it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.90it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.72it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.60it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:35,  7.43it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.54it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.43it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.53it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.68it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.62it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:36,  7.01it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:35,  7.15it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:35,  7.11it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:34,  7.19it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:34,  7.24it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.47it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:33,  7.45it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.53it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.69it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:31,  7.66it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.58it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.58it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.62it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.54it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 17:08:05,897 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:08:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:08:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:08:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:08:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 16.88it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.92it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.21it/s]04/21/2024 17:08:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:08:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.35439889645187594, 'eval_loss': 1.094006, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 405, 552, 519, 521, 501, 424, 348, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75738150, 'remaining_params': 9279450, 'pruned_model_sparsity': 0.8908525999322493, 'expected_sparsity': 0.88558, 'target_sparsity': 0.95, 'step': 24150}


Iteration:  11%|█         | 30/268 [00:05<02:52,  1.38it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<02:09,  1.83it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<01:38,  2.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<01:17,  3.01it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<01:03,  3.69it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:53,  4.36it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:45,  5.07it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:41,  5.57it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:38,  6.01it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:36,  6.34it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:34,  6.61it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:33,  6.80it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:31,  7.16it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:31,  7.18it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.32it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.39it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.50it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.53it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.60it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.51it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.43it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<00:28,  7.50it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.57it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.58it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.62it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.63it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.64it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.55it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.51it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.64it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.62it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.64it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.52it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.57it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.61it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.53it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.41it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.57it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.58it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.56it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.62it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.61it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.64it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.80it/s][A[INFO|trainer.py:570] 2024-04-21 17:08:14,448 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:08:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:08:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:08:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:08:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:08:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:08:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.36053768523977336, 'eval_loss': 1.0708655, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [366, 405, 551, 518, 521, 501, 424, 348, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75741210, 'remaining_params': 9276390, 'pruned_model_sparsity': 0.8908885924796748, 'expected_sparsity': 0.88562, 'target_sparsity': 0.95, 'step': 24200}


Iteration:  30%|██▉       | 80/268 [00:14<02:14,  1.39it/s][A04/21/2024 17:08:16 - INFO - trainer.trainer_mod - v4 Global step: 24200, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:14<01:41,  1.84it/s][A
Iteration:  31%|███       | 82/268 [00:14<01:18,  2.38it/s][A
Iteration:  31%|███       | 83/268 [00:14<01:02,  2.97it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:50,  3.65it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:41,  4.38it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:36,  5.02it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:32,  5.60it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:29,  6.11it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:27,  6.54it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:25,  6.85it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:25,  6.98it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:24,  7.17it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.32it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:24,  7.23it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.26it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.26it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.25it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.42it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.35it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.45it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.52it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.47it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.54it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.61it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.51it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.57it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.61it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.77it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.65it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.46it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.48it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.41it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.51it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.78it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:20,  7.36it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.57it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.73it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.69it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.70it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.52it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.70it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.59it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.60it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.40it/s][A[INFO|trainer.py:570] 2024-04-21 17:08:23,039 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:08:23 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:08:23 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:08:23 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:08:23 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:08:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:08:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3451071124679131, 'eval_loss': 1.1210829, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 404, 551, 517, 520, 501, 424, 348, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75741210, 'remaining_params': 9276390, 'pruned_model_sparsity': 0.8908885924796748, 'expected_sparsity': 0.88562, 'target_sparsity': 0.95, 'step': 24250}


Iteration:  49%|████▊     | 130/268 [00:23<01:39,  1.39it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<01:14,  1.84it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:57,  2.37it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:45,  2.99it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:36,  3.66it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:30,  4.34it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:26,  4.98it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:23,  5.64it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:21,  6.12it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:19,  6.54it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:19,  6.71it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:18,  6.98it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.21it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.40it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.44it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.41it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.50it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.48it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.46it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.50it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.41it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.47it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.46it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.52it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.61it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.80it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.54it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.43it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.37it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.50it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.55it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.79it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.76it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.56it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.47it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.48it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.56it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.63it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.40it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.51it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.59it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.75it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.63it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:11,  7.76it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.87it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.80it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 17:08:31,584 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:08:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:08:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:08:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:08:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.12it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:08:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:08:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.34550903174440106, 'eval_loss': 1.118567, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 403, 551, 516, 520, 500, 423, 347, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75745800, 'remaining_params': 9271800, 'pruned_model_sparsity': 0.890942581300813, 'expected_sparsity': 0.88566, 'target_sparsity': 0.95, 'step': 24300}


Iteration:  67%|██████▋   | 180/268 [00:31<01:03,  1.39it/s][A04/21/2024 17:08:33 - INFO - trainer.trainer_mod - v4 Global step: 24300, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:31<00:47,  1.84it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:36,  2.38it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:28,  3.01it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:22,  3.68it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:19,  4.32it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:16,  4.92it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:14,  5.50it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:13,  5.93it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:12,  6.45it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:11,  6.67it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:11,  6.86it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  6.96it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.16it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.33it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.45it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.41it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.50it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.54it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.45it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.50it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.74it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.72it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.69it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.80it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.42it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.48it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.67it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.72it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.69it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:06,  7.78it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.52it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.57it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.63it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.75it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.73it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.74it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.72it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.79it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.77it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.94it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.76it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.76it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.78it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.70it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:04,  7.90it/s][A[INFO|trainer.py:570] 2024-04-21 17:08:40,100 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:08:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:08:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:08:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:08:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:08:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:08:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3490196502696348, 'eval_loss': 1.1385778, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [367, 402, 550, 515, 520, 500, 423, 347, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75747330, 'remaining_params': 9270270, 'pruned_model_sparsity': 0.8909605775745257, 'expected_sparsity': 0.88569, 'target_sparsity': 0.95, 'step': 24350}


Iteration:  86%|████████▌ | 230/268 [00:40<00:27,  1.40it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:20,  1.85it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:15,  2.39it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:11,  3.04it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:09,  3.71it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:07,  4.41it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:06,  5.05it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:05,  5.41it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:05,  5.96it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  6.41it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:04,  6.65it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  6.95it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.09it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.47it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.37it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.45it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.54it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.36it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.22it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.33it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.46it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.39it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.52it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.53it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.60it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.55it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.58it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.51it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.42it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.41it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.38it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.28it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.28it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.33it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.35it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.44it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.69it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.69it/s][A04/21/2024 17:08:47 - INFO - trainer.trainer_mod - Epoch 90 finished. Took 45.18 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  91%|█████████ | 91/100 [1:10:00<06:51, 45.70s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.67it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.44it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.70it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.51it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.68it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:32,  7.83it/s][A[INFO|trainer.py:570] 2024-04-21 17:08:48,638 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:08:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:08:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:08:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:08:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.11it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.28it/s]04/21/2024 17:08:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:08:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.353043514617452, 'eval_loss': 1.161506, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [366, 401, 550, 514, 519, 499, 423, 347, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75751920, 'remaining_params': 9265680, 'pruned_model_sparsity': 0.891014566395664, 'expected_sparsity': 0.88572, 'target_sparsity': 0.95, 'step': 24400}


Iteration:   4%|▍         | 12/268 [00:03<03:04,  1.38it/s][A04/21/2024 17:08:50 - INFO - trainer.trainer_mod - v4 Global step: 24400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:03<02:18,  1.84it/s][A
Iteration:   5%|▌         | 14/268 [00:03<01:46,  2.39it/s][A
Iteration:   6%|▌         | 15/268 [00:03<01:23,  3.05it/s][A
Iteration:   6%|▌         | 16/268 [00:04<01:07,  3.72it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:56,  4.45it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:49,  5.10it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:43,  5.67it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:39,  6.24it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:37,  6.52it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:36,  6.75it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:35,  6.93it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:33,  7.23it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:33,  7.29it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.42it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:31,  7.66it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:31,  7.56it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:30,  7.73it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 31/268 [00:05<00:31,  7.60it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.56it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.49it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.33it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.36it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.46it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.37it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.47it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.39it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:32,  7.09it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:31,  7.29it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.39it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.49it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.56it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.50it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.70it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:28,  7.59it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.36it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.47it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.38it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.45it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.40it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.35it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.58it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.59it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.46it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.50it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.54it/s][A[INFO|trainer.py:570] 2024-04-21 17:08:57,217 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:08:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:08:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:08:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:08:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:08:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:08:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3609036607753639, 'eval_loss': 1.1038735, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [366, 400, 550, 513, 519, 499, 423, 347, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75751920, 'remaining_params': 9265680, 'pruned_model_sparsity': 0.891014566395664, 'expected_sparsity': 0.88577, 'target_sparsity': 0.95, 'step': 24450}


Iteration:  23%|██▎       | 62/268 [00:12<02:28,  1.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<01:51,  1.84it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<01:25,  2.39it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<01:07,  3.01it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:54,  3.69it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:46,  4.33it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:40,  4.94it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:36,  5.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:33,  5.87it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:31,  6.24it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:29,  6.62it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:28,  6.89it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:26,  7.21it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:26,  7.33it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.41it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:25,  7.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:25,  7.43it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.51it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.52it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.58it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.57it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:23,  7.80it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.71it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.74it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.72it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.59it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.37it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:24,  7.32it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.56it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.56it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.44it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.28it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.49it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.48it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.53it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.59it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.57it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.56it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.59it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.58it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.48it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.54it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.59it/s][A[INFO|trainer.py:570] 2024-04-21 17:09:05,803 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:09:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:09:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:09:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:09:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.11it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:09:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:09:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3813868081719626, 'eval_loss': 1.0933634, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [366, 399, 549, 512, 519, 498, 422, 347, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75756510, 'remaining_params': 9261090, 'pruned_model_sparsity': 0.8910685552168022, 'expected_sparsity': 0.88582, 'target_sparsity': 0.95, 'step': 24500}


Iteration:  42%|████▏     | 112/268 [00:20<01:52,  1.39it/s][A04/21/2024 17:09:07 - INFO - trainer.trainer_mod - v4 Global step: 24500, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:20<01:24,  1.83it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<01:05,  2.33it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:51,  2.96it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:41,  3.62it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:35,  4.27it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:30,  4.92it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:26,  5.57it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:24,  6.07it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:22,  6.49it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:21,  6.81it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:20,  7.06it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:20,  7.20it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.32it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:19,  7.30it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.45it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.58it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.61it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:17,  7.64it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.77it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.72it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.72it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.75it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.57it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:16,  7.73it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.54it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.49it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.50it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.78it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.54it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.60it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.61it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.64it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.65it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.55it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.57it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.59it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.65it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.55it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.57it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.65it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.61it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.78it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.57it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.62it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.66it/s][A[INFO|trainer.py:570] 2024-04-21 17:09:14,329 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:09:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:09:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:09:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:09:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.28it/s]04/21/2024 17:09:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:09:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38899362002004945, 'eval_loss': 1.0872308, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [366, 398, 549, 510, 519, 498, 422, 347, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75756510, 'remaining_params': 9261090, 'pruned_model_sparsity': 0.8910685552168022, 'expected_sparsity': 0.88581, 'target_sparsity': 0.95, 'step': 24550}


Iteration:  60%|██████    | 162/268 [00:29<01:15,  1.40it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:56,  1.86it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:43,  2.39it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:34,  3.02it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:27,  3.68it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:22,  4.41it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:19,  5.06it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:17,  5.70it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:15,  6.14it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:14,  6.51it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:14,  6.73it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:13,  6.89it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:13,  7.12it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.25it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.51it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.40it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.49it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.68it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.58it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.65it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.52it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.58it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.63it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.53it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.55it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.42it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.62it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.78it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:09,  7.73it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:09,  7.76it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.70it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.09it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:10,  7.08it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.22it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.38it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.65it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.37it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.64it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.64it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.57it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.56it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.52it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.54it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.75it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.67it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.54it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.44it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.43it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.49it/s][A[INFO|trainer.py:570] 2024-04-21 17:09:22,897 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:09:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:09:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:09:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:09:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:09:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:09:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38735323805942456, 'eval_loss': 1.1007438, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [366, 398, 549, 509, 518, 498, 422, 346, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75759570, 'remaining_params': 9258030, 'pruned_model_sparsity': 0.8911045477642277, 'expected_sparsity': 0.88587, 'target_sparsity': 0.95, 'step': 24600}


Iteration:  79%|███████▉  | 212/268 [00:37<00:40,  1.38it/s][A04/21/2024 17:09:24 - INFO - trainer.trainer_mod - v4 Global step: 24600, Alignment: tensor([ 0,  7,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:37<00:29,  1.84it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:22,  2.38it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:17,  3.00it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:14,  3.63it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:11,  4.31it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:10,  4.93it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:08,  5.55it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:07,  6.06it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:07,  6.36it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  6.64it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  6.80it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:06,  7.06it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:06,  7.15it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.29it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.30it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.36it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.48it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.45it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.42it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.55it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.39it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.36it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.47it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.54it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.56it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.57it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.58it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.52it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:02,  7.70it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.53it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.60it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.51it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.37it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.47it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.39it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.43it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.53it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.71it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.68it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.57it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.47it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.52it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.57it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 17:09:31,501 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:09:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:09:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:09:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:09:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 16.96it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:09:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:09:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38656831667454095, 'eval_loss': 1.1025101, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [366, 398, 549, 508, 518, 497, 422, 346, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75761100, 'remaining_params': 9256500, 'pruned_model_sparsity': 0.8911225440379403, 'expected_sparsity': 0.8859, 'target_sparsity': 0.95, 'step': 24650}


Iteration:  98%|█████████▊| 262/268 [00:46<00:04,  1.39it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:02,  1.84it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:01,  2.39it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  3.74it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  4.38it/s][A04/21/2024 17:09:34 - INFO - trainer.trainer_mod - Epoch 91 finished. Took 47.13 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  92%|█████████▏| 92/100 [1:10:47<06:09, 46.13s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:36,  7.40it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.62it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.59it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.59it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.65it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.52it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:35,  7.36it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.46it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.56it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.81it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.77it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.61it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.62it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:35,  7.24it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:34,  7.36it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.43it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:34,  7.38it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.44it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:33,  7.46it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.66it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.87it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:31,  7.81it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:33,  7.37it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:33,  7.36it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.55it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.72it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:32,  7.47it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:32,  7.35it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:32,  7.46it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:32,  7.33it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:31,  7.64it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:30,  7.62it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:31,  7.56it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.73it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.71it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.68it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.69it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.49it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:29,  7.71it/s][A
Iteration:  15%|█▍        | 40/268 [00:05<00:29,  7.72it/s][A
Iteration:  15%|█▌        | 41/268 [00:05<00:29,  7.57it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:30,  7.46it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:32,  6.96it/s][A[INFO|trainer.py:570] 2024-04-21 17:09:40,064 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:09:40 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:09:40 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:09:40 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:09:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:09:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:09:42 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3790304256906935, 'eval_loss': 1.0760034, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [366, 397, 548, 507, 517, 497, 421, 346, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75765690, 'remaining_params': 9251910, 'pruned_model_sparsity': 0.8911765328590786, 'expected_sparsity': 0.88594, 'target_sparsity': 0.95, 'step': 24700}


Iteration:  16%|█▋        | 44/268 [00:07<02:43,  1.37it/s][A04/21/2024 17:09:42 - INFO - trainer.trainer_mod - v4 Global step: 24700, Alignment: tensor([ 0,  7,  8, 10], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:07<02:02,  1.82it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<01:34,  2.36it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<01:14,  2.98it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<01:00,  3.66it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:49,  4.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:43,  5.02it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:38,  5.67it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:35,  6.14it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:32,  6.56it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:31,  6.79it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:31,  6.81it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:30,  7.05it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:29,  7.16it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.35it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.48it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.52it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.50it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.52it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.58it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.64it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.54it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:28,  7.17it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:27,  7.36it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.43it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:25,  7.69it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.57it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.64it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.63it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.62it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:24,  7.75it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:24,  7.95it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.88it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.86it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:24,  7.70it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:24,  7.66it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:24,  7.58it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.58it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.48it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.45it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.65it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.61it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.56it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.60it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:23,  7.63it/s][A
Iteration:  34%|███▍      | 91/268 [00:13<00:22,  7.85it/s][A
Iteration:  34%|███▍      | 92/268 [00:14<00:22,  7.76it/s][A
Iteration:  35%|███▍      | 93/268 [00:14<00:22,  7.87it/s][A[INFO|trainer.py:570] 2024-04-21 17:09:48,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:09:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:09:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:09:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:09:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:09:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:09:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38437484180841186, 'eval_loss': 1.0638275, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 396, 548, 506, 517, 496, 421, 346, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75768750, 'remaining_params': 9248850, 'pruned_model_sparsity': 0.8912125254065041, 'expected_sparsity': 0.88599, 'target_sparsity': 0.95, 'step': 24750}


Iteration:  35%|███▌      | 94/268 [00:16<02:04,  1.40it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<01:33,  1.85it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<01:11,  2.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:56,  3.03it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:45,  3.72it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:38,  4.40it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:33,  5.05it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:29,  5.64it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:27,  6.09it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:25,  6.58it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:23,  6.86it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:23,  6.97it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:22,  7.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.37it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.50it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.44it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:21,  7.42it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.44it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.53it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.50it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.58it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.48it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.52it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.47it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.42it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.36it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.45it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.61it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.62it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.49it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.55it/s][A
Iteration:  48%|████▊     | 129/268 [00:20<00:18,  7.57it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.58it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.49it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:18,  7.42it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:18,  7.38it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:18,  7.32it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.43it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.48it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.54it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.47it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:22<00:16,  7.57it/s][A
Iteration:  53%|█████▎    | 141/268 [00:22<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 142/268 [00:22<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 143/268 [00:22<00:16,  7.78it/s][A[INFO|trainer.py:570] 2024-04-21 17:09:57,118 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:09:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:09:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:09:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:09:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:09:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:09:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.37973525631011207, 'eval_loss': 1.0627941, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 395, 548, 505, 517, 496, 421, 346, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75768750, 'remaining_params': 9248850, 'pruned_model_sparsity': 0.8912125254065041, 'expected_sparsity': 0.88602, 'target_sparsity': 0.95, 'step': 24800}


Iteration:  54%|█████▎    | 144/268 [00:24<01:28,  1.39it/s][A04/21/2024 17:09:59 - INFO - trainer.trainer_mod - v4 Global step: 24800, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:25<01:06,  1.85it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:50,  2.41it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:39,  3.03it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:32,  3.67it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:27,  4.36it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:23,  5.01it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:20,  5.60it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:19,  6.04it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:17,  6.53it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:17,  6.65it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:16,  6.86it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.07it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.16it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.34it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.46it/s][A
Iteration:  60%|█████▉    | 160/268 [00:26<00:14,  7.57it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.63it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.63it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.62it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.62it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.61it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.66it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.68it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.66it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:12,  7.64it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.43it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.52it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.44it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.54it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.70it/s][A
Iteration:  65%|██████▌   | 175/268 [00:28<00:12,  7.68it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.58it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.52it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.43it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.44it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.35it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.46it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.35it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.44it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.47it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.51it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.49it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.57it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.63it/s][A
Iteration:  71%|███████   | 190/268 [00:30<00:10,  7.41it/s][A
Iteration:  71%|███████▏  | 191/268 [00:31<00:10,  7.47it/s][A
Iteration:  72%|███████▏  | 192/268 [00:31<00:10,  7.56it/s][A
Iteration:  72%|███████▏  | 193/268 [00:31<00:09,  7.63it/s][A[INFO|trainer.py:570] 2024-04-21 17:10:05,675 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:10:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:10:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:10:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:10:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.15it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.00it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.47it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.65it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.77it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.12it/s]04/21/2024 17:10:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:10:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3831310678715166, 'eval_loss': 1.1297665, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 395, 548, 505, 516, 496, 421, 346, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75770280, 'remaining_params': 9247320, 'pruned_model_sparsity': 0.8912305216802168, 'expected_sparsity': 0.88608, 'target_sparsity': 0.95, 'step': 24850}


Iteration:  72%|███████▏  | 194/268 [00:33<00:53,  1.39it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:39,  1.84it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:30,  2.37it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:23,  3.01it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:18,  3.69it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:15,  4.36it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:13,  5.00it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:12,  5.46it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:11,  5.97it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:10,  6.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:09,  6.68it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:09,  6.96it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.19it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.34it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.43it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.39it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.36it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.42it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.44it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.50it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.68it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.67it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.68it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.68it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.70it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.90it/s][A
Iteration:  82%|████████▏ | 221/268 [00:36<00:06,  7.68it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.61it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.53it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.60it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.40it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.29it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.23it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.40it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.48it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.55it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.55it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.52it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.60it/s][A
Iteration:  88%|████████▊ | 236/268 [00:38<00:04,  7.61it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.53it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.56it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.57it/s][A
Iteration:  90%|████████▉ | 240/268 [00:39<00:03,  7.72it/s][A
Iteration:  90%|████████▉ | 241/268 [00:39<00:03,  7.65it/s][A
Iteration:  90%|█████████ | 242/268 [00:39<00:03,  7.62it/s][A
Iteration:  91%|█████████ | 243/268 [00:39<00:03,  7.65it/s][A[INFO|trainer.py:570] 2024-04-21 17:10:14,260 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:10:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:10:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:10:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:10:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:10:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:10:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38735323805942456, 'eval_loss': 1.099956, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 394, 548, 504, 516, 495, 420, 346, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75773340, 'remaining_params': 9244260, 'pruned_model_sparsity': 0.8912665142276422, 'expected_sparsity': 0.88611, 'target_sparsity': 0.95, 'step': 24900}


Iteration:  91%|█████████ | 244/268 [00:42<00:17,  1.38it/s][A04/21/2024 17:10:16 - INFO - trainer.trainer_mod - v4 Global step: 24900, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [00:42<00:12,  1.83it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:09,  2.38it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:06,  3.00it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:05,  3.66it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:04,  4.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:03,  4.99it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:03,  5.52it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  6.03it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  6.44it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:02,  6.77it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.13it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.31it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.17it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.17it/s][A
Iteration:  97%|█████████▋| 259/268 [00:43<00:01,  7.31it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.34it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.32it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.42it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.65it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.58it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.51it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.51it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.54it/s][A04/21/2024 17:10:19 - INFO - trainer.trainer_mod - Epoch 92 finished. Took 45.15 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.94it/s]
Epoch:  93%|█████████▎| 93/100 [1:11:32<05:20, 45.84s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.69it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.52it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.53it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.75it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.76it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.51it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.56it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.61it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.53it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.51it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.53it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.55it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.50it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.51it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.69it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.71it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.69it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:31,  7.79it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.75it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.76it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.55it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.53it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.43it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 17:10:22,774 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:10:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:10:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:10:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:10:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:10:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:10:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3846762852756094, 'eval_loss': 1.0947858, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 393, 547, 503, 515, 495, 420, 346, 226, 182, 194, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75776400, 'remaining_params': 9241200, 'pruned_model_sparsity': 0.8913025067750677, 'expected_sparsity': 0.88615, 'target_sparsity': 0.95, 'step': 24950}


Iteration:  10%|▉         | 26/268 [00:05<02:53,  1.39it/s][A
Iteration:  10%|█         | 27/268 [00:05<02:10,  1.85it/s][A
Iteration:  10%|█         | 28/268 [00:05<01:40,  2.38it/s][A
Iteration:  11%|█         | 29/268 [00:05<01:19,  3.00it/s][A
Iteration:  11%|█         | 30/268 [00:05<01:04,  3.68it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:55,  4.30it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:47,  5.01it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:42,  5.52it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:38,  6.03it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:37,  6.29it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:34,  6.64it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:33,  6.90it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:32,  7.11it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.17it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.31it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.44it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:30,  7.46it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.50it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.54it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.47it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.55it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.42it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.48it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.56it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.59it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.61it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:27,  7.83it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:27,  7.83it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.57it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.46it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.55it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.49it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.67it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.69it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.51it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.59it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.75it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.54it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.61it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.60it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.52it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.43it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.55it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.57it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.64it/s][A[INFO|trainer.py:570] 2024-04-21 17:10:31,343 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:10:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:10:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:10:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:10:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:10:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:10:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39418850983928566, 'eval_loss': 1.085211, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 392, 547, 501, 515, 494, 420, 345, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75779460, 'remaining_params': 9238140, 'pruned_model_sparsity': 0.8913384993224932, 'expected_sparsity': 0.88617, 'target_sparsity': 0.95, 'step': 25000}


Iteration:  28%|██▊       | 76/268 [00:13<02:18,  1.39it/s][A04/21/2024 17:10:33 - INFO - trainer.trainer_mod - v4 Global step: 25000, Alignment: tensor([ 0,  7,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:14<01:44,  1.83it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<01:20,  2.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<01:04,  2.93it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:52,  3.58it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:43,  4.27it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:37,  4.91it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:33,  5.49it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:30,  6.03it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:28,  6.37it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:27,  6.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:26,  6.83it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:25,  7.04it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:24,  7.26it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:24,  7.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.60it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.64it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:22,  7.63it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.76it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.74it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.57it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.48it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.57it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:21,  7.73it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.71it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.71it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.67it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.67it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.69it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:22,  7.35it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.44it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.48it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.51it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.53it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.57it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.58it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.60it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.43it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.51it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:21,  6.97it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:21,  7.16it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.21it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:20,  7.37it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.37it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:20,  7.38it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:20,  7.34it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:20,  7.29it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:20,  7.25it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.38it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:19,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 17:10:39,987 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:10:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:10:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:10:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:10:40 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.23it/s]04/21/2024 17:10:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:10:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3938700520242154, 'eval_loss': 1.092735, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 392, 547, 500, 514, 494, 420, 345, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75780990, 'remaining_params': 9236610, 'pruned_model_sparsity': 0.891356495596206, 'expected_sparsity': 0.88623, 'target_sparsity': 0.95, 'step': 25050}


Iteration:  47%|████▋     | 126/268 [00:22<01:42,  1.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<01:16,  1.84it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:59,  2.36it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:47,  2.94it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:38,  3.62it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:31,  4.29it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:27,  4.87it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:24,  5.47it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:22,  6.00it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:20,  6.51it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:19,  6.85it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:18,  6.97it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.28it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.40it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.46it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.54it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.61it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.50it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.39it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.61it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.65it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.86it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:14,  7.94it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:14,  7.91it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:14,  7.84it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.67it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.87it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.72it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.57it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.44it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.38it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.42it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.41it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.51it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.46it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.40it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.46it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.48it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:14,  7.13it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.28it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.40it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.29it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.38it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.38it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:13,  7.33it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:13,  7.25it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:13,  7.15it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.34it/s][A[INFO|trainer.py:570] 2024-04-21 17:10:48,610 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:10:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:10:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:10:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:10:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.09it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:10:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:10:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38382306214159906, 'eval_loss': 1.092479, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 391, 547, 500, 514, 494, 420, 345, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75780990, 'remaining_params': 9236610, 'pruned_model_sparsity': 0.891356495596206, 'expected_sparsity': 0.88627, 'target_sparsity': 0.95, 'step': 25100}


Iteration:  66%|██████▌   | 176/268 [00:31<01:06,  1.38it/s][A04/21/2024 17:10:50 - INFO - trainer.trainer_mod - v4 Global step: 25100, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:31<00:50,  1.81it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:38,  2.35it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:30,  2.95it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:24,  3.61it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:20,  4.29it/s][A
Iteration:  68%|██████▊   | 182/268 [00:32<00:17,  4.93it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:15,  5.53it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:13,  6.02it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:12,  6.45it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:12,  6.79it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  6.90it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:11,  7.14it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:11,  7.18it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:10,  7.45it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.68it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.58it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.60it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.50it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.55it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.71it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.69it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:08,  7.90it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:08,  8.03it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.84it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.83it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.66it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.86it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.67it/s][A
Iteration:  76%|███████▋  | 205/268 [00:35<00:08,  7.53it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.58it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.66it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.81it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.80it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.76it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.75it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.74it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.66it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.64it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.56it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.43it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.63it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.65it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.65it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.56it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.57it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.64it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.63it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.79it/s][A[INFO|trainer.py:570] 2024-04-21 17:10:57,122 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:10:57 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:10:57 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:10:57 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:10:57 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:10:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:10:59 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3986722481537282, 'eval_loss': 1.0674896, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 390, 546, 499, 513, 493, 419, 345, 226, 182, 193, 145], 'head_nums': [3, 3, 2, 2, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75788640, 'remaining_params': 9228960, 'pruned_model_sparsity': 0.8914464769647696, 'expected_sparsity': 0.88635, 'target_sparsity': 0.95, 'step': 25150}


Iteration:  84%|████████▍ | 226/268 [00:39<00:30,  1.39it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:22,  1.84it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:16,  2.39it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:12,  3.02it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:10,  3.66it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:08,  4.31it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:07,  4.97it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:06,  5.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:05,  6.12it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:05,  6.50it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  6.63it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  6.91it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:04,  7.15it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:04,  7.08it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.24it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.39it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.56it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.62it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.62it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.50it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.58it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.49it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.45it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.61it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  7.59it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.51it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.54it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.61it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.60it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.66it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.59it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.66it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.66it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.54it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.57it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.59it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.64it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.57it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.62it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.62it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.65it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.20it/s][A04/21/2024 17:11:04 - INFO - trainer.trainer_mod - Epoch 93 finished. Took 45.23 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  94%|█████████▍| 94/100 [1:12:17<04:33, 45.66s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.62it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.68it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.64it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.50it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.45it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.51it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.58it/s][A[INFO|trainer.py:570] 2024-04-21 17:11:05,630 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:11:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:11:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:11:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:11:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 16.91it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.96it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 16.97it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.99it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.21it/s]04/21/2024 17:11:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:11:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3938700520242154, 'eval_loss': 1.0186989, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 390, 546, 498, 513, 493, 419, 345, 225, 182, 193, 145], 'head_nums': [3, 3, 2, 1, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75790170, 'remaining_params': 9227430, 'pruned_model_sparsity': 0.8914644732384824, 'expected_sparsity': 0.88636, 'target_sparsity': 0.95, 'step': 25200}


Iteration:   3%|▎         | 8/268 [00:03<03:15,  1.33it/s][A04/21/2024 17:11:07 - INFO - trainer.trainer_mod - v4 Global step: 25200, Alignment: tensor([ 1,  3,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:03<02:24,  1.79it/s][A
Iteration:   4%|▎         | 10/268 [00:03<01:50,  2.34it/s][A
Iteration:   4%|▍         | 11/268 [00:03<01:26,  2.98it/s][A
Iteration:   4%|▍         | 12/268 [00:03<01:10,  3.64it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:58,  4.33it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:50,  5.00it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:45,  5.52it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:42,  5.93it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:38,  6.44it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:37,  6.62it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:36,  6.92it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:34,  7.14it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:33,  7.30it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:32,  7.58it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:32,  7.59it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:31,  7.66it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.54it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:32,  7.35it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:32,  7.35it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.31it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.40it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:31,  7.48it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.41it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.39it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.44it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.53it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.56it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.42it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.48it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:30,  7.44it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:30,  7.53it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.56it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.59it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:28,  7.82it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:28,  7.77it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:28,  7.72it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.62it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.44it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.43it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.35it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.44it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.41it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.49it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.44it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.55it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.57it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.60it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:27,  7.60it/s][A[INFO|trainer.py:570] 2024-04-21 17:11:14,222 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:11:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:11:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:11:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:11:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:11:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:11:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3968106944174271, 'eval_loss': 1.0236734, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 389, 545, 498, 513, 492, 419, 345, 225, 182, 193, 145], 'head_nums': [3, 3, 2, 1, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75791700, 'remaining_params': 9225900, 'pruned_model_sparsity': 0.8914824695121951, 'expected_sparsity': 0.88638, 'target_sparsity': 0.95, 'step': 25250}


Iteration:  22%|██▏       | 58/268 [00:11<02:30,  1.39it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<01:53,  1.84it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<01:27,  2.39it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<01:08,  3.01it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:56,  3.66it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:47,  4.36it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:40,  5.01it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:36,  5.51it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:34,  5.92it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:31,  6.36it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:30,  6.60it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:28,  6.91it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.13it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.31it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.61it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.66it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:25,  7.71it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:24,  7.91it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:24,  7.73it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:24,  7.80it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.79it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.75it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.63it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.69it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.57it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:24,  7.58it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.50it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.54it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.56it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.79it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.78it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.72it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.57it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.49it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.55it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:22,  7.59it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:22,  7.76it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:21,  7.88it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:21,  7.83it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:21,  7.81it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:21,  7.86it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.85it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:20,  7.95it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:20,  7.89it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.80it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.53it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:17<00:21,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 17:11:22,708 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:11:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:11:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:11:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:11:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:11:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:11:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38899362002004945, 'eval_loss': 1.0213219, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 389, 545, 496, 512, 492, 418, 345, 225, 182, 193, 145], 'head_nums': [3, 3, 2, 1, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75794760, 'remaining_params': 9222840, 'pruned_model_sparsity': 0.8915184620596206, 'expected_sparsity': 0.88643, 'target_sparsity': 0.95, 'step': 25300}


Iteration:  40%|████      | 108/268 [00:20<01:55,  1.39it/s][A04/21/2024 17:11:24 - INFO - trainer.trainer_mod - v4 Global step: 25300, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:20<01:27,  1.83it/s][A
Iteration:  41%|████      | 110/268 [00:20<01:06,  2.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:52,  2.97it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:42,  3.64it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:35,  4.32it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:30,  4.99it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:27,  5.53it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:25,  6.05it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:23,  6.38it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:22,  6.65it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:21,  6.98it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.18it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:19,  7.36it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:19,  7.47it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:18,  7.70it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:18,  7.68it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:18,  7.69it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:18,  7.67it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.56it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.61it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.62it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:19,  7.02it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.24it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.37it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:18,  7.46it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.54it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.74it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.70it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:16,  7.72it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.59it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.60it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.63it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.79it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.74it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.73it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.63it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:16,  7.56it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.57it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.59it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.71it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.72it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.68it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.60it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.60it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.62it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.68it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.71it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:14,  7.73it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.73it/s][A[INFO|trainer.py:570] 2024-04-21 17:11:31,242 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:11:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:11:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:11:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:11:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:11:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:11:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39944969052503376, 'eval_loss': 1.026974, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 388, 545, 495, 512, 492, 418, 345, 225, 182, 193, 145], 'head_nums': [3, 3, 2, 1, 3, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75796290, 'remaining_params': 9221310, 'pruned_model_sparsity': 0.8915364583333333, 'expected_sparsity': 0.88645, 'target_sparsity': 0.95, 'step': 25350}


Iteration:  59%|█████▉    | 158/268 [00:28<01:19,  1.39it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:59,  1.84it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:45,  2.39it/s][A
Iteration:  60%|██████    | 161/268 [00:28<00:35,  3.03it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:28,  3.70it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:23,  4.38it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:20,  4.99it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:18,  5.57it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:16,  6.06it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:15,  6.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:29<00:14,  6.84it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.17it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:13,  7.32it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:12,  7.51it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:13,  7.34it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.57it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.60it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.64it/s][A
Iteration:  66%|██████▌   | 176/268 [00:30<00:12,  7.60it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:11,  7.60it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:11,  7.67it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:11,  7.57it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:11,  7.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.62it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.63it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.62it/s][A
Iteration:  69%|██████▊   | 184/268 [00:31<00:10,  7.80it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:10,  7.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.78it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.58it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.45it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.35it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.43it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.49it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.48it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.30it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.30it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.43it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.38it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.60it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.62it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.39it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.49it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.57it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.63it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.68it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.57it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.59it/s][A
Iteration:  77%|███████▋  | 206/268 [00:34<00:08,  7.45it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.55it/s][A[INFO|trainer.py:570] 2024-04-21 17:11:39,791 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:11:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:11:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:11:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:11:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:11:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:11:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4018510441279232, 'eval_loss': 1.0418373, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 388, 545, 494, 512, 492, 418, 345, 225, 182, 193, 145], 'head_nums': [3, 3, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75794760, 'remaining_params': 9222840, 'pruned_model_sparsity': 0.8915184620596206, 'expected_sparsity': 0.88644, 'target_sparsity': 0.95, 'step': 25400}


Iteration:  78%|███████▊  | 208/268 [00:37<00:43,  1.39it/s][A04/21/2024 17:11:41 - INFO - trainer.trainer_mod - v4 Global step: 25400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:37<00:32,  1.82it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:24,  2.34it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:19,  2.98it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:15,  3.68it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:12,  4.28it/s][A
Iteration:  80%|███████▉  | 214/268 [00:37<00:11,  4.85it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:09,  5.50it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:08,  5.92it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  6.44it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:07,  6.87it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.08it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:06,  7.41it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.40it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.47it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.51it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.60it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.53it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.60it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.56it/s][A
Iteration:  85%|████████▌ | 229/268 [00:39<00:05,  7.59it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:04,  7.63it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.64it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.56it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.76it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.72it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.72it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.61it/s][A
Iteration:  88%|████████▊ | 237/268 [00:40<00:03,  7.84it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.79it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.90it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.98it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.88it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.68it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.58it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.59it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.60it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.58it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.47it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.51it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.57it/s][A
Iteration:  94%|█████████▍| 252/268 [00:42<00:02,  7.19it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  6.97it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.11it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.24it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.36it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.46it/s][A[INFO|trainer.py:570] 2024-04-21 17:11:48,370 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:11:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:11:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:11:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:11:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.14it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:11:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:11:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4000515327135508, 'eval_loss': 1.020311, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [365, 387, 545, 494, 512, 491, 418, 344, 225, 182, 193, 145], 'head_nums': [3, 3, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75797820, 'remaining_params': 9219780, 'pruned_model_sparsity': 0.8915544546070461, 'expected_sparsity': 0.8865, 'target_sparsity': 0.95, 'step': 25450}


Iteration:  96%|█████████▋| 258/268 [00:45<00:07,  1.38it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:04,  1.83it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:03,  2.36it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:02,  2.96it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:01,  3.61it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:01,  4.28it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  4.91it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  5.51it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  6.03it/s][A
Iteration: 100%|█████████▉| 267/268 [00:46<00:00,  6.28it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.01it/s][A04/21/2024 17:11:51 - INFO - trainer.trainer_mod - Epoch 94 finished. Took 47.06 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch:  95%|█████████▌| 95/100 [1:13:04<03:50, 46.08s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:32,  8.09it/s][A
Iteration:   1%|          | 2/268 [00:00<00:35,  7.59it/s][A
Iteration:   1%|          | 3/268 [00:00<00:35,  7.47it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:35,  7.36it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.49it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.61it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.66it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.65it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:35,  7.40it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.47it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.41it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.50it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.57it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.41it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.48it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.51it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.56it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.59it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.60it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.64it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:32,  7.63it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:32,  7.66it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:31,  7.68it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.45it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:31,  7.68it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:31,  7.64it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.64it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.62it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.54it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:31,  7.60it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:30,  7.65it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:30,  7.64it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:30,  7.66it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:30,  7.63it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:30,  7.59it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:30,  7.58it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:30,  7.62it/s][A
Iteration:  14%|█▍        | 38/268 [00:05<00:30,  7.63it/s][A
Iteration:  15%|█▍        | 39/268 [00:05<00:29,  7.82it/s][A[INFO|trainer.py:570] 2024-04-21 17:11:56,907 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:11:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:11:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:11:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:11:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:11:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:11:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39057368837569445, 'eval_loss': 1.0269351, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 386, 544, 493, 511, 491, 417, 344, 225, 182, 194, 145], 'head_nums': [3, 3, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75803940, 'remaining_params': 9213660, 'pruned_model_sparsity': 0.891626439701897, 'expected_sparsity': 0.88652, 'target_sparsity': 0.95, 'step': 25500}


Iteration:  15%|█▍        | 40/268 [00:07<02:43,  1.40it/s][A04/21/2024 17:11:58 - INFO - trainer.trainer_mod - v4 Global step: 25500, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:07<02:02,  1.85it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<01:33,  2.41it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<01:14,  3.00it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<01:00,  3.68it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:51,  4.36it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:45,  4.91it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:40,  5.40it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:37,  5.94it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:34,  6.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:31,  6.82it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:31,  6.91it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:30,  7.03it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:30,  7.16it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:29,  7.29it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.41it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.43it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.44it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.47it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.41it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.31it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.60it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.61it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.24it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.48it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.55it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.39it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.46it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.51it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:25,  7.56it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.51it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.59it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.59it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.62it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:24,  7.76it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:24,  7.65it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.42it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.42it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.34it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:25,  7.33it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:24,  7.65it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.65it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:23,  7.64it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:23,  7.66it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:23,  7.69it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:23,  7.71it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:23,  7.59it/s][A[INFO|trainer.py:570] 2024-04-21 17:12:05,502 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:12:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:12:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:12:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:12:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 16.99it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.02it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:12:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:12:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4021057428931729, 'eval_loss': 1.0508019, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 386, 544, 492, 510, 490, 417, 344, 225, 182, 193, 145], 'head_nums': [3, 3, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75807000, 'remaining_params': 9210600, 'pruned_model_sparsity': 0.8916624322493225, 'expected_sparsity': 0.88658, 'target_sparsity': 0.95, 'step': 25550}


Iteration:  34%|███▎      | 90/268 [00:15<02:07,  1.39it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<01:35,  1.84it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<01:14,  2.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:58,  2.99it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:47,  3.65it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:41,  4.14it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:35,  4.80it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:31,  5.35it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:28,  5.91it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:26,  6.32it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:25,  6.67it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:24,  6.77it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:24,  6.88it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:23,  6.97it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.31it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:22,  7.31it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.38it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.47it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.41it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.62it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.63it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.64it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.62it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.53it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.59it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.50it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.68it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.77it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.76it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.74it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.75it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.64it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:19,  7.63it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:19,  7.49it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:19,  7.53it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.60it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.53it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.47it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.51it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.56it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:17,  7.73it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:17,  7.71it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.69it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.60it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.53it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.48it/s][A
Iteration:  51%|█████     | 136/268 [00:21<00:17,  7.56it/s][A
Iteration:  51%|█████     | 137/268 [00:22<00:17,  7.60it/s][A
Iteration:  51%|█████▏    | 138/268 [00:22<00:17,  7.48it/s][A
Iteration:  52%|█████▏    | 139/268 [00:22<00:17,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 17:12:14,108 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:12:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:12:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:12:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:12:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:12:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:12:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3968106944174271, 'eval_loss': 1.0539895, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 385, 544, 490, 510, 490, 417, 344, 225, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75807000, 'remaining_params': 9210600, 'pruned_model_sparsity': 0.8916624322493225, 'expected_sparsity': 0.88664, 'target_sparsity': 0.95, 'step': 25600}


Iteration:  52%|█████▏    | 140/268 [00:24<01:32,  1.39it/s][A04/21/2024 17:12:16 - INFO - trainer.trainer_mod - v4 Global step: 25600, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:24<01:08,  1.85it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:52,  2.39it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:41,  2.99it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:33,  3.66it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:28,  4.28it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:24,  4.93it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:21,  5.52it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:20,  5.97it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:18,  6.43it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:17,  6.75it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:16,  7.17it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.29it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.37it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.45it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.41it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.38it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.51it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.69it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.71it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.68it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.70it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.62it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.41it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.60it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.63it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.76it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:12,  7.77it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.53it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:12,  7.68it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.70it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:12,  7.64it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.69it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.71it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.59it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.64it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:11,  7.63it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:11,  7.78it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.65it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.55it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 182/268 [00:29<00:11,  7.45it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:11,  7.44it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:11,  7.39it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 186/268 [00:30<00:10,  7.56it/s][A
Iteration:  70%|██████▉   | 187/268 [00:30<00:10,  7.79it/s][A
Iteration:  70%|███████   | 188/268 [00:30<00:10,  7.63it/s][A
Iteration:  71%|███████   | 189/268 [00:30<00:10,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 17:12:22,635 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:12:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:12:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:12:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:12:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.06it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:12:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:12:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4023774765912522, 'eval_loss': 1.062343, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 384, 543, 489, 509, 489, 416, 344, 225, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75813120, 'remaining_params': 9204480, 'pruned_model_sparsity': 0.8917344173441735, 'expected_sparsity': 0.88669, 'target_sparsity': 0.95, 'step': 25650}


Iteration:  71%|███████   | 190/268 [00:32<00:56,  1.39it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:41,  1.84it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:32,  2.37it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:25,  2.99it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:20,  3.66it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:16,  4.31it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:14,  4.89it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:12,  5.47it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:11,  6.07it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:10,  6.56it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  6.94it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.01it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:09,  7.19it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.26it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.36it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.45it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.66it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.60it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.57it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.59it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.59it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.46it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.49it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.54it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.56it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.48it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.39it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.46it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:07,  7.11it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.27it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.39it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.60it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:06,  7.60it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.66it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.70it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.69it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.68it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.69it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.67it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.58it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.54it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.51it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.59it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.64it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.65it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 236/268 [00:39<00:04,  7.62it/s][A
Iteration:  88%|████████▊ | 237/268 [00:39<00:04,  7.63it/s][A
Iteration:  89%|████████▉ | 238/268 [00:39<00:03,  7.56it/s][A
Iteration:  89%|████████▉ | 239/268 [00:39<00:03,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 17:12:31,221 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:12:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:12:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:12:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:12:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.24it/s]04/21/2024 17:12:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:12:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39572141960523277, 'eval_loss': 1.0613502, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 383, 543, 488, 509, 489, 416, 344, 225, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75813120, 'remaining_params': 9204480, 'pruned_model_sparsity': 0.8917344173441735, 'expected_sparsity': 0.88673, 'target_sparsity': 0.95, 'step': 25700}


Iteration:  90%|████████▉ | 240/268 [00:41<00:20,  1.38it/s][A04/21/2024 17:12:33 - INFO - trainer.trainer_mod - v4 Global step: 25700, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [00:41<00:14,  1.82it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:11,  2.35it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:08,  2.96it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:06,  3.61it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:05,  4.28it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:04,  4.91it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:03,  5.39it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:03,  5.87it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  6.35it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  6.71it/s][A
Iteration:  94%|█████████▎| 251/268 [00:43<00:02,  6.96it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.32it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.24it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.36it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.41it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.50it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.38it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.37it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.45it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.51it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.70it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.59it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.61it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.65it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.62it/s][A
Iteration: 100%|██████████| 268/268 [00:45<00:00,  8.17it/s][A04/21/2024 17:12:36 - INFO - trainer.trainer_mod - Epoch 95 finished. Took 45.23 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.93it/s]
Epoch:  96%|█████████▌| 96/100 [1:13:50<03:03, 45.82s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:37,  7.18it/s][A
Iteration:   1%|          | 2/268 [00:00<00:38,  6.96it/s][A
Iteration:   1%|          | 3/268 [00:00<00:36,  7.25it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.55it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:35,  7.51it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.79it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.88it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:33,  7.84it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:32,  7.92it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:32,  7.83it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.77it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.74it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:32,  7.85it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:32,  7.76it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:32,  7.76it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.64it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:32,  7.68it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:32,  7.81it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.74it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:32,  7.75it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:31,  7.76it/s][A[INFO|trainer.py:570] 2024-04-21 17:12:39,720 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:12:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:12:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:12:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:12:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:12:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:12:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39452257636680016, 'eval_loss': 1.0432483, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 383, 543, 487, 508, 489, 416, 343, 225, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75816180, 'remaining_params': 9201420, 'pruned_model_sparsity': 0.891770409891599, 'expected_sparsity': 0.88677, 'target_sparsity': 0.95, 'step': 25750}


Iteration:   8%|▊         | 22/268 [00:04<02:55,  1.40it/s][A
Iteration:   9%|▊         | 23/268 [00:04<02:12,  1.85it/s][A
Iteration:   9%|▉         | 24/268 [00:05<01:41,  2.39it/s][A
Iteration:   9%|▉         | 25/268 [00:05<01:21,  2.98it/s][A
Iteration:  10%|▉         | 26/268 [00:05<01:07,  3.60it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:55,  4.35it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:48,  4.99it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:42,  5.57it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:39,  6.05it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:37,  6.36it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:35,  6.68it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:34,  6.87it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:33,  6.97it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:32,  7.09it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:32,  7.23it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:31,  7.25it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:31,  7.31it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.38it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:31,  7.28it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.49it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:29,  7.54it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.61it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:29,  7.48it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.50it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.46it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:30,  7.35it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.37it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.42it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.64it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.66it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.50it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.52it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.56it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.53it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.49it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.44it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.53it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.57it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.51it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.54it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.76it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.76it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.73it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.67it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.67it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.62it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.56it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 17:12:48,330 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:12:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:12:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:12:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:12:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.12it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.11it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.28it/s]04/21/2024 17:12:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:12:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39745362806120205, 'eval_loss': 1.0518533, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 383, 543, 487, 508, 489, 416, 344, 225, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75814650, 'remaining_params': 9202950, 'pruned_model_sparsity': 0.8917524136178862, 'expected_sparsity': 0.88677, 'target_sparsity': 0.95, 'step': 25800}


Iteration:  27%|██▋       | 72/268 [00:13<02:21,  1.39it/s][A04/21/2024 17:12:50 - INFO - trainer.trainer_mod - v4 Global step: 25800, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:13<01:45,  1.84it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<01:21,  2.39it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<01:04,  3.01it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:52,  3.68it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:44,  4.33it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:38,  4.94it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:34,  5.50it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:31,  6.01it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:31,  6.01it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:28,  6.43it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:27,  6.67it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:26,  6.91it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:25,  7.24it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:24,  7.38it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:24,  7.47it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.53it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.46it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.48it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.40it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.35it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.38it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.38it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.38it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.66it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.67it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.65it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.63it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.64it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.70it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.66it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.68it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.67it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.69it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.52it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.57it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.62it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.66it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.68it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.70it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.57it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.59it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.61it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:19,  7.65it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.67it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.53it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:20,  7.45it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.49it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.67it/s][A[INFO|trainer.py:570] 2024-04-21 17:12:56,910 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:12:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:12:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:12:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:12:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.04it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:12:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:12:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.4032903585162871, 'eval_loss': 1.0642456, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 382, 543, 485, 508, 489, 416, 343, 225, 182, 194, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75816180, 'remaining_params': 9201420, 'pruned_model_sparsity': 0.891770409891599, 'expected_sparsity': 0.88682, 'target_sparsity': 0.95, 'step': 25850}


Iteration:  46%|████▌     | 122/268 [00:21<01:45,  1.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<01:19,  1.83it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<01:01,  2.36it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:48,  2.96it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:38,  3.66it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:32,  4.33it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:28,  4.91it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:25,  5.35it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:23,  5.89it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:21,  6.34it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:20,  6.77it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:19,  7.00it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:18,  7.20it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:18,  7.23it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:18,  7.30it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:17,  7.39it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.38it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:17,  7.41it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:17,  7.40it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.62it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:17,  7.39it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:17,  7.11it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.43it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.39it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.46it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.66it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.67it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.67it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.65it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.70it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:14,  7.91it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:14,  7.80it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:14,  7.61it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.44it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.54it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.50it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:14,  7.57it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.44it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:13,  7.73it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:14,  7.48it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.54it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.58it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.59it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.62it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:13,  7.66it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.48it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:12,  7.53it/s][A[INFO|trainer.py:570] 2024-04-21 17:13:05,502 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:13:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:13:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:13:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:13:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:13:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:13:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.40037618010589204, 'eval_loss': 1.0621985, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [363, 382, 542, 484, 507, 488, 415, 343, 225, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75823830, 'remaining_params': 9193770, 'pruned_model_sparsity': 0.8918603912601626, 'expected_sparsity': 0.88687, 'target_sparsity': 0.95, 'step': 25900}


Iteration:  64%|██████▍   | 172/268 [00:30<01:08,  1.39it/s][A04/21/2024 17:13:07 - INFO - trainer.trainer_mod - v4 Global step: 25900, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:30<00:51,  1.84it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:39,  2.38it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:31,  2.98it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:25,  3.65it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:21,  4.30it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:17,  5.02it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:15,  5.69it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:14,  6.15it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:13,  6.55it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:12,  6.78it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:12,  6.85it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.09it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.26it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.29it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.33it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.41it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.51it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.55it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.60it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.54it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.49it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.55it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.60it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.79it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.78it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.76it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.33it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.25it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.36it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.37it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.31it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.40it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.32it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.28it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.42it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.39it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.48it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.31it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.54it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.58it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.74it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.62it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.66it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.55it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.61it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.62it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.64it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.66it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.71it/s][A[INFO|trainer.py:570] 2024-04-21 17:13:14,084 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:13:14 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:13:14 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:13:14 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:13:14 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.01it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.07it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:13:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:13:16 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39572141960523277, 'eval_loss': 1.0901468, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 381, 542, 483, 507, 488, 415, 343, 225, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75822300, 'remaining_params': 9195300, 'pruned_model_sparsity': 0.8918423949864499, 'expected_sparsity': 0.8869, 'target_sparsity': 0.95, 'step': 25950}


Iteration:  83%|████████▎ | 222/268 [00:39<00:32,  1.39it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:24,  1.85it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:18,  2.37it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:14,  2.99it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:11,  3.67it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:09,  4.29it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:08,  4.93it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:06,  5.59it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:06,  6.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  6.52it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:05,  6.80it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:05,  6.90it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.24it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.37it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.56it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.58it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.57it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.41it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.46it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.51it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.41it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.66it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.72it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:02,  7.86it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.68it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.39it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.46it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.51it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.51it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.58it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.64it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.63it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.78it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.75it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.86it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.83it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.75it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.72it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.71it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.70it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.89it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.99it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.85it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.67it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.81it/s][A04/21/2024 17:13:22 - INFO - trainer.trainer_mod - Epoch 96 finished. Took 45.14 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.94it/s]
Epoch:  97%|█████████▋| 97/100 [1:14:35<02:16, 45.62s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:31,  8.38it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  8.02it/s][A
Iteration:   1%|          | 3/268 [00:00<00:33,  7.87it/s][A[INFO|trainer.py:570] 2024-04-21 17:13:22,524 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:13:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:13:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:13:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:13:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.28it/s]04/21/2024 17:13:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:13:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39418850983928566, 'eval_loss': 1.0677679, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [364, 380, 542, 482, 508, 488, 415, 343, 225, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75820770, 'remaining_params': 9196830, 'pruned_model_sparsity': 0.8918243987127371, 'expected_sparsity': 0.88687, 'target_sparsity': 0.95, 'step': 26000}


Iteration:   1%|▏         | 4/268 [00:02<03:57,  1.11it/s][A04/21/2024 17:13:24 - INFO - trainer.trainer_mod - v4 Global step: 26000, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:02<02:43,  1.61it/s][A
Iteration:   2%|▏         | 6/268 [00:02<01:59,  2.20it/s][A
Iteration:   3%|▎         | 7/268 [00:02<01:31,  2.87it/s][A
Iteration:   3%|▎         | 8/268 [00:02<01:13,  3.56it/s][A
Iteration:   3%|▎         | 9/268 [00:03<01:00,  4.27it/s][A
Iteration:   4%|▎         | 10/268 [00:03<00:52,  4.90it/s][A
Iteration:   4%|▍         | 11/268 [00:03<00:45,  5.61it/s][A
Iteration:   4%|▍         | 12/268 [00:03<00:43,  5.95it/s][A
Iteration:   5%|▍         | 13/268 [00:03<00:40,  6.36it/s][A
Iteration:   5%|▌         | 14/268 [00:03<00:37,  6.70it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:37,  6.81it/s][A
Iteration:   6%|▌         | 16/268 [00:04<00:36,  6.86it/s][A
Iteration:   6%|▋         | 17/268 [00:04<00:35,  7.04it/s][A
Iteration:   7%|▋         | 18/268 [00:04<00:34,  7.25it/s][A
Iteration:   7%|▋         | 19/268 [00:04<00:33,  7.39it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:33,  7.46it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:32,  7.50it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:33,  7.39it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:32,  7.45it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:32,  7.55it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:32,  7.38it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:33,  7.33it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:33,  7.30it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:32,  7.32it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:32,  7.43it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:32,  7.41it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:31,  7.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:31,  7.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.48it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.55it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:30,  7.58it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:30,  7.60it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.60it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:31,  7.40it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:31,  7.30it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.37it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.36it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.43it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.54it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:28,  7.77it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:29,  7.60it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:29,  7.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:28,  7.66it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.56it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:28,  7.70it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:28,  7.71it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.74it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:28,  7.60it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.62it/s][A[INFO|trainer.py:570] 2024-04-21 17:13:31,135 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:13:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:13:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:13:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:13:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:13:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:13:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.391243912243602, 'eval_loss': 1.0681971, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [363, 379, 542, 481, 507, 488, 415, 343, 224, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75825360, 'remaining_params': 9192240, 'pruned_model_sparsity': 0.8918783875338754, 'expected_sparsity': 0.88692, 'target_sparsity': 0.95, 'step': 26050}


Iteration:  20%|██        | 54/268 [00:11<02:34,  1.39it/s][A
Iteration:  21%|██        | 55/268 [00:11<01:55,  1.84it/s][A
Iteration:  21%|██        | 56/268 [00:11<01:28,  2.39it/s][A
Iteration:  21%|██▏       | 57/268 [00:11<01:09,  3.03it/s][A
Iteration:  22%|██▏       | 58/268 [00:11<00:56,  3.70it/s][A
Iteration:  22%|██▏       | 59/268 [00:11<00:47,  4.38it/s][A
Iteration:  22%|██▏       | 60/268 [00:11<00:41,  5.02it/s][A
Iteration:  23%|██▎       | 61/268 [00:11<00:36,  5.63it/s][A
Iteration:  23%|██▎       | 62/268 [00:12<00:33,  6.13it/s][A
Iteration:  24%|██▎       | 63/268 [00:12<00:31,  6.42it/s][A
Iteration:  24%|██▍       | 64/268 [00:12<00:30,  6.77it/s][A
Iteration:  24%|██▍       | 65/268 [00:12<00:29,  6.92it/s][A
Iteration:  25%|██▍       | 66/268 [00:12<00:28,  7.02it/s][A
Iteration:  25%|██▌       | 67/268 [00:12<00:28,  7.03it/s][A
Iteration:  25%|██▌       | 68/268 [00:12<00:28,  7.10it/s][A
Iteration:  26%|██▌       | 69/268 [00:13<00:27,  7.29it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<00:27,  7.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<00:26,  7.39it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:26,  7.37it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:25,  7.52it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:25,  7.55it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:26,  7.19it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:25,  7.52it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:25,  7.57it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:24,  7.64it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:24,  7.57it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:24,  7.56it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:24,  7.60it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.64it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.66it/s][A
Iteration:  31%|███▏      | 84/268 [00:15<00:23,  7.68it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.55it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.60it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.65it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.68it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:23,  7.65it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.63it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.54it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.37it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.53it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.42it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:22,  7.51it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:22,  7.47it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.46it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.50it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.55it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.44it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.49it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.66it/s][A[INFO|trainer.py:570] 2024-04-21 17:13:39,709 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:13:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:13:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:13:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:13:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.02it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:13:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:13:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38829041352339694, 'eval_loss': 1.0784495, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [363, 378, 541, 480, 506, 487, 415, 343, 224, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75829950, 'remaining_params': 9187650, 'pruned_model_sparsity': 0.8919323763550135, 'expected_sparsity': 0.88699, 'target_sparsity': 0.95, 'step': 26100}


Iteration:  39%|███▉      | 104/268 [00:19<01:57,  1.39it/s][A04/21/2024 17:13:41 - INFO - trainer.trainer_mod - v4 Global step: 26100, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:19<01:28,  1.84it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<01:07,  2.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:20<00:53,  3.00it/s][A
Iteration:  40%|████      | 108/268 [00:20<00:43,  3.67it/s][A
Iteration:  41%|████      | 109/268 [00:20<00:37,  4.27it/s][A
Iteration:  41%|████      | 110/268 [00:20<00:31,  4.98it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:28,  5.49it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:26,  5.99it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:24,  6.40it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:22,  6.72it/s][A
Iteration:  43%|████▎     | 115/268 [00:21<00:22,  6.90it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:21,  7.00it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:21,  7.17it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:20,  7.22it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:20,  7.35it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:20,  7.36it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:20,  7.33it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:19,  7.33it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:19,  7.61it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:19,  7.54it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:19,  7.47it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:18,  7.54it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:18,  7.57it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:18,  7.59it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:18,  7.60it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:18,  7.65it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:17,  7.67it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:17,  7.69it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.68it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.51it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.54it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.58it/s][A
Iteration:  51%|█████     | 137/268 [00:24<00:16,  7.82it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:16,  7.78it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.73it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.83it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.91it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.83it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.77it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:16,  7.61it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:16,  7.64it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:15,  7.78it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:15,  7.78it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.67it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:15,  7.70it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.72it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.50it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.53it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 17:13:48,239 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:13:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:13:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:13:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:13:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.09it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.28it/s]04/21/2024 17:13:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:13:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38829041352339694, 'eval_loss': 1.080308, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [363, 378, 541, 479, 506, 487, 415, 343, 224, 182, 193, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75829950, 'remaining_params': 9187650, 'pruned_model_sparsity': 0.8919323763550135, 'expected_sparsity': 0.88702, 'target_sparsity': 0.95, 'step': 26150}


Iteration:  57%|█████▋    | 154/268 [00:28<01:21,  1.40it/s][A
Iteration:  58%|█████▊    | 155/268 [00:28<01:00,  1.86it/s][A
Iteration:  58%|█████▊    | 156/268 [00:28<00:46,  2.39it/s][A
Iteration:  59%|█████▊    | 157/268 [00:28<00:36,  3.01it/s][A
Iteration:  59%|█████▉    | 158/268 [00:28<00:29,  3.69it/s][A
Iteration:  59%|█████▉    | 159/268 [00:28<00:25,  4.35it/s][A
Iteration:  60%|█████▉    | 160/268 [00:28<00:21,  4.99it/s][A
Iteration:  60%|██████    | 161/268 [00:29<00:19,  5.59it/s][A
Iteration:  60%|██████    | 162/268 [00:29<00:17,  6.06it/s][A
Iteration:  61%|██████    | 163/268 [00:29<00:15,  6.62it/s][A
Iteration:  61%|██████    | 164/268 [00:29<00:15,  6.88it/s][A
Iteration:  62%|██████▏   | 165/268 [00:29<00:14,  7.24it/s][A
Iteration:  62%|██████▏   | 166/268 [00:29<00:14,  6.81it/s][A
Iteration:  62%|██████▏   | 167/268 [00:29<00:14,  7.05it/s][A
Iteration:  63%|██████▎   | 168/268 [00:30<00:13,  7.23it/s][A
Iteration:  63%|██████▎   | 169/268 [00:30<00:13,  7.45it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:12,  7.69it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:12,  7.69it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:12,  7.70it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:12,  7.57it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:12,  7.60it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:12,  7.62it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:12,  7.55it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:12,  7.35it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:12,  7.44it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:12,  7.34it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.31it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:11,  7.41it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.48it/s][A
Iteration:  68%|██████▊   | 183/268 [00:32<00:11,  7.55it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.48it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.51it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:11,  7.41it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:11,  7.31it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.45it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.35it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.48it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:10,  7.65it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.57it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:09,  7.51it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:10,  7.38it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.67it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.60it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.51it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.67it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.63it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.55it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.75it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.54it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.59it/s][A[INFO|trainer.py:570] 2024-04-21 17:13:56,816 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:13:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:13:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:13:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:13:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.09it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:13:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:13:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3915828968181581, 'eval_loss': 1.0567788, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [363, 377, 540, 478, 505, 486, 415, 343, 224, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75834540, 'remaining_params': 9183060, 'pruned_model_sparsity': 0.8919863651761517, 'expected_sparsity': 0.88706, 'target_sparsity': 0.95, 'step': 26200}


Iteration:  76%|███████▌  | 204/268 [00:36<00:46,  1.39it/s][A04/21/2024 17:13:58 - INFO - trainer.trainer_mod - v4 Global step: 26200, Alignment: tensor([0, 1, 2, 8], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:36<00:34,  1.84it/s][A
Iteration:  77%|███████▋  | 206/268 [00:37<00:26,  2.38it/s][A
Iteration:  77%|███████▋  | 207/268 [00:37<00:20,  3.00it/s][A
Iteration:  78%|███████▊  | 208/268 [00:37<00:16,  3.62it/s][A
Iteration:  78%|███████▊  | 209/268 [00:37<00:13,  4.28it/s][A
Iteration:  78%|███████▊  | 210/268 [00:37<00:12,  4.83it/s][A
Iteration:  79%|███████▊  | 211/268 [00:37<00:10,  5.37it/s][A
Iteration:  79%|███████▉  | 212/268 [00:37<00:09,  5.98it/s][A
Iteration:  79%|███████▉  | 213/268 [00:37<00:08,  6.40it/s][A
Iteration:  80%|███████▉  | 214/268 [00:38<00:08,  6.73it/s][A
Iteration:  80%|████████  | 215/268 [00:38<00:07,  6.97it/s][A
Iteration:  81%|████████  | 216/268 [00:38<00:07,  7.09it/s][A
Iteration:  81%|████████  | 217/268 [00:38<00:07,  7.05it/s][A
Iteration:  81%|████████▏ | 218/268 [00:38<00:06,  7.24it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:06,  7.37it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:06,  7.43it/s][A
Iteration:  82%|████████▏ | 221/268 [00:39<00:06,  7.50it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:06,  7.42it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:06,  7.37it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:05,  7.36it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:05,  7.43it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:05,  7.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:05,  7.63it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  7.66it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  7.65it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.44it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:04,  7.67it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.54it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.58it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.58it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.58it/s][A
Iteration:  88%|████████▊ | 236/268 [00:41<00:04,  7.59it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.74it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.74it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.64it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.79it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.78it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.34it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.47it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  7.57it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.58it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.75it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.72it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.71it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.70it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.88it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.82it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.80it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.79it/s][A[INFO|trainer.py:570] 2024-04-21 17:14:05,357 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:14:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:14:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:14:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:14:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.04it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 16.97it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:14:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:14:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.38899362002004945, 'eval_loss': 1.0547907, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [363, 376, 540, 477, 505, 486, 415, 342, 224, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75836070, 'remaining_params': 9181530, 'pruned_model_sparsity': 0.8920043614498645, 'expected_sparsity': 0.88708, 'target_sparsity': 0.95, 'step': 26250}


Iteration:  95%|█████████▍| 254/268 [00:45<00:10,  1.40it/s][A
Iteration:  95%|█████████▌| 255/268 [00:45<00:07,  1.85it/s][A
Iteration:  96%|█████████▌| 256/268 [00:45<00:05,  2.39it/s][A
Iteration:  96%|█████████▌| 257/268 [00:45<00:03,  3.01it/s][A
Iteration:  96%|█████████▋| 258/268 [00:45<00:02,  3.66it/s][A
Iteration:  97%|█████████▋| 259/268 [00:45<00:02,  4.33it/s][A
Iteration:  97%|█████████▋| 260/268 [00:46<00:01,  4.99it/s][A
Iteration:  97%|█████████▋| 261/268 [00:46<00:01,  5.52it/s][A
Iteration:  98%|█████████▊| 262/268 [00:46<00:01,  5.96it/s][A
Iteration:  98%|█████████▊| 263/268 [00:46<00:00,  6.37it/s][A
Iteration:  99%|█████████▊| 264/268 [00:46<00:00,  6.64it/s][A
Iteration:  99%|█████████▉| 265/268 [00:46<00:00,  6.85it/s][A
Iteration:  99%|█████████▉| 266/268 [00:46<00:00,  7.00it/s][A
Iteration: 100%|█████████▉| 267/268 [00:47<00:00,  7.19it/s][A
Iteration: 100%|██████████| 268/268 [00:47<00:00,  7.80it/s][A04/21/2024 17:14:09 - INFO - trainer.trainer_mod - Epoch 97 finished. Took 47.14 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.68it/s]
Epoch:  98%|█████████▊| 98/100 [1:15:22<01:32, 46.08s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:35,  7.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:33,  7.82it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.75it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.58it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:34,  7.62it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:34,  7.59it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:34,  7.54it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:34,  7.57it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.58it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:33,  7.67it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.58it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:34,  7.47it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:33,  7.56it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:33,  7.59it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.61it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:32,  7.65it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.56it/s][A
Iteration:   7%|▋         | 18/268 [00:02<00:33,  7.56it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:32,  7.58it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:33,  7.38it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:34,  7.21it/s][A
Iteration:   8%|▊         | 22/268 [00:02<00:33,  7.25it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:32,  7.56it/s][A
Iteration:   9%|▉         | 24/268 [00:03<00:32,  7.61it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:32,  7.50it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.56it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:31,  7.76it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:31,  7.73it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:31,  7.69it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:30,  7.72it/s][A
Iteration:  12%|█▏        | 31/268 [00:04<00:32,  7.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:04<00:32,  7.27it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:32,  7.24it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:31,  7.38it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:31,  7.50it/s][A[INFO|trainer.py:570] 2024-04-21 17:14:13,942 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:14:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:14:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:14:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:14:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:14:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:14:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3935676342577081, 'eval_loss': 1.0644208, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [363, 376, 540, 477, 505, 486, 414, 342, 224, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75837600, 'remaining_params': 9180000, 'pruned_model_sparsity': 0.8920223577235772, 'expected_sparsity': 0.88712, 'target_sparsity': 0.95, 'step': 26300}


Iteration:  13%|█▎        | 36/268 [00:06<02:47,  1.39it/s][A04/21/2024 17:14:15 - INFO - trainer.trainer_mod - v4 Global step: 26300, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:06<02:05,  1.85it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<01:36,  2.39it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<01:16,  3.01it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<01:02,  3.66it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:52,  4.34it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:45,  4.95it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:40,  5.55it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:36,  6.19it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:33,  6.60it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:32,  6.76it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:31,  7.02it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:30,  7.13it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.32it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.45it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:29,  7.39it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.37it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.50it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.54it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.48it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:28,  7.52it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.47it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:28,  7.44it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:28,  7.33it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:28,  7.31it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:28,  7.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:28,  7.30it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:27,  7.39it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:27,  7.43it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:27,  7.48it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.51it/s][A
Iteration:  25%|██▌       | 68/268 [00:10<00:26,  7.54it/s][A
Iteration:  26%|██▌       | 69/268 [00:11<00:26,  7.54it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:26,  7.56it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:26,  7.48it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:26,  7.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:25,  7.50it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:25,  7.56it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:25,  7.56it/s][A
Iteration:  28%|██▊       | 76/268 [00:12<00:25,  7.40it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:25,  7.51it/s][A
Iteration:  29%|██▉       | 78/268 [00:12<00:25,  7.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:25,  7.32it/s][A
Iteration:  30%|██▉       | 80/268 [00:12<00:25,  7.42it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:25,  7.47it/s][A
Iteration:  31%|███       | 82/268 [00:12<00:24,  7.56it/s][A
Iteration:  31%|███       | 83/268 [00:13<00:25,  7.34it/s][A
Iteration:  31%|███▏      | 84/268 [00:13<00:24,  7.46it/s][A
Iteration:  32%|███▏      | 85/268 [00:13<00:24,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 17:14:22,550 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:14:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:14:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:14:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:14:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:14:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:14:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.391243912243602, 'eval_loss': 1.0616541, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [362, 375, 540, 476, 505, 485, 414, 342, 224, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75840660, 'remaining_params': 9176940, 'pruned_model_sparsity': 0.8920583502710027, 'expected_sparsity': 0.88716, 'target_sparsity': 0.95, 'step': 26350}


Iteration:  32%|███▏      | 86/268 [00:15<02:11,  1.39it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<01:38,  1.84it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<01:15,  2.38it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<01:00,  2.97it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:48,  3.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:16<00:41,  4.30it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:35,  4.97it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:31,  5.56it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:28,  6.01it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:26,  6.54it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:24,  6.89it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:24,  7.11it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:23,  7.26it/s][A
Iteration:  37%|███▋      | 99/268 [00:17<00:22,  7.37it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.45it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:22,  7.37it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:22,  7.32it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:22,  7.45it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:22,  7.38it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.60it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.60it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.64it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.55it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:20,  7.58it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.63it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.59it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:20,  7.53it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.61it/s][A
Iteration:  43%|████▎     | 114/268 [00:19<00:20,  7.65it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.54it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.45it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:20,  7.51it/s][A
Iteration:  44%|████▍     | 118/268 [00:19<00:19,  7.56it/s][A
Iteration:  44%|████▍     | 119/268 [00:19<00:19,  7.61it/s][A
Iteration:  45%|████▍     | 120/268 [00:19<00:19,  7.60it/s][A
Iteration:  45%|████▌     | 121/268 [00:19<00:19,  7.61it/s][A
Iteration:  46%|████▌     | 122/268 [00:20<00:18,  7.82it/s][A
Iteration:  46%|████▌     | 123/268 [00:20<00:18,  7.66it/s][A
Iteration:  46%|████▋     | 124/268 [00:20<00:18,  7.67it/s][A
Iteration:  47%|████▋     | 125/268 [00:20<00:18,  7.78it/s][A
Iteration:  47%|████▋     | 126/268 [00:20<00:18,  7.74it/s][A
Iteration:  47%|████▋     | 127/268 [00:20<00:18,  7.76it/s][A
Iteration:  48%|████▊     | 128/268 [00:20<00:18,  7.63it/s][A
Iteration:  48%|████▊     | 129/268 [00:21<00:18,  7.64it/s][A
Iteration:  49%|████▊     | 130/268 [00:21<00:18,  7.66it/s][A
Iteration:  49%|████▉     | 131/268 [00:21<00:18,  7.56it/s][A
Iteration:  49%|████▉     | 132/268 [00:21<00:17,  7.58it/s][A
Iteration:  50%|████▉     | 133/268 [00:21<00:17,  7.52it/s][A
Iteration:  50%|█████     | 134/268 [00:21<00:17,  7.70it/s][A
Iteration:  50%|█████     | 135/268 [00:21<00:17,  7.68it/s][A[INFO|trainer.py:570] 2024-04-21 17:14:31,085 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:14:31 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:14:31 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:14:31 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:14:31 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:14:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:14:33 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39572141960523277, 'eval_loss': 1.0555472, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [362, 376, 539, 475, 504, 485, 414, 342, 224, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75843720, 'remaining_params': 9173880, 'pruned_model_sparsity': 0.8920943428184281, 'expected_sparsity': 0.88719, 'target_sparsity': 0.95, 'step': 26400}


Iteration:  51%|█████     | 136/268 [00:23<01:34,  1.39it/s][A04/21/2024 17:14:33 - INFO - trainer.trainer_mod - v4 Global step: 26400, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:24<01:11,  1.83it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:55,  2.35it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:43,  2.96it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:35,  3.60it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:29,  4.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:25,  4.89it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:23,  5.43it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:20,  5.93it/s][A
Iteration:  54%|█████▍    | 145/268 [00:25<00:19,  6.42it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:18,  6.66it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:17,  6.98it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:16,  7.07it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.23it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:16,  6.98it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:16,  7.28it/s][A
Iteration:  57%|█████▋    | 152/268 [00:26<00:15,  7.40it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.22it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.35it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.43it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.35it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:14,  7.46it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.56it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.76it/s][A
Iteration:  60%|█████▉    | 160/268 [00:27<00:13,  7.75it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:13,  7.70it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.45it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.52it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.62it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.55it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.61it/s][A
Iteration:  62%|██████▏   | 167/268 [00:28<00:13,  7.49it/s][A
Iteration:  63%|██████▎   | 168/268 [00:28<00:12,  7.74it/s][A
Iteration:  63%|██████▎   | 169/268 [00:28<00:13,  7.14it/s][A
Iteration:  63%|██████▎   | 170/268 [00:28<00:13,  7.19it/s][A
Iteration:  64%|██████▍   | 171/268 [00:28<00:13,  7.36it/s][A
Iteration:  64%|██████▍   | 172/268 [00:28<00:13,  7.26it/s][A
Iteration:  65%|██████▍   | 173/268 [00:28<00:12,  7.42it/s][A
Iteration:  65%|██████▍   | 174/268 [00:28<00:12,  7.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:29<00:12,  7.54it/s][A
Iteration:  66%|██████▌   | 176/268 [00:29<00:12,  7.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:29<00:12,  7.45it/s][A
Iteration:  66%|██████▋   | 178/268 [00:29<00:12,  7.31it/s][A
Iteration:  67%|██████▋   | 179/268 [00:29<00:11,  7.42it/s][A
Iteration:  67%|██████▋   | 180/268 [00:29<00:11,  7.48it/s][A
Iteration:  68%|██████▊   | 181/268 [00:29<00:11,  7.75it/s][A
Iteration:  68%|██████▊   | 182/268 [00:30<00:11,  7.64it/s][A
Iteration:  68%|██████▊   | 183/268 [00:30<00:10,  7.84it/s][A
Iteration:  69%|██████▊   | 184/268 [00:30<00:10,  7.84it/s][A
Iteration:  69%|██████▉   | 185/268 [00:30<00:10,  7.80it/s][A[INFO|trainer.py:570] 2024-04-21 17:14:39,705 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:14:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:14:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:14:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:14:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.26it/s]04/21/2024 17:14:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:14:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3984484478089589, 'eval_loss': 1.0590891, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [363, 375, 539, 474, 504, 485, 414, 342, 224, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75842190, 'remaining_params': 9175410, 'pruned_model_sparsity': 0.8920763465447155, 'expected_sparsity': 0.8872, 'target_sparsity': 0.95, 'step': 26450}


Iteration:  69%|██████▉   | 186/268 [00:32<00:58,  1.40it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:43,  1.86it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:33,  2.40it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:26,  3.03it/s][A
Iteration:  71%|███████   | 190/268 [00:33<00:21,  3.69it/s][A
Iteration:  71%|███████▏  | 191/268 [00:33<00:17,  4.37it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:15,  5.00it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:13,  5.66it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:11,  6.17it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:11,  6.56it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:10,  6.87it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:10,  7.08it/s][A
Iteration:  74%|███████▍  | 198/268 [00:34<00:09,  7.25it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.35it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:08,  7.64it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:08,  7.63it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.65it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.55it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.56it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.61it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.53it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.57it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:07,  7.60it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.64it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.64it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.87it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.70it/s][A
Iteration:  79%|███████▉  | 213/268 [00:36<00:07,  7.74it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:06,  7.74it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:06,  7.66it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:06,  7.48it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.68it/s][A
Iteration:  81%|████████▏ | 218/268 [00:36<00:06,  7.65it/s][A
Iteration:  82%|████████▏ | 219/268 [00:36<00:06,  7.80it/s][A
Iteration:  82%|████████▏ | 220/268 [00:36<00:06,  7.77it/s][A
Iteration:  82%|████████▏ | 221/268 [00:37<00:06,  7.77it/s][A
Iteration:  83%|████████▎ | 222/268 [00:37<00:05,  7.78it/s][A
Iteration:  83%|████████▎ | 223/268 [00:37<00:05,  7.78it/s][A
Iteration:  84%|████████▎ | 224/268 [00:37<00:05,  7.61it/s][A
Iteration:  84%|████████▍ | 225/268 [00:37<00:05,  7.64it/s][A
Iteration:  84%|████████▍ | 226/268 [00:37<00:05,  7.67it/s][A
Iteration:  85%|████████▍ | 227/268 [00:37<00:05,  7.65it/s][A
Iteration:  85%|████████▌ | 228/268 [00:37<00:05,  7.69it/s][A
Iteration:  85%|████████▌ | 229/268 [00:38<00:05,  7.49it/s][A
Iteration:  86%|████████▌ | 230/268 [00:38<00:05,  7.57it/s][A
Iteration:  86%|████████▌ | 231/268 [00:38<00:04,  7.41it/s][A
Iteration:  87%|████████▋ | 232/268 [00:38<00:04,  7.41it/s][A
Iteration:  87%|████████▋ | 233/268 [00:38<00:04,  7.50it/s][A
Iteration:  87%|████████▋ | 234/268 [00:38<00:04,  7.57it/s][A
Iteration:  88%|████████▊ | 235/268 [00:38<00:04,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 17:14:48,205 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:14:48 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:14:48 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:14:48 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:14:48 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.12it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.09it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:14:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:14:50 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3984484478089589, 'eval_loss': 1.0565342, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [362, 375, 540, 473, 504, 484, 413, 342, 223, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75846780, 'remaining_params': 9170820, 'pruned_model_sparsity': 0.8921303353658536, 'expected_sparsity': 0.88723, 'target_sparsity': 0.95, 'step': 26500}


Iteration:  88%|████████▊ | 236/268 [00:41<00:23,  1.38it/s][A04/21/2024 17:14:50 - INFO - trainer.trainer_mod - v4 Global step: 26500, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [00:41<00:16,  1.83it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:12,  2.39it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:09,  2.98it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:07,  3.65it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:06,  4.33it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:05,  5.04it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:04,  5.65it/s][A
Iteration:  91%|█████████ | 244/268 [00:42<00:03,  6.11it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  6.51it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:03,  6.83it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.11it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.08it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.37it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.33it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.53it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.45it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:01,  7.51it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.57it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.44it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.49it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.58it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.81it/s][A
Iteration:  97%|█████████▋| 259/268 [00:44<00:01,  7.75it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.72it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.58it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.61it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.84it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.81it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.68it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.81it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.58it/s][A04/21/2024 17:14:54 - INFO - trainer.trainer_mod - Epoch 98 finished. Took 45.14 seconds.
Iteration: 100%|██████████| 268/268 [00:45<00:00,  5.94it/s]
Epoch:  99%|█████████▉| 99/100 [1:16:07<00:45, 45.80s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:34,  7.63it/s][A
Iteration:   1%|          | 2/268 [00:00<00:34,  7.63it/s][A
Iteration:   1%|          | 3/268 [00:00<00:34,  7.61it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:33,  7.91it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:33,  7.86it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:33,  7.83it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:33,  7.82it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:32,  7.93it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:34,  7.62it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:34,  7.52it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:34,  7.48it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:33,  7.54it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:34,  7.48it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:34,  7.38it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:33,  7.48it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:33,  7.55it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:33,  7.57it/s][A[INFO|trainer.py:570] 2024-04-21 17:14:56,663 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:14:56 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:14:56 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:14:56 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:14:56 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:14:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:14:58 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39572141960523277, 'eval_loss': 1.0481774, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [362, 375, 540, 472, 504, 484, 413, 342, 223, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75846780, 'remaining_params': 9170820, 'pruned_model_sparsity': 0.8921303353658536, 'expected_sparsity': 0.88724, 'target_sparsity': 0.95, 'step': 26550}


Iteration:   7%|▋         | 18/268 [00:04<02:59,  1.39it/s][A
Iteration:   7%|▋         | 19/268 [00:04<02:15,  1.84it/s][A
Iteration:   7%|▋         | 20/268 [00:04<01:43,  2.40it/s][A
Iteration:   8%|▊         | 21/268 [00:04<01:21,  3.03it/s][A
Iteration:   8%|▊         | 22/268 [00:04<01:06,  3.70it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:55,  4.38it/s][A
Iteration:   9%|▉         | 24/268 [00:05<00:48,  4.99it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:43,  5.59it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:39,  6.16it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:37,  6.37it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:35,  6.73it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:34,  6.93it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:33,  7.12it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:32,  7.20it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:32,  7.33it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:31,  7.44it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:31,  7.42it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:31,  7.34it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:31,  7.47it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:30,  7.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:29,  7.70it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:29,  7.65it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:30,  7.48it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:30,  7.45it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:30,  7.51it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:29,  7.56it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:30,  7.42it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:30,  7.38it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:30,  7.30it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:29,  7.40it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:29,  7.40it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:29,  7.38it/s][A
Iteration:  19%|█▊        | 50/268 [00:08<00:29,  7.37it/s][A
Iteration:  19%|█▉        | 51/268 [00:08<00:28,  7.48it/s][A
Iteration:  19%|█▉        | 52/268 [00:08<00:29,  7.42it/s][A
Iteration:  20%|█▉        | 53/268 [00:08<00:28,  7.50it/s][A
Iteration:  20%|██        | 54/268 [00:09<00:28,  7.57it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:28,  7.60it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:27,  7.60it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:28,  7.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:09<00:27,  7.61it/s][A
Iteration:  22%|██▏       | 59/268 [00:09<00:27,  7.63it/s][A
Iteration:  22%|██▏       | 60/268 [00:09<00:27,  7.54it/s][A
Iteration:  23%|██▎       | 61/268 [00:10<00:27,  7.62it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:27,  7.62it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:27,  7.55it/s][A
Iteration:  24%|██▍       | 64/268 [00:10<00:26,  7.61it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:26,  7.74it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:26,  7.72it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:26,  7.69it/s][A[INFO|trainer.py:570] 2024-04-21 17:15:05,236 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:15:05 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:15:05 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:15:05 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:15:05 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.06it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.22it/s]04/21/2024 17:15:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:15:07 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39572141960523277, 'eval_loss': 1.0473471, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [362, 375, 539, 471, 503, 484, 413, 341, 223, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75851370, 'remaining_params': 9166230, 'pruned_model_sparsity': 0.8921843241869919, 'expected_sparsity': 0.88729, 'target_sparsity': 0.95, 'step': 26600}


Iteration:  25%|██▌       | 68/268 [00:12<02:24,  1.39it/s][A04/21/2024 17:15:07 - INFO - trainer.trainer_mod - v4 Global step: 26600, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:13<01:48,  1.84it/s][A
Iteration:  26%|██▌       | 70/268 [00:13<01:23,  2.38it/s][A
Iteration:  26%|██▋       | 71/268 [00:13<01:05,  3.00it/s][A
Iteration:  27%|██▋       | 72/268 [00:13<00:53,  3.68it/s][A
Iteration:  27%|██▋       | 73/268 [00:13<00:44,  4.36it/s][A
Iteration:  28%|██▊       | 74/268 [00:13<00:39,  4.90it/s][A
Iteration:  28%|██▊       | 75/268 [00:13<00:35,  5.50it/s][A
Iteration:  28%|██▊       | 76/268 [00:13<00:33,  5.78it/s][A
Iteration:  29%|██▊       | 77/268 [00:14<00:30,  6.23it/s][A
Iteration:  29%|██▉       | 78/268 [00:14<00:28,  6.69it/s][A
Iteration:  29%|██▉       | 79/268 [00:14<00:26,  7.09it/s][A
Iteration:  30%|██▉       | 80/268 [00:14<00:25,  7.25it/s][A
Iteration:  30%|███       | 81/268 [00:14<00:25,  7.37it/s][A
Iteration:  31%|███       | 82/268 [00:14<00:24,  7.45it/s][A
Iteration:  31%|███       | 83/268 [00:14<00:24,  7.65it/s][A
Iteration:  31%|███▏      | 84/268 [00:14<00:24,  7.57it/s][A
Iteration:  32%|███▏      | 85/268 [00:15<00:24,  7.51it/s][A
Iteration:  32%|███▏      | 86/268 [00:15<00:23,  7.59it/s][A
Iteration:  32%|███▏      | 87/268 [00:15<00:23,  7.59it/s][A
Iteration:  33%|███▎      | 88/268 [00:15<00:23,  7.81it/s][A
Iteration:  33%|███▎      | 89/268 [00:15<00:22,  7.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:15<00:23,  7.64it/s][A
Iteration:  34%|███▍      | 91/268 [00:15<00:23,  7.60it/s][A
Iteration:  34%|███▍      | 92/268 [00:16<00:23,  7.60it/s][A
Iteration:  35%|███▍      | 93/268 [00:16<00:23,  7.49it/s][A
Iteration:  35%|███▌      | 94/268 [00:16<00:23,  7.50it/s][A
Iteration:  35%|███▌      | 95/268 [00:16<00:23,  7.41it/s][A
Iteration:  36%|███▌      | 96/268 [00:16<00:23,  7.47it/s][A
Iteration:  36%|███▌      | 97/268 [00:16<00:23,  7.42it/s][A
Iteration:  37%|███▋      | 98/268 [00:16<00:22,  7.45it/s][A
Iteration:  37%|███▋      | 99/268 [00:16<00:22,  7.63it/s][A
Iteration:  37%|███▋      | 100/268 [00:17<00:22,  7.61it/s][A
Iteration:  38%|███▊      | 101/268 [00:17<00:21,  7.62it/s][A
Iteration:  38%|███▊      | 102/268 [00:17<00:21,  7.59it/s][A
Iteration:  38%|███▊      | 103/268 [00:17<00:21,  7.61it/s][A
Iteration:  39%|███▉      | 104/268 [00:17<00:21,  7.67it/s][A
Iteration:  39%|███▉      | 105/268 [00:17<00:21,  7.56it/s][A
Iteration:  40%|███▉      | 106/268 [00:17<00:21,  7.58it/s][A
Iteration:  40%|███▉      | 107/268 [00:18<00:21,  7.57it/s][A
Iteration:  40%|████      | 108/268 [00:18<00:21,  7.58it/s][A
Iteration:  41%|████      | 109/268 [00:18<00:21,  7.52it/s][A
Iteration:  41%|████      | 110/268 [00:18<00:20,  7.58it/s][A
Iteration:  41%|████▏     | 111/268 [00:18<00:20,  7.60it/s][A
Iteration:  42%|████▏     | 112/268 [00:18<00:21,  7.39it/s][A
Iteration:  42%|████▏     | 113/268 [00:18<00:20,  7.59it/s][A
Iteration:  43%|████▎     | 114/268 [00:18<00:20,  7.62it/s][A
Iteration:  43%|████▎     | 115/268 [00:19<00:20,  7.63it/s][A
Iteration:  43%|████▎     | 116/268 [00:19<00:20,  7.55it/s][A
Iteration:  44%|████▎     | 117/268 [00:19<00:19,  7.61it/s][A[INFO|trainer.py:570] 2024-04-21 17:15:13,785 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:15:13 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:15:13 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:15:13 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:15:13 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.03it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.07it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.11it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:15:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:15:15 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.3986722481537282, 'eval_loss': 1.0457275, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [362, 374, 539, 470, 503, 484, 413, 341, 223, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75851370, 'remaining_params': 9166230, 'pruned_model_sparsity': 0.8921843241869919, 'expected_sparsity': 0.88728, 'target_sparsity': 0.95, 'step': 26650}


Iteration:  44%|████▍     | 118/268 [00:21<01:47,  1.39it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<01:20,  1.85it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<01:01,  2.40it/s][A
Iteration:  45%|████▌     | 121/268 [00:21<00:48,  3.01it/s][A
Iteration:  46%|████▌     | 122/268 [00:21<00:39,  3.68it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:33,  4.37it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:28,  5.02it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:25,  5.67it/s][A
Iteration:  47%|████▋     | 126/268 [00:22<00:23,  6.15it/s][A
Iteration:  47%|████▋     | 127/268 [00:22<00:21,  6.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:22<00:20,  6.96it/s][A
Iteration:  48%|████▊     | 129/268 [00:22<00:19,  7.17it/s][A
Iteration:  49%|████▊     | 130/268 [00:22<00:19,  7.23it/s][A
Iteration:  49%|████▉     | 131/268 [00:23<00:18,  7.53it/s][A
Iteration:  49%|████▉     | 132/268 [00:23<00:18,  7.48it/s][A
Iteration:  50%|████▉     | 133/268 [00:23<00:17,  7.55it/s][A
Iteration:  50%|█████     | 134/268 [00:23<00:17,  7.56it/s][A
Iteration:  50%|█████     | 135/268 [00:23<00:17,  7.53it/s][A
Iteration:  51%|█████     | 136/268 [00:23<00:17,  7.52it/s][A
Iteration:  51%|█████     | 137/268 [00:23<00:17,  7.55it/s][A
Iteration:  51%|█████▏    | 138/268 [00:24<00:17,  7.60it/s][A
Iteration:  52%|█████▏    | 139/268 [00:24<00:16,  7.63it/s][A
Iteration:  52%|█████▏    | 140/268 [00:24<00:16,  7.67it/s][A
Iteration:  53%|█████▎    | 141/268 [00:24<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 142/268 [00:24<00:16,  7.65it/s][A
Iteration:  53%|█████▎    | 143/268 [00:24<00:16,  7.56it/s][A
Iteration:  54%|█████▎    | 144/268 [00:24<00:15,  7.78it/s][A
Iteration:  54%|█████▍    | 145/268 [00:24<00:15,  7.73it/s][A
Iteration:  54%|█████▍    | 146/268 [00:25<00:16,  7.47it/s][A
Iteration:  55%|█████▍    | 147/268 [00:25<00:16,  7.52it/s][A
Iteration:  55%|█████▌    | 148/268 [00:25<00:15,  7.53it/s][A
Iteration:  56%|█████▌    | 149/268 [00:25<00:16,  7.36it/s][A
Iteration:  56%|█████▌    | 150/268 [00:25<00:15,  7.58it/s][A
Iteration:  56%|█████▋    | 151/268 [00:25<00:15,  7.72it/s][A
Iteration:  57%|█████▋    | 152/268 [00:25<00:15,  7.52it/s][A
Iteration:  57%|█████▋    | 153/268 [00:26<00:15,  7.38it/s][A
Iteration:  57%|█████▋    | 154/268 [00:26<00:15,  7.30it/s][A
Iteration:  58%|█████▊    | 155/268 [00:26<00:15,  7.27it/s][A
Iteration:  58%|█████▊    | 156/268 [00:26<00:15,  7.28it/s][A
Iteration:  59%|█████▊    | 157/268 [00:26<00:15,  7.36it/s][A
Iteration:  59%|█████▉    | 158/268 [00:26<00:14,  7.48it/s][A
Iteration:  59%|█████▉    | 159/268 [00:26<00:14,  7.66it/s][A
Iteration:  60%|█████▉    | 160/268 [00:26<00:14,  7.46it/s][A
Iteration:  60%|██████    | 161/268 [00:27<00:14,  7.50it/s][A
Iteration:  60%|██████    | 162/268 [00:27<00:14,  7.39it/s][A
Iteration:  61%|██████    | 163/268 [00:27<00:13,  7.51it/s][A
Iteration:  61%|██████    | 164/268 [00:27<00:13,  7.77it/s][A
Iteration:  62%|██████▏   | 165/268 [00:27<00:13,  7.89it/s][A
Iteration:  62%|██████▏   | 166/268 [00:27<00:13,  7.69it/s][A
Iteration:  62%|██████▏   | 167/268 [00:27<00:13,  7.48it/s][A[INFO|trainer.py:570] 2024-04-21 17:15:22,320 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:15:22 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:15:22 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:15:22 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:15:22 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.10it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.09it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.08it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.08it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.28it/s]04/21/2024 17:15:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:15:24 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39596800444544106, 'eval_loss': 1.0416808, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [362, 373, 538, 469, 503, 484, 413, 341, 223, 182, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75852900, 'remaining_params': 9164700, 'pruned_model_sparsity': 0.8922023204607046, 'expected_sparsity': 0.88733, 'target_sparsity': 0.95, 'step': 26700}


Iteration:  63%|██████▎   | 168/268 [00:29<01:12,  1.39it/s][A04/21/2024 17:15:24 - INFO - trainer.trainer_mod - v4 Global step: 26700, Alignment: tensor([ 0,  3,  8, 11], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:30<00:53,  1.84it/s][A
Iteration:  63%|██████▎   | 170/268 [00:30<00:41,  2.38it/s][A
Iteration:  64%|██████▍   | 171/268 [00:30<00:32,  3.00it/s][A
Iteration:  64%|██████▍   | 172/268 [00:30<00:26,  3.65it/s][A
Iteration:  65%|██████▍   | 173/268 [00:30<00:21,  4.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:30<00:18,  5.07it/s][A
Iteration:  65%|██████▌   | 175/268 [00:30<00:16,  5.65it/s][A
Iteration:  66%|██████▌   | 176/268 [00:31<00:15,  6.10it/s][A
Iteration:  66%|██████▌   | 177/268 [00:31<00:13,  6.54it/s][A
Iteration:  66%|██████▋   | 178/268 [00:31<00:13,  6.87it/s][A
Iteration:  67%|██████▋   | 179/268 [00:31<00:13,  6.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:31<00:12,  7.05it/s][A
Iteration:  68%|██████▊   | 181/268 [00:31<00:12,  7.23it/s][A
Iteration:  68%|██████▊   | 182/268 [00:31<00:11,  7.23it/s][A
Iteration:  68%|██████▊   | 183/268 [00:31<00:11,  7.31it/s][A
Iteration:  69%|██████▊   | 184/268 [00:32<00:11,  7.44it/s][A
Iteration:  69%|██████▉   | 185/268 [00:32<00:11,  7.49it/s][A
Iteration:  69%|██████▉   | 186/268 [00:32<00:10,  7.56it/s][A
Iteration:  70%|██████▉   | 187/268 [00:32<00:10,  7.62it/s][A
Iteration:  70%|███████   | 188/268 [00:32<00:10,  7.78it/s][A
Iteration:  71%|███████   | 189/268 [00:32<00:10,  7.59it/s][A
Iteration:  71%|███████   | 190/268 [00:32<00:10,  7.51it/s][A
Iteration:  71%|███████▏  | 191/268 [00:32<00:10,  7.56it/s][A
Iteration:  72%|███████▏  | 192/268 [00:33<00:10,  7.01it/s][A
Iteration:  72%|███████▏  | 193/268 [00:33<00:10,  7.31it/s][A
Iteration:  72%|███████▏  | 194/268 [00:33<00:09,  7.45it/s][A
Iteration:  73%|███████▎  | 195/268 [00:33<00:09,  7.42it/s][A
Iteration:  73%|███████▎  | 196/268 [00:33<00:09,  7.46it/s][A
Iteration:  74%|███████▎  | 197/268 [00:33<00:09,  7.52it/s][A
Iteration:  74%|███████▍  | 198/268 [00:33<00:09,  7.60it/s][A
Iteration:  74%|███████▍  | 199/268 [00:34<00:09,  7.66it/s][A
Iteration:  75%|███████▍  | 200/268 [00:34<00:09,  7.44it/s][A
Iteration:  75%|███████▌  | 201/268 [00:34<00:09,  7.42it/s][A
Iteration:  75%|███████▌  | 202/268 [00:34<00:08,  7.51it/s][A
Iteration:  76%|███████▌  | 203/268 [00:34<00:08,  7.58it/s][A
Iteration:  76%|███████▌  | 204/268 [00:34<00:08,  7.62it/s][A
Iteration:  76%|███████▋  | 205/268 [00:34<00:08,  7.54it/s][A
Iteration:  77%|███████▋  | 206/268 [00:35<00:08,  7.44it/s][A
Iteration:  77%|███████▋  | 207/268 [00:35<00:08,  7.31it/s][A
Iteration:  78%|███████▊  | 208/268 [00:35<00:08,  7.43it/s][A
Iteration:  78%|███████▊  | 209/268 [00:35<00:07,  7.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:35<00:07,  7.65it/s][A
Iteration:  79%|███████▊  | 211/268 [00:35<00:07,  7.66it/s][A
Iteration:  79%|███████▉  | 212/268 [00:35<00:07,  7.64it/s][A
Iteration:  79%|███████▉  | 213/268 [00:35<00:07,  7.63it/s][A
Iteration:  80%|███████▉  | 214/268 [00:36<00:07,  7.67it/s][A
Iteration:  80%|████████  | 215/268 [00:36<00:07,  7.48it/s][A
Iteration:  81%|████████  | 216/268 [00:36<00:07,  7.43it/s][A
Iteration:  81%|████████  | 217/268 [00:36<00:06,  7.51it/s][A[INFO|trainer.py:570] 2024-04-21 17:15:30,905 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:15:30 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:15:30 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:15:30 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:15:30 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.05it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.03it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.02it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.04it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.25it/s]04/21/2024 17:15:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:15:32 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39596800444544106, 'eval_loss': 1.0402713, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [362, 372, 538, 468, 502, 483, 413, 341, 223, 181, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75857490, 'remaining_params': 9160110, 'pruned_model_sparsity': 0.8922563092818429, 'expected_sparsity': 0.88735, 'target_sparsity': 0.95, 'step': 26750}


Iteration:  81%|████████▏ | 218/268 [00:38<00:35,  1.39it/s][A
Iteration:  82%|████████▏ | 219/268 [00:38<00:26,  1.84it/s][A
Iteration:  82%|████████▏ | 220/268 [00:38<00:20,  2.37it/s][A
Iteration:  82%|████████▏ | 221/268 [00:38<00:15,  2.98it/s][A
Iteration:  83%|████████▎ | 222/268 [00:39<00:12,  3.65it/s][A
Iteration:  83%|████████▎ | 223/268 [00:39<00:10,  4.33it/s][A
Iteration:  84%|████████▎ | 224/268 [00:39<00:08,  5.06it/s][A
Iteration:  84%|████████▍ | 225/268 [00:39<00:07,  5.62it/s][A
Iteration:  84%|████████▍ | 226/268 [00:39<00:07,  5.99it/s][A
Iteration:  85%|████████▍ | 227/268 [00:39<00:06,  6.34it/s][A
Iteration:  85%|████████▌ | 228/268 [00:39<00:05,  6.79it/s][A
Iteration:  85%|████████▌ | 229/268 [00:40<00:05,  6.98it/s][A
Iteration:  86%|████████▌ | 230/268 [00:40<00:05,  7.11it/s][A
Iteration:  86%|████████▌ | 231/268 [00:40<00:05,  7.26it/s][A
Iteration:  87%|████████▋ | 232/268 [00:40<00:04,  7.38it/s][A
Iteration:  87%|████████▋ | 233/268 [00:40<00:04,  7.49it/s][A
Iteration:  87%|████████▋ | 234/268 [00:40<00:04,  7.51it/s][A
Iteration:  88%|████████▊ | 235/268 [00:40<00:04,  7.54it/s][A
Iteration:  88%|████████▊ | 236/268 [00:40<00:04,  7.60it/s][A
Iteration:  88%|████████▊ | 237/268 [00:41<00:04,  7.54it/s][A
Iteration:  89%|████████▉ | 238/268 [00:41<00:03,  7.62it/s][A
Iteration:  89%|████████▉ | 239/268 [00:41<00:03,  7.59it/s][A
Iteration:  90%|████████▉ | 240/268 [00:41<00:03,  7.60it/s][A
Iteration:  90%|████████▉ | 241/268 [00:41<00:03,  7.82it/s][A
Iteration:  90%|█████████ | 242/268 [00:41<00:03,  7.68it/s][A
Iteration:  91%|█████████ | 243/268 [00:41<00:03,  7.65it/s][A
Iteration:  91%|█████████ | 244/268 [00:41<00:03,  7.56it/s][A
Iteration:  91%|█████████▏| 245/268 [00:42<00:03,  7.58it/s][A
Iteration:  92%|█████████▏| 246/268 [00:42<00:02,  7.50it/s][A
Iteration:  92%|█████████▏| 247/268 [00:42<00:02,  7.52it/s][A
Iteration:  93%|█████████▎| 248/268 [00:42<00:02,  7.57it/s][A
Iteration:  93%|█████████▎| 249/268 [00:42<00:02,  7.59it/s][A
Iteration:  93%|█████████▎| 250/268 [00:42<00:02,  7.56it/s][A
Iteration:  94%|█████████▎| 251/268 [00:42<00:02,  7.45it/s][A
Iteration:  94%|█████████▍| 252/268 [00:43<00:02,  7.46it/s][A
Iteration:  94%|█████████▍| 253/268 [00:43<00:02,  7.44it/s][A
Iteration:  95%|█████████▍| 254/268 [00:43<00:01,  7.54it/s][A
Iteration:  95%|█████████▌| 255/268 [00:43<00:01,  7.51it/s][A
Iteration:  96%|█████████▌| 256/268 [00:43<00:01,  7.45it/s][A
Iteration:  96%|█████████▌| 257/268 [00:43<00:01,  7.43it/s][A
Iteration:  96%|█████████▋| 258/268 [00:43<00:01,  7.35it/s][A
Iteration:  97%|█████████▋| 259/268 [00:43<00:01,  7.45it/s][A
Iteration:  97%|█████████▋| 260/268 [00:44<00:01,  7.49it/s][A
Iteration:  97%|█████████▋| 261/268 [00:44<00:00,  7.55it/s][A
Iteration:  98%|█████████▊| 262/268 [00:44<00:00,  7.61it/s][A
Iteration:  98%|█████████▊| 263/268 [00:44<00:00,  7.59it/s][A
Iteration:  99%|█████████▊| 264/268 [00:44<00:00,  7.60it/s][A
Iteration:  99%|█████████▉| 265/268 [00:44<00:00,  7.60it/s][A
Iteration:  99%|█████████▉| 266/268 [00:44<00:00,  7.64it/s][A
Iteration: 100%|█████████▉| 267/268 [00:45<00:00,  7.52it/s][A[INFO|trainer.py:570] 2024-04-21 17:15:39,443 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/21/2024 17:15:39 - INFO - trainer.trainer_mod - ***** Running Evaluation *****
04/21/2024 17:15:39 - INFO - trainer.trainer_mod -   Num examples = 1043
04/21/2024 17:15:39 - INFO - trainer.trainer_mod -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/21/2024 17:15:39 - INFO - trainer.trainer_mod - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:01, 17.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:01, 17.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:01, 17.09it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:00<00:01, 17.10it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:00<00:01, 17.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:00<00:00, 17.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:00, 17.10it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:01<00:00, 17.05it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:01<00:00, 17.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:01<00:00, 17.06it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:01<00:00, 17.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:01<00:00, 17.27it/s]04/21/2024 17:15:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/21/2024 17:15:41 - INFO - trainer.trainer_mod - Evaluating: {'matthews_correlation': 0.39891405791978285, 'eval_loss': 1.03867, 'head_layers': [1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0], 'mlp_layers': [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [362, 371, 538, 468, 502, 483, 413, 341, 222, 181, 192, 145], 'head_nums': [3, 2, 2, 1, 2, 5, 5, 2, 2, 2, 2, 1], 'pruned_params': 75859020, 'remaining_params': 9158580, 'pruned_model_sparsity': 0.8922743055555555, 'expected_sparsity': 0.88737, 'target_sparsity': 0.95, 'step': 26800}


Iteration: 100%|██████████| 268/268 [00:47<00:00,  1.41it/s][A04/21/2024 17:15:41 - INFO - trainer.trainer_mod - Epoch 99 finished. Took 47.1 seconds.
Iteration: 100%|██████████| 268/268 [00:47<00:00,  5.69it/s]
Epoch: 100%|██████████| 100/100 [1:16:54<00:00, 46.19s/it]Epoch: 100%|██████████| 100/100 [1:16:54<00:00, 46.15s/it]
[INFO|configuration_utils.py:439] 2024-04-21 17:15:41,489 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95/config.json
[INFO|modeling_utils.py:1084] 2024-04-21 17:15:42,516 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-04-21 17:15:42,522 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-04-21 17:15:42,531 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod/CoLA_sparsity0.95/special_tokens_map.json
04/21/2024 17:15:42 - INFO - __main__ - Training took 4623.29 seconds.
