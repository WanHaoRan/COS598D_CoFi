Sun Apr 28 18:27:26 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/rte_mod2_0.6
nvidia-smi output:
Sun Apr 28 18:27:26 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:65:00.0 Off |                    0 |
| N/A   30C    P0              32W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/28/2024 18:27:29 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/28/2024 18:27:29 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/runs/Apr28_18-27-29_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/28/2024 18:27:29 - INFO - __main__ - Model Arguments:
04/28/2024 18:27:29 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/28/2024 18:27:29 - INFO - __main__ - config_name = None
04/28/2024 18:27:29 - INFO - __main__ - tokenizer_name = None
04/28/2024 18:27:29 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/28/2024 18:27:29 - INFO - __main__ - use_fast_tokenizer = True
04/28/2024 18:27:29 - INFO - __main__ - model_revision = main
04/28/2024 18:27:29 - INFO - __main__ - use_auth_token = False
04/28/2024 18:27:29 - INFO - __main__ - Data Arguments:
04/28/2024 18:27:29 - INFO - __main__ - task_name = rte
04/28/2024 18:27:29 - INFO - __main__ - dataset_name = None
04/28/2024 18:27:29 - INFO - __main__ - t_name = None
04/28/2024 18:27:29 - INFO - __main__ - dataset_config_name = None
04/28/2024 18:27:29 - INFO - __main__ - max_seq_length = 128
04/28/2024 18:27:29 - INFO - __main__ - overwrite_cache = False
04/28/2024 18:27:29 - INFO - __main__ - pad_to_max_length = True
04/28/2024 18:27:29 - INFO - __main__ - max_train_samples = None
04/28/2024 18:27:29 - INFO - __main__ - max_eval_samples = None
04/28/2024 18:27:29 - INFO - __main__ - max_predict_samples = None
04/28/2024 18:27:29 - INFO - __main__ - train_file = None
04/28/2024 18:27:29 - INFO - __main__ - validation_file = None
04/28/2024 18:27:29 - INFO - __main__ - test_file = None
04/28/2024 18:27:29 - INFO - __main__ - Training Arguments:
04/28/2024 18:27:29 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6
04/28/2024 18:27:29 - INFO - __main__ - overwrite_output_dir = True
04/28/2024 18:27:29 - INFO - __main__ - do_train = True
04/28/2024 18:27:29 - INFO - __main__ - do_eval = True
04/28/2024 18:27:29 - INFO - __main__ - do_predict = False
04/28/2024 18:27:29 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/28/2024 18:27:29 - INFO - __main__ - prediction_loss_only = False
04/28/2024 18:27:29 - INFO - __main__ - per_device_train_batch_size = 32
04/28/2024 18:27:29 - INFO - __main__ - per_device_eval_batch_size = 32
04/28/2024 18:27:29 - INFO - __main__ - per_gpu_train_batch_size = None
04/28/2024 18:27:29 - INFO - __main__ - per_gpu_eval_batch_size = None
04/28/2024 18:27:29 - INFO - __main__ - gradient_accumulation_steps = 1
04/28/2024 18:27:29 - INFO - __main__ - eval_accumulation_steps = None
04/28/2024 18:27:29 - INFO - __main__ - learning_rate = 2e-05
04/28/2024 18:27:29 - INFO - __main__ - weight_decay = 0.0
04/28/2024 18:27:29 - INFO - __main__ - adam_beta1 = 0.9
04/28/2024 18:27:29 - INFO - __main__ - adam_beta2 = 0.999
04/28/2024 18:27:29 - INFO - __main__ - adam_epsilon = 1e-08
04/28/2024 18:27:29 - INFO - __main__ - max_grad_norm = 1.0
04/28/2024 18:27:29 - INFO - __main__ - num_train_epochs = 100.0
04/28/2024 18:27:29 - INFO - __main__ - max_steps = -1
04/28/2024 18:27:29 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/28/2024 18:27:29 - INFO - __main__ - warmup_ratio = 0.0
04/28/2024 18:27:29 - INFO - __main__ - warmup_steps = 0
04/28/2024 18:27:29 - INFO - __main__ - log_level = -1
04/28/2024 18:27:29 - INFO - __main__ - log_level_replica = -1
04/28/2024 18:27:29 - INFO - __main__ - log_on_each_node = True
04/28/2024 18:27:29 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/runs/Apr28_18-27-29_adroit-h11g2
04/28/2024 18:27:29 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/28/2024 18:27:29 - INFO - __main__ - logging_first_step = False
04/28/2024 18:27:29 - INFO - __main__ - logging_steps = 100
04/28/2024 18:27:29 - INFO - __main__ - logging_nan_inf_filter = True
04/28/2024 18:27:29 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/28/2024 18:27:29 - INFO - __main__ - save_steps = 0
04/28/2024 18:27:29 - INFO - __main__ - save_total_limit = None
04/28/2024 18:27:29 - INFO - __main__ - save_on_each_node = False
04/28/2024 18:27:29 - INFO - __main__ - no_cuda = False
04/28/2024 18:27:29 - INFO - __main__ - seed = 57
04/28/2024 18:27:29 - INFO - __main__ - bf16 = False
04/28/2024 18:27:29 - INFO - __main__ - fp16 = False
04/28/2024 18:27:29 - INFO - __main__ - fp16_opt_level = O1
04/28/2024 18:27:29 - INFO - __main__ - half_precision_backend = auto
04/28/2024 18:27:29 - INFO - __main__ - bf16_full_eval = False
04/28/2024 18:27:29 - INFO - __main__ - fp16_full_eval = False
04/28/2024 18:27:29 - INFO - __main__ - tf32 = None
04/28/2024 18:27:29 - INFO - __main__ - local_rank = -1
04/28/2024 18:27:29 - INFO - __main__ - xpu_backend = None
04/28/2024 18:27:29 - INFO - __main__ - tpu_num_cores = None
04/28/2024 18:27:29 - INFO - __main__ - tpu_metrics_debug = False
04/28/2024 18:27:29 - INFO - __main__ - debug = []
04/28/2024 18:27:29 - INFO - __main__ - dataloader_drop_last = False
04/28/2024 18:27:29 - INFO - __main__ - eval_steps = 50
04/28/2024 18:27:29 - INFO - __main__ - dataloader_num_workers = 0
04/28/2024 18:27:29 - INFO - __main__ - past_index = -1
04/28/2024 18:27:29 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6
04/28/2024 18:27:29 - INFO - __main__ - disable_tqdm = False
04/28/2024 18:27:29 - INFO - __main__ - remove_unused_columns = True
04/28/2024 18:27:29 - INFO - __main__ - label_names = None
04/28/2024 18:27:29 - INFO - __main__ - load_best_model_at_end = False
04/28/2024 18:27:29 - INFO - __main__ - metric_for_best_model = None
04/28/2024 18:27:29 - INFO - __main__ - greater_is_better = None
04/28/2024 18:27:29 - INFO - __main__ - ignore_data_skip = False
04/28/2024 18:27:29 - INFO - __main__ - sharded_ddp = []
04/28/2024 18:27:29 - INFO - __main__ - deepspeed = None
04/28/2024 18:27:29 - INFO - __main__ - label_smoothing_factor = 0.0
04/28/2024 18:27:29 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/28/2024 18:27:29 - INFO - __main__ - adafactor = False
04/28/2024 18:27:29 - INFO - __main__ - group_by_length = False
04/28/2024 18:27:29 - INFO - __main__ - length_column_name = length
04/28/2024 18:27:29 - INFO - __main__ - report_to = []
04/28/2024 18:27:29 - INFO - __main__ - ddp_find_unused_parameters = None
04/28/2024 18:27:29 - INFO - __main__ - ddp_bucket_cap_mb = None
04/28/2024 18:27:29 - INFO - __main__ - dataloader_pin_memory = True
04/28/2024 18:27:29 - INFO - __main__ - skip_memory_metrics = True
04/28/2024 18:27:29 - INFO - __main__ - use_legacy_prediction_loop = False
04/28/2024 18:27:29 - INFO - __main__ - push_to_hub = False
04/28/2024 18:27:29 - INFO - __main__ - resume_from_checkpoint = None
04/28/2024 18:27:29 - INFO - __main__ - hub_model_id = None
04/28/2024 18:27:29 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/28/2024 18:27:29 - INFO - __main__ - hub_token = None
04/28/2024 18:27:29 - INFO - __main__ - gradient_checkpointing = False
04/28/2024 18:27:29 - INFO - __main__ - fp16_backend = auto
04/28/2024 18:27:29 - INFO - __main__ - push_to_hub_model_id = None
04/28/2024 18:27:29 - INFO - __main__ - push_to_hub_organization = None
04/28/2024 18:27:29 - INFO - __main__ - push_to_hub_token = None
04/28/2024 18:27:29 - INFO - __main__ - mp_parameters = 
04/28/2024 18:27:29 - INFO - __main__ - _n_gpu = 1
04/28/2024 18:27:29 - INFO - __main__ - __cached__setup_devices = cuda:0
04/28/2024 18:27:29 - INFO - __main__ - Additional Arguments:
04/28/2024 18:27:29 - INFO - __main__ - test = False
04/28/2024 18:27:29 - INFO - __main__ - ex_name = RTE_sparsity0.6
04/28/2024 18:27:29 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/28/2024 18:27:29 - INFO - __main__ - reg_learning_rate = 0.01
04/28/2024 18:27:29 - INFO - __main__ - scheduler_type = linear
04/28/2024 18:27:29 - INFO - __main__ - freeze_embeddings = True
04/28/2024 18:27:29 - INFO - __main__ - pretrained_pruned_model = None
04/28/2024 18:27:29 - INFO - __main__ - droprate_init = 0.5
04/28/2024 18:27:29 - INFO - __main__ - temperature = 0.6666666666666666
04/28/2024 18:27:29 - INFO - __main__ - prepruning_finetune_epochs = 4
04/28/2024 18:27:29 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/28/2024 18:27:29 - INFO - __main__ - target_sparsity = 0.6
04/28/2024 18:27:29 - INFO - __main__ - sparsity_epsilon = 0
04/28/2024 18:27:29 - INFO - __main__ - distillation_path = textattack/bert-base-uncased-RTE
04/28/2024 18:27:29 - INFO - __main__ - do_distill = True
04/28/2024 18:27:29 - INFO - __main__ - do_layer_distill = True
04/28/2024 18:27:29 - INFO - __main__ - layer_distill_version = 4
04/28/2024 18:27:29 - INFO - __main__ - distill_loss_alpha = 0.9
04/28/2024 18:27:29 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/28/2024 18:27:29 - INFO - __main__ - distill_temp = 2.0
04/28/2024 18:27:29 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/28/2024 18:27:29 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/28/2024 18:27:29 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/28/2024 18:27:29 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 689.21it/s]
[INFO|configuration_utils.py:648] 2024-04-28 18:27:29,679 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-28 18:27:29,679 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "rte",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-28 18:27:29,681 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-28 18:27:29,682 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-28 18:27:29,685 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-28 18:27:29,686 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-28 18:27:29,686 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-28 18:27:29,686 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-28 18:27:29,688 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-28 18:27:29,689 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/28/2024 18:27:38 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/28/2024 18:27:38 - INFO - __main__ - Model size: 85054464
04/28/2024 18:27:38 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x146de104f280> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/28/2024 18:27:38 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/28/2024 18:27:38 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x146de104f280> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/28/2024 18:27:38 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/28/2024 18:27:38 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x146de104f280> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/28/2024 18:27:38 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/rte/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/28/2024 18:27:38 - INFO - __main__ - Sample 2105 of the training set: {'sentence1': 'The CBS Evening News commentary segment "Free Speech" , which made its debut with Katie Couric this month, was accused last Friday by Bill Maher of HBO\'s "Real Time with Bill Maher" of being "anything but free speech". Maher said he was asked by CBS News to appear on the segment. But when he asked if he could talk about religion, "that was a dealbreaker from the start". Instead, he said they would send over a list of "acceptable topics". CBS News executive producer Rome Hartman has since responded in an e-mail to TVNewser saying that, "Bill Maher was never told that he couldn\'t discuss religion in a Free Speech segment," and added, "In fact, Free Speech has already addressed religion and we expect others will in the future."', 'sentence2': 'Free Speech is a part of the CBS Evening News.', 'label': 0, 'idx': 2105, 'input_ids': [101, 1996, 6568, 3944, 2739, 8570, 6903, 1000, 2489, 4613, 1000, 1010, 2029, 2081, 2049, 2834, 2007, 9734, 2522, 9496, 2278, 2023, 3204, 1010, 2001, 5496, 2197, 5958, 2011, 3021, 5003, 5886, 1997, 14633, 1005, 1055, 1000, 2613, 2051, 2007, 3021, 5003, 5886, 1000, 1997, 2108, 1000, 2505, 2021, 2489, 4613, 1000, 1012, 5003, 5886, 2056, 2002, 2001, 2356, 2011, 6568, 2739, 2000, 3711, 2006, 1996, 6903, 1012, 2021, 2043, 2002, 2356, 2065, 2002, 2071, 2831, 2055, 4676, 1010, 1000, 2008, 2001, 1037, 3066, 21204, 2013, 1996, 2707, 1000, 1012, 2612, 1010, 2002, 2056, 2027, 2052, 4604, 2058, 1037, 2862, 1997, 1000, 11701, 7832, 1000, 1012, 6568, 2739, 3237, 3135, 4199, 26766, 2038, 2144, 5838, 102, 2489, 4613, 2003, 1037, 2112, 1997, 1996, 6568, 3944, 2739, 1012, 102], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}.
04/28/2024 18:27:38 - INFO - __main__ - Sample 1315 of the training set: {'sentence1': "He said those three detainees are Khalid Sheikh Mohammed - one of the architects of the September 11th attacks on New York and Washington, Abu Zubaydah - who is believed to have been a top al-Qaida strategist, and Abd al-Rahim al-Nashiri - who is believed to have played a key role in the bombing of the USS Cole. All three are being held at the U.S. detention facility at Guantanamo Bay. Hayden said waterboarding was used against the three detainees nearly five years ago because of circumstances at the time, including the belief that additional attacks against the United States were imminent. Hayden defended the CIA's use of extreme interrogation techniques as lawful, and urged lawmakers not to impose restrictions on such methods. Congress is considering legislation that would restrict the CIA to using only the interrogation techniques authorized by the U.S. Army's field manual, which does not include waterboarding.", 'sentence2': 'Abu Zubaydah belongs to al-Qaida.', 'label': 0, 'idx': 1315, 'input_ids': [101, 2002, 2056, 2216, 2093, 26485, 2024, 21828, 12840, 12619, 1011, 2028, 1997, 1996, 8160, 1997, 1996, 2244, 6252, 4491, 2006, 2047, 2259, 1998, 2899, 1010, 8273, 16950, 15907, 18417, 1011, 2040, 2003, 3373, 2000, 2031, 2042, 1037, 2327, 2632, 1011, 1053, 14326, 2050, 2358, 11657, 24063, 1010, 1998, 19935, 2632, 1011, 10958, 14341, 2632, 1011, 10594, 15735, 1011, 2040, 2003, 3373, 2000, 2031, 2209, 1037, 3145, 2535, 1999, 1996, 8647, 1997, 1996, 7234, 5624, 1012, 2035, 2093, 2024, 2108, 2218, 2012, 1996, 1057, 1012, 1055, 1012, 12345, 4322, 2012, 23094, 3016, 1012, 13872, 2056, 2300, 21172, 2001, 2109, 2114, 1996, 2093, 26485, 3053, 2274, 2086, 3283, 2138, 1997, 6214, 2012, 1996, 2051, 1010, 102, 8273, 16950, 15907, 18417, 7460, 2000, 2632, 1011, 1053, 14326, 2050, 1012, 102], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}.
04/28/2024 18:27:38 - INFO - __main__ - Sample 1955 of the training set: {'sentence1': "Please note that Arabic is the language of Quran so it's better to learn it to understand clearly all the miracles in Quran.", 'sentence2': 'Arabic is the language of the Quran.', 'label': 0, 'idx': 1955, 'input_ids': [101, 3531, 3602, 2008, 5640, 2003, 1996, 2653, 1997, 21288, 2061, 2009, 1005, 1055, 2488, 2000, 4553, 2009, 2000, 3305, 4415, 2035, 1996, 17861, 1999, 21288, 1012, 102, 5640, 2003, 1996, 2653, 1997, 1996, 21288, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/28/2024 18:27:38 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/28/2024 18:27:38 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/28/2024 18:27:38 - INFO - __main__ - ************* 2490 Training Examples Loaded *************
04/28/2024 18:27:38 - INFO - __main__ - ************* 277 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-28 18:27:39,229 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 - Prepruning finetune steps: 100
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 - Lagrangian warmup steps: 1560
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 - ***** Running training *****
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 -   Num examples = 2490
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 -   Num Epochs = 100
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 -   Instantaneous batch size per device = 32
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 -   Gradient Accumulation steps = 1
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 -   Total optimization steps = 7800
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-28 18:27:39,234 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32

Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A
Evaluation:  11%|█         | 1/9 [00:00<00:01,  6.11it/s][A
Evaluation:  33%|███▎      | 3/9 [00:00<00:00,  9.79it/s][A
Evaluation:  56%|█████▌    | 5/9 [00:00<00:00, 12.57it/s][A
Evaluation:  78%|███████▊  | 7/9 [00:00<00:00, 14.21it/s][AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 13.74it/s]04/28/2024 18:27:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:27:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.5415162454873647, 'eval_loss': 0.691169, 'step': 0}


Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A04/28/2024 18:27:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:21,  3.54it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:20,  3.72it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:19,  3.81it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:18,  3.86it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:18,  3.89it/s][A
Iteration:   9%|▉         | 7/78 [00:01<00:18,  3.92it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:17,  3.92it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:17,  3.93it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:17,  3.93it/s][A
Iteration:  14%|█▍        | 11/78 [00:02<00:17,  3.94it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:16,  3.94it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:16,  3.94it/s][A
Iteration:  18%|█▊        | 14/78 [00:03<00:16,  3.94it/s][A
Iteration:  19%|█▉        | 15/78 [00:03<00:15,  3.94it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:15,  3.94it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:15,  3.94it/s][A
Iteration:  23%|██▎       | 18/78 [00:04<00:15,  3.94it/s][A
Iteration:  24%|██▍       | 19/78 [00:04<00:14,  3.94it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:14,  3.94it/s][A
Iteration:  27%|██▋       | 21/78 [00:05<00:14,  3.94it/s][A
Iteration:  28%|██▊       | 22/78 [00:05<00:14,  3.94it/s][A
Iteration:  29%|██▉       | 23/78 [00:05<00:13,  3.94it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:13,  3.94it/s][A
Iteration:  32%|███▏      | 25/78 [00:06<00:13,  3.94it/s][A
Iteration:  33%|███▎      | 26/78 [00:06<00:13,  3.94it/s][A
Iteration:  35%|███▍      | 27/78 [00:06<00:12,  3.94it/s][A
Iteration:  36%|███▌      | 28/78 [00:07<00:12,  3.94it/s][A
Iteration:  37%|███▋      | 29/78 [00:07<00:12,  4.03it/s][A
Iteration:  38%|███▊      | 30/78 [00:07<00:11,  4.01it/s][A
Iteration:  40%|███▉      | 31/78 [00:07<00:11,  3.99it/s][A
Iteration:  41%|████      | 32/78 [00:08<00:11,  3.97it/s][A
Iteration:  42%|████▏     | 33/78 [00:08<00:11,  3.96it/s][A
Iteration:  44%|████▎     | 34/78 [00:08<00:11,  3.96it/s][A
Iteration:  45%|████▍     | 35/78 [00:08<00:10,  3.95it/s][A
Iteration:  46%|████▌     | 36/78 [00:09<00:10,  3.94it/s][A
Iteration:  47%|████▋     | 37/78 [00:09<00:10,  3.94it/s][A
Iteration:  49%|████▊     | 38/78 [00:09<00:10,  3.94it/s][A
Iteration:  50%|█████     | 39/78 [00:09<00:09,  3.94it/s][A
Iteration:  51%|█████▏    | 40/78 [00:10<00:09,  3.94it/s][A
Iteration:  53%|█████▎    | 41/78 [00:10<00:10,  3.62it/s][A
Iteration:  54%|█████▍    | 42/78 [00:10<00:09,  3.70it/s][A
Iteration:  55%|█████▌    | 43/78 [00:11<00:09,  3.77it/s][A
Iteration:  56%|█████▋    | 44/78 [00:11<00:08,  3.82it/s][A
Iteration:  58%|█████▊    | 45/78 [00:11<00:08,  3.85it/s][A
Iteration:  59%|█████▉    | 46/78 [00:11<00:08,  3.88it/s][A
Iteration:  60%|██████    | 47/78 [00:12<00:07,  3.90it/s][A
Iteration:  62%|██████▏   | 48/78 [00:12<00:07,  3.91it/s][A
Iteration:  63%|██████▎   | 49/78 [00:12<00:07,  3.92it/s][A[INFO|trainer.py:570] 2024-04-28 18:27:52,718 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:27:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:27:52 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:27:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A

Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 17.22it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 17.11it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 17.06it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 17.01it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.66it/s]04/28/2024 18:27:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:27:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.6462278, 'step': 50}


Iteration:  64%|██████▍   | 50/78 [00:13<00:11,  2.44it/s][A
Iteration:  65%|██████▌   | 51/78 [00:13<00:09,  2.75it/s][A
Iteration:  67%|██████▋   | 52/78 [00:13<00:08,  3.02it/s][A
Iteration:  68%|██████▊   | 53/78 [00:14<00:07,  3.25it/s][A
Iteration:  69%|██████▉   | 54/78 [00:14<00:07,  3.42it/s][A
Iteration:  71%|███████   | 55/78 [00:14<00:06,  3.74it/s][A
Iteration:  72%|███████▏  | 56/78 [00:14<00:05,  3.80it/s][A
Iteration:  73%|███████▎  | 57/78 [00:15<00:05,  3.84it/s][A
Iteration:  74%|███████▍  | 58/78 [00:15<00:05,  3.87it/s][A
Iteration:  76%|███████▌  | 59/78 [00:15<00:04,  3.89it/s][A
Iteration:  77%|███████▋  | 60/78 [00:15<00:04,  3.90it/s][A
Iteration:  78%|███████▊  | 61/78 [00:16<00:04,  3.91it/s][A
Iteration:  79%|███████▉  | 62/78 [00:16<00:04,  3.92it/s][A
Iteration:  81%|████████  | 63/78 [00:16<00:03,  3.92it/s][A
Iteration:  82%|████████▏ | 64/78 [00:16<00:03,  3.93it/s][A
Iteration:  83%|████████▎ | 65/78 [00:17<00:03,  3.93it/s][A
Iteration:  85%|████████▍ | 66/78 [00:17<00:03,  3.93it/s][A
Iteration:  86%|████████▌ | 67/78 [00:17<00:02,  3.93it/s][A
Iteration:  87%|████████▋ | 68/78 [00:17<00:02,  3.93it/s][A
Iteration:  88%|████████▊ | 69/78 [00:18<00:02,  3.93it/s][A
Iteration:  90%|████████▉ | 70/78 [00:18<00:02,  3.93it/s][A
Iteration:  91%|█████████ | 71/78 [00:18<00:01,  3.93it/s][A
Iteration:  92%|█████████▏| 72/78 [00:18<00:01,  3.93it/s][A
Iteration:  94%|█████████▎| 73/78 [00:19<00:01,  3.93it/s][A
Iteration:  95%|█████████▍| 74/78 [00:19<00:01,  3.93it/s][A
Iteration:  96%|█████████▌| 75/78 [00:19<00:00,  3.93it/s][A
Iteration:  97%|█████████▋| 76/78 [00:19<00:00,  3.92it/s][A
Iteration:  99%|█████████▊| 77/78 [00:20<00:00,  3.92it/s][A
Iteration: 100%|██████████| 78/78 [00:20<00:00,  4.16it/s][A04/28/2024 18:28:00 - INFO - trainer.trainer_mod_2 - Epoch 0 finished. Took 20.36 seconds.
Iteration: 100%|██████████| 78/78 [00:20<00:00,  3.83it/s]
Epoch:   1%|          | 1/100 [00:21<34:42, 21.03s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:19,  3.93it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:19,  3.92it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:19,  3.93it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:18,  3.92it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:18,  3.92it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:18,  3.92it/s][A
Iteration:   9%|▉         | 7/78 [00:01<00:18,  3.92it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:17,  3.92it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:17,  3.92it/s][A
Iteration:  13%|█▎        | 10/78 [00:02<00:17,  3.92it/s][A
Iteration:  14%|█▍        | 11/78 [00:02<00:17,  3.92it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:16,  3.99it/s][A
Iteration:  17%|█▋        | 13/78 [00:03<00:16,  3.97it/s][A
Iteration:  18%|█▊        | 14/78 [00:03<00:16,  3.96it/s][A
Iteration:  19%|█▉        | 15/78 [00:03<00:15,  3.95it/s][A
Iteration:  21%|██        | 16/78 [00:04<00:15,  3.94it/s][A
Iteration:  22%|██▏       | 17/78 [00:04<00:15,  3.94it/s][A
Iteration:  23%|██▎       | 18/78 [00:04<00:15,  3.93it/s][A
Iteration:  24%|██▍       | 19/78 [00:04<00:15,  3.93it/s][A
Iteration:  26%|██▌       | 20/78 [00:05<00:14,  3.93it/s][A
Iteration:  27%|██▋       | 21/78 [00:05<00:14,  3.93it/s][A[INFO|trainer.py:570] 2024-04-28 18:28:05,862 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:28:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:28:05 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:28:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A

Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 17.14it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 17.01it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 16.95it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 16.88it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 17.55it/s]04/28/2024 18:28:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:28:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7075812274368231, 'eval_loss': 0.67303854, 'step': 100}


Iteration:  28%|██▊       | 22/78 [00:06<00:23,  2.43it/s][A04/28/2024 18:28:06 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/28/2024 18:28:06 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/28/2024 18:28:06 - INFO - trainer.trainer_mod_2 - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/28/2024 18:28:06 - INFO - trainer.trainer_mod_2 - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/28/2024 18:28:06 - INFO - trainer.trainer_mod_2 - Starting l0 regularization!
04/28/2024 18:28:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  29%|██▉       | 23/78 [00:06<00:22,  2.48it/s][A
Iteration:  31%|███       | 24/78 [00:06<00:20,  2.61it/s][A
Iteration:  32%|███▏      | 25/78 [00:07<00:19,  2.71it/s][A
Iteration:  33%|███▎      | 26/78 [00:07<00:18,  2.80it/s][A
Iteration:  35%|███▍      | 27/78 [00:07<00:17,  2.85it/s][A
Iteration:  36%|███▌      | 28/78 [00:08<00:17,  2.88it/s][A
Iteration:  37%|███▋      | 29/78 [00:08<00:16,  2.93it/s][A
Iteration:  38%|███▊      | 30/78 [00:08<00:16,  2.95it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:15,  2.96it/s][A
Iteration:  41%|████      | 32/78 [00:09<00:15,  2.98it/s][A
Iteration:  42%|████▏     | 33/78 [00:09<00:15,  2.98it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  2.99it/s][A
Iteration:  45%|████▍     | 35/78 [00:10<00:14,  3.00it/s][A
Iteration:  46%|████▌     | 36/78 [00:10<00:13,  3.00it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.01it/s][A
Iteration:  49%|████▊     | 38/78 [00:11<00:13,  2.99it/s][A
Iteration:  50%|█████     | 39/78 [00:11<00:12,  3.01it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.02it/s][A
Iteration:  53%|█████▎    | 41/78 [00:12<00:12,  3.02it/s][A
Iteration:  54%|█████▍    | 42/78 [00:12<00:11,  3.02it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.01it/s][A
Iteration:  56%|█████▋    | 44/78 [00:13<00:11,  3.02it/s][A
Iteration:  58%|█████▊    | 45/78 [00:13<00:10,  3.03it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.02it/s][A
Iteration:  60%|██████    | 47/78 [00:14<00:10,  3.02it/s][A
Iteration:  62%|██████▏   | 48/78 [00:14<00:09,  3.01it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.01it/s][A
Iteration:  64%|██████▍   | 50/78 [00:15<00:09,  3.01it/s][A
Iteration:  65%|██████▌   | 51/78 [00:15<00:08,  3.00it/s][A
Iteration:  67%|██████▋   | 52/78 [00:16<00:08,  3.01it/s][A
Iteration:  68%|██████▊   | 53/78 [00:16<00:08,  3.01it/s][A
Iteration:  69%|██████▉   | 54/78 [00:16<00:07,  3.01it/s][A
Iteration:  71%|███████   | 55/78 [00:17<00:07,  3.01it/s][A
Iteration:  72%|███████▏  | 56/78 [00:17<00:07,  3.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:17<00:06,  3.01it/s][A
Iteration:  74%|███████▍  | 58/78 [00:18<00:06,  3.02it/s][A
Iteration:  76%|███████▌  | 59/78 [00:18<00:06,  3.02it/s][A
Iteration:  77%|███████▋  | 60/78 [00:18<00:05,  3.02it/s][A
Iteration:  78%|███████▊  | 61/78 [00:19<00:05,  2.96it/s][A
Iteration:  79%|███████▉  | 62/78 [00:19<00:05,  2.98it/s][A
Iteration:  81%|████████  | 63/78 [00:19<00:05,  2.98it/s][A
Iteration:  82%|████████▏ | 64/78 [00:20<00:04,  2.99it/s][A
Iteration:  83%|████████▎ | 65/78 [00:20<00:04,  3.00it/s][A
Iteration:  85%|████████▍ | 66/78 [00:20<00:04,  3.00it/s][A
Iteration:  86%|████████▌ | 67/78 [00:21<00:03,  2.98it/s][A
Iteration:  87%|████████▋ | 68/78 [00:21<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:21<00:03,  2.99it/s][A
Iteration:  90%|████████▉ | 70/78 [00:22<00:02,  3.00it/s][A
Iteration:  91%|█████████ | 71/78 [00:22<00:02,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 18:28:23,076 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:28:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:28:23 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:28:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:28:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.44it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.87it/s]04/28/2024 18:28:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:28:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6353790613718412, 'eval_loss': 0.6569414, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2621, 2611, 2612, 2606, 2606, 2608, 2596, 2593, 2592, 2588, 2590, 2598], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8949204, 'remaining_params': 76068396, 'pruned_model_sparsity': 0.10526295731707318, 'expected_sparsity': 0.10682, 'target_sparsity': 0.01923076923076923, 'step': 150}


Iteration:  92%|█████████▏| 72/78 [00:23<00:03,  1.92it/s][A
Iteration:  94%|█████████▎| 73/78 [00:23<00:02,  2.16it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  2.35it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:01,  2.52it/s][A
Iteration:  97%|█████████▋| 76/78 [00:24<00:00,  2.64it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  2.74it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  2.94it/s][A04/28/2024 18:28:25 - INFO - trainer.trainer_mod_2 - Epoch 1 finished. Took 25.38 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.07it/s]
Epoch:   2%|▏         | 2/100 [00:46<38:32, 23.59s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.01it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.95it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.98it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  2.97it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.99it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:23,  3.00it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.01it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.02it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.02it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.01it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.03it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.00it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.00it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.02it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.01it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.01it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.02it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.02it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.03it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.02it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.00it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.01it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.01it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.01it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.99it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.00it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:17,  2.99it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.00it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:16,  3.00it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.00it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.00it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:15,  2.98it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.00it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.00it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:14,  2.98it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.99it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.93it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.95it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.96it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.98it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.98it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 18:28:40,327 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:28:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:28:40 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:28:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:28:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.45it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.38it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.36it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.89it/s]04/28/2024 18:28:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:28:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.6499808, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2667, 2654, 2654, 2642, 2645, 2648, 2629, 2627, 2629, 2628, 2644, 2689], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8129584, 'remaining_params': 76888016, 'pruned_model_sparsity': 0.0956223652514303, 'expected_sparsity': 0.09716, 'target_sparsity': 0.03846153846153846, 'step': 200}


Iteration:  56%|█████▋    | 44/78 [00:15<00:17,  1.93it/s][A04/28/2024 18:28:41 - INFO - trainer.trainer_mod_2 - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  58%|█████▊    | 45/78 [00:15<00:15,  2.20it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:13,  2.39it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:12,  2.55it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:11,  2.68it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:10,  2.77it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.84it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.89it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.92it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.95it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.97it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.98it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  2.98it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.99it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  2.99it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.99it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  3.00it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.99it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.00it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  3.00it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.00it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.00it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.00it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.99it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.00it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.99it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.99it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.00it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.00it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.15it/s][A04/28/2024 18:28:52 - INFO - trainer.trainer_mod_2 - Epoch 2 finished. Took 26.54 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:   3%|▎         | 3/100 [01:12<40:19, 24.94s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.01it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.01it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.01it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.01it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.99it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.98it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  2.99it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.99it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.99it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.98it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  2.99it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.99it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  2.99it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.99it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 18:28:57,534 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:28:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:28:57 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:28:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:28:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.50it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.31it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.88it/s]04/28/2024 18:28:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:28:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.68031484, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2708, 2693, 2693, 2678, 2681, 2684, 2661, 2659, 2666, 2668, 2697, 2767], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7365116, 'remaining_params': 77652484, 'pruned_model_sparsity': 0.08663048592291478, 'expected_sparsity': 0.0882, 'target_sparsity': 0.057692307692307696, 'step': 250}


Iteration:  21%|██        | 16/78 [00:05<00:32,  1.92it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:28,  2.15it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:25,  2.35it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:23,  2.52it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:21,  2.65it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:20,  2.75it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.82it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.88it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.91it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.94it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.96it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.92it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.94it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.96it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.96it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.98it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.99it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.98it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.99it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.00it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.98it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.99it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  2.99it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  3.00it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.00it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.00it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.00it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.99it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.99it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.99it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.98it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  3.00it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.00it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.00it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.02it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.01it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.01it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.01it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.01it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.01it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  3.00it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.00it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.00it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.99it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.00it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.00it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.00it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 18:29:14,839 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:29:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:29:14 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:29:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:29:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.39it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.32it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.29it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.86it/s]04/28/2024 18:29:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:29:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.68391395, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2745, 2729, 2729, 2712, 2713, 2715, 2690, 2689, 2700, 2704, 2742, 2828], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6689504, 'remaining_params': 78328096, 'pruned_model_sparsity': 0.07868375489310449, 'expected_sparsity': 0.08031, 'target_sparsity': 0.07692307692307691, 'step': 300}


Iteration:  85%|████████▍ | 66/78 [00:23<00:06,  1.92it/s][A04/28/2024 18:29:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  86%|████████▌ | 67/78 [00:23<00:05,  2.15it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:04,  2.35it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  2.51it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:03,  2.64it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.74it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  2.82it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.88it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.92it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.96it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.98it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.13it/s][A04/28/2024 18:29:19 - INFO - trainer.trainer_mod_2 - Epoch 3 finished. Took 27.21 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.87it/s]
Epoch:   4%|▍         | 4/100 [01:40<41:20, 25.84s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.04it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.04it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.04it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.04it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.03it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.02it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.02it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.01it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.01it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.01it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.02it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.01it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.01it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.00it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.01it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.00it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.03it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.02it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.01it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.01it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.01it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.02it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  2.99it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:17,  2.99it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.99it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  2.99it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.00it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.99it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.96it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:15,  2.98it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.99it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  2.98it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:14,  2.99it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 18:29:32,047 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:29:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:29:32 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:29:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:29:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.43it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.29it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.28it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.29it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.85it/s]04/28/2024 18:29:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:29:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 0.72183627, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2773, 2757, 2759, 2739, 2740, 2741, 2714, 2714, 2727, 2733, 2777, 2869], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6157900, 'remaining_params': 78859700, 'pruned_model_sparsity': 0.07243088489912677, 'expected_sparsity': 0.07401, 'target_sparsity': 0.09615384615384616, 'step': 350}


Iteration:  49%|████▊     | 38/78 [00:13<00:20,  1.92it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:18,  2.15it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:16,  2.34it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:14,  2.51it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:13,  2.64it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:12,  2.73it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:12,  2.81it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.87it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.91it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.98it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.99it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  2.99it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.00it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  3.00it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.00it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.00it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.99it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.98it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.04it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.03it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.03it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.03it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.02it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.02it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.02it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.99it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.99it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  3.00it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.99it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  3.00it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.98it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.99it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.00it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.00it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.00it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.32it/s][A04/28/2024 18:29:45 - INFO - trainer.trainer_mod_2 - Epoch 4 finished. Took 26.46 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:   5%|▌         | 5/100 [02:06<41:15, 26.06s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.01it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.00it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.00it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.00it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.02it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.01it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.00it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.01it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 18:29:49,192 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:29:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:29:49 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:29:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:29:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.50it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.31it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.31it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.26it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.84it/s]04/28/2024 18:29:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:29:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 0.6727804, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2796, 2779, 2782, 2760, 2761, 2761, 2733, 2733, 2747, 2754, 2802, 2896], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5758048, 'remaining_params': 79259552, 'pruned_model_sparsity': 0.06772771755495333, 'expected_sparsity': 0.06932, 'target_sparsity': 0.11538461538461539, 'step': 400}


Iteration:  13%|█▎        | 10/78 [00:03<00:35,  1.90it/s][A04/28/2024 18:29:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 11/78 [00:04<00:31,  2.14it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:28,  2.35it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:25,  2.51it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:24,  2.65it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:22,  2.74it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.82it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.87it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.91it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.94it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.96it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.96it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.97it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.99it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.99it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.98it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.98it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  3.00it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.00it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  3.00it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.00it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.00it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.00it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.00it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.00it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.99it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.99it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  2.99it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.99it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.00it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  3.00it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.99it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.98it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.99it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.00it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.00it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.02it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.01it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.00it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.97it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.98it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  2.99it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.99it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.99it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.00it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  3.00it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.01it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 18:30:06,494 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:30:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:30:06 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:30:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:30:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.42it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.28it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.29it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.84it/s]04/28/2024 18:30:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:30:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.5992779783393501, 'eval_loss': 0.7179765, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2810, 2794, 2797, 2774, 2775, 2775, 2745, 2746, 2761, 2767, 2816, 2911], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5502204, 'remaining_params': 79515396, 'pruned_model_sparsity': 0.06471841124661247, 'expected_sparsity': 0.06632, 'target_sparsity': 0.1346153846153846, 'step': 450}


Iteration:  77%|███████▋  | 60/78 [00:21<00:09,  1.92it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:07,  2.14it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:06,  2.34it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:05,  2.51it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.64it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.73it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:04,  2.81it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.86it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.91it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  2.94it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.96it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.96it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  2.98it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.98it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.99it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.98it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.99it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.15it/s][A04/28/2024 18:30:13 - INFO - trainer.trainer_mod_2 - Epoch 5 finished. Took 27.21 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.87it/s]
Epoch:   6%|▌         | 6/100 [02:33<41:26, 26.45s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.00it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.00it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.99it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  2.98it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  2.97it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:24,  2.99it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  2.98it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.98it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.99it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.99it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.00it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.00it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.00it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.99it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.99it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.00it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.00it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.99it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.00it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.00it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.02it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.00it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  2.99it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.99it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.99it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.00it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.00it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.01it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.01it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 18:30:23,757 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:30:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:30:23 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:30:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:30:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.40it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.31it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.30it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.86it/s]04/28/2024 18:30:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:30:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.6812482, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2817, 2801, 2805, 2780, 2782, 2782, 2751, 2752, 2767, 2770, 2820, 2915], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5393432, 'remaining_params': 79624168, 'pruned_model_sparsity': 0.06343900557061126, 'expected_sparsity': 0.06504, 'target_sparsity': 0.15384615384615383, 'step': 500}


Iteration:  41%|████      | 32/78 [00:11<00:23,  1.92it/s][A04/28/2024 18:30:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 33/78 [00:11<00:20,  2.15it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:18,  2.35it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:17,  2.51it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:15,  2.64it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.74it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:14,  2.82it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.87it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.90it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  2.94it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.95it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.96it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  2.98it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.98it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.00it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  2.99it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.99it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  2.99it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.03it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.01it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.01it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.01it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.00it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  3.00it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.00it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.99it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.99it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  2.99it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.00it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.99it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.00it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  3.00it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.00it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  3.00it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.00it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.99it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.99it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.99it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  3.00it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.00it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.00it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.13it/s][A04/28/2024 18:30:39 - INFO - trainer.trainer_mod_2 - Epoch 6 finished. Took 26.59 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:   7%|▋         | 7/100 [03:00<41:04, 26.50s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.98it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.99it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:25,  2.98it/s][A[INFO|trainer.py:570] 2024-04-28 18:30:41,010 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:30:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:30:41 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:30:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:30:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.42it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.31it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.31it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.86it/s]04/28/2024 18:30:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:30:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.7523057, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2815, 2799, 2803, 2778, 2780, 2781, 2746, 2747, 2762, 2761, 2808, 2904], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5482288, 'remaining_params': 79535312, 'pruned_model_sparsity': 0.06448415386931647, 'expected_sparsity': 0.06612, 'target_sparsity': 0.17307692307692304, 'step': 550}


Iteration:   5%|▌         | 4/78 [00:01<00:43,  1.72it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:36,  2.03it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:31,  2.28it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:28,  2.48it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:26,  2.62it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:25,  2.69it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:24,  2.79it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.85it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.91it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.94it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.95it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.97it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.98it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.99it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.98it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.00it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.00it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.99it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.98it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.99it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.01it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.97it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.98it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.99it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.00it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.00it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.01it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.01it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.01it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.02it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.01it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  3.00it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.01it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.01it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  3.00it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.00it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  3.00it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.01it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.01it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.01it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.01it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.01it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.00it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.04it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 18:30:58,270 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:30:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:30:58 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:30:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:30:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.46it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.30it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.26it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.22it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.79it/s]04/28/2024 18:30:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:30:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 0.9156487, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2802, 2785, 2791, 2762, 2767, 2769, 2729, 2729, 2744, 2733, 2773, 2867], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5839244, 'remaining_params': 79178356, 'pruned_model_sparsity': 0.06868276686239085, 'expected_sparsity': 0.07047, 'target_sparsity': 0.19230769230769232, 'step': 600}


Iteration:  69%|██████▉   | 54/78 [00:19<00:12,  1.92it/s][A04/28/2024 18:30:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 55/78 [00:19<00:10,  2.16it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:09,  2.35it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:08,  2.51it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:07,  2.64it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.74it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:06,  2.81it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.86it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.90it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:05,  2.94it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.97it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.98it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:04,  2.99it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.00it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:03,  3.00it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.99it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.99it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  3.00it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.00it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.00it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:00,  3.00it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.01it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.00it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.14it/s][A04/28/2024 18:31:06 - INFO - trainer.trainer_mod_2 - Epoch 7 finished. Took 27.17 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.87it/s]
Epoch:   8%|▊         | 8/100 [03:27<40:57, 26.71s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.98it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.04it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.03it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.02it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.02it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.02it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.02it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.01it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.01it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  2.99it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.00it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.00it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.01it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.01it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.00it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.01it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:20,  3.00it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.01it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.01it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.01it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.00it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.01it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.00it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.00it/s][A[INFO|trainer.py:570] 2024-04-28 18:31:15,480 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:31:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:31:15 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:31:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:31:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.43it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.29it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.32it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.86it/s]04/28/2024 18:31:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:31:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.8689848, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2772, 2754, 2763, 2730, 2738, 2743, 2694, 2692, 2706, 2673, 2689, 2749], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6678780, 'remaining_params': 78338820, 'pruned_model_sparsity': 0.07855761630532972, 'expected_sparsity': 0.08075, 'target_sparsity': 0.21153846153846154, 'step': 650}


Iteration:  33%|███▎      | 26/78 [00:09<00:27,  1.92it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:23,  2.15it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:21,  2.35it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:19,  2.52it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:18,  2.65it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:17,  2.74it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:16,  2.79it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.86it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:15,  2.90it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  2.92it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.95it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.97it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  2.97it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.99it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.99it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.01it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.00it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.02it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.00it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.02it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.02it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.02it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.02it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.02it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.02it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.02it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.02it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.02it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.01it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.01it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.01it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.02it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.03it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.01it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.01it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.00it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.01it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  3.00it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.00it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.99it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.97it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.94it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.97it/s][A[INFO|trainer.py:570] 2024-04-28 18:31:32,750 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:31:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:31:32 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:31:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:31:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.36it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.25it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.28it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.83it/s]04/28/2024 18:31:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:31:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7220216606498195, 'eval_loss': 0.8003462, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2711, 2689, 2707, 2670, 2683, 2694, 2631, 2626, 2635, 2552, 2484, 2333], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8651996, 'remaining_params': 76365604, 'pruned_model_sparsity': 0.10176711645588678, 'expected_sparsity': 0.10528, 'target_sparsity': 0.23076923076923078, 'step': 700}


Iteration:  97%|█████████▋| 76/78 [00:26<00:01,  1.91it/s][A04/28/2024 18:31:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.14it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.44it/s][A04/28/2024 18:31:33 - INFO - trainer.trainer_mod_2 - Epoch 8 finished. Took 27.15 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.87it/s]
Epoch:   9%|▉         | 9/100 [03:54<40:43, 26.85s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  2.98it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  2.99it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:24,  3.00it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.01it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.00it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.01it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.02it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.01it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.01it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.01it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.00it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:22,  3.00it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.00it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  2.99it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:21,  2.99it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.00it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.01it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.01it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.00it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:19,  2.99it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.00it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  2.99it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:18,  2.99it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.00it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.00it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.00it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.00it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.00it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:16,  3.00it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.01it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.01it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:15,  3.00it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.00it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.00it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.03it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.02it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.02it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.02it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.00it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.00it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.01it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.01it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.01it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.00it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.99it/s][A[INFO|trainer.py:570] 2024-04-28 18:31:49,974 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:31:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:31:49 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:31:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:31:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.43it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.29it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.27it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.85it/s]04/28/2024 18:31:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:31:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7184115523465704, 'eval_loss': 0.79249173, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2593, 2566, 2606, 2566, 2587, 2609, 2525, 2511, 2504, 2314, 2052, 1527], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 12413056, 'remaining_params': 72604544, 'pruned_model_sparsity': 0.1460057211683228, 'expected_sparsity': 0.15414, 'target_sparsity': 0.25, 'step': 750}


Iteration:  62%|██████▏   | 48/78 [00:16<00:15,  1.91it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:13,  2.14it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:11,  2.35it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:10,  2.51it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.65it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:09,  2.75it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.82it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.88it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  2.91it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.94it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  2.95it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.96it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.97it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  2.98it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.98it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.99it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.98it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.99it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.99it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.99it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.00it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  3.00it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.00it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.00it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.01it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.04it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.03it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.16it/s][A04/28/2024 18:32:00 - INFO - trainer.trainer_mod_2 - Epoch 9 finished. Took 26.53 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  10%|█         | 10/100 [04:21<40:07, 26.75s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.04it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.03it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:24,  3.01it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:24,  2.99it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.00it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  2.99it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:23,  2.99it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.00it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.00it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.00it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.00it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.00it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.01it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.00it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.00it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.00it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.01it/s][A[INFO|trainer.py:570] 2024-04-28 18:32:07,173 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:32:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:32:07 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:32:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:32:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.33it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.35it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.33it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.89it/s]04/28/2024 18:32:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:32:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.7184115523465704, 'eval_loss': 0.8397098, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2405, 2376, 2448, 2406, 2440, 2480, 2367, 2342, 2304, 1976, 1506, 997], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 18403176, 'remaining_params': 66614424, 'pruned_model_sparsity': 0.21646313233965672, 'expected_sparsity': 0.21531, 'target_sparsity': 0.2692307692307692, 'step': 800}


Iteration:  26%|██▌       | 20/78 [00:07<00:30,  1.93it/s][A04/28/2024 18:32:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  27%|██▋       | 21/78 [00:07<00:26,  2.16it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:23,  2.36it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:21,  2.52it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:20,  2.65it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:19,  2.75it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:18,  2.82it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.87it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:17,  2.91it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.94it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.96it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.98it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.99it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.99it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.00it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.00it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.99it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.99it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.00it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.00it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.00it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:12,  3.01it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.99it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.00it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.00it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.00it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.01it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.01it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.01it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.03it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.03it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.03it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.04it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.03it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.02it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.02it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.01it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.01it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.01it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.01it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.01it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.04it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.04it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 18:32:24,373 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:32:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:32:24 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:32:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:32:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.44it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.34it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.36it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.92it/s]04/28/2024 18:32:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:32:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.8571983, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [2176, 2154, 2241, 2201, 2257, 2319, 2180, 2138, 2061, 1649, 1082, 808], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 12], 'pruned_params': 22766312, 'remaining_params': 62251288, 'pruned_model_sparsity': 0.2677835177657332, 'expected_sparsity': 0.2792, 'target_sparsity': 0.28846153846153844, 'step': 850}


Iteration:  90%|████████▉ | 70/78 [00:24<00:04,  1.94it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:03,  2.18it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:02,  2.38it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.54it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.66it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  2.79it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.87it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.91it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.08it/s][A04/28/2024 18:32:27 - INFO - trainer.trainer_mod_2 - Epoch 10 finished. Took 27.05 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.88it/s]
Epoch:  11%|█         | 11/100 [04:48<39:49, 26.84s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.04it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:24,  2.97it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  2.98it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.00it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.01it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.02it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.03it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.05it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.04it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:20,  3.03it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.01it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.02it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:19,  3.05it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.05it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.05it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.04it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.04it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.04it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.02it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.03it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.02it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.04it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.05it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.04it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.03it/s][A[INFO|trainer.py:570] 2024-04-28 18:32:41,410 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:32:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:32:41 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:32:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:32:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.51it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.48it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.40it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.42it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.00it/s]04/28/2024 18:32:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:32:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.5415162454873647, 'eval_loss': 0.770947, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0], 'hidden_dims': 766, 'intermediate_dims': [1960, 1951, 2030, 1992, 2072, 2152, 2018, 1939, 1835, 1448, 837, 731], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 10, 12, 12, 11, 11], 'pruned_params': 28784008, 'remaining_params': 56233592, 'pruned_model_sparsity': 0.33856528530563085, 'expected_sparsity': 0.35054, 'target_sparsity': 0.30769230769230765, 'step': 900}


Iteration:  54%|█████▍    | 42/78 [00:14<00:18,  1.94it/s][A04/28/2024 18:32:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 900, Alignment: tensor([2, 5, 8, 9], device='cuda:0')

Iteration:  55%|█████▌    | 43/78 [00:14<00:16,  2.18it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:14,  2.38it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:12,  2.55it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.69it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:11,  2.80it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.88it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  2.92it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  2.96it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  3.00it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.00it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.01it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.03it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.05it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.19it/s][A04/28/2024 18:32:53 - INFO - trainer.trainer_mod_2 - Epoch 11 finished. Took 26.15 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.98it/s]
Epoch:  12%|█▏        | 12/100 [05:14<39:03, 26.63s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.03it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.04it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.05it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:23,  3.02it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.04it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.04it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.05it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 18:32:58,319 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:32:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:32:58 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:32:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:32:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]04/28/2024 18:32:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:32:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.79749846, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1786, 1790, 1852, 1816, 1916, 2007, 1943, 1779, 1663, 1369, 732, 690], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 10, 12, 11, 11, 11], 'pruned_params': 35379268, 'remaining_params': 49638332, 'pruned_model_sparsity': 0.41614051678711234, 'expected_sparsity': 0.40085, 'target_sparsity': 0.32692307692307687, 'step': 950}


Iteration:  18%|█▊        | 14/78 [00:05<00:32,  1.95it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:28,  2.18it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:25,  2.39it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:23,  2.56it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:22,  2.69it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:21,  2.80it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:20,  2.88it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.94it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.98it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.02it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.04it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.05it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.10it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.04it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.04it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.04it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.05it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.05it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:33:15,218 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:33:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:33:15 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:33:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:33:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.09it/s]04/28/2024 18:33:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:33:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.8543365, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1663, 1676, 1723, 1689, 1799, 1896, 1915, 1655, 1533, 1336, 692, 667], 'head_nums': [12, 12, 12, 11, 12, 12, 12, 9, 12, 11, 11, 11], 'pruned_params': 37265160, 'remaining_params': 47752440, 'pruned_model_sparsity': 0.43832288843721773, 'expected_sparsity': 0.42899, 'target_sparsity': 0.3461538461538461, 'step': 1000}


Iteration:  82%|████████▏ | 64/78 [00:22<00:07,  1.97it/s][A04/28/2024 18:33:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 1000, Alignment: tensor([ 2,  5,  8, 10], device='cuda:0')

Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.20it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:05,  2.39it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:04,  2.56it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.68it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.79it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.84it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.91it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.95it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  2.96it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.00it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.02it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A04/28/2024 18:33:20 - INFO - trainer.trainer_mod_2 - Epoch 12 finished. Took 26.64 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  13%|█▎        | 13/100 [05:41<38:37, 26.64s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.03it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.04it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:33:32,077 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:33:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:33:32 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:33:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:33:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.10it/s]04/28/2024 18:33:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:33:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.8294413, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1577, 1597, 1630, 1596, 1716, 1816, 1900, 1566, 1440, 1317, 674, 650], 'head_nums': [12, 12, 12, 11, 12, 12, 11, 9, 12, 11, 11, 11], 'pruned_params': 38527528, 'remaining_params': 46490072, 'pruned_model_sparsity': 0.4531712021981331, 'expected_sparsity': 0.44729, 'target_sparsity': 0.36538461538461536, 'step': 1050}


Iteration:  46%|████▌     | 36/78 [00:12<00:21,  1.96it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:18,  2.21it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:16,  2.40it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:15,  2.57it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:14,  2.70it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:13,  2.81it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.88it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.94it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.98it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.01it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.03it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.02it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.04it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.04it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.05it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.03it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.04it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.04it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.05it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A04/28/2024 18:33:46 - INFO - trainer.trainer_mod_2 - Epoch 13 finished. Took 25.97 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.00it/s]
Epoch:  14%|█▍        | 14/100 [06:07<37:53, 26.43s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:33:48,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:33:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:33:48 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:33:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:33:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.13it/s]04/28/2024 18:33:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:33:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.84481645, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1519, 1543, 1568, 1534, 1657, 1758, 1891, 1499, 1374, 1305, 664, 639], 'head_nums': [12, 12, 11, 11, 12, 12, 11, 9, 12, 11, 10, 11], 'pruned_params': 39664272, 'remaining_params': 45353328, 'pruned_model_sparsity': 0.46654189250225836, 'expected_sparsity': 0.46005, 'target_sparsity': 0.38461538461538464, 'step': 1100}


Iteration:  10%|█         | 8/78 [00:03<00:36,  1.92it/s][A04/28/2024 18:33:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 1100, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  12%|█▏        | 9/78 [00:03<00:31,  2.17it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:28,  2.39it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:26,  2.57it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.72it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.82it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:22,  2.90it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.95it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.96it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.99it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.02it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.03it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.04it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.04it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.04it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.05it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.04it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.05it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.05it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.05it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:34:05,837 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:34:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:34:05 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:34:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:34:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.10it/s]04/28/2024 18:34:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:34:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.8550863, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1479, 1508, 1526, 1490, 1615, 1717, 1885, 1451, 1326, 1297, 657, 631], 'head_nums': [12, 12, 11, 11, 12, 12, 11, 9, 12, 11, 10, 11], 'pruned_params': 40185152, 'remaining_params': 44832448, 'pruned_model_sparsity': 0.4726686239084613, 'expected_sparsity': 0.46835, 'target_sparsity': 0.40384615384615385, 'step': 1150}


Iteration:  74%|███████▍  | 58/78 [00:20<00:10,  1.96it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:08,  2.20it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:07,  2.40it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.56it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.71it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.81it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.89it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.94it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.98it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.01it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.03it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.03it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A04/28/2024 18:34:12 - INFO - trainer.trainer_mod_2 - Epoch 14 finished. Took 26.57 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  15%|█▌        | 15/100 [06:33<37:30, 26.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.05it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.05it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:16,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 18:34:22,669 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:34:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:34:22 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:34:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:34:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.50it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.08it/s]04/28/2024 18:34:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:34:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.88494754, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1450, 1483, 1495, 1458, 1584, 1686, 1881, 1416, 1288, 1291, 652, 625], 'head_nums': [12, 12, 11, 11, 12, 12, 11, 9, 12, 11, 10, 11], 'pruned_params': 40571216, 'remaining_params': 44446384, 'pruned_model_sparsity': 0.4772096130683529, 'expected_sparsity': 0.47444, 'target_sparsity': 0.4230769230769231, 'step': 1200}


Iteration:  38%|███▊      | 30/78 [00:10<00:24,  1.96it/s][A04/28/2024 18:34:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 1200, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  40%|███▉      | 31/78 [00:10<00:21,  2.19it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:19,  2.40it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:17,  2.57it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:16,  2.70it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:15,  2.80it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.88it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.94it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.98it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  3.00it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.02it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.02it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.04it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.11it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.10it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.10it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 18:34:38 - INFO - trainer.trainer_mod_2 - Epoch 15 finished. Took 25.93 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  16%|█▌        | 16/100 [06:59<36:50, 26.31s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:34:39,488 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:34:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:34:39 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:34:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:34:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.12it/s]04/28/2024 18:34:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:34:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.90524507, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1427, 1462, 1472, 1432, 1560, 1662, 1877, 1385, 1256, 1286, 648, 620], 'head_nums': [12, 12, 11, 11, 12, 12, 11, 9, 12, 11, 10, 11], 'pruned_params': 40883744, 'remaining_params': 44133856, 'pruned_model_sparsity': 0.48088565191207466, 'expected_sparsity': 0.47943, 'target_sparsity': 0.44230769230769235, 'step': 1250}


Iteration:   3%|▎         | 2/78 [00:01<00:52,  1.45it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:39,  1.91it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:32,  2.24it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:29,  2.49it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:27,  2.66it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.79it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.89it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.94it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.98it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  3.01it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.01it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.03it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  3.05it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.06it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.01it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.02it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.03it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.03it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:34:56,377 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:34:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:34:56 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:34:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:34:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]04/28/2024 18:34:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:34:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.91948193, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1407, 1444, 1450, 1408, 1536, 1639, 1874, 1357, 1227, 1281, 645, 615], 'head_nums': [12, 12, 11, 11, 12, 12, 11, 9, 12, 11, 9, 11], 'pruned_params': 41367856, 'remaining_params': 43649744, 'pruned_model_sparsity': 0.4865799081601927, 'expected_sparsity': 0.48435, 'target_sparsity': 0.46153846153846156, 'step': 1300}


Iteration:  67%|██████▋   | 52/78 [00:18<00:13,  1.96it/s][A04/28/2024 18:34:57 - INFO - trainer.trainer_mod_2 - v4 Global step: 1300, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  68%|██████▊   | 53/78 [00:18<00:11,  2.19it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:10,  2.39it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.57it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.71it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.81it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.89it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.97it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  3.00it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.03it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.04it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.21it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.17it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.15it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.12it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A04/28/2024 18:35:05 - INFO - trainer.trainer_mod_2 - Epoch 16 finished. Took 26.52 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  17%|█▋        | 17/100 [07:26<36:29, 26.37s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:35:13,165 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:35:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:35:13 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:35:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:35:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.51it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.10it/s]04/28/2024 18:35:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:35:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.8928433, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1387, 1424, 1426, 1384, 1513, 1615, 1870, 1328, 1195, 1277, 641, 610], 'head_nums': [12, 12, 11, 11, 12, 12, 11, 9, 12, 10, 9, 11], 'pruned_params': 41864224, 'remaining_params': 43153376, 'pruned_model_sparsity': 0.49241832279433906, 'expected_sparsity': 0.48938, 'target_sparsity': 0.4807692307692308, 'step': 1350}


Iteration:  31%|███       | 24/78 [00:08<00:27,  1.96it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:24,  2.20it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:21,  2.42it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:19,  2.58it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:18,  2.71it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.80it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.88it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.94it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.96it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.99it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.02it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.04it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.03it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.04it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.05it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.10it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.10it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.06it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.06it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 18:35:30,044 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:35:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:35:30 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:35:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:35:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.79it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:35:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:35:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.87168485, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1360, 1399, 1396, 1354, 1485, 1585, 1867, 1294, 1161, 1271, 638, 605], 'head_nums': [12, 12, 11, 11, 12, 12, 11, 9, 12, 10, 9, 11], 'pruned_params': 42228840, 'remaining_params': 42788760, 'pruned_model_sparsity': 0.4967070347786811, 'expected_sparsity': 0.49488, 'target_sparsity': 0.5, 'step': 1400}


Iteration:  95%|█████████▍| 74/78 [00:25<00:02,  1.95it/s][A04/28/2024 18:35:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 1400, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.19it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.39it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.56it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.80it/s][A04/28/2024 18:35:31 - INFO - trainer.trainer_mod_2 - Epoch 17 finished. Took 26.56 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  18%|█▊        | 18/100 [07:52<36:07, 26.43s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.05it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.05it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:35:46,885 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:35:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:35:46 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:35:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:35:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]04/28/2024 18:35:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:35:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.90784085, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1327, 1369, 1362, 1318, 1450, 1549, 1862, 1253, 1119, 1264, 633, 598], 'head_nums': [12, 12, 11, 11, 12, 12, 11, 9, 12, 10, 9, 11], 'pruned_params': 42668524, 'remaining_params': 42349076, 'pruned_model_sparsity': 0.5018787168774466, 'expected_sparsity': 0.5011, 'target_sparsity': 0.5192307692307693, 'step': 1450}


Iteration:  59%|█████▉    | 46/78 [00:15<00:16,  1.96it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:14,  2.20it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:12,  2.40it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:11,  2.57it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:10,  2.70it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.81it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.88it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.93it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.00it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.03it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A04/28/2024 18:35:57 - INFO - trainer.trainer_mod_2 - Epoch 18 finished. Took 25.95 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  19%|█▉        | 19/100 [08:18<35:29, 26.29s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.05it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.05it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 18:36:03,738 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:36:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:36:03 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:36:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:36:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.53it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.12it/s]04/28/2024 18:36:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:36:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.9336931, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1286, 1331, 1319, 1273, 1406, 1504, 1856, 1205, 1071, 1257, 628, 590], 'head_nums': [12, 12, 11, 11, 12, 11, 11, 9, 12, 10, 9, 11], 'pruned_params': 43403884, 'remaining_params': 41613716, 'pruned_model_sparsity': 0.5105282200391449, 'expected_sparsity': 0.50888, 'target_sparsity': 0.5384615384615384, 'step': 1500}


Iteration:  23%|██▎       | 18/78 [00:06<00:30,  1.95it/s][A04/28/2024 18:36:04 - INFO - trainer.trainer_mod_2 - v4 Global step: 1500, Alignment: tensor([1, 2, 3, 4], device='cuda:0')

Iteration:  24%|██▍       | 19/78 [00:06<00:26,  2.19it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:24,  2.41it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:22,  2.58it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:20,  2.71it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.81it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.88it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.93it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.98it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.05it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  3.05it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:36:20,596 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:36:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:36:20 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:36:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:36:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.12it/s]04/28/2024 18:36:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:36:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6895306859205776, 'eval_loss': 0.8800596, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1240, 1288, 1268, 1221, 1354, 1450, 1848, 1149, 1016, 1248, 622, 580], 'head_nums': [12, 12, 11, 11, 12, 11, 11, 9, 12, 10, 9, 11], 'pruned_params': 44030472, 'remaining_params': 40987128, 'pruned_model_sparsity': 0.517898317524842, 'expected_sparsity': 0.51829, 'target_sparsity': 0.5576923076923077, 'step': 1550}


Iteration:  87%|████████▋ | 68/78 [00:23<00:05,  1.97it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:04,  2.20it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:03,  2.40it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.57it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.71it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.82it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.89it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.97it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.00it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.15it/s][A04/28/2024 18:36:24 - INFO - trainer.trainer_mod_2 - Epoch 19 finished. Took 26.55 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  20%|██        | 20/100 [08:45<35:09, 26.37s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.05it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:36:37,448 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:36:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:36:37 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:36:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:36:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.15it/s]04/28/2024 18:36:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:36:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6967509025270758, 'eval_loss': 0.9435416, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1189, 1239, 1211, 1164, 1296, 1388, 1838, 1084, 956, 1237, 616, 569], 'head_nums': [12, 12, 11, 11, 11, 11, 11, 9, 12, 10, 9, 11], 'pruned_params': 44929756, 'remaining_params': 40087844, 'pruned_model_sparsity': 0.5284759390996687, 'expected_sparsity': 0.52956, 'target_sparsity': 0.5769230769230769, 'step': 1600}


Iteration:  51%|█████▏    | 40/78 [00:13<00:19,  1.96it/s][A04/28/2024 18:36:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 1600, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  53%|█████▎    | 41/78 [00:13<00:16,  2.19it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:15,  2.40it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:13,  2.56it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:12,  2.71it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.81it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.90it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.94it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.98it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.01it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.02it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.05it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A04/28/2024 18:36:50 - INFO - trainer.trainer_mod_2 - Epoch 20 finished. Took 25.94 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  21%|██        | 21/100 [09:11<34:32, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.05it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:36:54,280 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:36:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:36:54 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:36:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:36:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.10it/s]04/28/2024 18:36:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:36:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.94915956, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1130, 1185, 1149, 1101, 1231, 1320, 1826, 1015, 891, 1223, 608, 556], 'head_nums': [12, 12, 11, 11, 11, 10, 11, 8, 12, 10, 8, 10], 'pruned_params': 46487800, 'remaining_params': 38529800, 'pruned_model_sparsity': 0.546802073923517, 'expected_sparsity': 0.54327, 'target_sparsity': 0.5961538461538461, 'step': 1650}


Iteration:  15%|█▌        | 12/78 [00:04<00:33,  1.94it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:29,  2.18it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:26,  2.38it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:24,  2.55it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:23,  2.67it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.78it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.88it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.93it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.98it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.01it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.03it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.05it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:15,  3.15it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.13it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.11it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.11it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.10it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.04it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.05it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.03it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.04it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.04it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.04it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:37:11,157 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:37:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:37:11 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:37:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:37:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.54it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.56it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.09it/s]04/28/2024 18:37:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:37:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 0.94511795, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1074, 1130, 1087, 1037, 1164, 1247, 1812, 945, 828, 1208, 598, 541], 'head_nums': [12, 12, 11, 10, 11, 10, 11, 8, 11, 9, 8, 10], 'pruned_params': 47857408, 'remaining_params': 37160192, 'pruned_model_sparsity': 0.56291177356218, 'expected_sparsity': 0.55748, 'target_sparsity': 0.6, 'step': 1700}


Iteration:  79%|███████▉  | 62/78 [00:21<00:08,  1.95it/s][A04/28/2024 18:37:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 1700, Alignment: tensor([2, 5, 7, 8], device='cuda:0')

Iteration:  81%|████████  | 63/78 [00:21<00:06,  2.19it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:05,  2.40it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.57it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.71it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  2.81it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.88it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.93it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.97it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.02it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.04it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A04/28/2024 18:37:16 - INFO - trainer.trainer_mod_2 - Epoch 21 finished. Took 26.58 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  22%|██▏       | 22/100 [09:37<34:14, 26.34s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:37:27,969 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:37:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:37:27 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:37:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:37:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.10it/s]04/28/2024 18:37:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:37:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.9367082, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1021, 1079, 1030, 978, 1102, 1178, 1796, 880, 772, 1191, 588, 525], 'head_nums': [12, 12, 11, 10, 11, 10, 11, 8, 11, 9, 8, 10], 'pruned_params': 48580512, 'remaining_params': 36437088, 'pruned_model_sparsity': 0.57141711833785, 'expected_sparsity': 0.56908, 'target_sparsity': 0.6, 'step': 1750}


Iteration:  44%|████▎     | 34/78 [00:11<00:22,  1.97it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:19,  2.20it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:17,  2.41it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:15,  2.58it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:14,  2.69it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.81it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.91it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.97it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.00it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.03it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.04it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.10it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A04/28/2024 18:37:42 - INFO - trainer.trainer_mod_2 - Epoch 22 finished. Took 25.87 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  23%|██▎       | 23/100 [10:03<33:37, 26.20s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.11it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:37:44,767 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:37:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:37:44 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:37:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:37:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.57it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]04/28/2024 18:37:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:37:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6787003610108303, 'eval_loss': 0.93837655, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [973, 1033, 980, 924, 1045, 1114, 1780, 823, 725, 1173, 578, 510], 'head_nums': [12, 12, 11, 10, 11, 10, 11, 8, 11, 9, 8, 10], 'pruned_params': 49228548, 'remaining_params': 35789052, 'pruned_model_sparsity': 0.5790394929990966, 'expected_sparsity': 0.58032, 'target_sparsity': 0.6, 'step': 1800}


Iteration:   8%|▊         | 6/78 [00:02<00:38,  1.87it/s][A04/28/2024 18:37:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 1800, Alignment: tensor([2, 5, 7, 9], device='cuda:0')

Iteration:   9%|▉         | 7/78 [00:02<00:33,  2.15it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:29,  2.41it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:26,  2.57it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:25,  2.71it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.82it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.89it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.95it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.99it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.01it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.02it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.04it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.05it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.05it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.05it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:38:01,604 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:38:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:38:01 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:38:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:38:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.77it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:38:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:38:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.628158844765343, 'eval_loss': 0.6848637, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [932, 992, 936, 877, 995, 1057, 1764, 774, 693, 1156, 568, 495], 'head_nums': [12, 11, 11, 10, 11, 9, 11, 8, 11, 9, 8, 10], 'pruned_params': 51235468, 'remaining_params': 33782132, 'pruned_model_sparsity': 0.6026454287112316, 'expected_sparsity': 0.5951, 'target_sparsity': 0.6, 'step': 1850}


Iteration:  72%|███████▏  | 56/78 [00:19<00:11,  1.96it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:09,  2.21it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:08,  2.42it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:07,  2.59it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.72it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.82it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.89it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.94it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.97it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.03it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.05it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.10it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.23it/s][A04/28/2024 18:38:09 - INFO - trainer.trainer_mod_2 - Epoch 23 finished. Took 26.47 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  24%|██▍       | 24/100 [10:30<33:17, 26.28s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.12it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:22,  3.03it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.05it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.10it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:38:18,389 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:38:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:38:18 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:38:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:38:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]04/28/2024 18:38:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:38:19 - INFO - trainer.trainer_mod_2 - Starting saving the best from epoch 24 and step 1900
04/28/2024 18:38:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.79220283, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [899, 957, 900, 838, 952, 1007, 1748, 731, 678, 1139, 559, 481], 'head_nums': [12, 10, 11, 10, 10, 9, 11, 8, 10, 9, 8, 10], 'pruned_params': 52251184, 'remaining_params': 32766416, 'pruned_model_sparsity': 0.6145925549533273, 'expected_sparsity': 0.60781, 'target_sparsity': 0.6, 'step': 1900}
04/28/2024 18:38:19 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 24 | Step: 1900 | Model size: 32766416 | Score: 0.65343]

[INFO|configuration_utils.py:439] 2024-04-28 18:38:19,015 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 18:38:20,279 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  36%|███▌      | 28/78 [00:10<00:44,  1.12it/s][A04/28/2024 18:38:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 1900, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  37%|███▋      | 29/78 [00:11<00:35,  1.39it/s][A
Iteration:  38%|███▊      | 30/78 [00:11<00:28,  1.66it/s][A
Iteration:  40%|███▉      | 31/78 [00:11<00:24,  1.92it/s][A
Iteration:  41%|████      | 32/78 [00:12<00:21,  2.17it/s][A
Iteration:  42%|████▏     | 33/78 [00:12<00:18,  2.38it/s][A
Iteration:  44%|████▎     | 34/78 [00:12<00:17,  2.56it/s][A
Iteration:  45%|████▍     | 35/78 [00:13<00:15,  2.70it/s][A
Iteration:  46%|████▌     | 36/78 [00:13<00:14,  2.80it/s][A
Iteration:  47%|████▋     | 37/78 [00:13<00:14,  2.89it/s][A
Iteration:  49%|████▊     | 38/78 [00:14<00:13,  2.94it/s][A
Iteration:  50%|█████     | 39/78 [00:14<00:13,  2.97it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:12,  3.00it/s][A
Iteration:  53%|█████▎    | 41/78 [00:15<00:12,  3.03it/s][A
Iteration:  54%|█████▍    | 42/78 [00:15<00:11,  3.05it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:16<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:16<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:17<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:17<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:18<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:18<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:19<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:19<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:20<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:21<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.05it/s][A
Iteration:  79%|███████▉  | 62/78 [00:22<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:23<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.05it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:00,  3.05it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 18:38:36,497 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:38:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:38:36 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:38:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:38:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.80it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.23it/s]04/28/2024 18:38:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:38:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 0.9111077, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [870, 928, 870, 806, 916, 963, 1733, 696, 672, 1123, 550, 469], 'head_nums': [12, 10, 10, 10, 10, 9, 10, 8, 10, 9, 8, 10], 'pruned_params': 53003396, 'remaining_params': 32014204, 'pruned_model_sparsity': 0.6234402758958145, 'expected_sparsity': 0.61599, 'target_sparsity': 0.6, 'step': 1950}


Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.01it/s][A04/28/2024 18:38:37 - INFO - trainer.trainer_mod_2 - Epoch 24 finished. Took 27.82 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.80it/s]
Epoch:  25%|██▌       | 25/100 [10:57<33:25, 26.74s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.10it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.10it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:38:53,318 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:38:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:38:53 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:38:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:38:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.84it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/28/2024 18:38:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:38:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.95054805, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [847, 904, 847, 779, 885, 926, 1718, 668, 668, 1109, 542, 457], 'head_nums': [12, 10, 10, 10, 10, 9, 10, 8, 10, 9, 8, 10], 'pruned_params': 53299072, 'remaining_params': 31718528, 'pruned_model_sparsity': 0.6269180969587473, 'expected_sparsity': 0.62255, 'target_sparsity': 0.6, 'step': 2000}


Iteration:  64%|██████▍   | 50/78 [00:16<00:14,  1.97it/s][A04/28/2024 18:38:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 2000, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  65%|██████▌   | 51/78 [00:17<00:12,  2.22it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:10,  2.43it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:09,  2.60it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.73it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:08,  2.83it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.90it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.94it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  2.98it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.00it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.03it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.04it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 18:39:02 - INFO - trainer.trainer_mod_2 - Epoch 25 finished. Took 25.84 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  26%|██▌       | 26/100 [11:23<32:39, 26.47s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.12it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:39:10,080 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:39:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:39:10 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:39:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:39:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:39:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:39:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 0.9115602, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [828, 885, 827, 757, 861, 896, 1706, 644, 666, 1095, 535, 447], 'head_nums': [12, 10, 10, 10, 10, 9, 10, 8, 10, 9, 8, 10], 'pruned_params': 53541128, 'remaining_params': 31476472, 'pruned_model_sparsity': 0.6297652250828064, 'expected_sparsity': 0.62905, 'target_sparsity': 0.6, 'step': 2050}
04/28/2024 18:39:10 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 26 | Step: 2050 | Model size: 31476472 | Score: 0.65704]

[INFO|configuration_utils.py:439] 2024-04-28 18:39:10,731 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 18:39:11,469 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  28%|██▊       | 22/78 [00:08<00:41,  1.35it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:33,  1.63it/s][A
Iteration:  31%|███       | 24/78 [00:09<00:28,  1.90it/s][A
Iteration:  32%|███▏      | 25/78 [00:09<00:24,  2.15it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:22,  2.36it/s][A
Iteration:  35%|███▍      | 27/78 [00:10<00:20,  2.54it/s][A
Iteration:  36%|███▌      | 28/78 [00:10<00:18,  2.69it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.80it/s][A
Iteration:  38%|███▊      | 30/78 [00:11<00:16,  2.89it/s][A
Iteration:  40%|███▉      | 31/78 [00:11<00:16,  2.93it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.98it/s][A
Iteration:  42%|████▏     | 33/78 [00:12<00:14,  3.02it/s][A
Iteration:  44%|████▎     | 34/78 [00:12<00:14,  3.03it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:13<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:13<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:14<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:07,  3.03it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.04it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:39:27,684 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:39:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:39:27 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:39:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:39:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.80it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:39:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:39:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 0.9427953, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [815, 871, 813, 740, 842, 871, 1694, 625, 664, 1084, 528, 438], 'head_nums': [12, 10, 10, 10, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 54510884, 'remaining_params': 30506716, 'pruned_model_sparsity': 0.641171757377296, 'expected_sparsity': 0.63451, 'target_sparsity': 0.6, 'step': 2100}


Iteration:  92%|█████████▏| 72/78 [00:25<00:03,  1.97it/s][A04/28/2024 18:39:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 2100, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  94%|█████████▎| 73/78 [00:25<00:02,  2.20it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.41it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:01,  2.58it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  2.72it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.80it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.00it/s][A04/28/2024 18:39:30 - INFO - trainer.trainer_mod_2 - Epoch 26 finished. Took 27.25 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.86it/s]
Epoch:  27%|██▋       | 27/100 [11:50<32:29, 26.71s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.11it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.11it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.10it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:19,  3.10it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.11it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.10it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.10it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.10it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:39:44,426 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:39:44 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:39:44 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:39:44 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:39:44 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.79it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:39:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:39:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.9451217, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [804, 860, 802, 728, 827, 852, 1685, 611, 663, 1075, 523, 432], 'head_nums': [12, 10, 10, 10, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 54653360, 'remaining_params': 30364240, 'pruned_model_sparsity': 0.6428475986148751, 'expected_sparsity': 0.63837, 'target_sparsity': 0.6, 'step': 2150}
04/28/2024 18:39:45 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 27 | Step: 2150 | Model size: 30364240 | Score: 0.66065]

[INFO|configuration_utils.py:439] 2024-04-28 18:39:45,048 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 18:39:46,772 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  56%|█████▋    | 44/78 [00:16<00:34,  1.03s/it][A
Iteration:  58%|█████▊    | 45/78 [00:16<00:27,  1.20it/s][A
Iteration:  59%|█████▉    | 46/78 [00:17<00:21,  1.48it/s][A
Iteration:  60%|██████    | 47/78 [00:17<00:17,  1.75it/s][A
Iteration:  62%|██████▏   | 48/78 [00:17<00:14,  2.01it/s][A
Iteration:  63%|██████▎   | 49/78 [00:18<00:12,  2.25it/s][A
Iteration:  64%|██████▍   | 50/78 [00:18<00:11,  2.44it/s][A
Iteration:  65%|██████▌   | 51/78 [00:18<00:10,  2.60it/s][A
Iteration:  67%|██████▋   | 52/78 [00:19<00:09,  2.74it/s][A
Iteration:  68%|██████▊   | 53/78 [00:19<00:08,  2.83it/s][A
Iteration:  69%|██████▉   | 54/78 [00:19<00:08,  2.91it/s][A
Iteration:  71%|███████   | 55/78 [00:20<00:07,  2.96it/s][A
Iteration:  72%|███████▏  | 56/78 [00:20<00:07,  3.01it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:06,  3.02it/s][A
Iteration:  74%|███████▍  | 58/78 [00:21<00:06,  3.04it/s][A
Iteration:  76%|███████▌  | 59/78 [00:21<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:22<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:22<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:23<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:23<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:24<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:24<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:25<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:25<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:26<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:26<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:27<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.22it/s][A04/28/2024 18:39:57 - INFO - trainer.trainer_mod_2 - Epoch 27 finished. Took 27.59 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.83it/s]
Epoch:  28%|██▊       | 28/100 [12:18<32:21, 26.97s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.11it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.11it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:40:02,967 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:40:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:40:02 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:40:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:40:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.24it/s]04/28/2024 18:40:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:40:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 0.941172, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [798, 853, 795, 719, 817, 839, 1677, 601, 662, 1068, 519, 426], 'head_nums': [12, 10, 10, 9, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 54944440, 'remaining_params': 30073160, 'pruned_model_sparsity': 0.6462713602830473, 'expected_sparsity': 0.64068, 'target_sparsity': 0.6, 'step': 2200}


Iteration:  21%|██        | 16/78 [00:05<00:31,  1.97it/s][A04/28/2024 18:40:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 2200, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  22%|██▏       | 17/78 [00:06<00:27,  2.21it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:24,  2.43it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:22,  2.60it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:21,  2.73it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:20,  2.83it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.91it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.96it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.00it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.03it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.10it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.10it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.17it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.15it/s][A[INFO|trainer.py:570] 2024-04-28 18:40:19,740 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:40:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:40:19 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:40:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:40:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.85it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.25it/s]04/28/2024 18:40:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:40:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.98502105, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [795, 850, 793, 715, 812, 830, 1672, 594, 661, 1063, 517, 423], 'head_nums': [12, 10, 10, 9, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 54994996, 'remaining_params': 30022604, 'pruned_model_sparsity': 0.6468660136254141, 'expected_sparsity': 0.64199, 'target_sparsity': 0.6, 'step': 2250}
04/28/2024 18:40:20 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 28 | Step: 2250 | Model size: 30022604 | Score: 0.66787]

[INFO|configuration_utils.py:439] 2024-04-28 18:40:20,365 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 18:40:22,063 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  85%|████████▍ | 66/78 [00:24<00:12,  1.02s/it][A
Iteration:  86%|████████▌ | 67/78 [00:24<00:08,  1.24it/s][A
Iteration:  87%|████████▋ | 68/78 [00:24<00:06,  1.51it/s][A
Iteration:  88%|████████▊ | 69/78 [00:25<00:05,  1.78it/s][A
Iteration:  90%|████████▉ | 70/78 [00:25<00:03,  2.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:25<00:03,  2.28it/s][A
Iteration:  92%|█████████▏| 72/78 [00:26<00:02,  2.47it/s][A
Iteration:  94%|█████████▎| 73/78 [00:26<00:01,  2.63it/s][A
Iteration:  95%|█████████▍| 74/78 [00:26<00:01,  2.75it/s][A
Iteration:  96%|█████████▌| 75/78 [00:27<00:01,  2.85it/s][A
Iteration:  97%|█████████▋| 76/78 [00:27<00:00,  2.91it/s][A
Iteration:  99%|█████████▊| 77/78 [00:27<00:00,  2.98it/s][A
Iteration: 100%|██████████| 78/78 [00:28<00:00,  3.13it/s][A04/28/2024 18:40:25 - INFO - trainer.trainer_mod_2 - Epoch 28 finished. Took 28.1 seconds.
Iteration: 100%|██████████| 78/78 [00:28<00:00,  2.78it/s]
Epoch:  29%|██▉       | 29/100 [12:46<32:19, 27.31s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.10it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.10it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.10it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.04it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.16it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.13it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.13it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.11it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  3.11it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.11it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:40:38,191 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:40:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:40:38 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:40:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:40:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.23it/s]04/28/2024 18:40:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:40:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.95774496, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [796, 851, 793, 715, 811, 826, 1669, 591, 661, 1061, 515, 421], 'head_nums': [12, 10, 10, 9, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 55004188, 'remaining_params': 30013412, 'pruned_model_sparsity': 0.6469741324149353, 'expected_sparsity': 0.64238, 'target_sparsity': 0.6, 'step': 2300}


Iteration:  49%|████▊     | 38/78 [00:12<00:20,  1.97it/s][A04/28/2024 18:40:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 2300, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  50%|█████     | 39/78 [00:13<00:17,  2.21it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:15,  2.42it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:14,  2.56it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:13,  2.70it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:12,  2.81it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.89it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.94it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.98it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.01it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.04it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A04/28/2024 18:40:51 - INFO - trainer.trainer_mod_2 - Epoch 29 finished. Took 25.83 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  30%|███       | 30/100 [13:12<31:20, 26.87s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.16it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:21,  3.14it/s][A[INFO|trainer.py:570] 2024-04-28 18:40:54,937 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:40:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:40:54 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:40:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:40:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.23it/s]04/28/2024 18:40:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:40:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 1.014224, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [799, 854, 797, 717, 813, 827, 1669, 591, 661, 1061, 515, 421], 'head_nums': [12, 10, 10, 9, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 54981208, 'remaining_params': 30036392, 'pruned_model_sparsity': 0.6467038354411322, 'expected_sparsity': 0.6419, 'target_sparsity': 0.6, 'step': 2350}


Iteration:  13%|█▎        | 10/78 [00:03<00:34,  1.96it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:30,  2.21it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:27,  2.41it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:25,  2.58it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:23,  2.72it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:22,  2.82it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.89it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.94it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.98it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.02it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.03it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.05it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.11it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.10it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.10it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.10it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:41:11,762 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:41:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:41:11 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:41:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:41:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:41:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:41:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.9865463, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [807, 862, 804, 725, 821, 834, 1672, 596, 661, 1063, 517, 423], 'head_nums': [12, 10, 10, 9, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 54903076, 'remaining_params': 30114524, 'pruned_model_sparsity': 0.6457848257302018, 'expected_sparsity': 0.64022, 'target_sparsity': 0.6, 'step': 2400}


Iteration:  77%|███████▋  | 60/78 [00:20<00:09,  1.97it/s][A04/28/2024 18:41:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 2400, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  78%|███████▊  | 61/78 [00:20<00:07,  2.20it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:06,  2.41it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.57it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:05,  2.69it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.80it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.89it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.95it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.99it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.02it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.03it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.16it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.27it/s][A04/28/2024 18:41:18 - INFO - trainer.trainer_mod_2 - Epoch 30 finished. Took 26.43 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  31%|███       | 31/100 [13:38<30:44, 26.73s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:41:28,534 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:41:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:41:28 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:41:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:41:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.81it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.24it/s]04/28/2024 18:41:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:41:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.9775362, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [820, 873, 816, 736, 833, 846, 1677, 606, 662, 1068, 519, 426], 'head_nums': [12, 10, 10, 10, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 54582888, 'remaining_params': 30434712, 'pruned_model_sparsity': 0.6420186878952123, 'expected_sparsity': 0.63718, 'target_sparsity': 0.6, 'step': 2450}


Iteration:  41%|████      | 32/78 [00:11<00:23,  1.96it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:20,  2.19it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:18,  2.41it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:16,  2.58it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:15,  2.71it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.81it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.89it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.95it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.98it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.01it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.04it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.10it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.10it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.13it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.11it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.11it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.10it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.10it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.10it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.10it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.04it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.05it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A04/28/2024 18:41:44 - INFO - trainer.trainer_mod_2 - Epoch 31 finished. Took 25.88 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  32%|███▏      | 32/100 [14:04<30:00, 26.48s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:41:45,322 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:41:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:41:45 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:41:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:41:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.79it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:41:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:41:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.9575409, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [837, 890, 832, 753, 851, 863, 1686, 621, 663, 1077, 524, 432], 'head_nums': [12, 10, 10, 10, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 54403644, 'remaining_params': 30613956, 'pruned_model_sparsity': 0.6399103714995483, 'expected_sparsity': 0.63245, 'target_sparsity': 0.6, 'step': 2500}
04/28/2024 18:41:45 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 32 | Step: 2500 | Model size: 30613956 | Score: 0.67148]

[INFO|configuration_utils.py:439] 2024-04-28 18:41:45,947 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 18:41:46,617 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:   5%|▌         | 4/78 [00:02<01:01,  1.20it/s][A04/28/2024 18:41:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 2500, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:   6%|▋         | 5/78 [00:02<00:47,  1.54it/s][A
Iteration:   8%|▊         | 6/78 [00:03<00:38,  1.85it/s][A
Iteration:   9%|▉         | 7/78 [00:03<00:33,  2.13it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:29,  2.36it/s][A
Iteration:  12%|█▏        | 9/78 [00:04<00:27,  2.55it/s][A
Iteration:  13%|█▎        | 10/78 [00:04<00:25,  2.69it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.80it/s][A
Iteration:  15%|█▌        | 12/78 [00:05<00:22,  2.88it/s][A
Iteration:  17%|█▋        | 13/78 [00:05<00:22,  2.94it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.97it/s][A
Iteration:  19%|█▉        | 15/78 [00:06<00:21,  2.98it/s][A
Iteration:  21%|██        | 16/78 [00:06<00:20,  3.02it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.03it/s][A
Iteration:  23%|██▎       | 18/78 [00:07<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:07<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:08<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:08<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:09<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:09<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:10<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:10<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:11<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:11<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.10it/s][A
Iteration:  42%|████▏     | 33/78 [00:12<00:14,  3.10it/s][A
Iteration:  44%|████▎     | 34/78 [00:12<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:13<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:14<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:14<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:15<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:15<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:16<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:16<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:17<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:17<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.10it/s][A
Iteration:  67%|██████▋   | 52/78 [00:18<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:08,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:42:02,832 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:42:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:42:02 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:42:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:42:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.84it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:42:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:42:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 1.0093064, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [858, 910, 852, 773, 872, 884, 1700, 640, 665, 1089, 530, 439], 'head_nums': [12, 10, 10, 10, 10, 9, 9, 7, 9, 9, 8, 9], 'pruned_params': 54186100, 'remaining_params': 30831500, 'pruned_model_sparsity': 0.6373515601475459, 'expected_sparsity': 0.62593, 'target_sparsity': 0.6, 'step': 2550}


Iteration:  69%|██████▉   | 54/78 [00:19<00:12,  1.97it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:10,  2.20it/s][A
Iteration:  72%|███████▏  | 56/78 [00:20<00:09,  2.41it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:08,  2.58it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:07,  2.72it/s][A
Iteration:  76%|███████▌  | 59/78 [00:21<00:06,  2.84it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:06,  2.91it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.96it/s][A
Iteration:  79%|███████▉  | 62/78 [00:22<00:05,  3.00it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:04,  3.03it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.23it/s][A04/28/2024 18:42:11 - INFO - trainer.trainer_mod_2 - Epoch 32 finished. Took 27.14 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.87it/s]
Epoch:  33%|███▎      | 33/100 [14:31<29:47, 26.68s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:42:19,607 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:42:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:42:19 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:42:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:42:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.79it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:42:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:42:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 1.0006117, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [884, 935, 876, 798, 897, 910, 1721, 662, 667, 1106, 540, 448], 'head_nums': [12, 10, 10, 10, 10, 9, 10, 8, 10, 9, 9, 10], 'pruned_params': 52940584, 'remaining_params': 32077016, 'pruned_model_sparsity': 0.6227014641674194, 'expected_sparsity': 0.61618, 'target_sparsity': 0.6, 'step': 2600}


Iteration:  33%|███▎      | 26/78 [00:09<00:26,  1.97it/s][A04/28/2024 18:42:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 2600, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  35%|███▍      | 27/78 [00:09<00:23,  2.21it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:20,  2.41it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:18,  2.61it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:17,  2.74it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:16,  2.83it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.91it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.96it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.98it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.01it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.02it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.03it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.05it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.10it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 18:42:36,421 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:42:36 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:42:36 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:42:36 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:42:36 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:42:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:42:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.9685572, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [912, 962, 902, 824, 923, 937, 1752, 687, 670, 1127, 552, 458], 'head_nums': [12, 10, 11, 10, 10, 10, 10, 8, 10, 10, 9, 10], 'pruned_params': 52068876, 'remaining_params': 32948724, 'pruned_model_sparsity': 0.6124481989611563, 'expected_sparsity': 0.60175, 'target_sparsity': 0.6, 'step': 2650}


Iteration:  97%|█████████▋| 76/78 [00:25<00:01,  1.96it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.20it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.49it/s][A04/28/2024 18:42:37 - INFO - trainer.trainer_mod_2 - Epoch 33 finished. Took 26.47 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  34%|███▍      | 34/100 [14:58<29:16, 26.61s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:23,  3.25it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.19it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.12it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  3.11it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.01it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.03it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:42:53,207 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:42:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:42:53 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:42:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:42:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 18:42:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:42:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.99604905, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [937, 987, 927, 847, 948, 961, 1794, 709, 673, 1150, 566, 468], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 10, 10, 10], 'pruned_params': 51221680, 'remaining_params': 33795920, 'pruned_model_sparsity': 0.6024832505269497, 'expected_sparsity': 0.58501, 'target_sparsity': 0.6, 'step': 2700}


Iteration:  62%|██████▏   | 48/78 [00:16<00:15,  1.96it/s][A04/28/2024 18:42:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 2700, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  63%|██████▎   | 49/78 [00:16<00:13,  2.20it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:11,  2.41it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:10,  2.57it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.70it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.81it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.87it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.92it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.96it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.00it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.02it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.04it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.04it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.04it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 18:43:03 - INFO - trainer.trainer_mod_2 - Epoch 34 finished. Took 25.91 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  35%|███▌      | 35/100 [15:24<28:36, 26.40s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.12it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:43:10,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:43:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:43:10 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:43:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:43:10 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:43:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:43:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0023811, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [957, 1005, 944, 864, 965, 977, 1833, 725, 675, 1170, 577, 474], 'head_nums': [12, 10, 11, 11, 11, 10, 11, 9, 10, 10, 10, 10], 'pruned_params': 50644116, 'remaining_params': 34373484, 'pruned_model_sparsity': 0.5956897865853659, 'expected_sparsity': 0.57217, 'target_sparsity': 0.6, 'step': 2750}


Iteration:  26%|██▌       | 20/78 [00:07<00:29,  1.97it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:25,  2.20it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:23,  2.39it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:21,  2.56it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:20,  2.70it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.81it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:18,  2.89it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.94it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.99it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.01it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.11it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.05it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:07,  3.25it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.20it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.15it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:06,  3.15it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.12it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.11it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:43:26,852 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:43:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:43:26 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:43:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:43:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.59it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:43:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:43:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 1.0696574, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [965, 1013, 953, 871, 972, 983, 1847, 730, 676, 1175, 580, 476], 'head_nums': [12, 10, 11, 11, 11, 10, 11, 9, 10, 10, 10, 10], 'pruned_params': 47737912, 'remaining_params': 37279688, 'pruned_model_sparsity': 0.5615062292984041, 'expected_sparsity': 0.56721, 'target_sparsity': 0.6, 'step': 2800}


Iteration:  90%|████████▉ | 70/78 [00:23<00:04,  1.97it/s][A04/28/2024 18:43:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 2800, Alignment: tensor([2, 4, 6, 7], device='cuda:0')

Iteration:  91%|█████████ | 71/78 [00:24<00:03,  2.20it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.41it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.57it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.69it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.78it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.86it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.92it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.11it/s][A04/28/2024 18:43:30 - INFO - trainer.trainer_mod_2 - Epoch 35 finished. Took 26.49 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  36%|███▌      | 36/100 [15:50<28:11, 26.43s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.12it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.11it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.11it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.10it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.10it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:43:43,651 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:43:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:43:43 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:43:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:43:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:43:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:43:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.96469855, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [963, 1012, 952, 869, 971, 979, 1828, 725, 675, 1169, 576, 474], 'head_nums': [12, 10, 11, 11, 11, 10, 11, 9, 10, 10, 10, 10], 'pruned_params': 50592028, 'remaining_params': 34425572, 'pruned_model_sparsity': 0.5950771134447456, 'expected_sparsity': 0.57114, 'target_sparsity': 0.6, 'step': 2850}


Iteration:  54%|█████▍    | 42/78 [00:14<00:18,  1.97it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:15,  2.20it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:14,  2.41it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:12,  2.57it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.70it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:11,  2.81it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.90it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  2.96it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  2.99it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.01it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.03it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.05it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.05it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A04/28/2024 18:43:55 - INFO - trainer.trainer_mod_2 - Epoch 36 finished. Took 25.9 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  37%|███▋      | 37/100 [16:16<27:35, 26.27s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.05it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.06it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 18:44:00,503 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:44:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:44:00 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:44:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:44:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.79it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:44:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:44:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.9731093, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [958, 1005, 946, 865, 964, 970, 1795, 714, 673, 1155, 567, 469], 'head_nums': [12, 10, 11, 11, 11, 10, 11, 8, 10, 10, 10, 10], 'pruned_params': 50863192, 'remaining_params': 34154408, 'pruned_model_sparsity': 0.5982666177356218, 'expected_sparsity': 0.57952, 'target_sparsity': 0.6, 'step': 2900}


Iteration:  18%|█▊        | 14/78 [00:05<00:32,  1.96it/s][A04/28/2024 18:44:01 - INFO - trainer.trainer_mod_2 - v4 Global step: 2900, Alignment: tensor([2, 4, 6, 9], device='cuda:0')

Iteration:  19%|█▉        | 15/78 [00:05<00:28,  2.18it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:25,  2.39it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:23,  2.56it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:22,  2.69it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:21,  2.79it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:20,  2.85it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.92it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.96it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.00it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.03it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.05it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:13<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:44:17,412 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:44:17 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:44:17 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:44:17 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:44:17 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 18:44:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:44:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.97601956, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [950, 997, 938, 858, 956, 959, 1765, 702, 671, 1142, 558, 464], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 10, 9, 10], 'pruned_params': 51350368, 'remaining_params': 33667232, 'pruned_model_sparsity': 0.6039969135802469, 'expected_sparsity': 0.58806, 'target_sparsity': 0.6, 'step': 2950}


Iteration:  82%|████████▏ | 64/78 [00:22<00:07,  1.96it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.19it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:05,  2.39it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:04,  2.56it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.69it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.80it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  2.88it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.92it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.97it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.01it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.04it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.05it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A04/28/2024 18:44:22 - INFO - trainer.trainer_mod_2 - Epoch 37 finished. Took 26.61 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.93it/s]
Epoch:  38%|███▊      | 38/100 [16:43<27:15, 26.37s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.11it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.10it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.11it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.10it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:44:34,212 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:44:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:44:34 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:44:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:44:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:44:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:44:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 0.9938678, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [943, 990, 931, 850, 948, 949, 1741, 691, 669, 1131, 551, 459], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 10, 9, 10], 'pruned_params': 51439224, 'remaining_params': 33578376, 'pruned_model_sparsity': 0.6050420618789522, 'expected_sparsity': 0.59522, 'target_sparsity': 0.6, 'step': 3000}


Iteration:  46%|████▌     | 36/78 [00:12<00:21,  1.97it/s][A04/28/2024 18:44:34 - INFO - trainer.trainer_mod_2 - v4 Global step: 3000, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  47%|████▋     | 37/78 [00:12<00:18,  2.20it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:16,  2.41it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:15,  2.58it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.71it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:13,  2.81it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.89it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.95it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.99it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.02it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.03it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.05it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.04it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.05it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.12it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.23it/s][A04/28/2024 18:44:48 - INFO - trainer.trainer_mod_2 - Epoch 38 finished. Took 25.87 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  39%|███▉      | 39/100 [17:09<26:39, 26.22s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.12it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 18:44:50,988 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:44:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:44:50 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:44:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:44:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.78it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:44:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:44:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0189002, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [936, 984, 925, 845, 942, 941, 1723, 682, 667, 1123, 546, 455], 'head_nums': [12, 10, 11, 11, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51903420, 'remaining_params': 33114180, 'pruned_model_sparsity': 0.6105020607497742, 'expected_sparsity': 0.60072, 'target_sparsity': 0.6, 'step': 3050}


Iteration:  10%|█         | 8/78 [00:03<00:36,  1.94it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:31,  2.19it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:28,  2.41it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:25,  2.59it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.72it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.80it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:22,  2.86it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.90it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.97it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.01it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.03it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.05it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.05it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.05it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.10it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.10it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.10it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.12it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:45:07,836 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:45:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:45:07 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:45:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:45:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 18:45:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:45:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 0.97298676, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [933, 980, 922, 841, 938, 934, 1711, 676, 666, 1117, 542, 452], 'head_nums': [12, 10, 11, 10, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 52147008, 'remaining_params': 32870592, 'pruned_model_sparsity': 0.6133672086720867, 'expected_sparsity': 0.60435, 'target_sparsity': 0.6, 'step': 3100}


Iteration:  74%|███████▍  | 58/78 [00:20<00:10,  1.96it/s][A04/28/2024 18:45:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 3100, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  76%|███████▌  | 59/78 [00:20<00:08,  2.20it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:07,  2.38it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.56it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.69it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.81it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  2.87it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.92it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.97it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.00it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.03it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A04/28/2024 18:45:14 - INFO - trainer.trainer_mod_2 - Epoch 39 finished. Took 26.49 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  40%|████      | 40/100 [17:35<26:18, 26.30s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.05it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:45:24,642 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:45:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:45:24 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:45:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:45:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:45:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:45:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.9661203, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [931, 979, 920, 839, 936, 930, 1704, 671, 666, 1113, 539, 450], 'head_nums': [12, 10, 11, 10, 10, 9, 10, 8, 10, 9, 9, 10], 'pruned_params': 52370680, 'remaining_params': 32646920, 'pruned_model_sparsity': 0.6159980992171032, 'expected_sparsity': 0.60657, 'target_sparsity': 0.6, 'step': 3150}


Iteration:  38%|███▊      | 30/78 [00:10<00:24,  1.96it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:21,  2.21it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:19,  2.41it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:17,  2.58it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:16,  2.72it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:15,  2.82it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.90it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.95it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.99it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.02it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.03it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.05it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.11it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.11it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.11it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 18:45:40 - INFO - trainer.trainer_mod_2 - Epoch 40 finished. Took 25.84 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  41%|████      | 41/100 [18:01<25:43, 26.17s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A[INFO|trainer.py:570] 2024-04-28 18:45:41,400 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:45:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:45:41 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:45:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:45:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:45:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:45:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.99151117, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [932, 979, 922, 839, 937, 929, 1700, 669, 665, 1111, 538, 449], 'head_nums': [12, 10, 11, 10, 10, 9, 10, 8, 10, 9, 9, 10], 'pruned_params': 52369148, 'remaining_params': 32648452, 'pruned_model_sparsity': 0.6159800794188497, 'expected_sparsity': 0.60727, 'target_sparsity': 0.6, 'step': 3200}


Iteration:   3%|▎         | 2/78 [00:01<00:51,  1.46it/s][A04/28/2024 18:45:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 3200, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:   4%|▍         | 3/78 [00:01<00:38,  1.94it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:32,  2.27it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:29,  2.51it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:26,  2.67it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.79it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.88it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.93it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.96it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  3.00it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.02it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.04it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:20,  3.06it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.06it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.12it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.10it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.10it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.14it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.13it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.11it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.11it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.10it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:45:58,199 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:45:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:45:58 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:45:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:45:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:45:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:45:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 1.0284331, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [935, 982, 925, 841, 939, 929, 1699, 669, 665, 1111, 538, 449], 'head_nums': [12, 10, 11, 10, 10, 9, 10, 8, 10, 9, 9, 10], 'pruned_params': 52349232, 'remaining_params': 32668368, 'pruned_model_sparsity': 0.6157458220415537, 'expected_sparsity': 0.60704, 'target_sparsity': 0.6, 'step': 3250}


Iteration:  67%|██████▋   | 52/78 [00:18<00:13,  1.97it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:11,  2.21it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:09,  2.41it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.58it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.70it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.80it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.88it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.95it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.98it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.02it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.04it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.05it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.22it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.17it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.14it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.14it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.12it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.12it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.24it/s][A04/28/2024 18:46:07 - INFO - trainer.trainer_mod_2 - Epoch 41 finished. Took 26.4 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  42%|████▏     | 42/100 [18:27<25:21, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.11it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:46:14,925 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:46:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:46:14 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:46:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:46:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.79it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:46:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:46:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 1.0507672, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [939, 986, 930, 845, 943, 931, 1701, 670, 665, 1112, 538, 449], 'head_nums': [12, 10, 11, 10, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 52116368, 'remaining_params': 32901232, 'pruned_model_sparsity': 0.613006812707016, 'expected_sparsity': 0.60577, 'target_sparsity': 0.6, 'step': 3300}


Iteration:  31%|███       | 24/78 [00:08<00:27,  1.96it/s][A04/28/2024 18:46:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 3300, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  32%|███▏      | 25/78 [00:08<00:24,  2.19it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:21,  2.40it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:19,  2.57it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:18,  2.71it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.81it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.89it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:16,  2.93it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.93it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.98it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.01it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.03it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.04it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.05it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.10it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:46:31,786 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:46:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:46:31 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:46:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:46:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:46:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:46:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 1.0370542, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [945, 992, 936, 850, 948, 935, 1705, 673, 666, 1114, 540, 450], 'head_nums': [12, 10, 11, 10, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 52062748, 'remaining_params': 32954852, 'pruned_model_sparsity': 0.6123761197681421, 'expected_sparsity': 0.60375, 'target_sparsity': 0.6, 'step': 3350}


Iteration:  95%|█████████▍| 74/78 [00:25<00:02,  1.96it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.20it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.41it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.57it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.81it/s][A04/28/2024 18:46:33 - INFO - trainer.trainer_mod_2 - Epoch 42 finished. Took 26.51 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  43%|████▎     | 43/100 [18:54<25:00, 26.32s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.03it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.11it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.10it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.10it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.05it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:46:48,611 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:46:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:46:48 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:46:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:46:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:46:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:46:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6750902527075813, 'eval_loss': 1.0314304, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [951, 998, 942, 856, 953, 939, 1709, 676, 666, 1116, 542, 452], 'head_nums': [12, 10, 11, 11, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51811500, 'remaining_params': 33206100, 'pruned_model_sparsity': 0.6094208728545619, 'expected_sparsity': 0.60141, 'target_sparsity': 0.6, 'step': 3400}
04/28/2024 18:46:49 - INFO - trainer.trainer_mod_2 - Saving the best model so far: [Epoch 43 | Step: 3400 | Model size: 33206100 | Score: 0.67509]

[INFO|configuration_utils.py:439] 2024-04-28 18:46:49,234 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 18:46:50,714 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/best/pytorch_model.bin

Iteration:  59%|█████▉    | 46/78 [00:17<00:30,  1.05it/s][A04/28/2024 18:46:50 - INFO - trainer.trainer_mod_2 - v4 Global step: 3400, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  60%|██████    | 47/78 [00:17<00:23,  1.30it/s][A
Iteration:  62%|██████▏   | 48/78 [00:17<00:19,  1.57it/s][A
Iteration:  63%|██████▎   | 49/78 [00:18<00:15,  1.85it/s][A
Iteration:  64%|██████▍   | 50/78 [00:18<00:13,  2.10it/s][A
Iteration:  65%|██████▌   | 51/78 [00:18<00:11,  2.31it/s][A
Iteration:  67%|██████▋   | 52/78 [00:19<00:10,  2.50it/s][A
Iteration:  68%|██████▊   | 53/78 [00:19<00:09,  2.65it/s][A
Iteration:  69%|██████▉   | 54/78 [00:19<00:08,  2.77it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.86it/s][A
Iteration:  72%|███████▏  | 56/78 [00:20<00:07,  2.92it/s][A
Iteration:  73%|███████▎  | 57/78 [00:20<00:07,  2.97it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  3.01it/s][A
Iteration:  76%|███████▌  | 59/78 [00:21<00:06,  3.03it/s][A
Iteration:  77%|███████▋  | 60/78 [00:21<00:05,  3.04it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.05it/s][A
Iteration:  79%|███████▉  | 62/78 [00:22<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:22<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:23<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:23<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:24<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:24<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:24<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:25<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:25<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:25<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:26<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:26<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:26<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:27<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:27<00:00,  3.23it/s][A04/28/2024 18:47:01 - INFO - trainer.trainer_mod_2 - Epoch 43 finished. Took 27.39 seconds.
Iteration: 100%|██████████| 78/78 [00:27<00:00,  2.85it/s]
Epoch:  44%|████▍     | 44/100 [19:21<24:51, 26.64s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.11it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:47:06,879 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:47:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:47:06 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:47:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:47:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.88it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.26it/s]04/28/2024 18:47:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:47:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0128722, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [955, 1003, 948, 861, 958, 942, 1713, 680, 667, 1118, 543, 453], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 9, 9, 10], 'pruned_params': 51566380, 'remaining_params': 33451220, 'pruned_model_sparsity': 0.6065377051339957, 'expected_sparsity': 0.59932, 'target_sparsity': 0.6, 'step': 3450}


Iteration:  23%|██▎       | 18/78 [00:06<00:30,  1.96it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:26,  2.20it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:24,  2.41it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:22,  2.58it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:20,  2.71it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.82it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.90it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.95it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.99it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.02it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.04it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.03it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.13it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.12it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.11it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.10it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:47:23,685 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:47:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:47:23 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:47:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:47:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.78it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:47:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:47:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 1.039358, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [960, 1007, 953, 865, 963, 944, 1716, 681, 667, 1119, 544, 454], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 9, 9, 10], 'pruned_params': 51526548, 'remaining_params': 33491052, 'pruned_model_sparsity': 0.6060691903794038, 'expected_sparsity': 0.59789, 'target_sparsity': 0.6, 'step': 3500}


Iteration:  87%|████████▋ | 68/78 [00:23<00:05,  1.97it/s][A04/28/2024 18:47:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 3500, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  88%|████████▊ | 69/78 [00:23<00:04,  2.21it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:03,  2.42it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.59it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.71it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.81it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.86it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.93it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.97it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.00it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.15it/s][A04/28/2024 18:47:27 - INFO - trainer.trainer_mod_2 - Epoch 44 finished. Took 26.47 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  45%|████▌     | 45/100 [19:48<24:22, 26.59s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:26,  2.93it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.02it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.05it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.10it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.10it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.10it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.10it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.10it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.10it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.10it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.10it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 18:47:40,492 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:47:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:47:40 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:47:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:47:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:47:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:47:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 1.0279136, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [963, 1011, 957, 868, 966, 945, 1718, 682, 667, 1120, 544, 454], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 9, 9, 10], 'pruned_params': 51497440, 'remaining_params': 33520160, 'pruned_model_sparsity': 0.6057268142125866, 'expected_sparsity': 0.59715, 'target_sparsity': 0.6, 'step': 3550}


Iteration:  51%|█████▏    | 40/78 [00:13<00:20,  1.89it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:17,  2.14it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:15,  2.35it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:13,  2.53it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:12,  2.67it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.77it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.85it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.92it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.97it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.00it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.02it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.05it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.04it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.11it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.23it/s][A04/28/2024 18:47:53 - INFO - trainer.trainer_mod_2 - Epoch 45 finished. Took 25.95 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  46%|████▌     | 46/100 [20:14<23:45, 26.40s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.14it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:47:57,355 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:47:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:47:57 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:47:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:47:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.85it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:47:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:47:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.9859035, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [966, 1013, 961, 871, 968, 946, 1716, 681, 667, 1119, 544, 454], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 9, 9, 10], 'pruned_params': 51475992, 'remaining_params': 33541608, 'pruned_model_sparsity': 0.605474537037037, 'expected_sparsity': 0.59708, 'target_sparsity': 0.6, 'step': 3600}


Iteration:  15%|█▌        | 12/78 [00:04<00:33,  1.96it/s][A04/28/2024 18:47:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 3600, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  17%|█▋        | 13/78 [00:04<00:29,  2.20it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:26,  2.40it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:24,  2.57it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:22,  2.71it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.79it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.87it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.91it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.96it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.00it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.03it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.04it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.10it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.10it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.10it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.10it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:48:14,183 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:48:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:48:14 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:48:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:48:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.77it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:48:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:48:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.99776816, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [967, 1014, 962, 872, 969, 944, 1713, 680, 666, 1117, 544, 453], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 9, 9, 10], 'pruned_params': 51472928, 'remaining_params': 33544672, 'pruned_model_sparsity': 0.6054384974405299, 'expected_sparsity': 0.59741, 'target_sparsity': 0.6, 'step': 3650}


Iteration:  79%|███████▉  | 62/78 [00:21<00:08,  1.97it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:06,  2.20it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:05,  2.40it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.57it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.71it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.81it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.88it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.94it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.98it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.02it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.03it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.03it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.05it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A04/28/2024 18:48:19 - INFO - trainer.trainer_mod_2 - Epoch 46 finished. Took 26.5 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  47%|████▋     | 47/100 [20:40<23:20, 26.43s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.10it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.10it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:48:30,979 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:48:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:48:30 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:48:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:48:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:48:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:48:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 1.0369135, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [967, 1015, 963, 872, 969, 942, 1708, 677, 666, 1115, 542, 452], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 9, 9, 10], 'pruned_params': 51477524, 'remaining_params': 33540076, 'pruned_model_sparsity': 0.6054925568352906, 'expected_sparsity': 0.59858, 'target_sparsity': 0.6, 'step': 3700}


Iteration:  44%|████▎     | 34/78 [00:11<00:22,  1.97it/s][A04/28/2024 18:48:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 3700, Alignment: tensor([2, 4, 6, 7], device='cuda:0')

Iteration:  45%|████▍     | 35/78 [00:11<00:19,  2.20it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:17,  2.41it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:15,  2.58it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:14,  2.71it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.81it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.89it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.95it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.99it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.02it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.03it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.04it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.03it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.04it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A04/28/2024 18:48:45 - INFO - trainer.trainer_mod_2 - Epoch 47 finished. Took 25.89 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  48%|████▊     | 48/100 [21:06<22:45, 26.27s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.04it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 18:48:47,813 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:48:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:48:47 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:48:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:48:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:48:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:48:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0357338, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [967, 1015, 963, 871, 969, 940, 1702, 674, 665, 1113, 540, 451], 'head_nums': [12, 10, 11, 11, 10, 10, 11, 8, 10, 9, 9, 10], 'pruned_params': 51486716, 'remaining_params': 33530884, 'pruned_model_sparsity': 0.6056006756248118, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 3750}


Iteration:   8%|▊         | 6/78 [00:02<00:38,  1.86it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:33,  2.14it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:29,  2.37it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:27,  2.55it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:25,  2.70it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.80it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.89it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.94it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  3.00it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.03it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.04it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.04it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.11it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.10it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.12it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.11it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.11it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.10it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.12it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.12it/s][A[INFO|trainer.py:570] 2024-04-28 18:49:04,613 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:49:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:49:04 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:49:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:49:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:49:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:49:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0524982, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [968, 1016, 965, 871, 969, 938, 1698, 672, 665, 1111, 539, 449], 'head_nums': [12, 10, 11, 11, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51682812, 'remaining_params': 33334788, 'pruned_model_sparsity': 0.6079072098012647, 'expected_sparsity': 0.60072, 'target_sparsity': 0.6, 'step': 3800}


Iteration:  72%|███████▏  | 56/78 [00:19<00:11,  1.98it/s][A04/28/2024 18:49:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 3800, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  73%|███████▎  | 57/78 [00:19<00:09,  2.21it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:08,  2.41it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:07,  2.59it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.72it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.81it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.89it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.95it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.99it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.02it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.04it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.23it/s][A04/28/2024 18:49:12 - INFO - trainer.trainer_mod_2 - Epoch 48 finished. Took 26.46 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  49%|████▉     | 49/100 [21:33<22:22, 26.32s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 18:49:21,380 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:49:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:49:21 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:49:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:49:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.81it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/28/2024 18:49:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:49:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 1.0350697, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [970, 1017, 966, 871, 969, 937, 1694, 670, 665, 1110, 538, 449], 'head_nums': [12, 10, 11, 11, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51681280, 'remaining_params': 33336320, 'pruned_model_sparsity': 0.6078891900030111, 'expected_sparsity': 0.60134, 'target_sparsity': 0.6, 'step': 3850}


Iteration:  36%|███▌      | 28/78 [00:09<00:25,  1.97it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:22,  2.21it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:20,  2.40it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:18,  2.57it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:16,  2.71it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.82it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:15,  2.90it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  2.95it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.99it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.02it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.05it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.10it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.10it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:49:38,153 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:49:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:49:38 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:49:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:49:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:49:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:49:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0555158, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [972, 1020, 968, 873, 971, 937, 1692, 669, 665, 1109, 537, 448], 'head_nums': [12, 10, 11, 11, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51665960, 'remaining_params': 33351640, 'pruned_model_sparsity': 0.6077089920204758, 'expected_sparsity': 0.60133, 'target_sparsity': 0.6, 'step': 3900}


Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.02it/s][A04/28/2024 18:49:38 - INFO - trainer.trainer_mod_2 - Epoch 49 finished. Took 26.46 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  50%|█████     | 50/100 [21:59<21:58, 26.36s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A04/28/2024 18:49:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 3900, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.25it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.19it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:19,  3.15it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:19,  3.14it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.12it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.11it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.03it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.04it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.11it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:49:54,970 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:49:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:49:54 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:49:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:49:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:49:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:49:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0305628, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [974, 1022, 971, 875, 973, 937, 1691, 669, 665, 1108, 537, 448], 'head_nums': [12, 10, 11, 11, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51649108, 'remaining_params': 33368492, 'pruned_model_sparsity': 0.6075107742396868, 'expected_sparsity': 0.60116, 'target_sparsity': 0.6, 'step': 3950}


Iteration:  64%|██████▍   | 50/78 [00:16<00:14,  1.97it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:12,  2.20it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:10,  2.40it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:09,  2.57it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.72it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:08,  2.81it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.88it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.95it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.00it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.02it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.04it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.05it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.06it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.17it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.14it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.11it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.11it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.11it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.11it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.24it/s][A04/28/2024 18:50:04 - INFO - trainer.trainer_mod_2 - Epoch 50 finished. Took 25.81 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  51%|█████     | 51/100 [22:25<21:23, 26.20s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:50:11,713 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:50:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:50:11 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:50:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:50:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.79it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:50:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:50:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0321316, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [977, 1025, 974, 878, 977, 938, 1691, 669, 665, 1108, 537, 448], 'head_nums': [12, 10, 11, 11, 10, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51623064, 'remaining_params': 33394536, 'pruned_model_sparsity': 0.6072044376693767, 'expected_sparsity': 0.60068, 'target_sparsity': 0.6, 'step': 4000}


Iteration:  28%|██▊       | 22/78 [00:07<00:28,  1.97it/s][A04/28/2024 18:50:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 4000, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  29%|██▉       | 23/78 [00:08<00:24,  2.21it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:22,  2.42it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:20,  2.58it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:19,  2.72it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:18,  2.83it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:17,  2.90it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.98it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.01it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.03it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.04it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.04it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.02it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.04it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.11it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.10it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.10it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:50:28,545 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:50:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:50:28 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:50:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:50:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.81it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:50:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:50:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 1.0056858, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [980, 1028, 978, 881, 980, 939, 1689, 669, 665, 1109, 537, 448], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51400924, 'remaining_params': 33616676, 'pruned_model_sparsity': 0.6045915669226136, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 4050}


Iteration:  92%|█████████▏| 72/78 [00:24<00:03,  1.97it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:02,  2.21it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.41it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.58it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.71it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.81it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.01it/s][A04/28/2024 18:50:31 - INFO - trainer.trainer_mod_2 - Epoch 51 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  52%|█████▏    | 52/100 [22:51<21:01, 26.28s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.02it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.11it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.11it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.11it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:19,  3.10it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.10it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.10it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.06it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:50:45,324 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:50:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:50:45 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:50:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:50:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:50:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:50:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 1.0107616, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [983, 1031, 982, 883, 982, 940, 1689, 669, 665, 1108, 537, 447], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51377944, 'remaining_params': 33639656, 'pruned_model_sparsity': 0.6043212699488106, 'expected_sparsity': 0.59931, 'target_sparsity': 0.6, 'step': 4100}


Iteration:  56%|█████▋    | 44/78 [00:14<00:17,  1.96it/s][A04/28/2024 18:50:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 4100, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  58%|█████▊    | 45/78 [00:15<00:14,  2.20it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:13,  2.42it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:11,  2.60it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:11,  2.72it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:10,  2.82it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  2.90it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.96it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.99it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.03it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.05it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.05it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.05it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A04/28/2024 18:50:56 - INFO - trainer.trainer_mod_2 - Epoch 52 finished. Took 25.87 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  53%|█████▎    | 53/100 [23:17<20:29, 26.16s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.17it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.15it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.12it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.11it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.11it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.10it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:51:02,091 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:51:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:51:02 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:51:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:51:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:51:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:51:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 1.038054, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [985, 1034, 985, 886, 985, 940, 1687, 668, 664, 1107, 536, 447], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51358028, 'remaining_params': 33659572, 'pruned_model_sparsity': 0.6040870125715146, 'expected_sparsity': 0.59913, 'target_sparsity': 0.6, 'step': 4150}


Iteration:  21%|██        | 16/78 [00:05<00:31,  1.96it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:27,  2.20it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:24,  2.41it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:22,  2.58it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:21,  2.71it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:20,  2.81it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.89it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.94it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.98it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.01it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.03it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.11it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.28it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.21it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:07,  3.17it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.14it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.13it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.11it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:51:18,868 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:51:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:51:18 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:51:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:51:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 18:51:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:51:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 1.0301319, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [987, 1036, 987, 887, 986, 940, 1685, 666, 664, 1106, 535, 447], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51348836, 'remaining_params': 33668764, 'pruned_model_sparsity': 0.6039788937819933, 'expected_sparsity': 0.59932, 'target_sparsity': 0.6, 'step': 4200}


Iteration:  85%|████████▍ | 66/78 [00:22<00:06,  1.97it/s][A04/28/2024 18:51:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 4200, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  86%|████████▌ | 67/78 [00:22<00:04,  2.21it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:04,  2.41it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.59it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.73it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.85it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.92it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.96it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.98it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.01it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.03it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A04/28/2024 18:51:23 - INFO - trainer.trainer_mod_2 - Epoch 53 finished. Took 26.39 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.96it/s]
Epoch:  54%|█████▍    | 54/100 [23:44<20:06, 26.23s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.10it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.10it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.10it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.10it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.05it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 18:51:35,647 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:51:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:51:35 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:51:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:51:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]04/28/2024 18:51:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:51:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.99366754, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [988, 1037, 989, 888, 988, 939, 1682, 664, 664, 1105, 534, 446], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 8, 10, 9, 9, 10], 'pruned_params': 51342708, 'remaining_params': 33674892, 'pruned_model_sparsity': 0.6039068145889792, 'expected_sparsity': 0.59972, 'target_sparsity': 0.6, 'step': 4250}


Iteration:  49%|████▊     | 38/78 [00:12<00:20,  1.96it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:17,  2.20it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:15,  2.40it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:14,  2.58it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:13,  2.71it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:12,  2.82it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.91it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.96it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.98it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.03it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.10it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.24it/s][A04/28/2024 18:51:49 - INFO - trainer.trainer_mod_2 - Epoch 54 finished. Took 25.85 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  55%|█████▌    | 55/100 [24:09<19:35, 26.12s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:23,  3.13it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.11it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:22,  3.19it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:22,  3.14it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.13it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.11it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 18:51:52,381 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:51:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:51:52 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:51:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:51:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:51:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:51:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.9973453, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [989, 1039, 991, 889, 989, 938, 1679, 663, 663, 1104, 533, 446], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 8, 10, 9, 8, 10], 'pruned_params': 51531144, 'remaining_params': 33486456, 'pruned_model_sparsity': 0.6061232497741644, 'expected_sparsity': 0.60004, 'target_sparsity': 0.6, 'step': 4300}


Iteration:  13%|█▎        | 10/78 [00:03<00:34,  1.95it/s][A04/28/2024 18:51:53 - INFO - trainer.trainer_mod_2 - v4 Global step: 4300, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  14%|█▍        | 11/78 [00:04<00:30,  2.20it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:27,  2.41it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:25,  2.58it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:23,  2.71it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:22,  2.81it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.89it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.94it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.98it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.02it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.03it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.04it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.06it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.10it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.04it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:52:09,222 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:52:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:52:09 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:52:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:52:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:52:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:52:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 1.013039, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [991, 1041, 993, 891, 991, 937, 1676, 661, 663, 1102, 531, 445], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 8, 10, 9, 8, 10], 'pruned_params': 51520420, 'remaining_params': 33497180, 'pruned_model_sparsity': 0.6059971111863897, 'expected_sparsity': 0.60016, 'target_sparsity': 0.6, 'step': 4350}


Iteration:  77%|███████▋  | 60/78 [00:20<00:09,  1.97it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:07,  2.20it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:06,  2.42it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.59it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:05,  2.72it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.82it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.89it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.95it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.99it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  3.00it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.02it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.03it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.05it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A04/28/2024 18:52:15 - INFO - trainer.trainer_mod_2 - Epoch 55 finished. Took 26.46 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  56%|█████▌    | 56/100 [24:36<19:13, 26.22s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.03it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.05it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.06it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:52:26,041 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:52:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:52:26 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:52:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:52:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.37it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.03it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.31it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.41it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.92it/s]04/28/2024 18:52:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:52:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 1.0233452, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [993, 1043, 995, 893, 993, 936, 1674, 660, 663, 1101, 530, 445], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 8, 10, 9, 8, 10], 'pruned_params': 51508164, 'remaining_params': 33509436, 'pruned_model_sparsity': 0.6058529528003613, 'expected_sparsity': 0.60026, 'target_sparsity': 0.6, 'step': 4400}


Iteration:  41%|████      | 32/78 [00:11<00:23,  1.94it/s][A04/28/2024 18:52:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 4400, Alignment: tensor([2, 3, 4, 5], device='cuda:0')

Iteration:  42%|████▏     | 33/78 [00:11<00:20,  2.19it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:18,  2.39it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:16,  2.56it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:15,  2.70it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.81it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.89it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.94it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.99it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.02it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.04it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.12it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 18:52:41 - INFO - trainer.trainer_mod_2 - Epoch 56 finished. Took 25.91 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  57%|█████▋    | 57/100 [25:02<18:43, 26.13s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 18:52:42,842 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:52:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:52:42 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:52:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:52:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:52:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:52:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.631768953068592, 'eval_loss': 1.0738683, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [996, 1045, 998, 895, 995, 936, 1671, 658, 663, 1100, 529, 444], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 10, 9, 8, 10], 'pruned_params': 51688940, 'remaining_params': 33328660, 'pruned_model_sparsity': 0.6079792889942788, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 4450}


Iteration:   5%|▌         | 4/78 [00:01<00:42,  1.76it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:35,  2.08it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:30,  2.33it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:28,  2.53it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:26,  2.68it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:24,  2.80it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:23,  2.88it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  2.94it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.98it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.02it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  3.04it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.06it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:52:59,696 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:52:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:52:59 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:52:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:52:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:53:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:53:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0542623, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [998, 1048, 1000, 897, 997, 935, 1669, 657, 662, 1099, 528, 444], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 10, 9, 8, 10], 'pruned_params': 51675152, 'remaining_params': 33342448, 'pruned_model_sparsity': 0.607817110809997, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 4500}


Iteration:  69%|██████▉   | 54/78 [00:18<00:12,  1.97it/s][A04/28/2024 18:53:00 - INFO - trainer.trainer_mod_2 - v4 Global step: 4500, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  71%|███████   | 55/78 [00:19<00:10,  2.21it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:09,  2.42it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:08,  2.59it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:07,  2.72it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.81it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.88it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  2.95it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.97it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.01it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.03it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.05it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A04/28/2024 18:53:08 - INFO - trainer.trainer_mod_2 - Epoch 57 finished. Took 26.5 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  58%|█████▊    | 58/100 [25:28<18:22, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.03it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.04it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:53:16,502 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:53:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:53:16 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:53:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:53:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:53:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:53:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 1.050828, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1001, 1051, 1004, 899, 999, 935, 1667, 656, 662, 1099, 528, 443], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 10, 9, 8, 10], 'pruned_params': 51655236, 'remaining_params': 33362364, 'pruned_model_sparsity': 0.607582853432701, 'expected_sparsity': 0.60025, 'target_sparsity': 0.6, 'step': 4550}


Iteration:  33%|███▎      | 26/78 [00:09<00:26,  1.97it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:23,  2.21it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:20,  2.41it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:18,  2.59it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:17,  2.72it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:16,  2.82it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.90it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.95it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  2.96it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.01it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.04it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.13it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.11it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.11it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.11it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.10it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.10it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.11it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.10it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:53:33,303 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:53:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:53:33 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:53:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:53:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 18:53:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:53:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0384108, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1003, 1053, 1006, 901, 1001, 935, 1666, 656, 662, 1098, 527, 442], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 10, 9, 8, 10], 'pruned_params': 51639916, 'remaining_params': 33377684, 'pruned_model_sparsity': 0.6074026554501656, 'expected_sparsity': 0.60007, 'target_sparsity': 0.6, 'step': 4600}


Iteration:  97%|█████████▋| 76/78 [00:25<00:01,  1.96it/s][A04/28/2024 18:53:34 - INFO - trainer.trainer_mod_2 - v4 Global step: 4600, Alignment: tensor([2, 4, 6, 7], device='cuda:0')

Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.20it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.49it/s][A04/28/2024 18:53:34 - INFO - trainer.trainer_mod_2 - Epoch 58 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  59%|█████▉    | 59/100 [25:55<17:58, 26.31s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.06it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.07it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:53:50,113 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:53:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:53:50 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:53:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:53:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:53:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:53:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 1.0715731, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1006, 1056, 1010, 903, 1004, 936, 1665, 655, 662, 1098, 527, 442], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51813032, 'remaining_params': 33204568, 'pruned_model_sparsity': 0.6094388926528154, 'expected_sparsity': 0.59977, 'target_sparsity': 0.6, 'step': 4650}


Iteration:  62%|██████▏   | 48/78 [00:16<00:15,  1.97it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:13,  2.20it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:11,  2.41it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:10,  2.57it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.69it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.80it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.88it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.94it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.99it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.02it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.03it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.04it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A04/28/2024 18:54:00 - INFO - trainer.trainer_mod_2 - Epoch 59 finished. Took 25.9 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  60%|██████    | 60/100 [26:21<17:27, 26.19s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.11it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A[INFO|trainer.py:570] 2024-04-28 18:54:06,901 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:54:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:54:06 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:54:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:54:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:54:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:54:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 1.0446588, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1008, 1058, 1012, 905, 1007, 936, 1664, 655, 662, 1097, 526, 441], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51796180, 'remaining_params': 33221420, 'pruned_model_sparsity': 0.6092406748720265, 'expected_sparsity': 0.5996, 'target_sparsity': 0.6, 'step': 4700}


Iteration:  26%|██▌       | 20/78 [00:07<00:29,  1.96it/s][A04/28/2024 18:54:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 4700, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  27%|██▋       | 21/78 [00:07<00:25,  2.20it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:23,  2.41it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:21,  2.58it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:19,  2.72it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.81it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.89it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.95it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.99it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.02it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.03it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.03it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.04it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:54:23,749 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:54:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:54:23 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:54:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:54:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:54:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:54:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0369049, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1010, 1060, 1015, 907, 1008, 936, 1661, 653, 662, 1096, 525, 441], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51783924, 'remaining_params': 33233676, 'pruned_model_sparsity': 0.6090965164859982, 'expected_sparsity': 0.59951, 'target_sparsity': 0.6, 'step': 4750}


Iteration:  90%|████████▉ | 70/78 [00:23<00:04,  1.97it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:03,  2.21it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.59it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.72it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.88it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.93it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.09it/s][A04/28/2024 18:54:26 - INFO - trainer.trainer_mod_2 - Epoch 60 finished. Took 26.5 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  61%|██████    | 61/100 [26:47<17:04, 26.28s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.05it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.05it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.11it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.11it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.10it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:54:40,553 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:54:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:54:40 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:54:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:54:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 18:54:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:54:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 1.020872, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1012, 1062, 1017, 908, 1009, 934, 1658, 651, 661, 1094, 523, 440], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51777796, 'remaining_params': 33239804, 'pruned_model_sparsity': 0.609024437292984, 'expected_sparsity': 0.59975, 'target_sparsity': 0.6, 'step': 4800}


Iteration:  54%|█████▍    | 42/78 [00:14<00:18,  1.97it/s][A04/28/2024 18:54:41 - INFO - trainer.trainer_mod_2 - v4 Global step: 4800, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  55%|█████▌    | 43/78 [00:14<00:15,  2.21it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:14,  2.41it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:12,  2.58it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.72it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.82it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.90it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  2.96it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  2.99it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.03it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.04it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.10it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.10it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.10it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.16it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.13it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.12it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.11it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.11it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.24it/s][A04/28/2024 18:54:52 - INFO - trainer.trainer_mod_2 - Epoch 61 finished. Took 25.84 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  62%|██████▏   | 62/100 [27:13<16:33, 26.15s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.06it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:54:57,303 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:54:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:54:57 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:54:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:54:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:54:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:54:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0323339, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1014, 1064, 1020, 909, 1010, 933, 1654, 649, 661, 1092, 522, 439], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51768604, 'remaining_params': 33248996, 'pruned_model_sparsity': 0.6089163185034628, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 4850}


Iteration:  18%|█▊        | 14/78 [00:05<00:32,  1.96it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:28,  2.20it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:25,  2.42it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:23,  2.58it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:22,  2.72it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.82it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:20,  2.90it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.95it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.00it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.02it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.05it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.14it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.12it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.10it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.10it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.10it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 18:55:14,072 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:55:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:55:14 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:55:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:55:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.83it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.70it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.29it/s]04/28/2024 18:55:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:55:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 1.0393124, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1016, 1066, 1022, 910, 1011, 932, 1651, 647, 661, 1091, 521, 438], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51760944, 'remaining_params': 33256656, 'pruned_model_sparsity': 0.6088262195121952, 'expected_sparsity': 0.60041, 'target_sparsity': 0.6, 'step': 4900}


Iteration:  82%|████████▏ | 64/78 [00:21<00:07,  1.99it/s][A04/28/2024 18:55:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 4900, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.22it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.43it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:04,  2.59it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.73it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.83it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.90it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.96it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.99it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.01it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.03it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.03it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.04it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.19it/s][A04/28/2024 18:55:19 - INFO - trainer.trainer_mod_2 - Epoch 62 finished. Took 26.43 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  63%|██████▎   | 63/100 [27:39<16:10, 26.23s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.10it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.04it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:18,  3.05it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.07it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.10it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.03it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.04it/s][A[INFO|trainer.py:570] 2024-04-28 18:55:30,882 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:55:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:55:30 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:55:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:55:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:55:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:55:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.016682, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1017, 1068, 1024, 912, 1013, 931, 1648, 646, 661, 1090, 520, 437], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51750220, 'remaining_params': 33267380, 'pruned_model_sparsity': 0.6087000809244204, 'expected_sparsity': 0.60039, 'target_sparsity': 0.6, 'step': 4950}


Iteration:  46%|████▌     | 36/78 [00:12<00:21,  1.96it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:18,  2.19it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:16,  2.40it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:15,  2.57it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:14,  2.71it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:13,  2.81it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.89it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.94it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.97it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.99it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.00it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.03it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.06it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.05it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 18:55:45 - INFO - trainer.trainer_mod_2 - Epoch 63 finished. Took 25.91 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  64%|██████▍   | 64/100 [28:05<15:40, 26.13s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:55:47,682 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:55:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:55:47 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:55:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:55:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:55:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:55:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 1.0296477, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1020, 1071, 1027, 915, 1016, 931, 1648, 645, 661, 1089, 520, 437], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51728772, 'remaining_params': 33288828, 'pruned_model_sparsity': 0.6084478037488709, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 5000}


Iteration:  10%|█         | 8/78 [00:03<00:36,  1.93it/s][A04/28/2024 18:55:48 - INFO - trainer.trainer_mod_2 - v4 Global step: 5000, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  12%|█▏        | 9/78 [00:03<00:31,  2.18it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:28,  2.39it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:26,  2.57it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.71it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.81it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:22,  2.89it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.93it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.98it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.01it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.03it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.05it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.05it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.03it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.05it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.05it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.05it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:07,  3.14it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.12it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.11it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.10it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:56:04,530 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:56:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:56:04 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:56:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:56:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:56:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:56:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 1.034829, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1023, 1074, 1031, 917, 1018, 932, 1646, 644, 660, 1088, 519, 436], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51707324, 'remaining_params': 33310276, 'pruned_model_sparsity': 0.6081955265733213, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 5050}


Iteration:  74%|███████▍  | 58/78 [00:20<00:10,  1.97it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:08,  2.21it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:07,  2.41it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.58it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.71it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.81it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.89it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.95it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.99it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.02it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.03it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.04it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A04/28/2024 18:56:11 - INFO - trainer.trainer_mod_2 - Epoch 64 finished. Took 26.5 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  65%|██████▌   | 65/100 [28:32<15:18, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.10it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.10it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:56:21,307 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:56:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:56:21 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:56:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:56:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:56:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:56:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 1.0358976, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1026, 1077, 1034, 919, 1020, 931, 1644, 643, 660, 1087, 518, 435], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51690472, 'remaining_params': 33327128, 'pruned_model_sparsity': 0.6079973087925323, 'expected_sparsity': 0.59987, 'target_sparsity': 0.6, 'step': 5100}


Iteration:  38%|███▊      | 30/78 [00:10<00:24,  1.97it/s][A04/28/2024 18:56:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 5100, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  40%|███▉      | 31/78 [00:10<00:21,  2.21it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:19,  2.42it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:17,  2.59it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:16,  2.72it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:15,  2.81it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.89it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.95it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.99it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.01it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.03it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.05it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.06it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.05it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.06it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.06it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.10it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 18:56:37 - INFO - trainer.trainer_mod_2 - Epoch 65 finished. Took 25.86 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  66%|██████▌   | 66/100 [28:58<14:48, 26.13s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:56:38,098 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:56:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:56:38 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:56:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:56:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.55it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.14it/s]04/28/2024 18:56:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:56:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0153134, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1028, 1079, 1037, 922, 1022, 931, 1642, 642, 660, 1086, 518, 434], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51673620, 'remaining_params': 33343980, 'pruned_model_sparsity': 0.6077990910117435, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 5150}


Iteration:   3%|▎         | 2/78 [00:01<00:52,  1.44it/s][A
Iteration:   4%|▍         | 3/78 [00:01<00:39,  1.89it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:33,  2.23it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:29,  2.48it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:27,  2.65it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.77it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.86it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.93it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.97it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  3.00it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.01it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.02it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  3.04it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.05it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.05it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.06it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.06it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:12<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.11it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.10it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.10it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:56:54,977 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:56:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:56:54 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:56:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:56:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:56:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:56:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0467098, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1030, 1081, 1040, 923, 1024, 931, 1639, 640, 659, 1085, 517, 434], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51661364, 'remaining_params': 33356236, 'pruned_model_sparsity': 0.6076549326257151, 'expected_sparsity': 0.59981, 'target_sparsity': 0.6, 'step': 5200}


Iteration:  67%|██████▋   | 52/78 [00:18<00:13,  1.96it/s][A04/28/2024 18:56:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 5200, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  68%|██████▊   | 53/78 [00:18<00:11,  2.20it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:09,  2.40it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.57it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.70it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.81it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:06,  2.88it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.94it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.98it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.03it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.06it/s][A
Iteration:  82%|████████▏ | 64/78 [00:22<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:23<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A04/28/2024 18:57:03 - INFO - trainer.trainer_mod_2 - Epoch 66 finished. Took 26.54 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  67%|██████▋   | 67/100 [29:24<14:26, 26.25s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.11it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:57:11,781 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:57:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:57:11 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:57:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:57:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.81it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/28/2024 18:57:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:57:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 1.0478797, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1033, 1083, 1043, 925, 1026, 930, 1636, 638, 659, 1083, 516, 432], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51647576, 'remaining_params': 33370024, 'pruned_model_sparsity': 0.6074927544414334, 'expected_sparsity': 0.60003, 'target_sparsity': 0.6, 'step': 5250}


Iteration:  31%|███       | 24/78 [00:08<00:27,  1.97it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:24,  2.21it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:21,  2.41it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:19,  2.58it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:18,  2.71it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.81it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.89it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.94it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.99it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.01it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.05it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.10it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.11it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.10it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.10it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.11it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.10it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 18:57:28,585 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:57:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:57:28 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:57:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:57:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/28/2024 18:57:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:57:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 1.0294852, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1035, 1084, 1046, 927, 1027, 929, 1633, 636, 659, 1082, 515, 431], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 10], 'pruned_params': 51638384, 'remaining_params': 33379216, 'pruned_model_sparsity': 0.607384635651912, 'expected_sparsity': 0.60014, 'target_sparsity': 0.6, 'step': 5300}


Iteration:  95%|█████████▍| 74/78 [00:25<00:02,  1.97it/s][A04/28/2024 18:57:29 - INFO - trainer.trainer_mod_2 - v4 Global step: 5300, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.21it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.41it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.58it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.82it/s][A04/28/2024 18:57:30 - INFO - trainer.trainer_mod_2 - Epoch 67 finished. Took 26.46 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  68%|██████▊   | 68/100 [29:51<14:02, 26.31s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.02it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.03it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.04it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:57:45,393 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:57:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:57:45 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:57:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:57:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:57:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:57:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 1.0260532, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1038, 1087, 1049, 929, 1029, 928, 1630, 634, 659, 1081, 514, 430], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51819160, 'remaining_params': 33198440, 'pruned_model_sparsity': 0.6095109718458296, 'expected_sparsity': 0.60027, 'target_sparsity': 0.6, 'step': 5350}


Iteration:  59%|█████▉    | 46/78 [00:15<00:16,  1.96it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:14,  2.21it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:12,  2.41it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:11,  2.57it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:10,  2.72it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.79it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.87it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.94it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.00it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.02it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.05it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A04/28/2024 18:57:56 - INFO - trainer.trainer_mod_2 - Epoch 68 finished. Took 25.91 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  69%|██████▉   | 69/100 [30:17<13:31, 26.19s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:58:02,191 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:58:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:58:02 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:58:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:58:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 18:58:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:58:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.032676, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1041, 1090, 1052, 931, 1031, 929, 1628, 633, 658, 1080, 513, 430], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51799244, 'remaining_params': 33218356, 'pruned_model_sparsity': 0.6092767144685336, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 5400}


Iteration:  23%|██▎       | 18/78 [00:06<00:30,  1.97it/s][A04/28/2024 18:58:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 5400, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  24%|██▍       | 19/78 [00:06<00:26,  2.20it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:24,  2.42it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:22,  2.58it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:20,  2.72it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.81it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.89it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  2.95it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.98it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.02it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.03it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.05it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:13,  3.33it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.25it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.19it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:12,  3.16it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.19it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.15it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.14it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.12it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.11it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.10it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.11it/s][A
Iteration:  73%|███████▎  | 57/78 [00:18<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:58:18,913 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:58:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:58:18 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:58:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:58:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.16it/s]04/28/2024 18:58:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:58:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 1.0338395, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1043, 1092, 1055, 933, 1033, 929, 1627, 633, 658, 1079, 513, 429], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51782392, 'remaining_params': 33235208, 'pruned_model_sparsity': 0.6090784966877446, 'expected_sparsity': 0.60001, 'target_sparsity': 0.6, 'step': 5450}


Iteration:  87%|████████▋ | 68/78 [00:23<00:05,  1.96it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:04,  2.20it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:03,  2.41it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.58it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.71it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.81it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.89it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.95it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.00it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.02it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.18it/s][A04/28/2024 18:58:22 - INFO - trainer.trainer_mod_2 - Epoch 69 finished. Took 26.36 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.96it/s]
Epoch:  70%|███████   | 70/100 [30:43<13:07, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.06it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.06it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 18:58:35,712 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:58:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:58:35 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:58:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:58:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.80it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 18:58:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:58:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0147624, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1045, 1094, 1058, 935, 1035, 928, 1625, 631, 658, 1078, 512, 428], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51770136, 'remaining_params': 33247464, 'pruned_model_sparsity': 0.6089343383017164, 'expected_sparsity': 0.59999, 'target_sparsity': 0.6, 'step': 5500}


Iteration:  51%|█████▏    | 40/78 [00:13<00:19,  1.97it/s][A04/28/2024 18:58:36 - INFO - trainer.trainer_mod_2 - v4 Global step: 5500, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  53%|█████▎    | 41/78 [00:13<00:16,  2.20it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:14,  2.41it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:13,  2.58it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:12,  2.72it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.82it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.91it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.96it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.01it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.04it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.05it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.04it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.05it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.11it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.10it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.03it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.18it/s][A04/28/2024 18:58:48 - INFO - trainer.trainer_mod_2 - Epoch 70 finished. Took 25.89 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  71%|███████   | 71/100 [31:09<12:37, 26.14s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.14it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.12it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:58:52,483 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:58:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:58:52 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:58:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:58:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 18:58:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:58:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0274423, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1048, 1097, 1061, 937, 1038, 928, 1622, 630, 658, 1077, 511, 427], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51750220, 'remaining_params': 33267380, 'pruned_model_sparsity': 0.6087000809244204, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 5550}


Iteration:  15%|█▌        | 12/78 [00:04<00:33,  1.96it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:29,  2.20it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:26,  2.41it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:24,  2.60it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:22,  2.73it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.82it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.90it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.94it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.97it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.97it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.00it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.02it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.04it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.04it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.05it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.05it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.10it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.10it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.10it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:59:09,327 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:59:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:59:09 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:59:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:59:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 18:59:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:59:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0147147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1051, 1100, 1065, 939, 1039, 928, 1619, 629, 657, 1075, 510, 426], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51731836, 'remaining_params': 33285764, 'pruned_model_sparsity': 0.6084838433453779, 'expected_sparsity': 0.59979, 'target_sparsity': 0.6, 'step': 5600}


Iteration:  79%|███████▉  | 62/78 [00:21<00:08,  1.96it/s][A04/28/2024 18:59:10 - INFO - trainer.trainer_mod_2 - v4 Global step: 5600, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  81%|████████  | 63/78 [00:21<00:06,  2.20it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:05,  2.42it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.59it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.72it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.82it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.89it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.93it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.98it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.03it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.04it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A04/28/2024 18:59:15 - INFO - trainer.trainer_mod_2 - Epoch 71 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  72%|███████▏  | 72/100 [31:35<12:14, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.11it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.11it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.10it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.11it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.11it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.10it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 18:59:26,100 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:59:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:59:26 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:59:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:59:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.43it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.52it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.53it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.58it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.11it/s]04/28/2024 18:59:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:59:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 1.0183396, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1053, 1101, 1068, 940, 1040, 927, 1617, 628, 657, 1073, 509, 425], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51722644, 'remaining_params': 33294956, 'pruned_model_sparsity': 0.6083757245558566, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 5650}


Iteration:  44%|████▎     | 34/78 [00:11<00:22,  1.96it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:19,  2.20it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:17,  2.41it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:15,  2.58it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:14,  2.71it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.81it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.88it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.91it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.97it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.00it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.02it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.04it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.10it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 18:59:40 - INFO - trainer.trainer_mod_2 - Epoch 72 finished. Took 25.87 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  73%|███████▎  | 73/100 [32:01<11:45, 26.13s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.07it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 18:59:42,902 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:59:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:59:42 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:59:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:59:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 18:59:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 18:59:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0002915, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1054, 1103, 1070, 940, 1040, 926, 1613, 625, 656, 1072, 508, 424], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51721112, 'remaining_params': 33296488, 'pruned_model_sparsity': 0.6083577047576031, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 5700}


Iteration:   8%|▊         | 6/78 [00:02<00:38,  1.88it/s][A04/28/2024 18:59:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 5700, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:   9%|▉         | 7/78 [00:02<00:32,  2.16it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:29,  2.38it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:26,  2.57it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:25,  2.71it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.81it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.89it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.95it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.99it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.02it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.04it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.13it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.12it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.10it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.11it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.11it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.11it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.07it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.07it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.06it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 18:59:59,707 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 18:59:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 18:59:59 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 18:59:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 18:59:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:00:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:00:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 1.0156808, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1055, 1105, 1072, 941, 1041, 925, 1609, 623, 656, 1070, 508, 422], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51714984, 'remaining_params': 33302616, 'pruned_model_sparsity': 0.608285625564589, 'expected_sparsity': 0.60021, 'target_sparsity': 0.6, 'step': 5750}


Iteration:  72%|███████▏  | 56/78 [00:19<00:11,  1.98it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:09,  2.22it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:08,  2.42it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:07,  2.59it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.72it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:06,  2.82it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.89it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.95it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.98it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.02it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.03it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.17it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A04/28/2024 19:00:07 - INFO - trainer.trainer_mod_2 - Epoch 73 finished. Took 26.44 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  74%|███████▍  | 74/100 [32:28<11:21, 26.22s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.12it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.05it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:18,  3.15it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.13it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.12it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.11it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.10it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:00:16,448 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:00:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:00:16 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:00:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:00:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.60it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 19:00:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:00:17 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.98842824, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1057, 1107, 1075, 942, 1043, 924, 1606, 621, 656, 1068, 507, 421], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51704260, 'remaining_params': 33313340, 'pruned_model_sparsity': 0.6081594869768142, 'expected_sparsity': 0.60023, 'target_sparsity': 0.6, 'step': 5800}


Iteration:  36%|███▌      | 28/78 [00:09<00:25,  1.96it/s][A04/28/2024 19:00:17 - INFO - trainer.trainer_mod_2 - v4 Global step: 5800, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  37%|███▋      | 29/78 [00:09<00:22,  2.21it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:19,  2.41it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:18,  2.58it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:16,  2.71it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.82it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:15,  2.89it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  2.96it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.98it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.02it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.10it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.12it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.11it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.11it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.10it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.11it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.10it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.10it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.06it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 19:00:33,227 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:00:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:00:33 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:00:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:00:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.77it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:00:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:00:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.043635, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1059, 1110, 1078, 944, 1046, 924, 1605, 620, 655, 1068, 505, 420], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51685876, 'remaining_params': 33331724, 'pruned_model_sparsity': 0.6079432493977718, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 5850}


Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.01it/s][A04/28/2024 19:00:33 - INFO - trainer.trainer_mod_2 - Epoch 74 finished. Took 26.45 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  75%|███████▌  | 75/100 [32:54<10:57, 26.29s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.05it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.11it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.10it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.10it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:15<00:09,  3.12it/s][A
Iteration:  63%|██████▎   | 49/78 [00:15<00:09,  3.12it/s][A[INFO|trainer.py:570] 2024-04-28 19:00:50,038 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:00:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:00:50 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:00:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:00:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:00:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:00:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 1.0099934, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1062, 1113, 1082, 946, 1048, 924, 1603, 620, 655, 1067, 505, 420], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51664428, 'remaining_params': 33353172, 'pruned_model_sparsity': 0.6076909722222222, 'expected_sparsity': 0.60002, 'target_sparsity': 0.6, 'step': 5900}


Iteration:  64%|██████▍   | 50/78 [00:16<00:14,  1.97it/s][A04/28/2024 19:00:50 - INFO - trainer.trainer_mod_2 - v4 Global step: 5900, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  65%|██████▌   | 51/78 [00:17<00:12,  2.21it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:10,  2.41it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:09,  2.58it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.72it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:08,  2.82it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.90it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.95it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  2.99it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.03it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.04it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.06it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.14it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.12it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.07it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A04/28/2024 19:00:59 - INFO - trainer.trainer_mod_2 - Epoch 75 finished. Took 25.84 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  76%|███████▌  | 76/100 [33:20<10:27, 26.15s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.11it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.11it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:01:06,802 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:01:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:01:06 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:01:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:01:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 19:01:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:01:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0148994, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1066, 1116, 1086, 948, 1051, 924, 1602, 619, 654, 1066, 504, 418], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51641448, 'remaining_params': 33376152, 'pruned_model_sparsity': 0.6074206752484191, 'expected_sparsity': 0.59971, 'target_sparsity': 0.6, 'step': 5950}


Iteration:  28%|██▊       | 22/78 [00:07<00:28,  1.97it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:24,  2.21it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:22,  2.42it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:20,  2.60it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:19,  2.73it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:18,  2.83it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:17,  2.88it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  2.94it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.99it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.03it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.05it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.05it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.08it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.07it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.06it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 19:01:23,645 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:01:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:01:23 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:01:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:01:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.17it/s]04/28/2024 19:01:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:01:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 1.0136956, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1068, 1118, 1089, 950, 1053, 924, 1599, 617, 654, 1064, 504, 417], 'head_nums': [12, 10, 11, 11, 11, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51627660, 'remaining_params': 33389940, 'pruned_model_sparsity': 0.6072584970641373, 'expected_sparsity': 0.59985, 'target_sparsity': 0.6, 'step': 6000}


Iteration:  92%|█████████▏| 72/78 [00:24<00:03,  1.96it/s][A04/28/2024 19:01:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 6000, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  94%|█████████▎| 73/78 [00:24<00:02,  2.20it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.40it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.58it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.71it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.81it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.01it/s][A04/28/2024 19:01:26 - INFO - trainer.trainer_mod_2 - Epoch 76 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  77%|███████▋  | 77/100 [33:46<10:03, 26.25s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.06it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.07it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 19:01:40,439 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:01:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:01:40 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:01:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:01:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 19:01:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:01:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 0.9908151, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1070, 1122, 1092, 951, 1053, 923, 1596, 616, 654, 1062, 502, 416], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51419308, 'remaining_params': 33598292, 'pruned_model_sparsity': 0.6048078045016562, 'expected_sparsity': 0.59982, 'target_sparsity': 0.6, 'step': 6050}


Iteration:  56%|█████▋    | 44/78 [00:14<00:17,  1.96it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:14,  2.20it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:13,  2.41it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:12,  2.58it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:11,  2.71it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:10,  2.82it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  2.90it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.95it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.99it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.02it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.04it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.03it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.04it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.06it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.10it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.23it/s][A04/28/2024 19:01:52 - INFO - trainer.trainer_mod_2 - Epoch 77 finished. Took 25.86 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  78%|███████▊  | 78/100 [34:12<09:34, 26.14s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.07it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.07it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 19:01:57,213 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:01:57 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:01:57 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:01:57 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:01:57 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/28/2024 19:01:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:01:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 1.0174088, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1072, 1123, 1095, 952, 1054, 922, 1593, 614, 653, 1060, 501, 415], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51411648, 'remaining_params': 33605952, 'pruned_model_sparsity': 0.6047177055103884, 'expected_sparsity': 0.59998, 'target_sparsity': 0.6, 'step': 6100}


Iteration:  21%|██        | 16/78 [00:05<00:31,  1.97it/s][A04/28/2024 19:01:57 - INFO - trainer.trainer_mod_2 - v4 Global step: 6100, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  22%|██▏       | 17/78 [00:06<00:27,  2.21it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:24,  2.42it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:22,  2.59it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:21,  2.72it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:20,  2.82it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:19,  2.89it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  2.94it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.99it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.01it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.03it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.11it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.11it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.10it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.13it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.11it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.12it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.10it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.10it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.10it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.07it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:02:14,010 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:02:14 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:02:14 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:02:14 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:02:14 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:02:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:02:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0141578, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1073, 1125, 1097, 953, 1056, 921, 1590, 613, 653, 1058, 499, 413], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51402456, 'remaining_params': 33615144, 'pruned_model_sparsity': 0.6046095867208672, 'expected_sparsity': 0.60009, 'target_sparsity': 0.6, 'step': 6150}


Iteration:  85%|████████▍ | 66/78 [00:22<00:06,  1.97it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:04,  2.20it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:04,  2.41it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.58it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.71it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.81it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.89it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.94it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.98it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.01it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.03it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A04/28/2024 19:02:18 - INFO - trainer.trainer_mod_2 - Epoch 78 finished. Took 26.44 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  79%|███████▉  | 79/100 [34:39<09:10, 26.23s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.14it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.14it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.12it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.11it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.03it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.10it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 19:02:30,785 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:02:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:02:30 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:02:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:02:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.78it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 19:02:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:02:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 1.020568, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1075, 1127, 1100, 954, 1058, 920, 1587, 611, 653, 1056, 498, 412], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51391732, 'remaining_params': 33625868, 'pruned_model_sparsity': 0.6044834481330924, 'expected_sparsity': 0.60022, 'target_sparsity': 0.6, 'step': 6200}


Iteration:  49%|████▊     | 38/78 [00:12<00:20,  1.96it/s][A04/28/2024 19:02:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 6200, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  50%|█████     | 39/78 [00:13<00:17,  2.19it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:15,  2.42it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:14,  2.58it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:13,  2.72it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:12,  2.81it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.89it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.94it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  2.99it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.00it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.03it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.04it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.23it/s][A04/28/2024 19:02:44 - INFO - trainer.trainer_mod_2 - Epoch 79 finished. Took 25.85 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  80%|████████  | 80/100 [35:05<08:42, 26.11s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.11it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.11it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.12it/s][A[INFO|trainer.py:570] 2024-04-28 19:02:47,539 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:02:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:02:47 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:02:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:02:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.74it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.29it/s]04/28/2024 19:02:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:02:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0102632, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1078, 1129, 1104, 955, 1059, 920, 1585, 610, 653, 1054, 497, 411], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51376412, 'remaining_params': 33641188, 'pruned_model_sparsity': 0.6043032501505571, 'expected_sparsity': 0.6002, 'target_sparsity': 0.6, 'step': 6250}


Iteration:  13%|█▎        | 10/78 [00:03<00:34,  1.96it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:30,  2.21it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:27,  2.41it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:25,  2.59it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:23,  2.72it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:22,  2.83it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:21,  2.90it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  2.96it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.99it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.01it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  3.04it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.05it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.07it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.10it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.07it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.10it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.11it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.11it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.10it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.10it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 19:03:04,332 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:03:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:03:04 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:03:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:03:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:03:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:03:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0070353, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1080, 1133, 1108, 958, 1061, 920, 1583, 610, 652, 1053, 497, 410], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51353432, 'remaining_params': 33664168, 'pruned_model_sparsity': 0.604032953176754, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 6300}


Iteration:  77%|███████▋  | 60/78 [00:20<00:09,  1.97it/s][A04/28/2024 19:03:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 6300, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  78%|███████▊  | 61/78 [00:20<00:07,  2.22it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:06,  2.42it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.60it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:05,  2.73it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.83it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.90it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.95it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.99it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.02it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.04it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.12it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.11it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.22it/s][A04/28/2024 19:03:10 - INFO - trainer.trainer_mod_2 - Epoch 80 finished. Took 26.38 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.96it/s]
Epoch:  81%|████████  | 81/100 [35:31<08:17, 26.20s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.07it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.12it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.10it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.10it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:03:21,069 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:03:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:03:21 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:03:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:03:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.77it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 19:03:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:03:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 0.99334276, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1083, 1135, 1111, 960, 1063, 920, 1581, 609, 652, 1052, 496, 408], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51336580, 'remaining_params': 33681020, 'pruned_model_sparsity': 0.6038347353959651, 'expected_sparsity': 0.59986, 'target_sparsity': 0.6, 'step': 6350}


Iteration:  41%|████      | 32/78 [00:10<00:23,  1.96it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:20,  2.21it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:18,  2.42it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:16,  2.58it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:15,  2.71it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:14,  2.81it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.89it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:13,  2.94it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  2.99it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.02it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.04it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.06it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.06it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.05it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.04it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.04it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.04it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.05it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.10it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.20it/s][A04/28/2024 19:03:36 - INFO - trainer.trainer_mod_2 - Epoch 81 finished. Took 25.88 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.01it/s]
Epoch:  82%|████████▏ | 82/100 [35:57<07:49, 26.10s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.04it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 19:03:37,880 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:03:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:03:37 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:03:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:03:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 19:03:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:03:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0101241, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1085, 1137, 1114, 961, 1065, 919, 1579, 607, 652, 1050, 495, 407], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51325856, 'remaining_params': 33691744, 'pruned_model_sparsity': 0.6037085968081903, 'expected_sparsity': 0.59988, 'target_sparsity': 0.6, 'step': 6400}


Iteration:   5%|▌         | 4/78 [00:01<00:41,  1.76it/s][A04/28/2024 19:03:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 6400, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:   6%|▋         | 5/78 [00:02<00:34,  2.10it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:30,  2.33it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:28,  2.53it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:26,  2.69it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:24,  2.80it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:23,  2.88it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  2.94it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.98it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.00it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  3.02it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.04it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.05it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.06it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.07it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.11it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.10it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.10it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.10it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:03:54,698 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:03:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:03:54 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:03:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:03:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 19:03:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:03:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 1.0095551, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1086, 1139, 1116, 962, 1066, 919, 1576, 605, 652, 1048, 494, 405], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51318196, 'remaining_params': 33699404, 'pruned_model_sparsity': 0.6036184978169226, 'expected_sparsity': 0.59997, 'target_sparsity': 0.6, 'step': 6450}


Iteration:  69%|██████▉   | 54/78 [00:18<00:12,  1.97it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:10,  2.21it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:09,  2.42it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:08,  2.58it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:07,  2.85it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.91it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.96it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  2.99it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.01it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.04it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.11it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.20it/s][A04/28/2024 19:04:03 - INFO - trainer.trainer_mod_2 - Epoch 82 finished. Took 26.43 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  83%|████████▎ | 83/100 [36:23<07:25, 26.20s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.11it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.11it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:04:11,428 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:04:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:04:11 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:04:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:04:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 19:04:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:04:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 1.0250411, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1088, 1142, 1118, 964, 1069, 918, 1572, 604, 651, 1045, 493, 404], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51302876, 'remaining_params': 33714724, 'pruned_model_sparsity': 0.6034382998343872, 'expected_sparsity': 0.60021, 'target_sparsity': 0.6, 'step': 6500}


Iteration:  33%|███▎      | 26/78 [00:09<00:26,  1.97it/s][A04/28/2024 19:04:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 6500, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  35%|███▍      | 27/78 [00:09<00:23,  2.20it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:20,  2.41it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:18,  2.58it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:17,  2.73it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:16,  2.82it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  2.90it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.95it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.00it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.02it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.05it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.06it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:08,  3.12it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.11it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.07it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.11it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.10it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.10it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:04:28,220 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:04:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:04:28 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:04:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:04:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 19:04:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:04:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 1.0244727, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1090, 1145, 1121, 965, 1071, 918, 1570, 602, 651, 1044, 492, 402], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51289088, 'remaining_params': 33728512, 'pruned_model_sparsity': 0.6032761216501054, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 6550}


Iteration:  97%|█████████▋| 76/78 [00:25<00:01,  1.97it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.21it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.49it/s][A04/28/2024 19:04:29 - INFO - trainer.trainer_mod_2 - Epoch 83 finished. Took 26.44 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  84%|████████▍ | 84/100 [36:50<07:00, 26.27s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.13it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.11it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.11it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.02it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.03it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.04it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.05it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.06it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.11it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.11it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.11it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.11it/s][A
Iteration:  59%|█████▉    | 46/78 [00:14<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 19:04:45,009 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:04:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:04:45 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:04:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:04:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 19:04:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:04:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6389891696750902, 'eval_loss': 1.0345097, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1094, 1147, 1126, 968, 1073, 918, 1568, 602, 651, 1042, 491, 401], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51264576, 'remaining_params': 33753024, 'pruned_model_sparsity': 0.6029878048780488, 'expected_sparsity': 0.6, 'target_sparsity': 0.6, 'step': 6600}


Iteration:  62%|██████▏   | 48/78 [00:16<00:15,  1.97it/s][A04/28/2024 19:04:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 6600, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  63%|██████▎   | 49/78 [00:16<00:13,  2.21it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:11,  2.40it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:10,  2.57it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:09,  2.70it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.83it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.90it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  2.95it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  2.98it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.00it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.04it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.06it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.07it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.07it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.07it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.07it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.10it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 19:04:55 - INFO - trainer.trainer_mod_2 - Epoch 84 finished. Took 25.86 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  85%|████████▌ | 85/100 [37:16<06:32, 26.15s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.10it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:21,  3.10it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.10it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.10it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:05:01,772 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:05:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:05:01 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:05:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:05:01 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 19:05:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:05:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0309794, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1097, 1150, 1130, 970, 1076, 919, 1566, 601, 651, 1040, 491, 400], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51241596, 'remaining_params': 33776004, 'pruned_model_sparsity': 0.6027175079042457, 'expected_sparsity': 0.59973, 'target_sparsity': 0.6, 'step': 6650}


Iteration:  26%|██▌       | 20/78 [00:07<00:29,  1.96it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:25,  2.20it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:23,  2.41it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:21,  2.58it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:19,  2.71it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.82it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.90it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:17,  2.95it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  2.99it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.02it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.04it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.05it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.07it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.10it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.10it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.11it/s][A[INFO|trainer.py:570] 2024-04-28 19:05:18,583 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:05:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:05:18 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:05:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:05:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/28/2024 19:05:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:05:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0184007, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1099, 1152, 1133, 972, 1078, 918, 1564, 600, 650, 1038, 490, 398], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51227808, 'remaining_params': 33789792, 'pruned_model_sparsity': 0.6025553297199638, 'expected_sparsity': 0.59969, 'target_sparsity': 0.6, 'step': 6700}


Iteration:  90%|████████▉ | 70/78 [00:23<00:04,  1.98it/s][A04/28/2024 19:05:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 6700, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  91%|█████████ | 71/78 [00:24<00:03,  2.22it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.42it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.58it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.71it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.82it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.89it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.95it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.11it/s][A04/28/2024 19:05:21 - INFO - trainer.trainer_mod_2 - Epoch 85 finished. Took 26.44 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  86%|████████▌ | 86/100 [37:42<06:07, 26.24s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.05it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.07it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:21,  3.04it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.06it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.11it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 19:05:35,368 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:05:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:05:35 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:05:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:05:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:05:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:05:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 1.0225246, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1101, 1154, 1135, 973, 1078, 917, 1560, 597, 650, 1035, 488, 396], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51223212, 'remaining_params': 33794388, 'pruned_model_sparsity': 0.6025012703252033, 'expected_sparsity': 0.59992, 'target_sparsity': 0.6, 'step': 6750}


Iteration:  54%|█████▍    | 42/78 [00:14<00:18,  1.97it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:15,  2.21it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:14,  2.42it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:12,  2.58it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.73it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.82it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.90it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  2.96it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.01it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.03it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.04it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.06it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.07it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.08it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.10it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.09it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.11it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.23it/s][A04/28/2024 19:05:47 - INFO - trainer.trainer_mod_2 - Epoch 86 finished. Took 25.83 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  87%|████████▋ | 87/100 [38:08<05:39, 26.12s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.02it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.04it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.06it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.06it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.07it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.15it/s][A[INFO|trainer.py:570] 2024-04-28 19:05:52,117 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:05:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:05:52 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:05:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:05:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:05:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:05:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6425992779783394, 'eval_loss': 1.0165267, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1102, 1155, 1137, 974, 1078, 915, 1556, 595, 649, 1031, 486, 394], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51221680, 'remaining_params': 33795920, 'pruned_model_sparsity': 0.6024832505269497, 'expected_sparsity': 0.60024, 'target_sparsity': 0.6, 'step': 6800}


Iteration:  18%|█▊        | 14/78 [00:05<00:32,  1.98it/s][A04/28/2024 19:05:52 - INFO - trainer.trainer_mod_2 - v4 Global step: 6800, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  19%|█▉        | 15/78 [00:05<00:28,  2.23it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:25,  2.43it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:23,  2.59it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:21,  2.73it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:20,  2.82it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.90it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:19,  2.96it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  2.99it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.02it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.04it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.05it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  3.02it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.04it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.07it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:15,  3.06it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.06it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.15it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.14it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.12it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.11it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.10it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.13it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.12it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.10it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.10it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:06:08,920 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:06:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:06:08 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:06:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:06:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.80it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 19:06:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:06:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6498194945848376, 'eval_loss': 1.0399467, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1104, 1156, 1139, 974, 1079, 914, 1553, 592, 649, 1028, 485, 392], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51218616, 'remaining_params': 33798984, 'pruned_model_sparsity': 0.6024472109304426, 'expected_sparsity': 0.60043, 'target_sparsity': 0.6, 'step': 6850}


Iteration:  82%|████████▏ | 64/78 [00:21<00:07,  1.97it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.21it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.41it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:04,  2.59it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.72it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.82it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.90it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.95it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.99it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.02it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.13it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.10it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.10it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.23it/s][A04/28/2024 19:06:13 - INFO - trainer.trainer_mod_2 - Epoch 87 finished. Took 26.41 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  88%|████████▊ | 88/100 [38:34<05:14, 26.20s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.07it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.07it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.09it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.09it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 19:06:25,667 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:06:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:06:25 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:06:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:06:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.21it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 15.97it/s]04/28/2024 19:06:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:06:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6462093862815884, 'eval_loss': 1.029872, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1108, 1160, 1143, 976, 1082, 914, 1552, 592, 649, 1027, 484, 391], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51192572, 'remaining_params': 33825028, 'pruned_model_sparsity': 0.6021408743601325, 'expected_sparsity': 0.60017, 'target_sparsity': 0.6, 'step': 6900}


Iteration:  46%|████▌     | 36/78 [00:12<00:21,  1.96it/s][A04/28/2024 19:06:26 - INFO - trainer.trainer_mod_2 - v4 Global step: 6900, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  47%|████▋     | 37/78 [00:12<00:18,  2.21it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:16,  2.41it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:15,  2.57it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:14,  2.71it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:13,  2.81it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.88it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  2.94it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  2.98it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.01it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.03it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.05it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.05it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.07it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.12it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.10it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 19:06:39 - INFO - trainer.trainer_mod_2 - Epoch 88 finished. Took 25.86 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  89%|████████▉ | 89/100 [39:00<04:47, 26.10s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:06:42,439 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:06:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:06:42 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:06:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:06:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.73it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:06:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:06:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6606498194945848, 'eval_loss': 1.0016924, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1113, 1164, 1149, 980, 1085, 915, 1551, 592, 649, 1026, 484, 391], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51157336, 'remaining_params': 33860264, 'pruned_model_sparsity': 0.6017264190003011, 'expected_sparsity': 0.59962, 'target_sparsity': 0.6, 'step': 6950}


Iteration:  10%|█         | 8/78 [00:03<00:36,  1.93it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:31,  2.18it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:28,  2.40it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:26,  2.57it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:24,  2.72it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:23,  2.82it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:22,  2.89it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:21,  2.95it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  2.99it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:20,  3.02it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.04it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.05it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.07it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.12it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.10it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.10it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.10it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.13it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.12it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.11it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.14it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.12it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.11it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.12it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:09,  3.11it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.10it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.07it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.03it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.04it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.08it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.20it/s][A[INFO|trainer.py:570] 2024-04-28 19:06:59,206 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:06:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:06:59 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:06:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:06:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.23it/s]04/28/2024 19:06:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:06:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6534296028880866, 'eval_loss': 0.99999, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1116, 1167, 1153, 982, 1088, 915, 1549, 591, 648, 1025, 483, 389], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51135888, 'remaining_params': 33881712, 'pruned_model_sparsity': 0.6014741418247516, 'expected_sparsity': 0.59944, 'target_sparsity': 0.6, 'step': 7000}


Iteration:  74%|███████▍  | 58/78 [00:19<00:10,  2.00it/s][A04/28/2024 19:06:59 - INFO - trainer.trainer_mod_2 - v4 Global step: 7000, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  76%|███████▌  | 59/78 [00:20<00:08,  2.23it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:07,  2.44it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:06,  2.60it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.73it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.82it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.90it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  2.97it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.01it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.03it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.05it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.06it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.06it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.19it/s][A04/28/2024 19:07:06 - INFO - trainer.trainer_mod_2 - Epoch 89 finished. Took 26.41 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  90%|█████████ | 90/100 [39:27<04:21, 26.19s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.09it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.06it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.06it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.10it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.08it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.08it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.08it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.10it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.09it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.12it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.11it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.10it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.11it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 19:07:15,969 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:07:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:07:15 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:07:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:07:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 19:07:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:07:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 0.99521327, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1116, 1168, 1155, 982, 1088, 912, 1545, 587, 648, 1020, 481, 386], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51142016, 'remaining_params': 33875584, 'pruned_model_sparsity': 0.6015462210177658, 'expected_sparsity': 0.59976, 'target_sparsity': 0.6, 'step': 7050}


Iteration:  38%|███▊      | 30/78 [00:10<00:24,  1.97it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:21,  2.21it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:19,  2.41it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:17,  2.58it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:16,  2.71it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:15,  2.81it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.88it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  2.94it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  2.98it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.01it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.03it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.04it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.09it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.07it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.07it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.22it/s][A04/28/2024 19:07:32 - INFO - trainer.trainer_mod_2 - Epoch 90 finished. Took 25.84 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  91%|█████████ | 91/100 [39:52<03:54, 26.09s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 19:07:32,754 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:07:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:07:32 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:07:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:07:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.76it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.62it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 19:07:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:07:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 1.007354, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1115, 1168, 1156, 981, 1087, 909, 1541, 584, 646, 1015, 478, 383], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 9, 8, 9], 'pruned_params': 51350368, 'remaining_params': 33667232, 'pruned_model_sparsity': 0.6039969135802469, 'expected_sparsity': 0.60035, 'target_sparsity': 0.6, 'step': 7100}


Iteration:   3%|▎         | 2/78 [00:01<00:51,  1.46it/s][A04/28/2024 19:07:33 - INFO - trainer.trainer_mod_2 - v4 Global step: 7100, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:   4%|▍         | 3/78 [00:01<00:38,  1.92it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:32,  2.27it/s][A
Iteration:   6%|▋         | 5/78 [00:02<00:29,  2.50it/s][A
Iteration:   8%|▊         | 6/78 [00:02<00:26,  2.67it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:25,  2.80it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:24,  2.90it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:23,  2.96it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  2.99it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:22,  3.02it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:21,  3.04it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.06it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.07it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.08it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.08it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.08it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.07it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.10it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.10it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.10it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.10it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:08,  3.19it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.16it/s][A[INFO|trainer.py:570] 2024-04-28 19:07:49,522 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:07:49 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:07:49 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:07:49 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:07:49 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.77it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:07:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:07:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.99494135, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1116, 1169, 1158, 982, 1088, 909, 1536, 582, 646, 1010, 476, 380], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51540336, 'remaining_params': 33477264, 'pruned_model_sparsity': 0.6062313685636856, 'expected_sparsity': 0.60058, 'target_sparsity': 0.6, 'step': 7150}


Iteration:  67%|██████▋   | 52/78 [00:18<00:13,  1.99it/s][A
Iteration:  68%|██████▊   | 53/78 [00:18<00:11,  2.23it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:09,  2.43it/s][A
Iteration:  71%|███████   | 55/78 [00:19<00:08,  2.60it/s][A
Iteration:  72%|███████▏  | 56/78 [00:19<00:08,  2.72it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:07,  2.82it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  2.89it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:06,  2.95it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.98it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.01it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  3.04it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.04it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.05it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.06it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.07it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.09it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.07it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.05it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.07it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A04/28/2024 19:07:58 - INFO - trainer.trainer_mod_2 - Epoch 91 finished. Took 26.43 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  92%|█████████▏| 92/100 [40:19<03:29, 26.19s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.07it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.09it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:20,  3.10it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.09it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.06it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 19:08:06,331 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:08:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:08:06 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:08:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:08:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.59it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 19:08:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:08:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.99158674, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1119, 1172, 1161, 984, 1090, 909, 1535, 581, 646, 1008, 475, 378], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51521952, 'remaining_params': 33495648, 'pruned_model_sparsity': 0.6060151309846432, 'expected_sparsity': 0.60051, 'target_sparsity': 0.6, 'step': 7200}


Iteration:  31%|███       | 24/78 [00:08<00:27,  1.95it/s][A04/28/2024 19:08:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 7200, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  32%|███▏      | 25/78 [00:08<00:24,  2.18it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:21,  2.39it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:19,  2.57it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:18,  2.70it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:17,  2.81it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:16,  2.88it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  2.94it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:15,  2.98it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.01it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.03it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  3.05it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.06it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.07it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.07it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.10it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.10it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.10it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.06it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.06it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.08it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.10it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.10it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.06it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.06it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.07it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A[INFO|trainer.py:570] 2024-04-28 19:08:23,174 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:08:23 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:08:23 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:08:23 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:08:23 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 19:08:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:08:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.97907376, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1125, 1177, 1167, 989, 1095, 911, 1535, 582, 646, 1009, 476, 379], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51475992, 'remaining_params': 33541608, 'pruned_model_sparsity': 0.605474537037037, 'expected_sparsity': 0.59981, 'target_sparsity': 0.6, 'step': 7250}


Iteration:  95%|█████████▍| 74/78 [00:25<00:02,  1.97it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.21it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.41it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  2.58it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.81it/s][A04/28/2024 19:08:25 - INFO - trainer.trainer_mod_2 - Epoch 92 finished. Took 26.51 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  93%|█████████▎| 93/100 [40:45<03:04, 26.29s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.13it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.12it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.10it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.10it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.11it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:18,  3.11it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.11it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.11it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.20it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.17it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.15it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.13it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.11it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.12it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:15,  3.11it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.10it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:10<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:11<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.08it/s][A
Iteration:  51%|█████▏    | 40/78 [00:12<00:12,  3.08it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:13<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:13<00:11,  3.08it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:14<00:10,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:08:39,888 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:08:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:08:39 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:08:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:08:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.82it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.23it/s]04/28/2024 19:08:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:08:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 1.0001538, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1131, 1181, 1173, 992, 1100, 913, 1535, 583, 646, 1009, 475, 378], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51238532, 'remaining_params': 33779068, 'pruned_model_sparsity': 0.6026814683077386, 'expected_sparsity': 0.59915, 'target_sparsity': 0.6, 'step': 7300}


Iteration:  59%|█████▉    | 46/78 [00:15<00:16,  1.97it/s][A04/28/2024 19:08:40 - INFO - trainer.trainer_mod_2 - v4 Global step: 7300, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  60%|██████    | 47/78 [00:15<00:14,  2.21it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:12,  2.41it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:11,  2.58it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:10,  2.71it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:09,  2.82it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  2.90it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  2.95it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:08,  2.98it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.01it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.03it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.05it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.06it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.07it/s][A
Iteration:  77%|███████▋  | 60/78 [00:19<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.10it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.10it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.10it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.10it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.10it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.10it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.09it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.10it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.11it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.10it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.10it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.24it/s][A04/28/2024 19:08:50 - INFO - trainer.trainer_mod_2 - Epoch 93 finished. Took 25.75 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.03it/s]
Epoch:  94%|█████████▍| 94/100 [41:11<02:36, 26.13s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.06it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:25,  3.02it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.04it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.07it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.07it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A[INFO|trainer.py:570] 2024-04-28 19:08:56,652 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:08:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:08:56 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:08:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:08:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.82it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 19:08:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:08:57 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6570397111913358, 'eval_loss': 0.9940784, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1132, 1183, 1176, 992, 1101, 911, 1531, 581, 645, 1003, 474, 376], 'head_nums': [12, 10, 11, 11, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51233936, 'remaining_params': 33783664, 'pruned_model_sparsity': 0.6026274089129781, 'expected_sparsity': 0.59943, 'target_sparsity': 0.6, 'step': 7350}


Iteration:  23%|██▎       | 18/78 [00:06<00:30,  1.97it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:26,  2.21it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:24,  2.42it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:22,  2.59it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:20,  2.71it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:19,  2.82it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:18,  2.89it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:18,  2.94it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:17,  2.98it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.00it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.03it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:16,  3.04it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:11<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.07it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.11it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.10it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.10it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.09it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.09it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.11it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.10it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.10it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.09it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.08it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.10it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.10it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.08it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:09:13,454 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:09:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:09:13 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:09:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:09:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.21it/s]04/28/2024 19:09:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:09:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.989536, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1130, 1181, 1174, 989, 1098, 906, 1523, 576, 644, 996, 471, 371], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51463736, 'remaining_params': 33553864, 'pruned_model_sparsity': 0.6053303786510087, 'expected_sparsity': 0.60028, 'target_sparsity': 0.6, 'step': 7400}


Iteration:  87%|████████▋ | 68/78 [00:23<00:05,  1.97it/s][A04/28/2024 19:09:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 7400, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  88%|████████▊ | 69/78 [00:23<00:04,  2.21it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:03,  2.42it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  2.58it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:02,  2.67it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  2.78it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  2.87it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:01,  2.92it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  2.98it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.02it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.17it/s][A04/28/2024 19:09:17 - INFO - trainer.trainer_mod_2 - Epoch 94 finished. Took 26.48 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  95%|█████████▌| 95/100 [41:38<02:11, 26.23s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.03it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.06it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.05it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.06it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.07it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.08it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.08it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.09it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.09it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.04it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.06it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.07it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.09it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.08it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.07it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.09it/s][A
Iteration:  46%|████▌     | 36/78 [00:11<00:13,  3.09it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:12<00:12,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:09:30,272 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:09:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:09:30 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:09:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:09:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.86it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.70it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.23it/s]04/28/2024 19:09:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:09:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.9854365, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1130, 1180, 1173, 988, 1096, 903, 1517, 572, 643, 990, 468, 367], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51482120, 'remaining_params': 33535480, 'pruned_model_sparsity': 0.6055466162300512, 'expected_sparsity': 0.60099, 'target_sparsity': 0.6, 'step': 7450}


Iteration:  51%|█████▏    | 40/78 [00:13<00:19,  1.96it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:16,  2.20it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:14,  2.42it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:13,  2.58it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:12,  2.71it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:11,  2.82it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:11,  2.89it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  2.95it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:10,  2.99it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.01it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.02it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.05it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.07it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.07it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.07it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.11it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.10it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.10it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.10it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.09it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.10it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.08it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.09it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.08it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.10it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.09it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.10it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.10it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.09it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.23it/s][A04/28/2024 19:09:43 - INFO - trainer.trainer_mod_2 - Epoch 95 finished. Took 25.86 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  96%|█████████▌| 96/100 [42:03<01:44, 26.12s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.10it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.08it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.09it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.11it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.10it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.10it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:09:47,018 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:09:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:09:47 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:09:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:09:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.84it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.68it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.25it/s]04/28/2024 19:09:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:09:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.9756383, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1133, 1184, 1178, 990, 1098, 905, 1516, 572, 643, 988, 467, 366], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51454544, 'remaining_params': 33563056, 'pruned_model_sparsity': 0.6052222598614875, 'expected_sparsity': 0.60066, 'target_sparsity': 0.6, 'step': 7500}


Iteration:  15%|█▌        | 12/78 [00:04<00:33,  1.96it/s][A04/28/2024 19:09:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 7500, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  17%|█▋        | 13/78 [00:04<00:29,  2.21it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:26,  2.43it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:24,  2.59it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:22,  2.72it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:21,  2.82it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:20,  2.90it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  2.95it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:19,  2.99it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.02it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.04it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:18,  3.05it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.06it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.06it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.07it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.07it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.07it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.08it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.06it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.07it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.08it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.09it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.10it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.10it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.09it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.08it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.06it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.08it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.06it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.08it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.09it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.10it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.10it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.10it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:10:03,833 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:10:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:10:03 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:10:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:10:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.71it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.67it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.69it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/28/2024 19:10:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:10:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6678700361010831, 'eval_loss': 0.9729461, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1141, 1190, 1188, 996, 1105, 909, 1519, 575, 643, 992, 469, 368], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51387136, 'remaining_params': 33630464, 'pruned_model_sparsity': 0.6044293887383319, 'expected_sparsity': 0.59922, 'target_sparsity': 0.6, 'step': 7550}


Iteration:  79%|███████▉  | 62/78 [00:21<00:08,  1.97it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:06,  2.21it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:05,  2.42it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:05,  2.59it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:04,  2.71it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  2.80it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  2.88it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:03,  2.93it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  2.98it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.00it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.03it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.05it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.06it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.06it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.07it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A04/28/2024 19:10:09 - INFO - trainer.trainer_mod_2 - Epoch 96 finished. Took 26.46 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch:  97%|█████████▋| 97/100 [42:30<01:18, 26.22s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.08it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.07it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:24,  3.08it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.11it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.10it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:22,  3.09it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.09it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.09it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.09it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.09it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.09it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.09it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.08it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.07it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.06it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:17,  3.24it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.19it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.17it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:16,  3.14it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.13it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.11it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.11it/s][A
Iteration:  37%|███▋      | 29/78 [00:09<00:15,  3.10it/s][A
Iteration:  38%|███▊      | 30/78 [00:09<00:15,  3.10it/s][A
Iteration:  40%|███▉      | 31/78 [00:09<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.08it/s][A
Iteration:  42%|████▏     | 33/78 [00:10<00:14,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:10:20,564 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:10:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:10:20 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:10:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:10:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.74it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.64it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.18it/s]04/28/2024 19:10:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:10:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6714801444043321, 'eval_loss': 0.9718189, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1146, 1194, 1193, 999, 1109, 910, 1518, 575, 643, 991, 468, 367], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51353432, 'remaining_params': 33664168, 'pruned_model_sparsity': 0.604032953176754, 'expected_sparsity': 0.59874, 'target_sparsity': 0.6, 'step': 7600}


Iteration:  44%|████▎     | 34/78 [00:11<00:22,  1.97it/s][A04/28/2024 19:10:21 - INFO - trainer.trainer_mod_2 - v4 Global step: 7600, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  45%|████▍     | 35/78 [00:11<00:19,  2.21it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:17,  2.42it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:15,  2.58it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:14,  2.68it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:14,  2.78it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:13,  2.88it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  2.94it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:12,  2.99it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.02it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.04it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.06it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.06it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.07it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.07it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.07it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.06it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.05it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.06it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.07it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.09it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.09it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.09it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.09it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.09it/s][A
Iteration:  81%|████████  | 63/78 [00:20<00:04,  3.11it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.11it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.10it/s][A
Iteration:  85%|████████▍ | 66/78 [00:21<00:03,  3.09it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.06it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.06it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.06it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.09it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.08it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.08it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.09it/s][A
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.21it/s][A04/28/2024 19:10:35 - INFO - trainer.trainer_mod_2 - Epoch 97 finished. Took 25.82 seconds.
Iteration: 100%|██████████| 78/78 [00:25<00:00,  3.02it/s]
Epoch:  98%|█████████▊| 98/100 [42:56<00:52, 26.10s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:24,  3.10it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.10it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.09it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.09it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:10:37,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:10:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:10:37 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:10:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:10:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.80it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.65it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.22it/s]04/28/2024 19:10:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:10:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.9804637, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1143, 1192, 1191, 996, 1106, 905, 1511, 569, 641, 984, 464, 362], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51390200, 'remaining_params': 33627400, 'pruned_model_sparsity': 0.6044654283348389, 'expected_sparsity': 0.60006, 'target_sparsity': 0.6, 'step': 7650}


Iteration:   8%|▊         | 6/78 [00:02<00:38,  1.88it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:32,  2.16it/s][A
Iteration:  10%|█         | 8/78 [00:03<00:29,  2.38it/s][A
Iteration:  12%|█▏        | 9/78 [00:03<00:27,  2.55it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:25,  2.71it/s][A
Iteration:  14%|█▍        | 11/78 [00:04<00:23,  2.81it/s][A
Iteration:  15%|█▌        | 12/78 [00:04<00:22,  2.89it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:22,  2.95it/s][A
Iteration:  18%|█▊        | 14/78 [00:05<00:21,  2.99it/s][A
Iteration:  19%|█▉        | 15/78 [00:05<00:20,  3.02it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.04it/s][A
Iteration:  22%|██▏       | 17/78 [00:06<00:19,  3.05it/s][A
Iteration:  23%|██▎       | 18/78 [00:06<00:19,  3.06it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.07it/s][A
Iteration:  26%|██▌       | 20/78 [00:07<00:18,  3.08it/s][A
Iteration:  27%|██▋       | 21/78 [00:07<00:18,  3.07it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.07it/s][A
Iteration:  29%|██▉       | 23/78 [00:08<00:17,  3.07it/s][A
Iteration:  31%|███       | 24/78 [00:08<00:17,  3.08it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.08it/s][A
Iteration:  33%|███▎      | 26/78 [00:09<00:16,  3.08it/s][A
Iteration:  35%|███▍      | 27/78 [00:09<00:16,  3.08it/s][A
Iteration:  36%|███▌      | 28/78 [00:09<00:16,  3.08it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:15,  3.08it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:15,  3.06it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:15,  3.09it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:14,  3.09it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:14,  3.09it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:14,  3.08it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:13,  3.07it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:13,  3.08it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.08it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:12,  3.09it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.09it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.09it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:11,  3.09it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.08it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.09it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:10,  3.10it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.09it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.09it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.09it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.10it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:10:54,180 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:10:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:10:54 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:10:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:10:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.78it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.60it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.61it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:10:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:10:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.9841009, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1139, 1189, 1188, 992, 1102, 900, 1501, 564, 640, 977, 460, 356], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51433096, 'remaining_params': 33584504, 'pruned_model_sparsity': 0.6049699826859379, 'expected_sparsity': 0.60121, 'target_sparsity': 0.6, 'step': 7700}


Iteration:  72%|███████▏  | 56/78 [00:19<00:11,  1.97it/s][A04/28/2024 19:10:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 7700, Alignment: tensor([2, 4, 5, 7], device='cuda:0')

Iteration:  73%|███████▎  | 57/78 [00:19<00:09,  2.20it/s][A
Iteration:  74%|███████▍  | 58/78 [00:20<00:08,  2.41it/s][A
Iteration:  76%|███████▌  | 59/78 [00:20<00:07,  2.58it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:06,  2.70it/s][A
Iteration:  78%|███████▊  | 61/78 [00:21<00:06,  2.80it/s][A
Iteration:  79%|███████▉  | 62/78 [00:21<00:05,  2.88it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:05,  2.93it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  2.98it/s][A
Iteration:  83%|████████▎ | 65/78 [00:22<00:04,  3.01it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.04it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.05it/s][A
Iteration:  87%|████████▋ | 68/78 [00:23<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:23<00:02,  3.07it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.05it/s][A
Iteration:  91%|█████████ | 71/78 [00:24<00:02,  3.05it/s][A
Iteration:  92%|█████████▏| 72/78 [00:24<00:01,  3.05it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.06it/s][A
Iteration:  95%|█████████▍| 74/78 [00:25<00:01,  3.07it/s][A
Iteration:  96%|█████████▌| 75/78 [00:25<00:00,  3.08it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.08it/s][A
Iteration:  99%|█████████▊| 77/78 [00:26<00:00,  3.08it/s][A
Iteration: 100%|██████████| 78/78 [00:26<00:00,  3.21it/s][A04/28/2024 19:11:01 - INFO - trainer.trainer_mod_2 - Epoch 98 finished. Took 26.49 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.94it/s]
Epoch:  99%|█████████▉| 99/100 [43:22<00:26, 26.22s/it]
Iteration:   0%|          | 0/78 [00:00<?, ?it/s][A
Iteration:   1%|▏         | 1/78 [00:00<00:25,  3.08it/s][A
Iteration:   3%|▎         | 2/78 [00:00<00:24,  3.09it/s][A
Iteration:   4%|▍         | 3/78 [00:00<00:24,  3.08it/s][A
Iteration:   5%|▌         | 4/78 [00:01<00:23,  3.10it/s][A
Iteration:   6%|▋         | 5/78 [00:01<00:23,  3.06it/s][A
Iteration:   8%|▊         | 6/78 [00:01<00:23,  3.06it/s][A
Iteration:   9%|▉         | 7/78 [00:02<00:23,  3.08it/s][A
Iteration:  10%|█         | 8/78 [00:02<00:22,  3.08it/s][A
Iteration:  12%|█▏        | 9/78 [00:02<00:22,  3.07it/s][A
Iteration:  13%|█▎        | 10/78 [00:03<00:22,  3.08it/s][A
Iteration:  14%|█▍        | 11/78 [00:03<00:21,  3.08it/s][A
Iteration:  15%|█▌        | 12/78 [00:03<00:21,  3.08it/s][A
Iteration:  17%|█▋        | 13/78 [00:04<00:21,  3.08it/s][A
Iteration:  18%|█▊        | 14/78 [00:04<00:20,  3.08it/s][A
Iteration:  19%|█▉        | 15/78 [00:04<00:20,  3.08it/s][A
Iteration:  21%|██        | 16/78 [00:05<00:20,  3.07it/s][A
Iteration:  22%|██▏       | 17/78 [00:05<00:19,  3.07it/s][A
Iteration:  23%|██▎       | 18/78 [00:05<00:19,  3.09it/s][A
Iteration:  24%|██▍       | 19/78 [00:06<00:19,  3.09it/s][A
Iteration:  26%|██▌       | 20/78 [00:06<00:18,  3.09it/s][A
Iteration:  27%|██▋       | 21/78 [00:06<00:18,  3.09it/s][A
Iteration:  28%|██▊       | 22/78 [00:07<00:18,  3.08it/s][A
Iteration:  29%|██▉       | 23/78 [00:07<00:17,  3.09it/s][A
Iteration:  31%|███       | 24/78 [00:07<00:17,  3.09it/s][A
Iteration:  32%|███▏      | 25/78 [00:08<00:17,  3.09it/s][A
Iteration:  33%|███▎      | 26/78 [00:08<00:16,  3.09it/s][A
Iteration:  35%|███▍      | 27/78 [00:08<00:16,  3.09it/s][A[INFO|trainer.py:570] 2024-04-28 19:11:10,992 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:11:10 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:11:10 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:11:10 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:11:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.72it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.64it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.20it/s]04/28/2024 19:11:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:11:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.9848695, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1142, 1192, 1191, 994, 1104, 899, 1498, 563, 639, 975, 458, 355], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51416244, 'remaining_params': 33601356, 'pruned_model_sparsity': 0.6047717649051491, 'expected_sparsity': 0.60101, 'target_sparsity': 0.6, 'step': 7750}


Iteration:  36%|███▌      | 28/78 [00:09<00:25,  1.97it/s][A
Iteration:  37%|███▋      | 29/78 [00:10<00:22,  2.21it/s][A
Iteration:  38%|███▊      | 30/78 [00:10<00:19,  2.43it/s][A
Iteration:  40%|███▉      | 31/78 [00:10<00:18,  2.59it/s][A
Iteration:  41%|████      | 32/78 [00:10<00:16,  2.73it/s][A
Iteration:  42%|████▏     | 33/78 [00:11<00:15,  2.83it/s][A
Iteration:  44%|████▎     | 34/78 [00:11<00:15,  2.91it/s][A
Iteration:  45%|████▍     | 35/78 [00:11<00:14,  2.95it/s][A
Iteration:  46%|████▌     | 36/78 [00:12<00:14,  2.99it/s][A
Iteration:  47%|████▋     | 37/78 [00:12<00:13,  3.02it/s][A
Iteration:  49%|████▊     | 38/78 [00:12<00:13,  3.04it/s][A
Iteration:  50%|█████     | 39/78 [00:13<00:12,  3.05it/s][A
Iteration:  51%|█████▏    | 40/78 [00:13<00:12,  3.06it/s][A
Iteration:  53%|█████▎    | 41/78 [00:13<00:12,  3.06it/s][A
Iteration:  54%|█████▍    | 42/78 [00:14<00:11,  3.07it/s][A
Iteration:  55%|█████▌    | 43/78 [00:14<00:11,  3.07it/s][A
Iteration:  56%|█████▋    | 44/78 [00:14<00:11,  3.08it/s][A
Iteration:  58%|█████▊    | 45/78 [00:15<00:10,  3.08it/s][A
Iteration:  59%|█████▉    | 46/78 [00:15<00:10,  3.09it/s][A
Iteration:  60%|██████    | 47/78 [00:15<00:10,  3.08it/s][A
Iteration:  62%|██████▏   | 48/78 [00:16<00:09,  3.08it/s][A
Iteration:  63%|██████▎   | 49/78 [00:16<00:09,  3.08it/s][A
Iteration:  64%|██████▍   | 50/78 [00:16<00:09,  3.08it/s][A
Iteration:  65%|██████▌   | 51/78 [00:17<00:08,  3.09it/s][A
Iteration:  67%|██████▋   | 52/78 [00:17<00:08,  3.09it/s][A
Iteration:  68%|██████▊   | 53/78 [00:17<00:08,  3.09it/s][A
Iteration:  69%|██████▉   | 54/78 [00:18<00:07,  3.08it/s][A
Iteration:  71%|███████   | 55/78 [00:18<00:07,  3.08it/s][A
Iteration:  72%|███████▏  | 56/78 [00:18<00:07,  3.09it/s][A
Iteration:  73%|███████▎  | 57/78 [00:19<00:06,  3.08it/s][A
Iteration:  74%|███████▍  | 58/78 [00:19<00:06,  3.08it/s][A
Iteration:  76%|███████▌  | 59/78 [00:19<00:06,  3.09it/s][A
Iteration:  77%|███████▋  | 60/78 [00:20<00:05,  3.08it/s][A
Iteration:  78%|███████▊  | 61/78 [00:20<00:05,  3.08it/s][A
Iteration:  79%|███████▉  | 62/78 [00:20<00:05,  3.08it/s][A
Iteration:  81%|████████  | 63/78 [00:21<00:04,  3.08it/s][A
Iteration:  82%|████████▏ | 64/78 [00:21<00:04,  3.09it/s][A
Iteration:  83%|████████▎ | 65/78 [00:21<00:04,  3.09it/s][A
Iteration:  85%|████████▍ | 66/78 [00:22<00:03,  3.08it/s][A
Iteration:  86%|████████▌ | 67/78 [00:22<00:03,  3.08it/s][A
Iteration:  87%|████████▋ | 68/78 [00:22<00:03,  3.07it/s][A
Iteration:  88%|████████▊ | 69/78 [00:22<00:02,  3.08it/s][A
Iteration:  90%|████████▉ | 70/78 [00:23<00:02,  3.08it/s][A
Iteration:  91%|█████████ | 71/78 [00:23<00:02,  3.08it/s][A
Iteration:  92%|█████████▏| 72/78 [00:23<00:01,  3.08it/s][A
Iteration:  94%|█████████▎| 73/78 [00:24<00:01,  3.07it/s][A
Iteration:  95%|█████████▍| 74/78 [00:24<00:01,  3.09it/s][A
Iteration:  96%|█████████▌| 75/78 [00:24<00:00,  3.09it/s][A
Iteration:  97%|█████████▋| 76/78 [00:25<00:00,  3.09it/s][A
Iteration:  99%|█████████▊| 77/78 [00:25<00:00,  3.10it/s][A[INFO|trainer.py:570] 2024-04-28 19:11:27,757 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/28/2024 19:11:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/28/2024 19:11:27 - INFO - trainer.trainer_mod_2 -   Num examples = 277
04/28/2024 19:11:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/9 [00:00<?, ?it/s][A[A04/28/2024 19:11:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  22%|██▏       | 2/9 [00:00<00:00, 15.75it/s][A[A

Evaluation:  44%|████▍     | 4/9 [00:00<00:00, 15.66it/s][A[A

Evaluation:  67%|██████▋   | 6/9 [00:00<00:00, 15.63it/s][A[A

Evaluation:  89%|████████▉ | 8/9 [00:00<00:00, 15.62it/s][A[AEvaluation: 100%|██████████| 9/9 [00:00<00:00, 16.19it/s]04/28/2024 19:11:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/rte/default_experiment-1-0.arrow
04/28/2024 19:11:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'accuracy': 0.6642599277978339, 'eval_loss': 0.98078936, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1153, 1201, 1203, 1003, 1113, 906, 1504, 569, 640, 979, 461, 358], 'head_nums': [12, 10, 11, 10, 12, 10, 10, 7, 9, 8, 8, 9], 'pruned_params': 51319728, 'remaining_params': 33697872, 'pruned_model_sparsity': 0.6036365176151761, 'expected_sparsity': 0.59904, 'target_sparsity': 0.6, 'step': 7800}


Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.02it/s][A04/28/2024 19:11:28 - INFO - trainer.trainer_mod_2 - Epoch 99 finished. Took 26.47 seconds.
Iteration: 100%|██████████| 78/78 [00:26<00:00,  2.95it/s]
Epoch: 100%|██████████| 100/100 [43:49<00:00, 26.29s/it]Epoch: 100%|██████████| 100/100 [43:49<00:00, 26.29s/it]
[INFO|configuration_utils.py:439] 2024-04-28 19:11:28,381 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/config.json
[INFO|modeling_utils.py:1084] 2024-04-28 19:11:31,270 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-04-28 19:11:31,271 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-04-28 19:11:31,272 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/RTE/CoFi_mod_2/RTE_sparsity0.6/special_tokens_map.json
04/28/2024 19:11:31 - INFO - __main__ - Training took 2641.75 seconds.
