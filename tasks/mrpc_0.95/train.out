Sat Mar 23 21:21:08 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/mrpc_0.95
nvidia-smi output:
Sat Mar 23 21:21:08 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:65:00.0 Off |                    0 |
| N/A   36C    P0              34W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
03/23/2024 21:21:12 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
03/23/2024 21:21:12 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95/runs/Mar23_21-21-12_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
03/23/2024 21:21:12 - INFO - __main__ - Model Arguments:
03/23/2024 21:21:12 - INFO - __main__ - model_name_or_path = bert-base-uncased
03/23/2024 21:21:12 - INFO - __main__ - config_name = None
03/23/2024 21:21:12 - INFO - __main__ - tokenizer_name = None
03/23/2024 21:21:12 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
03/23/2024 21:21:12 - INFO - __main__ - use_fast_tokenizer = True
03/23/2024 21:21:12 - INFO - __main__ - model_revision = main
03/23/2024 21:21:12 - INFO - __main__ - use_auth_token = False
03/23/2024 21:21:12 - INFO - __main__ - Data Arguments:
03/23/2024 21:21:12 - INFO - __main__ - task_name = mrpc
03/23/2024 21:21:12 - INFO - __main__ - dataset_name = None
03/23/2024 21:21:12 - INFO - __main__ - t_name = None
03/23/2024 21:21:12 - INFO - __main__ - dataset_config_name = None
03/23/2024 21:21:12 - INFO - __main__ - max_seq_length = 128
03/23/2024 21:21:12 - INFO - __main__ - overwrite_cache = False
03/23/2024 21:21:12 - INFO - __main__ - pad_to_max_length = True
03/23/2024 21:21:12 - INFO - __main__ - max_train_samples = None
03/23/2024 21:21:12 - INFO - __main__ - max_eval_samples = None
03/23/2024 21:21:12 - INFO - __main__ - max_predict_samples = None
03/23/2024 21:21:12 - INFO - __main__ - train_file = None
03/23/2024 21:21:12 - INFO - __main__ - validation_file = None
03/23/2024 21:21:12 - INFO - __main__ - test_file = None
03/23/2024 21:21:12 - INFO - __main__ - Training Arguments:
03/23/2024 21:21:12 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95
03/23/2024 21:21:12 - INFO - __main__ - overwrite_output_dir = True
03/23/2024 21:21:12 - INFO - __main__ - do_train = True
03/23/2024 21:21:12 - INFO - __main__ - do_eval = True
03/23/2024 21:21:12 - INFO - __main__ - do_predict = False
03/23/2024 21:21:12 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
03/23/2024 21:21:12 - INFO - __main__ - prediction_loss_only = False
03/23/2024 21:21:12 - INFO - __main__ - per_device_train_batch_size = 32
03/23/2024 21:21:12 - INFO - __main__ - per_device_eval_batch_size = 32
03/23/2024 21:21:12 - INFO - __main__ - per_gpu_train_batch_size = None
03/23/2024 21:21:12 - INFO - __main__ - per_gpu_eval_batch_size = None
03/23/2024 21:21:12 - INFO - __main__ - gradient_accumulation_steps = 1
03/23/2024 21:21:12 - INFO - __main__ - eval_accumulation_steps = None
03/23/2024 21:21:12 - INFO - __main__ - learning_rate = 2e-05
03/23/2024 21:21:12 - INFO - __main__ - weight_decay = 0.0
03/23/2024 21:21:12 - INFO - __main__ - adam_beta1 = 0.9
03/23/2024 21:21:12 - INFO - __main__ - adam_beta2 = 0.999
03/23/2024 21:21:12 - INFO - __main__ - adam_epsilon = 1e-08
03/23/2024 21:21:12 - INFO - __main__ - max_grad_norm = 1.0
03/23/2024 21:21:12 - INFO - __main__ - num_train_epochs = 100.0
03/23/2024 21:21:12 - INFO - __main__ - max_steps = -1
03/23/2024 21:21:12 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
03/23/2024 21:21:12 - INFO - __main__ - warmup_ratio = 0.0
03/23/2024 21:21:12 - INFO - __main__ - warmup_steps = 0
03/23/2024 21:21:12 - INFO - __main__ - log_level = -1
03/23/2024 21:21:12 - INFO - __main__ - log_level_replica = -1
03/23/2024 21:21:12 - INFO - __main__ - log_on_each_node = True
03/23/2024 21:21:12 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95/runs/Mar23_21-21-12_adroit-h11g2
03/23/2024 21:21:12 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
03/23/2024 21:21:12 - INFO - __main__ - logging_first_step = False
03/23/2024 21:21:12 - INFO - __main__ - logging_steps = 100
03/23/2024 21:21:12 - INFO - __main__ - logging_nan_inf_filter = True
03/23/2024 21:21:12 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
03/23/2024 21:21:12 - INFO - __main__ - save_steps = 0
03/23/2024 21:21:12 - INFO - __main__ - save_total_limit = None
03/23/2024 21:21:12 - INFO - __main__ - save_on_each_node = False
03/23/2024 21:21:12 - INFO - __main__ - no_cuda = False
03/23/2024 21:21:12 - INFO - __main__ - seed = 57
03/23/2024 21:21:12 - INFO - __main__ - bf16 = False
03/23/2024 21:21:12 - INFO - __main__ - fp16 = False
03/23/2024 21:21:12 - INFO - __main__ - fp16_opt_level = O1
03/23/2024 21:21:12 - INFO - __main__ - half_precision_backend = auto
03/23/2024 21:21:12 - INFO - __main__ - bf16_full_eval = False
03/23/2024 21:21:12 - INFO - __main__ - fp16_full_eval = False
03/23/2024 21:21:12 - INFO - __main__ - tf32 = None
03/23/2024 21:21:12 - INFO - __main__ - local_rank = -1
03/23/2024 21:21:12 - INFO - __main__ - xpu_backend = None
03/23/2024 21:21:12 - INFO - __main__ - tpu_num_cores = None
03/23/2024 21:21:12 - INFO - __main__ - tpu_metrics_debug = False
03/23/2024 21:21:12 - INFO - __main__ - debug = []
03/23/2024 21:21:12 - INFO - __main__ - dataloader_drop_last = False
03/23/2024 21:21:12 - INFO - __main__ - eval_steps = 50
03/23/2024 21:21:12 - INFO - __main__ - dataloader_num_workers = 0
03/23/2024 21:21:12 - INFO - __main__ - past_index = -1
03/23/2024 21:21:12 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95
03/23/2024 21:21:12 - INFO - __main__ - disable_tqdm = False
03/23/2024 21:21:12 - INFO - __main__ - remove_unused_columns = True
03/23/2024 21:21:12 - INFO - __main__ - label_names = None
03/23/2024 21:21:12 - INFO - __main__ - load_best_model_at_end = False
03/23/2024 21:21:12 - INFO - __main__ - metric_for_best_model = None
03/23/2024 21:21:12 - INFO - __main__ - greater_is_better = None
03/23/2024 21:21:12 - INFO - __main__ - ignore_data_skip = False
03/23/2024 21:21:12 - INFO - __main__ - sharded_ddp = []
03/23/2024 21:21:12 - INFO - __main__ - deepspeed = None
03/23/2024 21:21:12 - INFO - __main__ - label_smoothing_factor = 0.0
03/23/2024 21:21:12 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
03/23/2024 21:21:12 - INFO - __main__ - adafactor = False
03/23/2024 21:21:12 - INFO - __main__ - group_by_length = False
03/23/2024 21:21:12 - INFO - __main__ - length_column_name = length
03/23/2024 21:21:12 - INFO - __main__ - report_to = []
03/23/2024 21:21:12 - INFO - __main__ - ddp_find_unused_parameters = None
03/23/2024 21:21:12 - INFO - __main__ - ddp_bucket_cap_mb = None
03/23/2024 21:21:12 - INFO - __main__ - dataloader_pin_memory = True
03/23/2024 21:21:12 - INFO - __main__ - skip_memory_metrics = True
03/23/2024 21:21:12 - INFO - __main__ - use_legacy_prediction_loop = False
03/23/2024 21:21:12 - INFO - __main__ - push_to_hub = False
03/23/2024 21:21:12 - INFO - __main__ - resume_from_checkpoint = None
03/23/2024 21:21:12 - INFO - __main__ - hub_model_id = None
03/23/2024 21:21:12 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
03/23/2024 21:21:12 - INFO - __main__ - hub_token = None
03/23/2024 21:21:12 - INFO - __main__ - gradient_checkpointing = False
03/23/2024 21:21:12 - INFO - __main__ - fp16_backend = auto
03/23/2024 21:21:12 - INFO - __main__ - push_to_hub_model_id = None
03/23/2024 21:21:12 - INFO - __main__ - push_to_hub_organization = None
03/23/2024 21:21:12 - INFO - __main__ - push_to_hub_token = None
03/23/2024 21:21:12 - INFO - __main__ - mp_parameters = 
03/23/2024 21:21:12 - INFO - __main__ - _n_gpu = 1
03/23/2024 21:21:12 - INFO - __main__ - __cached__setup_devices = cuda:0
03/23/2024 21:21:12 - INFO - __main__ - Additional Arguments:
03/23/2024 21:21:12 - INFO - __main__ - test = False
03/23/2024 21:21:12 - INFO - __main__ - ex_name = MRPC_sparsity0.95
03/23/2024 21:21:12 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
03/23/2024 21:21:12 - INFO - __main__ - reg_learning_rate = 0.01
03/23/2024 21:21:12 - INFO - __main__ - scheduler_type = linear
03/23/2024 21:21:12 - INFO - __main__ - freeze_embeddings = True
03/23/2024 21:21:12 - INFO - __main__ - pretrained_pruned_model = None
03/23/2024 21:21:12 - INFO - __main__ - droprate_init = 0.5
03/23/2024 21:21:12 - INFO - __main__ - temperature = 0.6666666666666666
03/23/2024 21:21:12 - INFO - __main__ - prepruning_finetune_epochs = 4
03/23/2024 21:21:12 - INFO - __main__ - lagrangian_warmup_epochs = 20
03/23/2024 21:21:12 - INFO - __main__ - target_sparsity = 0.95
03/23/2024 21:21:12 - INFO - __main__ - sparsity_epsilon = 0
03/23/2024 21:21:12 - INFO - __main__ - distillation_path = Intel/bert-base-uncased-mrpc
03/23/2024 21:21:12 - INFO - __main__ - do_distill = True
03/23/2024 21:21:12 - INFO - __main__ - do_layer_distill = True
03/23/2024 21:21:12 - INFO - __main__ - layer_distill_version = 4
03/23/2024 21:21:12 - INFO - __main__ - distill_loss_alpha = 0.9
03/23/2024 21:21:12 - INFO - __main__ - distill_ce_loss_alpha = 0.1
03/23/2024 21:21:12 - INFO - __main__ - distill_temp = 2.0
03/23/2024 21:21:12 - INFO - datasets.builder - Overwrite dataset info from restored data version.
03/23/2024 21:21:12 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
03/23/2024 21:21:12 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
03/23/2024 21:21:12 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 762.92it/s]
[INFO|configuration_utils.py:648] 2024-03-23 21:21:12,818 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 21:21:12,819 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "mrpc",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-03-23 21:21:12,820 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 21:21:12,820 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-03-23 21:21:12,823 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-03-23 21:21:12,823 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-03-23 21:21:12,823 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-03-23 21:21:12,823 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-03-23 21:21:12,826 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-03-23 21:21:12,826 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
03/23/2024 21:21:21 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
03/23/2024 21:21:21 - INFO - __main__ - Model size: 85054464
03/23/2024 21:21:21 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14f4f93c2e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
03/23/2024 21:21:21 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
03/23/2024 21:21:21 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14f4f93c2f70> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 21:21:21 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
03/23/2024 21:21:21 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14f4f93c2e50> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
03/23/2024 21:21:21 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/mrpc/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
03/23/2024 21:21:21 - INFO - __main__ - Sample 2105 of the training set: {'sentence1': 'The Communicator can also consolidate e-mail from multiple screen names and other POP and IMAP accounts into a single application .', 'sentence2': 'AOL Communicator can consolidate e-mail from multiple AOL screen names , as well as from other POP and IMAP-based e-mail accounts .', 'label': 1, 'idx': 2338, 'input_ids': [101, 1996, 4012, 23041, 5555, 4263, 2064, 2036, 24939, 1041, 1011, 5653, 2013, 3674, 3898, 3415, 1998, 2060, 3769, 1998, 10047, 9331, 6115, 2046, 1037, 2309, 4646, 1012, 102, 20118, 2140, 4012, 23041, 5555, 4263, 2064, 24939, 1041, 1011, 5653, 2013, 3674, 20118, 2140, 3898, 3415, 1010, 2004, 2092, 2004, 2013, 2060, 3769, 1998, 10047, 9331, 1011, 2241, 1041, 1011, 5653, 6115, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 21:21:21 - INFO - __main__ - Sample 1315 of the training set: {'sentence1': 'The dollar gained against the euro , yen and Swiss franc after September U.S. retail sales figures came in slightly weaker than consensus forecasts .', 'sentence2': 'The greenback rose steeply against the euro , yen and Swiss franc despite weaker-than-expected September U.S. retail sales figures .', 'label': 1, 'idx': 1465, 'input_ids': [101, 1996, 7922, 4227, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2044, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 2234, 1999, 3621, 15863, 2084, 10465, 19939, 2015, 1012, 102, 1996, 2665, 5963, 3123, 9561, 2135, 2114, 1996, 9944, 1010, 18371, 1998, 5364, 23151, 2278, 2750, 15863, 1011, 2084, 1011, 3517, 2244, 1057, 1012, 1055, 1012, 7027, 4341, 4481, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 21:21:21 - INFO - __main__ - Sample 1955 of the training set: {'sentence1': "But he said he had Dr Hollingworth 's legal advice that he had been denied natural justice by the church inquiry .", 'sentence2': "Senator Brandis backed Dr Hollingworth 's claims he had been denied natural justice by the Anglican Church inquiry into the claims against him .", 'label': 0, 'idx': 2170, 'input_ids': [101, 2021, 2002, 2056, 2002, 2018, 2852, 7570, 13112, 5172, 1005, 1055, 3423, 6040, 2008, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 2277, 9934, 1012, 102, 5205, 4435, 2483, 6153, 2852, 7570, 13112, 5172, 1005, 1055, 4447, 2002, 2018, 2042, 6380, 3019, 3425, 2011, 1996, 9437, 2277, 9934, 2046, 1996, 4447, 2114, 2032, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
03/23/2024 21:21:21 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
03/23/2024 21:21:22 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
03/23/2024 21:21:22 - INFO - __main__ - ************* 3668 Training Examples Loaded *************
03/23/2024 21:21:22 - INFO - __main__ - ************* 408 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-03-23 21:21:22,322 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:21:22 - INFO - trainer.trainer - Prepruning finetune steps: 100
03/23/2024 21:21:22 - INFO - trainer.trainer - Lagrangian warmup steps: 2300
03/23/2024 21:21:22 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 21:21:22 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 21:21:22 - INFO - trainer.trainer - ***** Running training *****
03/23/2024 21:21:22 - INFO - trainer.trainer -   Num examples = 3668
03/23/2024 21:21:22 - INFO - trainer.trainer -   Num Epochs = 100
03/23/2024 21:21:22 - INFO - trainer.trainer -   Instantaneous batch size per device = 32
03/23/2024 21:21:22 - INFO - trainer.trainer -   Total train batch size (w. parallel, distributed & accumulation) = 32
03/23/2024 21:21:22 - INFO - trainer.trainer -   Gradient Accumulation steps = 1
03/23/2024 21:21:22 - INFO - trainer.trainer -   Total optimization steps = 11500
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-03-23 21:21:22,326 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:21:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:21:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:21:22 - INFO - trainer.trainer -   Batch size = 32

Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A
Evaluation:   8%|▊         | 1/13 [00:00<00:02,  6.00it/s][A
Evaluation:  23%|██▎       | 3/13 [00:00<00:01,  9.91it/s][A
Evaluation:  38%|███▊      | 5/13 [00:00<00:00, 12.68it/s][A
Evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 14.28it/s][A
Evaluation:  69%|██████▉   | 9/13 [00:00<00:00, 15.29it/s][A
Evaluation:  85%|████████▍ | 11/13 [00:00<00:00, 15.87it/s][A
Evaluation: 100%|██████████| 13/13 [00:00<00:00, 16.94it/s][AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 14.62it/s]03/23/2024 21:21:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:21:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.3161764705882353, 'f1': 0.0, 'combined_score': 0.15808823529411764, 'eval_loss': 0.7583998, 'step': 0}


Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:21:23 - INFO - trainer.trainer - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:27,  4.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:21,  5.20it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:20,  5.51it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:19,  5.60it/s][A
Iteration:   4%|▍         | 5/115 [00:00<00:19,  5.70it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:18,  5.88it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:17,  6.02it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:16,  6.30it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:16,  6.30it/s][A
Iteration:   9%|▊         | 10/115 [00:01<00:16,  6.19it/s][A
Iteration:  10%|▉         | 11/115 [00:01<00:16,  6.23it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:16,  6.12it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:16,  6.18it/s][A
Iteration:  12%|█▏        | 14/115 [00:02<00:15,  6.43it/s][A
Iteration:  13%|█▎        | 15/115 [00:02<00:16,  6.06it/s][A
Iteration:  14%|█▍        | 16/115 [00:02<00:17,  5.55it/s][A
Iteration:  15%|█▍        | 17/115 [00:02<00:16,  5.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:03<00:18,  5.22it/s][A
Iteration:  17%|█▋        | 19/115 [00:03<00:17,  5.52it/s][A
Iteration:  17%|█▋        | 20/115 [00:03<00:16,  5.76it/s][A
Iteration:  18%|█▊        | 21/115 [00:03<00:16,  5.79it/s][A
Iteration:  19%|█▉        | 22/115 [00:03<00:15,  6.11it/s][A
Iteration:  20%|██        | 23/115 [00:03<00:14,  6.16it/s][A
Iteration:  21%|██        | 24/115 [00:04<00:15,  5.91it/s][A
Iteration:  22%|██▏       | 25/115 [00:04<00:14,  6.02it/s][A
Iteration:  23%|██▎       | 26/115 [00:04<00:14,  6.00it/s][A
Iteration:  23%|██▎       | 27/115 [00:04<00:14,  5.99it/s][A
Iteration:  24%|██▍       | 28/115 [00:04<00:14,  6.13it/s][A
Iteration:  25%|██▌       | 29/115 [00:04<00:13,  6.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:05<00:13,  6.44it/s][A
Iteration:  27%|██▋       | 31/115 [00:05<00:12,  6.68it/s][A
Iteration:  28%|██▊       | 32/115 [00:05<00:12,  6.40it/s][A
Iteration:  29%|██▊       | 33/115 [00:05<00:12,  6.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:05<00:12,  6.39it/s][A
Iteration:  30%|███       | 35/115 [00:05<00:12,  6.18it/s][A
Iteration:  31%|███▏      | 36/115 [00:05<00:12,  6.39it/s][A
Iteration:  32%|███▏      | 37/115 [00:06<00:12,  6.25it/s][A
Iteration:  33%|███▎      | 38/115 [00:06<00:12,  6.12it/s][A
Iteration:  34%|███▍      | 39/115 [00:06<00:12,  6.21it/s][A
Iteration:  35%|███▍      | 40/115 [00:06<00:11,  6.28it/s][A
Iteration:  36%|███▌      | 41/115 [00:06<00:11,  6.50it/s][A
Iteration:  37%|███▋      | 42/115 [00:06<00:11,  6.45it/s][A
Iteration:  37%|███▋      | 43/115 [00:07<00:11,  6.40it/s][A
Iteration:  38%|███▊      | 44/115 [00:07<00:11,  6.41it/s][A
Iteration:  39%|███▉      | 45/115 [00:07<00:11,  6.36it/s][A
Iteration:  40%|████      | 46/115 [00:07<00:10,  6.35it/s][A
Iteration:  41%|████      | 47/115 [00:07<00:10,  6.18it/s][A
Iteration:  42%|████▏     | 48/115 [00:07<00:10,  6.26it/s][A
Iteration:  43%|████▎     | 49/115 [00:08<00:11,  6.00it/s][A[INFO|trainer.py:570] 2024-03-23 21:21:31,473 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:21:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:21:31 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:21:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 17.29it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 17.27it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 17.18it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 17.13it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 17.16it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 17.17it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 17.51it/s]03/23/2024 21:21:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:21:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7254901960784313, 'f1': 0.8303030303030303, 'combined_score': 0.7778966131907308, 'eval_loss': 0.5070065, 'step': 50}


Iteration:  43%|████▎     | 50/115 [00:08<00:25,  2.54it/s][A
Iteration:  44%|████▍     | 51/115 [00:09<00:20,  3.09it/s][A
Iteration:  45%|████▌     | 52/115 [00:09<00:16,  3.72it/s][A
Iteration:  46%|████▌     | 53/115 [00:09<00:14,  4.16it/s][A
Iteration:  47%|████▋     | 54/115 [00:09<00:13,  4.64it/s][A
Iteration:  48%|████▊     | 55/115 [00:09<00:12,  5.00it/s][A
Iteration:  49%|████▊     | 56/115 [00:09<00:11,  5.32it/s][A
Iteration:  50%|████▉     | 57/115 [00:10<00:10,  5.57it/s][A
Iteration:  50%|█████     | 58/115 [00:10<00:09,  5.72it/s][A
Iteration:  51%|█████▏    | 59/115 [00:10<00:10,  5.51it/s][A
Iteration:  52%|█████▏    | 60/115 [00:10<00:09,  5.74it/s][A
Iteration:  53%|█████▎    | 61/115 [00:10<00:09,  5.85it/s][A
Iteration:  54%|█████▍    | 62/115 [00:10<00:09,  5.53it/s][A
Iteration:  55%|█████▍    | 63/115 [00:11<00:09,  5.74it/s][A
Iteration:  56%|█████▌    | 64/115 [00:11<00:08,  5.92it/s][A
Iteration:  57%|█████▋    | 65/115 [00:11<00:08,  6.03it/s][A
Iteration:  57%|█████▋    | 66/115 [00:11<00:08,  6.11it/s][A
Iteration:  58%|█████▊    | 67/115 [00:11<00:07,  6.07it/s][A
Iteration:  59%|█████▉    | 68/115 [00:11<00:07,  6.12it/s][A
Iteration:  60%|██████    | 69/115 [00:12<00:07,  6.21it/s][A
Iteration:  61%|██████    | 70/115 [00:12<00:07,  6.12it/s][A
Iteration:  62%|██████▏   | 71/115 [00:12<00:07,  6.11it/s][A
Iteration:  63%|██████▎   | 72/115 [00:12<00:06,  6.20it/s][A
Iteration:  63%|██████▎   | 73/115 [00:12<00:06,  6.28it/s][A
Iteration:  64%|██████▍   | 74/115 [00:12<00:06,  6.32it/s][A
Iteration:  65%|██████▌   | 75/115 [00:13<00:06,  6.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:13<00:06,  6.21it/s][A
Iteration:  67%|██████▋   | 77/115 [00:13<00:06,  6.13it/s][A
Iteration:  68%|██████▊   | 78/115 [00:13<00:06,  6.16it/s][A
Iteration:  69%|██████▊   | 79/115 [00:13<00:05,  6.14it/s][A
Iteration:  70%|██████▉   | 80/115 [00:13<00:05,  6.12it/s][A
Iteration:  70%|███████   | 81/115 [00:14<00:05,  6.22it/s][A
Iteration:  71%|███████▏  | 82/115 [00:14<00:05,  6.21it/s][A
Iteration:  72%|███████▏  | 83/115 [00:14<00:05,  6.27it/s][A
Iteration:  73%|███████▎  | 84/115 [00:14<00:04,  6.21it/s][A
Iteration:  74%|███████▍  | 85/115 [00:14<00:04,  6.13it/s][A
Iteration:  75%|███████▍  | 86/115 [00:14<00:04,  6.03it/s][A
Iteration:  76%|███████▌  | 87/115 [00:15<00:04,  6.07it/s][A
Iteration:  77%|███████▋  | 88/115 [00:15<00:04,  6.33it/s][A
Iteration:  77%|███████▋  | 89/115 [00:15<00:04,  6.33it/s][A
Iteration:  78%|███████▊  | 90/115 [00:15<00:04,  6.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:15<00:03,  6.27it/s][A
Iteration:  80%|████████  | 92/115 [00:15<00:03,  6.33it/s][A
Iteration:  81%|████████  | 93/115 [00:15<00:03,  6.33it/s][A
Iteration:  82%|████████▏ | 94/115 [00:16<00:03,  6.36it/s][A
Iteration:  83%|████████▎ | 95/115 [00:16<00:03,  6.23it/s][A
Iteration:  83%|████████▎ | 96/115 [00:16<00:03,  6.30it/s][A
Iteration:  84%|████████▍ | 97/115 [00:16<00:02,  6.11it/s][A
Iteration:  85%|████████▌ | 98/115 [00:16<00:02,  6.06it/s][A
Iteration:  86%|████████▌ | 99/115 [00:16<00:02,  6.03it/s][A[INFO|trainer.py:570] 2024-03-23 21:21:40,359 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:21:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:21:40 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:21:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 17.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 17.17it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 17.16it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 17.17it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 17.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 17.05it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 17.43it/s]03/23/2024 21:21:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:21:41 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8357843137254902, 'f1': 0.8896210873146623, 'combined_score': 0.8627027005200762, 'eval_loss': 0.51207834, 'step': 100}


Iteration:  87%|████████▋ | 100/115 [00:17<00:05,  2.54it/s][A03/23/2024 21:21:41 - INFO - trainer.trainer - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
03/23/2024 21:21:41 - INFO - trainer.trainer - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
03/23/2024 21:21:41 - INFO - trainer.trainer - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
03/23/2024 21:21:41 - INFO - trainer.trainer - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
03/23/2024 21:21:41 - INFO - trainer.trainer - Starting l0 regularization!
03/23/2024 21:21:41 - INFO - trainer.trainer - v4 Global step: 100, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:18<00:05,  2.80it/s][A
Iteration:  89%|████████▊ | 102/115 [00:18<00:04,  2.98it/s][A
Iteration:  90%|████████▉ | 103/115 [00:18<00:03,  3.31it/s][A
Iteration:  90%|█████████ | 104/115 [00:18<00:03,  3.49it/s][A
Iteration:  91%|█████████▏| 105/115 [00:19<00:02,  3.62it/s][A
Iteration:  92%|█████████▏| 106/115 [00:19<00:02,  3.84it/s][A
Iteration:  93%|█████████▎| 107/115 [00:19<00:02,  3.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:19<00:01,  3.95it/s][A
Iteration:  95%|█████████▍| 109/115 [00:20<00:01,  4.03it/s][A
Iteration:  96%|█████████▌| 110/115 [00:20<00:01,  4.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:20<00:00,  4.08it/s][A
Iteration:  97%|█████████▋| 112/115 [00:20<00:00,  3.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:21<00:00,  3.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:21<00:00,  4.09it/s][A
Iteration: 100%|██████████| 115/115 [00:21<00:00,  4.35it/s][A03/23/2024 21:21:44 - INFO - trainer.trainer - Epoch 0 finished. Took 21.54 seconds.
Iteration: 100%|██████████| 115/115 [00:21<00:00,  5.34it/s]
Epoch:   1%|          | 1/100 [00:22<37:02, 22.45s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.45it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.47it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.06it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.21it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.18it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.11it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:26,  4.11it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:26,  4.00it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:26,  4.01it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:26,  3.99it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:25,  4.12it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  3.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:25,  3.99it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.05it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:24,  4.08it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.06it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:23,  4.02it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  3.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:23,  4.04it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.09it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:22,  4.12it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.13it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.21it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.21it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:21,  4.10it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.11it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.10it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.09it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.13it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.16it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.16it/s][A[INFO|trainer.py:570] 2024-03-23 21:21:53,296 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:21:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:21:53 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:21:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:21:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.75it/s]03/23/2024 21:21:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:21:54 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6838235294117647, 'f1': 0.8122270742358079, 'combined_score': 0.7480253018237863, 'eval_loss': 1.6212225, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2607, 2597, 2596, 2593, 2592, 2597, 2585, 2584, 2587, 2579, 2579, 2587], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9160620, 'remaining_params': 75856980, 'pruned_model_sparsity': 0.10774968947606142, 'expected_sparsity': 0.10928, 'target_sparsity': 0.020652173913043477, 'step': 150}


Iteration:  30%|███       | 35/115 [00:09<00:40,  1.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:33,  2.35it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:29,  2.68it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:25,  2.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:23,  3.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:21,  3.46it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:20,  3.63it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:19,  3.74it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:18,  3.85it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  3.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:17,  3.94it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.07it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.08it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.09it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:15,  4.14it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.22it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.18it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:14,  4.12it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.04it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.07it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  3.92it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:14,  4.01it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.08it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.12it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.21it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.20it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.19it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.12it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.13it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.16it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.18it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.19it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.12it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.21it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.13it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.23it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.22it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.20it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.12it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.13it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.14it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  3.95it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  3.86it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:08,  3.70it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:08,  3.80it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:06,417 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:06 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.55it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.50it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.75it/s]03/23/2024 21:22:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:07 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8659127625201937, 'combined_score': 0.8312406949855871, 'eval_loss': 0.4991803, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2642, 2630, 2627, 2616, 2617, 2628, 2609, 2606, 2612, 2606, 2613, 2638], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8607568, 'remaining_params': 76410032, 'pruned_model_sparsity': 0.10124454230653418, 'expected_sparsity': 0.10282, 'target_sparsity': 0.041304347826086954, 'step': 200}


Iteration:  74%|███████▍  | 85/115 [00:22<00:15,  1.90it/s][A03/23/2024 21:22:07 - INFO - trainer.trainer - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:22<00:12,  2.23it/s][A
Iteration:  76%|███████▌  | 87/115 [00:23<00:10,  2.60it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:09,  2.94it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:08,  3.23it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:07,  3.48it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:06,  3.68it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:06,  3.75it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  3.87it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  3.80it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:05,  3.84it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  3.85it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  3.96it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.05it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.05it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.15it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.25it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.24it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.15it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.16it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.10it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.07it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  4.12it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.08it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.03it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.06it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  4.11it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.14it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.14it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.42it/s][A03/23/2024 21:22:14 - INFO - trainer.trainer - Epoch 1 finished. Took 29.78 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.86it/s]
Epoch:   2%|▏         | 2/100 [00:52<43:42, 26.76s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.15it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.22it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.19it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.19it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.12it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:27,  3.92it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.00it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:27,  3.96it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:26,  3.96it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:26,  4.02it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.02it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:25,  4.08it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.12it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.14it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.17it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.26it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.13it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.21it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.12it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:19,452 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:19 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.43it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.73it/s]03/23/2024 21:22:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8339350180505415, 'combined_score': 0.8042224109860551, 'eval_loss': 0.5023599, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2674, 2660, 2657, 2643, 2644, 2661, 2636, 2632, 2642, 2642, 2657, 2696], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7994768, 'remaining_params': 77022832, 'pruned_model_sparsity': 0.09403662300511895, 'expected_sparsity': 0.0956, 'target_sparsity': 0.06195652173913043, 'step': 250}


Iteration:  17%|█▋        | 20/115 [00:05<00:48,  1.95it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:41,  2.28it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:35,  2.64it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:30,  3.01it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:27,  3.26it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:25,  3.48it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:25,  3.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:23,  3.74it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:22,  3.81it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:21,  3.92it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:21,  4.02it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:20,  4.07it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.12it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:18,  4.21it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:19,  4.15it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  4.02it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:18,  4.09it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.10it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.12it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.21it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.21it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.19it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.18it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  3.91it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:16,  4.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.13it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.08it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  4.11it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:15,  4.04it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.09it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.06it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  3.92it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:14,  3.95it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.01it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.09it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:12,  4.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.14it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.06it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.09it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:12,  4.05it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.07it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.02it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:32,559 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:32 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.76it/s]03/23/2024 21:22:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7573529411764706, 'f1': 0.8031809145129223, 'combined_score': 0.7802669278446964, 'eval_loss': 0.5202786, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2700, 2685, 2683, 2666, 2669, 2689, 2661, 2659, 2673, 2676, 2695, 2747], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7444780, 'remaining_params': 77572820, 'pruned_model_sparsity': 0.08756751543209877, 'expected_sparsity': 0.08915, 'target_sparsity': 0.08260869565217391, 'step': 300}


Iteration:  61%|██████    | 70/115 [00:18<00:23,  1.96it/s][A03/23/2024 21:22:33 - INFO - trainer.trainer - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:19<00:19,  2.31it/s][A
Iteration:  63%|██████▎   | 72/115 [00:19<00:16,  2.60it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:14,  2.96it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:12,  3.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:20<00:11,  3.43it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:10,  3.61it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:10,  3.77it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:09,  3.90it/s][A
Iteration:  69%|██████▊   | 79/115 [00:21<00:09,  3.99it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:08,  4.05it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  4.10it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:07,  4.21it/s][A
Iteration:  72%|███████▏  | 83/115 [00:22<00:07,  4.21it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:07,  4.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.11it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  4.06it/s][A
Iteration:  76%|███████▌  | 87/115 [00:23<00:06,  4.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  4.08it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.04it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.08it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.11it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.12it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.08it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  3.95it/s][A
Iteration:  83%|████████▎ | 95/115 [00:25<00:05,  3.94it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.01it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.03it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.08it/s][A
Iteration:  86%|████████▌ | 99/115 [00:26<00:04,  3.97it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.10it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.13it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.05it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.11it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.19it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.11it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  4.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.15it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.17it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.16it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  4.18it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.27it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.32it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.55it/s][A03/23/2024 21:22:44 - INFO - trainer.trainer - Epoch 2 finished. Took 29.76 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.86it/s]
Epoch:   3%|▎         | 3/100 [01:21<45:28, 28.13s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.48it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.33it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.27it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.24it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:45,523 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:45 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.43it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.74it/s]03/23/2024 21:22:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7622549019607843, 'f1': 0.8116504854368932, 'combined_score': 0.7869526936988387, 'eval_loss': 0.49710152, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2721, 2706, 2704, 2687, 2691, 2714, 2683, 2679, 2700, 2707, 2731, 2789], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6971392, 'remaining_params': 78046208, 'pruned_model_sparsity': 0.0819993977717555, 'expected_sparsity': 0.08356, 'target_sparsity': 0.10326086956521738, 'step': 350}


Iteration:   4%|▍         | 5/115 [00:02<01:02,  1.77it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:49,  2.22it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:41,  2.63it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.93it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:32,  3.28it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:30,  3.47it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:28,  3.65it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:27,  3.77it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  3.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:24,  4.08it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:24,  4.13it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:23,  4.16it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.16it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:23,  4.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:24,  3.98it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:24,  3.93it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  3.95it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:23,  4.02it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.13it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.14it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:22,  4.08it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:21,  4.10it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.06it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.19it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.15it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.17it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.09it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.13it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.20it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:19,  4.21it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:19,  4.04it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  4.01it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:19,  4.03it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.05it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  3.91it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:18,  3.92it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.00it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.06it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:17,  4.09it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.11it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.12it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.13it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.09it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:15,  4.19it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:16,  3.99it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.02it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  4.09it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:15,  4.05it/s][A[INFO|trainer.py:570] 2024-03-23 21:22:58,626 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:22:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:22:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:22:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:22:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.41it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.74it/s]03/23/2024 21:22:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:22:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8317214700193424, 'combined_score': 0.8092430879508477, 'eval_loss': 0.46928087, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2740, 2725, 2724, 2705, 2710, 2734, 2700, 2697, 2721, 2730, 2757, 2820], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6586860, 'remaining_params': 78430740, 'pruned_model_sparsity': 0.07747642841011744, 'expected_sparsity': 0.07908, 'target_sparsity': 0.12391304347826086, 'step': 400}


Iteration:  48%|████▊     | 55/115 [00:15<00:31,  1.92it/s][A03/23/2024 21:22:59 - INFO - trainer.trainer - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:15<00:25,  2.31it/s][A
Iteration:  50%|████▉     | 57/115 [00:15<00:21,  2.65it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:19,  2.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:16<00:17,  3.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:16<00:15,  3.50it/s][A
Iteration:  53%|█████▎    | 61/115 [00:16<00:14,  3.68it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:14,  3.75it/s][A
Iteration:  55%|█████▍    | 63/115 [00:17<00:13,  3.86it/s][A
Iteration:  56%|█████▌    | 64/115 [00:17<00:12,  4.01it/s][A
Iteration:  57%|█████▋    | 65/115 [00:17<00:12,  4.00it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:12,  3.96it/s][A
Iteration:  58%|█████▊    | 67/115 [00:18<00:11,  4.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:18<00:11,  4.02it/s][A
Iteration:  60%|██████    | 69/115 [00:18<00:11,  4.06it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:11,  4.03it/s][A
Iteration:  62%|██████▏   | 71/115 [00:19<00:10,  4.07it/s][A
Iteration:  63%|██████▎   | 72/115 [00:19<00:10,  4.05it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:10,  3.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:10,  4.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:20<00:10,  4.00it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:10,  3.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:09,  3.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:09,  4.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:21<00:08,  4.08it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:08,  4.19it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  4.09it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:07,  4.17it/s][A
Iteration:  72%|███████▏  | 83/115 [00:22<00:07,  4.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:07,  4.12it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.10it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  4.12it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  4.16it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.08it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.12it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.19it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.18it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.19it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.18it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.19it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.15it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.03it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.02it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.09it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.06it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.06it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.06it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.02it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.09it/s][A[INFO|trainer.py:570] 2024-03-23 21:23:11,708 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:23:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:23:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:23:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:23:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.42it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.41it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.73it/s]03/23/2024 21:23:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:23:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8641571194762684, 'combined_score': 0.8303628734636244, 'eval_loss': 0.4957493, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2753, 2738, 2736, 2716, 2723, 2749, 2712, 2709, 2736, 2744, 2772, 2838], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6337144, 'remaining_params': 78680456, 'pruned_model_sparsity': 0.07453920129479072, 'expected_sparsity': 0.07611, 'target_sparsity': 0.14456521739130435, 'step': 450}


Iteration:  91%|█████████▏| 105/115 [00:28<00:05,  1.97it/s][A
Iteration:  92%|█████████▏| 106/115 [00:28<00:03,  2.33it/s][A
Iteration:  93%|█████████▎| 107/115 [00:28<00:03,  2.65it/s][A
Iteration:  94%|█████████▍| 108/115 [00:29<00:02,  2.96it/s][A
Iteration:  95%|█████████▍| 109/115 [00:29<00:01,  3.25it/s][A
Iteration:  96%|█████████▌| 110/115 [00:29<00:01,  3.48it/s][A
Iteration:  97%|█████████▋| 111/115 [00:29<00:01,  3.68it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  3.75it/s][A
Iteration:  98%|█████████▊| 113/115 [00:30<00:00,  3.78it/s][A
Iteration:  99%|█████████▉| 114/115 [00:30<00:00,  3.84it/s][A
Iteration: 100%|██████████| 115/115 [00:30<00:00,  4.16it/s][A03/23/2024 21:23:15 - INFO - trainer.trainer - Epoch 3 finished. Took 30.69 seconds.
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.75it/s]
Epoch:   4%|▍         | 4/100 [01:52<46:37, 29.14s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:28,  3.96it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.10it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.12it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.13it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:27,  4.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.12it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.15it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.23it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.24it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.31it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.19it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.20it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.20it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.11it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:24,  4.06it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.10it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.11it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.19it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.20it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.20it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.27it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.26it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.20it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.13it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.12it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:21,  4.08it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:20,  4.11it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.07it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.97it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.13it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.16it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.11it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.15it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.01it/s][A[INFO|trainer.py:570] 2024-03-23 21:23:24,693 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:23:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:23:24 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:23:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:23:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.42it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.43it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.75it/s]03/23/2024 21:23:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:23:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8647798742138365, 'combined_score': 0.8269977802441731, 'eval_loss': 0.7300774, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2760, 2746, 2746, 2724, 2731, 2758, 2718, 2715, 2743, 2747, 2776, 2845], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6209988, 'remaining_params': 78807612, 'pruned_model_sparsity': 0.07304355803974706, 'expected_sparsity': 0.07466, 'target_sparsity': 0.16521739130434782, 'step': 500}


Iteration:  35%|███▍      | 40/115 [00:10<00:38,  1.95it/s][A03/23/2024 21:23:25 - INFO - trainer.trainer - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:10<00:31,  2.31it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:27,  2.67it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:24,  2.90it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:22,  3.14it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:20,  3.39it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:19,  3.59it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:18,  3.66it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:18,  3.64it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:17,  3.77it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:16,  4.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:16,  3.97it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.11it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.15it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:14,  4.11it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.12it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.08it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  4.07it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.19it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.13it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.22it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.23it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.21it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.10it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.07it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.10it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  4.08it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.10it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.05it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:10,  4.04it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.09it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.08it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.12it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:09,  4.06it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.09it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.10it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.09it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.11it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.09it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.04it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  4.05it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.00it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.00it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  3.99it/s][A[INFO|trainer.py:570] 2024-03-23 21:23:37,828 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:23:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:23:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:23:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:23:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.52it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.26it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.31it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.59it/s]03/23/2024 21:23:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:23:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8762214983713356, 'combined_score': 0.844973494283707, 'eval_loss': 0.6979057, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2762, 2748, 2748, 2725, 2734, 2760, 2717, 2713, 2741, 2737, 2766, 2838], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6240628, 'remaining_params': 78776972, 'pruned_model_sparsity': 0.07340395400481782, 'expected_sparsity': 0.07507, 'target_sparsity': 0.1858695652173913, 'step': 550}


Iteration:  78%|███████▊  | 90/115 [00:23<00:12,  1.94it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:10,  2.30it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:08,  2.70it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:07,  2.94it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:06,  3.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:05,  3.51it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:05,  3.68it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  3.79it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  3.91it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.00it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.00it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  3.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  3.97it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.11it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.06it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.12it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.15it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  4.10it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  3.90it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  3.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.03it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  3.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.00it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  3.88it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.22it/s][A03/23/2024 21:23:44 - INFO - trainer.trainer - Epoch 4 finished. Took 29.81 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.86it/s]
Epoch:   5%|▌         | 5/100 [02:22<46:31, 29.38s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:28,  3.92it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:28,  3.94it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:28,  3.91it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:28,  3.91it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:27,  4.02it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:27,  3.88it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:26,  3.97it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:26,  4.03it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:26,  3.94it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:26,  3.95it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:26,  3.92it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  4.01it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.08it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.07it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  4.07it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:24,  4.07it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.12it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.13it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:23,  4.12it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  4.08it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.06it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.17it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.23it/s][A[INFO|trainer.py:570] 2024-03-23 21:23:51,028 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:23:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:23:51 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:23:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:23:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.59it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.43it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.40it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.38it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.41it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.40it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.71it/s]03/23/2024 21:23:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:23:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.890728476821192, 'combined_score': 0.8644818854694196, 'eval_loss': 0.5509762, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2758, 2743, 2747, 2720, 2730, 2757, 2706, 2700, 2727, 2706, 2732, 2808], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6478088, 'remaining_params': 78539512, 'pruned_model_sparsity': 0.07619702273411623, 'expected_sparsity': 0.07786, 'target_sparsity': 0.20652173913043476, 'step': 600}


Iteration:  22%|██▏       | 25/115 [00:07<00:46,  1.94it/s][A03/23/2024 21:23:51 - INFO - trainer.trainer - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:07<00:38,  2.31it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:33,  2.59it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:29,  2.93it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:26,  3.27it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:23,  3.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:22,  3.72it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:21,  3.80it/s][A
Iteration:  29%|██▊       | 33/115 [00:09<00:21,  3.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:20,  3.97it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:20,  3.88it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:19,  4.03it/s][A
Iteration:  32%|███▏      | 37/115 [00:10<00:19,  4.05it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:19,  3.99it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.06it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.12it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.13it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.14it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.17it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.13it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:17,  4.07it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.07it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.09it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.03it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.02it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:16,  4.02it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.08it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.03it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  3.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:15,  4.06it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:15,  3.87it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.04it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  4.09it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:13,  4.12it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.16it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.13it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.16it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:12,  4.18it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.19it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.12it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.06it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:11,  4.09it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.13it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.03it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.09it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:11,  3.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.06it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.03it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:10,  4.06it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:04,176 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:04 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.51it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.42it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.42it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.41it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.41it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.71it/s]03/23/2024 21:24:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:05 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8712241653418125, 'combined_score': 0.8363473767885533, 'eval_loss': 0.80144304, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2747, 2732, 2740, 2709, 2719, 2745, 2683, 2674, 2696, 2639, 2652, 2731], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7040332, 'remaining_params': 77977268, 'pruned_model_sparsity': 0.08281028869316472, 'expected_sparsity': 0.08453, 'target_sparsity': 0.22717391304347825, 'step': 650}


Iteration:  65%|██████▌   | 75/115 [00:20<00:20,  1.92it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:17,  2.29it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:14,  2.65it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:12,  2.98it/s][A
Iteration:  69%|██████▊   | 79/115 [00:21<00:11,  3.21it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:10,  3.45it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:09,  3.59it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:08,  3.74it/s][A
Iteration:  72%|███████▏  | 83/115 [00:22<00:08,  3.81it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:08,  3.87it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  3.92it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  3.93it/s][A
Iteration:  76%|███████▌  | 87/115 [00:23<00:07,  3.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  3.94it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  3.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  3.98it/s][A
Iteration:  79%|███████▉  | 91/115 [00:24<00:05,  4.05it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.09it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.13it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.17it/s][A
Iteration:  83%|████████▎ | 95/115 [00:25<00:04,  4.11it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.12it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.11it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:26<00:03,  4.22it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.23it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.23it/s][A
Iteration:  90%|████████▉ | 103/115 [00:27<00:02,  4.29it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.17it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.17it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.11it/s][A
Iteration:  93%|█████████▎| 107/115 [00:28<00:01,  4.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  4.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.07it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.04it/s][A
Iteration:  97%|█████████▋| 111/115 [00:29<00:00,  4.06it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  4.10it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.14it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.17it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.45it/s][A03/23/2024 21:24:14 - INFO - trainer.trainer - Epoch 5 finished. Took 29.91 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.85it/s]
Epoch:   6%|▌         | 6/100 [02:52<46:18, 29.56s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.46it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.28it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.08it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.06it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.20it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.11it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.15it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:26,  4.08it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:26,  4.03it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:17,166 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:17 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.50it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.44it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.43it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.44it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.40it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.72it/s]03/23/2024 21:24:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8112745098039216, 'f1': 0.8756058158319872, 'combined_score': 0.8434401628179544, 'eval_loss': 0.90470123, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2727, 2710, 2724, 2687, 2697, 2724, 2644, 2627, 2635, 2496, 2461, 2523], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8284316, 'remaining_params': 76733284, 'pruned_model_sparsity': 0.09744236487503764, 'expected_sparsity': 0.09928, 'target_sparsity': 0.24782608695652172, 'step': 700}


Iteration:   9%|▊         | 10/115 [00:03<00:54,  1.93it/s][A03/23/2024 21:24:18 - INFO - trainer.trainer - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:45,  2.27it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:39,  2.63it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:34,  2.92it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:31,  3.22it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:28,  3.51it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:27,  3.64it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:25,  3.78it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:24,  3.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:24,  4.00it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:23,  4.06it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  4.02it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:23,  4.01it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.08it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:22,  4.10it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:22,  4.06it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:21,  4.08it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.07it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:21,  4.04it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.10it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.11it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.14it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:21,  3.87it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:20,  3.97it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:20,  3.95it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:19,  4.08it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.13it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:18,  4.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.10it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  4.09it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.13it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.08it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.12it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.14it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.16it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.17it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.16it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.07it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:15,  4.12it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.22it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.13it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  4.08it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:14,  4.10it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.09it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.12it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  3.94it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:14,  4.00it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.08it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:30,282 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:30 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.62it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.44it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.43it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.41it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.42it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.40it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.72it/s]03/23/2024 21:24:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:31 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.869701726844584, 'combined_score': 0.8331351771477822, 'eval_loss': 1.1399372, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2695, 2676, 2699, 2655, 2665, 2690, 2585, 2551, 2524, 2207, 2063, 2074], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 10691088, 'remaining_params': 74326512, 'pruned_model_sparsity': 0.12575146793134598, 'expected_sparsity': 0.12779, 'target_sparsity': 0.26847826086956517, 'step': 750}


Iteration:  52%|█████▏    | 60/115 [00:16<00:28,  1.95it/s][A
Iteration:  53%|█████▎    | 61/115 [00:16<00:23,  2.32it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:19,  2.65it/s][A
Iteration:  55%|█████▍    | 63/115 [00:17<00:17,  2.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:17<00:15,  3.27it/s][A
Iteration:  57%|█████▋    | 65/115 [00:17<00:14,  3.55it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:13,  3.74it/s][A
Iteration:  58%|█████▊    | 67/115 [00:18<00:12,  3.73it/s][A
Iteration:  59%|█████▉    | 68/115 [00:18<00:12,  3.82it/s][A
Iteration:  60%|██████    | 69/115 [00:18<00:11,  3.88it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:11,  3.92it/s][A
Iteration:  62%|██████▏   | 71/115 [00:19<00:11,  3.75it/s][A
Iteration:  63%|██████▎   | 72/115 [00:19<00:11,  3.83it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:10,  3.90it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:10,  3.99it/s][A
Iteration:  65%|██████▌   | 75/115 [00:20<00:09,  4.05it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:09,  4.10it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:09,  4.12it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:08,  4.14it/s][A
Iteration:  69%|██████▊   | 79/115 [00:21<00:08,  4.16it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:08,  4.18it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  4.18it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:07,  4.15it/s][A
Iteration:  72%|███████▏  | 83/115 [00:22<00:07,  4.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:07,  4.11it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.14it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  4.00it/s][A
Iteration:  76%|███████▌  | 87/115 [00:23<00:06,  4.07it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  4.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.06it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.02it/s][A
Iteration:  79%|███████▉  | 91/115 [00:24<00:05,  4.09it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.04it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.05it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.10it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.20it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.16it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.16it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.12it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.14it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.16it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.18it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.05it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.17it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.19it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.12it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  4.20it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.21it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:43,339 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:43 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.53it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.77it/s]03/23/2024 21:24:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8810289389067525, 'combined_score': 0.8498281949435723, 'eval_loss': 0.85740155, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2646, 2627, 2662, 2608, 2619, 2643, 2498, 2431, 2341, 1788, 1543, 1498], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 14030848, 'remaining_params': 70986752, 'pruned_model_sparsity': 0.16503462812405903, 'expected_sparsity': 0.16764, 'target_sparsity': 0.2891304347826087, 'step': 800}


Iteration:  96%|█████████▌| 110/115 [00:29<00:02,  1.98it/s][A03/23/2024 21:24:44 - INFO - trainer.trainer - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:29<00:01,  2.33it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:01,  2.69it/s][A
Iteration:  98%|█████████▊| 113/115 [00:30<00:00,  3.01it/s][A
Iteration:  99%|█████████▉| 114/115 [00:30<00:00,  3.18it/s][A
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.60it/s][A03/23/2024 21:24:45 - INFO - trainer.trainer - Epoch 6 finished. Took 30.69 seconds.
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.75it/s]
Epoch:   7%|▋         | 7/100 [03:23<46:23, 29.93s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.17it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.06it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.11it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.14it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:27,  3.94it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:27,  4.02it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.09it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:27,  3.93it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:27,  3.86it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:26,  3.89it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:26,  3.97it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:25,  3.97it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  4.04it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.04it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.01it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:24,  4.05it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.13it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.15it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.16it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.17it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.25it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.21it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.20it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.21it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.23it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.19it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.04it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:20,  4.05it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.16it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.11it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.13it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.15it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.17it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:18,  4.13it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.17it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.18it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.19it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:17,  4.02it/s][A[INFO|trainer.py:570] 2024-03-23 21:24:56,367 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:24:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:24:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:24:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:24:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.42it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.74it/s]03/23/2024 21:24:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:24:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8931034482758621, 'combined_score': 0.8705713319810683, 'eval_loss': 0.68565935, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2579, 2559, 2612, 2546, 2558, 2579, 2379, 2264, 2100, 1377, 1107, 1033], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11], 'pruned_params': 17614196, 'remaining_params': 67403404, 'pruned_model_sparsity': 0.20718293623908463, 'expected_sparsity': 0.20976, 'target_sparsity': 0.30978260869565216, 'step': 850}


Iteration:  39%|███▉      | 45/115 [00:11<00:35,  1.97it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:29,  2.32it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:25,  2.67it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:22,  3.00it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:19,  3.32it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:18,  3.55it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:17,  3.76it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:16,  3.76it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  3.95it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:15,  4.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:15,  3.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.04it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  4.09it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.14it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.17it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.11it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:13,  3.94it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  3.96it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.02it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  3.97it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.00it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  3.96it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  3.95it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  4.03it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.00it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  3.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  3.98it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:10,  4.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.07it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.10it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.19it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.12it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.15it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.15it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.08it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.11it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.24it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.15it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  4.11it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.14it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  3.98it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:06,  3.97it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.05it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.01it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.01it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:05,  4.05it/s][A[INFO|trainer.py:570] 2024-03-23 21:25:09,483 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:25:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:25:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:25:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:25:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.56it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.49it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.44it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.45it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.44it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.75it/s]03/23/2024 21:25:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:25:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8930390492359932, 'combined_score': 0.8693136422650554, 'eval_loss': 0.6850633, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2488, 2469, 2550, 2467, 2480, 2495, 2232, 2066, 1861, 1054, 811, 742], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 10], 'pruned_params': 21036684, 'remaining_params': 63980916, 'pruned_model_sparsity': 0.2474391655374887, 'expected_sparsity': 0.24957, 'target_sparsity': 0.33043478260869563, 'step': 900}


Iteration:  83%|████████▎ | 95/115 [00:24<00:10,  1.96it/s][A03/23/2024 21:25:10 - INFO - trainer.trainer - v4 Global step: 900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:25<00:08,  2.31it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:06,  2.67it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:05,  3.00it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:04,  3.21it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:04,  3.46it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  3.66it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  3.80it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:03,  3.85it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  3.88it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.04it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.09it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.07it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  4.10it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.08it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.02it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.06it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  4.10it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.14it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.14it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.40it/s][A03/23/2024 21:25:15 - INFO - trainer.trainer - Epoch 7 finished. Took 29.76 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.86it/s]
Epoch:   8%|▊         | 8/100 [03:52<45:48, 29.88s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:28,  3.95it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.06it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.14it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.27it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.17it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.26it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.25it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.14it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.18it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.11it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:25,  4.06it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  4.03it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:25,  3.94it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.02it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:24,  4.00it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.12it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.11it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:23,  3.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  4.08it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.12it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.06it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:22,  4.12it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:22,  4.07it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.07it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.07it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:21,  4.08it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.17it/s][A[INFO|trainer.py:570] 2024-03-23 21:25:22,497 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:25:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:25:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:25:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:25:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.51it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.48it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.46it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.77it/s]03/23/2024 21:25:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:25:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8333333333333334, 'f1': 0.8859060402684563, 'combined_score': 0.8596196868008948, 'eval_loss': 0.7710623, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2380, 2365, 2472, 2372, 2388, 2396, 2065, 1855, 1634, 822, 618, 566], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 9], 'pruned_params': 24158900, 'remaining_params': 60858700, 'pruned_model_sparsity': 0.2841635143781993, 'expected_sparsity': 0.28561, 'target_sparsity': 0.3510869565217391, 'step': 950}


Iteration:  26%|██▌       | 30/115 [00:08<00:43,  1.97it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:35,  2.34it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:30,  2.70it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:27,  3.03it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:24,  3.25it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:23,  3.42it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:22,  3.59it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:20,  3.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:19,  3.91it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:19,  3.95it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:19,  3.94it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  3.90it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:18,  3.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.07it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.18it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.20it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.13it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.16it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.18it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.14it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:15,  4.15it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.09it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.13it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.16it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:14,  4.17it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.19it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:13,  4.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.25it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.16it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.11it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.11it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.00it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:13,  4.05it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.09it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.12it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.20it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.12it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.15it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.16it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.18it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.10it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.03it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.08it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:10,  3.93it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:10,  3.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  3.95it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.03it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:09,  4.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.11it/s][A[INFO|trainer.py:570] 2024-03-23 21:25:35,527 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:25:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:25:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:25:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:25:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.58it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.52it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.48it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.45it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.77it/s]03/23/2024 21:25:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:25:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8926174496644296, 'combined_score': 0.8678773522831952, 'eval_loss': 0.76108027, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2253, 2251, 2379, 2262, 2281, 2282, 1889, 1648, 1428, 660, 490, 458], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 12, 12, 11, 8], 'pruned_params': 26885860, 'remaining_params': 58131740, 'pruned_model_sparsity': 0.31623875526949713, 'expected_sparsity': 0.31887, 'target_sparsity': 0.3717391304347826, 'step': 1000}


Iteration:  70%|██████▉   | 80/115 [00:21<00:17,  1.98it/s][A03/23/2024 21:25:36 - INFO - trainer.trainer - v4 Global step: 1000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:21<00:14,  2.37it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:12,  2.71it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:10,  3.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:09,  3.34it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:08,  3.57it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  3.74it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:07,  3.67it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:07,  3.74it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  3.87it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  3.83it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:06,  3.95it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.02it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.07it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.03it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.08it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.08it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.03it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.15it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.07it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.08it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  3.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.07it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.18it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.20it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.18it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  4.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.11it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.07it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.10it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  3.94it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  3.94it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.00it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.25it/s][A03/23/2024 21:25:44 - INFO - trainer.trainer - Epoch 8 finished. Took 29.75 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.87it/s]
Epoch:   9%|▉         | 9/100 [04:22<45:15, 29.84s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:28,  4.05it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.14it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.18it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.10it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.08it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.13it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.23it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.21it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.27it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.17it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.25it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.17it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.16it/s][A[INFO|trainer.py:570] 2024-03-23 21:25:48,518 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:25:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:25:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:25:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:25:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.61it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.49it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.79it/s]03/23/2024 21:25:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:25:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.895973154362416, 'combined_score': 0.8720061850243452, 'eval_loss': 0.74657637, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2118, 2127, 2273, 2141, 2161, 2158, 1713, 1456, 1248, 549, 406, 389], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 10, 12, 12, 11, 8], 'pruned_params': 29640396, 'remaining_params': 55377204, 'pruned_model_sparsity': 0.34863835252935865, 'expected_sparsity': 0.35235, 'target_sparsity': 0.3923913043478261, 'step': 1050}


Iteration:  13%|█▎        | 15/115 [00:04<00:50,  1.98it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:42,  2.35it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:36,  2.72it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.35it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:26,  3.57it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:25,  3.74it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:24,  3.87it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:23,  3.95it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:22,  4.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.09it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:21,  4.13it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:21,  3.96it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:21,  4.03it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.09it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.18it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.12it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:20,  4.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.14it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:20,  3.98it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.85it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  3.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:19,  3.96it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:19,  3.97it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.05it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  4.08it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.11it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.05it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.17it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.17it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.11it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.13it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.19it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.26it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.21it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:14,  4.22it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  4.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.09it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.12it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.16it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.17it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.16it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.26it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.22it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.14it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.18it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  3.98it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:01,545 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:01 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.57it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.55it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.50it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.49it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.47it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.79it/s]03/23/2024 21:26:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8829431438127091, 'combined_score': 0.8556872581808643, 'eval_loss': 0.8420668, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1980, 2000, 2161, 2014, 2038, 2030, 1547, 1285, 1096, 479, 351, 344], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 11, 10, 8], 'pruned_params': 32394932, 'remaining_params': 52622668, 'pruned_model_sparsity': 0.3810379497892201, 'expected_sparsity': 0.38612, 'target_sparsity': 0.4130434782608695, 'step': 1100}


Iteration:  57%|█████▋    | 65/115 [00:17<00:25,  1.92it/s][A03/23/2024 21:26:02 - INFO - trainer.trainer - v4 Global step: 1100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:17<00:21,  2.30it/s][A
Iteration:  58%|█████▊    | 67/115 [00:18<00:18,  2.58it/s][A
Iteration:  59%|█████▉    | 68/115 [00:18<00:16,  2.87it/s][A
Iteration:  60%|██████    | 69/115 [00:18<00:14,  3.15it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:13,  3.40it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:12,  3.62it/s][A
Iteration:  63%|██████▎   | 72/115 [00:19<00:11,  3.78it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:10,  3.84it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:10,  4.01it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.14it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:09,  4.08it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:09,  4.08it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:08,  4.13it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.08it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:08,  4.18it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  4.10it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:08,  4.05it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:08,  4.00it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:07,  4.05it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.03it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  4.08it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.12it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  4.11it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.15it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.11it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.06it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.04it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.03it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  3.94it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.02it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.13it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.13it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.15it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.15it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.19it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.12it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.13it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.07it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.13it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.17it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  3.98it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.04it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.11it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.11it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.13it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:14,572 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:14 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.58it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.54it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.84it/s]03/23/2024 21:26:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:15 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8865619546247819, 'combined_score': 0.8636241145672929, 'eval_loss': 0.6373334, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1847, 1878, 2045, 1888, 1917, 1903, 1397, 1139, 971, 440, 313, 313], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 9, 7], 'pruned_params': 35609068, 'remaining_params': 49408532, 'pruned_model_sparsity': 0.418843486525143, 'expected_sparsity': 0.41636, 'target_sparsity': 0.433695652173913, 'step': 1150}


Iteration: 100%|██████████| 115/115 [00:30<00:00,  2.04it/s][A03/23/2024 21:26:15 - INFO - trainer.trainer - Epoch 9 finished. Took 30.52 seconds.
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.77it/s]
Epoch:  10%|█         | 10/100 [04:53<45:04, 30.05s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:29,  3.92it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:28,  3.97it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:28,  3.99it/s][A
Iteration:   3%|▎         | 4/115 [00:01<00:27,  3.98it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.13it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:27,  3.94it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:27,  3.95it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:26,  4.03it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.08it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.12it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.07it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.12it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  3.99it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.06it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.10it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.14it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.19it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.26it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.24it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.24it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.21it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:22,  4.10it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.17it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:22,  3.96it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:21,  4.04it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.16it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.10it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.12it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.14it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.15it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.24it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.23it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.24it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.21it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.06it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.11it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:18,  4.13it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.23it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.20it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:17,  4.05it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.15it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.19it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.10it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:16,  4.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:16,  4.12it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:27,582 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:27 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.56it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.55it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.53it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.52it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.83it/s]03/23/2024 21:26:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:28 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8855721393034827, 'combined_score': 0.8582272461223296, 'eval_loss': 0.805659, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1722, 1764, 1932, 1769, 1801, 1785, 1264, 1016, 868, 419, 286, 291], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 9, 6], 'pruned_params': 37510280, 'remaining_params': 47507320, 'pruned_model_sparsity': 0.4412060561577838, 'expected_sparsity': 0.44027, 'target_sparsity': 0.4543478260869565, 'step': 1200}


Iteration:  43%|████▎     | 50/115 [00:13<00:32,  1.98it/s][A03/23/2024 21:26:28 - INFO - trainer.trainer - v4 Global step: 1200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:13<00:27,  2.33it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:23,  2.69it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:20,  3.02it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:19,  3.19it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:18,  3.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:16,  3.55it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:15,  3.72it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:14,  3.84it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:14,  3.91it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:14,  3.84it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.06it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.08it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.06it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.12it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.13it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.08it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.03it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.05it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.04it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  4.05it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.08it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.07it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  3.90it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:10,  4.00it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.14it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.08it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.12it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.15it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.11it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.14it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.06it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.07it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.12it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.13it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  3.99it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.04it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.10it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.13it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:06,  4.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.14it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.10it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.12it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:05,  4.08it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.03it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.09it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.13it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.15it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.16it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:40,712 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:40 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.63it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.62it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.58it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.57it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.57it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.54it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.86it/s]03/23/2024 21:26:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:41 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8553921568627451, 'f1': 0.897391304347826, 'combined_score': 0.8763917306052855, 'eval_loss': 0.6763741, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1607, 1659, 1825, 1657, 1692, 1672, 1145, 909, 781, 407, 266, 274], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 8, 6], 'pruned_params': 39255228, 'remaining_params': 45762372, 'pruned_model_sparsity': 0.46173060636856367, 'expected_sparsity': 0.4614, 'target_sparsity': 0.475, 'step': 1250}


Iteration:  87%|████████▋ | 100/115 [00:26<00:07,  1.97it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:05,  2.35it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:04,  2.71it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:04,  3.00it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:03,  3.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  3.46it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  3.66it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:02,  3.74it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  3.84it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  3.91it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  3.90it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.00it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  4.13it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.12it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.12it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.44it/s][A03/23/2024 21:26:45 - INFO - trainer.trainer - Epoch 10 finished. Took 29.72 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.87it/s]
Epoch:  11%|█         | 11/100 [05:22<44:25, 29.95s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.11it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:29,  3.88it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:28,  3.94it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.04it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:28,  3.88it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:27,  4.00it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.07it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:26,  4.04it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.09it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.11it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:26,  3.94it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:26,  3.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  4.02it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:25,  3.96it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:25,  4.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:24,  4.07it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.12it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.06it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.12it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.15it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.09it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.21it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.19it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:22,  4.02it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.06it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.02it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:21,  4.03it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:21,  4.09it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.12it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.14it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.07it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.12it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.06it/s][A[INFO|trainer.py:570] 2024-03-23 21:26:53,779 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:26:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:26:53 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:26:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:26:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.77it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.62it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.59it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.58it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.52it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.87it/s]03/23/2024 21:26:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:26:54 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8934010152284263, 'combined_score': 0.869494625261272, 'eval_loss': 0.7418744, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1499, 1559, 1719, 1548, 1587, 1563, 1039, 817, 706, 399, 250, 261], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 8, 6], 'pruned_params': 40693776, 'remaining_params': 44323824, 'pruned_model_sparsity': 0.47865119692863595, 'expected_sparsity': 0.48169, 'target_sparsity': 0.49565217391304345, 'step': 1300}


Iteration:  30%|███       | 35/115 [00:09<00:40,  1.97it/s][A03/23/2024 21:26:54 - INFO - trainer.trainer - v4 Global step: 1300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:09<00:34,  2.31it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:29,  2.66it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:26,  2.95it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:23,  3.25it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:21,  3.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:20,  3.64it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:18,  3.86it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:18,  3.95it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  3.97it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:17,  3.98it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:17,  4.06it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.11it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.13it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.17it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:15,  4.18it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.19it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.21it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:14,  4.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:13,  4.24it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.23it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.22it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.22it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.03it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.02it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:13,  4.07it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.12it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.15it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.08it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.17it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:10,  4.28it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.18it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  4.01it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.16it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.04it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.11it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.05it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.06it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.04it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.16it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.19it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.16it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.12it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.11it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.12it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.09it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:06,728 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:06 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.63it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.59it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.58it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.56it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.55it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.87it/s]03/23/2024 21:27:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:07 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8949152542372881, 'combined_score': 0.8714772349617813, 'eval_loss': 0.7636598, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1399, 1464, 1619, 1444, 1488, 1462, 944, 738, 643, 394, 237, 251], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 10, 7, 5], 'pruned_params': 42401956, 'remaining_params': 42615644, 'pruned_model_sparsity': 0.49874327198133095, 'expected_sparsity': 0.50284, 'target_sparsity': 0.5163043478260869, 'step': 1350}


Iteration:  74%|███████▍  | 85/115 [00:22<00:15,  2.00it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:12,  2.37it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:10,  2.72it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:08,  3.02it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:08,  3.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:07,  3.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:06,  3.63it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  3.84it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  3.88it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.04it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.10it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.05it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.07it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.11it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.09it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.13it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.11it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.10it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.07it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.09it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.14it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.18it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.20it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.20it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.17it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.03it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.35it/s][A03/23/2024 21:27:14 - INFO - trainer.trainer - Epoch 11 finished. Took 29.65 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.88it/s]
Epoch:  12%|█▏        | 12/100 [05:52<43:47, 29.86s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.22it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.22it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.10it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:28,  3.91it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.07it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:27,  3.93it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:26,  4.00it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:26,  4.06it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.11it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.09it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.20it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.16it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.18it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.19it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.13it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.16it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.19it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:19,683 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:19 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.59it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.60it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.59it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.61it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.91it/s]03/23/2024 21:27:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8861209964412811, 'combined_score': 0.864629125671621, 'eval_loss': 0.7324217, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1310, 1378, 1526, 1350, 1397, 1369, 860, 671, 589, 389, 227, 242], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 9, 12, 9, 6, 5], 'pruned_params': 45150364, 'remaining_params': 39867236, 'pruned_model_sparsity': 0.5310707900481783, 'expected_sparsity': 0.5272, 'target_sparsity': 0.5369565217391303, 'step': 1400}


Iteration:  17%|█▋        | 20/115 [00:05<00:47,  1.98it/s][A03/23/2024 21:27:20 - INFO - trainer.trainer - v4 Global step: 1400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:40,  2.34it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:34,  2.70it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:30,  3.02it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:28,  3.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:26,  3.40it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:24,  3.62it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:23,  3.79it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:22,  3.91it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:21,  3.93it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:21,  4.01it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:21,  3.94it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.02it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.17it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.20it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:19,  4.07it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:19,  4.03it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  4.10it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:18,  4.12it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.15it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.15it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.25it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.21it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.22it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.13it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.15it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.07it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.12it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.08it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:15,  4.12it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.24it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:14,  4.23it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.24it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.12it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.05it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.10it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  4.10it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.13it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.10it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.11it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.15it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.11it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.09it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.06it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  3.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:12,  3.92it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  3.95it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.04it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:32,726 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:32 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.73it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.65it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.63it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.60it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.61it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.94it/s]03/23/2024 21:27:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8919382504288165, 'combined_score': 0.8687632428614671, 'eval_loss': 0.7746078, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1229, 1299, 1440, 1264, 1312, 1284, 788, 615, 545, 386, 219, 236], 'head_nums': [12, 12, 12, 12, 12, 12, 11, 8, 12, 7, 6, 4], 'pruned_params': 46988764, 'remaining_params': 38028836, 'pruned_model_sparsity': 0.552694547952424, 'expected_sparsity': 0.54992, 'target_sparsity': 0.557608695652174, 'step': 1450}


Iteration:  61%|██████    | 70/115 [00:18<00:22,  1.98it/s][A
Iteration:  62%|██████▏   | 71/115 [00:19<00:18,  2.34it/s][A
Iteration:  63%|██████▎   | 72/115 [00:19<00:16,  2.64it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:14,  2.92it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:12,  3.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:20<00:11,  3.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:10,  3.64it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:10,  3.78it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:09,  3.88it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:09,  3.97it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:08,  4.01it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  3.93it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:08,  3.97it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:07,  4.06it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.18it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:06,  4.15it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.06it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  4.09it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.10it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.11it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.07it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.06it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.16it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.17it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.27it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.24it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.15it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.10it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.11it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.11it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.15it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.09it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.14it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.25it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.32it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.07it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.10it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.14it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.15it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.45it/s][A03/23/2024 21:27:44 - INFO - trainer.trainer - Epoch 12 finished. Took 29.65 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.88it/s]
Epoch:  13%|█▎        | 13/100 [06:22<43:12, 29.80s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:28,  4.02it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:28,  3.99it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.08it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:45,697 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:45 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.65it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.62it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.63it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.94it/s]03/23/2024 21:27:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8900343642611684, 'combined_score': 0.8665858095815646, 'eval_loss': 0.7823281, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1156, 1225, 1357, 1185, 1234, 1206, 725, 567, 507, 382, 212, 231], 'head_nums': [12, 11, 12, 12, 12, 12, 11, 8, 12, 6, 6, 3], 'pruned_params': 48536084, 'remaining_params': 36481516, 'pruned_model_sparsity': 0.5708945441884974, 'expected_sparsity': 0.56713, 'target_sparsity': 0.5782608695652174, 'step': 1500}


Iteration:   4%|▍         | 5/115 [00:02<01:01,  1.79it/s][A03/23/2024 21:27:46 - INFO - trainer.trainer - v4 Global step: 1500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:49,  2.22it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:41,  2.63it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:36,  2.92it/s][A
Iteration:   8%|▊         | 9/115 [00:03<00:33,  3.18it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:31,  3.30it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:29,  3.54it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:27,  3.71it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:26,  3.80it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:25,  3.99it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:24,  4.07it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  4.03it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:24,  4.05it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:24,  4.03it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:23,  4.05it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:23,  4.05it/s][A
Iteration:  18%|█▊        | 21/115 [00:06<00:22,  4.17it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:21,  4.25it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.20it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.18it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:21,  4.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.21it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.22it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.24it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.22it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.16it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.18it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.18it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.17it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:18,  4.26it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.21it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.24it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:18,  4.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:17,  4.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.31it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.20it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.21it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.20it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.30it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.20it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.13it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  3.95it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.03it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.09it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.10it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.14it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.24it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.22it/s][A[INFO|trainer.py:570] 2024-03-23 21:27:58,603 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:27:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:27:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:27:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:27:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.73it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.64it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.65it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.98it/s]03/23/2024 21:27:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:27:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8912280701754387, 'combined_score': 0.8696336429308567, 'eval_loss': 0.7138566, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1089, 1157, 1281, 1112, 1162, 1133, 668, 526, 474, 379, 206, 226], 'head_nums': [12, 11, 12, 12, 12, 12, 11, 8, 12, 6, 6, 3], 'pruned_params': 49410856, 'remaining_params': 35606744, 'pruned_model_sparsity': 0.5811838489912677, 'expected_sparsity': 0.58198, 'target_sparsity': 0.5989130434782609, 'step': 1550}


Iteration:  48%|████▊     | 55/115 [00:14<00:30,  1.99it/s][A
Iteration:  49%|████▊     | 56/115 [00:15<00:24,  2.39it/s][A
Iteration:  50%|████▉     | 57/115 [00:15<00:20,  2.78it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:18,  3.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:16,  3.36it/s][A
Iteration:  52%|█████▏    | 60/115 [00:16<00:15,  3.58it/s][A
Iteration:  53%|█████▎    | 61/115 [00:16<00:14,  3.69it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:14,  3.78it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:13,  3.81it/s][A
Iteration:  56%|█████▌    | 64/115 [00:17<00:12,  3.99it/s][A
Iteration:  57%|█████▋    | 65/115 [00:17<00:12,  4.05it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:11,  4.10it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.14it/s][A
Iteration:  59%|█████▉    | 68/115 [00:18<00:11,  4.12it/s][A
Iteration:  60%|██████    | 69/115 [00:18<00:11,  4.10it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:10,  4.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.14it/s][A
Iteration:  63%|██████▎   | 72/115 [00:19<00:10,  4.25it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:09,  4.23it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:09,  4.12it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:10,  3.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:09,  4.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:09,  4.06it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:09,  4.06it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.13it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:08,  4.16it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  4.17it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:07,  4.19it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.20it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.15it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.24it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:06,  4.23it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.18it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.14it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.18it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:05,  4.19it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.14it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.06it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.12it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.15it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:05,  3.97it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.04it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  3.99it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.01it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:04,  3.98it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.11it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.09it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.07it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:03,  3.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  3.98it/s][A[INFO|trainer.py:570] 2024-03-23 21:28:11,571 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:28:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:28:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:28:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:28:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.97it/s]03/23/2024 21:28:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:28:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8284313725490197, 'f1': 0.8745519713261649, 'combined_score': 0.8514916719375922, 'eval_loss': 0.7889492, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [1029, 1093, 1211, 1046, 1097, 1069, 619, 490, 445, 376, 202, 223], 'head_nums': [12, 11, 12, 12, 12, 12, 10, 8, 12, 5, 6, 2], 'pruned_params': 50780464, 'remaining_params': 34237136, 'pruned_model_sparsity': 0.5972935486299308, 'expected_sparsity': 0.59615, 'target_sparsity': 0.6195652173913043, 'step': 1600}


Iteration:  91%|█████████▏| 105/115 [00:27<00:05,  1.99it/s][A03/23/2024 21:28:12 - INFO - trainer.trainer - v4 Global step: 1600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:28<00:03,  2.36it/s][A
Iteration:  93%|█████████▎| 107/115 [00:28<00:02,  2.72it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:02,  3.04it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  3.27it/s][A
Iteration:  96%|█████████▌| 110/115 [00:29<00:01,  3.51it/s][A
Iteration:  97%|█████████▋| 111/115 [00:29<00:01,  3.57it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  3.74it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  3.72it/s][A
Iteration:  99%|█████████▉| 114/115 [00:30<00:00,  3.80it/s][A
Iteration: 100%|██████████| 115/115 [00:30<00:00,  4.11it/s][A03/23/2024 21:28:14 - INFO - trainer.trainer - Epoch 13 finished. Took 30.39 seconds.
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.78it/s]
Epoch:  14%|█▍        | 14/100 [06:52<42:57, 29.98s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.26it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.13it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.18it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.12it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.26it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.25it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.19it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.20it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.11it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.14it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:25,  4.11it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.14it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.18it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.20it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:22,  4.29it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.28it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.03it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:23,  4.02it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  4.04it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.09it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.13it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:22,  4.02it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:22,  4.06it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.08it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.14it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.25it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.11it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.15it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.19it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.14it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.17it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.20it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.12it/s][A[INFO|trainer.py:570] 2024-03-23 21:28:24,516 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:28:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:28:24 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:28:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:28:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.71it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.63it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.97it/s]03/23/2024 21:28:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:28:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8455882352941176, 'f1': 0.8884955752212389, 'combined_score': 0.8670419052576783, 'eval_loss': 0.7972527, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [972, 1034, 1144, 983, 1035, 1006, 574, 458, 420, 372, 197, 219], 'head_nums': [12, 11, 12, 12, 12, 12, 9, 8, 12, 5, 6, 2], 'pruned_params': 51714984, 'remaining_params': 33302616, 'pruned_model_sparsity': 0.608285625564589, 'expected_sparsity': 0.60852, 'target_sparsity': 0.6402173913043477, 'step': 1650}


Iteration:  35%|███▍      | 40/115 [00:10<00:37,  1.99it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:30,  2.39it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:24,  2.96it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:22,  3.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:20,  3.41it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:19,  3.56it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:18,  3.69it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:17,  3.76it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  3.89it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:16,  3.98it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:16,  3.98it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:16,  3.90it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  3.94it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:15,  4.02it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.07it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.10it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  4.14it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.16it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.15it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.11it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  3.95it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:13,  4.03it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.06it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.00it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  3.97it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.03it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.07it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.10it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.10it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.11it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.16it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.24it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.17it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.17it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.16it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.17it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.04it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  3.90it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.00it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.07it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.05it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.09it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  3.96it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.01it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.06it/s][A[INFO|trainer.py:570] 2024-03-23 21:28:37,661 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:28:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:28:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:28:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:28:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.75it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.67it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.47it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.55it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.56it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.89it/s]03/23/2024 21:28:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:28:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8922558922558923, 'combined_score': 0.8676965735789266, 'eval_loss': 0.86011654, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [921, 979, 1081, 924, 976, 947, 534, 431, 397, 369, 193, 216], 'head_nums': [12, 11, 12, 12, 12, 11, 9, 8, 12, 4, 6, 2], 'pruned_params': 52785852, 'remaining_params': 32231748, 'pruned_model_sparsity': 0.6208814645438121, 'expected_sparsity': 0.6193, 'target_sparsity': 0.6608695652173913, 'step': 1700}


Iteration:  78%|███████▊  | 90/115 [00:23<00:12,  1.98it/s][A03/23/2024 21:28:38 - INFO - trainer.trainer - v4 Global step: 1700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:23<00:10,  2.32it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:08,  2.65it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:07,  2.99it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:06,  3.31it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:05,  3.53it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:05,  3.65it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  3.80it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  3.98it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.11it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.14it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.16it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.14it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.18it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.19it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.15it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.13it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.16it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.24it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.22it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.28it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.53it/s][A03/23/2024 21:28:44 - INFO - trainer.trainer - Epoch 14 finished. Took 29.57 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.89it/s]
Epoch:  15%|█▌        | 15/100 [07:22<42:17, 29.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.18it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.07it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.06it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.12it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.17it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.18it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.10it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:26,  4.06it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.08it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.11it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.09it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.13it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.12it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.16it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.18it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:24,  4.01it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.16it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.23it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.23it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.15it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.25it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.15it/s][A[INFO|trainer.py:570] 2024-03-23 21:28:50,479 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:28:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:28:50 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:28:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:28:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.67it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.98it/s]03/23/2024 21:28:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:28:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8578431372549019, 'f1': 0.9016949152542373, 'combined_score': 0.8797690262545697, 'eval_loss': 0.7749249, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [873, 927, 1021, 871, 923, 893, 498, 406, 377, 365, 190, 213], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 8, 12, 4, 6, 2], 'pruned_params': 53605472, 'remaining_params': 31412128, 'pruned_model_sparsity': 0.6305220566094549, 'expected_sparsity': 0.62958, 'target_sparsity': 0.6815217391304347, 'step': 1750}


Iteration:  22%|██▏       | 25/115 [00:06<00:45,  1.98it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:37,  2.35it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:32,  2.70it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:28,  3.03it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:26,  3.25it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:24,  3.49it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:23,  3.64it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:22,  3.77it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:21,  3.90it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:20,  3.91it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:20,  3.86it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.94it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  3.99it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:19,  4.00it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.06it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.10it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.12it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.12it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.13it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.23it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.18it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.11it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.15it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.18it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.27it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.22it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.19it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.21it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.21it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.18it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.20it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.20it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.20it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.11it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.05it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.07it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.04it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.03it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.16it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.19it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.11it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.22it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.30it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.26it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:03,401 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:03 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.77it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.67it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.64it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.65it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.97it/s]03/23/2024 21:29:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:04 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8861646234676007, 'combined_score': 0.8634254489887023, 'eval_loss': 0.78304094, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [827, 878, 964, 820, 871, 841, 465, 383, 359, 361, 187, 210], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 7, 12, 4, 6, 2], 'pruned_params': 54394452, 'remaining_params': 30623148, 'pruned_model_sparsity': 0.6398022527100271, 'expected_sparsity': 0.63896, 'target_sparsity': 0.7021739130434782, 'step': 1800}


Iteration:  65%|██████▌   | 75/115 [00:19<00:19,  2.00it/s][A03/23/2024 21:29:04 - INFO - trainer.trainer - v4 Global step: 1800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:20<00:16,  2.37it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:13,  2.72it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:12,  3.05it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:11,  3.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:10,  3.45it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:09,  3.65it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:08,  3.69it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:08,  3.84it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:07,  3.88it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  3.98it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  4.05it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.08it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  4.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.12it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.10it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.12it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  3.97it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  3.96it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.05it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.03it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.08it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.11it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.15it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.11it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.12it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.10it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.18it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.08it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.13it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.14it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.15it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.14it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  3.97it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.16it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  3.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  3.97it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.31it/s][A03/23/2024 21:29:14 - INFO - trainer.trainer - Epoch 15 finished. Took 29.58 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.89it/s]
Epoch:  16%|█▌        | 16/100 [07:51<41:40, 29.77s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.25it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:28,  3.89it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.02it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.08it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.13it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.17it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.26it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:16,436 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:16 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.79it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.71it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.65it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.97it/s]03/23/2024 21:29:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:17 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.891846921797005, 'combined_score': 0.8662665981534045, 'eval_loss': 0.8040395, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [785, 832, 910, 771, 822, 793, 436, 363, 342, 356, 184, 208], 'head_nums': [12, 11, 11, 12, 12, 11, 9, 7, 12, 4, 5, 2], 'pruned_params': 54944440, 'remaining_params': 30073160, 'pruned_model_sparsity': 0.6462713602830473, 'expected_sparsity': 0.64712, 'target_sparsity': 0.7228260869565217, 'step': 1850}


Iteration:   9%|▊         | 10/115 [00:03<00:53,  1.96it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:44,  2.34it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:38,  2.68it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.00it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:28,  3.51it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:27,  3.58it/s][A
Iteration:  15%|█▍        | 17/115 [00:05<00:26,  3.67it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:25,  3.76it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:24,  3.95it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:23,  3.96it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  3.98it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:23,  3.94it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.09it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:22,  4.12it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.23it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:21,  4.21it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.19it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.20it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.07it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.05it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.11it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:20,  4.08it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.12it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:19,  4.11it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:19,  3.98it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  4.03it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:18,  4.08it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.07it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.06it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  4.09it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.11it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.13it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:17,  4.09it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.13it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.09it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.10it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.07it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:15,  4.11it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:16,  3.99it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.04it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  4.01it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:14,  4.16it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.11it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.15it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.19it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.09it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.13it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:29,498 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:29 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.77it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.64it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.65it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.97it/s]03/23/2024 21:29:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8602941176470589, 'f1': 0.9025641025641027, 'combined_score': 0.8814291101055808, 'eval_loss': 0.73011917, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [745, 786, 857, 725, 776, 746, 408, 345, 328, 351, 181, 205], 'head_nums': [11, 10, 11, 12, 12, 11, 9, 7, 12, 4, 5, 2], 'pruned_params': 55863640, 'remaining_params': 29153960, 'pruned_model_sparsity': 0.6570832392351701, 'expected_sparsity': 0.65589, 'target_sparsity': 0.7434782608695653, 'step': 1900}


Iteration:  52%|█████▏    | 60/115 [00:16<00:27,  1.99it/s][A03/23/2024 21:29:30 - INFO - trainer.trainer - v4 Global step: 1900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:16<00:22,  2.35it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:19,  2.68it/s][A
Iteration:  55%|█████▍    | 63/115 [00:17<00:17,  3.01it/s][A
Iteration:  56%|█████▌    | 64/115 [00:17<00:15,  3.25it/s][A
Iteration:  57%|█████▋    | 65/115 [00:17<00:14,  3.45it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:13,  3.61it/s][A
Iteration:  58%|█████▊    | 67/115 [00:18<00:12,  3.74it/s][A
Iteration:  59%|█████▉    | 68/115 [00:18<00:12,  3.87it/s][A
Iteration:  60%|██████    | 69/115 [00:18<00:11,  3.90it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:11,  3.80it/s][A
Iteration:  62%|██████▏   | 71/115 [00:19<00:11,  3.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:19<00:10,  3.97it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:10,  3.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:10,  4.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:20<00:09,  4.06it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:09,  3.91it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:09,  4.07it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:09,  4.07it/s][A
Iteration:  69%|██████▊   | 79/115 [00:21<00:08,  4.18it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:08,  4.28it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:07,  4.33it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:07,  4.22it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:07,  4.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.18it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:06,  4.27it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.27it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  4.16it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.16it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.08it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.09it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.10it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.04it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.06it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.10it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.13it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.14it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.09it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.14it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:03,  4.07it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.12it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.12it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  4.23it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.17it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.17it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  4.04it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.08it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:42,523 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:42 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.72it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.65it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.97it/s]03/23/2024 21:29:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8892617449664431, 'combined_score': 0.8637485195420451, 'eval_loss': 0.85799736, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [707, 744, 806, 681, 732, 703, 382, 328, 315, 346, 179, 203], 'head_nums': [11, 10, 11, 12, 12, 11, 9, 7, 12, 4, 5, 2], 'pruned_params': 56356944, 'remaining_params': 28660656, 'pruned_model_sparsity': 0.6628856142728093, 'expected_sparsity': 0.66355, 'target_sparsity': 0.7641304347826087, 'step': 1950}


Iteration:  96%|█████████▌| 110/115 [00:29<00:02,  2.00it/s][A
Iteration:  97%|█████████▋| 111/115 [00:29<00:01,  2.37it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:01,  2.71it/s][A
Iteration:  98%|█████████▊| 113/115 [00:30<00:00,  3.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:30<00:00,  3.33it/s][A
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.76it/s][A03/23/2024 21:29:44 - INFO - trainer.trainer - Epoch 16 finished. Took 30.51 seconds.
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.77it/s]
Epoch:  17%|█▋        | 17/100 [08:22<41:29, 29.99s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.20it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.09it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.17it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:28,  3.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:27,  4.06it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.12it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.13it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.14it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.14it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.14it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.16it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.19it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.19it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.14it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.15it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.15it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.16it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.14it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.17it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.14it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.16it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.24it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.08it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.12it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:21,  4.08it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.13it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.05it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.11it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.09it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.11it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.15it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.13it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.16it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.13it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.23it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:18,  4.01it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:18,  4.06it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:18,  3.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:18,  3.83it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:18,  3.82it/s][A[INFO|trainer.py:570] 2024-03-23 21:29:55,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:29:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:29:55 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:29:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:29:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.74it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.74it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.00it/s]03/23/2024 21:29:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:29:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8406862745098039, 'f1': 0.8845470692717585, 'combined_score': 0.8626166718907813, 'eval_loss': 0.8371878, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [672, 704, 759, 641, 691, 663, 359, 313, 303, 340, 176, 201], 'head_nums': [11, 10, 11, 12, 12, 10, 9, 7, 11, 4, 5, 2], 'pruned_params': 57205672, 'remaining_params': 27811928, 'pruned_model_sparsity': 0.6728685825052695, 'expected_sparsity': 0.67356, 'target_sparsity': 0.7847826086956522, 'step': 2000}


Iteration:  39%|███▉      | 45/115 [00:11<00:36,  1.94it/s][A03/23/2024 21:29:56 - INFO - trainer.trainer - v4 Global step: 2000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:12<00:30,  2.29it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:25,  2.63it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:22,  2.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:20,  3.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:13<00:18,  3.47it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:17,  3.68it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:16,  3.83it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  3.93it/s][A
Iteration:  47%|████▋     | 54/115 [00:14<00:15,  4.00it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.03it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  3.99it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  3.98it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:14,  3.98it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.13it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.15it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.13it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.18it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:11,  4.27it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.15it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.13it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.07it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.13it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.15it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.11it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.10it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:10,  4.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.09it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.14it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.10it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.21it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.20it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.16it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.17it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  3.96it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.04it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  4.10it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:07,  3.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  3.98it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.05it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:06,  4.04it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.08it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.01it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.06it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:05,  4.10it/s][A[INFO|trainer.py:570] 2024-03-23 21:30:08,559 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:30:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:30:08 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:30:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:30:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.77it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.74it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.71it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.00it/s]03/23/2024 21:30:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:30:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8922558922558923, 'combined_score': 0.8676965735789266, 'eval_loss': 0.84783113, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [639, 667, 715, 602, 653, 624, 337, 298, 293, 334, 174, 198], 'head_nums': [11, 9, 10, 12, 12, 10, 9, 6, 10, 4, 5, 2], 'pruned_params': 58422080, 'remaining_params': 26595520, 'pruned_model_sparsity': 0.6871763023185787, 'expected_sparsity': 0.68515, 'target_sparsity': 0.8054347826086956, 'step': 2050}


Iteration:  83%|████████▎ | 95/115 [00:25<00:11,  1.77it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:08,  2.13it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:07,  2.48it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:06,  2.83it/s][A
Iteration:  86%|████████▌ | 99/115 [00:26<00:05,  3.11it/s][A
Iteration:  87%|████████▋ | 100/115 [00:26<00:04,  3.39it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  3.56it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  3.80it/s][A
Iteration:  90%|████████▉ | 103/115 [00:27<00:03,  3.88it/s][A
Iteration:  90%|█████████ | 104/115 [00:27<00:02,  3.97it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.11it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.14it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:01,  4.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.05it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.07it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.07it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  4.19it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.19it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.20it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.46it/s][A03/23/2024 21:30:14 - INFO - trainer.trainer - Epoch 17 finished. Took 29.84 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.85it/s]
Epoch:  18%|█▊        | 18/100 [08:52<40:55, 29.95s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:30,  3.73it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:28,  3.97it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.07it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.13it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:27,  4.07it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.04it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.18it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.27it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.14it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:26,  4.01it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.07it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.19it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.21it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.13it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.16it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.10it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.14it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.17it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.19it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.13it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:22,  4.11it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:22,  4.06it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.09it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.14it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.14it/s][A[INFO|trainer.py:570] 2024-03-23 21:30:21,649 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:30:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:30:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:30:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:30:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.76it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.72it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.66it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.99it/s]03/23/2024 21:30:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:30:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8922558922558923, 'combined_score': 0.8676965735789266, 'eval_loss': 0.80992687, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [610, 633, 674, 568, 617, 589, 318, 286, 284, 328, 172, 196], 'head_nums': [11, 8, 10, 12, 12, 10, 9, 5, 10, 4, 5, 2], 'pruned_params': 59201868, 'remaining_params': 25815732, 'pruned_model_sparsity': 0.6963483796296296, 'expected_sparsity': 0.69718, 'target_sparsity': 0.826086956521739, 'step': 2100}


Iteration:  26%|██▌       | 30/115 [00:08<00:42,  1.98it/s][A03/23/2024 21:30:22 - INFO - trainer.trainer - v4 Global step: 2100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:08<00:36,  2.30it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:31,  2.65it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:27,  2.99it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:25,  3.23it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:23,  3.47it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:21,  3.67it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:20,  3.76it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:20,  3.84it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.00it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.14it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.16it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.18it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.19it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.14it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.22it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.19it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.17it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.09it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.12it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.07it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.10it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.11it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.14it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.09it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.14it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.09it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  4.11it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:14,  4.04it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.08it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.06it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.16it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.17it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.20it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.14it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.13it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.02it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.09it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  3.94it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:10,  4.02it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:10,  3.98it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:10,  3.86it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.02it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:09,  4.07it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.11it/s][A[INFO|trainer.py:570] 2024-03-23 21:30:34,690 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:30:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:30:34 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:30:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:30:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.74it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.72it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.01it/s]03/23/2024 21:30:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:30:35 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8927335640138409, 'combined_score': 0.8703863898500577, 'eval_loss': 0.7901668, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [583, 602, 637, 536, 583, 557, 301, 274, 277, 321, 170, 194], 'head_nums': [10, 8, 9, 11, 12, 10, 8, 5, 10, 4, 5, 2], 'pruned_params': 60343208, 'remaining_params': 24674392, 'pruned_model_sparsity': 0.7097731293285156, 'expected_sparsity': 0.70913, 'target_sparsity': 0.8467391304347825, 'step': 2150}


Iteration:  70%|██████▉   | 80/115 [00:21<00:17,  1.97it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:14,  2.31it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:12,  2.65it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:10,  3.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:09,  3.29it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:08,  3.53it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  3.70it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:07,  3.77it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  3.90it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  3.80it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  3.89it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:06,  3.98it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.13it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.22it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:04,  4.23it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.22it/s][A
Iteration:  83%|████████▎ | 96/115 [00:25<00:04,  4.31it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.22it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:03,  4.31it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.22it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.16it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.25it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.24it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.22it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.16it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.17it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.14it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.14it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.15it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.16it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.18it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.14it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  3.98it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.02it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.33it/s][A03/23/2024 21:30:43 - INFO - trainer.trainer - Epoch 18 finished. Took 29.56 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.89it/s]
Epoch:  19%|█▉        | 19/100 [09:21<40:16, 29.83s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.56it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.31it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.25it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.08it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.15it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.17it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.17it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.20it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.14it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.18it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.13it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:25,  4.07it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.10it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.06it/s][A[INFO|trainer.py:570] 2024-03-23 21:30:47,548 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:30:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:30:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:30:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:30:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.73it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.72it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.66it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.68it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.99it/s]03/23/2024 21:30:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:30:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8480392156862745, 'f1': 0.8952702702702703, 'combined_score': 0.8716547429782724, 'eval_loss': 0.7846431, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [558, 573, 602, 506, 551, 527, 287, 264, 270, 314, 168, 193], 'head_nums': [9, 7, 9, 11, 11, 10, 7, 5, 10, 4, 5, 2], 'pruned_params': 61456972, 'remaining_params': 23560628, 'pruned_model_sparsity': 0.7228735226588378, 'expected_sparsity': 0.72137, 'target_sparsity': 0.867391304347826, 'step': 2200}


Iteration:  13%|█▎        | 15/115 [00:04<00:50,  1.99it/s][A03/23/2024 21:30:48 - INFO - trainer.trainer - v4 Global step: 2200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:41,  2.39it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:35,  2.78it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.09it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:29,  3.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:28,  3.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:26,  3.57it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:25,  3.71it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:23,  3.86it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:23,  3.95it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:22,  4.03it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:21,  4.09it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.22it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.21it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.20it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:19,  4.28it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.35it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.24it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.19it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:19,  4.21it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.22it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.22it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:17,  4.24it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.24it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.24it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.20it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.19it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.18it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.18it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.08it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.10it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.14it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.14it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.15it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.06it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.07it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  4.10it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.12it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.10it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.14it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  3.94it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:14,  3.96it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.03it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  3.99it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:13,  3.89it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:13,  3.93it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.02it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:00,510 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:00 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.72it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.69it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.00it/s]03/23/2024 21:31:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8627450980392157, 'f1': 0.902439024390244, 'combined_score': 0.8825920612147299, 'eval_loss': 0.75578946, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [536, 547, 572, 479, 523, 499, 275, 254, 264, 307, 167, 191], 'head_nums': [9, 7, 9, 10, 10, 10, 6, 4, 9, 4, 4, 2], 'pruned_params': 62731596, 'remaining_params': 22286004, 'pruned_model_sparsity': 0.7378659948057814, 'expected_sparsity': 0.7374, 'target_sparsity': 0.8880434782608696, 'step': 2250}


Iteration:  57%|█████▋    | 65/115 [00:17<00:25,  1.97it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:21,  2.30it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:18,  2.65it/s][A
Iteration:  59%|█████▉    | 68/115 [00:18<00:16,  2.94it/s][A
Iteration:  60%|██████    | 69/115 [00:18<00:14,  3.25it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:12,  3.49it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:12,  3.62it/s][A
Iteration:  63%|██████▎   | 72/115 [00:19<00:11,  3.79it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:10,  3.91it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:10,  3.99it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:10,  3.99it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:09,  4.02it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:09,  4.03it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:09,  4.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.08it/s][A
Iteration:  70%|██████▉   | 80/115 [00:21<00:08,  4.05it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  4.04it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:07,  4.15it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:22<00:07,  4.15it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.18it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:06,  4.25it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.22it/s][A
Iteration:  77%|███████▋  | 88/115 [00:23<00:06,  4.23it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.15it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.03it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.08it/s][A
Iteration:  80%|████████  | 92/115 [00:24<00:05,  4.01it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.13it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.09it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.22it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.21it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.12it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.15it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.18it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.12it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.14it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.17it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.20it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.19it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.20it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.18it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.16it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.26it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.24it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.20it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.14it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.18it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.20it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:13,403 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.72it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.71it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.00it/s]03/23/2024 21:31:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8866995073891626, 'combined_score': 0.8587909301651695, 'eval_loss': 0.9373516, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [516, 524, 545, 454, 498, 474, 264, 247, 259, 300, 166, 190], 'head_nums': [8, 6, 9, 10, 9, 9, 5, 4, 8, 4, 4, 2], 'pruned_params': 64168612, 'remaining_params': 20848988, 'pruned_model_sparsity': 0.7547685655676001, 'expected_sparsity': 0.75271, 'target_sparsity': 0.908695652173913, 'step': 2300}


Iteration: 100%|██████████| 115/115 [00:30<00:00,  2.05it/s][A03/23/2024 21:31:14 - INFO - trainer.trainer - Epoch 19 finished. Took 30.33 seconds.
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.79it/s]
Epoch:  20%|██        | 20/100 [09:51<39:58, 29.98s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:31:14 - INFO - trainer.trainer - v4 Global step: 2300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:25,  4.44it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.28it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.24it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.19it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.22it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.21it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.24it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.24it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.18it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.07it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:25,  4.11it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.11it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.13it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.15it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.23it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.24it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.28it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.15it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:23,  3.98it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:22,  4.00it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:22,  4.03it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.08it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:21,  3.98it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:21,  3.97it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:21,  4.00it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.09it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.12it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:20,  4.09it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.07it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.18it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.17it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.11it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.10it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.13it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:18,  4.16it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.20it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.16it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.18it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.18it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.27it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.24it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.32it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:26,290 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:26 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.83it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.74it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.67it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.68it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.67it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 15.99it/s]03/23/2024 21:31:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:27 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8870703764320785, 'combined_score': 0.8589763646866275, 'eval_loss': 0.92425597, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [497, 502, 522, 432, 475, 451, 254, 240, 254, 293, 165, 189], 'head_nums': [8, 6, 8, 9, 8, 9, 5, 3, 7, 4, 4, 2], 'pruned_params': 65388084, 'remaining_params': 19629516, 'pruned_model_sparsity': 0.7691123249774164, 'expected_sparsity': 0.76532, 'target_sparsity': 0.9293478260869565, 'step': 2350}


Iteration:  43%|████▎     | 50/115 [00:12<00:32,  2.03it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:26,  2.40it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:23,  2.72it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:20,  2.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:18,  3.24it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:17,  3.42it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:16,  3.63it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:15,  3.79it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:14,  3.92it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:14,  3.90it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  3.98it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.07it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:13,  4.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.07it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.06it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.11it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  3.92it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.01it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.15it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.00it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  4.07it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.12it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.15it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.17it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.13it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.17it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.18it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.18it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.27it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.15it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.18it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.26it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.26it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.19it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.30it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.28it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.26it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.21it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.15it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:05,  4.02it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:05,  3.99it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  3.97it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.06it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.16it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.05it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:39,295 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:39 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.78it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.73it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.69it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.70it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.70it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.00it/s]03/23/2024 21:31:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:40 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8382352941176471, 'f1': 0.8829787234042553, 'combined_score': 0.8606070087609512, 'eval_loss': 0.7359991, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [480, 482, 500, 411, 454, 429, 245, 235, 250, 285, 164, 188], 'head_nums': [8, 6, 8, 9, 8, 8, 5, 3, 6, 4, 4, 2], 'pruned_params': 65999352, 'remaining_params': 19018248, 'pruned_model_sparsity': 0.7763022244805782, 'expected_sparsity': 0.77619, 'target_sparsity': 0.95, 'step': 2400}


Iteration:  87%|████████▋ | 100/115 [00:25<00:07,  1.96it/s][A03/23/2024 21:31:40 - INFO - trainer.trainer - v4 Global step: 2400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:26<00:06,  2.27it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:04,  2.62it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:04,  2.96it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:03,  3.26it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  3.37it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  3.59it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:02,  3.76it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  3.81it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  3.92it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.03it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.06it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.06it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.09it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.08it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.36it/s][A03/23/2024 21:31:43 - INFO - trainer.trainer - Epoch 20 finished. Took 29.52 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.90it/s]
Epoch:  21%|██        | 21/100 [10:21<39:17, 29.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.31it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.18it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.09it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.07it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.13it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.08it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.11it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.13it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.18it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.10it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.15it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.14it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.16it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.13it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.10it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.15it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:24,  4.00it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.05it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:23,  4.04it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.16it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.19it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.16it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:22,  4.09it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.14it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.09it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.13it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.17it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.16it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.02it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.06it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.23it/s][A[INFO|trainer.py:570] 2024-03-23 21:31:52,271 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:31:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:31:52 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:31:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:31:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.74it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.74it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.75it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.74it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.05it/s]03/23/2024 21:31:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:31:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8431372549019608, 'f1': 0.8885017421602788, 'combined_score': 0.8658194985311198, 'eval_loss': 0.7517903, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [464, 464, 481, 393, 435, 409, 237, 230, 247, 278, 163, 187], 'head_nums': [8, 6, 7, 9, 7, 8, 5, 3, 5, 4, 4, 2], 'pruned_params': 67175928, 'remaining_params': 17841672, 'pruned_model_sparsity': 0.7901414295392954, 'expected_sparsity': 0.78836, 'target_sparsity': 0.95, 'step': 2450}


Iteration:  30%|███       | 35/115 [00:09<00:40,  2.00it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:33,  2.35it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:28,  2.70it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:25,  3.03it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:23,  3.19it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:21,  3.50it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:19,  3.71it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:19,  3.79it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:18,  3.91it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  3.95it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:17,  3.98it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:17,  4.04it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.10it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.08it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.20it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.22it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.17it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:14,  4.27it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.35it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.14it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.15it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.15it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.25it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.22it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.08it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.13it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.18it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.18it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.15it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.14it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.25it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.24it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.24it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.28it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.19it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.22it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.16it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.17it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.18it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.14it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.04it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.04it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.11it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.14it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.25it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:05,130 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:05 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.78it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.73it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.75it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.75it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.72it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.73it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.05it/s]03/23/2024 21:32:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:05 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8709677419354839, 'combined_score': 0.8472485768500948, 'eval_loss': 0.7840459, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [450, 448, 463, 376, 418, 391, 230, 225, 244, 271, 162, 186], 'head_nums': [7, 6, 6, 9, 6, 7, 4, 3, 5, 4, 3, 2], 'pruned_params': 68335652, 'remaining_params': 16681948, 'pruned_model_sparsity': 0.8037824168172237, 'expected_sparsity': 0.80131, 'target_sparsity': 0.95, 'step': 2500}


Iteration:  74%|███████▍  | 85/115 [00:22<00:14,  2.00it/s][A03/23/2024 21:32:06 - INFO - trainer.trainer - v4 Global step: 2500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:22<00:12,  2.32it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:10,  2.68it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:09,  2.99it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:08,  3.24it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:07,  3.46it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:06,  3.64it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:06,  3.72it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  3.81it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  3.86it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:05,  3.97it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.05it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.07it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.13it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.16it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.19it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.21it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.17it/s][A
Iteration:  91%|█████████▏| 105/115 [00:27<00:02,  4.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.16it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.19it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.06it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  4.11it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.08it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.18it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  4.12it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  3.99it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.29it/s][A03/23/2024 21:32:13 - INFO - trainer.trainer - Epoch 21 finished. Took 29.47 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.90it/s]
Epoch:  22%|██▏       | 22/100 [10:50<38:39, 29.73s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.05it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.10it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.07it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.14it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.18it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.10it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.15it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.11it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.21it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.20it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:25,  4.04it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.10it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.13it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.14it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.15it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.14it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.17it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:18,083 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:18 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.84it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.78it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.11it/s]03/23/2024 21:32:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8795986622073578, 'combined_score': 0.8515640369860318, 'eval_loss': 0.71662164, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [437, 435, 446, 362, 402, 374, 226, 221, 241, 264, 162, 186], 'head_nums': [7, 6, 5, 9, 5, 7, 4, 3, 5, 3, 3, 2], 'pruned_params': 69424904, 'remaining_params': 15592696, 'pruned_model_sparsity': 0.8165944933754893, 'expected_sparsity': 0.81088, 'target_sparsity': 0.95, 'step': 2550}


Iteration:  17%|█▋        | 20/115 [00:05<00:47,  2.01it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:39,  2.38it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:34,  2.73it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:30,  3.03it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:27,  3.32it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.63it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:23,  3.79it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:22,  3.87it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:22,  3.92it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:21,  4.01it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.08it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.12it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.12it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:20,  4.09it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.14it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:19,  4.08it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:19,  4.14it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.22it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.18it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.26it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:18,  4.02it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.13it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.16it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.13it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.12it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.11it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.10it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.12it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.17it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.12it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.16it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.15it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.18it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.19it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.22it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:12,  4.24it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.24it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.11it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.15it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.19it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.06it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:12,  3.97it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.04it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.09it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:30,978 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:30 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.84it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.83it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.83it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.81it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.13it/s]03/23/2024 21:32:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:31 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8795986622073578, 'combined_score': 0.8515640369860318, 'eval_loss': 0.82739913, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [424, 423, 432, 350, 389, 358, 224, 218, 238, 258, 161, 185], 'head_nums': [7, 6, 5, 9, 5, 6, 4, 3, 5, 3, 3, 2], 'pruned_params': 69755816, 'remaining_params': 15261784, 'pruned_model_sparsity': 0.8204867697982535, 'expected_sparsity': 0.81886, 'target_sparsity': 0.95, 'step': 2600}


Iteration:  61%|██████    | 70/115 [00:18<00:22,  1.99it/s][A03/23/2024 21:32:31 - INFO - trainer.trainer - v4 Global step: 2600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:18<00:18,  2.35it/s][A
Iteration:  63%|██████▎   | 72/115 [00:19<00:15,  2.71it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:13,  3.11it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:12,  3.37it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:11,  3.58it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:10,  3.74it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:09,  3.88it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:09,  3.99it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.07it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.12it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  4.06it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:08,  4.08it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.19it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.28it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:06,  4.37it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.23it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.25it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:05,  4.20it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.21it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.23it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.19it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.20it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.01it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.04it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.18it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.20it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.17it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.18it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.16it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:03,  3.95it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.02it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.07it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.07it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.07it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.12it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.06it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.06it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.04it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.10it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.08it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.31it/s][A03/23/2024 21:32:42 - INFO - trainer.trainer - Epoch 22 finished. Took 29.36 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.92it/s]
Epoch:  23%|██▎       | 23/100 [11:20<38:00, 29.62s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.50it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.24it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.22it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.23it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:43,802 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:43 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.84it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.79it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.77it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.77it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.09it/s]03/23/2024 21:32:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8754208754208753, 'combined_score': 0.8470241632006337, 'eval_loss': 0.8517133, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [413, 412, 419, 339, 378, 345, 223, 214, 236, 252, 161, 185], 'head_nums': [6, 6, 5, 8, 4, 6, 4, 2, 4, 3, 2, 2], 'pruned_params': 70852728, 'remaining_params': 14164872, 'pruned_model_sparsity': 0.8333889453477868, 'expected_sparsity': 0.82782, 'target_sparsity': 0.95, 'step': 2650}


Iteration:   4%|▍         | 5/115 [00:02<01:00,  1.83it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:48,  2.25it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:40,  2.69it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.34it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:29,  3.56it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:28,  3.67it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:26,  3.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  3.94it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:25,  3.97it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:25,  3.95it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  4.02it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.10it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:23,  4.06it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:23,  4.17it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:23,  4.13it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.10it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:22,  4.11it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.17it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:22,  4.02it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.09it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:21,  4.10it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.14it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.20it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.21it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:19,  4.21it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.18it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.13it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.17it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:19,  4.19it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.17it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.30it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.28it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.04it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.10it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.17it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.24it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.35it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:15,  4.26it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.26it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.20it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.14it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.11it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.09it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.13it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.10it/s][A[INFO|trainer.py:570] 2024-03-23 21:32:56,675 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:32:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:32:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:32:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:32:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.11it/s]03/23/2024 21:32:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:32:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8259803921568627, 'f1': 0.8786324786324787, 'combined_score': 0.8523064353946708, 'eval_loss': 0.80635655, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [403, 402, 408, 329, 367, 334, 223, 212, 233, 247, 160, 184], 'head_nums': [5, 6, 5, 7, 4, 5, 4, 2, 4, 3, 2, 2], 'pruned_params': 71548256, 'remaining_params': 13469344, 'pruned_model_sparsity': 0.8415699337548931, 'expected_sparsity': 0.8339, 'target_sparsity': 0.95, 'step': 2700}


Iteration:  48%|████▊     | 55/115 [00:14<00:30,  1.99it/s][A03/23/2024 21:32:57 - INFO - trainer.trainer - v4 Global step: 2700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:15<00:25,  2.35it/s][A
Iteration:  50%|████▉     | 57/115 [00:15<00:21,  2.71it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:18,  3.02it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:16,  3.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:16<00:15,  3.57it/s][A
Iteration:  53%|█████▎    | 61/115 [00:16<00:14,  3.81it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:13,  3.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.00it/s][A
Iteration:  56%|█████▌    | 64/115 [00:17<00:12,  4.03it/s][A
Iteration:  57%|█████▋    | 65/115 [00:17<00:12,  4.09it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:11,  4.12it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.16it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.18it/s][A
Iteration:  60%|██████    | 69/115 [00:18<00:10,  4.19it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:11,  4.08it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.13it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:10,  4.12it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:09,  4.24it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.15it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:09,  4.18it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:08,  4.16it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.27it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  4.22it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:08,  4.03it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.12it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.10it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.09it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  4.11it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:07,  4.00it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  3.96it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.03it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.01it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.07it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.04it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.08it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.09it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.09it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.13it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.17it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.14it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.14it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.17it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:03,  4.14it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.16it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.12it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.14it/s][A[INFO|trainer.py:570] 2024-03-23 21:33:09,592 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:33:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:33:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:33:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:33:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.77it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.79it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.78it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.10it/s]03/23/2024 21:33:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:33:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8161764705882353, 'f1': 0.862888482632541, 'combined_score': 0.8395324766103882, 'eval_loss': 0.69405663, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [394, 394, 397, 320, 358, 323, 223, 209, 231, 242, 160, 183], 'head_nums': [4, 6, 5, 7, 4, 5, 4, 2, 4, 3, 2, 2], 'pruned_params': 71840868, 'remaining_params': 13176732, 'pruned_model_sparsity': 0.8450117152213189, 'expected_sparsity': 0.83932, 'target_sparsity': 0.95, 'step': 2750}


Iteration:  91%|█████████▏| 105/115 [00:27<00:04,  2.00it/s][A
Iteration:  92%|█████████▏| 106/115 [00:28<00:03,  2.36it/s][A
Iteration:  93%|█████████▎| 107/115 [00:28<00:02,  2.73it/s][A
Iteration:  94%|█████████▍| 108/115 [00:28<00:02,  3.03it/s][A
Iteration:  95%|█████████▍| 109/115 [00:28<00:01,  3.32it/s][A
Iteration:  96%|█████████▌| 110/115 [00:29<00:01,  3.56it/s][A
Iteration:  97%|█████████▋| 111/115 [00:29<00:01,  3.62it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:00,  3.80it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  3.86it/s][A
Iteration:  99%|█████████▉| 114/115 [00:30<00:00,  3.97it/s][A
Iteration: 100%|██████████| 115/115 [00:30<00:00,  4.31it/s][A03/23/2024 21:33:12 - INFO - trainer.trainer - Epoch 23 finished. Took 30.19 seconds.
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.81it/s]
Epoch:  24%|██▍       | 24/100 [11:50<37:44, 29.79s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.15it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.22it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.20it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.18it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.13it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.16it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.18it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.15it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.13it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.13it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.13it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.23it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:25,  4.03it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.10it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.14it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.12it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:24,  3.99it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.01it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:23,  4.06it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.11it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.22it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.18it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.20it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.22it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.18it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.14it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.16it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:20,  4.19it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.16it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.13it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.15it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.17it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.21it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.14it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.16it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:19,  4.03it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.10it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.15it/s][A[INFO|trainer.py:570] 2024-03-23 21:33:22,457 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:33:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:33:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:33:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:33:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.86it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.83it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.13it/s]03/23/2024 21:33:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:33:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.821078431372549, 'f1': 0.8712522045855379, 'combined_score': 0.8461653179790434, 'eval_loss': 0.7081938, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [386, 386, 387, 312, 349, 314, 222, 207, 228, 237, 160, 183], 'head_nums': [4, 6, 5, 7, 4, 5, 4, 2, 4, 3, 2, 2], 'pruned_params': 71928192, 'remaining_params': 13089408, 'pruned_model_sparsity': 0.8460388437217705, 'expected_sparsity': 0.84425, 'target_sparsity': 0.95, 'step': 2800}


Iteration:  35%|███▍      | 40/115 [00:10<00:37,  2.02it/s][A03/23/2024 21:33:23 - INFO - trainer.trainer - v4 Global step: 2800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:10<00:30,  2.40it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:26,  2.75it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:23,  3.03it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:21,  3.30it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:20,  3.50it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:18,  3.66it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:17,  3.83it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:17,  3.93it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.02it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.10it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.16it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:14,  4.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.27it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.22it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:13,  4.24it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.18it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.27it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.27it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:12,  4.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.14it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.11it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.14it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.17it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.27it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.11it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.19it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.21it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.16it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.17it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.20it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.22it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.23it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.18it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.16it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.17it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.27it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.26it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.21it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.17it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.14it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.15it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.12it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  4.12it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:07,  3.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.06it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.12it/s][A[INFO|trainer.py:570] 2024-03-23 21:33:35,265 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:33:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:33:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:33:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:33:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.77it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.10it/s]03/23/2024 21:33:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:33:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8423076923076923, 'combined_score': 0.8206636500754148, 'eval_loss': 0.7166323, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [379, 379, 379, 305, 340, 305, 222, 205, 226, 233, 159, 182], 'head_nums': [3, 6, 4, 6, 3, 5, 4, 2, 4, 3, 2, 2], 'pruned_params': 72793772, 'remaining_params': 12223828, 'pruned_model_sparsity': 0.8562200297350195, 'expected_sparsity': 0.85013, 'target_sparsity': 0.95, 'step': 2850}


Iteration:  78%|███████▊  | 90/115 [00:23<00:12,  2.00it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:10,  2.38it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:08,  2.72it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:07,  3.01it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:06,  3.31it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:05,  3.60it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:05,  3.78it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  3.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  3.99it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:04,  3.93it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  3.94it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  3.99it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.08it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.07it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.20it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.14it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.05it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.15it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.07it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.07it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.13it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.16it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.25it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.46it/s][A03/23/2024 21:33:42 - INFO - trainer.trainer - Epoch 24 finished. Took 29.28 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.93it/s]
Epoch:  25%|██▌       | 25/100 [12:19<37:03, 29.64s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.20it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.22it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.33it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.21it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.10it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.09it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.12it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:26,  3.99it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:26,  4.01it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.03it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:25,  4.09it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.13it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.09it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.09it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:24,  4.06it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.11it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.07it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:23,  3.99it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  4.07it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:23,  3.94it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:23,  3.99it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:23,  3.87it/s][A[INFO|trainer.py:570] 2024-03-23 21:33:48,265 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:33:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:33:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:33:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:33:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.81it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.12it/s]03/23/2024 21:33:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:33:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8235294117647058, 'f1': 0.8795986622073578, 'combined_score': 0.8515640369860318, 'eval_loss': 0.78950787, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [372, 373, 370, 299, 332, 296, 221, 203, 224, 229, 159, 182], 'head_nums': [3, 6, 4, 5, 3, 5, 3, 2, 4, 3, 2, 2], 'pruned_params': 73261032, 'remaining_params': 11756568, 'pruned_model_sparsity': 0.8617160682023487, 'expected_sparsity': 0.85561, 'target_sparsity': 0.95, 'step': 2900}


Iteration:  22%|██▏       | 25/115 [00:07<00:46,  1.95it/s][A03/23/2024 21:33:49 - INFO - trainer.trainer - v4 Global step: 2900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:07<00:38,  2.33it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:32,  2.70it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:28,  3.00it/s][A
Iteration:  25%|██▌       | 29/115 [00:08<00:27,  3.17it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:24,  3.43it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:23,  3.61it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:21,  3.79it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:21,  3.89it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:20,  3.99it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:19,  4.06it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:19,  4.06it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.12it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:18,  4.13it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.16it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.18it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.19it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.08it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.13it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.16it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.25it/s][A
Iteration:  40%|████      | 46/115 [00:12<00:16,  4.24it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.24it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.32it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.31it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.29it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.23it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.19it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.21it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.20it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.22it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.18it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.21it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:12,  4.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:12,  4.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.29it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.30it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.27it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.19it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.15it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.15it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.11it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.09it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.14it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.11it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.14it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.13it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.17it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.19it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:01,066 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:01 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.83it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.83it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.79it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.11it/s]03/23/2024 21:34:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:01 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8660130718954249, 'combined_score': 0.8325163398692811, 'eval_loss': 0.91516083, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [366, 367, 363, 293, 324, 287, 221, 202, 223, 225, 159, 182], 'head_nums': [3, 6, 4, 5, 3, 5, 3, 2, 3, 3, 2, 2], 'pruned_params': 73524536, 'remaining_params': 11493064, 'pruned_model_sparsity': 0.8648154735019572, 'expected_sparsity': 0.86083, 'target_sparsity': 0.95, 'step': 2950}


Iteration:  65%|██████▌   | 75/115 [00:19<00:20,  2.00it/s][A
Iteration:  66%|██████▌   | 76/115 [00:20<00:16,  2.37it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:13,  2.76it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:11,  3.12it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:10,  3.44it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:09,  3.64it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:08,  3.88it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:08,  3.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.01it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.07it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.06it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  4.10it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.11it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.13it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.15it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.15it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.18it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:04,  4.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.21it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.16it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:04,  4.25it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:03,  4.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.18it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.21it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.13it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.13it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.16it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.17it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.11it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.04it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.06it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.04it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.06it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.04it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.10it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.15it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.22it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.53it/s][A03/23/2024 21:34:11 - INFO - trainer.trainer - Epoch 25 finished. Took 29.32 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.92it/s]
Epoch:  26%|██▌       | 26/100 [12:49<36:26, 29.54s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.12it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.20it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:28,  3.96it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:27,  4.06it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.14it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.16it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.13it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.17it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:13,840 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.79it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.12it/s]03/23/2024 21:34:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8689655172413793, 'combined_score': 0.8413455037187288, 'eval_loss': 0.7616192, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [360, 362, 357, 288, 317, 280, 220, 201, 221, 221, 159, 181], 'head_nums': [3, 6, 4, 4, 3, 5, 2, 2, 3, 3, 2, 2], 'pruned_params': 73978008, 'remaining_params': 11039592, 'pruned_model_sparsity': 0.8701493337850045, 'expected_sparsity': 0.86418, 'target_sparsity': 0.95, 'step': 3000}


Iteration:   9%|▊         | 10/115 [00:03<00:53,  1.97it/s][A03/23/2024 21:34:14 - INFO - trainer.trainer - v4 Global step: 3000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:44,  2.35it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:38,  2.71it/s][A
Iteration:  11%|█▏        | 13/115 [00:04<00:33,  3.02it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:30,  3.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:28,  3.51it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:26,  3.70it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:25,  3.78it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:24,  3.91it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:24,  3.94it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:24,  3.84it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  3.97it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:22,  4.05it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.06it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.19it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:22,  3.97it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.16it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:21,  4.08it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.22it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.23it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.13it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.11it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:20,  4.03it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:19,  4.07it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:19,  4.06it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:19,  4.12it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.15it/s][A
Iteration:  33%|███▎      | 38/115 [00:10<00:18,  4.14it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:17,  4.25it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.23it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:11<00:17,  4.23it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.24it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.25it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.31it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:16,  4.16it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.12it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.15it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.20it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.20it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.16it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.18it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:13,  4.21it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.18it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.22it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:26,710 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:26 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.78it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.78it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.79it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.74it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.08it/s]03/23/2024 21:34:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:27 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8112745098039216, 'f1': 0.8612612612612611, 'combined_score': 0.8362678855325913, 'eval_loss': 0.72230595, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [354, 357, 351, 283, 310, 273, 220, 200, 220, 217, 158, 181], 'head_nums': [3, 6, 4, 4, 3, 5, 2, 2, 3, 3, 2, 2], 'pruned_params': 74037756, 'remaining_params': 10979844, 'pruned_model_sparsity': 0.8708521059168925, 'expected_sparsity': 0.8671, 'target_sparsity': 0.95, 'step': 3050}


Iteration:  52%|█████▏    | 60/115 [00:16<00:27,  2.02it/s][A
Iteration:  53%|█████▎    | 61/115 [00:16<00:22,  2.40it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:19,  2.73it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:16,  3.11it/s][A
Iteration:  56%|█████▌    | 64/115 [00:17<00:15,  3.34it/s][A
Iteration:  57%|█████▋    | 65/115 [00:17<00:14,  3.57it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:13,  3.73it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:12,  3.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:18<00:11,  3.98it/s][A
Iteration:  60%|██████    | 69/115 [00:18<00:11,  4.07it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:11,  4.07it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.10it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.23it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:09,  4.21it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:09,  4.24it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.19it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:09,  4.09it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:09,  4.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.15it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.29it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:07,  4.30it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:07,  4.22it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.23it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.22it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:07,  4.23it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:06,  4.23it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.16it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:05,  4.17it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.15it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.19it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.27it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:05,  4.12it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.12it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.15it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.14it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.16it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.19it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.17it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.19it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:03,  4.00it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.09it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.08it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.11it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.09it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.09it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.22it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:39,526 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:39 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.83it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.82it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.84it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.12it/s]03/23/2024 21:34:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:40 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8308823529411765, 'f1': 0.8761220825852782, 'combined_score': 0.8535022177632274, 'eval_loss': 0.7087532, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [349, 353, 345, 279, 304, 268, 219, 199, 220, 214, 158, 181], 'head_nums': [3, 6, 4, 4, 3, 5, 2, 2, 3, 3, 2, 2], 'pruned_params': 74085248, 'remaining_params': 10932352, 'pruned_model_sparsity': 0.8714107196627522, 'expected_sparsity': 0.86865, 'target_sparsity': 0.95, 'step': 3100}


Iteration:  96%|█████████▌| 110/115 [00:28<00:02,  2.01it/s][A03/23/2024 21:34:40 - INFO - trainer.trainer - v4 Global step: 3100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:29<00:01,  2.38it/s][A
Iteration:  97%|█████████▋| 112/115 [00:29<00:01,  2.74it/s][A
Iteration:  98%|█████████▊| 113/115 [00:29<00:00,  3.07it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  3.34it/s][A
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.75it/s][A03/23/2024 21:34:41 - INFO - trainer.trainer - Epoch 26 finished. Took 30.1 seconds.
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.82it/s]
Epoch:  27%|██▋       | 27/100 [13:19<36:08, 29.71s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.09it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.17it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.17it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.14it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.18it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.30it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.28it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.25it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.17it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.07it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.12it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:25,  4.10it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  4.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.04it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.06it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:24,  3.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:24,  3.99it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:25,  3.87it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:24,  3.97it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:23,  3.97it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  4.02it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.19it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.21it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.22it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.23it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.17it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.18it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:21,  4.13it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.16it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.18it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.18it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.16it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.17it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.26it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.25it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.25it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.18it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.20it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.19it/s][A[INFO|trainer.py:570] 2024-03-23 21:34:52,362 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:34:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:34:52 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:34:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:34:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.84it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.83it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.84it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.12it/s]03/23/2024 21:34:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:34:53 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8161764705882353, 'f1': 0.866785079928952, 'combined_score': 0.8414807752585937, 'eval_loss': 0.7076602, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [344, 348, 341, 275, 298, 264, 219, 198, 219, 211, 158, 181], 'head_nums': [3, 6, 4, 3, 3, 5, 2, 2, 3, 3, 2, 2], 'pruned_params': 74327304, 'remaining_params': 10690296, 'pruned_model_sparsity': 0.8742578477868111, 'expected_sparsity': 0.86966, 'target_sparsity': 0.95, 'step': 3150}


Iteration:  39%|███▉      | 45/115 [00:11<00:34,  2.02it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:28,  2.39it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:24,  2.75it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:22,  3.03it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:19,  3.33it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:18,  3.56it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:17,  3.74it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:16,  3.88it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  3.92it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:15,  4.03it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.06it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.20it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.21it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.22it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.19it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.13it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.16it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.19it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.08it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.06it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:12,  3.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.05it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.09it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.10it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.09it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.13it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.22it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.23it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.19it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.23it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.22it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.25it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.26it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.24it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.20it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.17it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.17it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.13it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.17it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.19it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.18it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.20it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:05,  4.18it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:05,190 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:05 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.80it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.81it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.80it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.12it/s]03/23/2024 21:35:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:06 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8186274509803921, 'f1': 0.8697183098591549, 'combined_score': 0.8441728804197735, 'eval_loss': 0.7313702, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [339, 344, 336, 272, 293, 259, 218, 197, 218, 208, 157, 181], 'head_nums': [3, 6, 4, 3, 3, 5, 2, 2, 3, 3, 2, 2], 'pruned_params': 74373264, 'remaining_params': 10644336, 'pruned_model_sparsity': 0.8747984417344173, 'expected_sparsity': 0.87082, 'target_sparsity': 0.95, 'step': 3200}


Iteration:  83%|████████▎ | 95/115 [00:24<00:10,  2.00it/s][A03/23/2024 21:35:06 - INFO - trainer.trainer - v4 Global step: 3200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:24<00:08,  2.36it/s][A
Iteration:  84%|████████▍ | 97/115 [00:25<00:06,  2.70it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:05,  3.03it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:04,  3.28it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:04,  3.52it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  3.68it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  3.82it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.01it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  3.99it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.06it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.05it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.06it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.19it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.31it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.25it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.24it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.24it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.07it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.03it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.36it/s][A03/23/2024 21:35:10 - INFO - trainer.trainer - Epoch 27 finished. Took 29.28 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.93it/s]
Epoch:  28%|██▊       | 28/100 [13:48<35:29, 29.58s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.10it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.17it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.22it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.24it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.18it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.18it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.20it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.22it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.22it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.24it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.15it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.13it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.18it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.15it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.15it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.19it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.24it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.24it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.26it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.13it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.18it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.16it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.17it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.18it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.17it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.18it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:20,  4.21it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:17,984 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:17 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.90it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.88it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.20it/s]03/23/2024 21:35:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8088235294117647, 'f1': 0.8729641693811075, 'combined_score': 0.8408938493964362, 'eval_loss': 0.7424333, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [334, 340, 333, 270, 288, 255, 218, 196, 217, 205, 157, 181], 'head_nums': [3, 6, 4, 3, 3, 5, 2, 2, 3, 3, 2, 2], 'pruned_params': 74825204, 'remaining_params': 10192396, 'pruned_model_sparsity': 0.8801142822192111, 'expected_sparsity': 0.87319, 'target_sparsity': 0.95, 'step': 3250}


Iteration:  26%|██▌       | 30/115 [00:08<00:42,  2.00it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:35,  2.37it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:30,  2.74it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:27,  3.03it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:24,  3.37it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:21,  3.68it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.84it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  3.92it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:19,  3.93it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.01it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.05it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  4.01it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:18,  4.06it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.03it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:17,  4.09it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:17,  4.02it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:17,  3.99it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:17,  3.92it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  3.98it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:16,  4.00it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.05it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:16,  3.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  4.00it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.16it/s][A
Iteration:  48%|████▊     | 55/115 [00:14<00:14,  4.19it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.19it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.17it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.13it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:13,  4.02it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.04it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.09it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:13,  3.97it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.03it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:12,  4.11it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.27it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.23it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.24it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.18it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.19it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.30it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.22it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.34it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.25it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.24it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.22it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.23it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:30,880 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:30 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.87it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.85it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.17it/s]03/23/2024 21:35:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:31 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8112745098039216, 'f1': 0.8723051409618573, 'combined_score': 0.8417898253828895, 'eval_loss': 0.7834772, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [330, 336, 329, 268, 284, 252, 217, 195, 217, 202, 157, 181], 'head_nums': [3, 6, 4, 3, 3, 5, 2, 2, 3, 3, 1, 2], 'pruned_params': 74855844, 'remaining_params': 10161756, 'pruned_model_sparsity': 0.8804746781842818, 'expected_sparsity': 0.87517, 'target_sparsity': 0.95, 'step': 3300}


Iteration:  70%|██████▉   | 80/115 [00:20<00:17,  2.02it/s][A03/23/2024 21:35:31 - INFO - trainer.trainer - v4 Global step: 3300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:21<00:14,  2.38it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:11,  2.76it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:10,  3.06it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:09,  3.34it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:08,  3.53it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:07,  3.69it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:07,  3.82it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  3.88it/s][A
Iteration:  77%|███████▋  | 89/115 [00:23<00:06,  4.00it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:06,  4.08it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.12it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.22it/s][A
Iteration:  81%|████████  | 93/115 [00:24<00:05,  4.25it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:04,  4.34it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.33it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.25it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.25it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.26it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.26it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.25it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.25it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.26it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.27it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.33it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.04it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  4.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.10it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.14it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.15it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.43it/s][A03/23/2024 21:35:40 - INFO - trainer.trainer - Epoch 28 finished. Took 29.2 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.94it/s]
Epoch:  29%|██▉       | 29/100 [14:17<34:52, 29.47s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.24it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.28it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.21it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.25it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:27,  4.04it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:27,  4.03it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.01it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:26,  4.09it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:26,  4.06it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.13it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.17it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.20it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.16it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:43,637 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:43 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.86it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.86it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.87it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.86it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.17it/s]03/23/2024 21:35:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8663282571912013, 'combined_score': 0.8363504031054045, 'eval_loss': 0.72066736, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [325, 333, 326, 268, 280, 249, 217, 195, 216, 200, 157, 180], 'head_nums': [3, 6, 4, 3, 3, 5, 2, 2, 3, 3, 1, 2], 'pruned_params': 74886484, 'remaining_params': 10131116, 'pruned_model_sparsity': 0.8808350741493526, 'expected_sparsity': 0.87667, 'target_sparsity': 0.95, 'step': 3350}


Iteration:  13%|█▎        | 15/115 [00:04<00:50,  2.00it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:41,  2.37it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:35,  2.74it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.08it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.36it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:27,  3.52it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:25,  3.68it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:24,  3.74it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:24,  3.82it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:23,  3.93it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.12it/s][A
Iteration:  23%|██▎       | 26/115 [00:07<00:21,  4.19it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.16it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:21,  4.14it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.16it/s][A
Iteration:  26%|██▌       | 30/115 [00:08<00:20,  4.25it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.20it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.16it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.19it/s][A
Iteration:  30%|██▉       | 34/115 [00:09<00:18,  4.27it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:18,  4.27it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.27it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.33it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:17,  4.40it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.35it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.24it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.23it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.24it/s][A
Iteration:  41%|████      | 47/115 [00:12<00:15,  4.25it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.23it/s][A
Iteration:  44%|████▍     | 51/115 [00:13<00:15,  4.08it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.14it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.17it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.13it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.12it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:14,  4.15it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.19it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.13it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.04it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.12it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  4.13it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.12it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:13,  3.99it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.05it/s][A[INFO|trainer.py:570] 2024-03-23 21:35:56,439 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:35:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:35:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:35:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:35:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.86it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.90it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.21it/s]03/23/2024 21:35:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:35:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8689655172413793, 'combined_score': 0.8413455037187288, 'eval_loss': 0.75697154, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [322, 329, 322, 268, 276, 247, 216, 194, 216, 197, 157, 180], 'head_nums': [3, 6, 4, 3, 3, 5, 2, 2, 3, 3, 1, 2], 'pruned_params': 74914060, 'remaining_params': 10103540, 'pruned_model_sparsity': 0.8811594305179163, 'expected_sparsity': 0.87831, 'target_sparsity': 0.95, 'step': 3400}


Iteration:  57%|█████▋    | 65/115 [00:17<00:25,  1.99it/s][A03/23/2024 21:35:57 - INFO - trainer.trainer - v4 Global step: 3400, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:17<00:20,  2.35it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:17,  2.71it/s][A
Iteration:  59%|█████▉    | 68/115 [00:18<00:15,  3.03it/s][A
Iteration:  60%|██████    | 69/115 [00:18<00:14,  3.24it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:12,  3.49it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:12,  3.64it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:11,  3.77it/s][A
Iteration:  63%|██████▎   | 73/115 [00:19<00:10,  3.88it/s][A
Iteration:  64%|██████▍   | 74/115 [00:19<00:10,  3.94it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.03it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.10it/s][A
Iteration:  67%|██████▋   | 77/115 [00:20<00:08,  4.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:20<00:08,  4.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.37it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.33it/s][A
Iteration:  70%|███████   | 81/115 [00:21<00:07,  4.31it/s][A
Iteration:  71%|███████▏  | 82/115 [00:21<00:07,  4.28it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.21it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:22<00:06,  4.29it/s][A
Iteration:  75%|███████▍  | 86/115 [00:22<00:06,  4.26it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:06,  4.38it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.30it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.27it/s][A
Iteration:  78%|███████▊  | 90/115 [00:23<00:05,  4.26it/s][A
Iteration:  79%|███████▉  | 91/115 [00:23<00:05,  4.26it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.26it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.19it/s][A
Iteration:  82%|████████▏ | 94/115 [00:24<00:04,  4.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:24<00:04,  4.24it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.17it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.21it/s][A
Iteration:  85%|████████▌ | 98/115 [00:25<00:04,  4.24it/s][A
Iteration:  86%|████████▌ | 99/115 [00:25<00:03,  4.30it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.30it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.08it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:03,  4.04it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:02,  4.14it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:02,  4.09it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.10it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  4.09it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:01,  4.13it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  4.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.18it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.14it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.09it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.15it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  3.97it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.07it/s][A[INFO|trainer.py:570] 2024-03-23 21:36:09,179 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:36:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:36:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:36:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:36:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.90it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.89it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.88it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.19it/s]03/23/2024 21:36:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:36:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8349146110056925, 'combined_score': 0.8108396584440227, 'eval_loss': 0.77546287, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [318, 325, 319, 267, 272, 244, 216, 193, 215, 195, 157, 180], 'head_nums': [3, 6, 3, 3, 3, 5, 2, 2, 3, 3, 1, 2], 'pruned_params': 75140796, 'remaining_params': 9876804, 'pruned_model_sparsity': 0.88382636065944, 'expected_sparsity': 0.8801, 'target_sparsity': 0.95, 'step': 3450}


Iteration: 100%|██████████| 115/115 [00:30<00:00,  2.06it/s][A03/23/2024 21:36:10 - INFO - trainer.trainer - Epoch 29 finished. Took 30.03 seconds.
Iteration: 100%|██████████| 115/115 [00:30<00:00,  3.83it/s]
Epoch:  30%|███       | 30/100 [14:47<34:34, 29.64s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.26it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.12it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.13it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:27,  4.04it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.10it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.15it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.15it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.12it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.24it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.24it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.13it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.10it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:24,  4.12it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.13it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.21it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.23it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.18it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.21it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.22it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.19it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.27it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.27it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.28it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.29it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:20,  4.28it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.28it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.27it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.17it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.18it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.22it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.23it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.25it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.25it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.19it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.15it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:16,  4.09it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.16it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.23it/s][A[INFO|trainer.py:570] 2024-03-23 21:36:21,933 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:36:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:36:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:36:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:36:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.88it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.86it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.87it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.88it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.19it/s]03/23/2024 21:36:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:36:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8088235294117647, 'f1': 0.8571428571428572, 'combined_score': 0.832983193277311, 'eval_loss': 0.74107075, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [315, 322, 316, 267, 269, 242, 215, 193, 214, 193, 156, 180], 'head_nums': [3, 6, 3, 3, 3, 5, 2, 2, 3, 3, 1, 2], 'pruned_params': 75165308, 'remaining_params': 9852292, 'pruned_model_sparsity': 0.8841146774314965, 'expected_sparsity': 0.88219, 'target_sparsity': 0.95, 'step': 3500}


Iteration:  43%|████▎     | 50/115 [00:12<00:31,  2.04it/s][A03/23/2024 21:36:22 - INFO - trainer.trainer - v4 Global step: 3500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:12<00:26,  2.41it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:22,  2.77it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:20,  3.09it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:18,  3.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:16,  3.60it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:15,  3.78it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  3.91it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:14,  4.02it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.07it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:13,  4.14it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.17it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.19it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.22it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.24it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.20it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.24it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.04it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.11it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.14it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.16it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.25it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.27it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.21it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.17it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.00it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  3.94it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:09,  4.01it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:09,  3.93it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.01it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.14it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.16it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.21it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.13it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.24it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.34it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.12it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.20it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.25it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.17it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.20it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.14it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:05,  4.11it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.11it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.12it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.16it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.13it/s][A[INFO|trainer.py:570] 2024-03-23 21:36:34,784 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:36:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:36:34 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:36:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:36:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.13it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.90it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:36:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:36:35 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8535262206148282, 'combined_score': 0.8274984044250612, 'eval_loss': 0.73408794, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [312, 318, 313, 267, 265, 240, 214, 192, 214, 191, 156, 180], 'head_nums': [3, 6, 3, 3, 3, 5, 2, 2, 2, 3, 1, 2], 'pruned_params': 75387448, 'remaining_params': 9630152, 'pruned_model_sparsity': 0.8867275481782596, 'expected_sparsity': 0.88381, 'target_sparsity': 0.95, 'step': 3550}


Iteration:  87%|████████▋ | 100/115 [00:25<00:08,  1.79it/s][A
Iteration:  88%|████████▊ | 101/115 [00:26<00:06,  2.17it/s][A
Iteration:  89%|████████▊ | 102/115 [00:26<00:05,  2.55it/s][A
Iteration:  90%|████████▉ | 103/115 [00:26<00:04,  2.92it/s][A
Iteration:  90%|█████████ | 104/115 [00:26<00:03,  3.20it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  3.50it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:02,  3.54it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:02,  3.62it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:01,  3.79it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  3.91it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  3.95it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:00,  4.01it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.04it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.10it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.40it/s][A03/23/2024 21:36:39 - INFO - trainer.trainer - Epoch 30 finished. Took 29.36 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.92it/s]
Epoch:  31%|███       | 31/100 [15:17<33:59, 29.55s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.16it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.21it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.20it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.15it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.19it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.23it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.24it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.17it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.25it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.24it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.32it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.38it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.37it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.39it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.21it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.20it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.20it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.25it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.34it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.36it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.46it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.42it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.15it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.27it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.20it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:21,  4.07it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.12it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.18it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:20,  4.12it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.18it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.23it/s][A[INFO|trainer.py:570] 2024-03-23 21:36:47,642 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:36:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:36:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:36:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:36:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.26it/s]03/23/2024 21:36:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:36:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8438661710037175, 'combined_score': 0.8189919090312705, 'eval_loss': 0.7029326, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [309, 315, 310, 267, 262, 238, 214, 192, 214, 190, 156, 180], 'head_nums': [3, 6, 3, 3, 3, 5, 2, 2, 2, 3, 1, 2], 'pruned_params': 75647888, 'remaining_params': 9369712, 'pruned_model_sparsity': 0.889790913881361, 'expected_sparsity': 0.88594, 'target_sparsity': 0.95, 'step': 3600}


Iteration:  30%|███       | 35/115 [00:09<00:39,  2.03it/s][A03/23/2024 21:36:48 - INFO - trainer.trainer - v4 Global step: 3600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:09<00:32,  2.41it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:28,  2.77it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:24,  3.13it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:22,  3.44it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:20,  3.68it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:19,  3.87it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:18,  3.94it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.01it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.12it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.18it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.25it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.35it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.35it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.27it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.33it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.29it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:14,  4.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.34it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.30it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.27it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  4.09it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.16it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.36it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.38it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.37it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.21it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:12,  4.20it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.25it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.26it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.24it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.30it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.36it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.37it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.34it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.36it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.29it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.22it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.27it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.18it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.25it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.30it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  4.24it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.31it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.32it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.34it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:00,101 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:00 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.90it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.91it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.22it/s]03/23/2024 21:37:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8524590163934426, 'combined_score': 0.8269648023143683, 'eval_loss': 0.7168057, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [306, 312, 308, 266, 259, 237, 213, 191, 213, 188, 156, 180], 'head_nums': [3, 6, 3, 3, 2, 5, 2, 2, 2, 3, 1, 2], 'pruned_params': 75865432, 'remaining_params': 9152168, 'pruned_model_sparsity': 0.8923497252333634, 'expected_sparsity': 0.88694, 'target_sparsity': 0.95, 'step': 3650}


Iteration:  74%|███████▍  | 85/115 [00:21<00:14,  2.07it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:11,  2.44it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:09,  2.81it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:08,  3.12it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:07,  3.37it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:06,  3.63it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:06,  3.91it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.01it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.04it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:05,  4.20it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.22it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.21it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.25it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.15it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.29it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.29it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.13it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.23it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.29it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.26it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.31it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.27it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.26it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.14it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.12it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.17it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.17it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.26it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.55it/s][A03/23/2024 21:37:07 - INFO - trainer.trainer - Epoch 31 finished. Took 28.55 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.03it/s]
Epoch:  32%|███▏      | 32/100 [15:45<33:09, 29.25s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.09it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.30it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.26it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.31it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.32it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.29it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.29it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.26it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.25it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.23it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.37it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:22,  4.44it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.36it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.41it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.38it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.40it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.37it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:12,567 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:12 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:37:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:13 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8473967684021544, 'combined_score': 0.8195317175344106, 'eval_loss': 0.731301, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [304, 309, 305, 266, 256, 236, 212, 191, 213, 186, 156, 179], 'head_nums': [3, 6, 3, 3, 2, 5, 2, 2, 2, 3, 1, 2], 'pruned_params': 75885348, 'remaining_params': 9132252, 'pruned_model_sparsity': 0.8925839826106594, 'expected_sparsity': 0.88803, 'target_sparsity': 0.95, 'step': 3700}


Iteration:  17%|█▋        | 20/115 [00:05<00:46,  2.06it/s][A03/23/2024 21:37:13 - INFO - trainer.trainer - v4 Global step: 3700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:38,  2.43it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:33,  2.82it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:28,  3.18it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:26,  3.46it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.70it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  3.87it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:21,  4.11it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.17it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.21it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.23it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.39it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.36it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.31it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.21it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.13it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.29it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.33it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.35it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.14it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.18it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.19it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.21it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.27it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.39it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.33it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.17it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.15it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  4.12it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.20it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.27it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.32it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.33it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.28it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.28it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.40it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.25it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.26it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.30it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.23it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.26it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:25,100 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:25 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:25 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:25 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:25 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.92it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:37:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8525179856115108, 'combined_score': 0.8257687967273241, 'eval_loss': 0.766802, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [301, 307, 303, 266, 254, 234, 212, 190, 212, 184, 156, 179], 'head_nums': [3, 6, 3, 3, 2, 5, 2, 2, 2, 3, 1, 2], 'pruned_params': 75905264, 'remaining_params': 9112336, 'pruned_model_sparsity': 0.8928182399879554, 'expected_sparsity': 0.88911, 'target_sparsity': 0.95, 'step': 3750}


Iteration:  61%|██████    | 70/115 [00:18<00:22,  2.04it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:18,  2.42it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:15,  2.84it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:13,  3.18it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:12,  3.40it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:10,  3.69it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:10,  3.86it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.14it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.17it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.22it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.22it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.36it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.36it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.38it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.37it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.31it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.33it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.34it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:05,  4.41it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.47it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.41it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.36it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.17it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.25it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.29it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.12it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.15it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.30it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.31it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.33it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.32it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.35it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.18it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.29it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.31it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.27it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.20it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.19it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.23it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.22it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.28it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.36it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.65it/s][A03/23/2024 21:37:36 - INFO - trainer.trainer - Epoch 32 finished. Took 28.37 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.05it/s]
Epoch:  33%|███▎      | 33/100 [16:13<32:22, 28.99s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:28,  4.01it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:28,  3.91it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.06it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.18it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:37,532 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:37 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:37 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:37 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.84it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.88it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.23it/s]03/23/2024 21:37:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:38 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8088235294117647, 'f1': 0.8560885608856089, 'combined_score': 0.8324560451486869, 'eval_loss': 0.7924464, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [298, 304, 300, 266, 252, 233, 211, 190, 212, 183, 156, 179], 'head_nums': [3, 6, 3, 3, 2, 5, 2, 2, 2, 3, 1, 2], 'pruned_params': 75923648, 'remaining_params': 9093952, 'pruned_model_sparsity': 0.8930344775669979, 'expected_sparsity': 0.89018, 'target_sparsity': 0.95, 'step': 3800}


Iteration:   4%|▍         | 5/115 [00:02<01:00,  1.82it/s][A03/23/2024 21:37:38 - INFO - trainer.trainer - v4 Global step: 3800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:48,  2.26it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.70it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.08it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.39it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:28,  3.66it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:26,  3.88it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:25,  3.99it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  4.05it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:24,  4.07it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:24,  4.11it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:23,  4.17it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.24it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:22,  4.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.30it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.36it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.25it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.29it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.36it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.39it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.28it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.28it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.35it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.33it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.33it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.32it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:19,  4.24it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.27it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:18,  4.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.31it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.32it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.35it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.47it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:16,  4.41it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.41it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.42it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.47it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:15,  4.50it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.45it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.22it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.28it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.36it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.32it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.38it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.33it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.22it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.31it/s][A[INFO|trainer.py:570] 2024-03-23 21:37:49,946 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:37:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:37:49 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:37:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:37:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.23it/s]03/23/2024 21:37:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:37:50 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7696078431372549, 'f1': 0.8206106870229007, 'combined_score': 0.7951092650800778, 'eval_loss': 0.8590277, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [296, 301, 298, 265, 250, 232, 211, 190, 212, 181, 156, 179], 'head_nums': [3, 6, 3, 3, 2, 5, 2, 2, 2, 2, 1, 2], 'pruned_params': 76135064, 'remaining_params': 8882536, 'pruned_model_sparsity': 0.8955212097259861, 'expected_sparsity': 0.89137, 'target_sparsity': 0.95, 'step': 3850}


Iteration:  48%|████▊     | 55/115 [00:14<00:29,  2.03it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:24,  2.39it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:20,  2.79it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:18,  3.11it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:16,  3.41it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:15,  3.66it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:14,  3.81it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:13,  3.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.06it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.10it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.21it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:11,  4.34it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.35it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:10,  4.35it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.21it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.23it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.33it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.28it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.29it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.28it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.32it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.25it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.27it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.22it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.27it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.25it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.24it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.21it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.35it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.30it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:05,  4.43it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.35it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.38it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.41it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.35it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.35it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.32it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.43it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.31it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.30it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.33it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.33it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.10it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.19it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:02,442 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:02 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:02 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:02 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:02 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.89it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.22it/s]03/23/2024 21:38:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:03 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.855595667870036, 'combined_score': 0.8297586182487435, 'eval_loss': 0.787292, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [293, 299, 296, 265, 248, 232, 210, 189, 212, 180, 156, 179], 'head_nums': [3, 6, 3, 3, 2, 5, 2, 2, 2, 2, 1, 2], 'pruned_params': 76150384, 'remaining_params': 8867216, 'pruned_model_sparsity': 0.8957014077085216, 'expected_sparsity': 0.89192, 'target_sparsity': 0.95, 'step': 3900}


Iteration:  91%|█████████▏| 105/115 [00:26<00:04,  2.01it/s][A03/23/2024 21:38:03 - INFO - trainer.trainer - v4 Global step: 3900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:27<00:03,  2.41it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:02,  2.74it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:02,  3.07it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  3.38it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  3.56it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:01,  3.76it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  3.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.02it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.13it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.43it/s][A03/23/2024 21:38:05 - INFO - trainer.trainer - Epoch 33 finished. Took 29.27 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.93it/s]
Epoch:  34%|███▍      | 34/100 [16:43<31:58, 29.07s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.48it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.26it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.43it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.53it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.44it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.41it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.31it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.28it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.31it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.33it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.35it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.47it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.29it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.35it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.37it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.31it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.30it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.26it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.25it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.39it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.30it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.38it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.42it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.41it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.36it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.34it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.39it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.33it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.30it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.39it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.35it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.32it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.35it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.36it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.33it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.35it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:17,  4.36it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:14,795 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:14 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:14 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:14 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:14 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.95it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.26it/s]03/23/2024 21:38:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:15 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8112745098039216, 'f1': 0.8679245283018869, 'combined_score': 0.8395995190529042, 'eval_loss': 0.7842688, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [291, 297, 294, 265, 246, 231, 209, 189, 212, 178, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 5, 2, 2, 2, 2, 1, 2], 'pruned_params': 76361800, 'remaining_params': 8655800, 'pruned_model_sparsity': 0.8981881398675098, 'expected_sparsity': 0.89227, 'target_sparsity': 0.95, 'step': 3950}


Iteration:  35%|███▍      | 40/115 [00:10<00:36,  2.04it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:30,  2.40it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:26,  2.78it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:23,  3.10it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.42it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:19,  3.52it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:18,  3.70it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:17,  3.97it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:16,  4.07it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  4.07it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.15it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.27it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.31it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.37it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.38it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.24it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.20it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.15it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.23it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.26it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.29it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:12,  4.13it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.18it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.25it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.37it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.37it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.32it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.35it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.40it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.46it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.31it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.28it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.26it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.28it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.31it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.45it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.38it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.41it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.27it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.34it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.27it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.38it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.39it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.32it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.33it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:27,270 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:27 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:38:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:28 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8365019011406845, 'combined_score': 0.8128587937075971, 'eval_loss': 0.84360623, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [288, 295, 292, 264, 244, 230, 208, 188, 211, 177, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 5, 2, 2, 2, 2, 1, 2], 'pruned_params': 76380184, 'remaining_params': 8637416, 'pruned_model_sparsity': 0.8984043774465522, 'expected_sparsity': 0.89262, 'target_sparsity': 0.95, 'step': 4000}


Iteration:  78%|███████▊  | 90/115 [00:22<00:12,  2.04it/s][A03/23/2024 21:38:28 - INFO - trainer.trainer - v4 Global step: 4000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:22<00:09,  2.43it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:08,  2.81it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:07,  3.06it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:06,  3.35it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:05,  3.54it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:05,  3.69it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  3.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  3.85it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:04,  3.95it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.02it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.12it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.12it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.00it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.15it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.27it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.26it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.30it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.34it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.38it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.39it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.51it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.48it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.55it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.78it/s][A03/23/2024 21:38:33 - INFO - trainer.trainer - Epoch 34 finished. Took 28.33 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.06it/s]
Epoch:  35%|███▌      | 35/100 [17:11<31:15, 28.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.40it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.39it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.31it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.31it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.45it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.27it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.32it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.46it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.36it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.36it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.41it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.40it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.32it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.30it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.32it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.34it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.44it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.41it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.38it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.39it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.42it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.36it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.47it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:39,637 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:39 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.90it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.22it/s]03/23/2024 21:38:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:40 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8551483420593368, 'combined_score': 0.8258584847551586, 'eval_loss': 0.7816511, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [286, 293, 290, 264, 242, 229, 208, 188, 211, 176, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 5, 2, 2, 2, 2, 1, 2], 'pruned_params': 76393972, 'remaining_params': 8623628, 'pruned_model_sparsity': 0.8985665556308341, 'expected_sparsity': 0.89341, 'target_sparsity': 0.95, 'step': 4050}


Iteration:  22%|██▏       | 25/115 [00:06<00:44,  2.04it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:36,  2.43it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:31,  2.77it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:27,  3.15it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:25,  3.43it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:23,  3.67it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.85it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.01it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.14it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.14it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.18it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.30it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.35it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.35it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.37it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.36it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.28it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.40it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.41it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.33it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.45it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.37it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.35it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.43it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.36it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.37it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.24it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.29it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.37it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.26it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  4.12it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.08it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:14,  4.00it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:13,  4.13it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:13,  4.14it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.14it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.21it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.28it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.29it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.26it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.28it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.25it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.38it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.39it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.38it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.37it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.36it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.48it/s][A[INFO|trainer.py:570] 2024-03-23 21:38:52,082 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:38:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:38:52 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:38:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:38:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.94it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:38:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:38:52 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8551724137931033, 'combined_score': 0.8246450304259634, 'eval_loss': 0.80417544, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [283, 291, 288, 264, 240, 228, 207, 187, 211, 174, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 5, 2, 2, 2, 2, 1, 2], 'pruned_params': 76410824, 'remaining_params': 8606776, 'pruned_model_sparsity': 0.898764773411623, 'expected_sparsity': 0.89456, 'target_sparsity': 0.95, 'step': 4100}


Iteration:  65%|██████▌   | 75/115 [00:19<00:19,  2.08it/s][A03/23/2024 21:38:53 - INFO - trainer.trainer - v4 Global step: 4100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:19<00:15,  2.47it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:13,  2.75it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:12,  3.04it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:09,  3.62it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:09,  3.74it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  3.88it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.02it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.21it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.21it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.21it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.21it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.29it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.33it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.29it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.25it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.22it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.28it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.21it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.20it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.24it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.26it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.15it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.16it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.18it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.39it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.38it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.45it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.42it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.36it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.43it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.36it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.32it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.35it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.33it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.59it/s][A03/23/2024 21:39:02 - INFO - trainer.trainer - Epoch 35 finished. Took 28.31 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.06it/s]
Epoch:  36%|███▌      | 36/100 [17:39<30:36, 28.69s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.28it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.21it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.32it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.37it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.39it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.37it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.38it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.36it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.36it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:04,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:04 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.90it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.94it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.23it/s]03/23/2024 21:39:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:05 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8617886178861789, 'combined_score': 0.8267276422764227, 'eval_loss': 0.892852, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [281, 289, 286, 263, 239, 227, 206, 187, 210, 173, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76620708, 'remaining_params': 8396892, 'pruned_model_sparsity': 0.9012334857723577, 'expected_sparsity': 0.89498, 'target_sparsity': 0.95, 'step': 4150}


Iteration:   9%|▊         | 10/115 [00:03<00:51,  2.03it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:42,  2.43it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:36,  2.80it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:32,  3.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:29,  3.38it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:27,  3.61it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:27,  3.65it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:25,  3.87it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:24,  3.88it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:23,  4.03it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:23,  4.06it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.10it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:22,  4.10it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.17it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.23it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.26it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.35it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.35it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.38it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.47it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:18,  4.44it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.48it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.38it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.29it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.24it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.23it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.18it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.25it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.28it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.29it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.35it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.29it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.29it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.33it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.38it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.22it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.21it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.29it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.30it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.30it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.12it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.22it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.28it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.17it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:17,083 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:17 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.23it/s]03/23/2024 21:39:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:17 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8586206896551725, 'combined_score': 0.8288201487491549, 'eval_loss': 0.83063656, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [280, 287, 284, 263, 237, 226, 206, 186, 210, 172, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76634496, 'remaining_params': 8383104, 'pruned_model_sparsity': 0.9013956639566396, 'expected_sparsity': 0.89522, 'target_sparsity': 0.95, 'step': 4200}


Iteration:  52%|█████▏    | 60/115 [00:15<00:26,  2.05it/s][A03/23/2024 21:39:18 - INFO - trainer.trainer - v4 Global step: 4200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:15<00:22,  2.45it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:18,  2.82it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:16,  3.12it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:15,  3.38it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.60it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:12,  3.81it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:12,  3.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.04it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.09it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:10,  4.25it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.35it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:09,  4.39it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.37it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.40it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.41it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:08,  4.40it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.44it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.36it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.46it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:07,  4.38it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.33it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.44it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.43it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.29it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.34it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.26it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.23it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.24it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.20it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.23it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.23it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.22it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.24it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.35it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.37it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.41it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.45it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.46it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.37it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.33it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.15it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.27it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.31it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.28it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.23it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:29,466 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:29 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.26it/s]03/23/2024 21:39:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8644939965694681, 'combined_score': 0.8354332727945379, 'eval_loss': 0.8544352, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [278, 286, 282, 263, 236, 225, 205, 186, 210, 171, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76645220, 'remaining_params': 8372380, 'pruned_model_sparsity': 0.9015218025444144, 'expected_sparsity': 0.89541, 'target_sparsity': 0.95, 'step': 4250}


Iteration:  96%|█████████▌| 110/115 [00:28<00:02,  2.05it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:01,  2.41it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:01,  2.81it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  3.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  3.31it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.75it/s][A03/23/2024 21:39:31 - INFO - trainer.trainer - Epoch 36 finished. Took 29.23 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.93it/s]
Epoch:  37%|███▋      | 37/100 [18:09<30:17, 28.85s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.43it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.42it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.36it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.50it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.43it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.40it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.45it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.33it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.41it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.42it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.36it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.30it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.30it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.24it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.21it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.29it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.29it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.18it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:22,  4.18it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.19it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.24it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.31it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.29it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.35it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.31it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:20,  4.30it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.35it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.31it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.27it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.29it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.24it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  4.05it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.13it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:18,  4.14it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.15it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.23it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.29it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.32it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.35it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:41,921 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:41 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.91it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:39:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:42 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8088235294117647, 'f1': 0.8571428571428572, 'combined_score': 0.832983193277311, 'eval_loss': 0.8813193, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [277, 284, 280, 262, 235, 224, 204, 185, 210, 170, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76657476, 'remaining_params': 8360124, 'pruned_model_sparsity': 0.9016659609304426, 'expected_sparsity': 0.8956, 'target_sparsity': 0.95, 'step': 4300}


Iteration:  39%|███▉      | 45/115 [00:11<00:33,  2.08it/s][A03/23/2024 21:39:42 - INFO - trainer.trainer - v4 Global step: 4300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:11<00:28,  2.45it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:24,  2.82it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:21,  3.17it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:19,  3.45it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:17,  3.72it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.89it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.08it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.17it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.30it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.32it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.33it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.28it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.25it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.30it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.27it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.31it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.34it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.27it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.34it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.34it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.46it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.31it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.17it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.23it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.25it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.28it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.28it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.26it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.26it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.34it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.20it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  4.20it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.29it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.33it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  4.16it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.21it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.27it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.28it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.39it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.29it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.25it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.29it/s][A[INFO|trainer.py:570] 2024-03-23 21:39:54,393 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:39:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:39:54 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:39:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:39:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.26it/s]03/23/2024 21:39:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:39:55 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8455882352941178, 'combined_score': 0.8198529411764706, 'eval_loss': 0.8699086, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [276, 282, 279, 262, 234, 223, 204, 185, 209, 169, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76668200, 'remaining_params': 8349400, 'pruned_model_sparsity': 0.9017920995182174, 'expected_sparsity': 0.89579, 'target_sparsity': 0.95, 'step': 4350}


Iteration:  83%|████████▎ | 95/115 [00:23<00:09,  2.03it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:07,  2.40it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:06,  2.82it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:05,  3.16it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:04,  3.45it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  3.75it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  3.92it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.05it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.16it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.31it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.32it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.32it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.41it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.43it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.38it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.30it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.17it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.05it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.05it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.38it/s][A03/23/2024 21:39:59 - INFO - trainer.trainer - Epoch 37 finished. Took 28.35 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.06it/s]
Epoch:  38%|███▊      | 38/100 [18:37<29:39, 28.70s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.37it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.49it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.28it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.33it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.33it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.26it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.22it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:26,  4.11it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.20it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.19it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.15it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.17it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.31it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.32it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.35it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.36it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.35it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.16it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.23it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.23it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.28it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.22it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.26it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.26it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.27it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.31it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.33it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.37it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:06,848 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:06 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.89it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.92it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:40:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:07 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.86013986013986, 'combined_score': 0.8320307143836555, 'eval_loss': 0.82086766, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [275, 281, 277, 261, 233, 222, 203, 185, 209, 168, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76677392, 'remaining_params': 8340208, 'pruned_model_sparsity': 0.9019002183077386, 'expected_sparsity': 0.896, 'target_sparsity': 0.95, 'step': 4400}


Iteration:  26%|██▌       | 30/115 [00:07<00:41,  2.04it/s][A03/23/2024 21:40:07 - INFO - trainer.trainer - v4 Global step: 4400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:08<00:35,  2.40it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:30,  2.77it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:26,  3.09it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:23,  3.39it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:22,  3.63it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:20,  3.88it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:19,  3.98it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.01it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.04it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  4.08it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.15it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.20it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.28it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.31it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.35it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.33it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.36it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.47it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:14,  4.31it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.33it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.36it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.35it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.35it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.46it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:12,  4.43it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:13,  4.23it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.31it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.30it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.42it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.33it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.33it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.28it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.26it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.26it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.25it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.31it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.11it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:10,  4.10it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.19it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.20it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:09,  4.21it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.26it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.32it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:19,365 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:19 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.92it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:40:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8161764705882353, 'f1': 0.8691099476439791, 'combined_score': 0.8426432091161071, 'eval_loss': 0.8032843, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [274, 279, 275, 261, 232, 221, 202, 185, 209, 167, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76688116, 'remaining_params': 8329484, 'pruned_model_sparsity': 0.9020263568955134, 'expected_sparsity': 0.89638, 'target_sparsity': 0.95, 'step': 4450}


Iteration:  70%|██████▉   | 80/115 [00:20<00:17,  2.03it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:14,  2.42it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:11,  2.78it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:10,  3.13it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:09,  3.38it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:08,  3.59it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  3.68it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:07,  3.87it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  3.96it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.06it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:06,  4.16it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.31it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.25it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.24it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.24it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.36it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.34it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.32it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:03,  4.33it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.36it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.33it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.37it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.46it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.51it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.42it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.33it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.35it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.46it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.38it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.34it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.29it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.34it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.33it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.62it/s][A03/23/2024 21:40:28 - INFO - trainer.trainer - Epoch 38 finished. Took 28.44 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.04it/s]
Epoch:  39%|███▉      | 39/100 [19:05<29:06, 28.62s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.39it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.30it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.26it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.33it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.36it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.38it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.14it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.20it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.26it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.31it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.26it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.28it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.29it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.32it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:31,750 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:31 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.23it/s]03/23/2024 21:40:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8556521739130434, 'combined_score': 0.8261104006820119, 'eval_loss': 0.8374519, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [273, 278, 273, 260, 231, 221, 201, 184, 209, 166, 156, 178], 'head_nums': [3, 6, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76697308, 'remaining_params': 8320292, 'pruned_model_sparsity': 0.9021344756850346, 'expected_sparsity': 0.89744, 'target_sparsity': 0.95, 'step': 4500}


Iteration:  13%|█▎        | 15/115 [00:04<00:48,  2.04it/s][A03/23/2024 21:40:32 - INFO - trainer.trainer - v4 Global step: 4500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:40,  2.42it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:34,  2.81it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.36it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:26,  3.55it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:26,  3.61it/s][A
Iteration:  19%|█▉        | 22/115 [00:06<00:24,  3.77it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:23,  3.92it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:22,  4.03it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.13it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.21it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.23it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.15it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.21it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.15it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:20,  4.16it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.20it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.28it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.28it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:18,  4.31it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.21it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.32it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.30it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:18,  4.13it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:18,  4.05it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  4.08it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.16it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:17,  4.19it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.21it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.22it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.27it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.37it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.35it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:14,  4.46it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.49it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.56it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:14,  4.45it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:13,  4.43it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.37it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.34it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.33it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.41it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.42it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.33it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.35it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.36it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.48it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.37it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:44,278 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.91it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:40:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8482632541133455, 'combined_score': 0.822415940782163, 'eval_loss': 0.8225192, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [272, 277, 271, 260, 230, 220, 201, 184, 208, 165, 156, 178], 'head_nums': [3, 5, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76904128, 'remaining_params': 8113472, 'pruned_model_sparsity': 0.9045671484492622, 'expected_sparsity': 0.89882, 'target_sparsity': 0.95, 'step': 4550}


Iteration:  57%|█████▋    | 65/115 [00:16<00:24,  2.05it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:20,  2.43it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:17,  2.80it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:14,  3.18it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:13,  3.48it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:12,  3.65it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:11,  3.85it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  3.98it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.11it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.12it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.19it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.27it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.22it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.22it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.29it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.33it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.27it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.38it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.38it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.34it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.36it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.28it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.22it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.32it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.35it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.24it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.25it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.11it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.27it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.33it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.35it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.33it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.39it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.29it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.26it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.35it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.37it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.32it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.30it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.26it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.29it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.37it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.35it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.40it/s][A[INFO|trainer.py:570] 2024-03-23 21:40:56,669 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:40:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:40:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:40:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:40:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.92it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:40:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:40:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8490230905861456, 'combined_score': 0.820344878626406, 'eval_loss': 0.83564925, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [271, 276, 270, 259, 229, 219, 200, 184, 208, 164, 156, 178], 'head_nums': [3, 5, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76911788, 'remaining_params': 8105812, 'pruned_model_sparsity': 0.90465724744053, 'expected_sparsity': 0.9003, 'target_sparsity': 0.95, 'step': 4600}


Iteration: 100%|██████████| 115/115 [00:29<00:00,  2.11it/s][A03/23/2024 21:40:57 - INFO - trainer.trainer - Epoch 39 finished. Took 29.27 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.93it/s]
Epoch:  40%|████      | 40/100 [19:35<28:49, 28.82s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:40:57 - INFO - trainer.trainer - v4 Global step: 4600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:26,  4.29it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.20it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:28,  3.89it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.07it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.19it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.34it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.30it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.17it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.24it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.28it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.25it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.30it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.28it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.28it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.13it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.10it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:23,  4.17it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.24it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.36it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.38it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.38it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.35it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.29it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.27it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.29it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.32it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.33it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.30it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.28it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.36it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.26it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.31it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.32it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.39it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.40it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:18,  4.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.34it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.34it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.36it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.37it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.39it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.38it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.41it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.33it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.34it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.35it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.33it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:09,175 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.95it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.28it/s]03/23/2024 21:41:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.863013698630137, 'combined_score': 0.8334676336287941, 'eval_loss': 0.86477035, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [270, 275, 268, 259, 228, 219, 199, 183, 208, 163, 156, 178], 'head_nums': [3, 5, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76920980, 'remaining_params': 8096620, 'pruned_model_sparsity': 0.9047653662300512, 'expected_sparsity': 0.90164, 'target_sparsity': 0.95, 'step': 4650}


Iteration:  43%|████▎     | 50/115 [00:12<00:31,  2.06it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:26,  2.45it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:22,  2.83it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:19,  3.15it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:18,  3.32it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:16,  3.66it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:15,  3.88it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  4.02it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.29it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.35it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.38it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.42it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.50it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.40it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.30it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.32it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.34it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.35it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.36it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.35it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.29it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.34it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.31it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.30it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.26it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.17it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.28it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.25it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.30it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.27it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.30it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.41it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.27it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.32it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.34it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.26it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.32it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.25it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.22it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.19it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.27it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.25it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.10it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.21it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.16it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:21,638 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.92it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:41:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8576576576576576, 'combined_score': 0.8320151033386327, 'eval_loss': 0.7767113, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [269, 274, 267, 258, 227, 218, 199, 183, 208, 163, 156, 178], 'head_nums': [3, 5, 2, 3, 2, 4, 2, 2, 2, 2, 1, 2], 'pruned_params': 76928640, 'remaining_params': 8088960, 'pruned_model_sparsity': 0.9048554652213189, 'expected_sparsity': 0.90271, 'target_sparsity': 0.95, 'step': 4700}


Iteration:  87%|████████▋ | 100/115 [00:24<00:07,  2.01it/s][A03/23/2024 21:41:22 - INFO - trainer.trainer - v4 Global step: 4700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:25<00:05,  2.36it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:04,  2.77it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:03,  3.10it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:03,  3.35it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  3.62it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  3.87it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  3.94it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.07it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.12it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.13it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.13it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.15it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.21it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.23it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.50it/s][A03/23/2024 21:41:25 - INFO - trainer.trainer - Epoch 40 finished. Took 28.43 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.05it/s]
Epoch:  41%|████      | 41/100 [20:03<28:13, 28.70s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.16it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.28it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.34it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.23it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.29it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.20it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.30it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.19it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.30it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.34it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.38it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.29it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.32it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.32it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.41it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.41it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.33it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.28it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.20it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.22it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.35it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.35it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.31it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.31it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.36it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.35it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.37it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.33it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:20,  4.19it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.19it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.29it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.32it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:34,077 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:34 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.95it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:41:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8576512455516014, 'combined_score': 0.8307864070895262, 'eval_loss': 0.7776962, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [268, 272, 266, 258, 226, 218, 198, 183, 208, 162, 156, 178], 'head_nums': [3, 5, 2, 3, 2, 4, 2, 2, 2, 2, 1, 1], 'pruned_params': 76936300, 'remaining_params': 8081300, 'pruned_model_sparsity': 0.9049455642125865, 'expected_sparsity': 0.9032, 'target_sparsity': 0.95, 'step': 4750}


Iteration:  30%|███       | 35/115 [00:08<00:38,  2.07it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:32,  2.45it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:27,  2.80it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:24,  3.14it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:22,  3.38it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:20,  3.60it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:19,  3.81it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:18,  3.99it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.11it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:17,  4.16it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:17,  4.03it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.07it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.15it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.29it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.26it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.28it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.25it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.25it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.33it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.26it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.28it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.29it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.28it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.29it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.32it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.34it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.37it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.37it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.32it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.31it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.27it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.27it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.26it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.27it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.27it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:10,  4.15it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.36it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.42it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.44it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.44it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.43it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.39it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.40it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.35it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.16it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.19it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:46,587 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:46 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:41:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8530973451327434, 'combined_score': 0.8248329862918619, 'eval_loss': 0.81277007, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [268, 271, 265, 257, 226, 218, 197, 182, 208, 161, 156, 178], 'head_nums': [2, 5, 2, 3, 2, 4, 2, 2, 2, 2, 1, 1], 'pruned_params': 77136992, 'remaining_params': 7880608, 'pruned_model_sparsity': 0.9073061577838001, 'expected_sparsity': 0.90379, 'target_sparsity': 0.95, 'step': 4800}


Iteration:  74%|███████▍  | 85/115 [00:21<00:14,  2.02it/s][A03/23/2024 21:41:47 - INFO - trainer.trainer - v4 Global step: 4800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:21<00:12,  2.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:10,  2.75it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:08,  3.07it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:07,  3.38it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:06,  3.60it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:06,  3.77it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  3.93it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.09it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:05,  4.13it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.25it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.26it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.35it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.41it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.42it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.39it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.32it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.36it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.36it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.35it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.41it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.35it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.39it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.11it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.09it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.05it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.01it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.10it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.14it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.41it/s][A03/23/2024 21:41:54 - INFO - trainer.trainer - Epoch 41 finished. Took 28.46 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.04it/s]
Epoch:  42%|████▏     | 42/100 [20:32<27:40, 28.63s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.67it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.60it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.48it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.42it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.31it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.34it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.36it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.31it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.34it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.29it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.27it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.31it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.30it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.44it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.42it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.39it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.39it/s][A[INFO|trainer.py:570] 2024-03-23 21:41:58,984 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:41:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:41:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:41:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:41:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.22it/s]03/23/2024 21:41:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:41:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7671568627450981, 'f1': 0.8155339805825241, 'combined_score': 0.7913454216638112, 'eval_loss': 0.85655123, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [267, 270, 263, 257, 225, 217, 196, 182, 207, 161, 156, 178], 'head_nums': [2, 5, 2, 3, 2, 4, 2, 2, 2, 2, 1, 1], 'pruned_params': 77147716, 'remaining_params': 7869884, 'pruned_model_sparsity': 0.9074322963715749, 'expected_sparsity': 0.90551, 'target_sparsity': 0.95, 'step': 4850}


Iteration:  17%|█▋        | 20/115 [00:05<00:45,  2.07it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:38,  2.44it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:32,  2.83it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:28,  3.18it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:26,  3.44it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.63it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:23,  3.80it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.15it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.17it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.18it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.16it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.09it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.22it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.06it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:19,  4.16it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.20it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.26it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.20it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.22it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.21it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.22it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.23it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.23it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.24it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.23it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.15it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.32it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.26it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.30it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.39it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.45it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:13,  4.53it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.44it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.43it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.29it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.34it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:12,  4.40it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.46it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.38it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.27it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.22it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.28it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.40it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.31it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.33it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.42it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.35it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.28it/s][A[INFO|trainer.py:570] 2024-03-23 21:42:11,472 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:42:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:42:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:42:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:42:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.94it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:42:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:42:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8478260869565217, 'combined_score': 0.8209718670076727, 'eval_loss': 0.83748764, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [266, 269, 262, 256, 225, 217, 196, 182, 207, 160, 156, 178], 'head_nums': [2, 5, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77348408, 'remaining_params': 7669192, 'pruned_model_sparsity': 0.9097928899427883, 'expected_sparsity': 0.90706, 'target_sparsity': 0.95, 'step': 4900}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.05it/s][A03/23/2024 21:42:12 - INFO - trainer.trainer - v4 Global step: 4900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:18<00:18,  2.44it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:15,  2.75it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:13,  3.09it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:12,  3.33it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:11,  3.57it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:10,  3.79it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  3.96it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:09,  4.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.20it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.25it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.27it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.12it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.29it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.32it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.27it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  4.14it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.20it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:05,  4.37it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.48it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.46it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.45it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.39it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.38it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.43it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.44it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.44it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.48it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.43it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.24it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.19it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.25it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.31it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.29it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.36it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.38it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.29it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.30it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.33it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.39it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.36it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.31it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.56it/s][A03/23/2024 21:42:22 - INFO - trainer.trainer - Epoch 42 finished. Took 28.27 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.07it/s]
Epoch:  43%|████▎     | 43/100 [21:00<27:05, 28.52s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.25it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.29it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.24it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.25it/s][A[INFO|trainer.py:570] 2024-03-23 21:42:23,866 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:42:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:42:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:42:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:42:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.90it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.22it/s]03/23/2024 21:42:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:42:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8605851979345955, 'combined_score': 0.8310278930849448, 'eval_loss': 0.7985979, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [265, 268, 260, 255, 224, 216, 195, 181, 207, 160, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77555228, 'remaining_params': 7462372, 'pruned_model_sparsity': 0.9122255627070159, 'expected_sparsity': 0.90763, 'target_sparsity': 0.95, 'step': 4950}


Iteration:   4%|▍         | 5/115 [00:02<00:59,  1.84it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:47,  2.29it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.73it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.03it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.33it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:29,  3.57it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:27,  3.77it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:26,  3.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.15it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:23,  4.25it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:23,  4.28it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:23,  4.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:22,  4.27it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:22,  4.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:23,  4.10it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.19it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.24it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.26it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.35it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.27it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.31it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.35it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.31it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.34it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.31it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.35it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:19,  4.33it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.35it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.37it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.39it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.33it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.31it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.28it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.31it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.38it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.26it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.38it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.50it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:15,  4.54it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.53it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.45it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.55it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.46it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.46it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.29it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.23it/s][A[INFO|trainer.py:570] 2024-03-23 21:42:36,231 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:42:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:42:36 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:42:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:42:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:42:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:42:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.853195164075993, 'combined_score': 0.8224309153713298, 'eval_loss': 0.8082944, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [264, 267, 259, 255, 223, 216, 194, 181, 207, 159, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77561356, 'remaining_params': 7456244, 'pruned_model_sparsity': 0.9122976419000302, 'expected_sparsity': 0.90789, 'target_sparsity': 0.95, 'step': 5000}


Iteration:  48%|████▊     | 55/115 [00:14<00:29,  2.02it/s][A03/23/2024 21:42:37 - INFO - trainer.trainer - v4 Global step: 5000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:14<00:24,  2.36it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:21,  2.74it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:18,  3.09it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:16,  3.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:15,  3.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:14,  3.81it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:13,  3.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.11it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.19it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.28it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.27it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.25it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:10,  4.38it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.32it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.29it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:09,  4.34it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.44it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.50it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.39it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.27it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.24it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.11it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.19it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.08it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.11it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.16it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.20it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.16it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.19it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.25it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.28it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.30it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.29it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.27it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.11it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.19it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.24it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.27it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.09it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.09it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.18it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.24it/s][A[INFO|trainer.py:570] 2024-03-23 21:42:48,843 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:42:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:42:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:42:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:42:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.89it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.89it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.21it/s]03/23/2024 21:42:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:42:49 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.854054054054054, 'combined_score': 0.8277623211446741, 'eval_loss': 0.8309685, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [263, 266, 258, 254, 223, 215, 194, 181, 207, 158, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77567484, 'remaining_params': 7450116, 'pruned_model_sparsity': 0.9123697210930443, 'expected_sparsity': 0.90815, 'target_sparsity': 0.95, 'step': 5050}


Iteration:  91%|█████████▏| 105/115 [00:27<00:04,  2.02it/s][A
Iteration:  92%|█████████▏| 106/115 [00:27<00:03,  2.40it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:02,  2.79it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:02,  3.18it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  3.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:28<00:01,  3.75it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:01,  3.88it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  3.98it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.10it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  4.19it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  4.46it/s][A03/23/2024 21:42:51 - INFO - trainer.trainer - Epoch 43 finished. Took 29.24 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.93it/s]
Epoch:  44%|████▍     | 44/100 [21:29<26:49, 28.74s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.24it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.29it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.27it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.28it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.26it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.30it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.31it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.41it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.40it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.33it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.36it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.31it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.38it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.32it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.33it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.29it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.22it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.21it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.27it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.40it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.27it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.29it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.29it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.26it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.40it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.46it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.34it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.27it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.24it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.28it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.24it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.27it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.31it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.33it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.35it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.28it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.31it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:01,224 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:01 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:43:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8417132216014896, 'combined_score': 0.8166899441340781, 'eval_loss': 0.8199123, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [263, 266, 256, 253, 222, 215, 193, 181, 207, 158, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77572080, 'remaining_params': 7445520, 'pruned_model_sparsity': 0.9124237804878049, 'expected_sparsity': 0.90876, 'target_sparsity': 0.95, 'step': 5100}


Iteration:  35%|███▍      | 40/115 [00:10<00:36,  2.04it/s][A03/23/2024 21:43:02 - INFO - trainer.trainer - v4 Global step: 5100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:10<00:31,  2.38it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:26,  2.73it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:23,  3.09it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:20,  3.41it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:19,  3.63it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:17,  3.90it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.12it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.20it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.26it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.23it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.27it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.23it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.35it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.34it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:12,  4.42it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.28it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.26it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.30it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.31it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:12,  4.16it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.23it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.29it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.29it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.32it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.30it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.28it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.21it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.27it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.36it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.13it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.16it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.23it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.26it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.30it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  4.08it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.21it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.22it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.21it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  4.23it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.49it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.40it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.31it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:13,725 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.92it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:43:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8556338028169014, 'combined_score': 0.8273267053300193, 'eval_loss': 0.8453935, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [262, 265, 255, 253, 222, 215, 192, 181, 207, 157, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77576676, 'remaining_params': 7440924, 'pruned_model_sparsity': 0.9124778398825655, 'expected_sparsity': 0.90992, 'target_sparsity': 0.95, 'step': 5150}


Iteration:  78%|███████▊  | 90/115 [00:22<00:12,  2.04it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:09,  2.43it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:08,  2.75it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:07,  2.98it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:06,  3.34it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:05,  3.61it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:05,  3.80it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  3.98it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.18it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.22it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.25it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.28it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.36it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.44it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.40it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.40it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.40it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.32it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.39it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.40it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.38it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.36it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.31it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.65it/s][A03/23/2024 21:43:20 - INFO - trainer.trainer - Epoch 44 finished. Took 28.37 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.05it/s]
Epoch:  45%|████▌     | 45/100 [21:57<26:14, 28.63s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.18it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.30it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.20it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.21it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.17it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.25it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.22it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.37it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.12it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.15it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.32it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.31it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.36it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.43it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.25it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:24,  4.08it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.22it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.22it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.27it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:22,  4.09it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.12it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.15it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.22it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:26,225 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:26 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.89it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.95it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:43:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:27 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8581560283687943, 'combined_score': 0.8310387984981227, 'eval_loss': 0.81330854, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [261, 264, 254, 252, 221, 214, 191, 181, 207, 157, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77584336, 'remaining_params': 7433264, 'pruned_model_sparsity': 0.9125679388738331, 'expected_sparsity': 0.91031, 'target_sparsity': 0.95, 'step': 5200}


Iteration:  22%|██▏       | 25/115 [00:06<00:44,  2.01it/s][A03/23/2024 21:43:27 - INFO - trainer.trainer - v4 Global step: 5200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:07<00:37,  2.38it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:32,  2.71it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:28,  3.02it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:25,  3.32it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:24,  3.53it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:22,  3.72it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:21,  3.84it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:20,  3.98it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.07it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:19,  4.18it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.24it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.30it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.29it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:17,  4.26it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.30it/s][A
Iteration:  37%|███▋      | 43/115 [00:11<00:16,  4.32it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.34it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.31it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.40it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.41it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.41it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:14,  4.44it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.47it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.42it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:14,  4.42it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.28it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.34it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.33it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.30it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.31it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.28it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.40it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.40it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.34it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:11,  4.44it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.43it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.34it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.34it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.46it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.52it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.47it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.45it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.39it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.40it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.41it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:38,593 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:38 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.95it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.27it/s]03/23/2024 21:43:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:39 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8137254901960784, 'f1': 0.8698630136986301, 'combined_score': 0.8417942519473542, 'eval_loss': 0.82331234, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [260, 263, 253, 252, 221, 214, 191, 181, 207, 156, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77588932, 'remaining_params': 7428668, 'pruned_model_sparsity': 0.9126219982685938, 'expected_sparsity': 0.91047, 'target_sparsity': 0.95, 'step': 5250}


Iteration:  65%|██████▌   | 75/115 [00:19<00:19,  2.05it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:16,  2.41it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:13,  2.79it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:11,  3.09it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:10,  3.39it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:09,  3.64it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:09,  3.76it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  3.93it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.03it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.17it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.23it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.28it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.25it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.24it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.33it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.43it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.22it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.25it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.28it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.25it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.27it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.26it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.27it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.29it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.38it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.21it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.35it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.31it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.34it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.36it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.44it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.41it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.39it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.41it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.34it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.30it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.33it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.34it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.60it/s][A03/23/2024 21:43:48 - INFO - trainer.trainer - Epoch 45 finished. Took 28.37 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.05it/s]
Epoch:  46%|████▌     | 46/100 [22:26<25:41, 28.55s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.38it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.42it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.38it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.29it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.10it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.12it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.25it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.25it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.24it/s][A[INFO|trainer.py:570] 2024-03-23 21:43:51,018 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:43:51 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:43:51 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:43:51 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:43:51 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.26it/s]03/23/2024 21:43:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:43:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8467153284671534, 'combined_score': 0.8204164877629885, 'eval_loss': 0.834362, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [260, 263, 252, 251, 220, 213, 190, 181, 207, 156, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77593528, 'remaining_params': 7424072, 'pruned_model_sparsity': 0.9126760576633544, 'expected_sparsity': 0.91058, 'target_sparsity': 0.95, 'step': 5300}


Iteration:   9%|▊         | 10/115 [00:03<00:52,  2.00it/s][A03/23/2024 21:43:51 - INFO - trainer.trainer - v4 Global step: 5300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:43,  2.40it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:36,  2.79it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:32,  3.14it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:29,  3.44it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:27,  3.63it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:25,  3.82it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:25,  3.92it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:23,  4.05it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:23,  4.12it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.19it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.19it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.18it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.25it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.24it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.23it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.29it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.31it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:21,  4.12it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.21it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.19it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:19,  4.28it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.29it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.33it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.34it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:18,  4.43it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:17,  4.40it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.25it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.27it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.38it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:16,  4.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.27it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.19it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.26it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.24it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.17it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.26it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:16,  4.18it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.20it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.23it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.28it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:14,  4.22it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.14it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.29it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.33it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.36it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.46it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:12,  4.45it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.43it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:03,489 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:03 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.91it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.90it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.95it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.24it/s]03/23/2024 21:44:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:04 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8610634648370498, 'combined_score': 0.8312670265361719, 'eval_loss': 0.88000154, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [259, 262, 251, 250, 220, 213, 189, 181, 207, 155, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1], 'pruned_params': 77598124, 'remaining_params': 7419476, 'pruned_model_sparsity': 0.912730117058115, 'expected_sparsity': 0.91066, 'target_sparsity': 0.95, 'step': 5350}


Iteration:  52%|█████▏    | 60/115 [00:15<00:26,  2.09it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.47it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:18,  2.84it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:16,  3.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:14,  3.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.80it/s][A
Iteration:  57%|█████▋    | 66/115 [00:17<00:12,  3.80it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:12,  3.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.04it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.09it/s][A
Iteration:  61%|██████    | 70/115 [00:18<00:10,  4.13it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.09it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.12it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.14it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.19it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.27it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:08,  4.38it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.37it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:20<00:08,  4.36it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.32it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.33it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.42it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:07,  4.35it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.32it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.37it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.38it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.34it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.30it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.19it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.23it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.32it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.35it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.25it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.28it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.29it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.26it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.30it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.31it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.38it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.29it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.42it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.39it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.38it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.44it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.40it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:15,907 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:15 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.96it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:44:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:16 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.852112676056338, 'combined_score': 0.8231151615575807, 'eval_loss': 0.8439723, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [258, 261, 249, 249, 219, 212, 189, 181, 207, 155, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 77803412, 'remaining_params': 7214188, 'pruned_model_sparsity': 0.9151447700240891, 'expected_sparsity': 0.91077, 'target_sparsity': 0.95, 'step': 5400}


Iteration:  96%|█████████▌| 110/115 [00:28<00:02,  2.07it/s][A03/23/2024 21:44:16 - INFO - trainer.trainer - v4 Global step: 5400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:28<00:01,  2.47it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:01,  2.82it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  3.11it/s][A
Iteration:  99%|█████████▉| 114/115 [00:29<00:00,  3.38it/s][A
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.81it/s][A03/23/2024 21:44:17 - INFO - trainer.trainer - Epoch 46 finished. Took 29.22 seconds.
Iteration: 100%|██████████| 115/115 [00:29<00:00,  3.94it/s]
Epoch:  47%|████▋     | 47/100 [22:55<25:23, 28.75s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.34it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.28it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.08it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.03it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.12it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.17it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.34it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.36it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.38it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.35it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.34it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.36it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.37it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.38it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.40it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.34it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.18it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.19it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.28it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:22,  4.27it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.31it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.37it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.31it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.28it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.32it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.29it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:21,  4.08it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.15it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.13it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.16it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.10it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:19,  4.16it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.22it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.18it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.31it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.33it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.31it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.30it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.34it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.35it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.36it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:28,424 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:28 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.92it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.26it/s]03/23/2024 21:44:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:29 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8088235294117647, 'f1': 0.8659793814432989, 'combined_score': 0.8374014554275317, 'eval_loss': 0.8868255, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [258, 260, 248, 249, 219, 212, 188, 180, 207, 155, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 77808008, 'remaining_params': 7209592, 'pruned_model_sparsity': 0.9151988294188498, 'expected_sparsity': 0.91091, 'target_sparsity': 0.95, 'step': 5450}


Iteration:  39%|███▉      | 45/115 [00:11<00:34,  2.04it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:28,  2.44it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:24,  2.79it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:21,  3.12it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:19,  3.43it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:17,  3.63it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.79it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  3.97it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  3.97it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.08it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  4.17it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.21it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.27it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.25it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.31it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.35it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.30it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.25it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.24it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.23it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.28it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.20it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.14it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.15it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.21it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.26it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.27it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.11it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:09,  4.17it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.26it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.30it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.37it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.31it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.31it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.20it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.19it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  4.17it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.16it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.20it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.29it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.26it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.38it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.38it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.29it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.37it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:40,954 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:40 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:40 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:40 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:40 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.94it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.94it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.25it/s]03/23/2024 21:44:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:41 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8492647058823529, 'combined_score': 0.8241421568627452, 'eval_loss': 0.8579347, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [257, 260, 248, 248, 218, 211, 187, 180, 207, 154, 156, 178], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 77812604, 'remaining_params': 7204996, 'pruned_model_sparsity': 0.9152528888136103, 'expected_sparsity': 0.91118, 'target_sparsity': 0.95, 'step': 5500}


Iteration:  83%|████████▎ | 95/115 [00:23<00:09,  2.07it/s][A03/23/2024 21:44:41 - INFO - trainer.trainer - v4 Global step: 5500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:24<00:07,  2.45it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:06,  2.83it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:05,  3.17it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:04,  3.51it/s][A
Iteration:  87%|████████▋ | 100/115 [00:25<00:04,  3.72it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  3.89it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.12it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.25it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.28it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.32it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.30it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.33it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.21it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.28it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.35it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.42it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.43it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.65it/s][A03/23/2024 21:44:46 - INFO - trainer.trainer - Epoch 47 finished. Took 28.45 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.04it/s]
Epoch:  48%|████▊     | 48/100 [23:24<24:50, 28.66s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.28it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.30it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.31it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.18it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.26it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.26it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.13it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.24it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.21it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.31it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:25,  4.12it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.13it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.18it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.23it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.26it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.27it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.24it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:22,  4.24it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.20it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:22,  4.07it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:22,  4.13it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.15it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.20it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.24it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.25it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:20,  4.26it/s][A[INFO|trainer.py:570] 2024-03-23 21:44:53,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:44:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:44:53 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:44:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:44:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.93it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.93it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.26it/s]03/23/2024 21:44:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:44:54 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8531468531468531, 'combined_score': 0.8236322501028384, 'eval_loss': 0.89414096, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [257, 259, 246, 247, 218, 210, 187, 180, 207, 154, 156, 177], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 77820264, 'remaining_params': 7197336, 'pruned_model_sparsity': 0.915342987804878, 'expected_sparsity': 0.91208, 'target_sparsity': 0.95, 'step': 5550}


Iteration:  26%|██▌       | 30/115 [00:07<00:41,  2.05it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:34,  2.42it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:29,  2.82it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.16it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:23,  3.43it/s][A
Iteration:  30%|███       | 35/115 [00:09<00:21,  3.67it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.84it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  4.00it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.11it/s][A
Iteration:  34%|███▍      | 39/115 [00:10<00:17,  4.28it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.28it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.26it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.36it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.34it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.15it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.16it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.23it/s][A
Iteration:  42%|████▏     | 48/115 [00:12<00:15,  4.22it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.26it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.31it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.28it/s][A
Iteration:  45%|████▌     | 52/115 [00:13<00:15,  4.19it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.27it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.31it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.31it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:12,  4.44it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.32it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.30it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:12,  4.38it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.41it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.34it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.26it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.27it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.23it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.30it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.25it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.35it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.34it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.28it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.36it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.21it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.29it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.20it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.25it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.36it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.36it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.40it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:05,897 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:05 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.97it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.29it/s]03/23/2024 21:45:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:06 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8376383763837638, 'combined_score': 0.8109760509369799, 'eval_loss': 0.9666637, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [256, 258, 245, 247, 218, 209, 186, 180, 207, 154, 156, 177], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78022488, 'remaining_params': 6995112, 'pruned_model_sparsity': 0.9177216011743451, 'expected_sparsity': 0.91375, 'target_sparsity': 0.95, 'step': 5600}


Iteration:  70%|██████▉   | 80/115 [00:20<00:17,  2.04it/s][A03/23/2024 21:45:06 - INFO - trainer.trainer - v4 Global step: 5600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:20<00:13,  2.44it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:11,  2.81it/s][A
Iteration:  72%|███████▏  | 83/115 [00:21<00:10,  3.14it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:09,  3.44it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:08,  3.65it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  3.85it/s][A
Iteration:  76%|███████▌  | 87/115 [00:22<00:07,  3.96it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.09it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.20it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:06,  4.06it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.16it/s][A
Iteration:  80%|████████  | 92/115 [00:23<00:05,  4.14it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.25it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.26it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.35it/s][A
Iteration:  83%|████████▎ | 96/115 [00:24<00:04,  4.44it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:03,  4.51it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.52it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.47it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.46it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.37it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.41it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.50it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.53it/s][A
Iteration:  91%|█████████▏| 105/115 [00:26<00:02,  4.49it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.49it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.55it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.49it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  4.38it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.31it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.32it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.33it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.41it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.40it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.63it/s][A03/23/2024 21:45:14 - INFO - trainer.trainer - Epoch 48 finished. Took 28.34 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.06it/s]
Epoch:  49%|████▉     | 49/100 [23:52<24:16, 28.57s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.15it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.47it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.51it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.42it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.42it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.35it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.35it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.38it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.47it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.45it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.35it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.41it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:24,  4.17it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.19it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:18,135 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:18 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.94it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.28it/s]03/23/2024 21:45:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8472727272727272, 'combined_score': 0.8206951871657753, 'eval_loss': 0.9088563, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [256, 258, 244, 246, 218, 209, 185, 180, 206, 154, 156, 177], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78025552, 'remaining_params': 6992048, 'pruned_model_sparsity': 0.9177576407708522, 'expected_sparsity': 0.91426, 'target_sparsity': 0.95, 'step': 5650}


Iteration:  13%|█▎        | 15/115 [00:04<00:49,  2.03it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:40,  2.42it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:36,  2.71it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:31,  3.07it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:28,  3.37it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:26,  3.58it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:25,  3.75it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:23,  3.93it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.03it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.17it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.21it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.27it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:19,  4.41it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.41it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.43it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.44it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.43it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.45it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.47it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.45it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.46it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:17,  4.42it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.42it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.47it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.54it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.53it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.54it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.52it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.52it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.43it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.36it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.26it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:16,  4.12it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.24it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.23it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.08it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.17it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.22it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.24it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.26it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.30it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.32it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.37it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.38it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.37it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.34it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.38it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.37it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:30,465 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:30 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.30it/s]03/23/2024 21:45:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:31 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8405253283302063, 'combined_score': 0.8160959974984365, 'eval_loss': 0.9027749, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [256, 257, 243, 245, 217, 208, 185, 180, 206, 153, 156, 177], 'head_nums': [2, 4, 2, 3, 2, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78031680, 'remaining_params': 6985920, 'pruned_model_sparsity': 0.9178297199638663, 'expected_sparsity': 0.91444, 'target_sparsity': 0.95, 'step': 5700}


Iteration:  57%|█████▋    | 65/115 [00:16<00:24,  2.07it/s][A03/23/2024 21:45:31 - INFO - trainer.trainer - v4 Global step: 5700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:17,  2.82it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:14,  3.19it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:13,  3.52it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  3.81it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.86it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.03it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.13it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.18it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.23it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.09it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.20it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.19it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.23it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.31it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.28it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.34it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.38it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.33it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.30it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.25it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.26it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.32it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.33it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.18it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.20it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.24it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.38it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.30it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.22it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.25it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.32it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.36it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.45it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.42it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.40it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.42it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.28it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.36it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.29it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.32it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.41it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.42it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.39it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.42it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.39it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.37it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.45it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:42,780 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:42 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.31it/s]03/23/2024 21:45:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8635578583765113, 'combined_score': 0.8349652036980596, 'eval_loss': 0.8937132, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [255, 256, 243, 245, 217, 208, 184, 180, 206, 153, 156, 177], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78230840, 'remaining_params': 6786760, 'pruned_model_sparsity': 0.9201722937368263, 'expected_sparsity': 0.91455, 'target_sparsity': 0.95, 'step': 5750}


Iteration: 100%|██████████| 115/115 [00:28<00:00,  2.12it/s][A03/23/2024 21:45:43 - INFO - trainer.trainer - Epoch 49 finished. Took 28.95 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.97it/s]
Epoch:  50%|█████     | 50/100 [24:21<23:54, 28.68s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.22it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.38it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.34it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.39it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.45it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.40it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.37it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.36it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.42it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.43it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.34it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.33it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.39it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.44it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.43it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.38it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.41it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.37it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:22,  4.17it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:22,  4.22it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.22it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.29it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.28it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.29it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.30it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.33it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.34it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.38it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.35it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.38it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.37it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.38it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:19,  4.16it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.26it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.29it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:18,  4.20it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:18,  4.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:17,  4.39it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.34it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.40it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.34it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.35it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.34it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.28it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.33it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.30it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.29it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.34it/s][A[INFO|trainer.py:570] 2024-03-23 21:45:55,161 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:45:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:45:55 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:45:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:45:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.00it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.32it/s]03/23/2024 21:45:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:45:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8438061041292639, 'combined_score': 0.8152854050058085, 'eval_loss': 0.8965566, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [255, 256, 242, 244, 217, 207, 183, 180, 206, 153, 156, 177], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78233904, 'remaining_params': 6783696, 'pruned_model_sparsity': 0.9202083333333333, 'expected_sparsity': 0.91465, 'target_sparsity': 0.95, 'step': 5800}


Iteration:  43%|████▎     | 50/115 [00:12<00:31,  2.07it/s][A03/23/2024 21:45:56 - INFO - trainer.trainer - v4 Global step: 5800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:12<00:26,  2.42it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:22,  2.82it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:19,  3.22it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:18,  3.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:16,  3.61it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:15,  3.83it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:14,  3.89it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:14,  3.97it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.08it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:13,  4.16it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.24it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.37it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.37it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.31it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.38it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.38it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.34it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.40it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.47it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.41it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.38it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.35it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.42it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.29it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.35it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.41it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.30it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.33it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.47it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.48it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.50it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.39it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.41it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.35it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.37it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.44it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.46it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.40it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.36it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.25it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.20it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.25it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.33it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.39it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:07,500 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:07 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.84it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.23it/s]03/23/2024 21:46:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:08 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8484848484848485, 'combined_score': 0.8200757575757576, 'eval_loss': 0.9061032, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [254, 255, 242, 244, 217, 207, 183, 179, 206, 152, 156, 177], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78238500, 'remaining_params': 6779100, 'pruned_model_sparsity': 0.920262392728094, 'expected_sparsity': 0.91474, 'target_sparsity': 0.95, 'step': 5850}


Iteration:  87%|████████▋ | 100/115 [00:24<00:07,  2.03it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:05,  2.44it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:04,  2.83it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:03,  3.19it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:03,  3.51it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  3.76it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  3.78it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  3.96it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.11it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.16it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.15it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.22it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.23it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.22it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.55it/s][A03/23/2024 21:46:11 - INFO - trainer.trainer - Epoch 50 finished. Took 28.13 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.09it/s]
Epoch:  51%|█████     | 51/100 [24:49<23:17, 28.52s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.19it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.33it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.38it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.48it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.41it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.36it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.40it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.34it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.37it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.41it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.44it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.43it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.44it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.34it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.42it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.38it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.46it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.46it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.45it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.40it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.28it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.30it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.42it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.46it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.46it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.45it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.47it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:19,700 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:19 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.97it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.29it/s]03/23/2024 21:46:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8515901060070672, 'combined_score': 0.8228538765329454, 'eval_loss': 0.9119946, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [254, 255, 241, 243, 217, 206, 182, 179, 206, 152, 156, 177], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78241564, 'remaining_params': 6776036, 'pruned_model_sparsity': 0.9202984323246011, 'expected_sparsity': 0.9149, 'target_sparsity': 0.95, 'step': 5900}


Iteration:  30%|███       | 35/115 [00:08<00:38,  2.09it/s][A03/23/2024 21:46:20 - INFO - trainer.trainer - v4 Global step: 5900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:09<00:32,  2.45it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:24,  3.11it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.47it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:20,  3.68it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:19,  3.87it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:18,  3.97it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.11it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.22it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.29it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.16it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.23it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.20it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.28it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.20it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.17it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.26it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.32it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.42it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.40it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.35it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.34it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.30it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.42it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.29it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.31it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.36it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.26it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.27it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.34it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.35it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.41it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.43it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.48it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.48it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.49it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.46it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.52it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.54it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.46it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.37it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.38it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.34it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.30it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.42it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.37it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.31it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.30it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:32,060 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:32 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.30it/s]03/23/2024 21:46:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8411867364746947, 'combined_score': 0.8090737603942101, 'eval_loss': 0.9576762, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [254, 255, 241, 242, 216, 206, 181, 179, 206, 152, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78244628, 'remaining_params': 6772972, 'pruned_model_sparsity': 0.9203344719211081, 'expected_sparsity': 0.91561, 'target_sparsity': 0.95, 'step': 5950}


Iteration:  74%|███████▍  | 85/115 [00:21<00:14,  2.04it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:11,  2.44it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.19it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:07,  3.53it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:06,  3.73it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:06,  3.98it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.07it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.14it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.21it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.28it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.12it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.23it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.27it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.22it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.37it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.26it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.30it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.34it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.36it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.35it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.30it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.24it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.31it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.12it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.29it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.37it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.68it/s][A03/23/2024 21:46:39 - INFO - trainer.trainer - Epoch 51 finished. Took 28.01 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.11it/s]
Epoch:  52%|█████▏    | 52/100 [25:17<22:41, 28.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.43it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.43it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.30it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.33it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.34it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.31it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.43it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.46it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.46it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.50it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.41it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.37it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:23,  4.22it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.32it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:44,343 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.31it/s]03/23/2024 21:46:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8581314878892734, 'combined_score': 0.8285755478662054, 'eval_loss': 0.91800576, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [253, 254, 240, 242, 216, 206, 181, 179, 206, 152, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78249224, 'remaining_params': 6768376, 'pruned_model_sparsity': 0.9203885313158687, 'expected_sparsity': 0.91664, 'target_sparsity': 0.95, 'step': 6000}


Iteration:  17%|█▋        | 20/115 [00:05<00:46,  2.04it/s][A03/23/2024 21:46:45 - INFO - trainer.trainer - v4 Global step: 6000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:38,  2.44it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:33,  2.81it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:28,  3.18it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:26,  3.47it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.69it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:23,  3.72it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:22,  3.88it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:21,  3.99it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.12it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.26it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.19it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.27it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.40it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.35it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.32it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.39it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.39it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.35it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.30it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.14it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.23it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.30it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.32it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.43it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.49it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.39it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:14,  4.43it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.51it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.44it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.51it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.58it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.53it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.40it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.38it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.43it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:12,  4.39it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.40it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.31it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.26it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.37it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.29it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.36it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.32it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.28it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:11,  4.12it/s][A[INFO|trainer.py:570] 2024-03-23 21:46:56,699 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:46:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:46:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:46:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:46:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.96it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.31it/s]03/23/2024 21:46:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:46:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8445229681978799, 'combined_score': 0.814418346844038, 'eval_loss': 0.9248316, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [253, 254, 240, 241, 216, 205, 180, 179, 205, 151, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78252288, 'remaining_params': 6765312, 'pruned_model_sparsity': 0.9204245709123758, 'expected_sparsity': 0.91694, 'target_sparsity': 0.95, 'step': 6050}


Iteration:  61%|██████    | 70/115 [00:17<00:22,  2.02it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:18,  2.36it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:15,  2.75it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:13,  3.04it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:12,  3.36it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:11,  3.59it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:10,  3.73it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  3.99it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:09,  4.08it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.00it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.13it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.18it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.14it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.26it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.31it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.32it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.36it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:05,  4.45it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.42it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.39it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.31it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.31it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.42it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.42it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.36it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.37it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.38it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.27it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.31it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.31it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.19it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.22it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.27it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.32it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.38it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.42it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  4.51it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.45it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.42it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.46it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.63it/s][A03/23/2024 21:47:07 - INFO - trainer.trainer - Epoch 52 finished. Took 28.14 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.09it/s]
Epoch:  53%|█████▎    | 53/100 [25:45<22:09, 28.30s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:29,  3.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.27it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.39it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.32it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:09,080 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.99it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.31it/s]03/23/2024 21:47:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8581436077057792, 'combined_score': 0.8298070979705368, 'eval_loss': 0.8944173, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [252, 254, 240, 240, 216, 205, 180, 179, 205, 151, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78253820, 'remaining_params': 6763780, 'pruned_model_sparsity': 0.9204425907106293, 'expected_sparsity': 0.91707, 'target_sparsity': 0.95, 'step': 6100}


Iteration:   4%|▍         | 5/115 [00:02<00:59,  1.85it/s][A03/23/2024 21:47:10 - INFO - trainer.trainer - v4 Global step: 6100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:47,  2.30it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.71it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:34,  3.07it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.37it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:29,  3.61it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:27,  3.85it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:26,  3.94it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:25,  4.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:24,  4.12it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:23,  4.19it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:23,  4.25it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.25it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.38it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.40it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.37it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.34it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.35it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.41it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.38it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.31it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.34it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.34it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.45it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.36it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.39it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.42it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.50it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.47it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.46it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:17,  4.45it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.45it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.35it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.14it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.22it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.29it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.35it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.39it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.45it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.39it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.36it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.38it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.35it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.31it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.33it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.22it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.26it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.26it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.16it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:21,465 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.08it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.30it/s]03/23/2024 21:47:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8063725490196079, 'f1': 0.8644939965694681, 'combined_score': 0.8354332727945379, 'eval_loss': 0.93388456, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [252, 254, 239, 240, 216, 205, 179, 179, 205, 151, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78255352, 'remaining_params': 6762248, 'pruned_model_sparsity': 0.9204606105088828, 'expected_sparsity': 0.91714, 'target_sparsity': 0.95, 'step': 6150}


Iteration:  48%|████▊     | 55/115 [00:14<00:29,  2.02it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:24,  2.41it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:20,  2.83it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:18,  3.06it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:16,  3.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:15,  3.59it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:14,  3.80it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:13,  3.93it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.10it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.20it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.29it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.38it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:10,  4.38it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:10,  4.39it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.42it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.47it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.24it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.24it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.27it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.18it/s][A
Iteration:  65%|██████▌   | 75/115 [00:19<00:09,  4.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.29it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.32it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.30it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.35it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:07,  4.40it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.50it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.47it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.41it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:06,  4.52it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.51it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.45it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.51it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:05,  4.51it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.51it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.51it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:04,  4.43it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.34it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.18it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.30it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.30it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.31it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.37it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.36it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.40it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.25it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.29it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:33,751 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.01it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.32it/s]03/23/2024 21:47:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8639455782312925, 'combined_score': 0.8339335734293718, 'eval_loss': 0.93621004, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [252, 253, 239, 239, 216, 204, 178, 179, 205, 150, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78258416, 'remaining_params': 6759184, 'pruned_model_sparsity': 0.92049665010539, 'expected_sparsity': 0.91721, 'target_sparsity': 0.95, 'step': 6200}


Iteration:  91%|█████████▏| 105/115 [00:26<00:04,  2.07it/s][A03/23/2024 21:47:34 - INFO - trainer.trainer - v4 Global step: 6200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:26<00:03,  2.46it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:02,  2.86it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:02,  3.20it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  3.43it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  3.59it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:01,  3.79it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.00it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.13it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.12it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.39it/s][A03/23/2024 21:47:36 - INFO - trainer.trainer - Epoch 53 finished. Took 28.96 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.97it/s]
Epoch:  54%|█████▍    | 54/100 [26:14<21:50, 28.50s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.38it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.28it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.26it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:26,  4.07it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.13it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.15it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.24it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.27it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.33it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.28it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.27it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.26it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.37it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.34it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.38it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.43it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.42it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.44it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.21it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.26it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.30it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.36it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.39it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.41it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.50it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.50it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.53it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.44it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.43it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.47it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.46it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.35it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.31it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.36it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.40it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:17,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:46,036 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:46 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.13it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.99it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.99it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.32it/s]03/23/2024 21:47:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.803921568627451, 'f1': 0.8545454545454545, 'combined_score': 0.8292335115864528, 'eval_loss': 0.8838926, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [251, 253, 238, 239, 216, 204, 177, 179, 204, 150, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78263012, 'remaining_params': 6754588, 'pruned_model_sparsity': 0.9205507095001506, 'expected_sparsity': 0.91729, 'target_sparsity': 0.95, 'step': 6250}


Iteration:  35%|███▍      | 40/115 [00:10<00:35,  2.09it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:30,  2.46it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:25,  2.82it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.15it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.50it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:18,  3.71it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:17,  3.88it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:17,  3.91it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:17,  3.85it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:16,  3.99it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.17it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.13it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.21it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.31it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.41it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:12,  4.39it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.34it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.33it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.31it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.33it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.50it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.42it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.42it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.44it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.45it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.28it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.23it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.27it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.32it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.36it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.34it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.45it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.41it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.37it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.43it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.31it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.35it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.37it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.39it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.40it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.35it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.40it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:47:58,366 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:47:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:47:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:47:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:47:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.97it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.96it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.98it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.30it/s]03/23/2024 21:47:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:47:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8605851979345955, 'combined_score': 0.8310278930849448, 'eval_loss': 0.92460144, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [251, 252, 238, 238, 216, 204, 177, 179, 204, 150, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78264544, 'remaining_params': 6753056, 'pruned_model_sparsity': 0.920568729298404, 'expected_sparsity': 0.91745, 'target_sparsity': 0.95, 'step': 6300}


Iteration:  78%|███████▊  | 90/115 [00:22<00:12,  2.08it/s][A03/23/2024 21:47:59 - INFO - trainer.trainer - v4 Global step: 6300, Alignment: tensor([ 2,  5,  7, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:22<00:09,  2.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:08,  2.84it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:06,  3.18it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:06,  3.43it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:05,  3.65it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:05,  3.77it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  3.95it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.15it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.31it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.36it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.37it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.36it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.42it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.37it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.34it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.34it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.39it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.50it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.20it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.17it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.19it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.27it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.31it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.30it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.55it/s][A03/23/2024 21:48:04 - INFO - trainer.trainer - Epoch 54 finished. Took 28.05 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.10it/s]
Epoch:  55%|█████▌    | 55/100 [26:42<21:16, 28.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:28,  4.02it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.15it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.33it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.39it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.22it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.25it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.28it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.15it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.18it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:25,  4.17it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.32it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.31it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.31it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.35it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.28it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.29it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.38it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.37it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.42it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.43it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.55it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.50it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.42it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 21:48:10,726 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:48:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:48:10 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:48:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:48:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.00it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.30it/s]03/23/2024 21:48:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:48:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8551724137931033, 'combined_score': 0.8246450304259634, 'eval_loss': 0.93503124, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [250, 252, 238, 237, 216, 204, 176, 179, 204, 150, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78266076, 'remaining_params': 6751524, 'pruned_model_sparsity': 0.9205867490966576, 'expected_sparsity': 0.91785, 'target_sparsity': 0.95, 'step': 6350}


Iteration:  22%|██▏       | 25/115 [00:06<00:44,  2.04it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:37,  2.39it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:31,  2.77it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:27,  3.12it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:25,  3.44it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.75it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:21,  3.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.00it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.12it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.22it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.23it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.21it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.25it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.28it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.33it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.18it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.21it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.29it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.29it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.39it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.36it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.35it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.46it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.39it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.41it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.37it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.37it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.34it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.36it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.16it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.31it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.43it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:12,  4.42it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.40it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.45it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:11,  4.45it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.43it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.40it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:10,  4.51it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.49it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.43it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.44it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.22it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.32it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.35it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.43it/s][A[INFO|trainer.py:570] 2024-03-23 21:48:23,018 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:48:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:48:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:48:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:48:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.00it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 15.98it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 15.95it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 15.96it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.28it/s]03/23/2024 21:48:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:48:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8571428571428571, 'combined_score': 0.8293067226890756, 'eval_loss': 0.8309372, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [250, 252, 237, 237, 216, 204, 175, 179, 204, 149, 155, 176], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78267608, 'remaining_params': 6749992, 'pruned_model_sparsity': 0.9206047688949112, 'expected_sparsity': 0.91977, 'target_sparsity': 0.95, 'step': 6400}


Iteration:  65%|██████▌   | 75/115 [00:18<00:19,  2.06it/s][A03/23/2024 21:48:23 - INFO - trainer.trainer - v4 Global step: 6400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:19<00:15,  2.46it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:13,  2.84it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:11,  3.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.46it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:09,  3.77it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  3.91it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  3.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.05it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.09it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.18it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.20it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.27it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.28it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.27it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.27it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.27it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.16it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.25it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.22it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.29it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.35it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.35it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.36it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.33it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.38it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.34it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.38it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.40it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.44it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.47it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:01,  4.51it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.46it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.46it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.47it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.48it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.49it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.39it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.39it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.43it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.72it/s][A03/23/2024 21:48:32 - INFO - trainer.trainer - Epoch 55 finished. Took 28.05 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.10it/s]
Epoch:  56%|█████▌    | 56/100 [27:10<20:43, 28.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:28,  4.04it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.27it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.13it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.30it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.35it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.31it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.21it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.32it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.29it/s][A[INFO|trainer.py:570] 2024-03-23 21:48:35,318 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:48:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:48:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:48:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:48:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.02it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.35it/s]03/23/2024 21:48:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:48:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8537414965986394, 'combined_score': 0.8214785914365745, 'eval_loss': 0.8196287, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [249, 251, 237, 236, 216, 204, 174, 179, 204, 149, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78664396, 'remaining_params': 6353204, 'pruned_model_sparsity': 0.9252718966425776, 'expected_sparsity': 0.92199, 'target_sparsity': 0.95, 'step': 6450}


Iteration:   9%|▊         | 10/115 [00:03<00:52,  2.01it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:42,  2.43it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:36,  2.83it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.19it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:29,  3.37it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:27,  3.61it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:26,  3.80it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:24,  4.02it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:23,  4.11it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:23,  4.10it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.21it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.23it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.23it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.27it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.28it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.32it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.32it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.29it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.37it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.38it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.43it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.50it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.39it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.33it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.26it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.33it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.27it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.45it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.41it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.54it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:16,  4.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.38it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.48it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.42it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.21it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.31it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.33it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.40it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:14,  4.50it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.57it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.54it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.39it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.47it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.41it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.43it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.39it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.32it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.34it/s][A[INFO|trainer.py:570] 2024-03-23 21:48:47,581 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:48:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:48:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:48:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:48:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.12it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.05it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.35it/s]03/23/2024 21:48:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:48:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7990196078431373, 'f1': 0.8600682593856656, 'combined_score': 0.8295439336144015, 'eval_loss': 0.78782594, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [248, 251, 236, 235, 216, 204, 174, 179, 204, 149, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78667460, 'remaining_params': 6350140, 'pruned_model_sparsity': 0.9253079362390846, 'expected_sparsity': 0.92253, 'target_sparsity': 0.95, 'step': 6500}


Iteration:  52%|█████▏    | 60/115 [00:15<00:26,  2.06it/s][A03/23/2024 21:48:48 - INFO - trainer.trainer - v4 Global step: 6500, Alignment: tensor([ 1,  4,  7, 10], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:15<00:22,  2.45it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.80it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:16,  3.16it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:14,  3.42it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.68it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  3.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.05it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.13it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.23it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.24it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.08it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  4.09it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.03it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.12it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.21it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  4.26it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.24it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.20it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.18it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.27it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.41it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.45it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.23it/s][A
Iteration:  73%|███████▎  | 84/115 [00:21<00:07,  4.19it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:07,  4.12it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.28it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.35it/s][A
Iteration:  77%|███████▋  | 88/115 [00:22<00:06,  4.19it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.23it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.32it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.34it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.37it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.41it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.44it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.43it/s][A
Iteration:  84%|████████▍ | 97/115 [00:24<00:04,  4.37it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.34it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.30it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:25<00:03,  4.30it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.35it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.35it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.34it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.45it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.34it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.40it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.37it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:00,004 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:00 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.04it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.36it/s]03/23/2024 21:49:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8483754512635379, 'combined_score': 0.8212465491611807, 'eval_loss': 0.7528513, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [247, 250, 236, 234, 215, 203, 173, 179, 204, 149, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78673588, 'remaining_params': 6344012, 'pruned_model_sparsity': 0.9253800154320988, 'expected_sparsity': 0.92273, 'target_sparsity': 0.95, 'step': 6550}


Iteration:  96%|█████████▌| 110/115 [00:27<00:02,  2.09it/s][A
Iteration:  97%|█████████▋| 111/115 [00:28<00:01,  2.46it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:01,  2.81it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  3.21it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  3.47it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.87it/s][A03/23/2024 21:49:01 - INFO - trainer.trainer - Epoch 56 finished. Took 28.99 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.97it/s]
Epoch:  57%|█████▋    | 57/100 [27:39<20:24, 28.48s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.30it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.22it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.30it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.40it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.16it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.20it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:26,  4.03it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:26,  4.11it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.21it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.28it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.27it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.34it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.29it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:24,  4.14it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.24it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.26it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.23it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.28it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.37it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.47it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.48it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.43it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.35it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.41it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.40it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.36it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.35it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.34it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.36it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.37it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.33it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.30it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.29it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.33it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.36it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.40it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.40it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.39it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.34it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.37it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.28it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.34it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:12,392 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:12 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:12 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:12 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:12 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.04it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.36it/s]03/23/2024 21:49:13 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:13 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8426763110307414, 'combined_score': 0.8147205084565472, 'eval_loss': 0.75333023, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [247, 250, 235, 234, 215, 203, 172, 179, 204, 149, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78675120, 'remaining_params': 6342480, 'pruned_model_sparsity': 0.9253980352303524, 'expected_sparsity': 0.92279, 'target_sparsity': 0.95, 'step': 6600}


Iteration:  39%|███▉      | 45/115 [00:11<00:33,  2.07it/s][A03/23/2024 21:49:13 - INFO - trainer.trainer - v4 Global step: 6600, Alignment: tensor([ 1,  4,  7, 10], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:11<00:28,  2.46it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.85it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:21,  3.18it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:19,  3.45it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:17,  3.67it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.85it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  3.98it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:15,  3.99it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.12it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.17it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.34it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:13,  4.39it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.37it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.44it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.43it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.39it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.41it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.40it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.31it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.31it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.33it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.34it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.33it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.40it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.47it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.50it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.45it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.41it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.41it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.52it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.42it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.43it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.37it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.42it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.44it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.50it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.57it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.54it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.44it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.41it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.40it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.29it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.42it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.38it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.39it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.43it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.44it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:24,596 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:24 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:24 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:24 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.14it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.02it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.34it/s]03/23/2024 21:49:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:25 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8447653429602888, 'combined_score': 0.8169905146173992, 'eval_loss': 0.76498383, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [246, 250, 235, 233, 215, 203, 171, 178, 204, 148, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78678184, 'remaining_params': 6339416, 'pruned_model_sparsity': 0.9254340748268594, 'expected_sparsity': 0.92284, 'target_sparsity': 0.95, 'step': 6650}


Iteration:  83%|████████▎ | 95/115 [00:23<00:09,  2.06it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:07,  2.46it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.84it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:05,  3.23it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:04,  3.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:04,  3.73it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  3.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.07it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.00it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.12it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.23it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.25it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.20it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.22it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.18it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.20it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.23it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.20it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.23it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.52it/s][A03/23/2024 21:49:30 - INFO - trainer.trainer - Epoch 57 finished. Took 28.08 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.10it/s]
Epoch:  58%|█████▊    | 58/100 [28:07<19:51, 28.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.29it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.32it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.34it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.40it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.32it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.36it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.30it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.30it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.38it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.40it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.31it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.19it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.21it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.30it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.34it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.36it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.31it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.37it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.42it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.36it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.27it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.34it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.35it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.37it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.43it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.41it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.34it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.40it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:20,  4.13it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:36,982 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:36 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:37 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.01it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.34it/s]03/23/2024 21:49:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:37 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8551483420593368, 'combined_score': 0.8258584847551586, 'eval_loss': 0.8132392, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [245, 250, 234, 232, 215, 202, 170, 178, 204, 148, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78682780, 'remaining_params': 6334820, 'pruned_model_sparsity': 0.92548813422162, 'expected_sparsity': 0.92288, 'target_sparsity': 0.95, 'step': 6700}


Iteration:  26%|██▌       | 30/115 [00:07<00:41,  2.03it/s][A03/23/2024 21:49:37 - INFO - trainer.trainer - v4 Global step: 6700, Alignment: tensor([ 1,  4,  8, 10], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:08<00:34,  2.41it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:29,  2.78it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:26,  3.12it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:23,  3.39it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:21,  3.66it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.87it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  4.02it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.30it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.36it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.45it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.37it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.34it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.29it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.27it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.27it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.23it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.26it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.32it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.38it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:13,  4.43it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.40it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.44it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.45it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.28it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.33it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.27it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.27it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.35it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.46it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.52it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.49it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.41it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.45it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.33it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.26it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.40it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.37it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.29it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.30it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.35it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.39it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.48it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.48it/s][A[INFO|trainer.py:570] 2024-03-23 21:49:49,238 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:49:49 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:49:49 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:49:49 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:49:49 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.04it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.37it/s]03/23/2024 21:49:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:49:50 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8494623655913978, 'combined_score': 0.8217900063251107, 'eval_loss': 0.79041916, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [245, 249, 234, 231, 215, 202, 170, 178, 204, 148, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78684312, 'remaining_params': 6333288, 'pruned_model_sparsity': 0.9255061540198736, 'expected_sparsity': 0.92291, 'target_sparsity': 0.95, 'step': 6750}


Iteration:  70%|██████▉   | 80/115 [00:20<00:16,  2.07it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:13,  2.44it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:11,  2.83it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:10,  3.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:09,  3.40it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:08,  3.50it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  3.77it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:07,  3.95it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.10it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.29it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.37it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.35it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.31it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.32it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.37it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.31it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.34it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.36it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.16it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.32it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.34it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.32it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.41it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.45it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.40it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.35it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.48it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.46it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.29it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.31it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.35it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.39it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.67it/s][A03/23/2024 21:49:58 - INFO - trainer.trainer - Epoch 58 finished. Took 28.05 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.10it/s]
Epoch:  59%|█████▉    | 59/100 [28:35<19:19, 28.27s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.33it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:28,  4.03it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:27,  4.14it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:27,  4.05it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:26,  4.11it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.23it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.21it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.37it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.45it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.41it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.47it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.39it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.39it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:01,552 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:01 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:01 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:01 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:01 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.12it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.03it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.35it/s]03/23/2024 21:50:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:02 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8491228070175437, 'combined_score': 0.8191692466460267, 'eval_loss': 0.80915207, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [244, 249, 233, 230, 215, 202, 169, 178, 203, 148, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78688908, 'remaining_params': 6328692, 'pruned_model_sparsity': 0.9255602134146341, 'expected_sparsity': 0.92296, 'target_sparsity': 0.95, 'step': 6800}


Iteration:  13%|█▎        | 15/115 [00:04<00:48,  2.08it/s][A03/23/2024 21:50:02 - INFO - trainer.trainer - v4 Global step: 6800, Alignment: tensor([ 1,  4,  8, 10], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:39,  2.48it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:34,  2.83it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.54it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:25,  3.74it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:24,  3.91it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.10it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.16it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.20it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.26it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.31it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.25it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.33it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.35it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.15it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.32it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.31it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.31it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.31it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.36it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:17,  4.46it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.47it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.43it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.27it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.29it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.25it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.24it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.18it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.22it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.24it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.30it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.29it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.25it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.23it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.38it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.27it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.32it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.37it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.42it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.46it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.35it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.41it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.46it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.35it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.33it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.34it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:13,893 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:13 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:13 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:13 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:13 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.12it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.04it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.36it/s]03/23/2024 21:50:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:14 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7916666666666666, 'f1': 0.8511383537653241, 'combined_score': 0.8214025102159954, 'eval_loss': 0.78861064, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [244, 249, 233, 229, 214, 201, 168, 178, 203, 148, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78691972, 'remaining_params': 6325628, 'pruned_model_sparsity': 0.9255962530111412, 'expected_sparsity': 0.923, 'target_sparsity': 0.95, 'step': 6850}


Iteration:  57%|█████▋    | 65/115 [00:16<00:24,  2.07it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:17,  2.80it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:14,  3.18it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:13,  3.45it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:12,  3.68it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:11,  3.84it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:10,  3.96it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.18it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.26it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.24it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:08,  4.38it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.39it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.38it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.37it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.34it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.39it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.40it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.46it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.47it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.24it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.28it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.31it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:05,  4.36it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.38it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.55it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:04,  4.47it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.25it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.34it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.36it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.34it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.36it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.39it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.34it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.39it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.36it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.40it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.38it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.44it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.37it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.38it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.37it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.40it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.50it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.57it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.53it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:26,059 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:26 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:26 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:26 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:26 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.17it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.13it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.04it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.38it/s]03/23/2024 21:50:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:26 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8519195612431445, 'combined_score': 0.8266950747392193, 'eval_loss': 0.7642789, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [243, 248, 232, 228, 214, 201, 167, 178, 203, 148, 155, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78696568, 'remaining_params': 6321032, 'pruned_model_sparsity': 0.9256503124059018, 'expected_sparsity': 0.92305, 'target_sparsity': 0.95, 'step': 6900}


Iteration: 100%|██████████| 115/115 [00:28<00:00,  2.15it/s][A03/23/2024 21:50:26 - INFO - trainer.trainer - Epoch 59 finished. Took 28.82 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.99it/s]
Epoch:  60%|██████    | 60/100 [29:04<18:57, 28.43s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:50:26 - INFO - trainer.trainer - v4 Global step: 6900, Alignment: tensor([ 1,  4,  7, 10], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:25,  4.54it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.50it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.37it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.33it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.39it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.34it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.40it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.43it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.42it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.40it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.32it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.32it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.26it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.34it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.36it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.40it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.40it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.42it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.39it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.39it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.31it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.33it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.29it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.24it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.29it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.37it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.43it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.38it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.38it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.35it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.39it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.46it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.50it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.38it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:17,  4.43it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.40it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.30it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.33it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.24it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.24it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.29it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:16,  4.29it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.35it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.39it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:38,377 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:38 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:38 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:38 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:38 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.02it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.35it/s]03/23/2024 21:50:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:39 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8541300527240773, 'combined_score': 0.8253493400875288, 'eval_loss': 0.8144742, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [242, 248, 232, 227, 214, 201, 167, 178, 203, 148, 154, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78698100, 'remaining_params': 6319500, 'pruned_model_sparsity': 0.9256683322041553, 'expected_sparsity': 0.9231, 'target_sparsity': 0.95, 'step': 6950}


Iteration:  43%|████▎     | 50/115 [00:12<00:31,  2.06it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:26,  2.46it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:22,  2.80it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:19,  3.19it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:17,  3.48it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:16,  3.71it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:15,  3.91it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  3.91it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:14,  4.05it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.16it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.24it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.25it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.27it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.41it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.31it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.31it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.23it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.33it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.33it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.38it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.36it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:10,  4.17it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.23it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.27it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.24it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.27it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.24it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.31it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.37it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.38it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.45it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.41it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.43it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.48it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.56it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.16it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.20it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.26it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.29it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.36it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.28it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.35it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.41it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.37it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.39it/s][A[INFO|trainer.py:570] 2024-03-23 21:50:50,741 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:50:50 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:50:50 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:50:50 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:50:50 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.03it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.36it/s]03/23/2024 21:50:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:50:51 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8472222222222223, 'combined_score': 0.8157679738562091, 'eval_loss': 0.8661053, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [242, 248, 231, 226, 213, 201, 166, 178, 203, 148, 154, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78701164, 'remaining_params': 6316436, 'pruned_model_sparsity': 0.9257043718006625, 'expected_sparsity': 0.92316, 'target_sparsity': 0.95, 'step': 7000}


Iteration:  87%|████████▋ | 100/115 [00:24<00:07,  2.05it/s][A03/23/2024 21:50:51 - INFO - trainer.trainer - v4 Global step: 7000, Alignment: tensor([ 1,  4,  7, 10], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:24<00:05,  2.44it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:04,  2.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:03,  3.23it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:03,  3.54it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  3.73it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  3.88it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.05it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.17it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.31it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.27it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.41it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.36it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.43it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.57it/s][A03/23/2024 21:50:54 - INFO - trainer.trainer - Epoch 60 finished. Took 28.02 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.10it/s]
Epoch:  61%|██████    | 61/100 [29:32<18:24, 28.31s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.50it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.20it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.31it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.37it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.42it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.38it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.36it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.49it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.46it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.38it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:24,  4.18it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.19it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.23it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.29it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.30it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.34it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.30it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.34it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.40it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.37it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.42it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.36it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.35it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.39it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.26it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.30it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.30it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.25it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.25it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.34it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:03,005 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:03 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:03 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:03 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:03 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.11it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.05it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.37it/s]03/23/2024 21:51:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:03 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8526315789473684, 'combined_score': 0.8233746130030959, 'eval_loss': 0.8635975, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [241, 247, 230, 225, 213, 201, 165, 178, 202, 147, 154, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78707292, 'remaining_params': 6310308, 'pruned_model_sparsity': 0.9257764509936766, 'expected_sparsity': 0.92322, 'target_sparsity': 0.95, 'step': 7050}


Iteration:  30%|███       | 35/115 [00:08<00:38,  2.06it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:32,  2.42it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:27,  2.82it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:24,  3.14it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:22,  3.44it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:20,  3.69it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:19,  3.86it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:18,  4.02it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.12it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.28it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.42it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.47it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.40it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:14,  4.43it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.31it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.38it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.41it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.46it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.42it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.38it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.45it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.34it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.34it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.36it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.33it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.32it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.23it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.30it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.33it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.27it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.27it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.31it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.37it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.35it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.33it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.34it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.38it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.43it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.51it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.48it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.46it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.40it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.50it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.44it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:15,216 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:15 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:15 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:15 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:15 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.16it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.02it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.36it/s]03/23/2024 21:51:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:16 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8505338078291814, 'combined_score': 0.8223257274440025, 'eval_loss': 0.8612879, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [241, 247, 230, 223, 212, 200, 165, 178, 202, 147, 154, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78710356, 'remaining_params': 6307244, 'pruned_model_sparsity': 0.9258124905901837, 'expected_sparsity': 0.9233, 'target_sparsity': 0.95, 'step': 7100}


Iteration:  74%|███████▍  | 85/115 [00:21<00:14,  2.09it/s][A03/23/2024 21:51:16 - INFO - trainer.trainer - v4 Global step: 7100, Alignment: tensor([1, 5, 8, 9], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:21<00:11,  2.48it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:09,  2.84it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.16it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:07,  3.42it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:07,  3.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:06,  3.74it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  3.93it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:05,  4.08it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:05,  4.17it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.29it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.32it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.44it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.41it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.42it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.16it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.12it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.14it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.22it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.30it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.30it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.33it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.36it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.37it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.36it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.37it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.33it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.48it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.43it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.66it/s][A03/23/2024 21:51:22 - INFO - trainer.trainer - Epoch 61 finished. Took 28.02 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.10it/s]
Epoch:  62%|██████▏   | 62/100 [30:00<17:52, 28.22s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.45it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.42it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.51it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.36it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.39it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.35it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.39it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.34it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.46it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.38it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.39it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.47it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.50it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.45it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.46it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.39it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.35it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.34it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:27,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:27 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:27 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:27 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:27 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.08it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.02it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.36it/s]03/23/2024 21:51:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:28 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8541300527240773, 'combined_score': 0.8253493400875288, 'eval_loss': 0.8888612, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [240, 246, 229, 222, 212, 200, 164, 178, 202, 147, 154, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78714952, 'remaining_params': 6302648, 'pruned_model_sparsity': 0.9258665499849443, 'expected_sparsity': 0.92337, 'target_sparsity': 0.95, 'step': 7150}


Iteration:  17%|█▋        | 20/115 [00:05<00:46,  2.02it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:39,  2.41it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:33,  2.79it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:30,  3.05it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:27,  3.32it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.61it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:23,  3.85it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:21,  4.01it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:21,  4.12it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.24it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.38it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:20,  4.20it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.23it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.31it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.44it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.47it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:17,  4.50it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.49it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.43it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.53it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.47it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.48it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.44it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.38it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.35it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.44it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.38it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.43it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.40it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.49it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.48it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.53it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.46it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.44it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.38it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.29it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.33it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.28it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.31it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.36it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:13,  4.12it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:12,  4.18it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.22it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.37it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.48it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.48it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.34it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:39,784 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:39 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:39 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:39 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:39 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.11it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.04it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.36it/s]03/23/2024 21:51:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:40 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8489208633093525, 'combined_score': 0.821519255184088, 'eval_loss': 0.8581526, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [240, 246, 229, 221, 212, 200, 163, 178, 202, 147, 154, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78714952, 'remaining_params': 6302648, 'pruned_model_sparsity': 0.9258665499849443, 'expected_sparsity': 0.92349, 'target_sparsity': 0.95, 'step': 7200}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.06it/s][A03/23/2024 21:51:40 - INFO - trainer.trainer - v4 Global step: 7200, Alignment: tensor([1, 4, 7, 9], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:17<00:18,  2.44it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:15,  2.82it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:13,  3.07it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:12,  3.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.70it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:09,  3.90it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.00it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.14it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.23it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.26it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:08,  4.24it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.24it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.29it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.28it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.29it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.43it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.35it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.37it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:05,  4.37it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.39it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.31it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.29it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.30it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.27it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.26it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:04,  4.19it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.34it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.36it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.27it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:03,  4.28it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.25it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.20it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.24it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:02,  4.38it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:01,  4.20it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.26it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.29it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.29it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:00,  4.33it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.37it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.41it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.70it/s][A03/23/2024 21:51:50 - INFO - trainer.trainer - Epoch 62 finished. Took 28.03 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.10it/s]
Epoch:  63%|██████▎   | 63/100 [30:28<17:22, 28.17s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.37it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.34it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.51it/s][A[INFO|trainer.py:570] 2024-03-23 21:51:52,111 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:51:52 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:51:52 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:51:52 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:51:52 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.02it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.03it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.36it/s]03/23/2024 21:51:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:51:52 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.8014705882352942, 'f1': 0.8529945553539019, 'combined_score': 0.8272325717945981, 'eval_loss': 0.8533988, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [240, 245, 228, 220, 211, 200, 163, 178, 202, 147, 154, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78719548, 'remaining_params': 6298052, 'pruned_model_sparsity': 0.9259206093797049, 'expected_sparsity': 0.92371, 'target_sparsity': 0.95, 'step': 7250}


Iteration:   4%|▍         | 5/115 [00:01<00:58,  1.88it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:47,  2.27it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:40,  2.68it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:35,  3.04it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:31,  3.35it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:28,  3.63it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:27,  3.81it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:26,  3.95it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.08it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:24,  4.14it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:23,  4.20it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  4.07it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.12it/s][A
Iteration:  16%|█▌        | 18/115 [00:05<00:22,  4.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.22it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.27it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.23it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.31it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:20,  4.44it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.43it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.39it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.49it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:19,  4.40it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.43it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.36it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.34it/s][A
Iteration:  27%|██▋       | 31/115 [00:08<00:19,  4.32it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.43it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.26it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.24it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.27it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.29it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.42it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.18it/s][A
Iteration:  35%|███▍      | 40/115 [00:10<00:17,  4.29it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.42it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.43it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.26it/s][A
Iteration:  38%|███▊      | 44/115 [00:11<00:16,  4.26it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.39it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.39it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.41it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.43it/s][A
Iteration:  43%|████▎     | 49/115 [00:12<00:15,  4.35it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.39it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.35it/s][A
Iteration:  46%|████▌     | 53/115 [00:13<00:14,  4.32it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.33it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:04,540 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:04 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:04 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:04 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:04 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.03it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.04it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.05it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.06it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.06it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.37it/s]03/23/2024 21:52:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:05 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7965686274509803, 'f1': 0.8551483420593368, 'combined_score': 0.8258584847551586, 'eval_loss': 0.877077, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [239, 245, 228, 219, 211, 199, 162, 178, 202, 147, 154, 175], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 78722612, 'remaining_params': 6294988, 'pruned_model_sparsity': 0.925956648976212, 'expected_sparsity': 0.92458, 'target_sparsity': 0.95, 'step': 7300}


Iteration:  48%|████▊     | 55/115 [00:14<00:29,  2.06it/s][A03/23/2024 21:52:05 - INFO - trainer.trainer - v4 Global step: 7300, Alignment: tensor([1, 2, 7, 9], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:14<00:24,  2.43it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:20,  2.83it/s][A
Iteration:  50%|█████     | 58/115 [00:15<00:17,  3.19it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:16,  3.44it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:15,  3.66it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  3.88it/s][A
Iteration:  54%|█████▍    | 62/115 [00:16<00:13,  3.97it/s][A
Iteration:  55%|█████▍    | 63/115 [00:16<00:12,  4.13it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.24it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.31it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.30it/s][A
Iteration:  58%|█████▊    | 67/115 [00:17<00:11,  4.18it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.20it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.24it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.28it/s][A
Iteration:  62%|██████▏   | 71/115 [00:18<00:10,  4.35it/s][A
Iteration:  63%|██████▎   | 72/115 [00:18<00:09,  4.46it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.49it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.51it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.49it/s][A
Iteration:  66%|██████▌   | 76/115 [00:19<00:08,  4.50it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.47it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.42it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.40it/s][A
Iteration:  70%|██████▉   | 80/115 [00:20<00:08,  4.32it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.43it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.50it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.49it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:21<00:06,  4.48it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.46it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.34it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.17it/s][A
Iteration:  77%|███████▋  | 89/115 [00:22<00:06,  4.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.36it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.35it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.38it/s][A
Iteration:  81%|████████  | 93/115 [00:23<00:04,  4.43it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.50it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.50it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.40it/s][A
Iteration:  85%|████████▌ | 98/115 [00:24<00:03,  4.40it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.33it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.32it/s][A
Iteration:  89%|████████▊ | 102/115 [00:25<00:02,  4.39it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.33it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:16,773 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:16 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:16 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:16 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:16 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.12it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.42it/s]03/23/2024 21:52:17 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:17 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8514851485148515, 'combined_score': 0.8154484566103669, 'eval_loss': 0.6849096, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [239, 244, 227, 217, 211, 199, 161, 178, 201, 147, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 79033608, 'remaining_params': 5983992, 'pruned_model_sparsity': 0.9296146680216802, 'expected_sparsity': 0.92777, 'target_sparsity': 0.95, 'step': 7350}


Iteration:  91%|█████████▏| 105/115 [00:26<00:04,  2.08it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:03,  2.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:27<00:02,  2.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:27<00:02,  3.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  3.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  3.73it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  3.88it/s][A
Iteration:  97%|█████████▋| 112/115 [00:28<00:00,  4.07it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.18it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.33it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.62it/s][A03/23/2024 21:52:19 - INFO - trainer.trainer - Epoch 63 finished. Took 28.82 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.99it/s]
Epoch:  64%|██████▍   | 64/100 [30:57<17:01, 28.36s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.54it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.34it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.39it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.29it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.32it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.38it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.43it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.45it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.52it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.41it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.43it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.40it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.30it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:23,  4.25it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.30it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.35it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.34it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.37it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.39it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.37it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.36it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.40it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.39it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.34it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.44it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.44it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.41it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.45it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.44it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:18,  4.44it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.48it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.43it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.48it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:17,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:28,919 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:28 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:28 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:28 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:28 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.08it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.07it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.10it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.41it/s]03/23/2024 21:52:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:29 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7941176470588235, 'f1': 0.8536585365853658, 'combined_score': 0.8238880918220947, 'eval_loss': 0.63409716, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [238, 243, 227, 216, 211, 199, 161, 178, 201, 147, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 3, 2, 1, 2, 2, 1, 1], 'pruned_params': 79036672, 'remaining_params': 5980928, 'pruned_model_sparsity': 0.9296507076181872, 'expected_sparsity': 0.92956, 'target_sparsity': 0.95, 'step': 7400}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.09it/s][A03/23/2024 21:52:29 - INFO - trainer.trainer - v4 Global step: 7400, Alignment: tensor([1, 2, 7, 9], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:10<00:29,  2.50it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:25,  2.90it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.52it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:18,  3.72it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:17,  3.94it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.15it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.27it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.41it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.35it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.44it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.48it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.50it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.52it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.41it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.46it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.42it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.39it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.36it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.34it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.33it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.38it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.37it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.40it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.38it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.32it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.28it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.41it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.47it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.46it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.48it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.51it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.45it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.48it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.44it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.50it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.44it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.26it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.30it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.37it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.40it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.50it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.23it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.38it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:41,036 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:41 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.14it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.16it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.16it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.15it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.47it/s]03/23/2024 21:52:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:41 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7843137254901961, 'f1': 0.8450704225352113, 'combined_score': 0.8146920740127037, 'eval_loss': 0.92075443, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [238, 243, 227, 215, 210, 199, 160, 178, 201, 147, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79500868, 'remaining_params': 5516732, 'pruned_model_sparsity': 0.9351107064890093, 'expected_sparsity': 0.93162, 'target_sparsity': 0.95, 'step': 7450}


Iteration:  78%|███████▊  | 90/115 [00:22<00:11,  2.09it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:09,  2.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:08,  2.77it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:07,  3.11it/s][A
Iteration:  82%|████████▏ | 94/115 [00:23<00:06,  3.42it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:05,  3.63it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  3.81it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  3.92it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.09it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.11it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.24it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.34it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.36it/s][A
Iteration:  90%|████████▉ | 103/115 [00:25<00:02,  4.34it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.17it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.32it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.41it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.43it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.39it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.34it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.40it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.43it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.46it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.42it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.46it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.73it/s][A03/23/2024 21:52:47 - INFO - trainer.trainer - Epoch 64 finished. Took 27.76 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.14it/s]
Epoch:  65%|██████▌   | 65/100 [31:25<16:26, 28.18s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.46it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.51it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.47it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.37it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.40it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.41it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.41it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.45it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.49it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.46it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.47it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.44it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.46it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.47it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.47it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:20,  4.62it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.51it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.49it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.50it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.49it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.46it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:52:53,207 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:52:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:52:53 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:52:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:52:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.09it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.11it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.13it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.44it/s]03/23/2024 21:52:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:52:54 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8443649373881931, 'combined_score': 0.815564821635273, 'eval_loss': 0.9137593, 'head_layers': [0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [237, 242, 226, 214, 210, 199, 160, 178, 200, 147, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79506996, 'remaining_params': 5510604, 'pruned_model_sparsity': 0.9351827856820235, 'expected_sparsity': 0.93255, 'target_sparsity': 0.95, 'step': 7500}


Iteration:  22%|██▏       | 25/115 [00:06<00:44,  2.03it/s][A03/23/2024 21:52:54 - INFO - trainer.trainer - v4 Global step: 7500, Alignment: tensor([ 1,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:06<00:36,  2.45it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.84it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:28,  3.08it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:25,  3.43it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:23,  3.69it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:22,  3.71it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:21,  3.92it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:20,  4.08it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.21it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.28it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.35it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.33it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.39it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.44it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.26it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.33it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.44it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.52it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.45it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.46it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.49it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.47it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.37it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.42it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.47it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.49it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.49it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.35it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.19it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.28it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.30it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:13,  4.33it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.32it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.32it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.41it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.46it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.47it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.43it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.48it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.47it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.46it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.41it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.40it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.51it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.50it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:05,400 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:05 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:05 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:05 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:05 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.53it/s]03/23/2024 21:53:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:06 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8476357267950962, 'combined_score': 0.8172002163387246, 'eval_loss': 1.0214238, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [237, 242, 225, 213, 210, 199, 160, 178, 200, 147, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79704624, 'remaining_params': 5312976, 'pruned_model_sparsity': 0.9375073396567299, 'expected_sparsity': 0.93316, 'target_sparsity': 0.95, 'step': 7550}


Iteration:  65%|██████▌   | 75/115 [00:18<00:19,  2.10it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:13,  2.89it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:11,  3.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.56it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.81it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  4.01it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.06it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.20it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.25it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.42it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.36it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.43it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.47it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.46it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.39it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.37it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.43it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.48it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.45it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.34it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.37it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.38it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.40it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.43it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.39it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.44it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.32it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.30it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.43it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.42it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.40it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.42it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.41it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.36it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.38it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.37it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.59it/s][A03/23/2024 21:53:15 - INFO - trainer.trainer - Epoch 65 finished. Took 27.66 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.16it/s]
Epoch:  66%|██████▌   | 66/100 [31:52<15:52, 28.03s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.42it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.21it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.29it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.41it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.40it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.38it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.46it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.38it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:25,  4.20it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:17,550 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:17 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:17 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:17 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:17 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.54it/s]03/23/2024 21:53:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8411867364746947, 'combined_score': 0.8090737603942101, 'eval_loss': 1.0132031, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [237, 242, 225, 212, 210, 199, 159, 178, 199, 146, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79706156, 'remaining_params': 5311444, 'pruned_model_sparsity': 0.9375253594549834, 'expected_sparsity': 0.93338, 'target_sparsity': 0.95, 'step': 7600}


Iteration:   9%|▊         | 10/115 [00:03<00:52,  2.02it/s][A03/23/2024 21:53:18 - INFO - trainer.trainer - v4 Global step: 7600, Alignment: tensor([ 1,  2,  8, 11], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:42,  2.44it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:36,  2.84it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.19it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:29,  3.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.72it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  3.97it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.18it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.23it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.25it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.44it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.44it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:20,  4.47it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.50it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.53it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.46it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.48it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.45it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.28it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.35it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.42it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.46it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.48it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.56it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.56it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.49it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.48it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.42it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.38it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.39it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.38it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.41it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.38it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.42it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.47it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.45it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.48it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.48it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.48it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.33it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.40it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.38it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.43it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.49it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:29,587 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:29 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:29 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:29 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:29 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.16it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.16it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.49it/s]03/23/2024 21:53:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:30 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8452173913043478, 'combined_score': 0.8135400682011935, 'eval_loss': 0.9697586, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [236, 241, 224, 210, 210, 199, 159, 178, 198, 146, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79712284, 'remaining_params': 5305316, 'pruned_model_sparsity': 0.9375974386479976, 'expected_sparsity': 0.93348, 'target_sparsity': 0.95, 'step': 7650}


Iteration:  52%|█████▏    | 60/115 [00:15<00:26,  2.08it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:22,  2.45it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.83it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:16,  3.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:14,  3.41it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.68it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:13,  3.74it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:12,  3.96it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:11,  4.13it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.25it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.34it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.40it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.26it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.35it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.35it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.35it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.41it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.45it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.46it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.43it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.46it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.50it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:06,  4.58it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.55it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.51it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.57it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.34it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.36it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.36it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.33it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.38it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.40it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.36it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.33it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.40it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.37it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.40it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.41it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.34it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.39it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.36it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.41it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.46it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.44it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.45it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.47it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.43it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.41it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:41,784 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:41 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:41 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:41 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:41 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.52it/s]03/23/2024 21:53:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:42 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8461538461538461, 'combined_score': 0.8103318250377074, 'eval_loss': 1.0363923, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [236, 241, 223, 209, 210, 199, 159, 178, 198, 146, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79713816, 'remaining_params': 5303784, 'pruned_model_sparsity': 0.9376154584462512, 'expected_sparsity': 0.93355, 'target_sparsity': 0.95, 'step': 7700}


Iteration:  96%|█████████▌| 110/115 [00:27<00:02,  2.08it/s][A03/23/2024 21:53:42 - INFO - trainer.trainer - v4 Global step: 7700, Alignment: tensor([1, 5, 7, 8], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  2.45it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.85it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  3.21it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  3.52it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.94it/s][A03/23/2024 21:53:43 - INFO - trainer.trainer - Epoch 66 finished. Took 28.48 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.04it/s]
Epoch:  67%|██████▋   | 67/100 [32:21<15:29, 28.16s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.56it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.37it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.35it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.35it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.34it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.37it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.44it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.42it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.53it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.54it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.49it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.45it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.41it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.45it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.31it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.36it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.43it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.24it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.28it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.35it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.46it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.46it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.48it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.53it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.54it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.47it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.44it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.43it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.45it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.27it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.29it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.35it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.37it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.44it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.46it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.51it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.52it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.53it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.59it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.52it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.48it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.54it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:53:53,862 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:53:53 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:53:53 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:53:53 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:53:53 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.19it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.53it/s]03/23/2024 21:53:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:53:54 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8460176991150442, 'combined_score': 0.8163912024986986, 'eval_loss': 0.9363991, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [236, 241, 223, 208, 210, 199, 158, 178, 198, 146, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79713816, 'remaining_params': 5303784, 'pruned_model_sparsity': 0.9376154584462512, 'expected_sparsity': 0.93359, 'target_sparsity': 0.95, 'step': 7750}


Iteration:  39%|███▉      | 45/115 [00:11<00:33,  2.09it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:27,  2.49it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.21it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:19,  3.47it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:17,  3.73it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.78it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  3.96it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.17it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.14it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.30it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.36it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.38it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.34it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.29it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.35it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.30it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.32it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.36it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.43it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.47it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.28it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.26it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.22it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.29it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.37it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.36it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.48it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.49it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.40it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.39it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.38it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.49it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.47it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.46it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.49it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.56it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.56it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.51it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.54it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.50it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.53it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.47it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.45it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.44it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.48it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:06,038 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:06 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.18it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.51it/s]03/23/2024 21:54:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:06 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8441330998248686, 'combined_score': 0.8129979224614539, 'eval_loss': 0.96786636, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [235, 241, 222, 207, 210, 199, 158, 178, 198, 146, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79716880, 'remaining_params': 5300720, 'pruned_model_sparsity': 0.9376514980427582, 'expected_sparsity': 0.93363, 'target_sparsity': 0.95, 'step': 7800}


Iteration:  83%|████████▎ | 95/115 [00:23<00:09,  2.10it/s][A03/23/2024 21:54:06 - INFO - trainer.trainer - v4 Global step: 7800, Alignment: tensor([ 1,  2,  7, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:23<00:07,  2.48it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:04,  3.59it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:04,  3.73it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  3.93it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.08it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.22it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.30it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.22it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.36it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.42it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.41it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.40it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.37it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.41it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.43it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.42it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.37it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.70it/s][A03/23/2024 21:54:11 - INFO - trainer.trainer - Epoch 67 finished. Took 27.63 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.16it/s]
Epoch:  68%|██████▊   | 68/100 [32:49<14:56, 28.00s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.61it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.72it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.29it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.38it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.39it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.34it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.22it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.38it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.44it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.55it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.48it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.52it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.44it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.34it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.38it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.39it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.39it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.44it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.46it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.49it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.49it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.46it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:18,092 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:18 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.16it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.19it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.52it/s]03/23/2024 21:54:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:18 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8419243986254294, 'combined_score': 0.8082171012734991, 'eval_loss': 1.0322556, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [235, 240, 222, 205, 209, 199, 158, 178, 198, 146, 154, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79719944, 'remaining_params': 5297656, 'pruned_model_sparsity': 0.9376875376392653, 'expected_sparsity': 0.93368, 'target_sparsity': 0.95, 'step': 7850}


Iteration:  26%|██▌       | 30/115 [00:07<00:40,  2.09it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:34,  2.47it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:29,  2.79it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.16it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:23,  3.46it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:22,  3.57it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:20,  3.77it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  3.98it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.10it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.12it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.22it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.19it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.26it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.34it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.31it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.35it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.36it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.35it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.39it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.46it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.55it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.54it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.50it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.52it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.48it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.38it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.39it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.42it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.30it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.40it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.34it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.38it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.43it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.41it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.35it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.34it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.36it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.37it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.48it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.45it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.44it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.48it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.43it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.46it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.48it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.51it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.55it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:30,292 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:30 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.56it/s]03/23/2024 21:54:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:31 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8481675392670157, 'combined_score': 0.8174661225746843, 'eval_loss': 0.9998078, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [235, 240, 222, 204, 209, 199, 157, 178, 197, 146, 153, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79721476, 'remaining_params': 5296124, 'pruned_model_sparsity': 0.9377055574375188, 'expected_sparsity': 0.93377, 'target_sparsity': 0.95, 'step': 7900}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.11it/s][A03/23/2024 21:54:31 - INFO - trainer.trainer - v4 Global step: 7900, Alignment: tensor([ 1,  2,  7, 11], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:20<00:13,  2.51it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:11,  2.89it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.24it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.52it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  3.82it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  3.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.15it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.27it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.33it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.40it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.45it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.37it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.27it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.30it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.23it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.32it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.38it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.41it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.45it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.40it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.46it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.46it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.55it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.55it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.44it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.40it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.39it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.44it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.47it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.36it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.40it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.66it/s][A03/23/2024 21:54:38 - INFO - trainer.trainer - Epoch 68 finished. Took 27.62 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.16it/s]
Epoch:  69%|██████▉   | 69/100 [33:16<14:24, 27.89s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.50it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.38it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.40it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.46it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.34it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.42it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.42it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.32it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.36it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.45it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.49it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.52it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:42,315 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:42 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.52it/s]03/23/2024 21:54:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7892156862745098, 'f1': 0.8506944444444444, 'combined_score': 0.8199550653594772, 'eval_loss': 0.9723772, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [235, 240, 221, 203, 209, 199, 157, 178, 197, 146, 153, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79723008, 'remaining_params': 5294592, 'pruned_model_sparsity': 0.9377235772357724, 'expected_sparsity': 0.93388, 'target_sparsity': 0.95, 'step': 7950}


Iteration:  13%|█▎        | 15/115 [00:04<00:47,  2.12it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:39,  2.49it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:30,  3.20it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.52it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:25,  3.72it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  3.93it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.15it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.31it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.34it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.20it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.09it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.18it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.24it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.26it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.34it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.45it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.43it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.43it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.35it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.41it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.33it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.37it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.42it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.47it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.35it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.41it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.37it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.35it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.20it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.25it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.35it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.41it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.47it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.50it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.51it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.54it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.54it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.45it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.47it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.50it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.50it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.52it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.54it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.53it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 21:54:54,465 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:54:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:54:54 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:54:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:54:54 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.53it/s]03/23/2024 21:54:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:54:55 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8426573426573426, 'combined_score': 0.8110345536816125, 'eval_loss': 0.9583836, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [234, 239, 221, 202, 208, 199, 157, 177, 197, 146, 153, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79729136, 'remaining_params': 5288464, 'pruned_model_sparsity': 0.9377956564287865, 'expected_sparsity': 0.93417, 'target_sparsity': 0.95, 'step': 8000}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.11it/s][A03/23/2024 21:54:55 - INFO - trainer.trainer - v4 Global step: 8000, Alignment: tensor([ 1,  2,  7, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.90it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:14,  3.24it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:13,  3.51it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:12,  3.71it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.74it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:11,  3.89it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  3.93it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:10,  4.09it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.23it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.17it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.25it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.24it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.32it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.35it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.35it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.40it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.49it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.40it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.42it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.47it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.50it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.51it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.53it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.53it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.43it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.48it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.40it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.43it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.48it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.46it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.44it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.52it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.44it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.43it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.40it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.43it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.44it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.48it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.48it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.50it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:06,573 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:06 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:06 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:06 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:06 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.54it/s]03/23/2024 21:55:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:07 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7671568627450981, 'f1': 0.8347826086956521, 'combined_score': 0.8009697357203751, 'eval_loss': 0.96854866, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [234, 239, 221, 201, 208, 199, 156, 177, 197, 146, 153, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79729136, 'remaining_params': 5288464, 'pruned_model_sparsity': 0.9377956564287865, 'expected_sparsity': 0.93534, 'target_sparsity': 0.95, 'step': 8050}


Iteration: 100%|██████████| 115/115 [00:28<00:00,  2.16it/s][A03/23/2024 21:55:07 - INFO - trainer.trainer - Epoch 69 finished. Took 28.45 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.04it/s]
Epoch:  70%|███████   | 70/100 [33:45<14:01, 28.06s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.57it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.66it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.48it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.45it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.48it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.45it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.38it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.48it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.49it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.52it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.52it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.54it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.54it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.31it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.30it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.27it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.35it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.46it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.40it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.43it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.42it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.38it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.36it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.42it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.39it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.37it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.38it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.38it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.45it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.43it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.38it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.40it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:18,  4.42it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.46it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.49it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.51it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.60it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.48it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.57it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.47it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.50it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.57it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.57it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.51it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:15,  4.39it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.36it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:18,663 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:18 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:18 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:18 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:18 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.52it/s]03/23/2024 21:55:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:19 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7867647058823529, 'f1': 0.8397790055248618, 'combined_score': 0.8132718557036074, 'eval_loss': 0.9113529, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [234, 238, 220, 200, 208, 199, 156, 177, 196, 146, 153, 174], 'head_nums': [2, 4, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79733732, 'remaining_params': 5283868, 'pruned_model_sparsity': 0.9378497158235471, 'expected_sparsity': 0.93736, 'target_sparsity': 0.95, 'step': 8100}


Iteration:  43%|████▎     | 50/115 [00:12<00:31,  2.09it/s][A03/23/2024 21:55:19 - INFO - trainer.trainer - v4 Global step: 8100, Alignment: tensor([ 1,  2,  7, 11], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:12<00:25,  2.49it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:21,  2.86it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:19,  3.23it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:17,  3.52it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:16,  3.73it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:15,  3.91it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  4.10it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.51it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.44it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.55it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.56it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.56it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.56it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.35it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.41it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.32it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.32it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.38it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.39it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.46it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.47it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.57it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.53it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.49it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.28it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.11it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:08,  4.24it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.39it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.43it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.47it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.37it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.41it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.39it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.44it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.49it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.47it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.45it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.40it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.43it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.34it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.34it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.41it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.41it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.32it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.40it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:30,799 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:30 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:30 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:30 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:30 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.54it/s]03/23/2024 21:55:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:31 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8409893992932862, 'combined_score': 0.8102005819995843, 'eval_loss': 0.92081213, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [233, 237, 220, 198, 208, 199, 156, 177, 196, 146, 153, 174], 'head_nums': [2, 3, 2, 3, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 79932892, 'remaining_params': 5084708, 'pruned_model_sparsity': 0.940192289596507, 'expected_sparsity': 0.93794, 'target_sparsity': 0.95, 'step': 8150}


Iteration:  87%|████████▋ | 100/115 [00:24<00:07,  2.06it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:05,  2.45it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.84it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.21it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:03,  3.52it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  3.82it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  3.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.12it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.22it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.31it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.38it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.43it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.45it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.49it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.30it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.57it/s][A03/23/2024 21:55:34 - INFO - trainer.trainer - Epoch 70 finished. Took 27.54 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  71%|███████   | 71/100 [34:12<13:29, 27.90s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.40it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.59it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.54it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.34it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.37it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.52it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.55it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.33it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.33it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.39it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.30it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.36it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.36it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.47it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.45it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.43it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.48it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.50it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.52it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.58it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.53it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.45it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.39it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.43it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.40it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:19,  4.28it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:19,  4.37it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.42it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:42,837 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:42 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:42 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:42 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:42 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.16it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.17it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.51it/s]03/23/2024 21:55:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:43 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8374558303886926, 'combined_score': 0.8059828171551306, 'eval_loss': 0.9076341, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [233, 237, 220, 197, 208, 199, 155, 177, 196, 146, 153, 174], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80128988, 'remaining_params': 4888612, 'pruned_model_sparsity': 0.9424988237729599, 'expected_sparsity': 0.93814, 'target_sparsity': 0.95, 'step': 8200}


Iteration:  30%|███       | 35/115 [00:08<00:38,  2.09it/s][A03/23/2024 21:55:43 - INFO - trainer.trainer - v4 Global step: 8200, Alignment: tensor([ 1,  2,  7, 11], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:08<00:31,  2.51it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:27,  2.85it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.22it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.53it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.78it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  3.98it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.13it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.14it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.26it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.32it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.35it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.29it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.29it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.33it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.34it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.30it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.38it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.43it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.20it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.27it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.41it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.52it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.54it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.47it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.50it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.44it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.42it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.31it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.35it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.37it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.40it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.46it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.47it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.51it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.46it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.51it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.39it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.44it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.47it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.33it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.40it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.39it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:08,  4.34it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.36it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.47it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.50it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.41it/s][A[INFO|trainer.py:570] 2024-03-23 21:55:54,986 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:55:54 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:55:54 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:55:54 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:55:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.18it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.50it/s]03/23/2024 21:55:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:55:55 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8385964912280701, 'combined_score': 0.8065531475748193, 'eval_loss': 0.93694544, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [233, 236, 219, 196, 208, 199, 155, 177, 196, 146, 153, 174], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80132052, 'remaining_params': 4885548, 'pruned_model_sparsity': 0.942534863369467, 'expected_sparsity': 0.93822, 'target_sparsity': 0.95, 'step': 8250}


Iteration:  74%|███████▍  | 85/115 [00:20<00:14,  2.10it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:11,  2.47it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:09,  2.83it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.18it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.50it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:06,  3.67it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:06,  3.86it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.01it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.13it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  4.15it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.19it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.35it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.41it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.38it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.33it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.32it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.35it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.29it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.37it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.44it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.43it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.42it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.43it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.40it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.40it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.43it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.42it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.37it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.47it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.72it/s][A03/23/2024 21:56:02 - INFO - trainer.trainer - Epoch 71 finished. Took 27.65 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.16it/s]
Epoch:  72%|███████▏  | 72/100 [34:40<12:59, 27.83s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.24it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.34it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.46it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.50it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.47it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.44it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.48it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.48it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.52it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.47it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.30it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.38it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.28it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.37it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:23,  4.20it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.35it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:07,160 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:07 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.56it/s]03/23/2024 21:56:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:08 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8409893992932862, 'combined_score': 0.8102005819995843, 'eval_loss': 0.930479, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [233, 235, 219, 195, 208, 199, 155, 177, 195, 146, 153, 174], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80135116, 'remaining_params': 4882484, 'pruned_model_sparsity': 0.9425709029659741, 'expected_sparsity': 0.93826, 'target_sparsity': 0.95, 'step': 8300}


Iteration:  17%|█▋        | 20/115 [00:05<00:45,  2.08it/s][A03/23/2024 21:56:08 - INFO - trainer.trainer - v4 Global step: 8300, Alignment: tensor([0, 2, 7, 9], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:38,  2.44it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:32,  2.83it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:29,  3.12it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:26,  3.47it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.73it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  3.89it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.05it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.15it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.26it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.25it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.30it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.37it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.44it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.46it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.49it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:18,  4.34it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.41it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.43it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.37it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.42it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.38it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.39it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:16,  4.36it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.38it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.45it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.46it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.44it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.41it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.45it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.53it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.54it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.51it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.51it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.53it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.55it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:11,  4.61it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.53it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.54it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.42it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.47it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.49it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.49it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.52it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:19,218 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:19 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.53it/s]03/23/2024 21:56:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7696078431372549, 'f1': 0.833922261484099, 'combined_score': 0.801765052310677, 'eval_loss': 0.8992199, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [233, 235, 218, 194, 208, 199, 154, 177, 195, 146, 153, 174], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80136648, 'remaining_params': 4880952, 'pruned_model_sparsity': 0.9425889227642277, 'expected_sparsity': 0.93832, 'target_sparsity': 0.95, 'step': 8350}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.12it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  2.89it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:12,  3.25it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:11,  3.46it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.68it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:10,  3.87it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.11it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.29it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.35it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.41it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.37it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.39it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.32it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.34it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.39it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.44it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.48it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.43it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.19it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.25it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.27it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.42it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.25it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.34it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.46it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.42it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.51it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.53it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.57it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.64it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.57it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.53it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.49it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.49it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.34it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.37it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.48it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.39it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.49it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.76it/s][A03/23/2024 21:56:30 - INFO - trainer.trainer - Epoch 72 finished. Took 27.54 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  73%|███████▎  | 73/100 [35:07<12:29, 27.74s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.57it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.52it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:31,267 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:31 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.17it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.52it/s]03/23/2024 21:56:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8351254480286737, 'combined_score': 0.8048176259751212, 'eval_loss': 0.8709084, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [233, 234, 218, 192, 208, 199, 154, 177, 195, 146, 153, 174], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80138180, 'remaining_params': 4879420, 'pruned_model_sparsity': 0.9426069425624812, 'expected_sparsity': 0.93836, 'target_sparsity': 0.95, 'step': 8400}


Iteration:   4%|▍         | 5/115 [00:01<00:57,  1.90it/s][A03/23/2024 21:56:32 - INFO - trainer.trainer - v4 Global step: 8400, Alignment: tensor([ 0,  2,  7, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:46,  2.34it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.78it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.18it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:30,  3.48it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:28,  3.71it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:26,  3.87it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:25,  4.02it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.15it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.23it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:23,  4.32it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.38it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:21,  4.50it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.41it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.44it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.33it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.33it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.33it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.37it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.35it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.31it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.25it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.34it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.40it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.34it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.40it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.43it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.50it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.46it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.50it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.42it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.23it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.30it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.29it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.40it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.44it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.53it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.52it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.55it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.54it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.48it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.45it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.45it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.48it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.44it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.52it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.54it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:43,423 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:43 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:43 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:43 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:43 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.18it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.52it/s]03/23/2024 21:56:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8359788359788359, 'combined_score': 0.8040188297541239, 'eval_loss': 0.93784225, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [232, 233, 218, 191, 208, 199, 154, 177, 194, 146, 153, 174], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80142776, 'remaining_params': 4874824, 'pruned_model_sparsity': 0.9426610019572418, 'expected_sparsity': 0.93841, 'target_sparsity': 0.95, 'step': 8450}


Iteration:  48%|████▊     | 55/115 [00:14<00:28,  2.08it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:23,  2.48it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:20,  2.88it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.23it/s][A
Iteration:  51%|█████▏    | 59/115 [00:15<00:16,  3.43it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:15,  3.67it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  3.90it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:13,  4.03it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.09it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:12,  4.20it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.30it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.36it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.36it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:10,  4.47it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.50it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.49it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.50it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.24it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.30it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.39it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.50it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.59it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.53it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.52it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.42it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.51it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.25it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.30it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.34it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.31it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.36it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.39it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.42it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.45it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.49it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.51it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.43it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.43it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.38it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.34it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.38it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.44it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.53it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.53it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.53it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.48it/s][A[INFO|trainer.py:570] 2024-03-23 21:56:55,553 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:56:55 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:56:55 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:56:55 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:56:55 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.15it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.16it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.51it/s]03/23/2024 21:56:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:56:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8390596745027125, 'combined_score': 0.8104612098003758, 'eval_loss': 0.89496076, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [232, 232, 217, 190, 207, 199, 154, 177, 194, 146, 153, 174], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80147372, 'remaining_params': 4870228, 'pruned_model_sparsity': 0.9427150613520024, 'expected_sparsity': 0.93846, 'target_sparsity': 0.95, 'step': 8500}


Iteration:  91%|█████████▏| 105/115 [00:26<00:04,  2.09it/s][A03/23/2024 21:56:56 - INFO - trainer.trainer - v4 Global step: 8500, Alignment: tensor([0, 2, 7, 8], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:26<00:03,  2.47it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.89it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.24it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  3.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  3.76it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  3.91it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.00it/s][A
Iteration:  98%|█████████▊| 113/115 [00:28<00:00,  4.08it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.10it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.46it/s][A03/23/2024 21:56:58 - INFO - trainer.trainer - Epoch 73 finished. Took 28.47 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.04it/s]
Epoch:  74%|███████▍  | 74/100 [35:36<12:07, 27.96s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:23,  4.80it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:23,  4.78it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.31it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.33it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.35it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.39it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.35it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.48it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.50it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.33it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.33it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.39it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.36it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.24it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.28it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.41it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.40it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.36it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.43it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.45it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.56it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.63it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.57it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.46it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.43it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.45it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.48it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.39it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.34it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.38it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.41it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:18,  4.38it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.31it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.39it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.43it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.48it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:07,682 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:07 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:07 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:07 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:07 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.01it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.10it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.17it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.48it/s]03/23/2024 21:57:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:08 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8402777777777776, 'combined_score': 0.8073937908496731, 'eval_loss': 0.95095307, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [232, 232, 217, 189, 207, 199, 153, 177, 194, 146, 153, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80147372, 'remaining_params': 4870228, 'pruned_model_sparsity': 0.9427150613520024, 'expected_sparsity': 0.93851, 'target_sparsity': 0.95, 'step': 8550}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.09it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:29,  2.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:25,  2.82it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.19it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.51it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:18,  3.81it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:17,  3.97it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.09it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:16,  4.18it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.30it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.22it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.31it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.29it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.33it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.26it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.37it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.35it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.37it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.48it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.28it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.28it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.42it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.37it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:12,  4.21it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.29it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.36it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.35it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.46it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.50it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.37it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.39it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.36it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.42it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.47it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.45it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.41it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.35it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.46it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.49it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.52it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.53it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.47it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.54it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.50it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.48it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.55it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.54it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:19,837 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:19 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:19 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:19 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:19 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.17it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.19it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.52it/s]03/23/2024 21:57:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:20 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8374558303886926, 'combined_score': 0.8059828171551306, 'eval_loss': 0.9065096, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [232, 231, 217, 188, 207, 199, 153, 177, 194, 146, 153, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80148904, 'remaining_params': 4868696, 'pruned_model_sparsity': 0.9427330811502559, 'expected_sparsity': 0.93866, 'target_sparsity': 0.95, 'step': 8600}


Iteration:  78%|███████▊  | 90/115 [00:22<00:11,  2.10it/s][A03/23/2024 21:57:20 - INFO - trainer.trainer - v4 Global step: 8600, Alignment: tensor([0, 2, 4, 8], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:22<00:09,  2.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:08,  2.86it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.16it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:06,  3.48it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:05,  3.77it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  3.98it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.12it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.24it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.18it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.29it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.33it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.40it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.40it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.41it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.46it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.36it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.37it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.39it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.45it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.49it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.42it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.44it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.35it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.62it/s][A03/23/2024 21:57:26 - INFO - trainer.trainer - Epoch 74 finished. Took 27.68 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.15it/s]
Epoch:  75%|███████▌  | 75/100 [36:03<11:36, 27.88s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.40it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.50it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.64it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.50it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.41it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.42it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.47it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.49it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.57it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.54it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.33it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.35it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.41it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.37it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.28it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.32it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.44it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.42it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.49it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.38it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.48it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:31,936 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:31 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:31 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:31 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:31 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.16it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.14it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.14it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.16it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.49it/s]03/23/2024 21:57:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8366247755834829, 'combined_score': 0.8067927799486042, 'eval_loss': 0.8620323, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [231, 231, 216, 187, 207, 199, 153, 177, 194, 146, 153, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80151968, 'remaining_params': 4865632, 'pruned_model_sparsity': 0.942769120746763, 'expected_sparsity': 0.93919, 'target_sparsity': 0.95, 'step': 8650}


Iteration:  22%|██▏       | 25/115 [00:06<00:42,  2.10it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:35,  2.51it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.86it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:27,  3.19it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.50it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.77it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.96it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.14it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.25it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.34it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.43it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.43it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.46it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.39it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.40it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.46it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.56it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.53it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.54it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.60it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.40it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.43it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.46it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.44it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.48it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.42it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.26it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.34it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.46it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.45it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.49it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.46it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.46it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.54it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.53it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.51it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.60it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.46it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.48it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.56it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.40it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.32it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.39it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.27it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.21it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:44,010 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 21:57:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:44 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7647058823529411, 'f1': 0.8303886925795053, 'combined_score': 0.7975472874662233, 'eval_loss': 0.8042987, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [231, 231, 216, 186, 207, 199, 153, 177, 193, 146, 153, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80545692, 'remaining_params': 4471908, 'pruned_model_sparsity': 0.9474002088979223, 'expected_sparsity': 0.94099, 'target_sparsity': 0.95, 'step': 8700}


Iteration:  65%|██████▌   | 75/115 [00:18<00:19,  2.07it/s][A03/23/2024 21:57:44 - INFO - trainer.trainer - v4 Global step: 8700, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.47it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:13,  2.85it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:11,  3.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.47it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.66it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  3.86it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.00it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.15it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.29it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.40it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.42it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.46it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.46it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.44it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.42it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.39it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.50it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.50it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.30it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.35it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.18it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.32it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.37it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.35it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.37it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.36it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.35it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.34it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.40it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.47it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.48it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.53it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.50it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.51it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.48it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.56it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.80it/s][A03/23/2024 21:57:53 - INFO - trainer.trainer - Epoch 75 finished. Took 27.52 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  76%|███████▌  | 76/100 [36:31<11:06, 27.77s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.75it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.62it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.53it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.45it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.42it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.30it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 21:57:56,079 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:57:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:57:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:57:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:57:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 21:57:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:57:56 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.841025641025641, 'combined_score': 0.8065422322775264, 'eval_loss': 0.87961084, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [231, 230, 216, 184, 207, 199, 153, 177, 193, 146, 153, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80547224, 'remaining_params': 4470376, 'pruned_model_sparsity': 0.9474182286961759, 'expected_sparsity': 0.94166, 'target_sparsity': 0.95, 'step': 8750}


Iteration:   9%|▊         | 10/115 [00:03<00:50,  2.06it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:42,  2.47it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.87it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.24it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.52it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.76it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:24,  3.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.17it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.26it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.35it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.19it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:22,  4.13it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.20it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.27it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.15it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.23it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.32it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.32it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.44it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.54it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.55it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:17,  4.56it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.42it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.42it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.46it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.48it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.50it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.53it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.49it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.45it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.44it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.48it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.46it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.44it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.46it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.48it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.50it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.50it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.59it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.44it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.48it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.49it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.41it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.40it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.39it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.24it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.34it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:08,211 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:08 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.64it/s]03/23/2024 21:58:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7696078431372549, 'f1': 0.833922261484099, 'combined_score': 0.801765052310677, 'eval_loss': 0.84814376, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [230, 229, 216, 183, 207, 199, 153, 177, 193, 146, 153, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80550288, 'remaining_params': 4467312, 'pruned_model_sparsity': 0.947454268292683, 'expected_sparsity': 0.94183, 'target_sparsity': 0.95, 'step': 8800}


Iteration:  52%|█████▏    | 60/115 [00:15<00:26,  2.06it/s][A03/23/2024 21:58:09 - INFO - trainer.trainer - v4 Global step: 8800, Alignment: tensor([1, 4, 7, 9], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.46it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.83it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:16,  3.20it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:14,  3.47it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.77it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  4.03it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.15it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.30it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.35it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.47it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.50it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.45it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.48it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:08,  4.57it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.48it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.51it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.52it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.49it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.51it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.50it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.46it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.42it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.46it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.48it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.53it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.54it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.60it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.51it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.53it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.35it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.46it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.51it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.52it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.52it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.52it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.47it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.43it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.42it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.39it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.45it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.50it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.44it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.42it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.46it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.43it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.47it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:20,159 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:20 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.56it/s]03/23/2024 21:58:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:21 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8404255319148937, 'combined_score': 0.809918648310388, 'eval_loss': 0.8273619, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [230, 229, 215, 182, 207, 199, 153, 177, 192, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80553352, 'remaining_params': 4464248, 'pruned_model_sparsity': 0.94749030788919, 'expected_sparsity': 0.94189, 'target_sparsity': 0.95, 'step': 8850}


Iteration:  96%|█████████▌| 110/115 [00:27<00:02,  2.11it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  2.52it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.91it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.28it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  3.57it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.98it/s][A03/23/2024 21:58:22 - INFO - trainer.trainer - Epoch 76 finished. Took 28.23 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.07it/s]
Epoch:  77%|███████▋  | 77/100 [36:59<10:41, 27.91s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:28,  4.03it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.39it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.37it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.41it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.42it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.42it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.48it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.44it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.42it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.51it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.60it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.50it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.52it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.50it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.47it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.50it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.31it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.42it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.45it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.41it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.38it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.43it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.48it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.49it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.50it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.51it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.57it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.59it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.56it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.51it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.54it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.62it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.58it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.57it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.56it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.50it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.49it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.51it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.53it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.47it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:32,090 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:32 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.57it/s]03/23/2024 21:58:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:32 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8274582560296846, 'combined_score': 0.7997585397795481, 'eval_loss': 0.82119334, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [230, 229, 215, 181, 207, 199, 153, 177, 192, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80553352, 'remaining_params': 4464248, 'pruned_model_sparsity': 0.94749030788919, 'expected_sparsity': 0.94191, 'target_sparsity': 0.95, 'step': 8900}


Iteration:  39%|███▉      | 45/115 [00:10<00:33,  2.11it/s][A03/23/2024 21:58:33 - INFO - trainer.trainer - v4 Global step: 8900, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:11<00:27,  2.51it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.87it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.54it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:17,  3.80it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.03it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.19it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.30it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.37it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.38it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.45it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.40it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.42it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.45it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.37it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.33it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.18it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:12,  4.25it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.33it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.37it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.34it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:11,  4.34it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.38it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.38it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.39it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.37it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.36it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.42it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.35it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.47it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.50it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.53it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.51it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.48it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.38it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.40it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.46it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.49it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.45it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.40it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.23it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.30it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.37it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.24it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.35it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.31it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:05,  4.33it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.39it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:44,269 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.20it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.53it/s]03/23/2024 21:58:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7818627450980392, 'f1': 0.8446771378708552, 'combined_score': 0.8132699414844472, 'eval_loss': 0.88170326, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [230, 228, 215, 180, 207, 199, 152, 177, 192, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80554884, 'remaining_params': 4462716, 'pruned_model_sparsity': 0.9475083276874435, 'expected_sparsity': 0.94193, 'target_sparsity': 0.95, 'step': 8950}


Iteration:  83%|████████▎ | 95/115 [00:23<00:09,  2.08it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:07,  2.46it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.85it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.09it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.40it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:04,  3.62it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  3.82it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.02it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.22it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.32it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.36it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.34it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.41it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.45it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.54it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.50it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.47it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.50it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.59it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.41it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.65it/s][A03/23/2024 21:58:49 - INFO - trainer.trainer - Epoch 77 finished. Took 27.52 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  78%|███████▊  | 78/100 [37:27<10:11, 27.79s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.58it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.51it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.44it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.37it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.23it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.36it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.45it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.48it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.52it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.52it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.53it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.42it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.42it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.46it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.44it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.48it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.43it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.46it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.45it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.49it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.48it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.43it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.44it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:21,  4.26it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.25it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.33it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.36it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.41it/s][A[INFO|trainer.py:570] 2024-03-23 21:58:56,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:58:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:58:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:58:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:58:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 21:58:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:58:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8391608391608392, 'combined_score': 0.8068353215412039, 'eval_loss': 0.8961548, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [229, 228, 215, 179, 206, 199, 152, 177, 192, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80557948, 'remaining_params': 4459652, 'pruned_model_sparsity': 0.9475443672839506, 'expected_sparsity': 0.94195, 'target_sparsity': 0.95, 'step': 9000}


Iteration:  26%|██▌       | 30/115 [00:07<00:40,  2.10it/s][A03/23/2024 21:58:57 - INFO - trainer.trainer - v4 Global step: 9000, Alignment: tensor([ 2,  4,  7, 11], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.49it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:28,  2.90it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.27it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:22,  3.57it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:20,  3.81it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  3.96it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.12it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.19it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.29it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.36it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.43it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.47it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.50it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.45it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.24it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.29it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.33it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.33it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.18it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.14it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.21it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.20it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.32it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.37it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.47it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.50it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.53it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.51it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.53it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.46it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.50it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.48it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.38it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.35it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.42it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.46it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.47it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.35it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.42it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.45it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.50it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.53it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.53it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.54it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.56it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.34it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:08,489 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:08 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.59it/s]03/23/2024 21:59:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8417391304347825, 'combined_score': 0.809349957374254, 'eval_loss': 0.90919, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [229, 228, 215, 178, 206, 199, 152, 177, 192, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80557948, 'remaining_params': 4459652, 'pruned_model_sparsity': 0.9475443672839506, 'expected_sparsity': 0.94197, 'target_sparsity': 0.95, 'step': 9050}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.08it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.48it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:11,  2.88it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:10,  3.18it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.45it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:08,  3.63it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  3.84it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:07,  3.99it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.09it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.21it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.33it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.39it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.45it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.36it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.38it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.39it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.50it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.53it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.45it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.44it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.48it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.50it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.48it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.53it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.38it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.43it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.45it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.43it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.33it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.41it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.52it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.52it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.52it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.43it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.68it/s][A03/23/2024 21:59:17 - INFO - trainer.trainer - Epoch 78 finished. Took 27.59 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.17it/s]
Epoch:  79%|███████▉  | 79/100 [37:54<09:42, 27.73s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.54it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.36it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.28it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:26,  4.17it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.24it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.27it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.36it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.29it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.26it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.41it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.42it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.42it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.47it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.41it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:20,608 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:20 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 21:59:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:21 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8399311531841653, 'combined_score': 0.8059949883567885, 'eval_loss': 0.9346565, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [229, 228, 215, 177, 206, 199, 152, 177, 192, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80557948, 'remaining_params': 4459652, 'pruned_model_sparsity': 0.9475443672839506, 'expected_sparsity': 0.94197, 'target_sparsity': 0.95, 'step': 9100}


Iteration:  13%|█▎        | 15/115 [00:04<00:47,  2.09it/s][A03/23/2024 21:59:21 - INFO - trainer.trainer - v4 Global step: 9100, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:39,  2.49it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:29,  3.24it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.52it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:26,  3.64it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:24,  3.85it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:23,  4.00it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:22,  4.11it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.23it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.34it/s][A
Iteration:  23%|██▎       | 27/115 [00:07<00:20,  4.25it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.30it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.38it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.43it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.48it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.48it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:17,  4.51it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.50it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:17,  4.53it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.54it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.44it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.49it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.48it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.41it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.41it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.41it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.53it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.47it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.44it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.49it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.54it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.56it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.54it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.53it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.53it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.50it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.52it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.54it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.55it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.53it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.49it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.46it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.43it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.43it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.48it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:32,660 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:32 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.59it/s]03/23/2024 21:59:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8426573426573426, 'combined_score': 0.8110345536816125, 'eval_loss': 0.91143215, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [229, 227, 215, 176, 206, 199, 152, 177, 192, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80559480, 'remaining_params': 4458120, 'pruned_model_sparsity': 0.9475623870822042, 'expected_sparsity': 0.94199, 'target_sparsity': 0.95, 'step': 9150}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.09it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.48it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.88it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:14,  3.24it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:12,  3.54it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:12,  3.71it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.92it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.10it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.23it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.33it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.38it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.46it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.49it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.48it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.44it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.43it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.42it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.37it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.43it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.49it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.43it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.40it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.45it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.47it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.54it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:04,  4.60it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.43it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.34it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.45it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.49it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.57it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.55it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.49it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.53it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.40it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.21it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.30it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.33it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.32it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.45it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.55it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.54it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.50it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.52it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.53it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.54it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:44,657 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:44 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.56it/s]03/23/2024 21:59:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8421052631578948, 'combined_score': 0.8107585139318886, 'eval_loss': 0.9156964, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [229, 227, 215, 176, 206, 199, 152, 177, 191, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80561012, 'remaining_params': 4456588, 'pruned_model_sparsity': 0.9475804068804577, 'expected_sparsity': 0.94201, 'target_sparsity': 0.95, 'step': 9200}


Iteration: 100%|██████████| 115/115 [00:28<00:00,  2.16it/s][A03/23/2024 21:59:45 - INFO - trainer.trainer - Epoch 79 finished. Took 28.32 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.06it/s]
Epoch:  80%|████████  | 80/100 [38:23<09:18, 27.91s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A03/23/2024 21:59:45 - INFO - trainer.trainer - v4 Global step: 9200, Alignment: tensor([ 0,  2,  7, 11], device='cuda:0')

Iteration:   1%|          | 1/115 [00:00<00:25,  4.45it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.35it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.36it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.52it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.45it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.39it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.43it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.49it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.33it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.39it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.37it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.40it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.47it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.46it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.51it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.52it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.40it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.42it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.47it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.47it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.45it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.39it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.51it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.38it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.39it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.44it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.43it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.39it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.36it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.41it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.46it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.49it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.50it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.52it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.53it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.49it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:17,  4.29it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.39it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.43it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.46it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.49it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.48it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.49it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 21:59:56,756 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 21:59:56 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 21:59:56 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 21:59:56 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 21:59:56 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.58it/s]03/23/2024 21:59:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 21:59:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8411867364746947, 'combined_score': 0.8090737603942101, 'eval_loss': 0.92151016, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [229, 227, 215, 175, 205, 199, 152, 177, 191, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80562544, 'remaining_params': 4455056, 'pruned_model_sparsity': 0.9475984266787112, 'expected_sparsity': 0.94203, 'target_sparsity': 0.95, 'step': 9250}


Iteration:  43%|████▎     | 50/115 [00:12<00:31,  2.08it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:26,  2.43it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:22,  2.80it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:19,  3.20it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:17,  3.52it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:16,  3.73it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:15,  3.85it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:14,  3.97it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.14it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.24it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.34it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.34it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.42it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.38it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.43it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.42it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.45it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.29it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.27it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.36it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.35it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.33it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.36it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.53it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.54it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.56it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.50it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.46it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.49it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.53it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.52it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.49it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.29it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.30it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.36it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.39it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.39it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.50it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.47it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:05,  4.31it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.38it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.37it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.39it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:04,  4.43it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.35it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:08,930 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:08 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:08 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:08 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:08 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.58it/s]03/23/2024 22:00:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8374558303886926, 'combined_score': 0.8059828171551306, 'eval_loss': 0.9214806, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [229, 226, 214, 174, 205, 199, 152, 177, 191, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80565608, 'remaining_params': 4451992, 'pruned_model_sparsity': 0.9476344662752183, 'expected_sparsity': 0.94207, 'target_sparsity': 0.95, 'step': 9300}


Iteration:  87%|████████▋ | 100/115 [00:24<00:07,  2.09it/s][A03/23/2024 22:00:09 - INFO - trainer.trainer - v4 Global step: 9300, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  88%|████████▊ | 101/115 [00:24<00:05,  2.48it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.88it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.27it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:03,  3.57it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  3.81it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.01it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.12it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.28it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.38it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.39it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.45it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.46it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.48it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.56it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.80it/s][A03/23/2024 22:00:13 - INFO - trainer.trainer - Epoch 80 finished. Took 27.52 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  81%|████████  | 81/100 [38:50<08:48, 27.79s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.34it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.53it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.55it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.62it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.45it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.49it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.45it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.46it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.47it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.39it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.41it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.47it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.50it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.53it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.51it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.52it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.49it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.46it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.43it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.42it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.37it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.42it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.44it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.35it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.42it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.44it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.48it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.49it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.49it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:20,864 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:20 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:20 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:20 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:20 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.62it/s]03/23/2024 22:00:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:21 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8432055749128919, 'combined_score': 0.8113086698093872, 'eval_loss': 0.9465135, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 226, 214, 173, 205, 199, 152, 177, 191, 146, 152, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80567140, 'remaining_params': 4450460, 'pruned_model_sparsity': 0.9476524860734719, 'expected_sparsity': 0.94211, 'target_sparsity': 0.95, 'step': 9350}


Iteration:  30%|███       | 35/115 [00:08<00:38,  2.10it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:31,  2.51it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:26,  2.89it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:23,  3.23it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.55it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:19,  3.80it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  3.97it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.07it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.21it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.32it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.34it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.37it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.43it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.46it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.50it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.44it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.23it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.38it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.40it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.21it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.32it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.39it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.31it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.31it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.35it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.45it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.46it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.42it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.38it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.44it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.43it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.48it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.51it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.50it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.51it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.54it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.61it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.45it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.51it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.51it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.54it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.54it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.46it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.54it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.49it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.51it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.53it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.50it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:32,920 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:32 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:32 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:32 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:32 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.55it/s]03/23/2024 22:00:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:33 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8448275862068965, 'combined_score': 0.8121196754563894, 'eval_loss': 0.9502693, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 226, 214, 172, 205, 199, 151, 177, 191, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80567140, 'remaining_params': 4450460, 'pruned_model_sparsity': 0.9476524860734719, 'expected_sparsity': 0.94214, 'target_sparsity': 0.95, 'step': 9400}


Iteration:  74%|███████▍  | 85/115 [00:20<00:14,  2.10it/s][A03/23/2024 22:00:33 - INFO - trainer.trainer - v4 Global step: 9400, Alignment: tensor([ 0,  2,  7, 11], device='cuda:0')

Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.51it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:09,  2.82it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.49it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.76it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:06,  3.95it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.12it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.21it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.42it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.40it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.33it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.36it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.41it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.41it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.47it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.44it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.41it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.45it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.47it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.55it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.54it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.56it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.32it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.39it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.44it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.44it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.68it/s][A03/23/2024 22:00:40 - INFO - trainer.trainer - Epoch 81 finished. Took 27.45 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.19it/s]
Epoch:  82%|████████▏ | 82/100 [39:18<08:18, 27.69s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.42it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.63it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.57it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.46it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.35it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.26it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.31it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.34it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.57it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.51it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.44it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.43it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.37it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.43it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.31it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:44,988 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:44 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:44 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:44 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.57it/s]03/23/2024 22:00:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:45 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8362989323843417, 'combined_score': 0.8054043681529552, 'eval_loss': 0.9100503, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 225, 214, 172, 205, 199, 151, 177, 191, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80568672, 'remaining_params': 4448928, 'pruned_model_sparsity': 0.9476705058717254, 'expected_sparsity': 0.94217, 'target_sparsity': 0.95, 'step': 9450}


Iteration:  17%|█▋        | 20/115 [00:05<00:45,  2.09it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:37,  2.50it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:32,  2.90it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:28,  3.24it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.55it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:23,  3.80it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  3.95it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.12it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.22it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.26it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.18it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.26it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.35it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.33it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:19,  4.20it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.25it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.28it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.36it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.36it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.43it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.47it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.40it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.36it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.35it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.40it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.45it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.45it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.29it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.30it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.27it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.32it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.34it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.35it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.40it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.45it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.47it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.45it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.48it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.51it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.51it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.54it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.54it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.53it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.54it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.57it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.54it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.43it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 22:00:57,111 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:00:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:00:57 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:00:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:00:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 22:00:57 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:00:57 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7696078431372549, 'f1': 0.8321428571428571, 'combined_score': 0.8008753501400561, 'eval_loss': 0.89860445, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 225, 214, 171, 205, 199, 151, 177, 191, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80568672, 'remaining_params': 4448928, 'pruned_model_sparsity': 0.9476705058717254, 'expected_sparsity': 0.94219, 'target_sparsity': 0.95, 'step': 9500}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.11it/s][A03/23/2024 22:00:58 - INFO - trainer.trainer - v4 Global step: 9500, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.48it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  2.90it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:12,  3.29it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:11,  3.49it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.74it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  3.92it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.09it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.18it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.29it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.35it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.32it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.39it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.41it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.45it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.50it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.51it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.54it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:05,  4.51it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.59it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.55it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.46it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.44it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.47it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.51it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.53it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.52it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.50it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.48it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.43it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.41it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.40it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.38it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.33it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.40it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.44it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.48it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.47it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.44it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.47it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.56it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.53it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.28it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.35it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.71it/s][A03/23/2024 22:01:07 - INFO - trainer.trainer - Epoch 82 finished. Took 27.52 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  83%|████████▎ | 83/100 [39:45<07:49, 27.64s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:29,  3.90it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.35it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.46it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:09,124 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 22:01:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:09 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8419243986254294, 'combined_score': 0.8082171012734991, 'eval_loss': 0.9452037, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 224, 214, 171, 205, 199, 151, 177, 191, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80570204, 'remaining_params': 4447396, 'pruned_model_sparsity': 0.947688525669979, 'expected_sparsity': 0.94221, 'target_sparsity': 0.95, 'step': 9550}


Iteration:   4%|▍         | 5/115 [00:01<00:58,  1.89it/s][A
Iteration:   5%|▌         | 6/115 [00:02<00:46,  2.35it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:38,  2.78it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.16it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:30,  3.53it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:27,  3.79it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:25,  4.00it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:24,  4.17it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:23,  4.25it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.36it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:22,  4.36it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.32it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:22,  4.38it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.40it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.37it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.39it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.41it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.43it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.33it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.35it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.39it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.39it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.49it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.54it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.57it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.49it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.46it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.45it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.39it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.42it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.45it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.43it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.32it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.33it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.36it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.43it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.47it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.48it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.50it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.58it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.37it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.40it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.35it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.34it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:21,213 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 22:01:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7696078431372549, 'f1': 0.8327402135231317, 'combined_score': 0.8011740283301934, 'eval_loss': 0.91015, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 224, 213, 170, 205, 199, 151, 177, 191, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80571736, 'remaining_params': 4445864, 'pruned_model_sparsity': 0.9477065454682324, 'expected_sparsity': 0.94223, 'target_sparsity': 0.95, 'step': 9600}


Iteration:  48%|████▊     | 55/115 [00:14<00:28,  2.08it/s][A03/23/2024 22:01:22 - INFO - trainer.trainer - v4 Global step: 9600, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  49%|████▊     | 56/115 [00:14<00:23,  2.47it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:20,  2.84it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.18it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:16,  3.44it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:14,  3.67it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:14,  3.85it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:13,  4.02it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.17it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:11,  4.28it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.41it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.45it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:10,  4.48it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.43it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.43it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.45it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.47it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.50it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.51it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.45it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.49it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.48it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.41it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.41it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.52it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.33it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.33it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.47it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.47it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.50it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.46it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.47it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.50it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.53it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.51it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.53it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.56it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.32it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.33it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.39it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.44it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.48it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.36it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.34it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.37it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.43it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.44it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.44it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:33,298 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.59it/s]03/23/2024 22:01:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8371278458844134, 'combined_score': 0.8045933347069125, 'eval_loss': 0.9245661, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 224, 213, 170, 205, 199, 151, 177, 191, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 80571736, 'remaining_params': 4445864, 'pruned_model_sparsity': 0.9477065454682324, 'expected_sparsity': 0.94224, 'target_sparsity': 0.95, 'step': 9650}


Iteration:  91%|█████████▏| 105/115 [00:26<00:04,  2.09it/s][A
Iteration:  92%|█████████▏| 106/115 [00:26<00:03,  2.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.88it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.22it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  3.51it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  3.72it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  3.93it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.05it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.12it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.15it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.50it/s][A03/23/2024 22:01:36 - INFO - trainer.trainer - Epoch 83 finished. Took 28.37 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.05it/s]
Epoch:  84%|████████▍ | 84/100 [40:14<07:25, 27.86s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.57it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.39it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:26,  4.30it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.40it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.33it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.35it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.32it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.43it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.47it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.34it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.30it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.38it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.28it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.36it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.52it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.50it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.48it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.40it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.45it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.54it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.49it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.51it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.47it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.56it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.56it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.47it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.55it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.52it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.49it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.52it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.41it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.48it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.50it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.54it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.61it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.58it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:45,337 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:45 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.21it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.55it/s]03/23/2024 22:01:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8380281690140845, 'combined_score': 0.8062689864678265, 'eval_loss': 0.91751605, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [228, 224, 213, 169, 204, 198, 151, 177, 191, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80573268, 'remaining_params': 4444332, 'pruned_model_sparsity': 0.947724565266486, 'expected_sparsity': 0.94226, 'target_sparsity': 0.95, 'step': 9700}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.10it/s][A03/23/2024 22:01:46 - INFO - trainer.trainer - v4 Global step: 9700, Alignment: tensor([ 0,  2,  7, 11], device='cuda:0')

Iteration:  36%|███▌      | 41/115 [00:10<00:29,  2.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:25,  2.89it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.20it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.44it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:19,  3.65it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:17,  3.89it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.07it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:16,  4.14it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.30it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.32it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:15,  4.25it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.27it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.33it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.38it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.44it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.45it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.43it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.33it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.41it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.32it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.44it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.42it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.48it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.49it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.42it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.46it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.48it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.56it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.23it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.50it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.47it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.50it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.51it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.53it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.51it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:08,  4.31it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.43it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.46it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.44it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.47it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.50it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.47it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.44it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 22:01:57,444 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:01:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:01:57 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:01:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:01:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.56it/s]03/23/2024 22:01:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:01:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.842832469775475, 'combined_score': 0.8098966270446002, 'eval_loss': 0.94263214, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 224, 213, 169, 204, 198, 151, 177, 191, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80574800, 'remaining_params': 4442800, 'pruned_model_sparsity': 0.9477425850647395, 'expected_sparsity': 0.94228, 'target_sparsity': 0.95, 'step': 9750}


Iteration:  78%|███████▊  | 90/115 [00:21<00:11,  2.12it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:09,  2.52it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:07,  2.90it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:07,  3.13it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:06,  3.45it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:05,  3.73it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  3.94it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.11it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.22it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.25it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.31it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.31it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.31it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.34it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.43it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.37it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.43it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.47it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.40it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.33it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.38it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.43it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.44it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.49it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.46it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.70it/s][A03/23/2024 22:02:03 - INFO - trainer.trainer - Epoch 84 finished. Took 27.53 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  85%|████████▌ | 85/100 [40:41<06:56, 27.76s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:26,  4.38it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.42it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.49it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.38it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.43it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.43it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.40it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.38it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.43it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.47it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.42it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.44it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.49it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.36it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.42it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.53it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.51it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.45it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.38it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.43it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.47it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.52it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.49it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:09,521 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.20it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.54it/s]03/23/2024 22:02:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8406304728546411, 'combined_score': 0.8087956285841833, 'eval_loss': 0.92209226, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 223, 212, 168, 204, 198, 151, 177, 190, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80579396, 'remaining_params': 4438204, 'pruned_model_sparsity': 0.9477966444595002, 'expected_sparsity': 0.94231, 'target_sparsity': 0.95, 'step': 9800}


Iteration:  22%|██▏       | 25/115 [00:06<00:42,  2.10it/s][A03/23/2024 22:02:10 - INFO - trainer.trainer - v4 Global step: 9800, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 26/115 [00:06<00:35,  2.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.89it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:26,  3.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.48it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.75it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.93it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.09it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.23it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.33it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.35it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.38it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.33it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.35it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.37it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.26it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.36it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.44it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.46it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.48it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.39it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.44it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.43it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.48it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.46it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.51it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.49it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.47it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.48it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.51it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.42it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.45it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.47it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.49it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.24it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.22it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.38it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.31it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.38it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.48it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.48it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.30it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.33it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.47it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.42it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:21,618 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:21 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:21 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:21 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:21 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.61it/s]03/23/2024 22:02:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8391608391608392, 'combined_score': 0.8068353215412039, 'eval_loss': 0.9163173, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 223, 212, 168, 204, 198, 150, 177, 190, 146, 151, 173], 'head_nums': [2, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80579396, 'remaining_params': 4438204, 'pruned_model_sparsity': 0.9477966444595002, 'expected_sparsity': 0.94233, 'target_sparsity': 0.95, 'step': 9850}


Iteration:  65%|██████▌   | 75/115 [00:18<00:18,  2.12it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:15,  2.45it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:13,  2.78it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:12,  3.03it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.37it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.66it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  3.89it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  4.02it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.11it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.24it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.31it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.34it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.37it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.31it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.25it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.14it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.23it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.30it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.34it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.40it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.43it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.43it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.47it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.42it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.35it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.45it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.57it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.53it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.45it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.55it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.49it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.43it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.47it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.47it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.56it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.46it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.50it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.73it/s][A03/23/2024 22:02:31 - INFO - trainer.trainer - Epoch 85 finished. Took 27.61 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.16it/s]
Epoch:  86%|████████▌ | 86/100 [41:09<06:28, 27.72s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.75it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.63it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.61it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:23,  4.69it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.62it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.52it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.59it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.42it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:24,  4.41it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:33,719 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:33 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:33 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:33 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:33 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.56it/s]03/23/2024 22:02:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:34 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8406304728546411, 'combined_score': 0.8087956285841833, 'eval_loss': 0.89676684, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 223, 212, 167, 203, 198, 150, 177, 190, 146, 151, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80580928, 'remaining_params': 4436672, 'pruned_model_sparsity': 0.9478146642577537, 'expected_sparsity': 0.94235, 'target_sparsity': 0.95, 'step': 9900}


Iteration:   9%|▊         | 10/115 [00:03<00:50,  2.06it/s][A03/23/2024 22:02:34 - INFO - trainer.trainer - v4 Global step: 9900, Alignment: tensor([0, 2, 8, 9], device='cuda:0')

Iteration:  10%|▉         | 11/115 [00:03<00:42,  2.47it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.87it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:31,  3.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:28,  3.55it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.77it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:25,  3.89it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:24,  4.00it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:23,  4.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:22,  4.31it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.34it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.41it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.42it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.43it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.45it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.44it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.39it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.40it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.46it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.47it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.35it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.47it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.47it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.48it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.46it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.48it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.52it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.53it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.43it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.44it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.46it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.50it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.51it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.52it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.50it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.45it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 50/115 [00:11<00:14,  4.60it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:13,  4.60it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.54it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.50it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.51it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.49it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.51it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.59it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.53it/s][A
Iteration:  51%|█████▏    | 59/115 [00:13<00:12,  4.56it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:45,710 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:45 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:45 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:45 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:45 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.57it/s]03/23/2024 22:02:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:46 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8391608391608392, 'combined_score': 0.8068353215412039, 'eval_loss': 0.8925613, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 223, 212, 167, 203, 198, 150, 177, 190, 146, 151, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80580928, 'remaining_params': 4436672, 'pruned_model_sparsity': 0.9478146642577537, 'expected_sparsity': 0.94238, 'target_sparsity': 0.95, 'step': 9950}


Iteration:  52%|█████▏    | 60/115 [00:15<00:26,  2.10it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.51it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.90it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:16,  3.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:14,  3.49it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.74it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  3.89it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:12,  3.99it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.05it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:11,  4.16it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.22it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.34it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.26it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.29it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.42it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.45it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.51it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.46it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.55it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.45it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.47it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.46it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.42it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.37it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.41it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.22it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.29it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.34it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.41it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.47it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.52it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.42it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.44it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.26it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.32it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.20it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.28it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.37it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.39it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.45it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.50it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.41it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.46it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.49it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.48it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.40it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.36it/s][A[INFO|trainer.py:570] 2024-03-23 22:02:57,903 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:02:57 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:02:57 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:02:57 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:02:57 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 22:02:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:02:58 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8402777777777776, 'combined_score': 0.8073937908496731, 'eval_loss': 0.9205995, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 223, 211, 166, 203, 198, 150, 177, 190, 146, 151, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80582460, 'remaining_params': 4435140, 'pruned_model_sparsity': 0.9478326840560072, 'expected_sparsity': 0.94241, 'target_sparsity': 0.95, 'step': 10000}


Iteration:  96%|█████████▌| 110/115 [00:27<00:02,  2.09it/s][A03/23/2024 22:02:58 - INFO - trainer.trainer - v4 Global step: 10000, Alignment: tensor([ 0,  1,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  2.49it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.87it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.24it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  3.53it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.97it/s][A03/23/2024 22:02:59 - INFO - trainer.trainer - Epoch 86 finished. Took 28.3 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.06it/s]
Epoch:  87%|████████▋ | 87/100 [41:37<06:02, 27.89s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.60it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.45it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.54it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.49it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.44it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.42it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.41it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.31it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.35it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.39it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.37it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.39it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.44it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.48it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.45it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.50it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.49it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.42it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.46it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.50it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.48it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.48it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.42it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.37it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.36it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.26it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:20,  4.35it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.37it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.43it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.47it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.43it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.40it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.52it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.54it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.51it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.48it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.50it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:17,  4.45it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.49it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:15,  4.58it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:15,  4.53it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:15,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:09,930 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:09 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:09 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:09 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:09 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 22:03:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:10 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8382608695652173, 'combined_score': 0.8051598465473145, 'eval_loss': 0.9147711, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 222, 211, 166, 203, 198, 150, 177, 189, 146, 150, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80585524, 'remaining_params': 4432076, 'pruned_model_sparsity': 0.9478687236525143, 'expected_sparsity': 0.94243, 'target_sparsity': 0.95, 'step': 10050}


Iteration:  39%|███▉      | 45/115 [00:10<00:33,  2.10it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:27,  2.49it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.88it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:20,  3.24it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:18,  3.56it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:17,  3.65it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.88it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.08it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.27it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.12it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.25it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.26it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.36it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:13,  4.27it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.39it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.29it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.36it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.29it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.36it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.38it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.30it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.39it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.37it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.37it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.30it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.33it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.38it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.40it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.41it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.36it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.44it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.39it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.39it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.44it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.39it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.39it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.40it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.33it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.40it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.51it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.59it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:05,  4.56it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.57it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.45it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.55it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.56it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.45it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:22,104 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 22:03:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:22 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8382608695652173, 'combined_score': 0.8051598465473145, 'eval_loss': 0.91943324, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 222, 211, 165, 202, 198, 150, 177, 189, 146, 150, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80587056, 'remaining_params': 4430544, 'pruned_model_sparsity': 0.9478867434507678, 'expected_sparsity': 0.94246, 'target_sparsity': 0.95, 'step': 10100}


Iteration:  83%|████████▎ | 95/115 [00:23<00:09,  2.11it/s][A03/23/2024 22:03:23 - INFO - trainer.trainer - v4 Global step: 10100, Alignment: tensor([ 0,  2,  7, 11], device='cuda:0')

Iteration:  83%|████████▎ | 96/115 [00:23<00:07,  2.49it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.76it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.10it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:04,  3.44it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:04,  3.70it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  3.87it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.03it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.18it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.35it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.38it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.43it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.53it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.39it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.44it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.44it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.49it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.49it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.58it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.53it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.73it/s][A03/23/2024 22:03:27 - INFO - trainer.trainer - Epoch 87 finished. Took 27.6 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.17it/s]
Epoch:  88%|████████▊ | 88/100 [42:05<05:33, 27.80s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.41it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.52it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.48it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.47it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.49it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.47it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.49it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.51it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.48it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.36it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.39it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.49it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.49it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.46it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.32it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.49it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.38it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.42it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.40it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.50it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.49it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.47it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:20,  4.26it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:34,164 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:34 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.21it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.26it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.57it/s]03/23/2024 22:03:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:35 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7671568627450981, 'f1': 0.8347826086956521, 'combined_score': 0.8009697357203751, 'eval_loss': 0.9322722, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 222, 210, 165, 202, 198, 150, 177, 189, 146, 150, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80588588, 'remaining_params': 4429012, 'pruned_model_sparsity': 0.9479047632490214, 'expected_sparsity': 0.94249, 'target_sparsity': 0.95, 'step': 10150}


Iteration:  26%|██▌       | 30/115 [00:07<00:41,  2.07it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:34,  2.46it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:30,  2.76it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:26,  3.14it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:23,  3.46it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:21,  3.76it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  3.96it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.14it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.26it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.34it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.39it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.37it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.38it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.36it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.48it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.45it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.50it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.59it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.57it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.52it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.52it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.43it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.48it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.45it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.41it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.40it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.46it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.46it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.50it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.48it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.44it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.48it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.43it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.45it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.40it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.40it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.45it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.45it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.48it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.49it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.57it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.57it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.57it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.58it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.55it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.62it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.58it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.52it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:46,176 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:46 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.58it/s]03/23/2024 22:03:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8422876949740035, 'combined_score': 0.8096242396438644, 'eval_loss': 0.93329597, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 222, 210, 165, 201, 198, 150, 177, 189, 146, 150, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80590120, 'remaining_params': 4427480, 'pruned_model_sparsity': 0.947922783047275, 'expected_sparsity': 0.94251, 'target_sparsity': 0.95, 'step': 10200}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.08it/s][A03/23/2024 22:03:47 - INFO - trainer.trainer - v4 Global step: 10200, Alignment: tensor([0, 2, 4, 7], device='cuda:0')

Iteration:  70%|███████   | 81/115 [00:19<00:14,  2.43it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:11,  2.82it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:10,  3.19it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:08,  3.48it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:08,  3.71it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:07,  3.98it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.07it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.24it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.33it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.39it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.38it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.50it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.54it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.62it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.60it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.59it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.51it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.53it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.53it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.61it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.59it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.58it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.55it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.62it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.61it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.37it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.40it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.39it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.39it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.45it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.45it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.47it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.61it/s][A03/23/2024 22:03:54 - INFO - trainer.trainer - Epoch 88 finished. Took 27.38 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.20it/s]
Epoch:  89%|████████▉ | 89/100 [42:32<05:04, 27.68s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.44it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.36it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.45it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.49it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.39it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.46it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.50it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.28it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.42it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.33it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.40it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.47it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.45it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.50it/s][A[INFO|trainer.py:570] 2024-03-23 22:03:58,183 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:03:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:03:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:03:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:03:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.59it/s]03/23/2024 22:03:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:03:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8402777777777776, 'combined_score': 0.8073937908496731, 'eval_loss': 0.9355925, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 221, 210, 164, 201, 198, 150, 177, 189, 146, 150, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80591652, 'remaining_params': 4425948, 'pruned_model_sparsity': 0.9479408028455285, 'expected_sparsity': 0.94253, 'target_sparsity': 0.95, 'step': 10250}


Iteration:  13%|█▎        | 15/115 [00:04<00:48,  2.07it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:39,  2.48it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:34,  2.84it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:30,  3.17it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.48it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:25,  3.79it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:23,  3.99it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:22,  4.10it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.22it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:21,  4.29it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.33it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:20,  4.25it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.28it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.32it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.28it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:19,  4.36it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.48it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.46it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.49it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.42it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.41it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.41it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.46it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.47it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.52it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.50it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.50it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.39it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.41it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.52it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.51it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.48it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.51it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.54it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.49it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.47it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.46it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.56it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.41it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.35it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.37it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.36it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:13,  4.14it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.23it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.29it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:10,311 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:10 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 22:04:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8448275862068965, 'combined_score': 0.8121196754563894, 'eval_loss': 0.9497062, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 221, 209, 164, 201, 198, 150, 177, 189, 146, 150, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80593184, 'remaining_params': 4424416, 'pruned_model_sparsity': 0.947958822643782, 'expected_sparsity': 0.94257, 'target_sparsity': 0.95, 'step': 10300}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.09it/s][A03/23/2024 22:04:11 - INFO - trainer.trainer - v4 Global step: 10300, Alignment: tensor([ 0,  2,  7, 11], device='cuda:0')

Iteration:  57%|█████▋    | 66/115 [00:16<00:20,  2.44it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.83it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:14,  3.19it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:12,  3.54it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:12,  3.70it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:11,  3.83it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  3.99it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:10,  4.10it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.19it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.18it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  4.33it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.29it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.35it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.39it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.42it/s][A
Iteration:  70%|███████   | 81/115 [00:20<00:07,  4.36it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.39it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.38it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.39it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.37it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.35it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.36it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.43it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.48it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.51it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.48it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.47it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.39it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.42it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.45it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.47it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.49it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.49it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.51it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.53it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.46it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.45it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.49it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.34it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.40it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.37it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.48it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.55it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.56it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:22,391 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.64it/s]03/23/2024 22:04:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.837696335078534, 'combined_score': 0.8048775793039729, 'eval_loss': 0.9292652, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 221, 209, 163, 200, 198, 150, 177, 189, 146, 150, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80594716, 'remaining_params': 4422884, 'pruned_model_sparsity': 0.9479768424420355, 'expected_sparsity': 0.94261, 'target_sparsity': 0.95, 'step': 10350}


Iteration: 100%|██████████| 115/115 [00:28<00:00,  2.18it/s][A03/23/2024 22:04:23 - INFO - trainer.trainer - Epoch 89 finished. Took 28.45 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.04it/s]
Epoch:  90%|█████████ | 90/100 [43:00<04:39, 27.91s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.56it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.65it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.45it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.49it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.47it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.48it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.53it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:25,  4.28it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.32it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:24,  4.34it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.42it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.45it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.49it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.48it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.57it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.42it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.43it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.38it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.43it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.50it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.51it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.45it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.45it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.41it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.46it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.49it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.46it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.49it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.48it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.50it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.54it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:17,  4.54it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.52it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.55it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:16,  4.62it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.50it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.49it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.51it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.48it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.41it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:16,  4.33it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.34it/s][A
Iteration:  40%|████      | 46/115 [00:10<00:15,  4.35it/s][A
Iteration:  41%|████      | 47/115 [00:10<00:15,  4.37it/s][A
Iteration:  42%|████▏     | 48/115 [00:10<00:15,  4.41it/s][A
Iteration:  43%|████▎     | 49/115 [00:10<00:14,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:34,446 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:34 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.23it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.58it/s]03/23/2024 22:04:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:35 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8413793103448276, 'combined_score': 0.8079445571331981, 'eval_loss': 0.9555239, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 221, 209, 163, 200, 198, 150, 177, 189, 146, 150, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80594716, 'remaining_params': 4422884, 'pruned_model_sparsity': 0.9479768424420355, 'expected_sparsity': 0.94266, 'target_sparsity': 0.95, 'step': 10400}


Iteration:  43%|████▎     | 50/115 [00:12<00:30,  2.10it/s][A03/23/2024 22:04:35 - INFO - trainer.trainer - v4 Global step: 10400, Alignment: tensor([1, 4, 7, 9], device='cuda:0')

Iteration:  44%|████▍     | 51/115 [00:12<00:25,  2.52it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:21,  2.91it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:19,  3.24it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:17,  3.52it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:15,  3.83it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:14,  4.02it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.17it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.28it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.33it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.37it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.37it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.44it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.45it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.42it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.38it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.38it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:11,  4.36it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.34it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.46it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:09,  4.51it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.38it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.38it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.43it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.43it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.33it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.40it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.42it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.46it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.33it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:08,  4.27it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.36it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.32it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.29it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.33it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.39it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.32it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.36it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.41it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.46it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.48it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.58it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:04,  4.63it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.65it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.58it/s][A
Iteration:  83%|████████▎ | 96/115 [00:22<00:04,  4.58it/s][A
Iteration:  84%|████████▍ | 97/115 [00:22<00:03,  4.62it/s][A
Iteration:  85%|████████▌ | 98/115 [00:22<00:03,  4.63it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.58it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:46,486 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:46 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:46 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.61it/s]03/23/2024 22:04:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8422876949740035, 'combined_score': 0.8096242396438644, 'eval_loss': 0.9370705, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 220, 209, 163, 200, 198, 149, 177, 189, 146, 150, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80596248, 'remaining_params': 4421352, 'pruned_model_sparsity': 0.9479948622402891, 'expected_sparsity': 0.9427, 'target_sparsity': 0.95, 'step': 10450}


Iteration:  87%|████████▋ | 100/115 [00:24<00:07,  2.12it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:05,  2.53it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:04,  2.90it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:03,  3.23it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:03,  3.50it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  3.78it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  3.96it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.03it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.01it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.17it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.26it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.32it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.16it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.18it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.28it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.58it/s][A03/23/2024 22:04:50 - INFO - trainer.trainer - Epoch 90 finished. Took 27.49 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  91%|█████████ | 91/100 [43:28<04:10, 27.78s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.45it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.52it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.51it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.44it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.32it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.41it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.40it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.37it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.38it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.53it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.45it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.40it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.45it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.49it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.47it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.57it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.53it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.54it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.46it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.49it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.45it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.38it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.41it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.41it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.29it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.37it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:19,  4.38it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:19,  4.41it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:19,  4.39it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.40it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.41it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.38it/s][A[INFO|trainer.py:570] 2024-03-23 22:04:58,617 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:04:58 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:04:58 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:04:58 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:04:58 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 22:04:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:04:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8422876949740035, 'combined_score': 0.8096242396438644, 'eval_loss': 0.9493411, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 220, 209, 162, 200, 198, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80596248, 'remaining_params': 4421352, 'pruned_model_sparsity': 0.9479948622402891, 'expected_sparsity': 0.94274, 'target_sparsity': 0.95, 'step': 10500}


Iteration:  30%|███       | 35/115 [00:08<00:38,  2.09it/s][A03/23/2024 22:04:59 - INFO - trainer.trainer - v4 Global step: 10500, Alignment: tensor([0, 2, 7, 9], device='cuda:0')

Iteration:  31%|███▏      | 36/115 [00:08<00:32,  2.44it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:27,  2.83it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:24,  3.18it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:21,  3.51it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:20,  3.71it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:18,  3.90it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:17,  4.07it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:17,  4.16it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.24it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:16,  4.33it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.39it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.43it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.47it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.45it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.49it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.57it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.39it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.33it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.41it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.43it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.43it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.38it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.38it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.42it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.51it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.58it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.44it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:10,  4.58it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.60it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.36it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.40it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.44it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.53it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.61it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.58it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.49it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:09,  4.40it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.52it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.46it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.44it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.51it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.57it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.53it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.44it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.45it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:10,652 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:10 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:10 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:10 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:10 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.22it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.24it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.55it/s]03/23/2024 22:05:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:11 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8442906574394463, 'combined_score': 0.8118512110726643, 'eval_loss': 0.9539123, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 220, 208, 162, 200, 198, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80597780, 'remaining_params': 4419820, 'pruned_model_sparsity': 0.9480128820385426, 'expected_sparsity': 0.94277, 'target_sparsity': 0.95, 'step': 10550}


Iteration:  74%|███████▍  | 85/115 [00:20<00:14,  2.10it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:11,  2.51it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:09,  2.86it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:08,  3.21it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:07,  3.52it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:06,  3.79it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:06,  3.98it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.16it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.22it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.24it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.27it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.29it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.24it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.26it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.21it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.31it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.12it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.13it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.11it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.14it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.26it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.26it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.35it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.41it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.51it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.49it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.55it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.55it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.56it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.77it/s][A03/23/2024 22:05:18 - INFO - trainer.trainer - Epoch 91 finished. Took 27.58 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.17it/s]
Epoch:  92%|█████████▏| 92/100 [43:55<03:41, 27.72s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.55it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.41it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.47it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.40it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.24it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.35it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:25,  4.30it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.35it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:24,  4.37it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.40it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.44it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:24,  4.19it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.21it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.37it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.49it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.45it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.45it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:22,855 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:22 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:22 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:22 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:22 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.60it/s]03/23/2024 22:05:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:23 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.8411867364746947, 'combined_score': 0.8090737603942101, 'eval_loss': 0.94389176, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [226, 220, 208, 162, 200, 198, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80599312, 'remaining_params': 4418288, 'pruned_model_sparsity': 0.9480309018367962, 'expected_sparsity': 0.94281, 'target_sparsity': 0.95, 'step': 10600}


Iteration:  17%|█▋        | 20/115 [00:05<00:45,  2.10it/s][A03/23/2024 22:05:23 - INFO - trainer.trainer - v4 Global step: 10600, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 21/115 [00:05<00:37,  2.49it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:33,  2.81it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:28,  3.18it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:25,  3.51it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:24,  3.74it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:22,  3.91it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:21,  4.09it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:20,  4.22it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:20,  4.13it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:20,  4.18it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.25it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:19,  4.22it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.33it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.39it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.40it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:17,  4.39it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.33it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.40it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.46it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.34it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.38it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.37it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.37it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.49it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.47it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.51it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.52it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.53it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.38it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.40it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.28it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.34it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.41it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.44it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.38it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:12,  4.52it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.55it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.52it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.53it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.54it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.55it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.53it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.52it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.50it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.52it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.54it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:34,955 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:34 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:34 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:34 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:34 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.61it/s]03/23/2024 22:05:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:35 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7769607843137255, 'f1': 0.842832469775475, 'combined_score': 0.8098966270446002, 'eval_loss': 0.95597166, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [226, 219, 208, 161, 200, 198, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80600844, 'remaining_params': 4416756, 'pruned_model_sparsity': 0.9480489216350497, 'expected_sparsity': 0.94284, 'target_sparsity': 0.95, 'step': 10650}


Iteration:  61%|██████    | 70/115 [00:17<00:21,  2.12it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:17,  2.50it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:14,  2.89it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:12,  3.25it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:11,  3.60it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:10,  3.82it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:09,  3.97it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:09,  4.13it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.24it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.25it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:08,  4.30it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.37it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.43it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.47it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.46it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.49it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.47it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.42it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.16it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.30it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.37it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.29it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.36it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.42it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.44it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.40it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.44it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.41it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.30it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.24it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.33it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.41it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.47it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.56it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.55it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.54it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.55it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.56it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.61it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.60it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.58it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.57it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.57it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.77it/s][A03/23/2024 22:05:45 - INFO - trainer.trainer - Epoch 92 finished. Took 27.54 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  93%|█████████▎| 93/100 [44:23<03:13, 27.67s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:27,  4.13it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:26,  4.29it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.40it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:46,991 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:46 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:46 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:46 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.22it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.56it/s]03/23/2024 22:05:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:47 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8365553602811951, 'combined_score': 0.8043070919053035, 'eval_loss': 0.92683536, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [226, 219, 208, 161, 199, 198, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80602376, 'remaining_params': 4415224, 'pruned_model_sparsity': 0.9480669414333032, 'expected_sparsity': 0.94287, 'target_sparsity': 0.95, 'step': 10700}


Iteration:   4%|▍         | 5/115 [00:01<00:58,  1.89it/s][A03/23/2024 22:05:47 - INFO - trainer.trainer - v4 Global step: 10700, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:   5%|▌         | 6/115 [00:02<00:46,  2.34it/s][A
Iteration:   6%|▌         | 7/115 [00:02<00:39,  2.76it/s][A
Iteration:   7%|▋         | 8/115 [00:02<00:33,  3.16it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:30,  3.50it/s][A
Iteration:   9%|▊         | 10/115 [00:03<00:27,  3.78it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:26,  3.96it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:25,  4.11it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:24,  4.23it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.31it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:22,  4.40it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:22,  4.37it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:22,  4.38it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.45it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:21,  4.51it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.44it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:20,  4.45it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.48it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.42it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.47it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.54it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.46it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.45it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.48it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.50it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.48it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.47it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.37it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.39it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:18,  4.23it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:18,  4.32it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.43it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.48it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.56it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.53it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.47it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.25it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.34it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.40it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.41it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.41it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.45it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.46it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.46it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.51it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.41it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 22:05:59,051 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:05:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:05:59 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:05:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:05:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.59it/s]03/23/2024 22:05:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:05:59 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.841549295774648, 'combined_score': 0.8104805302402651, 'eval_loss': 0.92862105, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [226, 219, 208, 161, 199, 198, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80602376, 'remaining_params': 4415224, 'pruned_model_sparsity': 0.9480669414333032, 'expected_sparsity': 0.94293, 'target_sparsity': 0.95, 'step': 10750}


Iteration:  48%|████▊     | 55/115 [00:14<00:28,  2.10it/s][A
Iteration:  49%|████▊     | 56/115 [00:14<00:23,  2.50it/s][A
Iteration:  50%|████▉     | 57/115 [00:14<00:20,  2.90it/s][A
Iteration:  50%|█████     | 58/115 [00:14<00:17,  3.21it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:16,  3.49it/s][A
Iteration:  52%|█████▏    | 60/115 [00:15<00:14,  3.76it/s][A
Iteration:  53%|█████▎    | 61/115 [00:15<00:13,  3.94it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:13,  4.07it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.20it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:11,  4.29it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:11,  4.35it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:11,  4.35it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.08it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.27it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.40it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.43it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.38it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.50it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.48it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.32it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.39it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.44it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.48it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.46it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.45it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.44it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.47it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.40it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.29it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.36it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.43it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.41it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.42it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.36it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.49it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.50it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.52it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.53it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.59it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.54it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.47it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.44it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.46it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.45it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.41it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.46it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.54it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.43it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:11,160 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.31it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 22:06:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:06:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8413793103448276, 'combined_score': 0.8079445571331981, 'eval_loss': 0.96800786, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [226, 219, 207, 160, 199, 198, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80603908, 'remaining_params': 4413692, 'pruned_model_sparsity': 0.9480849612315567, 'expected_sparsity': 0.94301, 'target_sparsity': 0.95, 'step': 10800}


Iteration:  91%|█████████▏| 105/115 [00:26<00:04,  2.09it/s][A03/23/2024 22:06:12 - INFO - trainer.trainer - v4 Global step: 10800, Alignment: tensor([ 0,  2,  7, 11], device='cuda:0')

Iteration:  92%|█████████▏| 106/115 [00:26<00:03,  2.48it/s][A
Iteration:  93%|█████████▎| 107/115 [00:26<00:02,  2.84it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:02,  3.21it/s][A
Iteration:  95%|█████████▍| 109/115 [00:27<00:01,  3.52it/s][A
Iteration:  96%|█████████▌| 110/115 [00:27<00:01,  3.66it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  3.91it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.04it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.18it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  4.24it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.55it/s][A03/23/2024 22:06:14 - INFO - trainer.trainer - Epoch 93 finished. Took 28.37 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.05it/s]
Epoch:  94%|█████████▍| 94/100 [44:51<02:47, 27.88s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.46it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.43it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.58it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.54it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:23,  4.63it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.53it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.46it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.33it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.44it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.53it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.60it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.51it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.50it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.52it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.47it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.30it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.43it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.29it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.35it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.38it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.39it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.39it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.41it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:20,  4.46it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.50it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.62it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:18,  4.66it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.57it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.59it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.53it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:18,  4.56it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.53it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:18,  4.44it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.39it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:17,  4.44it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.40it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.42it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:17,  4.44it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:23,177 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.33it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.29it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 22:06:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:06:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8421052631578948, 'combined_score': 0.8107585139318886, 'eval_loss': 0.9377143, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [226, 219, 207, 160, 199, 198, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80609670, 'remaining_params': 4407930, 'pruned_model_sparsity': 0.9481527354336043, 'expected_sparsity': 0.94309, 'target_sparsity': 0.95, 'step': 10850}


Iteration:  35%|███▍      | 40/115 [00:09<00:35,  2.09it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:29,  2.49it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:25,  2.88it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:22,  3.23it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:20,  3.41it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:19,  3.66it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:17,  3.85it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.04it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.23it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.21it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:15,  4.30it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.43it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.41it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.41it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.51it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.53it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.54it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.57it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.56it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.48it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.50it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.48it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.34it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.35it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.41it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.35it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.42it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.42it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.39it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.35it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.38it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.42it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.45it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.49it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.55it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.49it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.48it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.47it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.50it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.52it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.53it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.50it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.51it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.32it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:07,  4.34it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.38it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.38it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.43it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.36it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.36it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:35,283 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.58it/s]03/23/2024 22:06:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:06:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8432055749128919, 'combined_score': 0.8113086698093872, 'eval_loss': 0.93888706, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [226, 218, 207, 160, 199, 198, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80611200, 'remaining_params': 4406400, 'pruned_model_sparsity': 0.948170731707317, 'expected_sparsity': 0.94317, 'target_sparsity': 0.95, 'step': 10900}


Iteration:  78%|███████▊  | 90/115 [00:21<00:12,  2.08it/s][A03/23/2024 22:06:36 - INFO - trainer.trainer - v4 Global step: 10900, Alignment: tensor([ 0,  2,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 91/115 [00:22<00:09,  2.48it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:08,  2.87it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:06,  3.26it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:05,  3.52it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:05,  3.79it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  3.96it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.05it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:04,  4.17it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.13it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.04it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.15it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.26it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.31it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.28it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.41it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.43it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.43it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.45it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.48it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.49it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.41it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.41it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.45it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.73it/s][A03/23/2024 22:06:41 - INFO - trainer.trainer - Epoch 94 finished. Took 27.51 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  95%|█████████▌| 95/100 [45:19<02:18, 27.77s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:29,  3.88it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:27,  4.18it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.35it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.43it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.41it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:25,  4.30it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.38it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.45it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.47it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.44it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:24,  4.31it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.38it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.44it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.42it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:22,  4.47it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.47it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.46it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.47it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.47it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.48it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.47it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.49it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.56it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:47,360 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.26it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.27it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.27it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.59it/s]03/23/2024 22:06:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:06:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7745098039215687, 'f1': 0.8402777777777776, 'combined_score': 0.8073937908496731, 'eval_loss': 0.9448583, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [226, 218, 207, 160, 198, 197, 149, 177, 189, 146, 149, 173], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80612730, 'remaining_params': 4404870, 'pruned_model_sparsity': 0.9481887279810298, 'expected_sparsity': 0.94327, 'target_sparsity': 0.95, 'step': 10950}


Iteration:  22%|██▏       | 25/115 [00:06<00:42,  2.12it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:35,  2.53it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:30,  2.92it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:26,  3.23it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:24,  3.53it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:22,  3.76it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:21,  3.97it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:20,  4.10it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:19,  4.21it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.27it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:18,  4.35it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.41it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.45it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:16,  4.53it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:16,  4.55it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.55it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.55it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:15,  4.60it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:15,  4.55it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.42it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.42it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:16,  4.31it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.31it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.44it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.50it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.48it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.49it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:13,  4.51it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.40it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.44it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.41it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.38it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.41it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.23it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.24it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:12,  4.24it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:12,  4.24it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.29it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.30it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.38it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.32it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.47it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.39it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:10,  4.37it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.50it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.45it/s][A[INFO|trainer.py:570] 2024-03-23 22:06:59,470 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:06:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:06:59 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:06:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:06:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.28it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.61it/s]03/23/2024 22:07:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:07:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7794117647058824, 'f1': 0.8426573426573426, 'combined_score': 0.8110345536816125, 'eval_loss': 0.93373, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [226, 217, 206, 159, 198, 197, 148, 177, 189, 146, 149, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80615790, 'remaining_params': 4401810, 'pruned_model_sparsity': 0.9482247205284553, 'expected_sparsity': 0.94339, 'target_sparsity': 0.95, 'step': 11000}


Iteration:  65%|██████▌   | 75/115 [00:18<00:19,  2.09it/s][A03/23/2024 22:07:00 - INFO - trainer.trainer - v4 Global step: 11000, Alignment: tensor([ 0,  2,  7, 11], device='cuda:0')

Iteration:  66%|██████▌   | 76/115 [00:18<00:16,  2.43it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:13,  2.79it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:11,  3.10it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:10,  3.39it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:09,  3.68it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:08,  3.90it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:08,  3.99it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.12it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.21it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:07,  4.10it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.24it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.26it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.22it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.32it/s][A
Iteration:  78%|███████▊  | 90/115 [00:22<00:05,  4.39it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.39it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.41it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.50it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.57it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.56it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.57it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.56it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.53it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.47it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.46it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.48it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.28it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.40it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.37it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.35it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.37it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.35it/s][A
Iteration:  94%|█████████▍| 108/115 [00:26<00:01,  4.34it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.37it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.29it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.37it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:00,  4.20it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.26it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.35it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.59it/s][A03/23/2024 22:07:09 - INFO - trainer.trainer - Epoch 95 finished. Took 27.69 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.15it/s]
Epoch:  96%|█████████▌| 96/100 [45:47<01:50, 27.75s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.39it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.51it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:25,  4.42it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:25,  4.31it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:25,  4.35it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.41it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.47it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.50it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.43it/s][A[INFO|trainer.py:570] 2024-03-23 22:07:11,687 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:07:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:07:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:07:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:07:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 22:07:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:07:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7671568627450981, 'f1': 0.838709677419355, 'combined_score': 0.8029332700822265, 'eval_loss': 0.9823179, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [226, 217, 206, 159, 198, 197, 148, 177, 189, 146, 149, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80615790, 'remaining_params': 4401810, 'pruned_model_sparsity': 0.9482247205284553, 'expected_sparsity': 0.94365, 'target_sparsity': 0.95, 'step': 11050}


Iteration:   9%|▊         | 10/115 [00:03<00:50,  2.06it/s][A
Iteration:  10%|▉         | 11/115 [00:03<00:42,  2.46it/s][A
Iteration:  10%|█         | 12/115 [00:03<00:35,  2.87it/s][A
Iteration:  11%|█▏        | 13/115 [00:03<00:32,  3.16it/s][A
Iteration:  12%|█▏        | 14/115 [00:04<00:28,  3.48it/s][A
Iteration:  13%|█▎        | 15/115 [00:04<00:26,  3.74it/s][A
Iteration:  14%|█▍        | 16/115 [00:04<00:25,  3.96it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:23,  4.12it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.30it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:21,  4.43it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:22,  4.25it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:21,  4.36it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:21,  4.36it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:21,  4.31it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:20,  4.39it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:20,  4.44it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:19,  4.52it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.54it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:18,  4.61it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:18,  4.60it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.59it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:19,  4.36it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.39it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.44it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.40it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.47it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.47it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.43it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.39it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.37it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:16,  4.43it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.44it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.46it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.48it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:15,  4.56it/s][A
Iteration:  39%|███▉      | 45/115 [00:10<00:15,  4.39it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.40it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.44it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.42it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.41it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.43it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.48it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.28it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.34it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:14,  4.33it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.40it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.45it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.49it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.62it/s][A[INFO|trainer.py:570] 2024-03-23 22:07:23,744 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:07:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:07:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:07:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:07:23 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.23it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.24it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.25it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.25it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.56it/s]03/23/2024 22:07:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:07:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.7720588235294118, 'f1': 0.8452579034941763, 'combined_score': 0.8086583635117941, 'eval_loss': 1.0269299, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [225, 217, 206, 159, 198, 197, 148, 177, 189, 146, 149, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80617320, 'remaining_params': 4400280, 'pruned_model_sparsity': 0.948242716802168, 'expected_sparsity': 0.94452, 'target_sparsity': 0.95, 'step': 11100}


Iteration:  52%|█████▏    | 60/115 [00:15<00:26,  2.11it/s][A03/23/2024 22:07:24 - INFO - trainer.trainer - v4 Global step: 11100, Alignment: tensor([ 0,  1,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 61/115 [00:15<00:21,  2.50it/s][A
Iteration:  54%|█████▍    | 62/115 [00:15<00:18,  2.89it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:16,  3.23it/s][A
Iteration:  56%|█████▌    | 64/115 [00:16<00:14,  3.52it/s][A
Iteration:  57%|█████▋    | 65/115 [00:16<00:13,  3.74it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:12,  3.90it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:11,  4.09it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:11,  4.27it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:10,  4.40it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:10,  4.42it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:09,  4.52it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.65it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.57it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:08,  4.58it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:08,  4.57it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.62it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.66it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.60it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:07,  4.59it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.48it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.42it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.42it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.46it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:06,  4.55it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.50it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.35it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.48it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.45it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.41it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.35it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.42it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.29it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.36it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.25it/s][A
Iteration:  83%|████████▎ | 95/115 [00:22<00:04,  4.30it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.31it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.35it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.32it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.45it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.44it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.50it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.46it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.45it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.44it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.37it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.42it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.46it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.51it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.47it/s][A[INFO|trainer.py:570] 2024-03-23 22:07:35,777 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:07:35 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:07:35 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:07:35 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:07:35 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.34it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.67it/s]03/23/2024 22:07:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:07:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.5857843137254902, 'f1': 0.6780952380952382, 'combined_score': 0.6319397759103642, 'eval_loss': 0.82588667, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [225, 216, 206, 159, 197, 197, 148, 177, 189, 146, 149, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80950860, 'remaining_params': 4066740, 'pruned_model_sparsity': 0.9521659044715447, 'expected_sparsity': 0.94617, 'target_sparsity': 0.95, 'step': 11150}


Iteration:  96%|█████████▌| 110/115 [00:27<00:02,  2.11it/s][A
Iteration:  97%|█████████▋| 111/115 [00:27<00:01,  2.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:27<00:01,  2.88it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  3.23it/s][A
Iteration:  99%|█████████▉| 114/115 [00:28<00:00,  3.52it/s][A
Iteration: 100%|██████████| 115/115 [00:28<00:00,  3.93it/s][A03/23/2024 22:07:37 - INFO - trainer.trainer - Epoch 96 finished. Took 28.27 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.07it/s]
Epoch:  97%|█████████▋| 97/100 [46:15<01:23, 27.90s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.49it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:25,  4.39it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.56it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.56it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.48it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.53it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.49it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.49it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.49it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.48it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.50it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.53it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:22,  4.48it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:22,  4.52it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:22,  4.52it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:21,  4.52it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:21,  4.49it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:21,  4.45it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:21,  4.48it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:20,  4.54it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:20,  4.55it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:20,  4.56it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:20,  4.58it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:19,  4.57it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:19,  4.63it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:19,  4.68it/s][A
Iteration:  23%|██▎       | 27/115 [00:05<00:18,  4.64it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.52it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.56it/s][A
Iteration:  26%|██▌       | 30/115 [00:06<00:18,  4.51it/s][A
Iteration:  27%|██▋       | 31/115 [00:06<00:19,  4.42it/s][A
Iteration:  28%|██▊       | 32/115 [00:07<00:18,  4.37it/s][A
Iteration:  29%|██▊       | 33/115 [00:07<00:19,  4.29it/s][A
Iteration:  30%|██▉       | 34/115 [00:07<00:18,  4.43it/s][A
Iteration:  30%|███       | 35/115 [00:07<00:18,  4.44it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:17,  4.42it/s][A
Iteration:  32%|███▏      | 37/115 [00:08<00:17,  4.46it/s][A
Iteration:  33%|███▎      | 38/115 [00:08<00:16,  4.57it/s][A
Iteration:  34%|███▍      | 39/115 [00:08<00:16,  4.55it/s][A
Iteration:  35%|███▍      | 40/115 [00:08<00:16,  4.48it/s][A
Iteration:  36%|███▌      | 41/115 [00:09<00:16,  4.44it/s][A
Iteration:  37%|███▋      | 42/115 [00:09<00:17,  4.28it/s][A
Iteration:  37%|███▋      | 43/115 [00:09<00:16,  4.35it/s][A
Iteration:  38%|███▊      | 44/115 [00:09<00:16,  4.42it/s][A[INFO|trainer.py:570] 2024-03-23 22:07:47,721 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:07:47 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:07:47 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:07:47 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:07:47 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.36it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.37it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.70it/s]03/23/2024 22:07:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:07:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6642156862745098, 'f1': 0.7750410509031198, 'combined_score': 0.7196283685888147, 'eval_loss': 0.76594305, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [225, 216, 206, 158, 197, 197, 148, 177, 189, 146, 149, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80950860, 'remaining_params': 4066740, 'pruned_model_sparsity': 0.9521659044715447, 'expected_sparsity': 0.94673, 'target_sparsity': 0.95, 'step': 11200}


Iteration:  39%|███▉      | 45/115 [00:10<00:33,  2.11it/s][A03/23/2024 22:07:48 - INFO - trainer.trainer - v4 Global step: 11200, Alignment: tensor([ 2,  4,  7, 11], device='cuda:0')

Iteration:  40%|████      | 46/115 [00:11<00:28,  2.43it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:23,  2.84it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:21,  3.18it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:19,  3.45it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:17,  3.70it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:16,  3.91it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:15,  4.06it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:14,  4.20it/s][A
Iteration:  47%|████▋     | 54/115 [00:12<00:14,  4.25it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:14,  4.24it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.39it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.35it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:13,  4.27it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.36it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.32it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.39it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.44it/s][A
Iteration:  55%|█████▍    | 63/115 [00:14<00:11,  4.42it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.47it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.39it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:11,  4.45it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.46it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.35it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.40it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.45it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.47it/s][A
Iteration:  63%|██████▎   | 72/115 [00:16<00:09,  4.44it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.54it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:08,  4.61it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.59it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.54it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.60it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.51it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:07,  4.53it/s][A
Iteration:  70%|██████▉   | 80/115 [00:18<00:07,  4.52it/s][A
Iteration:  70%|███████   | 81/115 [00:18<00:07,  4.53it/s][A
Iteration:  71%|███████▏  | 82/115 [00:19<00:07,  4.53it/s][A
Iteration:  72%|███████▏  | 83/115 [00:19<00:07,  4.54it/s][A
Iteration:  73%|███████▎  | 84/115 [00:19<00:06,  4.50it/s][A
Iteration:  74%|███████▍  | 85/115 [00:19<00:06,  4.47it/s][A
Iteration:  75%|███████▍  | 86/115 [00:20<00:06,  4.47it/s][A
Iteration:  76%|███████▌  | 87/115 [00:20<00:06,  4.50it/s][A
Iteration:  77%|███████▋  | 88/115 [00:20<00:06,  4.47it/s][A
Iteration:  77%|███████▋  | 89/115 [00:20<00:05,  4.49it/s][A
Iteration:  78%|███████▊  | 90/115 [00:20<00:05,  4.49it/s][A
Iteration:  79%|███████▉  | 91/115 [00:21<00:05,  4.53it/s][A
Iteration:  80%|████████  | 92/115 [00:21<00:05,  4.32it/s][A
Iteration:  81%|████████  | 93/115 [00:21<00:05,  4.39it/s][A
Iteration:  82%|████████▏ | 94/115 [00:21<00:04,  4.51it/s][A[INFO|trainer.py:570] 2024-03-23 22:07:59,787 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:07:59 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:07:59 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:07:59 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:07:59 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.34it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.67it/s]03/23/2024 22:08:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:08:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6862745098039216, 'f1': 0.7999999999999999, 'combined_score': 0.7431372549019608, 'eval_loss': 0.80445623, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [225, 216, 206, 158, 197, 196, 148, 177, 189, 146, 149, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80950860, 'remaining_params': 4066740, 'pruned_model_sparsity': 0.9521659044715447, 'expected_sparsity': 0.94688, 'target_sparsity': 0.95, 'step': 11250}


Iteration:  83%|████████▎ | 95/115 [00:22<00:09,  2.11it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:07,  2.51it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:06,  2.90it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:05,  3.25it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:04,  3.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  3.75it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  3.94it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:03,  4.09it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.23it/s][A
Iteration:  90%|█████████ | 104/115 [00:24<00:02,  4.32it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.32it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.33it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.34it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.19it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.31it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.28it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.36it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.38it/s][A
Iteration:  98%|█████████▊| 113/115 [00:26<00:00,  4.40it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.34it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.58it/s][A03/23/2024 22:08:05 - INFO - trainer.trainer - Epoch 97 finished. Took 27.43 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.19it/s]
Epoch:  98%|█████████▊| 98/100 [46:42<00:55, 27.76s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:24,  4.57it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.55it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.54it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.47it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.44it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.48it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:23,  4.51it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:23,  4.58it/s][A
Iteration:   8%|▊         | 9/115 [00:01<00:23,  4.57it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:22,  4.59it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:22,  4.56it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:23,  4.42it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.38it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.34it/s][A
Iteration:  13%|█▎        | 15/115 [00:03<00:23,  4.21it/s][A
Iteration:  14%|█▍        | 16/115 [00:03<00:23,  4.14it/s][A
Iteration:  15%|█▍        | 17/115 [00:03<00:22,  4.27it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:22,  4.34it/s][A
Iteration:  17%|█▋        | 19/115 [00:04<00:22,  4.33it/s][A
Iteration:  17%|█▋        | 20/115 [00:04<00:21,  4.39it/s][A
Iteration:  18%|█▊        | 21/115 [00:04<00:21,  4.34it/s][A
Iteration:  19%|█▉        | 22/115 [00:04<00:21,  4.40it/s][A
Iteration:  20%|██        | 23/115 [00:05<00:21,  4.29it/s][A
Iteration:  21%|██        | 24/115 [00:05<00:21,  4.32it/s][A
Iteration:  22%|██▏       | 25/115 [00:05<00:20,  4.39it/s][A
Iteration:  23%|██▎       | 26/115 [00:05<00:20,  4.40it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:19,  4.50it/s][A
Iteration:  24%|██▍       | 28/115 [00:06<00:19,  4.54it/s][A
Iteration:  25%|██▌       | 29/115 [00:06<00:18,  4.53it/s][A[INFO|trainer.py:570] 2024-03-23 22:08:11,894 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:08:11 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:08:11 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:08:11 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:08:11 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.43it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.41it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.36it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.70it/s]03/23/2024 22:08:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:08:12 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6887254901960784, 'f1': 0.8018720748829954, 'combined_score': 0.745298782539537, 'eval_loss': 0.8098841, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [224, 216, 206, 158, 197, 196, 148, 177, 189, 146, 149, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80952390, 'remaining_params': 4065210, 'pruned_model_sparsity': 0.9521839007452575, 'expected_sparsity': 0.94694, 'target_sparsity': 0.95, 'step': 11300}


Iteration:  26%|██▌       | 30/115 [00:07<00:40,  2.12it/s][A03/23/2024 22:08:12 - INFO - trainer.trainer - v4 Global step: 11300, Alignment: tensor([2, 2, 4, 7], device='cuda:0')

Iteration:  27%|██▋       | 31/115 [00:07<00:33,  2.50it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:28,  2.89it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:25,  3.20it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:23,  3.51it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:21,  3.77it/s][A
Iteration:  31%|███▏      | 36/115 [00:08<00:19,  3.97it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:19,  3.94it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:18,  4.13it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:18,  4.17it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.28it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:17,  4.35it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.38it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.36it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.40it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.41it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.39it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:16,  4.25it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:15,  4.25it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:15,  4.30it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.40it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:13,  4.50it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.53it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.54it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.57it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:12,  4.58it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.50it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.37it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.36it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:12,  4.36it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:12,  4.34it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.34it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.40it/s][A
Iteration:  57%|█████▋    | 65/115 [00:15<00:11,  4.40it/s][A
Iteration:  57%|█████▋    | 66/115 [00:15<00:10,  4.46it/s][A
Iteration:  58%|█████▊    | 67/115 [00:15<00:10,  4.49it/s][A
Iteration:  59%|█████▉    | 68/115 [00:16<00:10,  4.51it/s][A
Iteration:  60%|██████    | 69/115 [00:16<00:10,  4.49it/s][A
Iteration:  61%|██████    | 70/115 [00:16<00:10,  4.43it/s][A
Iteration:  62%|██████▏   | 71/115 [00:16<00:09,  4.41it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:09,  4.46it/s][A
Iteration:  63%|██████▎   | 73/115 [00:17<00:09,  4.50it/s][A
Iteration:  64%|██████▍   | 74/115 [00:17<00:09,  4.43it/s][A
Iteration:  65%|██████▌   | 75/115 [00:17<00:08,  4.45it/s][A
Iteration:  66%|██████▌   | 76/115 [00:17<00:08,  4.50it/s][A
Iteration:  67%|██████▋   | 77/115 [00:18<00:08,  4.52it/s][A
Iteration:  68%|██████▊   | 78/115 [00:18<00:08,  4.46it/s][A
Iteration:  69%|██████▊   | 79/115 [00:18<00:08,  4.49it/s][A[INFO|trainer.py:570] 2024-03-23 22:08:23,996 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:08:23 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:08:23 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:08:23 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:08:24 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.40it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.38it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.39it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.41it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.71it/s]03/23/2024 22:08:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:08:24 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.678921568627451, 'f1': 0.7904, 'combined_score': 0.7346607843137255, 'eval_loss': 0.7870529, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [224, 216, 205, 157, 197, 196, 148, 177, 189, 146, 149, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80953920, 'remaining_params': 4063680, 'pruned_model_sparsity': 0.9522018970189702, 'expected_sparsity': 0.94696, 'target_sparsity': 0.95, 'step': 11350}


Iteration:  70%|██████▉   | 80/115 [00:19<00:16,  2.13it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:13,  2.52it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:11,  2.87it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:09,  3.20it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:09,  3.44it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:08,  3.69it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:07,  3.86it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.03it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.09it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:06,  4.22it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.28it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.37it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.48it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:05,  4.29it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.44it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.49it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.48it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:03,  4.51it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.56it/s][A
Iteration:  86%|████████▌ | 99/115 [00:23<00:03,  4.53it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.59it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.51it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.52it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.59it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.52it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.55it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:01,  4.50it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.36it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.41it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.47it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.49it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.47it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.39it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.43it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.47it/s][A
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.64it/s][A03/23/2024 22:08:32 - INFO - trainer.trainer - Epoch 98 finished. Took 27.53 seconds.
Iteration: 100%|██████████| 115/115 [00:27<00:00,  4.18it/s]
Epoch:  99%|█████████▉| 99/100 [47:10<00:27, 27.69s/it]
Iteration:   0%|          | 0/115 [00:00<?, ?it/s][A
Iteration:   1%|          | 1/115 [00:00<00:25,  4.54it/s][A
Iteration:   2%|▏         | 2/115 [00:00<00:24,  4.59it/s][A
Iteration:   3%|▎         | 3/115 [00:00<00:24,  4.57it/s][A
Iteration:   3%|▎         | 4/115 [00:00<00:24,  4.53it/s][A
Iteration:   4%|▍         | 5/115 [00:01<00:24,  4.49it/s][A
Iteration:   5%|▌         | 6/115 [00:01<00:24,  4.52it/s][A
Iteration:   6%|▌         | 7/115 [00:01<00:24,  4.44it/s][A
Iteration:   7%|▋         | 8/115 [00:01<00:24,  4.45it/s][A
Iteration:   8%|▊         | 9/115 [00:02<00:23,  4.46it/s][A
Iteration:   9%|▊         | 10/115 [00:02<00:23,  4.46it/s][A
Iteration:  10%|▉         | 11/115 [00:02<00:23,  4.51it/s][A
Iteration:  10%|█         | 12/115 [00:02<00:22,  4.50it/s][A
Iteration:  11%|█▏        | 13/115 [00:02<00:23,  4.32it/s][A
Iteration:  12%|█▏        | 14/115 [00:03<00:23,  4.35it/s][A[INFO|trainer.py:570] 2024-03-23 22:08:36,049 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:08:36 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:08:36 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:08:36 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:08:36 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.37it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.30it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 22:08:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:08:36 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6593137254901961, 'f1': 0.771004942339374, 'combined_score': 0.715159333914785, 'eval_loss': 0.7971643, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [224, 216, 205, 157, 196, 196, 148, 177, 189, 146, 149, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80955450, 'remaining_params': 4062150, 'pruned_model_sparsity': 0.952219893292683, 'expected_sparsity': 0.94703, 'target_sparsity': 0.95, 'step': 11400}


Iteration:  13%|█▎        | 15/115 [00:04<00:48,  2.05it/s][A03/23/2024 22:08:36 - INFO - trainer.trainer - v4 Global step: 11400, Alignment: tensor([ 0,  4,  7, 11], device='cuda:0')

Iteration:  14%|█▍        | 16/115 [00:04<00:40,  2.46it/s][A
Iteration:  15%|█▍        | 17/115 [00:04<00:34,  2.86it/s][A
Iteration:  16%|█▌        | 18/115 [00:04<00:30,  3.15it/s][A
Iteration:  17%|█▋        | 19/115 [00:05<00:27,  3.44it/s][A
Iteration:  17%|█▋        | 20/115 [00:05<00:25,  3.70it/s][A
Iteration:  18%|█▊        | 21/115 [00:05<00:25,  3.73it/s][A
Iteration:  19%|█▉        | 22/115 [00:05<00:24,  3.87it/s][A
Iteration:  20%|██        | 23/115 [00:06<00:23,  4.00it/s][A
Iteration:  21%|██        | 24/115 [00:06<00:22,  4.12it/s][A
Iteration:  22%|██▏       | 25/115 [00:06<00:21,  4.16it/s][A
Iteration:  23%|██▎       | 26/115 [00:06<00:21,  4.22it/s][A
Iteration:  23%|██▎       | 27/115 [00:06<00:20,  4.34it/s][A
Iteration:  24%|██▍       | 28/115 [00:07<00:19,  4.37it/s][A
Iteration:  25%|██▌       | 29/115 [00:07<00:19,  4.42it/s][A
Iteration:  26%|██▌       | 30/115 [00:07<00:18,  4.48it/s][A
Iteration:  27%|██▋       | 31/115 [00:07<00:18,  4.48it/s][A
Iteration:  28%|██▊       | 32/115 [00:08<00:18,  4.52it/s][A
Iteration:  29%|██▊       | 33/115 [00:08<00:18,  4.43it/s][A
Iteration:  30%|██▉       | 34/115 [00:08<00:18,  4.43it/s][A
Iteration:  30%|███       | 35/115 [00:08<00:17,  4.46it/s][A
Iteration:  31%|███▏      | 36/115 [00:09<00:17,  4.40it/s][A
Iteration:  32%|███▏      | 37/115 [00:09<00:17,  4.41it/s][A
Iteration:  33%|███▎      | 38/115 [00:09<00:17,  4.48it/s][A
Iteration:  34%|███▍      | 39/115 [00:09<00:17,  4.44it/s][A
Iteration:  35%|███▍      | 40/115 [00:09<00:17,  4.32it/s][A
Iteration:  36%|███▌      | 41/115 [00:10<00:16,  4.38it/s][A
Iteration:  37%|███▋      | 42/115 [00:10<00:16,  4.35it/s][A
Iteration:  37%|███▋      | 43/115 [00:10<00:16,  4.37it/s][A
Iteration:  38%|███▊      | 44/115 [00:10<00:16,  4.42it/s][A
Iteration:  39%|███▉      | 45/115 [00:11<00:15,  4.49it/s][A
Iteration:  40%|████      | 46/115 [00:11<00:15,  4.47it/s][A
Iteration:  41%|████      | 47/115 [00:11<00:15,  4.52it/s][A
Iteration:  42%|████▏     | 48/115 [00:11<00:14,  4.49it/s][A
Iteration:  43%|████▎     | 49/115 [00:11<00:14,  4.52it/s][A
Iteration:  43%|████▎     | 50/115 [00:12<00:14,  4.51it/s][A
Iteration:  44%|████▍     | 51/115 [00:12<00:14,  4.51it/s][A
Iteration:  45%|████▌     | 52/115 [00:12<00:14,  4.45it/s][A
Iteration:  46%|████▌     | 53/115 [00:12<00:13,  4.46it/s][A
Iteration:  47%|████▋     | 54/115 [00:13<00:13,  4.42it/s][A
Iteration:  48%|████▊     | 55/115 [00:13<00:13,  4.42it/s][A
Iteration:  49%|████▊     | 56/115 [00:13<00:13,  4.38it/s][A
Iteration:  50%|████▉     | 57/115 [00:13<00:13,  4.42it/s][A
Iteration:  50%|█████     | 58/115 [00:13<00:12,  4.50it/s][A
Iteration:  51%|█████▏    | 59/115 [00:14<00:12,  4.52it/s][A
Iteration:  52%|█████▏    | 60/115 [00:14<00:12,  4.46it/s][A
Iteration:  53%|█████▎    | 61/115 [00:14<00:11,  4.50it/s][A
Iteration:  54%|█████▍    | 62/115 [00:14<00:11,  4.51it/s][A
Iteration:  55%|█████▍    | 63/115 [00:15<00:11,  4.58it/s][A
Iteration:  56%|█████▌    | 64/115 [00:15<00:11,  4.57it/s][A[INFO|trainer.py:570] 2024-03-23 22:08:48,148 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:08:48 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:08:48 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:08:48 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:08:48 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.44it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.28it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.29it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.63it/s]03/23/2024 22:08:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:08:48 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6299019607843137, 'f1': 0.7409948542024013, 'combined_score': 0.6854484074933576, 'eval_loss': 0.8276102, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [224, 216, 205, 157, 196, 196, 148, 177, 189, 146, 148, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80955450, 'remaining_params': 4062150, 'pruned_model_sparsity': 0.952219893292683, 'expected_sparsity': 0.94712, 'target_sparsity': 0.95, 'step': 11450}


Iteration:  57%|█████▋    | 65/115 [00:16<00:23,  2.12it/s][A
Iteration:  57%|█████▋    | 66/115 [00:16<00:19,  2.47it/s][A
Iteration:  58%|█████▊    | 67/115 [00:16<00:16,  2.87it/s][A
Iteration:  59%|█████▉    | 68/115 [00:17<00:14,  3.18it/s][A
Iteration:  60%|██████    | 69/115 [00:17<00:13,  3.50it/s][A
Iteration:  61%|██████    | 70/115 [00:17<00:11,  3.75it/s][A
Iteration:  62%|██████▏   | 71/115 [00:17<00:10,  4.03it/s][A
Iteration:  63%|██████▎   | 72/115 [00:17<00:10,  4.16it/s][A
Iteration:  63%|██████▎   | 73/115 [00:18<00:09,  4.27it/s][A
Iteration:  64%|██████▍   | 74/115 [00:18<00:09,  4.36it/s][A
Iteration:  65%|██████▌   | 75/115 [00:18<00:09,  4.41it/s][A
Iteration:  66%|██████▌   | 76/115 [00:18<00:08,  4.42it/s][A
Iteration:  67%|██████▋   | 77/115 [00:19<00:08,  4.47it/s][A
Iteration:  68%|██████▊   | 78/115 [00:19<00:08,  4.55it/s][A
Iteration:  69%|██████▊   | 79/115 [00:19<00:08,  4.45it/s][A
Iteration:  70%|██████▉   | 80/115 [00:19<00:07,  4.45it/s][A
Iteration:  70%|███████   | 81/115 [00:19<00:07,  4.39it/s][A
Iteration:  71%|███████▏  | 82/115 [00:20<00:07,  4.37it/s][A
Iteration:  72%|███████▏  | 83/115 [00:20<00:07,  4.26it/s][A
Iteration:  73%|███████▎  | 84/115 [00:20<00:07,  4.35it/s][A
Iteration:  74%|███████▍  | 85/115 [00:20<00:06,  4.32it/s][A
Iteration:  75%|███████▍  | 86/115 [00:21<00:06,  4.32it/s][A
Iteration:  76%|███████▌  | 87/115 [00:21<00:06,  4.39it/s][A
Iteration:  77%|███████▋  | 88/115 [00:21<00:06,  4.48it/s][A
Iteration:  77%|███████▋  | 89/115 [00:21<00:05,  4.46it/s][A
Iteration:  78%|███████▊  | 90/115 [00:21<00:05,  4.43it/s][A
Iteration:  79%|███████▉  | 91/115 [00:22<00:05,  4.46it/s][A
Iteration:  80%|████████  | 92/115 [00:22<00:05,  4.43it/s][A
Iteration:  81%|████████  | 93/115 [00:22<00:04,  4.43it/s][A
Iteration:  82%|████████▏ | 94/115 [00:22<00:04,  4.46it/s][A
Iteration:  83%|████████▎ | 95/115 [00:23<00:04,  4.50it/s][A
Iteration:  83%|████████▎ | 96/115 [00:23<00:04,  4.54it/s][A
Iteration:  84%|████████▍ | 97/115 [00:23<00:04,  4.48it/s][A
Iteration:  85%|████████▌ | 98/115 [00:23<00:03,  4.51it/s][A
Iteration:  86%|████████▌ | 99/115 [00:24<00:03,  4.29it/s][A
Iteration:  87%|████████▋ | 100/115 [00:24<00:03,  4.37it/s][A
Iteration:  88%|████████▊ | 101/115 [00:24<00:03,  4.43it/s][A
Iteration:  89%|████████▊ | 102/115 [00:24<00:02,  4.46it/s][A
Iteration:  90%|████████▉ | 103/115 [00:24<00:02,  4.55it/s][A
Iteration:  90%|█████████ | 104/115 [00:25<00:02,  4.57it/s][A
Iteration:  91%|█████████▏| 105/115 [00:25<00:02,  4.56it/s][A
Iteration:  92%|█████████▏| 106/115 [00:25<00:02,  4.46it/s][A
Iteration:  93%|█████████▎| 107/115 [00:25<00:01,  4.46it/s][A
Iteration:  94%|█████████▍| 108/115 [00:25<00:01,  4.50it/s][A
Iteration:  95%|█████████▍| 109/115 [00:26<00:01,  4.50it/s][A
Iteration:  96%|█████████▌| 110/115 [00:26<00:01,  4.53it/s][A
Iteration:  97%|█████████▋| 111/115 [00:26<00:00,  4.51it/s][A
Iteration:  97%|█████████▋| 112/115 [00:26<00:00,  4.52it/s][A
Iteration:  98%|█████████▊| 113/115 [00:27<00:00,  4.44it/s][A
Iteration:  99%|█████████▉| 114/115 [00:27<00:00,  4.46it/s][A[INFO|trainer.py:570] 2024-03-23 22:09:00,157 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: idx, sentence1, sentence2. If idx, sentence1, sentence2 are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
03/23/2024 22:09:00 - INFO - trainer.trainer - ***** Running Evaluation *****
03/23/2024 22:09:00 - INFO - trainer.trainer -   Num examples = 408
03/23/2024 22:09:00 - INFO - trainer.trainer -   Batch size = 32


Evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A03/23/2024 22:09:00 - INFO - trainer.trainer - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:  15%|█▌        | 2/13 [00:00<00:00, 16.46it/s][A[A

Evaluation:  31%|███       | 4/13 [00:00<00:00, 16.35it/s][A[A

Evaluation:  46%|████▌     | 6/13 [00:00<00:00, 16.31it/s][A[A

Evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 16.32it/s][A[A

Evaluation:  77%|███████▋  | 10/13 [00:00<00:00, 16.30it/s][A[A

Evaluation:  92%|█████████▏| 12/13 [00:00<00:00, 16.32it/s][A[AEvaluation: 100%|██████████| 13/13 [00:00<00:00, 16.64it/s]03/23/2024 22:09:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/mrpc/default_experiment-1-0.arrow
03/23/2024 22:09:00 - INFO - trainer.trainer - Evaluating: {'accuracy': 0.6691176470588235, 'f1': 0.7652173913043476, 'combined_score': 0.7171675191815856, 'eval_loss': 0.8571275, 'head_layers': [0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0], 'mlp_layers': [1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0], 'hidden_dims': 765, 'intermediate_dims': [223, 216, 205, 156, 195, 196, 147, 177, 189, 146, 148, 172], 'head_nums': [1, 3, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1], 'pruned_params': 80958510, 'remaining_params': 4059090, 'pruned_model_sparsity': 0.9522558858401085, 'expected_sparsity': 0.94735, 'target_sparsity': 0.95, 'step': 11500}


Iteration: 100%|██████████| 115/115 [00:28<00:00,  2.16it/s][A03/23/2024 22:09:00 - INFO - trainer.trainer - Epoch 99 finished. Took 28.34 seconds.
Iteration: 100%|██████████| 115/115 [00:28<00:00,  4.06it/s]
Epoch: 100%|██████████| 100/100 [47:38<00:00, 27.89s/it]Epoch: 100%|██████████| 100/100 [47:38<00:00, 28.59s/it]
[INFO|configuration_utils.py:439] 2024-03-23 22:09:01,005 >> Configuration saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95/config.json
[INFO|modeling_utils.py:1084] 2024-03-23 22:09:04,006 >> Model weights saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95/pytorch_model.bin
[INFO|tokenization_utils_base.py:2094] 2024-03-23 22:09:04,007 >> tokenizer config file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95/tokenizer_config.json
[INFO|tokenization_utils_base.py:2100] 2024-03-23 22:09:04,008 >> Special tokens file saved in /scratch/network/hw8161/CoFiPruning/out/MRPC/CoFi/MRPC_sparsity0.95/special_tokens_map.json
03/23/2024 22:09:04 - INFO - __main__ - Training took 2871.37 seconds.
