Tue Apr 30 10:12:16 EDT 2024
Your job is running on node(s):
adroit-h11g2
Working directory:
/scratch/network/hw8161/CoFiPruning/tasks/cola_mod2_0.95
nvidia-smi output:
Tue Apr 30 10:12:16 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  | 00000000:17:00.0 Off |                    0 |
| N/A   29C    P0              34W / 250W |      2MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
04/30/2024 10:12:42 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
04/30/2024 10:12:42 - INFO - __main__ - Training/evaluation parameters TrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_steps=50,
evaluation_strategy=IntervalStrategy.STEPS,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=2e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.95/runs/Apr30_10-12-42_adroit-h11g2,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=100,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=100.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.95,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.95,
save_on_each_node=False,
save_steps=0,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=57,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
04/30/2024 10:12:42 - INFO - __main__ - Model Arguments:
04/30/2024 10:12:42 - INFO - __main__ - model_name_or_path = bert-base-uncased
04/30/2024 10:12:42 - INFO - __main__ - config_name = None
04/30/2024 10:12:42 - INFO - __main__ - tokenizer_name = None
04/30/2024 10:12:42 - INFO - __main__ - cache_dir = /scratch/network/hw8161/.cache/
04/30/2024 10:12:42 - INFO - __main__ - use_fast_tokenizer = True
04/30/2024 10:12:42 - INFO - __main__ - model_revision = main
04/30/2024 10:12:42 - INFO - __main__ - use_auth_token = False
04/30/2024 10:12:42 - INFO - __main__ - Data Arguments:
04/30/2024 10:12:42 - INFO - __main__ - task_name = cola
04/30/2024 10:12:42 - INFO - __main__ - dataset_name = None
04/30/2024 10:12:42 - INFO - __main__ - t_name = None
04/30/2024 10:12:42 - INFO - __main__ - dataset_config_name = None
04/30/2024 10:12:42 - INFO - __main__ - max_seq_length = 128
04/30/2024 10:12:42 - INFO - __main__ - overwrite_cache = False
04/30/2024 10:12:42 - INFO - __main__ - pad_to_max_length = True
04/30/2024 10:12:42 - INFO - __main__ - max_train_samples = None
04/30/2024 10:12:42 - INFO - __main__ - max_eval_samples = None
04/30/2024 10:12:42 - INFO - __main__ - max_predict_samples = None
04/30/2024 10:12:42 - INFO - __main__ - train_file = None
04/30/2024 10:12:42 - INFO - __main__ - validation_file = None
04/30/2024 10:12:42 - INFO - __main__ - test_file = None
04/30/2024 10:12:42 - INFO - __main__ - Training Arguments:
04/30/2024 10:12:42 - INFO - __main__ - output_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.95
04/30/2024 10:12:42 - INFO - __main__ - overwrite_output_dir = True
04/30/2024 10:12:42 - INFO - __main__ - do_train = True
04/30/2024 10:12:42 - INFO - __main__ - do_eval = True
04/30/2024 10:12:42 - INFO - __main__ - do_predict = False
04/30/2024 10:12:42 - INFO - __main__ - evaluation_strategy = IntervalStrategy.STEPS
04/30/2024 10:12:42 - INFO - __main__ - prediction_loss_only = False
04/30/2024 10:12:42 - INFO - __main__ - per_device_train_batch_size = 32
04/30/2024 10:12:42 - INFO - __main__ - per_device_eval_batch_size = 32
04/30/2024 10:12:42 - INFO - __main__ - per_gpu_train_batch_size = None
04/30/2024 10:12:42 - INFO - __main__ - per_gpu_eval_batch_size = None
04/30/2024 10:12:42 - INFO - __main__ - gradient_accumulation_steps = 1
04/30/2024 10:12:42 - INFO - __main__ - eval_accumulation_steps = None
04/30/2024 10:12:42 - INFO - __main__ - learning_rate = 2e-05
04/30/2024 10:12:42 - INFO - __main__ - weight_decay = 0.0
04/30/2024 10:12:42 - INFO - __main__ - adam_beta1 = 0.9
04/30/2024 10:12:42 - INFO - __main__ - adam_beta2 = 0.999
04/30/2024 10:12:42 - INFO - __main__ - adam_epsilon = 1e-08
04/30/2024 10:12:42 - INFO - __main__ - max_grad_norm = 1.0
04/30/2024 10:12:42 - INFO - __main__ - num_train_epochs = 100.0
04/30/2024 10:12:42 - INFO - __main__ - max_steps = -1
04/30/2024 10:12:42 - INFO - __main__ - lr_scheduler_type = SchedulerType.LINEAR
04/30/2024 10:12:42 - INFO - __main__ - warmup_ratio = 0.0
04/30/2024 10:12:42 - INFO - __main__ - warmup_steps = 0
04/30/2024 10:12:42 - INFO - __main__ - log_level = -1
04/30/2024 10:12:42 - INFO - __main__ - log_level_replica = -1
04/30/2024 10:12:42 - INFO - __main__ - log_on_each_node = True
04/30/2024 10:12:42 - INFO - __main__ - logging_dir = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.95/runs/Apr30_10-12-42_adroit-h11g2
04/30/2024 10:12:42 - INFO - __main__ - logging_strategy = IntervalStrategy.STEPS
04/30/2024 10:12:42 - INFO - __main__ - logging_first_step = False
04/30/2024 10:12:42 - INFO - __main__ - logging_steps = 100
04/30/2024 10:12:42 - INFO - __main__ - logging_nan_inf_filter = True
04/30/2024 10:12:42 - INFO - __main__ - save_strategy = IntervalStrategy.STEPS
04/30/2024 10:12:42 - INFO - __main__ - save_steps = 0
04/30/2024 10:12:42 - INFO - __main__ - save_total_limit = None
04/30/2024 10:12:42 - INFO - __main__ - save_on_each_node = False
04/30/2024 10:12:42 - INFO - __main__ - no_cuda = False
04/30/2024 10:12:42 - INFO - __main__ - seed = 57
04/30/2024 10:12:42 - INFO - __main__ - bf16 = False
04/30/2024 10:12:42 - INFO - __main__ - fp16 = False
04/30/2024 10:12:42 - INFO - __main__ - fp16_opt_level = O1
04/30/2024 10:12:42 - INFO - __main__ - half_precision_backend = auto
04/30/2024 10:12:42 - INFO - __main__ - bf16_full_eval = False
04/30/2024 10:12:42 - INFO - __main__ - fp16_full_eval = False
04/30/2024 10:12:42 - INFO - __main__ - tf32 = None
04/30/2024 10:12:42 - INFO - __main__ - local_rank = -1
04/30/2024 10:12:42 - INFO - __main__ - xpu_backend = None
04/30/2024 10:12:42 - INFO - __main__ - tpu_num_cores = None
04/30/2024 10:12:42 - INFO - __main__ - tpu_metrics_debug = False
04/30/2024 10:12:42 - INFO - __main__ - debug = []
04/30/2024 10:12:42 - INFO - __main__ - dataloader_drop_last = False
04/30/2024 10:12:42 - INFO - __main__ - eval_steps = 50
04/30/2024 10:12:42 - INFO - __main__ - dataloader_num_workers = 0
04/30/2024 10:12:42 - INFO - __main__ - past_index = -1
04/30/2024 10:12:42 - INFO - __main__ - run_name = /scratch/network/hw8161/CoFiPruning/out/CoLA/CoFi_mod_2/CoLA_sparsity0.95
04/30/2024 10:12:42 - INFO - __main__ - disable_tqdm = False
04/30/2024 10:12:42 - INFO - __main__ - remove_unused_columns = True
04/30/2024 10:12:42 - INFO - __main__ - label_names = None
04/30/2024 10:12:42 - INFO - __main__ - load_best_model_at_end = False
04/30/2024 10:12:42 - INFO - __main__ - metric_for_best_model = None
04/30/2024 10:12:42 - INFO - __main__ - greater_is_better = None
04/30/2024 10:12:42 - INFO - __main__ - ignore_data_skip = False
04/30/2024 10:12:42 - INFO - __main__ - sharded_ddp = []
04/30/2024 10:12:42 - INFO - __main__ - deepspeed = None
04/30/2024 10:12:42 - INFO - __main__ - label_smoothing_factor = 0.0
04/30/2024 10:12:42 - INFO - __main__ - optim = OptimizerNames.ADAMW_HF
04/30/2024 10:12:42 - INFO - __main__ - adafactor = False
04/30/2024 10:12:42 - INFO - __main__ - group_by_length = False
04/30/2024 10:12:42 - INFO - __main__ - length_column_name = length
04/30/2024 10:12:42 - INFO - __main__ - report_to = []
04/30/2024 10:12:42 - INFO - __main__ - ddp_find_unused_parameters = None
04/30/2024 10:12:42 - INFO - __main__ - ddp_bucket_cap_mb = None
04/30/2024 10:12:42 - INFO - __main__ - dataloader_pin_memory = True
04/30/2024 10:12:42 - INFO - __main__ - skip_memory_metrics = True
04/30/2024 10:12:42 - INFO - __main__ - use_legacy_prediction_loop = False
04/30/2024 10:12:42 - INFO - __main__ - push_to_hub = False
04/30/2024 10:12:42 - INFO - __main__ - resume_from_checkpoint = None
04/30/2024 10:12:42 - INFO - __main__ - hub_model_id = None
04/30/2024 10:12:42 - INFO - __main__ - hub_strategy = HubStrategy.EVERY_SAVE
04/30/2024 10:12:42 - INFO - __main__ - hub_token = None
04/30/2024 10:12:42 - INFO - __main__ - gradient_checkpointing = False
04/30/2024 10:12:42 - INFO - __main__ - fp16_backend = auto
04/30/2024 10:12:42 - INFO - __main__ - push_to_hub_model_id = None
04/30/2024 10:12:42 - INFO - __main__ - push_to_hub_organization = None
04/30/2024 10:12:42 - INFO - __main__ - push_to_hub_token = None
04/30/2024 10:12:42 - INFO - __main__ - mp_parameters = 
04/30/2024 10:12:42 - INFO - __main__ - _n_gpu = 1
04/30/2024 10:12:42 - INFO - __main__ - __cached__setup_devices = cuda:0
04/30/2024 10:12:42 - INFO - __main__ - Additional Arguments:
04/30/2024 10:12:42 - INFO - __main__ - test = False
04/30/2024 10:12:42 - INFO - __main__ - ex_name = CoLA_sparsity0.95
04/30/2024 10:12:42 - INFO - __main__ - pruning_type = structured_heads+structured_mlp+hidden+layer
04/30/2024 10:12:42 - INFO - __main__ - reg_learning_rate = 0.01
04/30/2024 10:12:42 - INFO - __main__ - scheduler_type = linear
04/30/2024 10:12:42 - INFO - __main__ - freeze_embeddings = True
04/30/2024 10:12:42 - INFO - __main__ - pretrained_pruned_model = None
04/30/2024 10:12:42 - INFO - __main__ - droprate_init = 0.5
04/30/2024 10:12:42 - INFO - __main__ - temperature = 0.6666666666666666
04/30/2024 10:12:42 - INFO - __main__ - prepruning_finetune_epochs = 4
04/30/2024 10:12:42 - INFO - __main__ - lagrangian_warmup_epochs = 20
04/30/2024 10:12:42 - INFO - __main__ - target_sparsity = 0.95
04/30/2024 10:12:42 - INFO - __main__ - sparsity_epsilon = 0
04/30/2024 10:12:42 - INFO - __main__ - distillation_path = mofyrt/bert-base-uncased-finetuned-cola
04/30/2024 10:12:42 - INFO - __main__ - do_distill = True
04/30/2024 10:12:42 - INFO - __main__ - do_layer_distill = True
04/30/2024 10:12:42 - INFO - __main__ - layer_distill_version = 4
04/30/2024 10:12:42 - INFO - __main__ - distill_loss_alpha = 0.9
04/30/2024 10:12:42 - INFO - __main__ - distill_ce_loss_alpha = 0.1
04/30/2024 10:12:42 - INFO - __main__ - distill_temp = 2.0
04/30/2024 10:12:43 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/30/2024 10:12:43 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
04/30/2024 10:12:43 - WARNING - datasets.builder - Reusing dataset glue (/scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353)
04/30/2024 10:12:43 - INFO - datasets.info - Loading Dataset info from /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 913.53it/s]
[INFO|configuration_utils.py:648] 2024-04-30 10:12:43,100 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-30 10:12:43,100 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "finetuning_task": "cola",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|configuration_utils.py:648] 2024-04-30 10:12:43,102 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-30 10:12:43,103 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1766] 2024-04-30 10:12:43,106 >> Can't load following files from cache: ['added_tokens_file', 'special_tokens_map_file'] and cannot check if these files are necessary for the tokenizer to operate.
[INFO|tokenization_utils_base.py:1786] 2024-04-30 10:12:43,106 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/vocab.txt from cache at /scratch/network/hw8161/.cache/45c3f7a79a80e1cf0a489e5c62b43f173c15db47864303a55d623bb3c96f72a5.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1786] 2024-04-30 10:12:43,106 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer.json from cache at /scratch/network/hw8161/.cache/534479488c54aeaf9c3406f647aa2ec13648c06771ffe269edabebd4c412da1d.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4
[INFO|tokenization_utils_base.py:1786] 2024-04-30 10:12:43,106 >> loading file https://huggingface.co/bert-base-uncased/resolve/main/tokenizer_config.json from cache at /scratch/network/hw8161/.cache/c1d7f0a763fb63861cc08553866f1fc3e5a6f4f07621be277452d26d71303b7e.76ea01b4b85ac16e2cec55c398cba7a943d89ab21dfdd973f6630a152e4b9aed
[INFO|configuration_utils.py:648] 2024-04-30 10:12:43,109 >> loading configuration file https://huggingface.co/bert-base-uncased/resolve/main/config.json from cache at /scratch/network/hw8161/.cache/3c61d016573b14f7f008c02c4e51a366c67ab274726fe2910691e2a761acf43e.37395cee442ab11005bcd270f3c34464dc1704b715b5d7d52b1a461abe3b9e4e
[INFO|configuration_utils.py:684] 2024-04-30 10:12:43,110 >> Model config BertConfig {
  "_name_or_path": "bert-base-uncased",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.17.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer 0, heads  pruned.
Layer 1, heads  pruned.
Layer 2, heads  pruned.
Layer 3, heads  pruned.
Layer 4, heads  pruned.
Layer 5, heads  pruned.
Layer 6, heads  pruned.
Layer 7, heads  pruned.
Layer 8, heads  pruned.
Layer 9, heads  pruned.
Layer 10, heads  pruned.
Layer 11, heads  pruned.
layer transformation torch.Size([768, 768])
Layer: 0
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 1
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 2
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 3
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 4
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 5
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 6
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 7
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 8
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 9
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 10
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
Layer: 11
query: torch.Size([768, 768])
key: torch.Size([768, 768])
value: torch.Size([768, 768])
output: torch.Size([768, 768])
up: torch.Size([3072, 768])
down: torch.Size([768, 3072])
04/30/2024 10:12:52 - INFO - __main__ - CoFiBertForSequenceClassification(
  (bert): CoFiBertModel(
    (embeddings): CoFiBertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): CoFiBertEncoder(
      (layer): ModuleList(
        (0): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): CoFiBertLayer(
          (attention): CoFiBertAttention(
            (self): CoFiBertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): CoFiBertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): CoFiBertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): CoFiLayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=2, bias=True)
  (layer_transformation): Linear(in_features=768, out_features=768, bias=True)
)
04/30/2024 10:12:52 - INFO - __main__ - Model size: 85054464
04/30/2024 10:12:52 - WARNING - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14fb28d0d040> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
04/30/2024 10:12:52 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-5e2502420ae59635.arrow
04/30/2024 10:12:52 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14fb28d0d4c0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/30/2024 10:12:52 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-9af4974096f5b0ee.arrow
04/30/2024 10:12:52 - INFO - datasets.fingerprint - Parameter 'function'=<function main.<locals>.preprocess_function at 0x14fb28d0d040> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead.
04/30/2024 10:12:52 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at /scratch/network/hw8161/.cache/glue/cola/1.0.0/a420f5e518f42454003587c47467370329f9fc0c6508d1ae0c45b58ea266a353/cache-399029b404f18db9.arrow
04/30/2024 10:12:52 - INFO - __main__ - Sample 8423 of the training set: {'sentence': 'Anson saw Anson.', 'label': 1, 'idx': 8423, 'input_ids': [101, 25435, 2387, 25435, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/30/2024 10:12:52 - INFO - __main__ - Sample 5262 of the training set: {'sentence': 'The men would not have all been working.', 'label': 1, 'idx': 5262, 'input_ids': [101, 1996, 2273, 2052, 2025, 2031, 2035, 2042, 2551, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/30/2024 10:12:52 - INFO - __main__ - Sample 7821 of the training set: {'sentence': 'Anson very happily demonized David.', 'label': 1, 'idx': 7821, 'input_ids': [101, 25435, 2200, 11361, 5698, 3550, 2585, 1012, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}.
04/30/2024 10:12:52 - INFO - datasets.utils.file_utils - HEAD request to https://raw.githubusercontent.com/huggingface/datasets/1.18.0/metrics/glue/glue.py timed out, retrying... [1.0]
04/30/2024 10:12:53 - WARNING - datasets.load - Using the latest cached version of the module from /scratch/network/hw8161/.cache/huggingface/modules/datasets_modules/metrics/glue/1f893b8ccbdd80c366ce0db148773ae919cdbd00f612188de0c14924a82fe984 (last modified on Wed Mar 20 22:26:50 2024) since it couldn't be found locally at glue, or remotely on the Hugging Face Hub.
04/30/2024 10:12:53 - INFO - __main__ - ************* 8551 Training Examples Loaded *************
04/30/2024 10:12:53 - INFO - __main__ - ************* 1043 Evaluation Examples Loaded *************
[INFO|trainer.py:570] 2024-04-30 10:12:53,646 >> The following columns in the training set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 - Prepruning finetune steps: 100
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 - Lagrangian warmup steps: 5360
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 - ***** Running training *****
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 -   Num examples = 8551
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 -   Num Epochs = 100
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 -   Instantaneous batch size per device = 32
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 -   Total train batch size (w. parallel, distributed & accumulation) = 32
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 -   Gradient Accumulation steps = 1
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 -   Total optimization steps = 26800
Epoch:   0%|          | 0/100 [00:00<?, ?it/s][INFO|trainer.py:570] 2024-04-30 10:12:53,650 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:12:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32

Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A
Evaluation:   3%|▎         | 1/33 [00:00<00:05,  6.39it/s][A
Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.02it/s][A
Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.77it/s][A
Evaluation:  21%|██        | 7/33 [00:00<00:02, 10.11it/s][A
Evaluation:  27%|██▋       | 9/33 [00:00<00:02, 10.29it/s][A
Evaluation:  33%|███▎      | 11/33 [00:01<00:02, 10.40it/s][A
Evaluation:  39%|███▉      | 13/33 [00:01<00:01, 10.47it/s][A
Evaluation:  45%|████▌     | 15/33 [00:01<00:01, 10.52it/s][A
Evaluation:  52%|█████▏    | 17/33 [00:01<00:01, 10.55it/s][A
Evaluation:  58%|█████▊    | 19/33 [00:01<00:01, 10.56it/s][A
Evaluation:  64%|██████▎   | 21/33 [00:02<00:01, 10.57it/s][A
Evaluation:  70%|██████▉   | 23/33 [00:02<00:00, 10.58it/s][A
Evaluation:  76%|███████▌  | 25/33 [00:02<00:00, 10.59it/s][A
Evaluation:  82%|████████▏ | 27/33 [00:02<00:00, 10.59it/s][A
Evaluation:  88%|████████▊ | 29/33 [00:02<00:00, 10.59it/s][A
Evaluation:  94%|█████████▍| 31/33 [00:02<00:00, 10.59it/s][A
Evaluation: 100%|██████████| 33/33 [00:03<00:00, 11.22it/s][AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.51it/s]04/30/2024 10:12:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:12:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': -0.015667329278145823, 'eval_loss': 0.6626569, 'step': 0}


Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/30/2024 10:12:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 0, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:49,  5.37it/s][A
Iteration:   1%|          | 2/268 [00:00<00:39,  6.65it/s][A
Iteration:   1%|          | 3/268 [00:00<00:37,  7.06it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:34,  7.67it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:32,  8.16it/s][A
Iteration:   2%|▏         | 6/268 [00:00<00:32,  8.18it/s][A
Iteration:   3%|▎         | 7/268 [00:00<00:31,  8.16it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:38,  6.67it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:36,  7.08it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:33,  7.69it/s][A
Iteration:   4%|▍         | 12/268 [00:01<00:32,  7.99it/s][A
Iteration:   5%|▍         | 13/268 [00:01<00:30,  8.28it/s][A
Iteration:   5%|▌         | 14/268 [00:01<00:30,  8.26it/s][A
Iteration:   6%|▌         | 15/268 [00:01<00:31,  8.14it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:30,  8.19it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:29,  8.45it/s][A
Iteration:   7%|▋         | 19/268 [00:02<00:27,  8.94it/s][A
Iteration:   7%|▋         | 20/268 [00:02<00:27,  9.00it/s][A
Iteration:   8%|▊         | 21/268 [00:02<00:27,  8.95it/s][A
Iteration:   9%|▊         | 23/268 [00:02<00:26,  9.38it/s][A
Iteration:   9%|▉         | 24/268 [00:02<00:26,  9.26it/s][A
Iteration:   9%|▉         | 25/268 [00:03<00:28,  8.60it/s][A
Iteration:  10%|▉         | 26/268 [00:03<00:32,  7.54it/s][A
Iteration:  10%|█         | 27/268 [00:03<00:30,  7.91it/s][A
Iteration:  10%|█         | 28/268 [00:03<00:29,  8.02it/s][A
Iteration:  11%|█         | 29/268 [00:03<00:28,  8.32it/s][A
Iteration:  11%|█         | 30/268 [00:03<00:28,  8.48it/s][A
Iteration:  12%|█▏        | 31/268 [00:03<00:27,  8.58it/s][A
Iteration:  12%|█▏        | 32/268 [00:03<00:26,  8.75it/s][A
Iteration:  12%|█▏        | 33/268 [00:04<00:27,  8.55it/s][A
Iteration:  13%|█▎        | 34/268 [00:04<00:27,  8.63it/s][A
Iteration:  13%|█▎        | 35/268 [00:04<00:27,  8.38it/s][A
Iteration:  13%|█▎        | 36/268 [00:04<00:27,  8.53it/s][A
Iteration:  14%|█▍        | 37/268 [00:04<00:26,  8.74it/s][A
Iteration:  14%|█▍        | 38/268 [00:04<00:26,  8.77it/s][A
Iteration:  15%|█▍        | 40/268 [00:04<00:25,  9.04it/s][A
Iteration:  15%|█▌        | 41/268 [00:04<00:25,  9.08it/s][A
Iteration:  16%|█▌        | 42/268 [00:05<00:25,  9.03it/s][A
Iteration:  16%|█▌        | 43/268 [00:05<00:26,  8.48it/s][A
Iteration:  16%|█▋        | 44/268 [00:05<00:26,  8.44it/s][A
Iteration:  17%|█▋        | 45/268 [00:05<00:26,  8.56it/s][A
Iteration:  18%|█▊        | 47/268 [00:05<00:24,  9.02it/s][A
Iteration:  18%|█▊        | 48/268 [00:05<00:24,  8.99it/s][A[INFO|trainer.py:570] 2024-04-30 10:13:02,808 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:13:02 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:13:02 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:13:02 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:01, 10.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.73it/s]04/30/2024 10:13:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:13:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.45335145054692777, 'eval_loss': 0.6140724, 'step': 50}


Iteration:  19%|█▊        | 50/268 [00:09<02:43,  1.33it/s][A
Iteration:  19%|█▉        | 51/268 [00:09<02:12,  1.64it/s][A
Iteration:  19%|█▉        | 52/268 [00:09<01:45,  2.04it/s][A
Iteration:  20%|█▉        | 53/268 [00:09<01:24,  2.55it/s][A
Iteration:  20%|██        | 54/268 [00:09<01:07,  3.17it/s][A
Iteration:  21%|██        | 55/268 [00:09<00:54,  3.88it/s][A
Iteration:  21%|██        | 56/268 [00:09<00:46,  4.57it/s][A
Iteration:  21%|██▏       | 57/268 [00:09<00:39,  5.31it/s][A
Iteration:  22%|██▏       | 59/268 [00:10<00:31,  6.63it/s][A
Iteration:  22%|██▏       | 60/268 [00:10<00:29,  7.06it/s][A
Iteration:  23%|██▎       | 62/268 [00:10<00:25,  7.94it/s][A
Iteration:  24%|██▎       | 63/268 [00:10<00:25,  8.12it/s][A
Iteration:  24%|██▍       | 65/268 [00:10<00:23,  8.63it/s][A
Iteration:  25%|██▍       | 66/268 [00:10<00:23,  8.68it/s][A
Iteration:  25%|██▌       | 67/268 [00:10<00:22,  8.77it/s][A
Iteration:  25%|██▌       | 68/268 [00:11<00:22,  8.88it/s][A
Iteration:  26%|██▌       | 70/268 [00:11<00:21,  9.19it/s][A
Iteration:  26%|██▋       | 71/268 [00:11<00:21,  9.12it/s][A
Iteration:  27%|██▋       | 72/268 [00:11<00:21,  9.16it/s][A
Iteration:  27%|██▋       | 73/268 [00:11<00:21,  9.09it/s][A
Iteration:  28%|██▊       | 74/268 [00:11<00:21,  9.15it/s][A
Iteration:  28%|██▊       | 75/268 [00:11<00:21,  9.07it/s][A
Iteration:  28%|██▊       | 76/268 [00:11<00:21,  8.85it/s][A
Iteration:  29%|██▊       | 77/268 [00:12<00:21,  8.86it/s][A
Iteration:  29%|██▉       | 79/268 [00:12<00:20,  9.13it/s][A
Iteration:  30%|███       | 81/268 [00:12<00:20,  9.26it/s][A
Iteration:  31%|███       | 83/268 [00:12<00:19,  9.38it/s][A
Iteration:  31%|███▏      | 84/268 [00:12<00:19,  9.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:12<00:19,  9.17it/s][A
Iteration:  32%|███▏      | 86/268 [00:13<00:20,  8.92it/s][A
Iteration:  32%|███▏      | 87/268 [00:13<00:20,  8.69it/s][A
Iteration:  33%|███▎      | 88/268 [00:13<00:20,  8.82it/s][A
Iteration:  33%|███▎      | 89/268 [00:13<00:20,  8.65it/s][A
Iteration:  34%|███▎      | 90/268 [00:13<00:20,  8.82it/s][A
Iteration:  34%|███▍      | 91/268 [00:13<00:20,  8.60it/s][A
Iteration:  34%|███▍      | 92/268 [00:13<00:20,  8.52it/s][A
Iteration:  35%|███▍      | 93/268 [00:13<00:20,  8.67it/s][A
Iteration:  35%|███▌      | 94/268 [00:13<00:19,  8.73it/s][A
Iteration:  35%|███▌      | 95/268 [00:14<00:21,  7.95it/s][A
Iteration:  36%|███▌      | 96/268 [00:14<00:22,  7.70it/s][A
Iteration:  36%|███▌      | 97/268 [00:14<00:21,  7.88it/s][A
Iteration:  37%|███▋      | 98/268 [00:14<00:21,  7.95it/s][A[INFO|trainer.py:570] 2024-04-30 10:13:11,554 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:13:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:13:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:13:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:01, 10.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.61it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.61it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.61it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.61it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.61it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.62it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.73it/s]04/30/2024 10:13:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:13:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.48886510271911465, 'eval_loss': 0.53403676, 'step': 100}


Iteration:  37%|███▋      | 100/268 [00:17<02:19,  1.20it/s][A04/30/2024 10:13:14 - INFO - trainer.trainer_mod_2 - main params, number of params: 86115840, weight_decay: 0.0, lr: 2e-05
04/30/2024 10:13:14 - INFO - trainer.trainer_mod_2 - main params, number of params: 121346, weight_decay: 0.0, lr: 2e-05
04/30/2024 10:13:14 - INFO - trainer.trainer_mod_2 - l0 reg params, number of params: 37800, weight_decay: 0.0, lr: 0.01
04/30/2024 10:13:14 - INFO - trainer.trainer_mod_2 - l0 reg lagrangian params, number of params: 2, weight_decay: 0.0, lr: -0.01
04/30/2024 10:13:14 - INFO - trainer.trainer_mod_2 - Starting l0 regularization!
04/30/2024 10:13:14 - INFO - trainer.trainer_mod_2 - v4 Global step: 100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:18<01:54,  1.46it/s][A
Iteration:  38%|███▊      | 102/268 [00:18<01:32,  1.80it/s][A
Iteration:  38%|███▊      | 103/268 [00:18<01:15,  2.18it/s][A
Iteration:  39%|███▉      | 104/268 [00:18<01:03,  2.60it/s][A
Iteration:  39%|███▉      | 105/268 [00:18<00:54,  2.99it/s][A
Iteration:  40%|███▉      | 106/268 [00:19<00:47,  3.39it/s][A
Iteration:  40%|███▉      | 107/268 [00:19<00:42,  3.76it/s][A
Iteration:  40%|████      | 108/268 [00:19<00:39,  4.09it/s][A
Iteration:  41%|████      | 109/268 [00:19<00:36,  4.30it/s][A
Iteration:  41%|████      | 110/268 [00:19<00:35,  4.51it/s][A
Iteration:  41%|████▏     | 111/268 [00:20<00:33,  4.66it/s][A
Iteration:  42%|████▏     | 112/268 [00:20<00:32,  4.78it/s][A
Iteration:  42%|████▏     | 113/268 [00:20<00:32,  4.79it/s][A
Iteration:  43%|████▎     | 114/268 [00:20<00:32,  4.81it/s][A
Iteration:  43%|████▎     | 115/268 [00:20<00:31,  4.89it/s][A
Iteration:  43%|████▎     | 116/268 [00:21<00:30,  4.95it/s][A
Iteration:  44%|████▎     | 117/268 [00:21<00:30,  4.99it/s][A
Iteration:  44%|████▍     | 118/268 [00:21<00:30,  4.87it/s][A
Iteration:  44%|████▍     | 119/268 [00:21<00:30,  4.94it/s][A
Iteration:  45%|████▍     | 120/268 [00:21<00:30,  4.88it/s][A
Iteration:  45%|████▌     | 121/268 [00:22<00:29,  4.94it/s][A
Iteration:  46%|████▌     | 122/268 [00:22<00:29,  4.91it/s][A
Iteration:  46%|████▌     | 123/268 [00:22<00:29,  5.00it/s][A
Iteration:  46%|████▋     | 124/268 [00:22<00:28,  5.04it/s][A
Iteration:  47%|████▋     | 125/268 [00:22<00:28,  5.03it/s][A
Iteration:  47%|████▋     | 126/268 [00:23<00:28,  4.97it/s][A
Iteration:  47%|████▋     | 127/268 [00:23<00:28,  4.98it/s][A
Iteration:  48%|████▊     | 128/268 [00:23<00:28,  4.98it/s][A
Iteration:  48%|████▊     | 129/268 [00:23<00:27,  5.01it/s][A
Iteration:  49%|████▊     | 130/268 [00:23<00:26,  5.15it/s][A
Iteration:  49%|████▉     | 131/268 [00:24<00:26,  5.17it/s][A
Iteration:  49%|████▉     | 132/268 [00:24<00:26,  5.15it/s][A
Iteration:  50%|████▉     | 133/268 [00:24<00:26,  5.11it/s][A
Iteration:  50%|█████     | 134/268 [00:24<00:26,  5.04it/s][A
Iteration:  50%|█████     | 135/268 [00:24<00:25,  5.16it/s][A
Iteration:  51%|█████     | 136/268 [00:25<00:25,  5.12it/s][A
Iteration:  51%|█████     | 137/268 [00:25<00:25,  5.10it/s][A
Iteration:  51%|█████▏    | 138/268 [00:25<00:26,  4.93it/s][A
Iteration:  52%|█████▏    | 139/268 [00:25<00:25,  5.00it/s][A
Iteration:  52%|█████▏    | 140/268 [00:25<00:25,  4.95it/s][A
Iteration:  53%|█████▎    | 141/268 [00:26<00:25,  4.97it/s][A
Iteration:  53%|█████▎    | 142/268 [00:26<00:25,  5.00it/s][A
Iteration:  53%|█████▎    | 143/268 [00:26<00:24,  5.18it/s][A
Iteration:  54%|█████▎    | 144/268 [00:26<00:24,  5.14it/s][A
Iteration:  54%|█████▍    | 145/268 [00:26<00:23,  5.15it/s][A
Iteration:  54%|█████▍    | 146/268 [00:26<00:23,  5.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:27<00:23,  5.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:27<00:23,  5.16it/s][A
Iteration:  56%|█████▌    | 149/268 [00:27<00:22,  5.30it/s][A[INFO|trainer.py:570] 2024-04-30 10:13:24,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:13:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:13:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:13:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:13:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.61it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:13:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:13:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0928457264044978, 'eval_loss': 0.94874084, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2589, 2588, 2586, 2586, 2586, 2583, 2579, 2578, 2586, 2590, 2600, 2604], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 9203516, 'remaining_params': 75814084, 'pruned_model_sparsity': 0.10825424382716049, 'expected_sparsity': 0.10981, 'target_sparsity': 0.008861940298507462, 'step': 150}


Iteration:  56%|█████▌    | 150/268 [00:31<02:25,  1.23s/it][A
Iteration:  56%|█████▋    | 151/268 [00:31<01:48,  1.08it/s][A
Iteration:  57%|█████▋    | 152/268 [00:31<01:22,  1.41it/s][A
Iteration:  57%|█████▋    | 153/268 [00:31<01:04,  1.79it/s][A
Iteration:  57%|█████▋    | 154/268 [00:32<00:51,  2.21it/s][A
Iteration:  58%|█████▊    | 155/268 [00:32<00:42,  2.66it/s][A
Iteration:  58%|█████▊    | 156/268 [00:32<00:36,  3.03it/s][A
Iteration:  59%|█████▊    | 157/268 [00:32<00:32,  3.36it/s][A
Iteration:  59%|█████▉    | 158/268 [00:32<00:29,  3.69it/s][A
Iteration:  59%|█████▉    | 159/268 [00:33<00:26,  4.04it/s][A
Iteration:  60%|█████▉    | 160/268 [00:33<00:25,  4.29it/s][A
Iteration:  60%|██████    | 161/268 [00:33<00:23,  4.63it/s][A
Iteration:  60%|██████    | 162/268 [00:33<00:22,  4.78it/s][A
Iteration:  61%|██████    | 163/268 [00:33<00:21,  4.87it/s][A
Iteration:  61%|██████    | 164/268 [00:34<00:21,  4.93it/s][A
Iteration:  62%|██████▏   | 165/268 [00:34<00:20,  5.01it/s][A
Iteration:  62%|██████▏   | 166/268 [00:34<00:21,  4.85it/s][A
Iteration:  62%|██████▏   | 167/268 [00:34<00:20,  4.92it/s][A
Iteration:  63%|██████▎   | 168/268 [00:34<00:19,  5.01it/s][A
Iteration:  63%|██████▎   | 169/268 [00:35<00:20,  4.85it/s][A
Iteration:  63%|██████▎   | 170/268 [00:35<00:19,  4.94it/s][A
Iteration:  64%|██████▍   | 171/268 [00:35<00:19,  4.97it/s][A
Iteration:  64%|██████▍   | 172/268 [00:35<00:19,  5.02it/s][A
Iteration:  65%|██████▍   | 173/268 [00:35<00:18,  5.04it/s][A
Iteration:  65%|██████▍   | 174/268 [00:36<00:18,  5.08it/s][A
Iteration:  65%|██████▌   | 175/268 [00:36<00:18,  5.06it/s][A
Iteration:  66%|██████▌   | 176/268 [00:36<00:18,  4.91it/s][A
Iteration:  66%|██████▌   | 177/268 [00:36<00:18,  4.89it/s][A
Iteration:  66%|██████▋   | 178/268 [00:36<00:18,  4.88it/s][A
Iteration:  67%|██████▋   | 179/268 [00:37<00:18,  4.86it/s][A
Iteration:  67%|██████▋   | 180/268 [00:37<00:17,  4.94it/s][A
Iteration:  68%|██████▊   | 181/268 [00:37<00:16,  5.15it/s][A
Iteration:  68%|██████▊   | 182/268 [00:37<00:16,  5.06it/s][A
Iteration:  68%|██████▊   | 183/268 [00:37<00:16,  5.05it/s][A
Iteration:  69%|██████▊   | 184/268 [00:38<00:16,  5.17it/s][A
Iteration:  69%|██████▉   | 185/268 [00:38<00:16,  5.19it/s][A
Iteration:  69%|██████▉   | 186/268 [00:38<00:16,  5.07it/s][A
Iteration:  70%|██████▉   | 187/268 [00:38<00:16,  4.99it/s][A
Iteration:  70%|███████   | 188/268 [00:38<00:15,  5.04it/s][A
Iteration:  71%|███████   | 189/268 [00:39<00:15,  5.08it/s][A
Iteration:  71%|███████   | 190/268 [00:39<00:15,  5.10it/s][A
Iteration:  71%|███████▏  | 191/268 [00:39<00:15,  5.08it/s][A
Iteration:  72%|███████▏  | 192/268 [00:39<00:15,  4.95it/s][A
Iteration:  72%|███████▏  | 193/268 [00:39<00:15,  4.97it/s][A
Iteration:  72%|███████▏  | 194/268 [00:40<00:14,  5.02it/s][A
Iteration:  73%|███████▎  | 195/268 [00:40<00:14,  5.08it/s][A
Iteration:  73%|███████▎  | 196/268 [00:40<00:14,  5.10it/s][A
Iteration:  74%|███████▎  | 197/268 [00:40<00:14,  5.02it/s][A
Iteration:  74%|███████▍  | 198/268 [00:40<00:14,  4.95it/s][A
Iteration:  74%|███████▍  | 199/268 [00:41<00:13,  5.01it/s][A[INFO|trainer.py:570] 2024-04-30 10:13:38,038 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:13:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:13:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:13:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:13:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.57it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.56it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.58it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.69it/s]04/30/2024 10:13:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:13:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.20521028256276466, 'eval_loss': 0.8921967, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2616, 2612, 2608, 2604, 2606, 2601, 2596, 2598, 2627, 2639, 2664, 2681], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 8595312, 'remaining_params': 76422288, 'pruned_model_sparsity': 0.10110038392050587, 'expected_sparsity': 0.10266, 'target_sparsity': 0.017723880597014924, 'step': 200}


Iteration:  75%|███████▍  | 200/268 [00:44<01:24,  1.24s/it][A04/30/2024 10:13:41 - INFO - trainer.trainer_mod_2 - v4 Global step: 200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:44<01:02,  1.07it/s][A
Iteration:  75%|███████▌  | 202/268 [00:45<00:47,  1.39it/s][A
Iteration:  76%|███████▌  | 203/268 [00:45<00:36,  1.76it/s][A
Iteration:  76%|███████▌  | 204/268 [00:45<00:29,  2.18it/s][A
Iteration:  76%|███████▋  | 205/268 [00:45<00:24,  2.58it/s][A
Iteration:  77%|███████▋  | 206/268 [00:45<00:20,  3.09it/s][A
Iteration:  77%|███████▋  | 207/268 [00:46<00:17,  3.51it/s][A
Iteration:  78%|███████▊  | 208/268 [00:46<00:15,  3.89it/s][A
Iteration:  78%|███████▊  | 209/268 [00:46<00:14,  4.18it/s][A
Iteration:  78%|███████▊  | 210/268 [00:46<00:13,  4.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:46<00:12,  4.56it/s][A
Iteration:  79%|███████▉  | 212/268 [00:47<00:11,  4.70it/s][A
Iteration:  79%|███████▉  | 213/268 [00:47<00:11,  4.84it/s][A
Iteration:  80%|███████▉  | 214/268 [00:47<00:11,  4.76it/s][A
Iteration:  80%|████████  | 215/268 [00:47<00:10,  4.84it/s][A
Iteration:  81%|████████  | 216/268 [00:47<00:10,  4.86it/s][A
Iteration:  81%|████████  | 217/268 [00:48<00:10,  4.92it/s][A
Iteration:  81%|████████▏ | 218/268 [00:48<00:10,  4.99it/s][A
Iteration:  82%|████████▏ | 219/268 [00:48<00:09,  5.13it/s][A
Iteration:  82%|████████▏ | 220/268 [00:48<00:09,  5.15it/s][A
Iteration:  82%|████████▏ | 221/268 [00:48<00:08,  5.24it/s][A
Iteration:  83%|████████▎ | 222/268 [00:49<00:08,  5.17it/s][A
Iteration:  83%|████████▎ | 223/268 [00:49<00:09,  4.93it/s][A
Iteration:  84%|████████▎ | 224/268 [00:49<00:08,  5.01it/s][A
Iteration:  84%|████████▍ | 225/268 [00:49<00:08,  5.04it/s][A
Iteration:  84%|████████▍ | 226/268 [00:49<00:08,  5.04it/s][A
Iteration:  85%|████████▍ | 227/268 [00:50<00:08,  4.97it/s][A
Iteration:  85%|████████▌ | 228/268 [00:50<00:07,  5.04it/s][A
Iteration:  85%|████████▌ | 229/268 [00:50<00:07,  4.90it/s][A
Iteration:  86%|████████▌ | 230/268 [00:50<00:07,  4.97it/s][A
Iteration:  86%|████████▌ | 231/268 [00:50<00:07,  5.01it/s][A
Iteration:  87%|████████▋ | 232/268 [00:51<00:07,  5.07it/s][A
Iteration:  87%|████████▋ | 233/268 [00:51<00:06,  5.11it/s][A
Iteration:  87%|████████▋ | 234/268 [00:51<00:06,  5.12it/s][A
Iteration:  88%|████████▊ | 235/268 [00:51<00:06,  5.10it/s][A
Iteration:  88%|████████▊ | 236/268 [00:51<00:06,  5.00it/s][A
Iteration:  88%|████████▊ | 237/268 [00:52<00:06,  5.06it/s][A
Iteration:  89%|████████▉ | 238/268 [00:52<00:05,  5.01it/s][A
Iteration:  89%|████████▉ | 239/268 [00:52<00:05,  5.13it/s][A
Iteration:  90%|████████▉ | 240/268 [00:52<00:05,  5.14it/s][A
Iteration:  90%|████████▉ | 241/268 [00:52<00:05,  5.14it/s][A
Iteration:  90%|█████████ | 242/268 [00:53<00:05,  5.16it/s][A
Iteration:  91%|█████████ | 243/268 [00:53<00:04,  5.16it/s][A
Iteration:  91%|█████████ | 244/268 [00:53<00:04,  5.17it/s][A
Iteration:  91%|█████████▏| 245/268 [00:53<00:04,  5.16it/s][A
Iteration:  92%|█████████▏| 246/268 [00:53<00:04,  4.98it/s][A
Iteration:  92%|█████████▏| 247/268 [00:54<00:04,  4.88it/s][A
Iteration:  93%|█████████▎| 248/268 [00:54<00:04,  4.98it/s][A
Iteration:  93%|█████████▎| 249/268 [00:54<00:03,  4.94it/s][A[INFO|trainer.py:570] 2024-04-30 10:13:51,474 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:13:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:13:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:13:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:13:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.60it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.61it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.61it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.61it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.61it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.61it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.61it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.61it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.61it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.61it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.60it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.60it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.60it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.60it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.60it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.71it/s]04/30/2024 10:13:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:13:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.25502269682328815, 'eval_loss': 0.8167505, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2642, 2636, 2630, 2626, 2626, 2621, 2616, 2622, 2671, 2698, 2732, 2760], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7939616, 'remaining_params': 77077984, 'pruned_model_sparsity': 0.09338791026799156, 'expected_sparsity': 0.09499, 'target_sparsity': 0.02658582089552239, 'step': 250}


Iteration:  93%|█████████▎| 250/268 [00:58<00:22,  1.23s/it][A
Iteration:  94%|█████████▎| 251/268 [00:58<00:15,  1.08it/s][A
Iteration:  94%|█████████▍| 252/268 [00:58<00:11,  1.41it/s][A
Iteration:  94%|█████████▍| 253/268 [00:58<00:08,  1.81it/s][A
Iteration:  95%|█████████▍| 254/268 [00:58<00:06,  2.25it/s][A
Iteration:  95%|█████████▌| 255/268 [00:59<00:04,  2.68it/s][A
Iteration:  96%|█████████▌| 256/268 [00:59<00:03,  3.12it/s][A
Iteration:  96%|█████████▌| 257/268 [00:59<00:03,  3.53it/s][A
Iteration:  96%|█████████▋| 258/268 [00:59<00:02,  3.83it/s][A
Iteration:  97%|█████████▋| 259/268 [00:59<00:02,  4.13it/s][A
Iteration:  97%|█████████▋| 260/268 [01:00<00:01,  4.39it/s][A
Iteration:  97%|█████████▋| 261/268 [01:00<00:01,  4.45it/s][A
Iteration:  98%|█████████▊| 262/268 [01:00<00:01,  4.62it/s][A
Iteration:  98%|█████████▊| 263/268 [01:00<00:01,  4.75it/s][A
Iteration:  99%|█████████▊| 264/268 [01:00<00:00,  4.89it/s][A
Iteration:  99%|█████████▉| 265/268 [01:01<00:00,  4.95it/s][A
Iteration:  99%|█████████▉| 266/268 [01:01<00:00,  4.86it/s][A
Iteration: 100%|█████████▉| 267/268 [01:01<00:00,  4.85it/s][A
Iteration: 100%|██████████| 268/268 [01:01<00:00,  5.26it/s][A04/30/2024 10:13:58 - INFO - trainer.trainer_mod_2 - Epoch 0 finished. Took 61.67 seconds.
Iteration: 100%|██████████| 268/268 [01:01<00:00,  4.35it/s]
Epoch:   1%|          | 1/100 [01:04<1:46:59, 64.85s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:55,  4.82it/s][A
Iteration:   1%|          | 2/268 [00:00<00:53,  4.97it/s][A
Iteration:   1%|          | 3/268 [00:00<00:53,  4.92it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:51,  5.12it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:51,  5.13it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:50,  5.14it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:50,  5.16it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:50,  5.14it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:48,  5.31it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:49,  5.23it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:49,  5.20it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:49,  5.20it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:49,  5.19it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:49,  5.14it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:49,  5.16it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:49,  5.12it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:48,  5.13it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:50,  4.99it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:50,  4.89it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:49,  4.96it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:50,  4.91it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:49,  5.01it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:49,  4.96it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:50,  4.83it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:49,  4.95it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:50,  4.82it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:49,  4.91it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:49,  4.88it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:49,  4.87it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:47,  5.03it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:47,  4.97it/s][A[INFO|trainer.py:570] 2024-04-30 10:14:04,872 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:14:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:14:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:14:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:14:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.56it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:14:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:14:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.25598541130339864, 'eval_loss': 1.0308937, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2668, 2663, 2653, 2647, 2648, 2642, 2637, 2647, 2716, 2753, 2794, 2827], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 7303836, 'remaining_params': 77713764, 'pruned_model_sparsity': 0.08590969399277326, 'expected_sparsity': 0.08752, 'target_sparsity': 0.03544776119402985, 'step': 300}


Iteration:  12%|█▏        | 32/268 [00:09<04:53,  1.24s/it][A04/30/2024 10:14:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:10<03:39,  1.07it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<02:46,  1.40it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<02:09,  1.80it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<01:43,  2.25it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<01:25,  2.70it/s][A
Iteration:  14%|█▍        | 38/268 [00:11<01:13,  3.15it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<01:05,  3.51it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<01:00,  3.78it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:55,  4.11it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:52,  4.34it/s][A
Iteration:  16%|█▌        | 43/268 [00:12<00:49,  4.56it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:46,  4.79it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:45,  4.86it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:45,  4.92it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:45,  4.89it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:43,  5.10it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<00:42,  5.11it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.14it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:43,  5.04it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:42,  5.09it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:42,  5.09it/s][A
Iteration:  20%|██        | 54/268 [00:14<00:42,  5.02it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:43,  4.87it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:43,  4.91it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:41,  5.06it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:42,  4.99it/s][A
Iteration:  22%|██▏       | 59/268 [00:15<00:42,  4.95it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:40,  5.09it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:41,  4.95it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:41,  5.00it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:41,  4.94it/s][A
Iteration:  24%|██▍       | 64/268 [00:16<00:39,  5.10it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:40,  4.96it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:40,  5.00it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:39,  5.05it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:40,  4.97it/s][A
Iteration:  26%|██▌       | 69/268 [00:17<00:39,  5.05it/s][A
Iteration:  26%|██▌       | 70/268 [00:17<00:39,  5.04it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:38,  5.08it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:38,  5.12it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:38,  5.04it/s][A
Iteration:  28%|██▊       | 74/268 [00:18<00:38,  5.09it/s][A
Iteration:  28%|██▊       | 75/268 [00:18<00:37,  5.09it/s][A
Iteration:  28%|██▊       | 76/268 [00:18<00:36,  5.20it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:37,  5.09it/s][A
Iteration:  29%|██▉       | 78/268 [00:18<00:37,  5.07it/s][A
Iteration:  29%|██▉       | 79/268 [00:19<00:38,  4.96it/s][A
Iteration:  30%|██▉       | 80/268 [00:19<00:36,  5.16it/s][A
Iteration:  30%|███       | 81/268 [00:19<00:36,  5.18it/s][A[INFO|trainer.py:570] 2024-04-30 10:14:18,235 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:14:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:14:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:14:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:14:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:14:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:14:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.26357566347479533, 'eval_loss': 1.1267371, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2694, 2687, 2676, 2668, 2668, 2663, 2657, 2670, 2755, 2798, 2841, 2877], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6753848, 'remaining_params': 78263752, 'pruned_model_sparsity': 0.07944058641975309, 'expected_sparsity': 0.08105, 'target_sparsity': 0.044309701492537316, 'step': 350}


Iteration:  31%|███       | 82/268 [00:23<03:50,  1.24s/it][A
Iteration:  31%|███       | 83/268 [00:23<02:50,  1.08it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<02:11,  1.40it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<01:41,  1.80it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<01:21,  2.23it/s][A
Iteration:  32%|███▏      | 87/268 [00:24<01:06,  2.71it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:57,  3.15it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:50,  3.52it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:45,  3.90it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:42,  4.21it/s][A
Iteration:  34%|███▍      | 92/268 [00:25<00:39,  4.44it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:39,  4.46it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:38,  4.47it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:37,  4.66it/s][A
Iteration:  36%|███▌      | 96/268 [00:26<00:36,  4.76it/s][A
Iteration:  36%|███▌      | 97/268 [00:26<00:36,  4.67it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:35,  4.77it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:34,  4.89it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:33,  4.99it/s][A
Iteration:  38%|███▊      | 101/268 [00:27<00:34,  4.85it/s][A
Iteration:  38%|███▊      | 102/268 [00:27<00:34,  4.78it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:34,  4.85it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:33,  4.90it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:33,  4.94it/s][A
Iteration:  40%|███▉      | 106/268 [00:28<00:32,  4.96it/s][A
Iteration:  40%|███▉      | 107/268 [00:28<00:32,  4.98it/s][A
Iteration:  40%|████      | 108/268 [00:28<00:33,  4.83it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:32,  4.91it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:32,  4.89it/s][A
Iteration:  41%|████▏     | 111/268 [00:29<00:31,  4.94it/s][A
Iteration:  42%|████▏     | 112/268 [00:29<00:31,  4.95it/s][A
Iteration:  42%|████▏     | 113/268 [00:29<00:30,  5.03it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:30,  5.08it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:31,  4.88it/s][A
Iteration:  43%|████▎     | 116/268 [00:30<00:31,  4.86it/s][A
Iteration:  44%|████▎     | 117/268 [00:30<00:30,  4.95it/s][A
Iteration:  44%|████▍     | 118/268 [00:30<00:30,  4.91it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:30,  4.94it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:29,  5.08it/s][A
Iteration:  45%|████▌     | 121/268 [00:31<00:28,  5.11it/s][A
Iteration:  46%|████▌     | 122/268 [00:31<00:29,  5.03it/s][A
Iteration:  46%|████▌     | 123/268 [00:31<00:29,  4.99it/s][A
Iteration:  46%|████▋     | 124/268 [00:31<00:28,  5.00it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:28,  5.00it/s][A
Iteration:  47%|████▋     | 126/268 [00:32<00:28,  5.01it/s][A
Iteration:  47%|████▋     | 127/268 [00:32<00:28,  4.96it/s][A
Iteration:  48%|████▊     | 128/268 [00:32<00:28,  4.92it/s][A
Iteration:  48%|████▊     | 129/268 [00:32<00:27,  5.00it/s][A
Iteration:  49%|████▊     | 130/268 [00:32<00:27,  5.01it/s][A
Iteration:  49%|████▉     | 131/268 [00:33<00:27,  4.96it/s][A[INFO|trainer.py:570] 2024-04-30 10:14:31,784 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:14:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:14:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:14:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:14:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:14:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:14:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3271291536929218, 'eval_loss': 1.0104256, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2717, 2709, 2696, 2686, 2686, 2683, 2676, 2694, 2789, 2835, 2878, 2913], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 6281992, 'remaining_params': 78735608, 'pruned_model_sparsity': 0.07389048855766335, 'expected_sparsity': 0.07549, 'target_sparsity': 0.05317164179104478, 'step': 400}


Iteration:  49%|████▉     | 132/268 [00:36<02:49,  1.24s/it][A04/30/2024 10:14:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:36<02:05,  1.07it/s][A
Iteration:  50%|█████     | 134/268 [00:37<01:35,  1.41it/s][A
Iteration:  50%|█████     | 135/268 [00:37<01:13,  1.81it/s][A
Iteration:  51%|█████     | 136/268 [00:37<00:59,  2.23it/s][A
Iteration:  51%|█████     | 137/268 [00:37<00:49,  2.65it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:42,  3.09it/s][A
Iteration:  52%|█████▏    | 139/268 [00:38<00:36,  3.52it/s][A
Iteration:  52%|█████▏    | 140/268 [00:38<00:33,  3.86it/s][A
Iteration:  53%|█████▎    | 141/268 [00:38<00:31,  4.08it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:29,  4.29it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:27,  4.58it/s][A
Iteration:  54%|█████▎    | 144/268 [00:39<00:26,  4.76it/s][A
Iteration:  54%|█████▍    | 145/268 [00:39<00:25,  4.79it/s][A
Iteration:  54%|█████▍    | 146/268 [00:39<00:24,  4.96it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:24,  4.99it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:23,  5.03it/s][A
Iteration:  56%|█████▌    | 149/268 [00:40<00:23,  5.07it/s][A
Iteration:  56%|█████▌    | 150/268 [00:40<00:23,  5.06it/s][A
Iteration:  56%|█████▋    | 151/268 [00:40<00:23,  4.99it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:22,  5.18it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.13it/s][A
Iteration:  57%|█████▋    | 154/268 [00:41<00:22,  5.10it/s][A
Iteration:  58%|█████▊    | 155/268 [00:41<00:23,  4.90it/s][A
Iteration:  58%|█████▊    | 156/268 [00:41<00:23,  4.85it/s][A
Iteration:  59%|█████▊    | 157/268 [00:41<00:22,  5.01it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:21,  5.14it/s][A
Iteration:  59%|█████▉    | 159/268 [00:42<00:21,  5.15it/s][A
Iteration:  60%|█████▉    | 160/268 [00:42<00:21,  5.11it/s][A
Iteration:  60%|██████    | 161/268 [00:42<00:21,  5.02it/s][A
Iteration:  60%|██████    | 162/268 [00:42<00:20,  5.07it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:20,  5.10it/s][A
Iteration:  61%|██████    | 164/268 [00:43<00:20,  5.07it/s][A
Iteration:  62%|██████▏   | 165/268 [00:43<00:20,  4.98it/s][A
Iteration:  62%|██████▏   | 166/268 [00:43<00:20,  5.04it/s][A
Iteration:  62%|██████▏   | 167/268 [00:43<00:20,  4.97it/s][A
Iteration:  63%|██████▎   | 168/268 [00:43<00:19,  5.17it/s][A
Iteration:  63%|██████▎   | 169/268 [00:44<00:18,  5.25it/s][A
Iteration:  63%|██████▎   | 170/268 [00:44<00:19,  5.14it/s][A
Iteration:  64%|██████▍   | 171/268 [00:44<00:19,  5.10it/s][A
Iteration:  64%|██████▍   | 172/268 [00:44<00:18,  5.08it/s][A
Iteration:  65%|██████▍   | 173/268 [00:44<00:18,  5.12it/s][A
Iteration:  65%|██████▍   | 174/268 [00:45<00:18,  5.04it/s][A
Iteration:  65%|██████▌   | 175/268 [00:45<00:18,  5.09it/s][A
Iteration:  66%|██████▌   | 176/268 [00:45<00:18,  5.11it/s][A
Iteration:  66%|██████▌   | 177/268 [00:45<00:18,  5.02it/s][A
Iteration:  66%|██████▋   | 178/268 [00:45<00:17,  5.03it/s][A
Iteration:  67%|██████▋   | 179/268 [00:46<00:17,  5.15it/s][A
Iteration:  67%|██████▋   | 180/268 [00:46<00:17,  4.96it/s][A
Iteration:  68%|██████▊   | 181/268 [00:46<00:17,  4.94it/s][A[INFO|trainer.py:570] 2024-04-30 10:14:45,135 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:14:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:14:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:14:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:14:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.60it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.61it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.61it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.61it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.49it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.53it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.55it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.57it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.58it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.60it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.60it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.60it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.60it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.60it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:14:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:14:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.258099917391379, 'eval_loss': 1.0773692, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2738, 2728, 2715, 2704, 2703, 2700, 2693, 2715, 2815, 2863, 2905, 2939], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5889800, 'remaining_params': 79127800, 'pruned_model_sparsity': 0.0692774202047576, 'expected_sparsity': 0.07094, 'target_sparsity': 0.06203358208955223, 'step': 450}


Iteration:  68%|██████▊   | 182/268 [00:50<01:46,  1.24s/it][A
Iteration:  68%|██████▊   | 183/268 [00:50<01:18,  1.08it/s][A
Iteration:  69%|██████▊   | 184/268 [00:50<00:59,  1.42it/s][A
Iteration:  69%|██████▉   | 185/268 [00:50<00:46,  1.79it/s][A
Iteration:  69%|██████▉   | 186/268 [00:50<00:37,  2.21it/s][A
Iteration:  70%|██████▉   | 187/268 [00:51<00:30,  2.66it/s][A
Iteration:  70%|███████   | 188/268 [00:51<00:25,  3.12it/s][A
Iteration:  71%|███████   | 189/268 [00:51<00:23,  3.37it/s][A
Iteration:  71%|███████   | 190/268 [00:51<00:20,  3.84it/s][A
Iteration:  71%|███████▏  | 191/268 [00:51<00:18,  4.21it/s][A
Iteration:  72%|███████▏  | 192/268 [00:52<00:17,  4.44it/s][A
Iteration:  72%|███████▏  | 193/268 [00:52<00:15,  4.75it/s][A
Iteration:  72%|███████▏  | 194/268 [00:52<00:15,  4.83it/s][A
Iteration:  73%|███████▎  | 195/268 [00:52<00:14,  4.88it/s][A
Iteration:  73%|███████▎  | 196/268 [00:52<00:14,  4.86it/s][A
Iteration:  74%|███████▎  | 197/268 [00:53<00:14,  4.91it/s][A
Iteration:  74%|███████▍  | 198/268 [00:53<00:13,  5.05it/s][A
Iteration:  74%|███████▍  | 199/268 [00:53<00:13,  5.04it/s][A
Iteration:  75%|███████▍  | 200/268 [00:53<00:13,  5.04it/s][A
Iteration:  75%|███████▌  | 201/268 [00:53<00:13,  5.03it/s][A
Iteration:  75%|███████▌  | 202/268 [00:54<00:13,  4.98it/s][A
Iteration:  76%|███████▌  | 203/268 [00:54<00:12,  5.05it/s][A
Iteration:  76%|███████▌  | 204/268 [00:54<00:12,  4.99it/s][A
Iteration:  76%|███████▋  | 205/268 [00:54<00:12,  5.00it/s][A
Iteration:  77%|███████▋  | 206/268 [00:54<00:12,  5.06it/s][A
Iteration:  77%|███████▋  | 207/268 [00:55<00:11,  5.10it/s][A
Iteration:  78%|███████▊  | 208/268 [00:55<00:11,  5.09it/s][A
Iteration:  78%|███████▊  | 209/268 [00:55<00:11,  4.95it/s][A
Iteration:  78%|███████▊  | 210/268 [00:55<00:11,  4.88it/s][A
Iteration:  79%|███████▊  | 211/268 [00:55<00:11,  4.92it/s][A
Iteration:  79%|███████▉  | 212/268 [00:56<00:11,  4.95it/s][A
Iteration:  79%|███████▉  | 213/268 [00:56<00:11,  5.00it/s][A
Iteration:  80%|███████▉  | 214/268 [00:56<00:10,  5.04it/s][A
Iteration:  80%|████████  | 215/268 [00:56<00:10,  5.10it/s][A
Iteration:  81%|████████  | 216/268 [00:56<00:10,  5.08it/s][A
Iteration:  81%|████████  | 217/268 [00:57<00:10,  5.00it/s][A
Iteration:  81%|████████▏ | 218/268 [00:57<00:09,  5.01it/s][A
Iteration:  82%|████████▏ | 219/268 [00:57<00:10,  4.87it/s][A
Iteration:  82%|████████▏ | 220/268 [00:57<00:09,  4.85it/s][A
Iteration:  82%|████████▏ | 221/268 [00:57<00:09,  4.92it/s][A
Iteration:  83%|████████▎ | 222/268 [00:58<00:09,  5.00it/s][A
Iteration:  83%|████████▎ | 223/268 [00:58<00:08,  5.03it/s][A
Iteration:  84%|████████▎ | 224/268 [00:58<00:08,  5.03it/s][A
Iteration:  84%|████████▍ | 225/268 [00:58<00:08,  4.96it/s][A
Iteration:  84%|████████▍ | 226/268 [00:58<00:08,  4.81it/s][A
Iteration:  85%|████████▍ | 227/268 [00:59<00:08,  4.62it/s][A
Iteration:  85%|████████▌ | 228/268 [00:59<00:08,  4.74it/s][A
Iteration:  85%|████████▌ | 229/268 [00:59<00:07,  4.94it/s][A
Iteration:  86%|████████▌ | 230/268 [00:59<00:07,  5.07it/s][A
Iteration:  86%|████████▌ | 231/268 [00:59<00:07,  4.97it/s][A[INFO|trainer.py:570] 2024-04-30 10:14:58,620 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:14:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:14:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:14:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:14:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:15:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:15:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.30352336473584907, 'eval_loss': 0.8614446, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2756, 2746, 2731, 2720, 2718, 2715, 2708, 2732, 2836, 2885, 2926, 2958], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5563484, 'remaining_params': 79454116, 'pruned_model_sparsity': 0.06543920317675399, 'expected_sparsity': 0.06713, 'target_sparsity': 0.0708955223880597, 'step': 500}


Iteration:  87%|████████▋ | 232/268 [01:03<00:44,  1.25s/it][A04/30/2024 10:15:02 - INFO - trainer.trainer_mod_2 - v4 Global step: 500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [01:03<00:32,  1.07it/s][A
Iteration:  87%|████████▋ | 234/268 [01:04<00:24,  1.40it/s][A
Iteration:  88%|████████▊ | 235/268 [01:04<00:18,  1.79it/s][A
Iteration:  88%|████████▊ | 236/268 [01:04<00:14,  2.22it/s][A
Iteration:  88%|████████▊ | 237/268 [01:04<00:11,  2.68it/s][A
Iteration:  89%|████████▉ | 238/268 [01:04<00:09,  3.13it/s][A
Iteration:  89%|████████▉ | 239/268 [01:04<00:08,  3.55it/s][A
Iteration:  90%|████████▉ | 240/268 [01:05<00:07,  3.89it/s][A
Iteration:  90%|████████▉ | 241/268 [01:05<00:06,  4.13it/s][A
Iteration:  90%|█████████ | 242/268 [01:05<00:05,  4.45it/s][A
Iteration:  91%|█████████ | 243/268 [01:05<00:05,  4.56it/s][A
Iteration:  91%|█████████ | 244/268 [01:05<00:05,  4.71it/s][A
Iteration:  91%|█████████▏| 245/268 [01:06<00:04,  4.97it/s][A
Iteration:  92%|█████████▏| 246/268 [01:06<00:04,  4.82it/s][A
Iteration:  92%|█████████▏| 247/268 [01:06<00:04,  4.93it/s][A
Iteration:  93%|█████████▎| 248/268 [01:06<00:04,  4.99it/s][A
Iteration:  93%|█████████▎| 249/268 [01:06<00:03,  5.06it/s][A
Iteration:  93%|█████████▎| 250/268 [01:07<00:03,  5.07it/s][A
Iteration:  94%|█████████▎| 251/268 [01:07<00:03,  5.08it/s][A
Iteration:  94%|█████████▍| 252/268 [01:07<00:03,  4.59it/s][A
Iteration:  94%|█████████▍| 253/268 [01:07<00:03,  4.67it/s][A
Iteration:  95%|█████████▍| 254/268 [01:08<00:02,  4.76it/s][A
Iteration:  95%|█████████▌| 255/268 [01:08<00:02,  4.85it/s][A
Iteration:  96%|█████████▌| 256/268 [01:08<00:02,  4.90it/s][A
Iteration:  96%|█████████▌| 257/268 [01:08<00:02,  5.11it/s][A
Iteration:  96%|█████████▋| 258/268 [01:08<00:01,  5.02it/s][A
Iteration:  97%|█████████▋| 259/268 [01:08<00:01,  5.15it/s][A
Iteration:  97%|█████████▋| 260/268 [01:09<00:01,  5.10it/s][A
Iteration:  97%|█████████▋| 261/268 [01:09<00:01,  5.02it/s][A
Iteration:  98%|█████████▊| 262/268 [01:09<00:01,  4.96it/s][A
Iteration:  98%|█████████▊| 263/268 [01:09<00:01,  4.80it/s][A
Iteration:  99%|█████████▊| 264/268 [01:10<00:00,  4.86it/s][A
Iteration:  99%|█████████▉| 265/268 [01:10<00:00,  4.91it/s][A
Iteration:  99%|█████████▉| 266/268 [01:10<00:00,  4.95it/s][A
Iteration: 100%|█████████▉| 267/268 [01:10<00:00,  5.02it/s][A
Iteration: 100%|██████████| 268/268 [01:10<00:00,  5.45it/s][A04/30/2024 10:15:09 - INFO - trainer.trainer_mod_2 - Epoch 1 finished. Took 70.75 seconds.
Iteration: 100%|██████████| 268/268 [01:10<00:00,  3.79it/s]
Epoch:   2%|▏         | 2/100 [02:15<1:51:35, 68.32s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:51,  5.16it/s][A
Iteration:   1%|          | 2/268 [00:00<00:53,  4.97it/s][A
Iteration:   1%|          | 3/268 [00:00<00:55,  4.75it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:52,  5.00it/s][A
Iteration:   2%|▏         | 5/268 [00:01<00:53,  4.94it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:52,  4.98it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:52,  5.01it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:52,  4.95it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:55,  4.70it/s][A
Iteration:   4%|▎         | 10/268 [00:02<00:53,  4.84it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:53,  4.82it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:52,  4.92it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:51,  4.99it/s][A[INFO|trainer.py:570] 2024-04-30 10:15:12,083 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:15:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:15:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:15:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:15:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:15:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:15:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3011864341966238, 'eval_loss': 1.001061, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2773, 2762, 2747, 2734, 2731, 2728, 2721, 2748, 2855, 2903, 2943, 2972], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5278532, 'remaining_params': 79739068, 'pruned_model_sparsity': 0.06208752070159591, 'expected_sparsity': 0.06376, 'target_sparsity': 0.07975746268656717, 'step': 550}


Iteration:   5%|▌         | 14/268 [00:06<05:16,  1.24s/it][A
Iteration:   6%|▌         | 15/268 [00:06<03:54,  1.08it/s][A
Iteration:   6%|▌         | 16/268 [00:06<02:58,  1.41it/s][A
Iteration:   6%|▋         | 17/268 [00:06<02:19,  1.80it/s][A
Iteration:   7%|▋         | 18/268 [00:07<01:52,  2.23it/s][A
Iteration:   7%|▋         | 19/268 [00:07<01:33,  2.67it/s][A
Iteration:   7%|▋         | 20/268 [00:07<01:19,  3.10it/s][A
Iteration:   8%|▊         | 21/268 [00:07<01:10,  3.53it/s][A
Iteration:   8%|▊         | 22/268 [00:07<01:03,  3.88it/s][A
Iteration:   9%|▊         | 23/268 [00:08<00:57,  4.25it/s][A
Iteration:   9%|▉         | 24/268 [00:08<00:54,  4.48it/s][A
Iteration:   9%|▉         | 25/268 [00:08<00:51,  4.73it/s][A
Iteration:  10%|▉         | 26/268 [00:08<00:50,  4.77it/s][A
Iteration:  10%|█         | 27/268 [00:08<00:50,  4.79it/s][A
Iteration:  10%|█         | 28/268 [00:09<00:49,  4.86it/s][A
Iteration:  11%|█         | 29/268 [00:09<00:48,  4.90it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:47,  5.05it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:45,  5.17it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:46,  5.12it/s][A
Iteration:  12%|█▏        | 33/268 [00:10<00:46,  5.10it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<00:45,  5.19it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:45,  5.09it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:45,  5.13it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:45,  5.05it/s][A
Iteration:  14%|█▍        | 38/268 [00:11<00:47,  4.87it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<00:48,  4.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:48,  4.74it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:47,  4.78it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:46,  4.89it/s][A
Iteration:  16%|█▌        | 43/268 [00:12<00:46,  4.87it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:45,  4.93it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:43,  5.07it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:43,  5.11it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:43,  5.10it/s][A
Iteration:  18%|█▊        | 48/268 [00:13<00:43,  5.08it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<00:42,  5.11it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.10it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:41,  5.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:43,  4.96it/s][A
Iteration:  20%|█▉        | 53/268 [00:14<00:43,  4.99it/s][A
Iteration:  20%|██        | 54/268 [00:14<00:42,  5.01it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:43,  4.95it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:42,  5.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:42,  5.02it/s][A
Iteration:  22%|██▏       | 58/268 [00:15<00:41,  5.02it/s][A
Iteration:  22%|██▏       | 59/268 [00:15<00:42,  4.96it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:41,  5.04it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:41,  4.98it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:40,  5.05it/s][A
Iteration:  24%|██▎       | 63/268 [00:16<00:40,  5.06it/s][A[INFO|trainer.py:570] 2024-04-30 10:15:25,456 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:15:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:15:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:15:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:15:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.59it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.58it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.58it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.58it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.58it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.58it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:15:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:15:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2420937606062148, 'eval_loss': 1.2480866, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2786, 2775, 2760, 2746, 2743, 2740, 2733, 2760, 2869, 2917, 2955, 2984], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5047200, 'remaining_params': 79970400, 'pruned_model_sparsity': 0.05936653116531165, 'expected_sparsity': 0.06102, 'target_sparsity': 0.08861940298507463, 'step': 600}


Iteration:  24%|██▍       | 64/268 [00:19<04:11,  1.23s/it][A04/30/2024 10:15:28 - INFO - trainer.trainer_mod_2 - v4 Global step: 600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:19<03:07,  1.08it/s][A
Iteration:  25%|██▍       | 66/268 [00:20<02:21,  1.43it/s][A
Iteration:  25%|██▌       | 67/268 [00:20<01:50,  1.83it/s][A
Iteration:  25%|██▌       | 68/268 [00:20<01:28,  2.27it/s][A
Iteration:  26%|██▌       | 69/268 [00:20<01:13,  2.72it/s][A
Iteration:  26%|██▌       | 70/268 [00:20<01:02,  3.17it/s][A
Iteration:  26%|██▋       | 71/268 [00:21<00:55,  3.56it/s][A
Iteration:  27%|██▋       | 72/268 [00:21<00:50,  3.87it/s][A
Iteration:  27%|██▋       | 73/268 [00:21<00:46,  4.19it/s][A
Iteration:  28%|██▊       | 74/268 [00:21<00:44,  4.41it/s][A
Iteration:  28%|██▊       | 75/268 [00:21<00:42,  4.52it/s][A
Iteration:  28%|██▊       | 76/268 [00:22<00:41,  4.62it/s][A
Iteration:  29%|██▊       | 77/268 [00:22<00:40,  4.77it/s][A
Iteration:  29%|██▉       | 78/268 [00:22<00:39,  4.86it/s][A
Iteration:  29%|██▉       | 79/268 [00:22<00:38,  4.87it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<00:38,  4.92it/s][A
Iteration:  30%|███       | 81/268 [00:23<00:37,  4.95it/s][A
Iteration:  31%|███       | 82/268 [00:23<00:37,  5.02it/s][A
Iteration:  31%|███       | 83/268 [00:23<00:36,  5.02it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:37,  4.97it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:38,  4.81it/s][A
Iteration:  32%|███▏      | 86/268 [00:24<00:38,  4.72it/s][A
Iteration:  32%|███▏      | 87/268 [00:24<00:37,  4.81it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:36,  4.93it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:36,  4.90it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:35,  4.95it/s][A
Iteration:  34%|███▍      | 91/268 [00:25<00:36,  4.91it/s][A
Iteration:  34%|███▍      | 92/268 [00:25<00:36,  4.86it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:35,  4.91it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:35,  4.94it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:34,  4.97it/s][A
Iteration:  36%|███▌      | 96/268 [00:26<00:34,  5.02it/s][A
Iteration:  36%|███▌      | 97/268 [00:26<00:33,  5.13it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:33,  5.14it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:33,  5.10it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:32,  5.09it/s][A
Iteration:  38%|███▊      | 101/268 [00:27<00:33,  5.00it/s][A
Iteration:  38%|███▊      | 102/268 [00:27<00:32,  5.04it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:31,  5.22it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:31,  5.14it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:31,  5.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:28<00:31,  5.16it/s][A
Iteration:  40%|███▉      | 107/268 [00:28<00:31,  5.07it/s][A
Iteration:  40%|████      | 108/268 [00:28<00:31,  5.09it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:31,  5.09it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:30,  5.13it/s][A
Iteration:  41%|████▏     | 111/268 [00:29<00:31,  5.04it/s][A
Iteration:  42%|████▏     | 112/268 [00:29<00:31,  4.99it/s][A
Iteration:  42%|████▏     | 113/268 [00:29<00:31,  4.88it/s][A[INFO|trainer.py:570] 2024-04-30 10:15:38,879 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:15:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:15:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:15:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:15:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.57it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.57it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:15:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:15:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2557834132889666, 'eval_loss': 1.1853817, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2797, 2786, 2770, 2755, 2751, 2749, 2742, 2771, 2881, 2928, 2964, 2992], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4866424, 'remaining_params': 80151176, 'pruned_model_sparsity': 0.05724019497139416, 'expected_sparsity': 0.05893, 'target_sparsity': 0.09748134328358209, 'step': 650}


Iteration:  43%|████▎     | 114/268 [00:33<03:12,  1.25s/it][A
Iteration:  43%|████▎     | 115/268 [00:33<02:23,  1.07it/s][A
Iteration:  43%|████▎     | 116/268 [00:33<01:48,  1.39it/s][A
Iteration:  44%|████▎     | 117/268 [00:33<01:24,  1.78it/s][A
Iteration:  44%|████▍     | 118/268 [00:33<01:07,  2.21it/s][A
Iteration:  44%|████▍     | 119/268 [00:34<00:55,  2.66it/s][A
Iteration:  45%|████▍     | 120/268 [00:34<00:47,  3.12it/s][A
Iteration:  45%|████▌     | 121/268 [00:34<00:41,  3.54it/s][A
Iteration:  46%|████▌     | 122/268 [00:34<00:37,  3.91it/s][A
Iteration:  46%|████▌     | 123/268 [00:34<00:34,  4.22it/s][A
Iteration:  46%|████▋     | 124/268 [00:35<00:33,  4.30it/s][A
Iteration:  47%|████▋     | 125/268 [00:35<00:31,  4.50it/s][A
Iteration:  47%|████▋     | 126/268 [00:35<00:31,  4.56it/s][A
Iteration:  47%|████▋     | 127/268 [00:35<00:30,  4.62it/s][A
Iteration:  48%|████▊     | 128/268 [00:35<00:29,  4.77it/s][A
Iteration:  48%|████▊     | 129/268 [00:36<00:28,  4.85it/s][A
Iteration:  49%|████▊     | 130/268 [00:36<00:27,  4.95it/s][A
Iteration:  49%|████▉     | 131/268 [00:36<00:27,  4.99it/s][A
Iteration:  49%|████▉     | 132/268 [00:36<00:26,  5.12it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<00:26,  5.02it/s][A
Iteration:  50%|█████     | 134/268 [00:37<00:26,  4.96it/s][A
Iteration:  50%|█████     | 135/268 [00:37<00:27,  4.87it/s][A
Iteration:  51%|█████     | 136/268 [00:37<00:26,  4.97it/s][A
Iteration:  51%|█████     | 137/268 [00:37<00:26,  4.93it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:26,  4.99it/s][A
Iteration:  52%|█████▏    | 139/268 [00:38<00:26,  4.95it/s][A
Iteration:  52%|█████▏    | 140/268 [00:38<00:25,  5.01it/s][A
Iteration:  53%|█████▎    | 141/268 [00:38<00:25,  5.00it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:25,  4.93it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:27,  4.53it/s][A
Iteration:  54%|█████▎    | 144/268 [00:39<00:26,  4.70it/s][A
Iteration:  54%|█████▍    | 145/268 [00:39<00:25,  4.79it/s][A
Iteration:  54%|█████▍    | 146/268 [00:39<00:25,  4.80it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:24,  4.91it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:24,  4.95it/s][A
Iteration:  56%|█████▌    | 149/268 [00:40<00:23,  5.03it/s][A
Iteration:  56%|█████▌    | 150/268 [00:40<00:22,  5.14it/s][A
Iteration:  56%|█████▋    | 151/268 [00:40<00:22,  5.10it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:22,  5.12it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.14it/s][A
Iteration:  57%|█████▋    | 154/268 [00:41<00:23,  4.94it/s][A
Iteration:  58%|█████▊    | 155/268 [00:41<00:23,  4.89it/s][A
Iteration:  58%|█████▊    | 156/268 [00:41<00:22,  4.99it/s][A
Iteration:  59%|█████▊    | 157/268 [00:41<00:22,  5.03it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:22,  4.93it/s][A
Iteration:  59%|█████▉    | 159/268 [00:42<00:21,  5.09it/s][A
Iteration:  60%|█████▉    | 160/268 [00:42<00:20,  5.20it/s][A
Iteration:  60%|██████    | 161/268 [00:42<00:20,  5.21it/s][A
Iteration:  60%|██████    | 162/268 [00:42<00:21,  5.03it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:21,  4.98it/s][A[INFO|trainer.py:570] 2024-04-30 10:15:52,419 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:15:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:15:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:15:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:15:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.60it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:15:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:15:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2774881647999953, 'eval_loss': 1.0773137, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2805, 2794, 2776, 2762, 2759, 2757, 2750, 2780, 2889, 2935, 2971, 2998], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4728544, 'remaining_params': 80289056, 'pruned_model_sparsity': 0.05561841312857573, 'expected_sparsity': 0.05733, 'target_sparsity': 0.10634328358208955, 'step': 700}


Iteration:  61%|██████    | 164/268 [00:46<02:09,  1.25s/it][A04/30/2024 10:15:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:46<01:36,  1.07it/s][A
Iteration:  62%|██████▏   | 166/268 [00:47<01:12,  1.41it/s][A
Iteration:  62%|██████▏   | 167/268 [00:47<00:56,  1.79it/s][A
Iteration:  63%|██████▎   | 168/268 [00:47<00:44,  2.24it/s][A
Iteration:  63%|██████▎   | 169/268 [00:47<00:36,  2.70it/s][A
Iteration:  63%|██████▎   | 170/268 [00:47<00:31,  3.15it/s][A
Iteration:  64%|██████▍   | 171/268 [00:47<00:27,  3.58it/s][A
Iteration:  64%|██████▍   | 172/268 [00:48<00:24,  3.88it/s][A
Iteration:  65%|██████▍   | 173/268 [00:48<00:22,  4.18it/s][A
Iteration:  65%|██████▍   | 174/268 [00:48<00:21,  4.41it/s][A
Iteration:  65%|██████▌   | 175/268 [00:48<00:20,  4.62it/s][A
Iteration:  66%|██████▌   | 176/268 [00:48<00:19,  4.75it/s][A
Iteration:  66%|██████▌   | 177/268 [00:49<00:19,  4.78it/s][A
Iteration:  66%|██████▋   | 178/268 [00:49<00:18,  4.86it/s][A
Iteration:  67%|██████▋   | 179/268 [00:49<00:18,  4.77it/s][A
Iteration:  67%|██████▋   | 180/268 [00:49<00:18,  4.86it/s][A
Iteration:  68%|██████▊   | 181/268 [00:49<00:17,  4.94it/s][A
Iteration:  68%|██████▊   | 182/268 [00:50<00:17,  4.99it/s][A
Iteration:  68%|██████▊   | 183/268 [00:50<00:16,  5.13it/s][A
Iteration:  69%|██████▊   | 184/268 [00:50<00:16,  5.10it/s][A
Iteration:  69%|██████▉   | 185/268 [00:50<00:16,  5.14it/s][A
Iteration:  69%|██████▉   | 186/268 [00:50<00:16,  5.10it/s][A
Iteration:  70%|██████▉   | 187/268 [00:51<00:16,  4.96it/s][A
Iteration:  70%|███████   | 188/268 [00:51<00:15,  5.02it/s][A
Iteration:  71%|███████   | 189/268 [00:51<00:15,  5.03it/s][A
Iteration:  71%|███████   | 190/268 [00:51<00:15,  5.07it/s][A
Iteration:  71%|███████▏  | 191/268 [00:51<00:15,  5.12it/s][A
Iteration:  72%|███████▏  | 192/268 [00:52<00:14,  5.11it/s][A
Iteration:  72%|███████▏  | 193/268 [00:52<00:14,  5.14it/s][A
Iteration:  72%|███████▏  | 194/268 [00:52<00:14,  5.14it/s][A
Iteration:  73%|███████▎  | 195/268 [00:52<00:14,  5.04it/s][A
Iteration:  73%|███████▎  | 196/268 [00:52<00:14,  4.98it/s][A
Iteration:  74%|███████▎  | 197/268 [00:53<00:14,  4.93it/s][A
Iteration:  74%|███████▍  | 198/268 [00:53<00:13,  5.02it/s][A
Iteration:  74%|███████▍  | 199/268 [00:53<00:14,  4.90it/s][A
Iteration:  75%|███████▍  | 200/268 [00:53<00:13,  4.99it/s][A
Iteration:  75%|███████▌  | 201/268 [00:53<00:13,  5.04it/s][A
Iteration:  75%|███████▌  | 202/268 [00:54<00:12,  5.08it/s][A
Iteration:  76%|███████▌  | 203/268 [00:54<00:13,  4.90it/s][A
Iteration:  76%|███████▌  | 204/268 [00:54<00:12,  4.98it/s][A
Iteration:  76%|███████▋  | 205/268 [00:54<00:12,  4.86it/s][A
Iteration:  77%|███████▋  | 206/268 [00:54<00:12,  4.90it/s][A
Iteration:  77%|███████▋  | 207/268 [00:55<00:12,  4.97it/s][A
Iteration:  78%|███████▊  | 208/268 [00:55<00:11,  5.01it/s][A
Iteration:  78%|███████▊  | 209/268 [00:55<00:11,  5.02it/s][A
Iteration:  78%|███████▊  | 210/268 [00:55<00:11,  5.06it/s][A
Iteration:  79%|███████▊  | 211/268 [00:55<00:11,  4.97it/s][A
Iteration:  79%|███████▉  | 212/268 [00:56<00:11,  5.03it/s][A
Iteration:  79%|███████▉  | 213/268 [00:56<00:11,  4.93it/s][A[INFO|trainer.py:570] 2024-04-30 10:16:05,812 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:16:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:16:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:16:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:16:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:16:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:16:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2894166011790952, 'eval_loss': 1.0991212, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2810, 2799, 2782, 2768, 2764, 2763, 2755, 2785, 2894, 2940, 2975, 3001], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4636624, 'remaining_params': 80380976, 'pruned_model_sparsity': 0.05453722523336344, 'expected_sparsity': 0.05625, 'target_sparsity': 0.11520522388059701, 'step': 750}


Iteration:  80%|███████▉  | 214/268 [01:00<01:06,  1.24s/it][A
Iteration:  80%|████████  | 215/268 [01:00<00:49,  1.08it/s][A
Iteration:  81%|████████  | 216/268 [01:00<00:36,  1.41it/s][A
Iteration:  81%|████████  | 217/268 [01:00<00:28,  1.80it/s][A
Iteration:  81%|████████▏ | 218/268 [01:00<00:22,  2.23it/s][A
Iteration:  82%|████████▏ | 219/268 [01:01<00:18,  2.68it/s][A
Iteration:  82%|████████▏ | 220/268 [01:01<00:15,  3.10it/s][A
Iteration:  82%|████████▏ | 221/268 [01:01<00:13,  3.43it/s][A
Iteration:  83%|████████▎ | 222/268 [01:01<00:12,  3.79it/s][A
Iteration:  83%|████████▎ | 223/268 [01:01<00:11,  4.01it/s][A
Iteration:  84%|████████▎ | 224/268 [01:02<00:10,  4.21it/s][A
Iteration:  84%|████████▍ | 225/268 [01:02<00:09,  4.46it/s][A
Iteration:  84%|████████▍ | 226/268 [01:02<00:08,  4.72it/s][A
Iteration:  85%|████████▍ | 227/268 [01:02<00:08,  4.81it/s][A
Iteration:  85%|████████▌ | 228/268 [01:02<00:08,  4.81it/s][A
Iteration:  85%|████████▌ | 229/268 [01:03<00:07,  4.98it/s][A
Iteration:  86%|████████▌ | 230/268 [01:03<00:07,  5.04it/s][A
Iteration:  86%|████████▌ | 231/268 [01:03<00:07,  5.22it/s][A
Iteration:  87%|████████▋ | 232/268 [01:03<00:06,  5.19it/s][A
Iteration:  87%|████████▋ | 233/268 [01:03<00:06,  5.33it/s][A
Iteration:  87%|████████▋ | 234/268 [01:03<00:06,  5.22it/s][A
Iteration:  88%|████████▊ | 235/268 [01:04<00:06,  5.17it/s][A
Iteration:  88%|████████▊ | 236/268 [01:04<00:06,  5.18it/s][A
Iteration:  88%|████████▊ | 237/268 [01:04<00:06,  5.12it/s][A
Iteration:  89%|████████▉ | 238/268 [01:04<00:05,  5.13it/s][A
Iteration:  89%|████████▉ | 239/268 [01:04<00:05,  5.15it/s][A
Iteration:  90%|████████▉ | 240/268 [01:05<00:05,  5.05it/s][A
Iteration:  90%|████████▉ | 241/268 [01:05<00:05,  5.04it/s][A
Iteration:  90%|█████████ | 242/268 [01:05<00:05,  5.07it/s][A
Iteration:  91%|█████████ | 243/268 [01:05<00:04,  5.08it/s][A
Iteration:  91%|█████████ | 244/268 [01:05<00:04,  5.10it/s][A
Iteration:  91%|█████████▏| 245/268 [01:06<00:04,  5.08it/s][A
Iteration:  92%|█████████▏| 246/268 [01:06<00:04,  5.11it/s][A
Iteration:  92%|█████████▏| 247/268 [01:06<00:04,  5.03it/s][A
Iteration:  93%|█████████▎| 248/268 [01:06<00:03,  5.09it/s][A
Iteration:  93%|█████████▎| 249/268 [01:06<00:03,  5.09it/s][A
Iteration:  93%|█████████▎| 250/268 [01:07<00:03,  5.00it/s][A
Iteration:  94%|█████████▎| 251/268 [01:07<00:03,  4.84it/s][A
Iteration:  94%|█████████▍| 252/268 [01:07<00:03,  4.84it/s][A
Iteration:  94%|█████████▍| 253/268 [01:07<00:03,  4.95it/s][A
Iteration:  95%|█████████▍| 254/268 [01:07<00:02,  4.83it/s][A
Iteration:  95%|█████████▌| 255/268 [01:08<00:02,  4.85it/s][A
Iteration:  96%|█████████▌| 256/268 [01:08<00:02,  4.72it/s][A
Iteration:  96%|█████████▌| 257/268 [01:08<00:02,  4.85it/s][A
Iteration:  96%|█████████▋| 258/268 [01:08<00:02,  4.84it/s][A
Iteration:  97%|█████████▋| 259/268 [01:09<00:01,  4.62it/s][A
Iteration:  97%|█████████▋| 260/268 [01:09<00:01,  4.67it/s][A
Iteration:  97%|█████████▋| 261/268 [01:09<00:01,  4.72it/s][A
Iteration:  98%|█████████▊| 262/268 [01:09<00:01,  4.98it/s][A
Iteration:  98%|█████████▊| 263/268 [01:09<00:00,  5.04it/s][A[INFO|trainer.py:570] 2024-04-30 10:16:19,252 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:16:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:16:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:16:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:16:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.57it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.58it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.60it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:16:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:16:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4057173311487901, 'eval_loss': 0.9654631, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2813, 2802, 2786, 2771, 2767, 2767, 2760, 2789, 2897, 2942, 2976, 3003], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4579940, 'remaining_params': 80437660, 'pruned_model_sparsity': 0.05387049269798254, 'expected_sparsity': 0.05558, 'target_sparsity': 0.12406716417910446, 'step': 800}


Iteration:  99%|█████████▊| 264/268 [01:13<00:04,  1.23s/it][A04/30/2024 10:16:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [01:13<00:02,  1.09it/s][A
Iteration:  99%|█████████▉| 266/268 [01:13<00:01,  1.42it/s][A
Iteration: 100%|█████████▉| 267/268 [01:14<00:00,  1.79it/s][A
Iteration: 100%|██████████| 268/268 [01:14<00:00,  2.30it/s][A04/30/2024 10:16:23 - INFO - trainer.trainer_mod_2 - Epoch 2 finished. Took 74.23 seconds.
Iteration: 100%|██████████| 268/268 [01:14<00:00,  3.61it/s]
Epoch:   3%|▎         | 3/100 [03:29<1:54:48, 71.02s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:54,  4.89it/s][A
Iteration:   1%|          | 2/268 [00:00<00:54,  4.90it/s][A
Iteration:   1%|          | 3/268 [00:00<00:55,  4.76it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:55,  4.79it/s][A
Iteration:   2%|▏         | 5/268 [00:01<00:53,  4.95it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:52,  4.97it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:51,  5.03it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:51,  5.03it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:51,  5.03it/s][A
Iteration:   4%|▎         | 10/268 [00:02<00:51,  4.98it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:50,  5.04it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:50,  5.03it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:51,  4.98it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:51,  4.94it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:49,  5.09it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:49,  5.05it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:51,  4.90it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:49,  5.05it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:51,  4.85it/s][A
Iteration:   7%|▋         | 20/268 [00:04<00:49,  5.01it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:48,  5.06it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:48,  5.05it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:48,  5.08it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:48,  5.02it/s][A
Iteration:   9%|▉         | 25/268 [00:05<00:51,  4.73it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:50,  4.82it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:48,  4.93it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:49,  4.80it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:49,  4.81it/s][A
Iteration:  11%|█         | 30/268 [00:06<00:49,  4.84it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:48,  4.93it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:48,  4.87it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:47,  4.95it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:47,  4.97it/s][A
Iteration:  13%|█▎        | 35/268 [00:07<00:47,  4.93it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:46,  5.01it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:47,  4.91it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:46,  4.99it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:46,  4.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:08<00:45,  4.98it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:45,  4.94it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:45,  4.98it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:45,  4.94it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:44,  5.09it/s][A
Iteration:  17%|█▋        | 45/268 [00:09<00:43,  5.13it/s][A[INFO|trainer.py:570] 2024-04-30 10:16:32,730 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:16:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:16:32 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:16:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:16:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.58it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:16:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:16:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3046287759864934, 'eval_loss': 1.2039708, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2814, 2803, 2786, 2772, 2768, 2767, 2757, 2787, 2897, 2941, 2975, 3003], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4584536, 'remaining_params': 80433064, 'pruned_model_sparsity': 0.05392455209274315, 'expected_sparsity': 0.05567, 'target_sparsity': 0.13292910447761191, 'step': 850}


Iteration:  17%|█▋        | 46/268 [00:12<04:33,  1.23s/it][A
Iteration:  18%|█▊        | 47/268 [00:12<03:24,  1.08it/s][A
Iteration:  18%|█▊        | 48/268 [00:13<02:34,  1.42it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<02:00,  1.82it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<01:35,  2.27it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<01:20,  2.68it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<01:08,  3.16it/s][A
Iteration:  20%|█▉        | 53/268 [00:14<01:00,  3.56it/s][A
Iteration:  20%|██        | 54/268 [00:14<00:54,  3.93it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:50,  4.21it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:47,  4.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:45,  4.62it/s][A
Iteration:  22%|██▏       | 58/268 [00:15<00:44,  4.74it/s][A
Iteration:  22%|██▏       | 59/268 [00:15<00:43,  4.76it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:42,  4.88it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:42,  4.92it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:41,  4.95it/s][A
Iteration:  24%|██▎       | 63/268 [00:16<00:41,  4.91it/s][A
Iteration:  24%|██▍       | 64/268 [00:16<00:42,  4.78it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:42,  4.78it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:42,  4.70it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:41,  4.81it/s][A
Iteration:  25%|██▌       | 68/268 [00:17<00:40,  4.91it/s][A
Iteration:  26%|██▌       | 69/268 [00:17<00:40,  4.90it/s][A
Iteration:  26%|██▌       | 70/268 [00:17<00:39,  4.96it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:39,  5.03it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:38,  5.08it/s][A
Iteration:  27%|██▋       | 73/268 [00:18<00:38,  5.12it/s][A
Iteration:  28%|██▊       | 74/268 [00:18<00:37,  5.14it/s][A
Iteration:  28%|██▊       | 75/268 [00:18<00:37,  5.11it/s][A
Iteration:  28%|██▊       | 76/268 [00:18<00:37,  5.08it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:37,  5.07it/s][A
Iteration:  29%|██▉       | 78/268 [00:19<00:37,  5.10it/s][A
Iteration:  29%|██▉       | 79/268 [00:19<00:38,  4.95it/s][A
Iteration:  30%|██▉       | 80/268 [00:19<00:39,  4.82it/s][A
Iteration:  30%|███       | 81/268 [00:19<00:38,  4.92it/s][A
Iteration:  31%|███       | 82/268 [00:19<00:37,  4.90it/s][A
Iteration:  31%|███       | 83/268 [00:20<00:36,  5.10it/s][A
Iteration:  31%|███▏      | 84/268 [00:20<00:35,  5.13it/s][A
Iteration:  32%|███▏      | 85/268 [00:20<00:34,  5.29it/s][A
Iteration:  32%|███▏      | 86/268 [00:20<00:34,  5.26it/s][A
Iteration:  32%|███▏      | 87/268 [00:20<00:34,  5.19it/s][A
Iteration:  33%|███▎      | 88/268 [00:21<00:33,  5.32it/s][A
Iteration:  33%|███▎      | 89/268 [00:21<00:34,  5.22it/s][A
Iteration:  34%|███▎      | 90/268 [00:21<00:34,  5.22it/s][A
Iteration:  34%|███▍      | 91/268 [00:21<00:33,  5.21it/s][A
Iteration:  34%|███▍      | 92/268 [00:21<00:34,  5.09it/s][A
Iteration:  35%|███▍      | 93/268 [00:22<00:34,  5.09it/s][A
Iteration:  35%|███▌      | 94/268 [00:22<00:34,  5.10it/s][A
Iteration:  35%|███▌      | 95/268 [00:22<00:35,  4.93it/s][A[INFO|trainer.py:570] 2024-04-30 10:16:46,083 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:16:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:16:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:16:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:16:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.56it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.09it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.28it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.39it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.46it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.51it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.54it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.56it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.57it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.58it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.59it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.67it/s]04/30/2024 10:16:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:16:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2685388119872844, 'eval_loss': 1.2866126, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2811, 2801, 2785, 2769, 2765, 2763, 2751, 2782, 2893, 2936, 2970, 3000], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4651944, 'remaining_params': 80365656, 'pruned_model_sparsity': 0.05471742321589883, 'expected_sparsity': 0.05654, 'target_sparsity': 0.1417910447761194, 'step': 900}


Iteration:  36%|███▌      | 96/268 [00:26<03:33,  1.24s/it][A04/30/2024 10:16:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  36%|███▌      | 97/268 [00:26<02:39,  1.07it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<02:01,  1.40it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<01:34,  1.79it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<01:15,  2.22it/s][A
Iteration:  38%|███▊      | 101/268 [00:27<01:02,  2.67it/s][A
Iteration:  38%|███▊      | 102/268 [00:27<00:53,  3.09it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:47,  3.49it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:43,  3.81it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:39,  4.11it/s][A
Iteration:  40%|███▉      | 106/268 [00:28<00:37,  4.35it/s][A
Iteration:  40%|███▉      | 107/268 [00:28<00:35,  4.55it/s][A
Iteration:  40%|████      | 108/268 [00:28<00:34,  4.63it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:34,  4.64it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:33,  4.76it/s][A
Iteration:  41%|████▏     | 111/268 [00:29<00:31,  4.94it/s][A
Iteration:  42%|████▏     | 112/268 [00:29<00:31,  5.00it/s][A
Iteration:  42%|████▏     | 113/268 [00:29<00:31,  4.96it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:31,  4.85it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:31,  4.90it/s][A
Iteration:  43%|████▎     | 116/268 [00:30<00:30,  4.98it/s][A
Iteration:  44%|████▎     | 117/268 [00:30<00:30,  4.94it/s][A
Iteration:  44%|████▍     | 118/268 [00:30<00:29,  5.08it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:29,  5.10it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:29,  5.07it/s][A
Iteration:  45%|████▌     | 121/268 [00:31<00:29,  5.05it/s][A
Iteration:  46%|████▌     | 122/268 [00:31<00:28,  5.17it/s][A
Iteration:  46%|████▌     | 123/268 [00:31<00:27,  5.31it/s][A
Iteration:  46%|████▋     | 124/268 [00:31<00:27,  5.16it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:27,  5.16it/s][A
Iteration:  47%|████▋     | 126/268 [00:32<00:27,  5.12it/s][A
Iteration:  47%|████▋     | 127/268 [00:32<00:26,  5.29it/s][A
Iteration:  48%|████▊     | 128/268 [00:32<00:26,  5.25it/s][A
Iteration:  48%|████▊     | 129/268 [00:32<00:27,  5.03it/s][A
Iteration:  49%|████▊     | 130/268 [00:32<00:26,  5.20it/s][A
Iteration:  49%|████▉     | 131/268 [00:33<00:26,  5.18it/s][A
Iteration:  49%|████▉     | 132/268 [00:33<00:26,  5.20it/s][A
Iteration:  50%|████▉     | 133/268 [00:33<00:26,  5.17it/s][A
Iteration:  50%|█████     | 134/268 [00:33<00:25,  5.25it/s][A
Iteration:  50%|█████     | 135/268 [00:33<00:25,  5.22it/s][A
Iteration:  51%|█████     | 136/268 [00:33<00:25,  5.10it/s][A
Iteration:  51%|█████     | 137/268 [00:34<00:25,  5.21it/s][A
Iteration:  51%|█████▏    | 138/268 [00:34<00:24,  5.28it/s][A
Iteration:  52%|█████▏    | 139/268 [00:34<00:24,  5.25it/s][A
Iteration:  52%|█████▏    | 140/268 [00:34<00:25,  5.12it/s][A
Iteration:  53%|█████▎    | 141/268 [00:34<00:25,  5.02it/s][A
Iteration:  53%|█████▎    | 142/268 [00:35<00:25,  4.98it/s][A
Iteration:  53%|█████▎    | 143/268 [00:35<00:24,  5.05it/s][A
Iteration:  54%|█████▎    | 144/268 [00:35<00:24,  5.05it/s][A
Iteration:  54%|█████▍    | 145/268 [00:35<00:24,  4.97it/s][A[INFO|trainer.py:570] 2024-04-30 10:16:59,409 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:16:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:16:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:16:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:16:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.56it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:17:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:17:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.38184961113286764, 'eval_loss': 1.0651, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2803, 2795, 2780, 2764, 2759, 2759, 2744, 2775, 2885, 2926, 2960, 2993], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 4779100, 'remaining_params': 80238500, 'pruned_model_sparsity': 0.056213066470942485, 'expected_sparsity': 0.05825, 'target_sparsity': 0.15065298507462688, 'step': 950}


Iteration:  54%|█████▍    | 146/268 [00:39<02:30,  1.23s/it][A
Iteration:  55%|█████▍    | 147/268 [00:39<01:51,  1.08it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<01:23,  1.43it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<01:05,  1.82it/s][A
Iteration:  56%|█████▌    | 150/268 [00:40<00:53,  2.23it/s][A
Iteration:  56%|█████▋    | 151/268 [00:40<00:44,  2.66it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:37,  3.09it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:32,  3.55it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:29,  3.86it/s][A
Iteration:  58%|█████▊    | 155/268 [00:41<00:26,  4.26it/s][A
Iteration:  58%|█████▊    | 156/268 [00:41<00:24,  4.51it/s][A
Iteration:  59%|█████▊    | 157/268 [00:41<00:24,  4.57it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:23,  4.70it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:23,  4.74it/s][A
Iteration:  60%|█████▉    | 160/268 [00:42<00:21,  4.93it/s][A
Iteration:  60%|██████    | 161/268 [00:42<00:21,  4.87it/s][A
Iteration:  60%|██████    | 162/268 [00:42<00:21,  4.83it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:21,  4.88it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:21,  4.87it/s][A
Iteration:  62%|██████▏   | 165/268 [00:43<00:20,  4.97it/s][A
Iteration:  62%|██████▏   | 166/268 [00:43<00:21,  4.84it/s][A
Iteration:  62%|██████▏   | 167/268 [00:43<00:20,  4.95it/s][A
Iteration:  63%|██████▎   | 168/268 [00:43<00:20,  4.97it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:19,  4.98it/s][A
Iteration:  63%|██████▎   | 170/268 [00:44<00:19,  5.03it/s][A
Iteration:  64%|██████▍   | 171/268 [00:44<00:19,  5.06it/s][A
Iteration:  64%|██████▍   | 172/268 [00:44<00:19,  4.86it/s][A
Iteration:  65%|██████▍   | 173/268 [00:44<00:20,  4.74it/s][A
Iteration:  65%|██████▍   | 174/268 [00:45<00:19,  4.79it/s][A
Iteration:  65%|██████▌   | 175/268 [00:45<00:18,  4.90it/s][A
Iteration:  66%|██████▌   | 176/268 [00:45<00:18,  4.99it/s][A
Iteration:  66%|██████▌   | 177/268 [00:45<00:17,  5.12it/s][A
Iteration:  66%|██████▋   | 178/268 [00:45<00:18,  4.97it/s][A
Iteration:  67%|██████▋   | 179/268 [00:46<00:17,  4.98it/s][A
Iteration:  67%|██████▋   | 180/268 [00:46<00:17,  5.05it/s][A
Iteration:  68%|██████▊   | 181/268 [00:46<00:17,  5.05it/s][A
Iteration:  68%|██████▊   | 182/268 [00:46<00:16,  5.08it/s][A
Iteration:  68%|██████▊   | 183/268 [00:46<00:16,  5.06it/s][A
Iteration:  69%|██████▊   | 184/268 [00:46<00:16,  5.17it/s][A
Iteration:  69%|██████▉   | 185/268 [00:47<00:16,  5.12it/s][A
Iteration:  69%|██████▉   | 186/268 [00:47<00:16,  5.08it/s][A
Iteration:  70%|██████▉   | 187/268 [00:47<00:15,  5.19it/s][A
Iteration:  70%|███████   | 188/268 [00:47<00:15,  5.14it/s][A
Iteration:  71%|███████   | 189/268 [00:47<00:14,  5.28it/s][A
Iteration:  71%|███████   | 190/268 [00:48<00:14,  5.33it/s][A
Iteration:  71%|███████▏  | 191/268 [00:48<00:14,  5.30it/s][A
Iteration:  72%|███████▏  | 192/268 [00:48<00:14,  5.15it/s][A
Iteration:  72%|███████▏  | 193/268 [00:48<00:14,  5.15it/s][A
Iteration:  72%|███████▏  | 194/268 [00:48<00:14,  5.01it/s][A
Iteration:  73%|███████▎  | 195/268 [00:49<00:15,  4.86it/s][A[INFO|trainer.py:570] 2024-04-30 10:17:12,819 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:17:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:17:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:17:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:17:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.55it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.59it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.59it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.59it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.59it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.59it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.58it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.57it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.57it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.58it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.58it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.58it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.58it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.58it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.58it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.57it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.69it/s]04/30/2024 10:17:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:17:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3007930418319595, 'eval_loss': 1.3329413, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2792, 2784, 2771, 2755, 2750, 2750, 2732, 2761, 2872, 2907, 2942, 2981], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5002772, 'remaining_params': 80014828, 'pruned_model_sparsity': 0.05884395701595905, 'expected_sparsity': 0.06149, 'target_sparsity': 0.15951492537313433, 'step': 1000}


Iteration:  73%|███████▎  | 196/268 [00:52<01:29,  1.25s/it][A04/30/2024 10:17:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 1000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  74%|███████▎  | 197/268 [00:53<01:06,  1.07it/s][A
Iteration:  74%|███████▍  | 198/268 [00:53<00:49,  1.40it/s][A
Iteration:  74%|███████▍  | 199/268 [00:53<00:38,  1.79it/s][A
Iteration:  75%|███████▍  | 200/268 [00:53<00:30,  2.22it/s][A
Iteration:  75%|███████▌  | 201/268 [00:53<00:25,  2.65it/s][A
Iteration:  75%|███████▌  | 202/268 [00:54<00:21,  3.04it/s][A
Iteration:  76%|███████▌  | 203/268 [00:54<00:18,  3.51it/s][A
Iteration:  76%|███████▌  | 204/268 [00:54<00:16,  3.88it/s][A
Iteration:  76%|███████▋  | 205/268 [00:54<00:15,  4.17it/s][A
Iteration:  77%|███████▋  | 206/268 [00:54<00:14,  4.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:55<00:13,  4.39it/s][A
Iteration:  78%|███████▊  | 208/268 [00:55<00:13,  4.52it/s][A
Iteration:  78%|███████▊  | 209/268 [00:55<00:13,  4.52it/s][A
Iteration:  78%|███████▊  | 210/268 [00:55<00:12,  4.60it/s][A
Iteration:  79%|███████▊  | 211/268 [00:55<00:12,  4.73it/s][A
Iteration:  79%|███████▉  | 212/268 [00:56<00:11,  4.75it/s][A
Iteration:  79%|███████▉  | 213/268 [00:56<00:11,  4.87it/s][A
Iteration:  80%|███████▉  | 214/268 [00:56<00:10,  4.93it/s][A
Iteration:  80%|████████  | 215/268 [00:56<00:10,  4.95it/s][A
Iteration:  81%|████████  | 216/268 [00:56<00:10,  5.00it/s][A
Iteration:  81%|████████  | 217/268 [00:57<00:09,  5.13it/s][A
Iteration:  81%|████████▏ | 218/268 [00:57<00:09,  5.11it/s][A
Iteration:  82%|████████▏ | 219/268 [00:57<00:09,  5.02it/s][A
Iteration:  82%|████████▏ | 220/268 [00:57<00:09,  4.85it/s][A
Iteration:  82%|████████▏ | 221/268 [00:57<00:09,  4.95it/s][A
Iteration:  83%|████████▎ | 222/268 [00:58<00:09,  4.91it/s][A
Iteration:  83%|████████▎ | 223/268 [00:58<00:09,  5.00it/s][A
Iteration:  84%|████████▎ | 224/268 [00:58<00:08,  5.01it/s][A
Iteration:  84%|████████▍ | 225/268 [00:58<00:08,  5.05it/s][A
Iteration:  84%|████████▍ | 226/268 [00:58<00:08,  4.99it/s][A
Iteration:  85%|████████▍ | 227/268 [00:59<00:08,  4.86it/s][A
Iteration:  85%|████████▌ | 228/268 [00:59<00:07,  5.01it/s][A
Iteration:  85%|████████▌ | 229/268 [00:59<00:07,  5.13it/s][A
Iteration:  86%|████████▌ | 230/268 [00:59<00:07,  5.13it/s][A
Iteration:  86%|████████▌ | 231/268 [00:59<00:07,  4.65it/s][A
Iteration:  87%|████████▋ | 232/268 [01:00<00:07,  4.75it/s][A
Iteration:  87%|████████▋ | 233/268 [01:00<00:07,  4.89it/s][A
Iteration:  87%|████████▋ | 234/268 [01:00<00:06,  4.96it/s][A
Iteration:  88%|████████▊ | 235/268 [01:00<00:06,  4.98it/s][A
Iteration:  88%|████████▊ | 236/268 [01:00<00:06,  5.05it/s][A
Iteration:  88%|████████▊ | 237/268 [01:01<00:06,  5.10it/s][A
Iteration:  89%|████████▉ | 238/268 [01:01<00:06,  4.94it/s][A
Iteration:  89%|████████▉ | 239/268 [01:01<00:05,  4.98it/s][A
Iteration:  90%|████████▉ | 240/268 [01:01<00:05,  5.00it/s][A
Iteration:  90%|████████▉ | 241/268 [01:01<00:05,  5.05it/s][A
Iteration:  90%|█████████ | 242/268 [01:02<00:05,  4.97it/s][A
Iteration:  91%|█████████ | 243/268 [01:02<00:05,  4.98it/s][A
Iteration:  91%|█████████ | 244/268 [01:02<00:04,  5.03it/s][A
Iteration:  91%|█████████▏| 245/268 [01:02<00:04,  4.97it/s][A[INFO|trainer.py:570] 2024-04-30 10:17:26,368 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:17:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:17:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:17:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:17:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:17:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:17:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3498528761781761, 'eval_loss': 1.1124647, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2775, 2767, 2757, 2741, 2736, 2736, 2716, 2741, 2851, 2873, 2905, 2952], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5381176, 'remaining_params': 79636424, 'pruned_model_sparsity': 0.06329484718458296, 'expected_sparsity': 0.07003, 'target_sparsity': 0.16837686567164178, 'step': 1050}


Iteration:  92%|█████████▏| 246/268 [01:06<00:27,  1.24s/it][A
Iteration:  92%|█████████▏| 247/268 [01:06<00:19,  1.09it/s][A
Iteration:  93%|█████████▎| 248/268 [01:06<00:14,  1.41it/s][A
Iteration:  93%|█████████▎| 249/268 [01:06<00:10,  1.80it/s][A
Iteration:  93%|█████████▎| 250/268 [01:07<00:08,  2.24it/s][A
Iteration:  94%|█████████▎| 251/268 [01:07<00:06,  2.69it/s][A
Iteration:  94%|█████████▍| 252/268 [01:07<00:05,  3.11it/s][A
Iteration:  94%|█████████▍| 253/268 [01:07<00:04,  3.48it/s][A
Iteration:  95%|█████████▍| 254/268 [01:07<00:03,  3.81it/s][A
Iteration:  95%|█████████▌| 255/268 [01:08<00:03,  4.13it/s][A
Iteration:  96%|█████████▌| 256/268 [01:08<00:02,  4.15it/s][A
Iteration:  96%|█████████▌| 257/268 [01:08<00:02,  4.42it/s][A
Iteration:  96%|█████████▋| 258/268 [01:08<00:02,  4.48it/s][A
Iteration:  97%|█████████▋| 259/268 [01:08<00:01,  4.67it/s][A
Iteration:  97%|█████████▋| 260/268 [01:09<00:01,  4.81it/s][A
Iteration:  97%|█████████▋| 261/268 [01:09<00:01,  4.74it/s][A
Iteration:  98%|█████████▊| 262/268 [01:09<00:01,  4.76it/s][A
Iteration:  98%|█████████▊| 263/268 [01:09<00:01,  4.88it/s][A
Iteration:  99%|█████████▊| 264/268 [01:09<00:00,  4.92it/s][A
Iteration:  99%|█████████▉| 265/268 [01:10<00:00,  4.99it/s][A
Iteration:  99%|█████████▉| 266/268 [01:10<00:00,  5.05it/s][A
Iteration: 100%|█████████▉| 267/268 [01:10<00:00,  5.04it/s][A
Iteration: 100%|██████████| 268/268 [01:10<00:00,  5.39it/s][A04/30/2024 10:17:34 - INFO - trainer.trainer_mod_2 - Epoch 3 finished. Took 70.74 seconds.
Iteration: 100%|██████████| 268/268 [01:10<00:00,  3.79it/s]
Epoch:   4%|▍         | 4/100 [04:40<1:53:27, 70.91s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:55,  4.82it/s][A
Iteration:   1%|          | 2/268 [00:00<00:52,  5.08it/s][A
Iteration:   1%|          | 3/268 [00:00<00:51,  5.14it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:53,  4.93it/s][A
Iteration:   2%|▏         | 5/268 [00:01<00:52,  4.97it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:52,  4.99it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:54,  4.82it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:53,  4.89it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:52,  4.93it/s][A
Iteration:   4%|▎         | 10/268 [00:02<00:50,  5.09it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:49,  5.19it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:47,  5.34it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:50,  5.05it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:50,  5.04it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:50,  4.99it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:50,  4.95it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:49,  5.04it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:49,  5.09it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:49,  5.08it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:48,  5.09it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:48,  5.09it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:48,  5.10it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:48,  5.02it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:48,  5.03it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:47,  5.08it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:47,  5.13it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:45,  5.28it/s][A[INFO|trainer.py:570] 2024-04-30 10:17:39,739 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:17:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:17:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:17:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:17:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.58it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.59it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.60it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.59it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.59it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.59it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.59it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.70it/s]04/30/2024 10:17:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:17:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3681808722299138, 'eval_loss': 1.3082495, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'hidden_dims': 766, 'intermediate_dims': [2751, 2744, 2739, 2722, 2718, 2719, 2697, 2714, 2819, 2818, 2835, 2886], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 5975592, 'remaining_params': 79042008, 'pruned_model_sparsity': 0.07028652890695573, 'expected_sparsity': 0.1102, 'target_sparsity': 0.17723880597014927, 'step': 1100}


Iteration:  10%|█         | 28/268 [00:08<04:55,  1.23s/it][A04/30/2024 10:17:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 1100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  11%|█         | 29/268 [00:09<03:40,  1.08it/s][A
Iteration:  11%|█         | 30/268 [00:09<02:47,  1.42it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<02:10,  1.81it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<01:44,  2.26it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<01:26,  2.70it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<01:14,  3.15it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<01:05,  3.58it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:58,  3.95it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:54,  4.26it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:52,  4.41it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<00:49,  4.61it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:48,  4.74it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:46,  4.84it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:46,  4.83it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:45,  4.94it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:45,  4.92it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:45,  4.94it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:43,  5.08it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:43,  5.06it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:42,  5.16it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<00:42,  5.18it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.15it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:42,  5.07it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:43,  4.98it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:42,  5.05it/s][A
Iteration:  20%|██        | 54/268 [00:14<00:41,  5.12it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:41,  5.11it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:41,  5.15it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:40,  5.16it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:40,  5.15it/s][A
Iteration:  22%|██▏       | 59/268 [00:15<00:41,  5.04it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:39,  5.22it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:40,  5.16it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:41,  5.02it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:40,  5.07it/s][A
Iteration:  24%|██▍       | 64/268 [00:16<00:39,  5.18it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:39,  5.20it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:40,  5.04it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:40,  5.00it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:42,  4.76it/s][A
Iteration:  26%|██▌       | 69/268 [00:17<00:40,  4.94it/s][A
Iteration:  26%|██▌       | 70/268 [00:17<00:38,  5.14it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:39,  4.99it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:37,  5.18it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:37,  5.16it/s][A
Iteration:  28%|██▊       | 74/268 [00:18<00:37,  5.18it/s][A
Iteration:  28%|██▊       | 75/268 [00:18<00:37,  5.16it/s][A
Iteration:  28%|██▊       | 76/268 [00:18<00:37,  5.10it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:37,  5.13it/s][A[INFO|trainer.py:570] 2024-04-30 10:17:53,071 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:17:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:17:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:17:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:17:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.64it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.66it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.66it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.67it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.66it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.66it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.66it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.66it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.66it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.66it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.66it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.66it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.66it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.77it/s]04/30/2024 10:17:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:17:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.36487671001457844, 'eval_loss': 1.2382988, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2722, 2716, 2717, 2701, 2697, 2699, 2671, 2683, 2769, 2773, 2751, 2695], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 15308536, 'remaining_params': 69709064, 'pruned_model_sparsity': 0.1800631398675098, 'expected_sparsity': 0.16438, 'target_sparsity': 0.18610074626865672, 'step': 1150}


Iteration:  29%|██▉       | 78/268 [00:22<03:56,  1.24s/it][A
Iteration:  29%|██▉       | 79/268 [00:22<02:55,  1.08it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<02:12,  1.42it/s][A
Iteration:  30%|███       | 81/268 [00:22<01:43,  1.81it/s][A
Iteration:  31%|███       | 82/268 [00:23<01:23,  2.23it/s][A
Iteration:  31%|███       | 83/268 [00:23<01:08,  2.70it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:59,  3.12it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:51,  3.54it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:47,  3.87it/s][A
Iteration:  32%|███▏      | 87/268 [00:24<00:43,  4.18it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:40,  4.41it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:38,  4.60it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:38,  4.62it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:37,  4.74it/s][A
Iteration:  34%|███▍      | 92/268 [00:25<00:36,  4.76it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:35,  4.96it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:35,  4.88it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:34,  4.95it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:34,  5.03it/s][A
Iteration:  36%|███▌      | 97/268 [00:26<00:35,  4.88it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:34,  4.99it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:32,  5.14it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:33,  5.03it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:33,  5.03it/s][A
Iteration:  38%|███▊      | 102/268 [00:27<00:32,  5.05it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:32,  5.01it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:32,  5.04it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:32,  5.02it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:32,  5.04it/s][A
Iteration:  40%|███▉      | 107/268 [00:28<00:31,  5.04it/s][A
Iteration:  40%|████      | 108/268 [00:28<00:31,  5.04it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:31,  4.99it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:32,  4.88it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:31,  4.98it/s][A
Iteration:  42%|████▏     | 112/268 [00:29<00:31,  5.02it/s][A
Iteration:  42%|████▏     | 113/268 [00:29<00:30,  5.08it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:30,  5.00it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:30,  5.03it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:30,  5.05it/s][A
Iteration:  44%|████▎     | 117/268 [00:30<00:30,  4.87it/s][A
Iteration:  44%|████▍     | 118/268 [00:30<00:30,  4.93it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:30,  4.85it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:29,  5.10it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:28,  5.13it/s][A
Iteration:  46%|████▌     | 122/268 [00:31<00:28,  5.12it/s][A
Iteration:  46%|████▌     | 123/268 [00:31<00:28,  5.16it/s][A
Iteration:  46%|████▋     | 124/268 [00:31<00:28,  5.14it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:29,  4.84it/s][A
Iteration:  47%|████▋     | 126/268 [00:31<00:28,  4.95it/s][A
Iteration:  47%|████▋     | 127/268 [00:32<00:27,  5.04it/s][A[INFO|trainer.py:570] 2024-04-30 10:18:06,447 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:18:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:18:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:18:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:18:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.64it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.64it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.66it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.66it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.66it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.66it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.66it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.66it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.65it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.65it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.65it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.63it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.62it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.63it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.64it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.64it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.65it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.65it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.65it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.76it/s]04/30/2024 10:18:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:18:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3779631903978113, 'eval_loss': 1.2447375, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1], 'hidden_dims': 766, 'intermediate_dims': [2689, 2686, 2694, 2679, 2675, 2677, 2644, 2645, 2696, 2751, 2705, 2312], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12], 'pruned_params': 16339572, 'remaining_params': 68678028, 'pruned_model_sparsity': 0.1921904640921409, 'expected_sparsity': 0.20143, 'target_sparsity': 0.19496268656716417, 'step': 1200}


Iteration:  48%|████▊     | 128/268 [00:35<02:52,  1.23s/it][A04/30/2024 10:18:09 - INFO - trainer.trainer_mod_2 - v4 Global step: 1200, Alignment: tensor([ 2,  7,  8, 11], device='cuda:0')

Iteration:  48%|████▊     | 129/268 [00:35<02:07,  1.09it/s][A
Iteration:  49%|████▊     | 130/268 [00:36<01:36,  1.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:36<01:15,  1.82it/s][A
Iteration:  49%|████▉     | 132/268 [00:36<01:01,  2.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<00:50,  2.68it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:42,  3.14it/s][A
Iteration:  50%|█████     | 135/268 [00:37<00:38,  3.49it/s][A
Iteration:  51%|█████     | 136/268 [00:37<00:34,  3.87it/s][A
Iteration:  51%|█████     | 137/268 [00:37<00:31,  4.12it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:29,  4.39it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:28,  4.58it/s][A
Iteration:  52%|█████▏    | 140/268 [00:38<00:27,  4.73it/s][A
Iteration:  53%|█████▎    | 141/268 [00:38<00:25,  4.99it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:25,  5.02it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:24,  5.01it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:25,  4.92it/s][A
Iteration:  54%|█████▍    | 145/268 [00:39<00:24,  5.07it/s][A
Iteration:  54%|█████▍    | 146/268 [00:39<00:23,  5.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:24,  5.02it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:23,  5.05it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:23,  5.10it/s][A
Iteration:  56%|█████▌    | 150/268 [00:40<00:23,  5.02it/s][A
Iteration:  56%|█████▋    | 151/268 [00:40<00:23,  5.07it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:22,  5.10it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.12it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:22,  5.06it/s][A
Iteration:  58%|█████▊    | 155/268 [00:41<00:23,  4.80it/s][A
Iteration:  58%|█████▊    | 156/268 [00:41<00:22,  4.93it/s][A
Iteration:  59%|█████▊    | 157/268 [00:41<00:22,  4.92it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:21,  5.00it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:21,  5.02it/s][A
Iteration:  60%|█████▉    | 160/268 [00:42<00:21,  5.04it/s][A
Iteration:  60%|██████    | 161/268 [00:42<00:22,  4.83it/s][A
Iteration:  60%|██████    | 162/268 [00:42<00:21,  5.01it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:20,  5.08it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:20,  5.02it/s][A
Iteration:  62%|██████▏   | 165/268 [00:43<00:21,  4.90it/s][A
Iteration:  62%|██████▏   | 166/268 [00:43<00:20,  5.01it/s][A
Iteration:  62%|██████▏   | 167/268 [00:43<00:19,  5.06it/s][A
Iteration:  63%|██████▎   | 168/268 [00:43<00:20,  4.90it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:20,  4.95it/s][A
Iteration:  63%|██████▎   | 170/268 [00:44<00:19,  5.00it/s][A
Iteration:  64%|██████▍   | 171/268 [00:44<00:19,  4.95it/s][A
Iteration:  64%|██████▍   | 172/268 [00:44<00:19,  5.03it/s][A
Iteration:  65%|██████▍   | 173/268 [00:44<00:18,  5.05it/s][A
Iteration:  65%|██████▍   | 174/268 [00:44<00:18,  5.05it/s][A
Iteration:  65%|██████▌   | 175/268 [00:44<00:18,  5.12it/s][A
Iteration:  66%|██████▌   | 176/268 [00:45<00:18,  5.06it/s][A
Iteration:  66%|██████▌   | 177/268 [00:45<00:18,  5.01it/s][A[INFO|trainer.py:570] 2024-04-30 10:18:19,804 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:18:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:18:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:18:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:18:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:18:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:18:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3721681506432673, 'eval_loss': 1.1636566, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2654, 2654, 2671, 2656, 2652, 2655, 2614, 2602, 2597, 2738, 2678, 2017], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 11, 12], 'pruned_params': 20779308, 'remaining_params': 64238292, 'pruned_model_sparsity': 0.2444118394308943, 'expected_sparsity': 0.23102, 'target_sparsity': 0.20382462686567165, 'step': 1250}


Iteration:  66%|██████▋   | 178/268 [00:49<01:50,  1.23s/it][A
Iteration:  67%|██████▋   | 179/268 [00:49<01:22,  1.08it/s][A
Iteration:  67%|██████▋   | 180/268 [00:49<01:02,  1.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:49<00:47,  1.81it/s][A
Iteration:  68%|██████▊   | 182/268 [00:49<00:38,  2.24it/s][A
Iteration:  68%|██████▊   | 183/268 [00:50<00:31,  2.69it/s][A
Iteration:  69%|██████▊   | 184/268 [00:50<00:26,  3.18it/s][A
Iteration:  69%|██████▉   | 185/268 [00:50<00:23,  3.55it/s][A
Iteration:  69%|██████▉   | 186/268 [00:50<00:21,  3.89it/s][A
Iteration:  70%|██████▉   | 187/268 [00:50<00:19,  4.20it/s][A
Iteration:  70%|███████   | 188/268 [00:51<00:18,  4.44it/s][A
Iteration:  71%|███████   | 189/268 [00:51<00:17,  4.55it/s][A
Iteration:  71%|███████   | 190/268 [00:51<00:16,  4.75it/s][A
Iteration:  71%|███████▏  | 191/268 [00:51<00:16,  4.81it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:15,  5.00it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:14,  5.08it/s][A
Iteration:  72%|███████▏  | 194/268 [00:52<00:14,  5.09it/s][A
Iteration:  73%|███████▎  | 195/268 [00:52<00:14,  5.13it/s][A
Iteration:  73%|███████▎  | 196/268 [00:52<00:14,  5.06it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:13,  5.08it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:13,  5.08it/s][A
Iteration:  74%|███████▍  | 199/268 [00:53<00:13,  5.00it/s][A
Iteration:  75%|███████▍  | 200/268 [00:53<00:13,  5.05it/s][A
Iteration:  75%|███████▌  | 201/268 [00:53<00:13,  4.97it/s][A
Iteration:  75%|███████▌  | 202/268 [00:53<00:13,  5.01it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:12,  5.06it/s][A
Iteration:  76%|███████▌  | 204/268 [00:54<00:12,  5.06it/s][A
Iteration:  76%|███████▋  | 205/268 [00:54<00:12,  5.10it/s][A
Iteration:  77%|███████▋  | 206/268 [00:54<00:12,  5.05it/s][A
Iteration:  77%|███████▋  | 207/268 [00:54<00:11,  5.11it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:11,  5.12it/s][A
Iteration:  78%|███████▊  | 209/268 [00:55<00:11,  5.12it/s][A
Iteration:  78%|███████▊  | 210/268 [00:55<00:11,  5.00it/s][A
Iteration:  79%|███████▊  | 211/268 [00:55<00:11,  4.95it/s][A
Iteration:  79%|███████▉  | 212/268 [00:55<00:11,  5.00it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:11,  4.97it/s][A
Iteration:  80%|███████▉  | 214/268 [00:56<00:10,  5.05it/s][A
Iteration:  80%|████████  | 215/268 [00:56<00:10,  5.11it/s][A
Iteration:  81%|████████  | 216/268 [00:56<00:10,  5.12it/s][A
Iteration:  81%|████████  | 217/268 [00:56<00:09,  5.14it/s][A
Iteration:  81%|████████▏ | 218/268 [00:56<00:10,  4.99it/s][A
Iteration:  82%|████████▏ | 219/268 [00:57<00:09,  4.97it/s][A
Iteration:  82%|████████▏ | 220/268 [00:57<00:09,  5.00it/s][A
Iteration:  82%|████████▏ | 221/268 [00:57<00:09,  4.83it/s][A
Iteration:  83%|████████▎ | 222/268 [00:57<00:09,  4.91it/s][A
Iteration:  83%|████████▎ | 223/268 [00:57<00:09,  4.79it/s][A
Iteration:  84%|████████▎ | 224/268 [00:58<00:09,  4.77it/s][A
Iteration:  84%|████████▍ | 225/268 [00:58<00:08,  4.96it/s][A
Iteration:  84%|████████▍ | 226/268 [00:58<00:08,  4.95it/s][A
Iteration:  85%|████████▍ | 227/268 [00:58<00:07,  5.16it/s][A[INFO|trainer.py:570] 2024-04-30 10:18:33,144 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:18:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:18:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:18:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:18:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:18:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:18:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4007177827039757, 'eval_loss': 1.1644895, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2618, 2622, 2648, 2632, 2629, 2633, 2585, 2556, 2478, 2729, 2659, 1893], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 11, 12], 'pruned_params': 21321636, 'remaining_params': 63695964, 'pruned_model_sparsity': 0.2507908480126468, 'expected_sparsity': 0.24624, 'target_sparsity': 0.2126865671641791, 'step': 1300}


Iteration:  85%|████████▌ | 228/268 [01:02<00:48,  1.22s/it][A04/30/2024 10:18:36 - INFO - trainer.trainer_mod_2 - v4 Global step: 1300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  85%|████████▌ | 229/268 [01:02<00:35,  1.09it/s][A
Iteration:  86%|████████▌ | 230/268 [01:02<00:26,  1.43it/s][A
Iteration:  86%|████████▌ | 231/268 [01:02<00:20,  1.83it/s][A
Iteration:  87%|████████▋ | 232/268 [01:03<00:15,  2.26it/s][A
Iteration:  87%|████████▋ | 233/268 [01:03<00:12,  2.73it/s][A
Iteration:  87%|████████▋ | 234/268 [01:03<00:10,  3.18it/s][A
Iteration:  88%|████████▊ | 235/268 [01:03<00:09,  3.56it/s][A
Iteration:  88%|████████▊ | 236/268 [01:03<00:08,  3.93it/s][A
Iteration:  88%|████████▊ | 237/268 [01:04<00:07,  4.25it/s][A
Iteration:  89%|████████▉ | 238/268 [01:04<00:06,  4.44it/s][A
Iteration:  89%|████████▉ | 239/268 [01:04<00:06,  4.70it/s][A
Iteration:  90%|████████▉ | 240/268 [01:04<00:05,  4.75it/s][A
Iteration:  90%|████████▉ | 241/268 [01:04<00:05,  4.88it/s][A
Iteration:  90%|█████████ | 242/268 [01:05<00:05,  4.98it/s][A
Iteration:  91%|█████████ | 243/268 [01:05<00:05,  4.90it/s][A
Iteration:  91%|█████████ | 244/268 [01:05<00:04,  4.96it/s][A
Iteration:  91%|█████████▏| 245/268 [01:05<00:04,  4.83it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:04,  4.86it/s][A
Iteration:  92%|█████████▏| 247/268 [01:06<00:04,  4.95it/s][A
Iteration:  93%|█████████▎| 248/268 [01:06<00:03,  5.03it/s][A
Iteration:  93%|█████████▎| 249/268 [01:06<00:03,  5.06it/s][A
Iteration:  93%|█████████▎| 250/268 [01:06<00:03,  5.11it/s][A
Iteration:  94%|█████████▎| 251/268 [01:06<00:03,  5.16it/s][A
Iteration:  94%|█████████▍| 252/268 [01:07<00:03,  5.06it/s][A
Iteration:  94%|█████████▍| 253/268 [01:07<00:03,  5.00it/s][A
Iteration:  95%|█████████▍| 254/268 [01:07<00:02,  5.09it/s][A
Iteration:  95%|█████████▌| 255/268 [01:07<00:02,  5.10it/s][A
Iteration:  96%|█████████▌| 256/268 [01:07<00:02,  5.01it/s][A
Iteration:  96%|█████████▌| 257/268 [01:08<00:02,  4.88it/s][A
Iteration:  96%|█████████▋| 258/268 [01:08<00:02,  4.98it/s][A
Iteration:  97%|█████████▋| 259/268 [01:08<00:01,  4.96it/s][A
Iteration:  97%|█████████▋| 260/268 [01:08<00:01,  5.06it/s][A
Iteration:  97%|█████████▋| 261/268 [01:08<00:01,  5.25it/s][A
Iteration:  98%|█████████▊| 262/268 [01:09<00:01,  4.98it/s][A
Iteration:  98%|█████████▊| 263/268 [01:09<00:00,  5.06it/s][A
Iteration:  99%|█████████▊| 264/268 [01:09<00:00,  5.02it/s][A
Iteration:  99%|█████████▉| 265/268 [01:09<00:00,  5.16it/s][A
Iteration:  99%|█████████▉| 266/268 [01:09<00:00,  5.16it/s][A
Iteration: 100%|█████████▉| 267/268 [01:10<00:00,  5.17it/s][A
Iteration: 100%|██████████| 268/268 [01:10<00:00,  5.58it/s][A04/30/2024 10:18:44 - INFO - trainer.trainer_mod_2 - Epoch 4 finished. Took 70.19 seconds.
Iteration: 100%|██████████| 268/268 [01:10<00:00,  3.82it/s]
Epoch:   5%|▌         | 5/100 [05:50<1:51:51, 70.65s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:54,  4.90it/s][A
Iteration:   1%|          | 2/268 [00:00<00:52,  5.10it/s][A
Iteration:   1%|          | 3/268 [00:00<00:50,  5.29it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:49,  5.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.22it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:49,  5.25it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:48,  5.33it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:50,  5.19it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:50,  5.08it/s][A[INFO|trainer.py:570] 2024-04-30 10:18:46,333 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:18:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:18:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:18:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:18:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.43it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.57it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.62it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.67it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.67it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.78it/s]04/30/2024 10:18:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:18:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3974597631363304, 'eval_loss': 1.150068, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2579, 2589, 2624, 2608, 2606, 2611, 2554, 2508, 2349, 2721, 2644, 1826], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 12, 10, 10, 12], 'pruned_params': 22285264, 'remaining_params': 62732336, 'pruned_model_sparsity': 0.26212530111412224, 'expected_sparsity': 0.25838, 'target_sparsity': 0.22154850746268656, 'step': 1350}


Iteration:   4%|▎         | 10/268 [00:05<05:23,  1.26s/it][A
Iteration:   4%|▍         | 11/268 [00:05<03:58,  1.08it/s][A
Iteration:   4%|▍         | 12/268 [00:05<03:01,  1.41it/s][A
Iteration:   5%|▍         | 13/268 [00:05<02:20,  1.81it/s][A
Iteration:   5%|▌         | 14/268 [00:06<01:53,  2.23it/s][A
Iteration:   6%|▌         | 15/268 [00:06<01:34,  2.68it/s][A
Iteration:   6%|▌         | 16/268 [00:06<01:18,  3.20it/s][A
Iteration:   6%|▋         | 17/268 [00:06<01:09,  3.60it/s][A
Iteration:   7%|▋         | 18/268 [00:06<01:02,  4.02it/s][A
Iteration:   7%|▋         | 19/268 [00:07<00:58,  4.23it/s][A
Iteration:   7%|▋         | 20/268 [00:07<00:55,  4.46it/s][A
Iteration:   8%|▊         | 21/268 [00:07<00:51,  4.78it/s][A
Iteration:   8%|▊         | 22/268 [00:07<00:51,  4.81it/s][A
Iteration:   9%|▊         | 23/268 [00:07<00:51,  4.80it/s][A
Iteration:   9%|▉         | 24/268 [00:08<00:51,  4.76it/s][A
Iteration:   9%|▉         | 25/268 [00:08<00:50,  4.86it/s][A
Iteration:  10%|▉         | 26/268 [00:08<00:50,  4.80it/s][A
Iteration:  10%|█         | 27/268 [00:08<00:49,  4.89it/s][A
Iteration:  10%|█         | 28/268 [00:08<00:48,  4.94it/s][A
Iteration:  11%|█         | 29/268 [00:09<00:47,  4.99it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:47,  5.03it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:46,  5.10it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:45,  5.13it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:46,  5.08it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<00:46,  5.03it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:46,  5.01it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:45,  5.07it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:45,  5.12it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:45,  5.00it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<00:45,  5.07it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:44,  5.13it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:43,  5.18it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:45,  5.02it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:44,  5.10it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:42,  5.22it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:42,  5.30it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:42,  5.24it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:42,  5.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:41,  5.29it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:40,  5.36it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.09it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:44,  4.89it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:43,  5.00it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:42,  5.07it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:42,  5.09it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:41,  5.09it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:41,  5.10it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:41,  5.10it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:40,  5.20it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:40,  5.20it/s][A[INFO|trainer.py:570] 2024-04-30 10:18:59,553 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:18:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:18:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:18:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:18:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:19:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:19:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.44436498029196, 'eval_loss': 1.0954155, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2541, 2555, 2602, 2586, 2582, 2588, 2524, 2460, 2225, 2714, 2629, 1782], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 10, 10, 11], 'pruned_params': 23236636, 'remaining_params': 61780964, 'pruned_model_sparsity': 0.2733155958295694, 'expected_sparsity': 0.27013, 'target_sparsity': 0.23041044776119401, 'step': 1400}


Iteration:  22%|██▏       | 60/268 [00:18<04:14,  1.22s/it][A04/30/2024 10:19:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 1400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  23%|██▎       | 61/268 [00:18<03:08,  1.10it/s][A
Iteration:  23%|██▎       | 62/268 [00:18<02:24,  1.43it/s][A
Iteration:  24%|██▎       | 63/268 [00:19<01:52,  1.82it/s][A
Iteration:  24%|██▍       | 64/268 [00:19<01:30,  2.26it/s][A
Iteration:  24%|██▍       | 65/268 [00:19<01:14,  2.71it/s][A
Iteration:  25%|██▍       | 66/268 [00:19<01:03,  3.17it/s][A
Iteration:  25%|██▌       | 67/268 [00:19<00:56,  3.57it/s][A
Iteration:  25%|██▌       | 68/268 [00:20<00:50,  3.94it/s][A
Iteration:  26%|██▌       | 69/268 [00:20<00:46,  4.27it/s][A
Iteration:  26%|██▌       | 70/268 [00:20<00:44,  4.49it/s][A
Iteration:  26%|██▋       | 71/268 [00:20<00:42,  4.69it/s][A
Iteration:  27%|██▋       | 72/268 [00:20<00:40,  4.80it/s][A
Iteration:  27%|██▋       | 73/268 [00:21<00:40,  4.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:21<00:40,  4.84it/s][A
Iteration:  28%|██▊       | 75/268 [00:21<00:37,  5.09it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<00:38,  4.96it/s][A
Iteration:  29%|██▊       | 77/268 [00:21<00:38,  4.96it/s][A
Iteration:  29%|██▉       | 78/268 [00:22<00:38,  4.98it/s][A
Iteration:  29%|██▉       | 79/268 [00:22<00:37,  5.04it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<00:37,  5.08it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:36,  5.09it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:36,  5.12it/s][A
Iteration:  31%|███       | 83/268 [00:23<00:36,  5.13it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:35,  5.11it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:35,  5.16it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:35,  5.17it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:35,  5.15it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:35,  5.07it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:35,  5.01it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:35,  5.06it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:34,  5.07it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:34,  5.08it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:34,  5.10it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:33,  5.15it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:33,  5.13it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:33,  5.14it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:32,  5.24it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:32,  5.20it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:32,  5.16it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:32,  5.12it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:32,  5.16it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:31,  5.26it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:31,  5.23it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:31,  5.25it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:31,  5.21it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:31,  5.22it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:30,  5.24it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:31,  5.01it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:30,  5.20it/s][A[INFO|trainer.py:570] 2024-04-30 10:19:12,715 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:19:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:19:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:19:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:19:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.65it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.67it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.78it/s]04/30/2024 10:19:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:19:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4464028893215794, 'eval_loss': 1.0525063, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2507, 2524, 2579, 2565, 2562, 2569, 2497, 2412, 2112, 2707, 2616, 1750], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 9, 9, 11], 'pruned_params': 24143580, 'remaining_params': 60874020, 'pruned_model_sparsity': 0.28398331639566393, 'expected_sparsity': 0.27972, 'target_sparsity': 0.23927238805970147, 'step': 1450}


Iteration:  41%|████      | 110/268 [00:31<03:13,  1.22s/it][A
Iteration:  41%|████▏     | 111/268 [00:31<02:23,  1.09it/s][A
Iteration:  42%|████▏     | 112/268 [00:32<01:49,  1.42it/s][A
Iteration:  42%|████▏     | 113/268 [00:32<01:25,  1.82it/s][A
Iteration:  43%|████▎     | 114/268 [00:32<01:08,  2.25it/s][A
Iteration:  43%|████▎     | 115/268 [00:32<00:56,  2.70it/s][A
Iteration:  43%|████▎     | 116/268 [00:32<00:49,  3.07it/s][A
Iteration:  44%|████▎     | 117/268 [00:33<00:43,  3.50it/s][A
Iteration:  44%|████▍     | 118/268 [00:33<00:38,  3.89it/s][A
Iteration:  44%|████▍     | 119/268 [00:33<00:36,  4.10it/s][A
Iteration:  45%|████▍     | 120/268 [00:33<00:34,  4.25it/s][A
Iteration:  45%|████▌     | 121/268 [00:33<00:32,  4.48it/s][A
Iteration:  46%|████▌     | 122/268 [00:34<00:31,  4.68it/s][A
Iteration:  46%|████▌     | 123/268 [00:34<00:30,  4.80it/s][A
Iteration:  46%|████▋     | 124/268 [00:34<00:29,  4.82it/s][A
Iteration:  47%|████▋     | 125/268 [00:34<00:29,  4.85it/s][A
Iteration:  47%|████▋     | 126/268 [00:34<00:29,  4.76it/s][A
Iteration:  47%|████▋     | 127/268 [00:35<00:28,  4.91it/s][A
Iteration:  48%|████▊     | 128/268 [00:35<00:28,  4.96it/s][A
Iteration:  48%|████▊     | 129/268 [00:35<00:27,  5.02it/s][A
Iteration:  49%|████▊     | 130/268 [00:35<00:27,  4.98it/s][A
Iteration:  49%|████▉     | 131/268 [00:35<00:27,  4.94it/s][A
Iteration:  49%|████▉     | 132/268 [00:36<00:27,  4.93it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<00:26,  5.08it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:26,  4.98it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:26,  5.01it/s][A
Iteration:  51%|█████     | 136/268 [00:36<00:25,  5.20it/s][A
Iteration:  51%|█████     | 137/268 [00:37<00:25,  5.23it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:25,  5.10it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:25,  5.12it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:24,  5.22it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:25,  5.00it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:25,  5.03it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:24,  5.05it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:24,  5.04it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:24,  5.02it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:24,  5.07it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:24,  4.96it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:24,  4.92it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:23,  4.99it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:24,  4.89it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:23,  4.99it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:22,  5.05it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.00it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:22,  5.04it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:22,  5.00it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:22,  5.04it/s][A
Iteration:  59%|█████▊    | 157/268 [00:41<00:21,  5.09it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:21,  5.03it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:21,  5.09it/s][A[INFO|trainer.py:570] 2024-04-30 10:19:26,130 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:19:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:19:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:19:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:19:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:19:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:19:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4038031422237696, 'eval_loss': 1.2839246, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2475, 2494, 2559, 2547, 2543, 2550, 2473, 2373, 2013, 2701, 2603, 1726], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 12, 11, 9, 9, 11], 'pruned_params': 24603180, 'remaining_params': 60414420, 'pruned_model_sparsity': 0.28938925587172537, 'expected_sparsity': 0.28747, 'target_sparsity': 0.24813432835820892, 'step': 1500}


Iteration:  60%|█████▉    | 160/268 [00:45<02:12,  1.23s/it][A04/30/2024 10:19:29 - INFO - trainer.trainer_mod_2 - v4 Global step: 1500, Alignment: tensor([ 0,  6,  8, 11], device='cuda:0')

Iteration:  60%|██████    | 161/268 [00:45<01:39,  1.08it/s][A
Iteration:  60%|██████    | 162/268 [00:45<01:14,  1.42it/s][A
Iteration:  61%|██████    | 163/268 [00:45<00:58,  1.78it/s][A
Iteration:  61%|██████    | 164/268 [00:45<00:47,  2.20it/s][A
Iteration:  62%|██████▏   | 165/268 [00:46<00:38,  2.67it/s][A
Iteration:  62%|██████▏   | 166/268 [00:46<00:32,  3.14it/s][A
Iteration:  62%|██████▏   | 167/268 [00:46<00:28,  3.55it/s][A
Iteration:  63%|██████▎   | 168/268 [00:46<00:25,  3.97it/s][A
Iteration:  63%|██████▎   | 169/268 [00:46<00:23,  4.26it/s][A
Iteration:  63%|██████▎   | 170/268 [00:47<00:21,  4.48it/s][A
Iteration:  64%|██████▍   | 171/268 [00:47<00:20,  4.68it/s][A
Iteration:  64%|██████▍   | 172/268 [00:47<00:19,  4.82it/s][A
Iteration:  65%|██████▍   | 173/268 [00:47<00:19,  4.96it/s][A
Iteration:  65%|██████▍   | 174/268 [00:47<00:18,  5.10it/s][A
Iteration:  65%|██████▌   | 175/268 [00:48<00:18,  5.12it/s][A
Iteration:  66%|██████▌   | 176/268 [00:48<00:18,  5.07it/s][A
Iteration:  66%|██████▌   | 177/268 [00:48<00:18,  5.02it/s][A
Iteration:  66%|██████▋   | 178/268 [00:48<00:17,  5.07it/s][A
Iteration:  67%|██████▋   | 179/268 [00:48<00:17,  5.20it/s][A
Iteration:  67%|██████▋   | 180/268 [00:49<00:17,  5.04it/s][A
Iteration:  68%|██████▊   | 181/268 [00:49<00:17,  5.08it/s][A
Iteration:  68%|██████▊   | 182/268 [00:49<00:17,  5.03it/s][A
Iteration:  68%|██████▊   | 183/268 [00:49<00:16,  5.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:49<00:16,  5.07it/s][A
Iteration:  69%|██████▉   | 185/268 [00:50<00:16,  5.07it/s][A
Iteration:  69%|██████▉   | 186/268 [00:50<00:16,  5.08it/s][A
Iteration:  70%|██████▉   | 187/268 [00:50<00:16,  4.88it/s][A
Iteration:  70%|███████   | 188/268 [00:50<00:16,  4.90it/s][A
Iteration:  71%|███████   | 189/268 [00:50<00:15,  4.96it/s][A
Iteration:  71%|███████   | 190/268 [00:51<00:15,  5.04it/s][A
Iteration:  71%|███████▏  | 191/268 [00:51<00:15,  5.03it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:15,  5.05it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:14,  5.12it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:14,  5.10it/s][A
Iteration:  73%|███████▎  | 195/268 [00:52<00:13,  5.22it/s][A
Iteration:  73%|███████▎  | 196/268 [00:52<00:14,  5.12it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:13,  5.13it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:13,  5.05it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:13,  5.06it/s][A
Iteration:  75%|███████▍  | 200/268 [00:53<00:13,  4.99it/s][A
Iteration:  75%|███████▌  | 201/268 [00:53<00:13,  5.07it/s][A
Iteration:  75%|███████▌  | 202/268 [00:53<00:12,  5.13it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:13,  4.96it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:12,  5.11it/s][A
Iteration:  76%|███████▋  | 205/268 [00:54<00:12,  5.11it/s][A
Iteration:  77%|███████▋  | 206/268 [00:54<00:12,  5.03it/s][A
Iteration:  77%|███████▋  | 207/268 [00:54<00:11,  5.17it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:11,  5.10it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  5.04it/s][A[INFO|trainer.py:570] 2024-04-30 10:19:39,416 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:19:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:19:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:19:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:19:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:19:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:19:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.42681570512624534, 'eval_loss': 1.0760182, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2445, 2468, 2542, 2529, 2525, 2533, 2448, 2331, 1932, 2695, 2592, 1705], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 9, 9, 10], 'pruned_params': 25415140, 'remaining_params': 59602460, 'pruned_model_sparsity': 0.2989397489461006, 'expected_sparsity': 0.2951, 'target_sparsity': 0.2569962686567164, 'step': 1550}


Iteration:  78%|███████▊  | 210/268 [00:58<01:11,  1.23s/it][A
Iteration:  79%|███████▊  | 211/268 [00:58<00:52,  1.09it/s][A
Iteration:  79%|███████▉  | 212/268 [00:58<00:39,  1.43it/s][A
Iteration:  79%|███████▉  | 213/268 [00:59<00:31,  1.77it/s][A
Iteration:  80%|███████▉  | 214/268 [00:59<00:24,  2.21it/s][A
Iteration:  80%|████████  | 215/268 [00:59<00:19,  2.67it/s][A
Iteration:  81%|████████  | 216/268 [00:59<00:16,  3.12it/s][A
Iteration:  81%|████████  | 217/268 [00:59<00:14,  3.49it/s][A
Iteration:  81%|████████▏ | 218/268 [01:00<00:12,  3.88it/s][A
Iteration:  82%|████████▏ | 219/268 [01:00<00:11,  4.18it/s][A
Iteration:  82%|████████▏ | 220/268 [01:00<00:10,  4.42it/s][A
Iteration:  82%|████████▏ | 221/268 [01:00<00:10,  4.54it/s][A
Iteration:  83%|████████▎ | 222/268 [01:00<00:09,  4.68it/s][A
Iteration:  83%|████████▎ | 223/268 [01:01<00:09,  4.68it/s][A
Iteration:  84%|████████▎ | 224/268 [01:01<00:09,  4.84it/s][A
Iteration:  84%|████████▍ | 225/268 [01:01<00:08,  4.94it/s][A
Iteration:  84%|████████▍ | 226/268 [01:01<00:08,  5.02it/s][A
Iteration:  85%|████████▍ | 227/268 [01:01<00:08,  5.07it/s][A
Iteration:  85%|████████▌ | 228/268 [01:02<00:07,  5.00it/s][A
Iteration:  85%|████████▌ | 229/268 [01:02<00:07,  5.07it/s][A
Iteration:  86%|████████▌ | 230/268 [01:02<00:07,  4.81it/s][A
Iteration:  86%|████████▌ | 231/268 [01:02<00:07,  4.90it/s][A
Iteration:  87%|████████▋ | 232/268 [01:02<00:07,  4.90it/s][A
Iteration:  87%|████████▋ | 233/268 [01:03<00:07,  4.97it/s][A
Iteration:  87%|████████▋ | 234/268 [01:03<00:06,  4.94it/s][A
Iteration:  88%|████████▊ | 235/268 [01:03<00:06,  5.01it/s][A
Iteration:  88%|████████▊ | 236/268 [01:03<00:06,  5.17it/s][A
Iteration:  88%|████████▊ | 237/268 [01:03<00:06,  5.10it/s][A
Iteration:  89%|████████▉ | 238/268 [01:04<00:06,  4.97it/s][A
Iteration:  89%|████████▉ | 239/268 [01:04<00:05,  5.01it/s][A
Iteration:  90%|████████▉ | 240/268 [01:04<00:05,  5.03it/s][A
Iteration:  90%|████████▉ | 241/268 [01:04<00:05,  5.05it/s][A
Iteration:  90%|█████████ | 242/268 [01:04<00:05,  5.09it/s][A
Iteration:  91%|█████████ | 243/268 [01:05<00:04,  5.03it/s][A
Iteration:  91%|█████████ | 244/268 [01:05<00:04,  5.09it/s][A
Iteration:  91%|█████████▏| 245/268 [01:05<00:04,  4.93it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:04,  4.98it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:04,  5.03it/s][A
Iteration:  93%|█████████▎| 248/268 [01:06<00:03,  5.16it/s][A
Iteration:  93%|█████████▎| 249/268 [01:06<00:03,  5.20it/s][A
Iteration:  93%|█████████▎| 250/268 [01:06<00:03,  5.18it/s][A
Iteration:  94%|█████████▎| 251/268 [01:06<00:03,  5.10it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:03,  5.06it/s][A
Iteration:  94%|█████████▍| 253/268 [01:07<00:02,  5.00it/s][A
Iteration:  95%|█████████▍| 254/268 [01:07<00:02,  5.04it/s][A
Iteration:  95%|█████████▌| 255/268 [01:07<00:02,  4.95it/s][A
Iteration:  96%|█████████▌| 256/268 [01:07<00:02,  4.99it/s][A
Iteration:  96%|█████████▌| 257/268 [01:07<00:02,  5.02it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:01,  5.09it/s][A
Iteration:  97%|█████████▋| 259/268 [01:08<00:01,  5.13it/s][A[INFO|trainer.py:570] 2024-04-30 10:19:52,788 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:19:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:19:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:19:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:19:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:19:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:19:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.45101661602267146, 'eval_loss': 1.1843609, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2422, 2445, 2527, 2514, 2511, 2520, 2430, 2305, 1867, 2690, 2581, 1688], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 8, 10], 'pruned_params': 26132116, 'remaining_params': 58885484, 'pruned_model_sparsity': 0.30737301452875637, 'expected_sparsity': 0.30127, 'target_sparsity': 0.26585820895522383, 'step': 1600}


Iteration:  97%|█████████▋| 260/268 [01:11<00:09,  1.22s/it][A04/30/2024 10:19:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 1600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  97%|█████████▋| 261/268 [01:12<00:06,  1.09it/s][A
Iteration:  98%|█████████▊| 262/268 [01:12<00:04,  1.43it/s][A
Iteration:  98%|█████████▊| 263/268 [01:12<00:02,  1.79it/s][A
Iteration:  99%|█████████▊| 264/268 [01:12<00:01,  2.21it/s][A
Iteration:  99%|█████████▉| 265/268 [01:12<00:01,  2.65it/s][A
Iteration:  99%|█████████▉| 266/268 [01:13<00:00,  3.07it/s][A
Iteration: 100%|█████████▉| 267/268 [01:13<00:00,  3.50it/s][A
Iteration: 100%|██████████| 268/268 [01:13<00:00,  4.09it/s][A04/30/2024 10:19:57 - INFO - trainer.trainer_mod_2 - Epoch 5 finished. Took 73.39 seconds.
Iteration: 100%|██████████| 268/268 [01:13<00:00,  3.65it/s]
Epoch:   6%|▌         | 6/100 [07:04<1:52:08, 71.58s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:54,  4.88it/s][A
Iteration:   1%|          | 2/268 [00:00<00:49,  5.35it/s][A
Iteration:   1%|          | 3/268 [00:00<00:50,  5.26it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:51,  5.11it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.17it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:51,  5.07it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:51,  5.09it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:51,  5.07it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:51,  5.01it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:49,  5.21it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:49,  5.23it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:49,  5.21it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:49,  5.19it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:50,  4.99it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:50,  5.03it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:49,  5.10it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:48,  5.15it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:49,  5.06it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:48,  5.12it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:48,  5.12it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:48,  5.09it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:49,  5.00it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:48,  5.00it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:48,  5.04it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:47,  5.10it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:46,  5.16it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:46,  5.17it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:46,  5.17it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:46,  5.16it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:47,  5.06it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:46,  5.10it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:48,  4.91it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:47,  4.91it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:46,  5.00it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:45,  5.08it/s][A
Iteration:  13%|█▎        | 36/268 [00:07<00:45,  5.09it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:45,  5.04it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:45,  5.00it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:44,  5.16it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:44,  5.18it/s][A
Iteration:  15%|█▌        | 41/268 [00:08<00:43,  5.20it/s][A[INFO|trainer.py:570] 2024-04-30 10:20:06,026 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:20:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:20:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:20:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:20:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.63it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.63it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.65it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.67it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.67it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.78it/s]04/30/2024 10:20:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:20:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4038031422237696, 'eval_loss': 1.3110124, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2402, 2427, 2514, 2501, 2498, 2506, 2407, 2271, 1811, 2685, 2572, 1673], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 8, 10], 'pruned_params': 26444644, 'remaining_params': 58572956, 'pruned_model_sparsity': 0.3110490533724782, 'expected_sparsity': 0.30691, 'target_sparsity': 0.2747201492537313, 'step': 1650}


Iteration:  16%|█▌        | 42/268 [00:11<04:36,  1.22s/it][A
Iteration:  16%|█▌        | 43/268 [00:11<03:25,  1.09it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<02:36,  1.43it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<02:01,  1.84it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<01:38,  2.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<01:20,  2.75it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<01:08,  3.21it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<01:00,  3.64it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:55,  3.91it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:51,  4.23it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:49,  4.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:48,  4.47it/s][A
Iteration:  20%|██        | 54/268 [00:14<00:46,  4.57it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:44,  4.75it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:44,  4.77it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:43,  4.89it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:42,  4.98it/s][A
Iteration:  22%|██▏       | 59/268 [00:15<00:41,  5.04it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:41,  5.00it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:40,  5.06it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:40,  5.07it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:40,  5.08it/s][A
Iteration:  24%|██▍       | 64/268 [00:16<00:41,  4.96it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:40,  5.03it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:40,  5.00it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:39,  5.04it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:39,  5.09it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:37,  5.28it/s][A
Iteration:  26%|██▌       | 70/268 [00:17<00:38,  5.15it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:38,  5.16it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:38,  5.08it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:38,  5.06it/s][A
Iteration:  28%|██▊       | 74/268 [00:17<00:39,  4.88it/s][A
Iteration:  28%|██▊       | 75/268 [00:18<00:38,  5.06it/s][A
Iteration:  28%|██▊       | 76/268 [00:18<00:37,  5.13it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:38,  5.02it/s][A
Iteration:  29%|██▉       | 78/268 [00:18<00:38,  4.96it/s][A
Iteration:  29%|██▉       | 79/268 [00:18<00:37,  5.11it/s][A
Iteration:  30%|██▉       | 80/268 [00:19<00:37,  4.99it/s][A
Iteration:  30%|███       | 81/268 [00:19<00:37,  5.03it/s][A
Iteration:  31%|███       | 82/268 [00:19<00:37,  5.02it/s][A
Iteration:  31%|███       | 83/268 [00:19<00:35,  5.16it/s][A
Iteration:  31%|███▏      | 84/268 [00:19<00:35,  5.14it/s][A
Iteration:  32%|███▏      | 85/268 [00:20<00:37,  4.85it/s][A
Iteration:  32%|███▏      | 86/268 [00:20<00:35,  5.09it/s][A
Iteration:  32%|███▏      | 87/268 [00:20<00:35,  5.10it/s][A
Iteration:  33%|███▎      | 88/268 [00:20<00:35,  5.09it/s][A
Iteration:  33%|███▎      | 89/268 [00:20<00:35,  5.09it/s][A
Iteration:  34%|███▎      | 90/268 [00:21<00:34,  5.09it/s][A
Iteration:  34%|███▍      | 91/268 [00:21<00:34,  5.12it/s][A[INFO|trainer.py:570] 2024-04-30 10:20:19,315 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:20:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:20:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:20:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:20:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:20:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:20:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4038031422237696, 'eval_loss': 1.2423434, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2386, 2412, 2505, 2493, 2489, 2496, 2392, 2251, 1769, 2681, 2565, 1661], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 7, 10], 'pruned_params': 26861348, 'remaining_params': 58156252, 'pruned_model_sparsity': 0.31595043849744053, 'expected_sparsity': 0.31078, 'target_sparsity': 0.2835820895522388, 'step': 1700}


Iteration:  34%|███▍      | 92/268 [00:24<03:35,  1.22s/it][A04/30/2024 10:20:22 - INFO - trainer.trainer_mod_2 - v4 Global step: 1700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  35%|███▍      | 93/268 [00:25<02:40,  1.09it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<02:02,  1.42it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<01:35,  1.82it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<01:15,  2.26it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<01:03,  2.70it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:54,  3.15it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:47,  3.58it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:42,  3.96it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:38,  4.32it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:36,  4.52it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:35,  4.63it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:34,  4.72it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:33,  4.83it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:32,  5.00it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:31,  5.06it/s][A
Iteration:  40%|████      | 108/268 [00:28<00:31,  5.13it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:30,  5.16it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:30,  5.13it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:30,  5.17it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:30,  5.14it/s][A
Iteration:  42%|████▏     | 113/268 [00:29<00:30,  5.08it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:30,  5.02it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:30,  5.04it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:29,  5.23it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:30,  4.97it/s][A
Iteration:  44%|████▍     | 118/268 [00:30<00:29,  5.04it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:28,  5.18it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:28,  5.21it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:28,  5.22it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:28,  5.19it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:28,  5.10it/s][A
Iteration:  46%|████▋     | 124/268 [00:31<00:27,  5.21it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:27,  5.11it/s][A
Iteration:  47%|████▋     | 126/268 [00:31<00:27,  5.11it/s][A
Iteration:  47%|████▋     | 127/268 [00:31<00:28,  4.95it/s][A
Iteration:  48%|████▊     | 128/268 [00:31<00:28,  4.96it/s][A
Iteration:  48%|████▊     | 129/268 [00:32<00:26,  5.16it/s][A
Iteration:  49%|████▊     | 130/268 [00:32<00:26,  5.17it/s][A
Iteration:  49%|████▉     | 131/268 [00:32<00:26,  5.13it/s][A
Iteration:  49%|████▉     | 132/268 [00:32<00:25,  5.31it/s][A
Iteration:  50%|████▉     | 133/268 [00:32<00:25,  5.24it/s][A
Iteration:  50%|█████     | 134/268 [00:33<00:25,  5.23it/s][A
Iteration:  50%|█████     | 135/268 [00:33<00:26,  5.05it/s][A
Iteration:  51%|█████     | 136/268 [00:33<00:25,  5.12it/s][A
Iteration:  51%|█████     | 137/268 [00:33<00:25,  5.05it/s][A
Iteration:  51%|█████▏    | 138/268 [00:33<00:25,  5.10it/s][A
Iteration:  52%|█████▏    | 139/268 [00:34<00:25,  5.06it/s][A
Iteration:  52%|█████▏    | 140/268 [00:34<00:25,  5.11it/s][A
Iteration:  53%|█████▎    | 141/268 [00:34<00:24,  5.14it/s][A[INFO|trainer.py:570] 2024-04-30 10:20:32,489 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:20:32 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:20:32 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:20:32 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:20:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.67it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:20:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:20:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.44062137503302884, 'eval_loss': 1.0720524, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2374, 2400, 2497, 2487, 2482, 2488, 2383, 2236, 1737, 2678, 2558, 1650], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 8, 7, 10], 'pruned_params': 27028336, 'remaining_params': 57989264, 'pruned_model_sparsity': 0.3179145965070762, 'expected_sparsity': 0.31421, 'target_sparsity': 0.29244402985074625, 'step': 1750}


Iteration:  53%|█████▎    | 142/268 [00:38<02:34,  1.22s/it][A
Iteration:  53%|█████▎    | 143/268 [00:38<01:54,  1.09it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<01:26,  1.43it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<01:07,  1.82it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:53,  2.26it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:45,  2.65it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:38,  3.11it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:33,  3.58it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:29,  3.95it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:28,  4.09it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:26,  4.42it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:25,  4.55it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:24,  4.75it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:23,  4.72it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:23,  4.84it/s][A
Iteration:  59%|█████▊    | 157/268 [00:41<00:22,  4.93it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:22,  4.90it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:21,  4.96it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:21,  5.11it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:20,  5.11it/s][A
Iteration:  60%|██████    | 162/268 [00:42<00:20,  5.09it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:20,  5.21it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:20,  5.04it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:20,  5.09it/s][A
Iteration:  62%|██████▏   | 166/268 [00:42<00:19,  5.13it/s][A
Iteration:  62%|██████▏   | 167/268 [00:43<00:19,  5.23it/s][A
Iteration:  63%|██████▎   | 168/268 [00:43<00:19,  5.24it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:19,  5.13it/s][A
Iteration:  63%|██████▎   | 170/268 [00:43<00:19,  5.16it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:18,  5.25it/s][A
Iteration:  64%|██████▍   | 172/268 [00:44<00:18,  5.14it/s][A
Iteration:  65%|██████▍   | 173/268 [00:44<00:19,  4.93it/s][A
Iteration:  65%|██████▍   | 174/268 [00:44<00:18,  4.95it/s][A
Iteration:  65%|██████▌   | 175/268 [00:44<00:18,  4.94it/s][A
Iteration:  66%|██████▌   | 176/268 [00:44<00:18,  4.99it/s][A
Iteration:  66%|██████▌   | 177/268 [00:45<00:19,  4.76it/s][A
Iteration:  66%|██████▋   | 178/268 [00:45<00:17,  5.01it/s][A
Iteration:  67%|██████▋   | 179/268 [00:45<00:17,  5.05it/s][A
Iteration:  67%|██████▋   | 180/268 [00:45<00:17,  4.92it/s][A
Iteration:  68%|██████▊   | 181/268 [00:45<00:16,  5.19it/s][A
Iteration:  68%|██████▊   | 182/268 [00:46<00:17,  5.04it/s][A
Iteration:  68%|██████▊   | 183/268 [00:46<00:16,  5.11it/s][A
Iteration:  69%|██████▊   | 184/268 [00:46<00:16,  5.14it/s][A
Iteration:  69%|██████▉   | 185/268 [00:46<00:16,  5.04it/s][A
Iteration:  69%|██████▉   | 186/268 [00:46<00:16,  5.10it/s][A
Iteration:  70%|██████▉   | 187/268 [00:47<00:16,  5.04it/s][A
Iteration:  70%|███████   | 188/268 [00:47<00:15,  5.07it/s][A
Iteration:  71%|███████   | 189/268 [00:47<00:15,  4.95it/s][A
Iteration:  71%|███████   | 190/268 [00:47<00:15,  5.04it/s][A
Iteration:  71%|███████▏  | 191/268 [00:47<00:15,  4.99it/s][A[INFO|trainer.py:570] 2024-04-30 10:20:45,811 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:20:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:20:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:20:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:20:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.60it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.63it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.64it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.67it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.67it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.78it/s]04/30/2024 10:20:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:20:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4107465567016423, 'eval_loss': 1.1751595, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2362, 2390, 2491, 2482, 2475, 2482, 2375, 2226, 1709, 2675, 2551, 1640], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 7, 10], 'pruned_params': 27365376, 'remaining_params': 57652224, 'pruned_model_sparsity': 0.32187895212285456, 'expected_sparsity': 0.31695, 'target_sparsity': 0.30130597014925375, 'step': 1800}


Iteration:  72%|███████▏  | 192/268 [00:51<01:33,  1.23s/it][A04/30/2024 10:20:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 1800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  72%|███████▏  | 193/268 [00:51<01:08,  1.09it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:51,  1.43it/s][A
Iteration:  73%|███████▎  | 195/268 [00:52<00:40,  1.81it/s][A
Iteration:  73%|███████▎  | 196/268 [00:52<00:31,  2.25it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:26,  2.66it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:22,  3.05it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:19,  3.48it/s][A
Iteration:  75%|███████▍  | 200/268 [00:53<00:17,  3.81it/s][A
Iteration:  75%|███████▌  | 201/268 [00:53<00:16,  4.11it/s][A
Iteration:  75%|███████▌  | 202/268 [00:53<00:14,  4.45it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:14,  4.59it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:13,  4.82it/s][A
Iteration:  76%|███████▋  | 205/268 [00:54<00:12,  4.91it/s][A
Iteration:  77%|███████▋  | 206/268 [00:54<00:12,  5.00it/s][A
Iteration:  77%|███████▋  | 207/268 [00:54<00:11,  5.08it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:12,  4.91it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  5.13it/s][A
Iteration:  78%|███████▊  | 210/268 [00:55<00:11,  5.06it/s][A
Iteration:  79%|███████▊  | 211/268 [00:55<00:11,  5.07it/s][A
Iteration:  79%|███████▉  | 212/268 [00:55<00:10,  5.09it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:10,  5.20it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:10,  5.21it/s][A
Iteration:  80%|████████  | 215/268 [00:55<00:10,  5.30it/s][A
Iteration:  81%|████████  | 216/268 [00:56<00:09,  5.24it/s][A
Iteration:  81%|████████  | 217/268 [00:56<00:09,  5.20it/s][A
Iteration:  81%|████████▏ | 218/268 [00:56<00:09,  5.10it/s][A
Iteration:  82%|████████▏ | 219/268 [00:56<00:09,  5.10it/s][A
Iteration:  82%|████████▏ | 220/268 [00:56<00:09,  5.13it/s][A
Iteration:  82%|████████▏ | 221/268 [00:57<00:09,  5.16it/s][A
Iteration:  83%|████████▎ | 222/268 [00:57<00:08,  5.18it/s][A
Iteration:  83%|████████▎ | 223/268 [00:57<00:08,  5.03it/s][A
Iteration:  84%|████████▎ | 224/268 [00:57<00:08,  5.03it/s][A
Iteration:  84%|████████▍ | 225/268 [00:57<00:08,  5.02it/s][A
Iteration:  84%|████████▍ | 226/268 [00:58<00:08,  5.07it/s][A
Iteration:  85%|████████▍ | 227/268 [00:58<00:08,  5.08it/s][A
Iteration:  85%|████████▌ | 228/268 [00:58<00:07,  5.05it/s][A
Iteration:  85%|████████▌ | 229/268 [00:58<00:07,  5.19it/s][A
Iteration:  86%|████████▌ | 230/268 [00:58<00:07,  5.22it/s][A
Iteration:  86%|████████▌ | 231/268 [00:59<00:07,  5.21it/s][A
Iteration:  87%|████████▋ | 232/268 [00:59<00:06,  5.18it/s][A
Iteration:  87%|████████▋ | 233/268 [00:59<00:06,  5.21it/s][A
Iteration:  87%|████████▋ | 234/268 [00:59<00:06,  5.20it/s][A
Iteration:  88%|████████▊ | 235/268 [00:59<00:06,  5.23it/s][A
Iteration:  88%|████████▊ | 236/268 [01:00<00:06,  5.20it/s][A
Iteration:  88%|████████▊ | 237/268 [01:00<00:05,  5.28it/s][A
Iteration:  89%|████████▉ | 238/268 [01:00<00:05,  5.19it/s][A
Iteration:  89%|████████▉ | 239/268 [01:00<00:05,  5.20it/s][A
Iteration:  90%|████████▉ | 240/268 [01:00<00:05,  5.00it/s][A
Iteration:  90%|████████▉ | 241/268 [01:01<00:05,  5.13it/s][A[INFO|trainer.py:570] 2024-04-30 10:20:59,019 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:20:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:20:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:20:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:20:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:21:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:21:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.42085887043883125, 'eval_loss': 1.1636428, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2351, 2379, 2485, 2476, 2468, 2475, 2362, 2209, 1683, 2672, 2545, 1631], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 7, 10], 'pruned_params': 27524704, 'remaining_params': 57492896, 'pruned_model_sparsity': 0.3237530111412225, 'expected_sparsity': 0.31955, 'target_sparsity': 0.3101679104477612, 'step': 1850}


Iteration:  90%|█████████ | 242/268 [01:04<00:31,  1.23s/it][A
Iteration:  91%|█████████ | 243/268 [01:04<00:22,  1.09it/s][A
Iteration:  91%|█████████ | 244/268 [01:05<00:16,  1.43it/s][A
Iteration:  91%|█████████▏| 245/268 [01:05<00:12,  1.83it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:09,  2.26it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:07,  2.70it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:06,  3.11it/s][A
Iteration:  93%|█████████▎| 249/268 [01:06<00:05,  3.54it/s][A
Iteration:  93%|█████████▎| 250/268 [01:06<00:04,  3.91it/s][A
Iteration:  94%|█████████▎| 251/268 [01:06<00:04,  4.19it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:03,  4.43it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:03,  4.65it/s][A
Iteration:  95%|█████████▍| 254/268 [01:07<00:03,  4.61it/s][A
Iteration:  95%|█████████▌| 255/268 [01:07<00:02,  4.78it/s][A
Iteration:  96%|█████████▌| 256/268 [01:07<00:02,  4.91it/s][A
Iteration:  96%|█████████▌| 257/268 [01:07<00:02,  4.98it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:01,  5.01it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  5.22it/s][A
Iteration:  97%|█████████▋| 260/268 [01:08<00:01,  5.10it/s][A
Iteration:  97%|█████████▋| 261/268 [01:08<00:01,  4.63it/s][A
Iteration:  98%|█████████▊| 262/268 [01:08<00:01,  4.87it/s][A
Iteration:  98%|█████████▊| 263/268 [01:08<00:01,  4.92it/s][A
Iteration:  99%|█████████▊| 264/268 [01:09<00:00,  4.93it/s][A
Iteration:  99%|█████████▉| 265/268 [01:09<00:00,  4.91it/s][A
Iteration:  99%|█████████▉| 266/268 [01:09<00:00,  4.98it/s][A
Iteration: 100%|█████████▉| 267/268 [01:09<00:00,  4.90it/s][A
Iteration: 100%|██████████| 268/268 [01:09<00:00,  5.40it/s][A04/30/2024 10:21:07 - INFO - trainer.trainer_mod_2 - Epoch 6 finished. Took 69.78 seconds.
Iteration: 100%|██████████| 268/268 [01:09<00:00,  3.84it/s]
Epoch:   7%|▋         | 7/100 [08:13<1:50:02, 70.99s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:52,  5.09it/s][A
Iteration:   1%|          | 2/268 [00:00<00:53,  4.98it/s][A
Iteration:   1%|          | 3/268 [00:00<00:53,  4.94it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:55,  4.79it/s][A
Iteration:   2%|▏         | 5/268 [00:01<00:55,  4.76it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:53,  4.87it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:52,  4.94it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:52,  4.95it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:51,  5.04it/s][A
Iteration:   4%|▎         | 10/268 [00:02<00:50,  5.09it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:50,  5.10it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:50,  5.10it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:50,  5.02it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:51,  4.95it/s][A
Iteration:   6%|▌         | 15/268 [00:03<00:52,  4.82it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:51,  4.94it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:50,  4.98it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:50,  4.98it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:48,  5.18it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:47,  5.21it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:48,  5.11it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:48,  5.04it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:49,  5.00it/s][A[INFO|trainer.py:570] 2024-04-30 10:21:12,371 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:21:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:21:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:21:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:21:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.64it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.67it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.78it/s]04/30/2024 10:21:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:21:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4699209560136086, 'eval_loss': 1.0882256, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2341, 2370, 2478, 2471, 2462, 2470, 2356, 2199, 1659, 2669, 2539, 1622], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 6, 10], 'pruned_params': 27846424, 'remaining_params': 57171176, 'pruned_model_sparsity': 0.32753716877446554, 'expected_sparsity': 0.32151, 'target_sparsity': 0.31902985074626866, 'step': 1900}


Iteration:   9%|▉         | 24/268 [00:08<04:59,  1.23s/it][A04/30/2024 10:21:15 - INFO - trainer.trainer_mod_2 - v4 Global step: 1900, Alignment: tensor([ 0,  7,  8, 11], device='cuda:0')

Iteration:   9%|▉         | 25/268 [00:08<03:43,  1.09it/s][A
Iteration:  10%|▉         | 26/268 [00:08<02:49,  1.42it/s][A
Iteration:  10%|█         | 27/268 [00:08<02:12,  1.82it/s][A
Iteration:  10%|█         | 28/268 [00:09<01:47,  2.24it/s][A
Iteration:  11%|█         | 29/268 [00:09<01:27,  2.74it/s][A
Iteration:  11%|█         | 30/268 [00:09<01:16,  3.13it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<01:06,  3.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<01:00,  3.89it/s][A
Iteration:  12%|█▏        | 33/268 [00:10<00:56,  4.19it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<00:52,  4.46it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:50,  4.57it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:49,  4.72it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:47,  4.83it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:46,  4.93it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<00:46,  4.94it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:45,  4.97it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:47,  4.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:45,  4.92it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:45,  5.00it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:44,  5.05it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:43,  5.17it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:42,  5.18it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:42,  5.20it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:42,  5.18it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<00:42,  5.16it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:43,  5.06it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:42,  5.07it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:42,  5.12it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:41,  5.16it/s][A
Iteration:  20%|██        | 54/268 [00:14<00:41,  5.19it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:41,  5.10it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:40,  5.23it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:41,  5.11it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:41,  5.11it/s][A
Iteration:  22%|██▏       | 59/268 [00:15<00:40,  5.11it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:39,  5.28it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:39,  5.22it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:40,  5.13it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:39,  5.17it/s][A
Iteration:  24%|██▍       | 64/268 [00:16<00:39,  5.18it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:38,  5.27it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:38,  5.26it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:38,  5.17it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:38,  5.19it/s][A
Iteration:  26%|██▌       | 69/268 [00:17<00:38,  5.20it/s][A
Iteration:  26%|██▌       | 70/268 [00:17<00:37,  5.21it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:37,  5.22it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:37,  5.22it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:37,  5.22it/s][A[INFO|trainer.py:570] 2024-04-30 10:21:25,541 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:21:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:21:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:21:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:21:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:21:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:21:28 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4576682517533829, 'eval_loss': 1.0579482, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2329, 2358, 2472, 2464, 2455, 2462, 2345, 2184, 1632, 2666, 2532, 1611], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 6, 10], 'pruned_params': 28007284, 'remaining_params': 57010316, 'pruned_model_sparsity': 0.32942924759108705, 'expected_sparsity': 0.32375, 'target_sparsity': 0.3278917910447761, 'step': 1950}


Iteration:  28%|██▊       | 74/268 [00:21<03:56,  1.22s/it][A
Iteration:  28%|██▊       | 75/268 [00:21<02:55,  1.10it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<02:15,  1.41it/s][A
Iteration:  29%|██▊       | 77/268 [00:22<01:46,  1.79it/s][A
Iteration:  29%|██▉       | 78/268 [00:22<01:24,  2.25it/s][A
Iteration:  29%|██▉       | 79/268 [00:22<01:10,  2.69it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<01:00,  3.12it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:53,  3.53it/s][A
Iteration:  31%|███       | 82/268 [00:23<00:47,  3.88it/s][A
Iteration:  31%|███       | 83/268 [00:23<00:44,  4.19it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:41,  4.46it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:39,  4.63it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:37,  4.86it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:37,  4.89it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:36,  5.00it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:36,  4.94it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:34,  5.09it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:34,  5.15it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:33,  5.18it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:33,  5.20it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:33,  5.18it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:33,  5.20it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:32,  5.30it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:33,  5.06it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:33,  5.08it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:33,  5.08it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:33,  5.09it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:32,  5.11it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:32,  5.11it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:32,  5.13it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:32,  5.12it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:31,  5.12it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:32,  4.98it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:32,  4.96it/s][A
Iteration:  40%|████      | 108/268 [00:28<00:32,  4.94it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:32,  4.87it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:31,  4.97it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:31,  5.01it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:30,  5.05it/s][A
Iteration:  42%|████▏     | 113/268 [00:29<00:30,  5.01it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:30,  4.98it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:30,  4.96it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:29,  5.10it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:29,  5.13it/s][A
Iteration:  44%|████▍     | 118/268 [00:30<00:28,  5.25it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:27,  5.38it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:27,  5.32it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:27,  5.29it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:27,  5.41it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:27,  5.36it/s][A[INFO|trainer.py:570] 2024-04-30 10:21:38,737 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:21:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:21:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:21:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:21:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:21:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:21:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.47450472606517075, 'eval_loss': 1.0314523, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2314, 2346, 2464, 2457, 2448, 2455, 2336, 2168, 1601, 2662, 2523, 1599], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 6, 10], 'pruned_params': 28178868, 'remaining_params': 56838732, 'pruned_model_sparsity': 0.3314474649954833, 'expected_sparsity': 0.32603, 'target_sparsity': 0.33675373134328357, 'step': 2000}


Iteration:  46%|████▋     | 124/268 [00:34<02:55,  1.22s/it][A04/30/2024 10:21:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 2000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  47%|████▋     | 125/268 [00:34<02:10,  1.10it/s][A
Iteration:  47%|████▋     | 126/268 [00:34<01:38,  1.44it/s][A
Iteration:  47%|████▋     | 127/268 [00:35<01:17,  1.82it/s][A
Iteration:  48%|████▊     | 128/268 [00:35<01:01,  2.26it/s][A
Iteration:  48%|████▊     | 129/268 [00:35<00:51,  2.72it/s][A
Iteration:  49%|████▊     | 130/268 [00:35<00:44,  3.11it/s][A
Iteration:  49%|████▉     | 131/268 [00:35<00:37,  3.62it/s][A
Iteration:  49%|████▉     | 132/268 [00:36<00:34,  3.90it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<00:32,  4.22it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:29,  4.49it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:29,  4.51it/s][A
Iteration:  51%|█████     | 136/268 [00:36<00:28,  4.70it/s][A
Iteration:  51%|█████     | 137/268 [00:37<00:27,  4.85it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:26,  4.89it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:26,  4.95it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:26,  4.92it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:25,  4.96it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:26,  4.83it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:25,  4.93it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:25,  4.93it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:25,  4.75it/s][A
Iteration:  54%|█████▍    | 146/268 [00:39<00:25,  4.81it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:25,  4.76it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:24,  4.88it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:23,  5.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:23,  5.13it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:23,  5.06it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:22,  5.08it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.02it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:22,  5.08it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:22,  5.08it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:22,  5.01it/s][A
Iteration:  59%|█████▊    | 157/268 [00:41<00:21,  5.14it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:21,  5.17it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:20,  5.25it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:20,  5.15it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:21,  5.02it/s][A
Iteration:  60%|██████    | 162/268 [00:42<00:21,  5.04it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:22,  4.76it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:23,  4.47it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:22,  4.67it/s][A
Iteration:  62%|██████▏   | 166/268 [00:43<00:21,  4.73it/s][A
Iteration:  62%|██████▏   | 167/268 [00:43<00:20,  4.84it/s][A
Iteration:  63%|██████▎   | 168/268 [00:43<00:20,  4.89it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:19,  4.99it/s][A
Iteration:  63%|██████▎   | 170/268 [00:43<00:18,  5.19it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:18,  5.16it/s][A
Iteration:  64%|██████▍   | 172/268 [00:44<00:18,  5.08it/s][A
Iteration:  65%|██████▍   | 173/268 [00:44<00:18,  5.11it/s][A[INFO|trainer.py:570] 2024-04-30 10:21:52,155 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:21:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:21:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:21:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:21:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:21:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:21:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4362839446899871, 'eval_loss': 1.2609072, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2295, 2329, 2452, 2444, 2437, 2445, 2317, 2143, 1562, 2656, 2511, 1583], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 6, 10], 'pruned_params': 28431648, 'remaining_params': 56585952, 'pruned_model_sparsity': 0.33442073170731706, 'expected_sparsity': 0.3293, 'target_sparsity': 0.3456156716417911, 'step': 2050}


Iteration:  65%|██████▍   | 174/268 [00:48<01:55,  1.22s/it][A
Iteration:  65%|██████▌   | 175/268 [00:48<01:25,  1.09it/s][A
Iteration:  66%|██████▌   | 176/268 [00:48<01:04,  1.42it/s][A
Iteration:  66%|██████▌   | 177/268 [00:48<00:50,  1.82it/s][A
Iteration:  66%|██████▋   | 178/268 [00:48<00:39,  2.25it/s][A
Iteration:  67%|██████▋   | 179/268 [00:49<00:33,  2.69it/s][A
Iteration:  67%|██████▋   | 180/268 [00:49<00:28,  3.08it/s][A
Iteration:  68%|██████▊   | 181/268 [00:49<00:24,  3.55it/s][A
Iteration:  68%|██████▊   | 182/268 [00:49<00:22,  3.90it/s][A
Iteration:  68%|██████▊   | 183/268 [00:49<00:20,  4.21it/s][A
Iteration:  69%|██████▊   | 184/268 [00:49<00:18,  4.49it/s][A
Iteration:  69%|██████▉   | 185/268 [00:50<00:17,  4.67it/s][A
Iteration:  69%|██████▉   | 186/268 [00:50<00:17,  4.79it/s][A
Iteration:  70%|██████▉   | 187/268 [00:50<00:16,  4.90it/s][A
Iteration:  70%|███████   | 188/268 [00:50<00:16,  4.87it/s][A
Iteration:  71%|███████   | 189/268 [00:51<00:16,  4.72it/s][A
Iteration:  71%|███████   | 190/268 [00:51<00:16,  4.79it/s][A
Iteration:  71%|███████▏  | 191/268 [00:51<00:16,  4.77it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:15,  4.92it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:14,  5.08it/s][A
Iteration:  72%|███████▏  | 194/268 [00:52<00:14,  4.95it/s][A
Iteration:  73%|███████▎  | 195/268 [00:52<00:14,  4.98it/s][A
Iteration:  73%|███████▎  | 196/268 [00:52<00:14,  5.13it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:14,  5.04it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:14,  4.98it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:13,  4.96it/s][A
Iteration:  75%|███████▍  | 200/268 [00:53<00:13,  5.03it/s][A
Iteration:  75%|███████▌  | 201/268 [00:53<00:13,  5.05it/s][A
Iteration:  75%|███████▌  | 202/268 [00:53<00:13,  4.98it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:12,  5.18it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:12,  5.19it/s][A
Iteration:  76%|███████▋  | 205/268 [00:54<00:12,  5.17it/s][A
Iteration:  77%|███████▋  | 206/268 [00:54<00:11,  5.20it/s][A
Iteration:  77%|███████▋  | 207/268 [00:54<00:12,  5.05it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:11,  5.09it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  5.13it/s][A
Iteration:  78%|███████▊  | 210/268 [00:55<00:11,  5.04it/s][A
Iteration:  79%|███████▊  | 211/268 [00:55<00:10,  5.21it/s][A
Iteration:  79%|███████▉  | 212/268 [00:55<00:11,  5.09it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:10,  5.11it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:10,  5.12it/s][A
Iteration:  80%|████████  | 215/268 [00:56<00:10,  5.15it/s][A
Iteration:  81%|████████  | 216/268 [00:56<00:10,  5.14it/s][A
Iteration:  81%|████████  | 217/268 [00:56<00:10,  5.03it/s][A
Iteration:  81%|████████▏ | 218/268 [00:56<00:09,  5.09it/s][A
Iteration:  82%|████████▏ | 219/268 [00:56<00:09,  5.13it/s][A
Iteration:  82%|████████▏ | 220/268 [00:57<00:09,  5.10it/s][A
Iteration:  82%|████████▏ | 221/268 [00:57<00:09,  4.97it/s][A
Iteration:  83%|████████▎ | 222/268 [00:57<00:09,  5.06it/s][A
Iteration:  83%|████████▎ | 223/268 [00:57<00:09,  4.97it/s][A[INFO|trainer.py:570] 2024-04-30 10:22:05,484 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:22:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:22:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:22:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:22:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:22:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:22:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5026213815149723, 'eval_loss': 0.99266523, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2272, 2310, 2437, 2430, 2424, 2432, 2300, 2121, 1517, 2649, 2497, 1563], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 6, 10], 'pruned_params': 28708940, 'remaining_params': 56308660, 'pruned_model_sparsity': 0.33768231519120745, 'expected_sparsity': 0.33274, 'target_sparsity': 0.35447761194029853, 'step': 2100}


Iteration:  84%|████████▎ | 224/268 [01:01<00:54,  1.23s/it][A04/30/2024 10:22:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 2100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  84%|████████▍ | 225/268 [01:01<00:39,  1.08it/s][A
Iteration:  84%|████████▍ | 226/268 [01:01<00:29,  1.41it/s][A
Iteration:  85%|████████▍ | 227/268 [01:01<00:22,  1.80it/s][A
Iteration:  85%|████████▌ | 228/268 [01:02<00:17,  2.24it/s][A
Iteration:  85%|████████▌ | 229/268 [01:02<00:14,  2.66it/s][A
Iteration:  86%|████████▌ | 230/268 [01:02<00:12,  3.09it/s][A
Iteration:  86%|████████▌ | 231/268 [01:02<00:10,  3.52it/s][A
Iteration:  87%|████████▋ | 232/268 [01:02<00:09,  3.87it/s][A
Iteration:  87%|████████▋ | 233/268 [01:03<00:08,  4.08it/s][A
Iteration:  87%|████████▋ | 234/268 [01:03<00:07,  4.36it/s][A
Iteration:  88%|████████▊ | 235/268 [01:03<00:07,  4.56it/s][A
Iteration:  88%|████████▊ | 236/268 [01:03<00:06,  4.81it/s][A
Iteration:  88%|████████▊ | 237/268 [01:03<00:06,  4.99it/s][A
Iteration:  89%|████████▉ | 238/268 [01:04<00:06,  4.98it/s][A
Iteration:  89%|████████▉ | 239/268 [01:04<00:05,  5.02it/s][A
Iteration:  90%|████████▉ | 240/268 [01:04<00:05,  5.08it/s][A
Iteration:  90%|████████▉ | 241/268 [01:04<00:05,  5.09it/s][A
Iteration:  90%|█████████ | 242/268 [01:04<00:05,  5.12it/s][A
Iteration:  91%|█████████ | 243/268 [01:05<00:04,  5.23it/s][A
Iteration:  91%|█████████ | 244/268 [01:05<00:04,  5.24it/s][A
Iteration:  91%|█████████▏| 245/268 [01:05<00:04,  5.16it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:04,  4.96it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:04,  5.17it/s][A
Iteration:  93%|█████████▎| 248/268 [01:06<00:03,  5.16it/s][A
Iteration:  93%|█████████▎| 249/268 [01:06<00:03,  5.17it/s][A
Iteration:  93%|█████████▎| 250/268 [01:06<00:03,  5.10it/s][A
Iteration:  94%|█████████▎| 251/268 [01:06<00:03,  5.03it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:03,  4.96it/s][A
Iteration:  94%|█████████▍| 253/268 [01:07<00:02,  5.01it/s][A
Iteration:  95%|█████████▍| 254/268 [01:07<00:02,  5.04it/s][A
Iteration:  95%|█████████▌| 255/268 [01:07<00:02,  5.07it/s][A
Iteration:  96%|█████████▌| 256/268 [01:07<00:02,  5.14it/s][A
Iteration:  96%|█████████▌| 257/268 [01:07<00:02,  5.17it/s][A
Iteration:  96%|█████████▋| 258/268 [01:08<00:01,  5.21it/s][A
Iteration:  97%|█████████▋| 259/268 [01:08<00:01,  5.22it/s][A
Iteration:  97%|█████████▋| 260/268 [01:08<00:01,  5.20it/s][A
Iteration:  97%|█████████▋| 261/268 [01:08<00:01,  5.12it/s][A
Iteration:  98%|█████████▊| 262/268 [01:08<00:01,  5.11it/s][A
Iteration:  98%|█████████▊| 263/268 [01:09<00:00,  5.10it/s][A
Iteration:  99%|█████████▊| 264/268 [01:09<00:00,  5.11it/s][A
Iteration:  99%|█████████▉| 265/268 [01:09<00:00,  5.09it/s][A
Iteration:  99%|█████████▉| 266/268 [01:09<00:00,  5.10it/s][A
Iteration: 100%|█████████▉| 267/268 [01:09<00:00,  5.14it/s][A
Iteration: 100%|██████████| 268/268 [01:09<00:00,  5.56it/s][A04/30/2024 10:22:17 - INFO - trainer.trainer_mod_2 - Epoch 7 finished. Took 69.93 seconds.
Iteration: 100%|██████████| 268/268 [01:09<00:00,  3.83it/s]
Epoch:   8%|▊         | 8/100 [09:23<1:48:20, 70.65s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:51,  5.23it/s][A
Iteration:   1%|          | 2/268 [00:00<00:52,  5.04it/s][A
Iteration:   1%|          | 3/268 [00:00<00:53,  4.95it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:53,  4.97it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:52,  5.02it/s][A[INFO|trainer.py:570] 2024-04-30 10:22:18,684 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:22:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:22:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:22:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:22:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:22:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:22:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5196268865242739, 'eval_loss': 0.9917116, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2242, 2283, 2417, 2412, 2407, 2416, 2276, 2090, 1462, 2640, 2479, 1538], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 6, 10], 'pruned_params': 29073556, 'remaining_params': 55944044, 'pruned_model_sparsity': 0.34197102717554956, 'expected_sparsity': 0.33729, 'target_sparsity': 0.363339552238806, 'step': 2150}


Iteration:   2%|▏         | 6/268 [00:04<05:56,  1.36s/it][A
Iteration:   3%|▎         | 7/268 [00:04<04:14,  1.02it/s][A
Iteration:   3%|▎         | 8/268 [00:04<03:08,  1.38it/s][A
Iteration:   3%|▎         | 9/268 [00:05<02:25,  1.79it/s][A
Iteration:   4%|▎         | 10/268 [00:05<01:57,  2.20it/s][A
Iteration:   4%|▍         | 11/268 [00:05<01:35,  2.70it/s][A
Iteration:   4%|▍         | 12/268 [00:05<01:23,  3.08it/s][A
Iteration:   5%|▍         | 13/268 [00:05<01:11,  3.56it/s][A
Iteration:   5%|▌         | 14/268 [00:06<01:04,  3.93it/s][A
Iteration:   6%|▌         | 15/268 [00:06<00:58,  4.29it/s][A
Iteration:   6%|▌         | 16/268 [00:06<00:55,  4.53it/s][A
Iteration:   6%|▋         | 17/268 [00:06<00:53,  4.66it/s][A
Iteration:   7%|▋         | 18/268 [00:06<00:52,  4.78it/s][A
Iteration:   7%|▋         | 19/268 [00:07<00:50,  4.98it/s][A
Iteration:   7%|▋         | 20/268 [00:07<00:49,  5.01it/s][A
Iteration:   8%|▊         | 21/268 [00:07<00:47,  5.21it/s][A
Iteration:   8%|▊         | 22/268 [00:07<00:47,  5.21it/s][A
Iteration:   9%|▊         | 23/268 [00:07<00:47,  5.17it/s][A
Iteration:   9%|▉         | 24/268 [00:08<00:46,  5.19it/s][A
Iteration:   9%|▉         | 25/268 [00:08<00:46,  5.21it/s][A
Iteration:  10%|▉         | 26/268 [00:08<00:46,  5.21it/s][A
Iteration:  10%|█         | 27/268 [00:08<00:48,  5.00it/s][A
Iteration:  10%|█         | 28/268 [00:08<00:47,  5.06it/s][A
Iteration:  11%|█         | 29/268 [00:09<00:48,  4.96it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:47,  5.01it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:48,  4.85it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:47,  4.95it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:45,  5.18it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<00:46,  4.98it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:46,  5.04it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:45,  5.06it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:46,  5.02it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:46,  4.98it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<00:45,  5.02it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:44,  5.08it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:44,  5.04it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:44,  5.07it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:44,  5.06it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:44,  5.07it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:43,  5.12it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:44,  4.97it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:43,  5.14it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:43,  5.11it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<00:42,  5.16it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.18it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:42,  5.17it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:42,  5.04it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:43,  4.89it/s][A
Iteration:  20%|██        | 54/268 [00:14<00:42,  5.01it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:41,  5.16it/s][A[INFO|trainer.py:570] 2024-04-30 10:22:31,928 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:22:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:22:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:22:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:22:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:22:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:22:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.47467239745267154, 'eval_loss': 1.0993606, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2205, 2249, 2393, 2390, 2386, 2395, 2248, 2054, 1399, 2628, 2455, 1507], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 6, 10], 'pruned_params': 29511708, 'remaining_params': 55505892, 'pruned_model_sparsity': 0.34712468947606145, 'expected_sparsity': 0.34309, 'target_sparsity': 0.37220149253731344, 'step': 2200}


Iteration:  21%|██        | 56/268 [00:17<04:21,  1.23s/it][A04/30/2024 10:22:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 2200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  21%|██▏       | 57/268 [00:18<03:14,  1.08it/s][A
Iteration:  22%|██▏       | 58/268 [00:18<02:27,  1.42it/s][A
Iteration:  22%|██▏       | 59/268 [00:18<01:54,  1.82it/s][A
Iteration:  22%|██▏       | 60/268 [00:18<01:31,  2.27it/s][A
Iteration:  23%|██▎       | 61/268 [00:18<01:14,  2.76it/s][A
Iteration:  23%|██▎       | 62/268 [00:19<01:04,  3.18it/s][A
Iteration:  24%|██▎       | 63/268 [00:19<00:58,  3.49it/s][A
Iteration:  24%|██▍       | 64/268 [00:19<00:52,  3.86it/s][A
Iteration:  24%|██▍       | 65/268 [00:19<00:49,  4.13it/s][A
Iteration:  25%|██▍       | 66/268 [00:19<00:45,  4.42it/s][A
Iteration:  25%|██▌       | 67/268 [00:20<00:43,  4.64it/s][A
Iteration:  25%|██▌       | 68/268 [00:20<00:41,  4.82it/s][A
Iteration:  26%|██▌       | 69/268 [00:20<00:40,  4.91it/s][A
Iteration:  26%|██▌       | 70/268 [00:20<00:39,  4.98it/s][A
Iteration:  26%|██▋       | 71/268 [00:20<00:38,  5.13it/s][A
Iteration:  27%|██▋       | 72/268 [00:20<00:38,  5.12it/s][A
Iteration:  27%|██▋       | 73/268 [00:21<00:37,  5.25it/s][A
Iteration:  28%|██▊       | 74/268 [00:21<00:38,  4.99it/s][A
Iteration:  28%|██▊       | 75/268 [00:21<00:38,  5.02it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<00:38,  5.01it/s][A
Iteration:  29%|██▊       | 77/268 [00:21<00:37,  5.16it/s][A
Iteration:  29%|██▉       | 78/268 [00:22<00:37,  5.07it/s][A
Iteration:  29%|██▉       | 79/268 [00:22<00:37,  5.03it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<00:37,  5.00it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:36,  5.07it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:36,  5.07it/s][A
Iteration:  31%|███       | 83/268 [00:23<00:36,  5.12it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:36,  5.04it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:35,  5.10it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:36,  4.98it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:36,  4.96it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:35,  5.11it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:36,  4.92it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:35,  4.99it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:35,  5.02it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:34,  5.10it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:35,  4.96it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:33,  5.13it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:33,  5.14it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:34,  5.05it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:33,  5.08it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:34,  5.00it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:33,  5.06it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:32,  5.19it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:33,  5.04it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:33,  4.95it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:33,  4.96it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:32,  5.01it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:31,  5.16it/s][A[INFO|trainer.py:570] 2024-04-30 10:22:45,192 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:22:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:22:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:22:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:22:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.61it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.63it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.65it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.78it/s]04/30/2024 10:22:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:22:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.507377846859107, 'eval_loss': 1.0201486, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2160, 2208, 2362, 2364, 2361, 2370, 2217, 2011, 1331, 2614, 2425, 1471], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 7, 6, 10], 'pruned_params': 30024928, 'remaining_params': 54992672, 'pruned_model_sparsity': 0.3531613218909967, 'expected_sparsity': 0.35002, 'target_sparsity': 0.3810634328358209, 'step': 2250}


Iteration:  40%|███▉      | 106/268 [00:31<03:18,  1.22s/it][A
Iteration:  40%|███▉      | 107/268 [00:31<02:27,  1.09it/s][A
Iteration:  40%|████      | 108/268 [00:31<01:51,  1.43it/s][A
Iteration:  41%|████      | 109/268 [00:31<01:27,  1.82it/s][A
Iteration:  41%|████      | 110/268 [00:31<01:10,  2.23it/s][A
Iteration:  41%|████▏     | 111/268 [00:32<01:00,  2.61it/s][A
Iteration:  42%|████▏     | 112/268 [00:32<00:50,  3.06it/s][A
Iteration:  42%|████▏     | 113/268 [00:32<00:44,  3.49it/s][A
Iteration:  43%|████▎     | 114/268 [00:32<00:40,  3.83it/s][A
Iteration:  43%|████▎     | 115/268 [00:32<00:36,  4.16it/s][A
Iteration:  43%|████▎     | 116/268 [00:33<00:34,  4.44it/s][A
Iteration:  44%|████▎     | 117/268 [00:33<00:32,  4.63it/s][A
Iteration:  44%|████▍     | 118/268 [00:33<00:31,  4.79it/s][A
Iteration:  44%|████▍     | 119/268 [00:33<00:30,  4.89it/s][A
Iteration:  45%|████▍     | 120/268 [00:33<00:29,  4.96it/s][A
Iteration:  45%|████▌     | 121/268 [00:34<00:29,  5.04it/s][A
Iteration:  46%|████▌     | 122/268 [00:34<00:28,  5.07it/s][A
Iteration:  46%|████▌     | 123/268 [00:34<00:28,  5.13it/s][A
Iteration:  46%|████▋     | 124/268 [00:34<00:28,  5.13it/s][A
Iteration:  47%|████▋     | 125/268 [00:34<00:27,  5.14it/s][A
Iteration:  47%|████▋     | 126/268 [00:35<00:28,  5.04it/s][A
Iteration:  47%|████▋     | 127/268 [00:35<00:27,  5.11it/s][A
Iteration:  48%|████▊     | 128/268 [00:35<00:27,  5.16it/s][A
Iteration:  48%|████▊     | 129/268 [00:35<00:27,  5.09it/s][A
Iteration:  49%|████▊     | 130/268 [00:35<00:26,  5.22it/s][A
Iteration:  49%|████▉     | 131/268 [00:36<00:26,  5.13it/s][A
Iteration:  49%|████▉     | 132/268 [00:36<00:26,  5.10it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<00:26,  5.15it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:26,  4.99it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:26,  5.08it/s][A
Iteration:  51%|█████     | 136/268 [00:37<00:25,  5.15it/s][A
Iteration:  51%|█████     | 137/268 [00:37<00:25,  5.09it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:25,  5.13it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:24,  5.25it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:26,  4.77it/s][A
Iteration:  53%|█████▎    | 141/268 [00:38<00:26,  4.83it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:25,  4.91it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:25,  4.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:25,  4.90it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:24,  4.97it/s][A
Iteration:  54%|█████▍    | 146/268 [00:39<00:24,  5.05it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:23,  5.24it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:22,  5.27it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:22,  5.27it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:22,  5.29it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:22,  5.25it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:22,  5.15it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.14it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:22,  5.08it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:22,  5.03it/s][A[INFO|trainer.py:570] 2024-04-30 10:22:58,473 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:22:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:22:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:22:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:22:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.66it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.66it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:23:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:23:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.46431446090304007, 'eval_loss': 1.0980003, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2107, 2161, 2326, 2331, 2327, 2337, 2173, 1956, 1256, 2595, 2388, 1428], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 6, 6, 10], 'pruned_params': 30849144, 'remaining_params': 54168456, 'pruned_model_sparsity': 0.3628559733514002, 'expected_sparsity': 0.35823, 'target_sparsity': 0.38992537313432835, 'step': 2300}


Iteration:  58%|█████▊    | 156/268 [00:44<02:17,  1.23s/it][A04/30/2024 10:23:01 - INFO - trainer.trainer_mod_2 - v4 Global step: 2300, Alignment: tensor([ 3,  6,  7, 10], device='cuda:0')

Iteration:  59%|█████▊    | 157/268 [00:44<01:42,  1.09it/s][A
Iteration:  59%|█████▉    | 158/268 [00:44<01:16,  1.43it/s][A
Iteration:  59%|█████▉    | 159/268 [00:45<01:00,  1.81it/s][A
Iteration:  60%|█████▉    | 160/268 [00:45<00:47,  2.25it/s][A
Iteration:  60%|██████    | 161/268 [00:45<00:39,  2.73it/s][A
Iteration:  60%|██████    | 162/268 [00:45<00:33,  3.19it/s][A
Iteration:  61%|██████    | 163/268 [00:45<00:29,  3.56it/s][A
Iteration:  61%|██████    | 164/268 [00:45<00:26,  3.92it/s][A
Iteration:  62%|██████▏   | 165/268 [00:46<00:24,  4.19it/s][A
Iteration:  62%|██████▏   | 166/268 [00:46<00:23,  4.41it/s][A
Iteration:  62%|██████▏   | 167/268 [00:46<00:22,  4.56it/s][A
Iteration:  63%|██████▎   | 168/268 [00:46<00:21,  4.66it/s][A
Iteration:  63%|██████▎   | 169/268 [00:46<00:20,  4.82it/s][A
Iteration:  63%|██████▎   | 170/268 [00:47<00:19,  4.94it/s][A
Iteration:  64%|██████▍   | 171/268 [00:47<00:19,  4.87it/s][A
Iteration:  64%|██████▍   | 172/268 [00:47<00:19,  4.88it/s][A
Iteration:  65%|██████▍   | 173/268 [00:47<00:19,  4.88it/s][A
Iteration:  65%|██████▍   | 174/268 [00:47<00:19,  4.91it/s][A
Iteration:  65%|██████▌   | 175/268 [00:48<00:19,  4.85it/s][A
Iteration:  66%|██████▌   | 176/268 [00:48<00:18,  4.96it/s][A
Iteration:  66%|██████▌   | 177/268 [00:48<00:18,  5.01it/s][A
Iteration:  66%|██████▋   | 178/268 [00:48<00:17,  5.10it/s][A
Iteration:  67%|██████▋   | 179/268 [00:48<00:17,  5.10it/s][A
Iteration:  67%|██████▋   | 180/268 [00:49<00:17,  5.15it/s][A
Iteration:  68%|██████▊   | 181/268 [00:49<00:16,  5.18it/s][A
Iteration:  68%|██████▊   | 182/268 [00:49<00:16,  5.14it/s][A
Iteration:  68%|██████▊   | 183/268 [00:49<00:16,  5.14it/s][A
Iteration:  69%|██████▊   | 184/268 [00:49<00:16,  5.19it/s][A
Iteration:  69%|██████▉   | 185/268 [00:50<00:15,  5.19it/s][A
Iteration:  69%|██████▉   | 186/268 [00:50<00:16,  5.11it/s][A
Iteration:  70%|██████▉   | 187/268 [00:50<00:15,  5.15it/s][A
Iteration:  70%|███████   | 188/268 [00:50<00:15,  5.14it/s][A
Iteration:  71%|███████   | 189/268 [00:50<00:15,  5.17it/s][A
Iteration:  71%|███████   | 190/268 [00:51<00:15,  5.20it/s][A
Iteration:  71%|███████▏  | 191/268 [00:51<00:14,  5.18it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:15,  5.07it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:14,  5.12it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:14,  5.15it/s][A
Iteration:  73%|███████▎  | 195/268 [00:52<00:14,  5.20it/s][A
Iteration:  73%|███████▎  | 196/268 [00:52<00:14,  5.04it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:13,  5.11it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:13,  5.11it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:13,  5.17it/s][A
Iteration:  75%|███████▍  | 200/268 [00:53<00:12,  5.26it/s][A
Iteration:  75%|███████▌  | 201/268 [00:53<00:12,  5.24it/s][A
Iteration:  75%|███████▌  | 202/268 [00:53<00:12,  5.21it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:12,  5.23it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:13,  4.92it/s][A
Iteration:  76%|███████▋  | 205/268 [00:54<00:12,  4.97it/s][A[INFO|trainer.py:570] 2024-04-30 10:23:11,746 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:23:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:23:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:23:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:23:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:23:15 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:23:15 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5100647346054326, 'eval_loss': 0.9940147, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [2049, 2107, 2285, 2294, 2292, 2301, 2127, 1896, 1179, 2572, 2344, 1379], 'head_nums': [12, 12, 12, 12, 12, 12, 12, 11, 11, 6, 6, 10], 'pruned_params': 31529352, 'remaining_params': 53488248, 'pruned_model_sparsity': 0.3708567637759711, 'expected_sparsity': 0.36726, 'target_sparsity': 0.3987873134328358, 'step': 2350}


Iteration:  77%|███████▋  | 206/268 [00:57<01:16,  1.24s/it][A
Iteration:  77%|███████▋  | 207/268 [00:57<00:56,  1.08it/s][A
Iteration:  78%|███████▊  | 208/268 [00:58<00:42,  1.42it/s][A
Iteration:  78%|███████▊  | 209/268 [00:58<00:32,  1.81it/s][A
Iteration:  78%|███████▊  | 210/268 [00:58<00:26,  2.22it/s][A
Iteration:  79%|███████▊  | 211/268 [00:58<00:21,  2.69it/s][A
Iteration:  79%|███████▉  | 212/268 [00:58<00:17,  3.15it/s][A
Iteration:  79%|███████▉  | 213/268 [00:59<00:15,  3.60it/s][A
Iteration:  80%|███████▉  | 214/268 [00:59<00:13,  3.93it/s][A
Iteration:  80%|████████  | 215/268 [00:59<00:12,  4.20it/s][A
Iteration:  81%|████████  | 216/268 [00:59<00:11,  4.48it/s][A
Iteration:  81%|████████  | 217/268 [00:59<00:11,  4.60it/s][A
Iteration:  81%|████████▏ | 218/268 [01:00<00:10,  4.75it/s][A
Iteration:  82%|████████▏ | 219/268 [01:00<00:09,  4.95it/s][A
Iteration:  82%|████████▏ | 220/268 [01:00<00:09,  5.04it/s][A
Iteration:  82%|████████▏ | 221/268 [01:00<00:09,  5.11it/s][A
Iteration:  83%|████████▎ | 222/268 [01:00<00:09,  5.00it/s][A
Iteration:  83%|████████▎ | 223/268 [01:01<00:09,  4.98it/s][A
Iteration:  84%|████████▎ | 224/268 [01:01<00:08,  5.04it/s][A
Iteration:  84%|████████▍ | 225/268 [01:01<00:08,  5.05it/s][A
Iteration:  84%|████████▍ | 226/268 [01:01<00:08,  5.14it/s][A
Iteration:  85%|████████▍ | 227/268 [01:01<00:07,  5.18it/s][A
Iteration:  85%|████████▌ | 228/268 [01:01<00:07,  5.18it/s][A
Iteration:  85%|████████▌ | 229/268 [01:02<00:07,  5.20it/s][A
Iteration:  86%|████████▌ | 230/268 [01:02<00:07,  5.12it/s][A
Iteration:  86%|████████▌ | 231/268 [01:02<00:07,  5.16it/s][A
Iteration:  87%|████████▋ | 232/268 [01:02<00:06,  5.17it/s][A
Iteration:  87%|████████▋ | 233/268 [01:02<00:06,  5.17it/s][A
Iteration:  87%|████████▋ | 234/268 [01:03<00:06,  5.20it/s][A
Iteration:  88%|████████▊ | 235/268 [01:03<00:06,  5.07it/s][A
Iteration:  88%|████████▊ | 236/268 [01:03<00:06,  5.12it/s][A
Iteration:  88%|████████▊ | 237/268 [01:03<00:06,  5.13it/s][A
Iteration:  89%|████████▉ | 238/268 [01:03<00:05,  5.14it/s][A
Iteration:  89%|████████▉ | 239/268 [01:04<00:05,  5.25it/s][A
Iteration:  90%|████████▉ | 240/268 [01:04<00:05,  5.20it/s][A
Iteration:  90%|████████▉ | 241/268 [01:04<00:05,  5.30it/s][A
Iteration:  90%|█████████ | 242/268 [01:04<00:04,  5.44it/s][A
Iteration:  91%|█████████ | 243/268 [01:04<00:04,  5.31it/s][A
Iteration:  91%|█████████ | 244/268 [01:05<00:04,  5.29it/s][A
Iteration:  91%|█████████▏| 245/268 [01:05<00:04,  5.25it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:04,  5.22it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:03,  5.25it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:03,  5.04it/s][A
Iteration:  93%|█████████▎| 249/268 [01:06<00:03,  5.02it/s][A
Iteration:  93%|█████████▎| 250/268 [01:06<00:03,  5.05it/s][A
Iteration:  94%|█████████▎| 251/268 [01:06<00:03,  5.04it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:03,  5.12it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:02,  5.17it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:02,  5.19it/s][A
Iteration:  95%|█████████▌| 255/268 [01:07<00:02,  5.10it/s][A[INFO|trainer.py:570] 2024-04-30 10:23:24,884 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:23:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:23:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:23:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:23:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:23:28 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:23:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5375536420654937, 'eval_loss': 0.9468067, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1984, 2048, 2239, 2254, 2249, 2260, 2075, 1834, 1103, 2545, 2292, 1326], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 11, 11, 6, 6, 10], 'pruned_params': 32466936, 'remaining_params': 52550664, 'pruned_model_sparsity': 0.3818848803071364, 'expected_sparsity': 0.37823, 'target_sparsity': 0.4076492537313433, 'step': 2400}


Iteration:  96%|█████████▌| 256/268 [01:13<00:22,  1.89s/it][A04/30/2024 10:23:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 2400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  96%|█████████▌| 257/268 [01:13<00:15,  1.39s/it][A
Iteration:  96%|█████████▋| 258/268 [01:13<00:10,  1.03s/it][A
Iteration:  97%|█████████▋| 259/268 [01:13<00:06,  1.29it/s][A
Iteration:  97%|█████████▋| 260/268 [01:13<00:04,  1.66it/s][A
Iteration:  97%|█████████▋| 261/268 [01:14<00:03,  2.09it/s][A
Iteration:  98%|█████████▊| 262/268 [01:14<00:02,  2.52it/s][A
Iteration:  98%|█████████▊| 263/268 [01:14<00:01,  3.01it/s][A
Iteration:  99%|█████████▊| 264/268 [01:14<00:01,  3.52it/s][A
Iteration:  99%|█████████▉| 265/268 [01:14<00:00,  3.86it/s][A
Iteration:  99%|█████████▉| 266/268 [01:14<00:00,  4.13it/s][A
Iteration: 100%|█████████▉| 267/268 [01:15<00:00,  4.34it/s][A
Iteration: 100%|██████████| 268/268 [01:15<00:00,  4.95it/s][A04/30/2024 10:23:32 - INFO - trainer.trainer_mod_2 - Epoch 8 finished. Took 75.31 seconds.
Iteration: 100%|██████████| 268/268 [01:15<00:00,  3.56it/s]
Epoch:   9%|▉         | 9/100 [10:39<1:49:21, 72.11s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:48,  5.51it/s][A
Iteration:   1%|          | 2/268 [00:00<00:52,  5.11it/s][A
Iteration:   1%|          | 3/268 [00:00<00:51,  5.18it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:49,  5.34it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.19it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:50,  5.21it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:52,  4.99it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:51,  5.04it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:51,  5.07it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:50,  5.09it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:50,  5.11it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:50,  5.08it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:49,  5.14it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:50,  5.06it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:51,  4.93it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:51,  4.87it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:48,  5.13it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:47,  5.26it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:47,  5.24it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:48,  5.16it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:48,  5.09it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:47,  5.21it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:47,  5.14it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:48,  4.99it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:47,  5.15it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:46,  5.16it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:46,  5.20it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:46,  5.19it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:45,  5.31it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:45,  5.26it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:45,  5.20it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:45,  5.18it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:45,  5.21it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:44,  5.20it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:44,  5.18it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:44,  5.23it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:44,  5.16it/s][A[INFO|trainer.py:570] 2024-04-30 10:23:40,206 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:23:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:23:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:23:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:23:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:23:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:23:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5286115192294574, 'eval_loss': 1.0036935, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1914, 1984, 2188, 2209, 2202, 2214, 2019, 1768, 1028, 2512, 2234, 1269], 'head_nums': [12, 11, 12, 12, 12, 12, 12, 11, 11, 6, 5, 10], 'pruned_params': 33459672, 'remaining_params': 51557928, 'pruned_model_sparsity': 0.3935617095754291, 'expected_sparsity': 0.39057, 'target_sparsity': 0.41651119402985076, 'step': 2450}


Iteration:  14%|█▍        | 38/268 [00:10<04:43,  1.23s/it][A
Iteration:  15%|█▍        | 39/268 [00:11<03:30,  1.09it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<02:40,  1.42it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<02:05,  1.81it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<01:40,  2.26it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<01:22,  2.72it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<01:10,  3.18it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<01:02,  3.59it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:56,  3.92it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:52,  4.21it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:49,  4.49it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:46,  4.66it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:45,  4.75it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:44,  4.86it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:43,  4.95it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:42,  5.02it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:42,  4.99it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:42,  5.05it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:41,  5.07it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:41,  5.09it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:40,  5.23it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:40,  5.20it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:41,  5.03it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:41,  5.02it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:41,  5.00it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:41,  4.97it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:40,  5.06it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:39,  5.10it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:39,  5.11it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:37,  5.31it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:37,  5.38it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:37,  5.26it/s][A
Iteration:  26%|██▌       | 70/268 [00:17<00:37,  5.27it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:37,  5.27it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:37,  5.17it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:37,  5.20it/s][A
Iteration:  28%|██▊       | 74/268 [00:17<00:37,  5.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:18<00:38,  4.99it/s][A
Iteration:  28%|██▊       | 76/268 [00:18<00:39,  4.90it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:39,  4.85it/s][A
Iteration:  29%|██▉       | 78/268 [00:18<00:38,  4.97it/s][A
Iteration:  29%|██▉       | 79/268 [00:18<00:38,  4.96it/s][A
Iteration:  30%|██▉       | 80/268 [00:19<00:37,  5.05it/s][A
Iteration:  30%|███       | 81/268 [00:19<00:35,  5.20it/s][A
Iteration:  31%|███       | 82/268 [00:19<00:36,  5.14it/s][A
Iteration:  31%|███       | 83/268 [00:19<00:36,  5.07it/s][A
Iteration:  31%|███▏      | 84/268 [00:19<00:37,  4.97it/s][A
Iteration:  32%|███▏      | 85/268 [00:20<00:36,  5.02it/s][A
Iteration:  32%|███▏      | 86/268 [00:20<00:35,  5.11it/s][A
Iteration:  32%|███▏      | 87/268 [00:20<00:35,  5.13it/s][A[INFO|trainer.py:570] 2024-04-30 10:23:53,425 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:23:53 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:23:53 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:23:53 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:23:53 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:23:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:23:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4919724947303947, 'eval_loss': 1.034639, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1841, 1916, 2134, 2160, 2153, 2165, 1959, 1698, 955, 2474, 2169, 1210], 'head_nums': [12, 10, 11, 12, 12, 12, 12, 11, 11, 6, 5, 10], 'pruned_params': 34686804, 'remaining_params': 50330796, 'pruned_model_sparsity': 0.4079955679765131, 'expected_sparsity': 0.40306, 'target_sparsity': 0.4253731343283582, 'step': 2500}


Iteration:  33%|███▎      | 88/268 [00:24<03:40,  1.22s/it][A04/30/2024 10:23:56 - INFO - trainer.trainer_mod_2 - v4 Global step: 2500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  33%|███▎      | 89/268 [00:24<02:46,  1.08it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<02:06,  1.41it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<01:37,  1.81it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<01:18,  2.25it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<01:05,  2.67it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:55,  3.14it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:48,  3.59it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:43,  3.97it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:40,  4.22it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:38,  4.41it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:36,  4.61it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:36,  4.62it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:35,  4.66it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:34,  4.74it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:33,  4.89it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:33,  4.87it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:33,  4.91it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:31,  5.09it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:32,  4.93it/s][A
Iteration:  40%|████      | 108/268 [00:28<00:32,  4.88it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:31,  4.98it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:31,  5.03it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:31,  4.98it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:30,  5.04it/s][A
Iteration:  42%|████▏     | 113/268 [00:29<00:30,  5.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:30,  5.10it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:29,  5.22it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:28,  5.25it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:28,  5.39it/s][A
Iteration:  44%|████▍     | 118/268 [00:29<00:28,  5.34it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:27,  5.33it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:27,  5.33it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:27,  5.38it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:27,  5.32it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:27,  5.32it/s][A
Iteration:  46%|████▋     | 124/268 [00:31<00:27,  5.27it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:27,  5.23it/s][A
Iteration:  47%|████▋     | 126/268 [00:31<00:26,  5.33it/s][A
Iteration:  47%|████▋     | 127/268 [00:31<00:26,  5.31it/s][A
Iteration:  48%|████▊     | 128/268 [00:31<00:26,  5.30it/s][A
Iteration:  48%|████▊     | 129/268 [00:32<00:26,  5.17it/s][A
Iteration:  49%|████▊     | 130/268 [00:32<00:26,  5.18it/s][A
Iteration:  49%|████▉     | 131/268 [00:32<00:26,  5.22it/s][A
Iteration:  49%|████▉     | 132/268 [00:32<00:26,  5.22it/s][A
Iteration:  50%|████▉     | 133/268 [00:32<00:26,  5.13it/s][A
Iteration:  50%|█████     | 134/268 [00:33<00:26,  5.14it/s][A
Iteration:  50%|█████     | 135/268 [00:33<00:25,  5.13it/s][A
Iteration:  51%|█████     | 136/268 [00:33<00:25,  5.15it/s][A
Iteration:  51%|█████     | 137/268 [00:33<00:26,  4.96it/s][A[INFO|trainer.py:570] 2024-04-30 10:24:06,635 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:24:06 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:24:06 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:24:06 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:24:06 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:24:10 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:24:10 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5146539306547105, 'eval_loss': 0.95920414, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1767, 1847, 2075, 2108, 2101, 2112, 1896, 1628, 887, 2432, 2099, 1151], 'head_nums': [12, 10, 10, 12, 12, 12, 12, 11, 11, 6, 5, 10], 'pruned_params': 35740820, 'remaining_params': 49276780, 'pruned_model_sparsity': 0.4203931891749473, 'expected_sparsity': 0.41709, 'target_sparsity': 0.43423507462686567, 'step': 2550}


Iteration:  51%|█████▏    | 138/268 [00:37<02:39,  1.23s/it][A
Iteration:  52%|█████▏    | 139/268 [00:37<01:58,  1.09it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<01:29,  1.43it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<01:09,  1.83it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:56,  2.24it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:46,  2.72it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:39,  3.16it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:34,  3.59it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:31,  3.82it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:29,  4.08it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:28,  4.21it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:26,  4.47it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:25,  4.61it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:24,  4.80it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:23,  4.99it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.05it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:23,  4.84it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:22,  4.92it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:22,  4.92it/s][A
Iteration:  59%|█████▊    | 157/268 [00:41<00:22,  5.01it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:22,  5.00it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:22,  4.93it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:22,  4.86it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:21,  4.97it/s][A
Iteration:  60%|██████    | 162/268 [00:42<00:20,  5.07it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:20,  5.09it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:20,  5.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:19,  5.18it/s][A
Iteration:  62%|██████▏   | 166/268 [00:42<00:19,  5.30it/s][A
Iteration:  62%|██████▏   | 167/268 [00:42<00:19,  5.24it/s][A
Iteration:  63%|██████▎   | 168/268 [00:43<00:19,  5.22it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:19,  5.15it/s][A
Iteration:  63%|██████▎   | 170/268 [00:43<00:18,  5.19it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:18,  5.17it/s][A
Iteration:  64%|██████▍   | 172/268 [00:43<00:18,  5.16it/s][A
Iteration:  65%|██████▍   | 173/268 [00:44<00:18,  5.16it/s][A
Iteration:  65%|██████▍   | 174/268 [00:44<00:18,  5.17it/s][A
Iteration:  65%|██████▌   | 175/268 [00:44<00:18,  5.09it/s][A
Iteration:  66%|██████▌   | 176/268 [00:44<00:18,  5.11it/s][A
Iteration:  66%|██████▌   | 177/268 [00:44<00:17,  5.10it/s][A
Iteration:  66%|██████▋   | 178/268 [00:45<00:17,  5.11it/s][A
Iteration:  67%|██████▋   | 179/268 [00:45<00:17,  5.13it/s][A
Iteration:  67%|██████▋   | 180/268 [00:45<00:17,  5.17it/s][A
Iteration:  68%|██████▊   | 181/268 [00:45<00:16,  5.16it/s][A
Iteration:  68%|██████▊   | 182/268 [00:45<00:16,  5.28it/s][A
Iteration:  68%|██████▊   | 183/268 [00:46<00:16,  5.17it/s][A
Iteration:  69%|██████▊   | 184/268 [00:46<00:16,  5.06it/s][A
Iteration:  69%|██████▉   | 185/268 [00:46<00:16,  5.10it/s][A
Iteration:  69%|██████▉   | 186/268 [00:46<00:15,  5.16it/s][A
Iteration:  70%|██████▉   | 187/268 [00:46<00:15,  5.15it/s][A[INFO|trainer.py:570] 2024-04-30 10:24:19,881 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:24:19 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:24:19 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:24:19 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:24:19 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:24:23 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:24:23 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5191410061786484, 'eval_loss': 0.92681867, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1694, 1779, 2017, 2055, 2048, 2060, 1835, 1561, 824, 2385, 2023, 1093], 'head_nums': [12, 10, 10, 12, 11, 12, 12, 11, 11, 5, 4, 10], 'pruned_params': 37168644, 'remaining_params': 47848956, 'pruned_model_sparsity': 0.4371876411472448, 'expected_sparsity': 0.43342, 'target_sparsity': 0.4430970149253731, 'step': 2600}


Iteration:  70%|███████   | 188/268 [00:50<01:37,  1.22s/it][A04/30/2024 10:24:23 - INFO - trainer.trainer_mod_2 - v4 Global step: 2600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  71%|███████   | 189/268 [00:50<01:12,  1.09it/s][A
Iteration:  71%|███████   | 190/268 [00:50<00:54,  1.43it/s][A
Iteration:  71%|███████▏  | 191/268 [00:51<00:42,  1.82it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:33,  2.26it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:27,  2.72it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:23,  3.16it/s][A
Iteration:  73%|███████▎  | 195/268 [00:51<00:20,  3.57it/s][A
Iteration:  73%|███████▎  | 196/268 [00:52<00:18,  3.96it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:16,  4.24it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:15,  4.56it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:14,  4.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:13,  4.95it/s][A
Iteration:  75%|███████▌  | 201/268 [00:53<00:13,  5.00it/s][A
Iteration:  75%|███████▌  | 202/268 [00:53<00:13,  5.03it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:12,  5.01it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:12,  5.00it/s][A
Iteration:  76%|███████▋  | 205/268 [00:53<00:12,  5.06it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:12,  5.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:54<00:11,  5.15it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:11,  5.13it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  5.16it/s][A
Iteration:  78%|███████▊  | 210/268 [00:54<00:11,  4.85it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:11,  4.97it/s][A
Iteration:  79%|███████▉  | 212/268 [00:55<00:12,  4.58it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:11,  4.66it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:11,  4.90it/s][A
Iteration:  80%|████████  | 215/268 [00:55<00:10,  5.00it/s][A
Iteration:  81%|████████  | 216/268 [00:56<00:10,  4.86it/s][A
Iteration:  81%|████████  | 217/268 [00:56<00:10,  5.04it/s][A
Iteration:  81%|████████▏ | 218/268 [00:56<00:09,  5.12it/s][A
Iteration:  82%|████████▏ | 219/268 [00:56<00:09,  5.17it/s][A
Iteration:  82%|████████▏ | 220/268 [00:56<00:09,  5.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:56<00:09,  5.20it/s][A
Iteration:  83%|████████▎ | 222/268 [00:57<00:09,  5.11it/s][A
Iteration:  83%|████████▎ | 223/268 [00:57<00:08,  5.16it/s][A
Iteration:  84%|████████▎ | 224/268 [00:57<00:08,  5.19it/s][A
Iteration:  84%|████████▍ | 225/268 [00:57<00:08,  5.12it/s][A
Iteration:  84%|████████▍ | 226/268 [00:57<00:08,  5.03it/s][A
Iteration:  85%|████████▍ | 227/268 [00:58<00:08,  5.06it/s][A
Iteration:  85%|████████▌ | 228/268 [00:58<00:07,  5.09it/s][A
Iteration:  85%|████████▌ | 229/268 [00:58<00:07,  5.10it/s][A
Iteration:  86%|████████▌ | 230/268 [00:58<00:07,  5.03it/s][A
Iteration:  86%|████████▌ | 231/268 [00:58<00:07,  4.99it/s][A
Iteration:  87%|████████▋ | 232/268 [00:59<00:06,  5.15it/s][A
Iteration:  87%|████████▋ | 233/268 [00:59<00:06,  5.12it/s][A
Iteration:  87%|████████▋ | 234/268 [00:59<00:06,  5.13it/s][A
Iteration:  88%|████████▊ | 235/268 [00:59<00:06,  5.26it/s][A
Iteration:  88%|████████▊ | 236/268 [00:59<00:06,  5.16it/s][A
Iteration:  88%|████████▊ | 237/268 [01:00<00:05,  5.18it/s][A[INFO|trainer.py:570] 2024-04-30 10:24:33,110 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:24:33 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:24:33 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:24:33 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:24:33 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:24:36 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:24:36 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.48569858867371524, 'eval_loss': 1.0633211, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1624, 1713, 1959, 2005, 1996, 2008, 1775, 1498, 769, 2336, 1946, 1037], 'head_nums': [12, 10, 8, 12, 11, 12, 12, 11, 10, 5, 4, 10], 'pruned_params': 38562764, 'remaining_params': 46454836, 'pruned_model_sparsity': 0.4535856575579645, 'expected_sparsity': 0.45082, 'target_sparsity': 0.4519589552238806, 'step': 2650}


Iteration:  89%|████████▉ | 238/268 [01:03<00:36,  1.22s/it][A
Iteration:  89%|████████▉ | 239/268 [01:03<00:26,  1.09it/s][A
Iteration:  90%|████████▉ | 240/268 [01:04<00:19,  1.43it/s][A
Iteration:  90%|████████▉ | 241/268 [01:04<00:14,  1.82it/s][A
Iteration:  90%|█████████ | 242/268 [01:04<00:11,  2.25it/s][A
Iteration:  91%|█████████ | 243/268 [01:04<00:09,  2.66it/s][A
Iteration:  91%|█████████ | 244/268 [01:04<00:07,  3.13it/s][A
Iteration:  91%|█████████▏| 245/268 [01:05<00:06,  3.56it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:05,  3.94it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:04,  4.25it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:04,  4.48it/s][A
Iteration:  93%|█████████▎| 249/268 [01:05<00:04,  4.51it/s][A
Iteration:  93%|█████████▎| 250/268 [01:06<00:03,  4.53it/s][A
Iteration:  94%|█████████▎| 251/268 [01:06<00:03,  4.60it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:03,  4.75it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:03,  4.88it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:02,  4.99it/s][A
Iteration:  95%|█████████▌| 255/268 [01:07<00:02,  5.07it/s][A
Iteration:  96%|█████████▌| 256/268 [01:07<00:02,  5.09it/s][A
Iteration:  96%|█████████▌| 257/268 [01:07<00:02,  5.04it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:01,  5.05it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  5.13it/s][A
Iteration:  97%|█████████▋| 260/268 [01:08<00:01,  5.09it/s][A
Iteration:  97%|█████████▋| 261/268 [01:08<00:01,  5.16it/s][A
Iteration:  98%|█████████▊| 262/268 [01:08<00:01,  5.03it/s][A
Iteration:  98%|█████████▊| 263/268 [01:08<00:01,  4.94it/s][A
Iteration:  99%|█████████▊| 264/268 [01:08<00:00,  5.00it/s][A
Iteration:  99%|█████████▉| 265/268 [01:09<00:00,  5.05it/s][A
Iteration:  99%|█████████▉| 266/268 [01:09<00:00,  5.11it/s][A
Iteration: 100%|█████████▉| 267/268 [01:09<00:00,  5.15it/s][A
Iteration: 100%|██████████| 268/268 [01:09<00:00,  5.65it/s][A04/30/2024 10:24:42 - INFO - trainer.trainer_mod_2 - Epoch 9 finished. Took 69.61 seconds.
Iteration: 100%|██████████| 268/268 [01:09<00:00,  3.85it/s]
Epoch:  10%|█         | 10/100 [11:48<1:47:00, 71.34s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:52,  5.13it/s][A
Iteration:   1%|          | 2/268 [00:00<00:51,  5.13it/s][A
Iteration:   1%|          | 3/268 [00:00<00:52,  5.00it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:51,  5.11it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.26it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:50,  5.22it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:51,  5.07it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:53,  4.90it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:51,  5.00it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:51,  5.04it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:50,  5.11it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:50,  5.06it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:50,  5.06it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:49,  5.08it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:49,  5.10it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:48,  5.14it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:49,  5.10it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:49,  5.05it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:50,  4.95it/s][A[INFO|trainer.py:570] 2024-04-30 10:24:46,361 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:24:46 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:24:46 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:24:46 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:24:46 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.53it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.62it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.67it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:24:49 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:24:49 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4906072440609618, 'eval_loss': 1.0202714, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1560, 1652, 1904, 1956, 1946, 1957, 1719, 1439, 722, 2284, 1868, 984], 'head_nums': [12, 9, 7, 12, 11, 12, 12, 11, 10, 4, 4, 9], 'pruned_params': 40100892, 'remaining_params': 44916708, 'pruned_model_sparsity': 0.4716775350045167, 'expected_sparsity': 0.46683, 'target_sparsity': 0.46082089552238803, 'step': 2700}


Iteration:   7%|▋         | 20/268 [00:07<05:04,  1.23s/it][A04/30/2024 10:24:49 - INFO - trainer.trainer_mod_2 - v4 Global step: 2700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   8%|▊         | 21/268 [00:07<03:47,  1.09it/s][A
Iteration:   8%|▊         | 22/268 [00:07<02:53,  1.42it/s][A
Iteration:   9%|▊         | 23/268 [00:07<02:15,  1.81it/s][A
Iteration:   9%|▉         | 24/268 [00:08<01:49,  2.22it/s][A
Iteration:   9%|▉         | 25/268 [00:08<01:30,  2.68it/s][A
Iteration:  10%|▉         | 26/268 [00:08<01:17,  3.13it/s][A
Iteration:  10%|█         | 27/268 [00:08<01:08,  3.53it/s][A
Iteration:  10%|█         | 28/268 [00:08<01:01,  3.93it/s][A
Iteration:  11%|█         | 29/268 [00:09<00:56,  4.20it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:53,  4.48it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:50,  4.66it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:48,  4.83it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:47,  4.90it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<00:47,  4.93it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:46,  4.96it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:45,  5.05it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:45,  5.04it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:44,  5.19it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<00:43,  5.21it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:42,  5.31it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:43,  5.18it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:43,  5.15it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:45,  4.96it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:43,  5.13it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:43,  5.18it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:42,  5.22it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:42,  5.22it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:41,  5.25it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<00:42,  5.15it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.14it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:41,  5.20it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:40,  5.35it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:41,  5.13it/s][A
Iteration:  20%|██        | 54/268 [00:14<00:42,  5.06it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:42,  5.00it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:41,  5.08it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:41,  5.09it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:40,  5.22it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:38,  5.37it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:40,  5.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:40,  5.12it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:39,  5.17it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:40,  5.10it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:40,  4.98it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:40,  5.03it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:39,  5.10it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:38,  5.16it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:38,  5.15it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:39,  5.08it/s][A[INFO|trainer.py:570] 2024-04-30 10:24:59,528 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:24:59 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:24:59 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:24:59 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:24:59 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.67it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.66it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.67it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:25:02 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:25:02 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4606649271937996, 'eval_loss': 1.1101013, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1501, 1594, 1853, 1910, 1898, 1908, 1663, 1384, 681, 2232, 1793, 937], 'head_nums': [12, 9, 7, 12, 11, 12, 12, 11, 10, 4, 3, 9], 'pruned_params': 41006304, 'remaining_params': 44011296, 'pruned_model_sparsity': 0.4823272357723577, 'expected_sparsity': 0.47999, 'target_sparsity': 0.46968283582089554, 'step': 2750}


Iteration:  26%|██▌       | 70/268 [00:20<04:02,  1.22s/it][A
Iteration:  26%|██▋       | 71/268 [00:20<03:00,  1.09it/s][A
Iteration:  27%|██▋       | 72/268 [00:20<02:17,  1.43it/s][A
Iteration:  27%|██▋       | 73/268 [00:21<01:45,  1.84it/s][A
Iteration:  28%|██▊       | 74/268 [00:21<01:25,  2.27it/s][A
Iteration:  28%|██▊       | 75/268 [00:21<01:09,  2.76it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<00:59,  3.25it/s][A
Iteration:  29%|██▊       | 77/268 [00:21<00:52,  3.66it/s][A
Iteration:  29%|██▉       | 78/268 [00:22<00:47,  4.01it/s][A
Iteration:  29%|██▉       | 79/268 [00:22<00:45,  4.19it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<00:42,  4.44it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:40,  4.66it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:39,  4.74it/s][A
Iteration:  31%|███       | 83/268 [00:23<00:38,  4.82it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:37,  4.85it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:36,  4.96it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:36,  5.05it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:35,  5.08it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:35,  5.13it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:35,  5.06it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:34,  5.09it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:34,  5.06it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:33,  5.21it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:34,  5.03it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:35,  4.94it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:34,  5.04it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:33,  5.18it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:32,  5.20it/s][A
Iteration:  37%|███▋      | 98/268 [00:25<00:32,  5.29it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:33,  5.06it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:32,  5.20it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:31,  5.23it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:31,  5.24it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:31,  5.22it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:31,  5.16it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:32,  5.02it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:31,  5.09it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:31,  5.17it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:30,  5.21it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:30,  5.25it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:29,  5.35it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:29,  5.34it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:29,  5.32it/s][A
Iteration:  42%|████▏     | 113/268 [00:28<00:29,  5.26it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:29,  5.22it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:29,  5.14it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:28,  5.34it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:29,  5.13it/s][A
Iteration:  44%|████▍     | 118/268 [00:29<00:29,  5.03it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:29,  5.08it/s][A[INFO|trainer.py:570] 2024-04-30 10:25:12,661 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:25:12 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:25:12 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:25:12 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:25:12 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:25:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:25:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5133671754762063, 'eval_loss': 0.9512337, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1448, 1543, 1805, 1866, 1854, 1865, 1613, 1334, 646, 2179, 1721, 893], 'head_nums': [12, 8, 6, 12, 11, 12, 12, 11, 10, 4, 3, 8], 'pruned_params': 42234968, 'remaining_params': 42782632, 'pruned_model_sparsity': 0.4967791139716953, 'expected_sparsity': 0.49126, 'target_sparsity': 0.47854477611940294, 'step': 2800}


Iteration:  45%|████▍     | 120/268 [00:33<03:01,  1.23s/it][A04/30/2024 10:25:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 2800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  45%|████▌     | 121/268 [00:33<02:14,  1.09it/s][A
Iteration:  46%|████▌     | 122/268 [00:34<01:42,  1.43it/s][A
Iteration:  46%|████▌     | 123/268 [00:34<01:19,  1.83it/s][A
Iteration:  46%|████▋     | 124/268 [00:34<01:03,  2.27it/s][A
Iteration:  47%|████▋     | 125/268 [00:34<00:52,  2.74it/s][A
Iteration:  47%|████▋     | 126/268 [00:34<00:44,  3.19it/s][A
Iteration:  47%|████▋     | 127/268 [00:35<00:39,  3.60it/s][A
Iteration:  48%|████▊     | 128/268 [00:35<00:35,  3.92it/s][A
Iteration:  48%|████▊     | 129/268 [00:35<00:34,  4.07it/s][A
Iteration:  49%|████▊     | 130/268 [00:35<00:32,  4.29it/s][A
Iteration:  49%|████▉     | 131/268 [00:35<00:30,  4.52it/s][A
Iteration:  49%|████▉     | 132/268 [00:36<00:29,  4.62it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<00:28,  4.81it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:27,  4.94it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:27,  4.92it/s][A
Iteration:  51%|█████     | 136/268 [00:36<00:26,  4.93it/s][A
Iteration:  51%|█████     | 137/268 [00:37<00:26,  4.93it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:26,  4.83it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:26,  4.93it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:25,  5.10it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:24,  5.11it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:24,  5.13it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:24,  5.12it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:24,  5.01it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:23,  5.15it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:23,  5.18it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<00:23,  5.19it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:22,  5.24it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:22,  5.25it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:22,  5.22it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:22,  5.23it/s][A
Iteration:  57%|█████▋    | 152/268 [00:39<00:23,  5.01it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:23,  4.92it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:22,  5.00it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:22,  5.04it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:21,  5.11it/s][A
Iteration:  59%|█████▊    | 157/268 [00:40<00:21,  5.13it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:21,  5.13it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:20,  5.24it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:20,  5.19it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:20,  5.28it/s][A
Iteration:  60%|██████    | 162/268 [00:41<00:20,  5.25it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:19,  5.28it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:20,  5.14it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:20,  5.08it/s][A
Iteration:  62%|██████▏   | 166/268 [00:42<00:19,  5.14it/s][A
Iteration:  62%|██████▏   | 167/268 [00:42<00:18,  5.32it/s][A
Iteration:  63%|██████▎   | 168/268 [00:43<00:19,  5.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:19,  5.19it/s][A[INFO|trainer.py:570] 2024-04-30 10:25:25,860 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:25:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:25:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:25:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:25:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:25:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:25:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49452574198897287, 'eval_loss': 0.9076988, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1400, 1497, 1761, 1825, 1813, 1825, 1568, 1289, 616, 2128, 1652, 854], 'head_nums': [12, 8, 6, 12, 11, 12, 12, 11, 9, 4, 3, 8], 'pruned_params': 43013224, 'remaining_params': 42004376, 'pruned_model_sparsity': 0.5059331714844926, 'expected_sparsity': 0.5013, 'target_sparsity': 0.48740671641791045, 'step': 2850}


Iteration:  63%|██████▎   | 170/268 [00:46<01:59,  1.22s/it][A
Iteration:  64%|██████▍   | 171/268 [00:47<01:28,  1.09it/s][A
Iteration:  64%|██████▍   | 172/268 [00:47<01:07,  1.43it/s][A
Iteration:  65%|██████▍   | 173/268 [00:47<00:52,  1.82it/s][A
Iteration:  65%|██████▍   | 174/268 [00:47<00:41,  2.25it/s][A
Iteration:  65%|██████▌   | 175/268 [00:47<00:33,  2.76it/s][A
Iteration:  66%|██████▌   | 176/268 [00:48<00:28,  3.21it/s][A
Iteration:  66%|██████▌   | 177/268 [00:48<00:25,  3.62it/s][A
Iteration:  66%|██████▋   | 178/268 [00:48<00:23,  3.85it/s][A
Iteration:  67%|██████▋   | 179/268 [00:48<00:21,  4.12it/s][A
Iteration:  67%|██████▋   | 180/268 [00:48<00:20,  4.25it/s][A
Iteration:  68%|██████▊   | 181/268 [00:49<00:19,  4.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:49<00:18,  4.69it/s][A
Iteration:  68%|██████▊   | 183/268 [00:49<00:17,  4.93it/s][A
Iteration:  69%|██████▊   | 184/268 [00:49<00:16,  4.99it/s][A
Iteration:  69%|██████▉   | 185/268 [00:49<00:16,  5.16it/s][A
Iteration:  69%|██████▉   | 186/268 [00:49<00:15,  5.20it/s][A
Iteration:  70%|██████▉   | 187/268 [00:50<00:15,  5.20it/s][A
Iteration:  70%|███████   | 188/268 [00:50<00:15,  5.23it/s][A
Iteration:  71%|███████   | 189/268 [00:50<00:14,  5.33it/s][A
Iteration:  71%|███████   | 190/268 [00:50<00:14,  5.41it/s][A
Iteration:  71%|███████▏  | 191/268 [00:50<00:14,  5.32it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:15,  4.95it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:15,  4.92it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:14,  5.02it/s][A
Iteration:  73%|███████▎  | 195/268 [00:51<00:14,  5.06it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:14,  5.11it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:14,  5.00it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:14,  4.92it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:13,  5.03it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:13,  5.10it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:13,  5.11it/s][A
Iteration:  75%|███████▌  | 202/268 [00:53<00:12,  5.14it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:12,  5.19it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:12,  4.98it/s][A
Iteration:  76%|███████▋  | 205/268 [00:53<00:12,  5.06it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:12,  5.08it/s][A
Iteration:  77%|███████▋  | 207/268 [00:54<00:12,  4.99it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:12,  4.95it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  5.01it/s][A
Iteration:  78%|███████▊  | 210/268 [00:54<00:11,  5.06it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:11,  5.10it/s][A
Iteration:  79%|███████▉  | 212/268 [00:55<00:10,  5.12it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:10,  5.13it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:10,  5.15it/s][A
Iteration:  80%|████████  | 215/268 [00:55<00:10,  5.17it/s][A
Iteration:  81%|████████  | 216/268 [00:55<00:10,  5.19it/s][A
Iteration:  81%|████████  | 217/268 [00:56<00:10,  4.73it/s][A
Iteration:  81%|████████▏ | 218/268 [00:56<00:10,  4.79it/s][A
Iteration:  82%|████████▏ | 219/268 [00:56<00:10,  4.89it/s][A[INFO|trainer.py:570] 2024-04-30 10:25:39,132 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:25:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:25:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:25:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:25:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:25:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:25:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.48082075308138933, 'eval_loss': 0.8701868, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1357, 1455, 1722, 1788, 1775, 1788, 1527, 1249, 591, 2078, 1587, 818], 'head_nums': [12, 8, 6, 12, 11, 12, 12, 11, 8, 4, 3, 8], 'pruned_params': 43733264, 'remaining_params': 41284336, 'pruned_model_sparsity': 0.5144024766636556, 'expected_sparsity': 0.50985, 'target_sparsity': 0.49626865671641784, 'step': 2900}


Iteration:  82%|████████▏ | 220/268 [01:00<00:59,  1.23s/it][A04/30/2024 10:25:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 2900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  82%|████████▏ | 221/268 [01:00<00:43,  1.09it/s][A
Iteration:  83%|████████▎ | 222/268 [01:00<00:32,  1.42it/s][A
Iteration:  83%|████████▎ | 223/268 [01:00<00:25,  1.79it/s][A
Iteration:  84%|████████▎ | 224/268 [01:00<00:19,  2.24it/s][A
Iteration:  84%|████████▍ | 225/268 [01:01<00:15,  2.69it/s][A
Iteration:  84%|████████▍ | 226/268 [01:01<00:13,  3.13it/s][A
Iteration:  85%|████████▍ | 227/268 [01:01<00:11,  3.52it/s][A
Iteration:  85%|████████▌ | 228/268 [01:01<00:10,  3.82it/s][A
Iteration:  85%|████████▌ | 229/268 [01:01<00:09,  4.14it/s][A
Iteration:  86%|████████▌ | 230/268 [01:02<00:08,  4.36it/s][A
Iteration:  86%|████████▌ | 231/268 [01:02<00:08,  4.57it/s][A
Iteration:  87%|████████▋ | 232/268 [01:02<00:07,  4.63it/s][A
Iteration:  87%|████████▋ | 233/268 [01:02<00:07,  4.82it/s][A
Iteration:  87%|████████▋ | 234/268 [01:02<00:06,  4.95it/s][A
Iteration:  88%|████████▊ | 235/268 [01:03<00:06,  5.12it/s][A
Iteration:  88%|████████▊ | 236/268 [01:03<00:06,  5.11it/s][A
Iteration:  88%|████████▊ | 237/268 [01:03<00:06,  5.08it/s][A
Iteration:  89%|████████▉ | 238/268 [01:03<00:05,  5.03it/s][A
Iteration:  89%|████████▉ | 239/268 [01:03<00:05,  5.11it/s][A
Iteration:  90%|████████▉ | 240/268 [01:04<00:05,  5.07it/s][A
Iteration:  90%|████████▉ | 241/268 [01:04<00:05,  5.21it/s][A
Iteration:  90%|█████████ | 242/268 [01:04<00:05,  5.19it/s][A
Iteration:  91%|█████████ | 243/268 [01:04<00:04,  5.05it/s][A
Iteration:  91%|█████████ | 244/268 [01:04<00:04,  5.13it/s][A
Iteration:  91%|█████████▏| 245/268 [01:05<00:04,  5.14it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:04,  5.17it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:04,  5.11it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:03,  5.12it/s][A
Iteration:  93%|█████████▎| 249/268 [01:05<00:03,  5.17it/s][A
Iteration:  93%|█████████▎| 250/268 [01:06<00:03,  5.22it/s][A
Iteration:  94%|█████████▎| 251/268 [01:06<00:03,  4.92it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:03,  4.94it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:02,  5.11it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:02,  5.14it/s][A
Iteration:  95%|█████████▌| 255/268 [01:07<00:02,  5.15it/s][A
Iteration:  96%|█████████▌| 256/268 [01:07<00:02,  5.13it/s][A
Iteration:  96%|█████████▌| 257/268 [01:07<00:02,  5.14it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:01,  5.25it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  5.35it/s][A
Iteration:  97%|█████████▋| 260/268 [01:07<00:01,  5.24it/s][A
Iteration:  97%|█████████▋| 261/268 [01:08<00:01,  5.40it/s][A
Iteration:  98%|█████████▊| 262/268 [01:08<00:01,  5.30it/s][A
Iteration:  98%|█████████▊| 263/268 [01:08<00:00,  5.29it/s][A
Iteration:  99%|█████████▊| 264/268 [01:08<00:00,  5.24it/s][A
Iteration:  99%|█████████▉| 265/268 [01:08<00:00,  5.22it/s][A
Iteration:  99%|█████████▉| 266/268 [01:09<00:00,  5.16it/s][A
Iteration: 100%|█████████▉| 267/268 [01:09<00:00,  5.21it/s][A
Iteration: 100%|██████████| 268/268 [01:09<00:00,  5.63it/s][A04/30/2024 10:25:51 - INFO - trainer.trainer_mod_2 - Epoch 10 finished. Took 69.46 seconds.
Iteration: 100%|██████████| 268/268 [01:09<00:00,  3.86it/s]
Epoch:  11%|█         | 11/100 [12:58<1:44:57, 70.76s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:56,  4.73it/s][A[INFO|trainer.py:570] 2024-04-30 10:25:52,269 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:25:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:25:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:25:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:25:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:25:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:25:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.510463005785497, 'eval_loss': 0.8899324, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1319, 1418, 1687, 1755, 1741, 1754, 1489, 1214, 569, 2029, 1525, 786], 'head_nums': [12, 8, 6, 12, 11, 12, 12, 11, 8, 4, 3, 8], 'pruned_params': 44202056, 'remaining_params': 40815544, 'pruned_model_sparsity': 0.5199165349292382, 'expected_sparsity': 0.51722, 'target_sparsity': 0.5051305970149254, 'step': 2950}


Iteration:   1%|          | 2/268 [00:03<09:49,  2.22s/it][A
Iteration:   1%|          | 3/268 [00:04<05:40,  1.29s/it][A
Iteration:   1%|▏         | 4/268 [00:04<03:45,  1.17it/s][A
Iteration:   2%|▏         | 5/268 [00:04<02:41,  1.62it/s][A
Iteration:   2%|▏         | 6/268 [00:04<02:04,  2.11it/s][A
Iteration:   3%|▎         | 7/268 [00:04<01:39,  2.62it/s][A
Iteration:   3%|▎         | 8/268 [00:04<01:22,  3.15it/s][A
Iteration:   3%|▎         | 9/268 [00:05<01:12,  3.57it/s][A
Iteration:   4%|▎         | 10/268 [00:05<01:05,  3.94it/s][A
Iteration:   4%|▍         | 11/268 [00:05<01:00,  4.28it/s][A
Iteration:   4%|▍         | 12/268 [00:05<00:56,  4.55it/s][A
Iteration:   5%|▍         | 13/268 [00:05<00:54,  4.72it/s][A
Iteration:   5%|▌         | 14/268 [00:06<00:52,  4.84it/s][A
Iteration:   6%|▌         | 15/268 [00:06<00:50,  4.99it/s][A
Iteration:   6%|▌         | 16/268 [00:06<00:50,  4.99it/s][A
Iteration:   6%|▋         | 17/268 [00:06<00:49,  5.06it/s][A
Iteration:   7%|▋         | 18/268 [00:06<00:48,  5.13it/s][A
Iteration:   7%|▋         | 19/268 [00:07<00:49,  5.07it/s][A
Iteration:   7%|▋         | 20/268 [00:07<00:46,  5.28it/s][A
Iteration:   8%|▊         | 21/268 [00:07<00:48,  5.06it/s][A
Iteration:   8%|▊         | 22/268 [00:07<00:47,  5.13it/s][A
Iteration:   9%|▊         | 23/268 [00:07<00:47,  5.18it/s][A
Iteration:   9%|▉         | 24/268 [00:08<00:46,  5.20it/s][A
Iteration:   9%|▉         | 25/268 [00:08<00:46,  5.19it/s][A
Iteration:  10%|▉         | 26/268 [00:08<00:47,  5.13it/s][A
Iteration:  10%|█         | 27/268 [00:08<00:47,  5.05it/s][A
Iteration:  10%|█         | 28/268 [00:08<00:45,  5.28it/s][A
Iteration:  11%|█         | 29/268 [00:09<00:45,  5.30it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:44,  5.29it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:44,  5.37it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:44,  5.34it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:45,  5.11it/s][A
Iteration:  13%|█▎        | 34/268 [00:09<00:45,  5.13it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:45,  5.12it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:48,  4.82it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:47,  4.88it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:46,  4.98it/s][A
Iteration:  15%|█▍        | 39/268 [00:10<00:45,  5.03it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:46,  4.89it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:44,  5.06it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:44,  5.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:42,  5.25it/s][A
Iteration:  16%|█▋        | 44/268 [00:11<00:44,  5.04it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:45,  4.93it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:44,  4.98it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:43,  5.03it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:43,  5.05it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:42,  5.14it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.18it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:41,  5.22it/s][A[INFO|trainer.py:570] 2024-04-30 10:26:05,398 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:26:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:26:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:26:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:26:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:26:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:26:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.46233271447102253, 'eval_loss': 1.0478237, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1285, 1382, 1653, 1723, 1709, 1721, 1454, 1180, 550, 1981, 1467, 756], 'head_nums': [12, 7, 6, 12, 11, 12, 12, 10, 8, 4, 3, 8], 'pruned_params': 45036996, 'remaining_params': 39980604, 'pruned_model_sparsity': 0.5297373249774164, 'expected_sparsity': 0.52466, 'target_sparsity': 0.5139925373134328, 'step': 3000}


Iteration:  19%|█▉        | 52/268 [00:16<04:23,  1.22s/it][A04/30/2024 10:26:08 - INFO - trainer.trainer_mod_2 - v4 Global step: 3000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  20%|█▉        | 53/268 [00:17<03:16,  1.09it/s][A
Iteration:  20%|██        | 54/268 [00:17<02:28,  1.44it/s][A
Iteration:  21%|██        | 55/268 [00:17<01:57,  1.81it/s][A
Iteration:  21%|██        | 56/268 [00:17<01:35,  2.23it/s][A
Iteration:  21%|██▏       | 57/268 [00:17<01:17,  2.72it/s][A
Iteration:  22%|██▏       | 58/268 [00:18<01:05,  3.21it/s][A
Iteration:  22%|██▏       | 59/268 [00:18<00:59,  3.51it/s][A
Iteration:  22%|██▏       | 60/268 [00:18<00:52,  3.95it/s][A
Iteration:  23%|██▎       | 61/268 [00:18<00:49,  4.20it/s][A
Iteration:  23%|██▎       | 62/268 [00:18<00:46,  4.39it/s][A
Iteration:  24%|██▎       | 63/268 [00:19<00:44,  4.63it/s][A
Iteration:  24%|██▍       | 64/268 [00:19<00:42,  4.78it/s][A
Iteration:  24%|██▍       | 65/268 [00:19<00:41,  4.90it/s][A
Iteration:  25%|██▍       | 66/268 [00:19<00:40,  5.01it/s][A
Iteration:  25%|██▌       | 67/268 [00:19<00:38,  5.17it/s][A
Iteration:  25%|██▌       | 68/268 [00:20<00:38,  5.14it/s][A
Iteration:  26%|██▌       | 69/268 [00:20<00:38,  5.14it/s][A
Iteration:  26%|██▌       | 70/268 [00:20<00:39,  5.00it/s][A
Iteration:  26%|██▋       | 71/268 [00:20<00:39,  5.02it/s][A
Iteration:  27%|██▋       | 72/268 [00:20<00:38,  5.11it/s][A
Iteration:  27%|██▋       | 73/268 [00:21<00:37,  5.16it/s][A
Iteration:  28%|██▊       | 74/268 [00:21<00:37,  5.16it/s][A
Iteration:  28%|██▊       | 75/268 [00:21<00:37,  5.16it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<00:37,  5.06it/s][A
Iteration:  29%|██▊       | 77/268 [00:21<00:38,  4.96it/s][A
Iteration:  29%|██▉       | 78/268 [00:22<00:37,  5.04it/s][A
Iteration:  29%|██▉       | 79/268 [00:22<00:36,  5.12it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<00:36,  5.16it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:37,  5.01it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:36,  5.05it/s][A
Iteration:  31%|███       | 83/268 [00:23<00:36,  5.01it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:36,  5.05it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:37,  4.95it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:36,  5.01it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:36,  4.97it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:35,  5.03it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:35,  5.01it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:35,  5.06it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:34,  5.06it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:35,  5.03it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:34,  5.04it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:34,  5.08it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:33,  5.10it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:33,  5.12it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:34,  5.00it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:33,  5.07it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:36,  4.67it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:34,  4.84it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:33,  4.94it/s][A[INFO|trainer.py:570] 2024-04-30 10:26:18,723 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:26:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:26:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:26:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:26:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:26:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:26:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5367064620897714, 'eval_loss': 0.98573864, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1253, 1349, 1622, 1693, 1679, 1692, 1422, 1152, 533, 1934, 1412, 730], 'head_nums': [12, 7, 6, 11, 11, 12, 12, 10, 8, 4, 3, 8], 'pruned_params': 45634476, 'remaining_params': 39383124, 'pruned_model_sparsity': 0.5367650462962963, 'expected_sparsity': 0.53212, 'target_sparsity': 0.5228544776119403, 'step': 3050}


Iteration:  38%|███▊      | 102/268 [00:30<03:24,  1.23s/it][A
Iteration:  38%|███▊      | 103/268 [00:30<02:31,  1.09it/s][A
Iteration:  39%|███▉      | 104/268 [00:30<01:55,  1.42it/s][A
Iteration:  39%|███▉      | 105/268 [00:30<01:29,  1.81it/s][A
Iteration:  40%|███▉      | 106/268 [00:31<01:11,  2.25it/s][A
Iteration:  40%|███▉      | 107/268 [00:31<00:59,  2.73it/s][A
Iteration:  40%|████      | 108/268 [00:31<00:50,  3.19it/s][A
Iteration:  41%|████      | 109/268 [00:31<00:44,  3.57it/s][A
Iteration:  41%|████      | 110/268 [00:31<00:40,  3.94it/s][A
Iteration:  41%|████▏     | 111/268 [00:32<00:37,  4.18it/s][A
Iteration:  42%|████▏     | 112/268 [00:32<00:34,  4.51it/s][A
Iteration:  42%|████▏     | 113/268 [00:32<00:32,  4.78it/s][A
Iteration:  43%|████▎     | 114/268 [00:32<00:31,  4.87it/s][A
Iteration:  43%|████▎     | 115/268 [00:32<00:30,  4.99it/s][A
Iteration:  43%|████▎     | 116/268 [00:32<00:30,  5.05it/s][A
Iteration:  44%|████▎     | 117/268 [00:33<00:28,  5.25it/s][A
Iteration:  44%|████▍     | 118/268 [00:33<00:28,  5.24it/s][A
Iteration:  44%|████▍     | 119/268 [00:33<00:28,  5.26it/s][A
Iteration:  45%|████▍     | 120/268 [00:33<00:28,  5.22it/s][A
Iteration:  45%|████▌     | 121/268 [00:33<00:27,  5.31it/s][A
Iteration:  46%|████▌     | 122/268 [00:34<00:27,  5.39it/s][A
Iteration:  46%|████▌     | 123/268 [00:34<00:27,  5.25it/s][A
Iteration:  46%|████▋     | 124/268 [00:34<00:27,  5.15it/s][A
Iteration:  47%|████▋     | 125/268 [00:34<00:27,  5.19it/s][A
Iteration:  47%|████▋     | 126/268 [00:34<00:27,  5.19it/s][A
Iteration:  47%|████▋     | 127/268 [00:35<00:27,  5.14it/s][A
Iteration:  48%|████▊     | 128/268 [00:35<00:27,  5.17it/s][A
Iteration:  48%|████▊     | 129/268 [00:35<00:27,  5.03it/s][A
Iteration:  49%|████▊     | 130/268 [00:35<00:28,  4.89it/s][A
Iteration:  49%|████▉     | 131/268 [00:35<00:28,  4.85it/s][A
Iteration:  49%|████▉     | 132/268 [00:36<00:27,  4.98it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<00:26,  5.07it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:25,  5.26it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:25,  5.27it/s][A
Iteration:  51%|█████     | 136/268 [00:36<00:25,  5.25it/s][A
Iteration:  51%|█████     | 137/268 [00:37<00:24,  5.27it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:24,  5.29it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:24,  5.25it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:24,  5.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:24,  5.21it/s][A
Iteration:  53%|█████▎    | 142/268 [00:37<00:24,  5.15it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:24,  5.18it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:24,  5.13it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:23,  5.33it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:22,  5.32it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<00:22,  5.40it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:22,  5.35it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:22,  5.32it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:22,  5.26it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:22,  5.24it/s][A[INFO|trainer.py:570] 2024-04-30 10:26:31,746 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:26:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:26:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:26:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:26:31 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:26:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:26:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5180539085272844, 'eval_loss': 0.9015993, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1225, 1320, 1594, 1665, 1652, 1664, 1392, 1124, 517, 1888, 1360, 704], 'head_nums': [11, 7, 6, 11, 11, 11, 12, 10, 8, 4, 3, 8], 'pruned_params': 46397412, 'remaining_params': 38620188, 'pruned_model_sparsity': 0.5457389058265583, 'expected_sparsity': 0.54034, 'target_sparsity': 0.5317164179104477, 'step': 3100}


Iteration:  57%|█████▋    | 152/268 [00:43<02:21,  1.22s/it][A04/30/2024 10:26:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 3100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  57%|█████▋    | 153/268 [00:43<01:45,  1.09it/s][A
Iteration:  57%|█████▋    | 154/268 [00:43<01:19,  1.43it/s][A
Iteration:  58%|█████▊    | 155/268 [00:43<01:01,  1.83it/s][A
Iteration:  58%|█████▊    | 156/268 [00:44<00:49,  2.27it/s][A
Iteration:  59%|█████▊    | 157/268 [00:44<00:40,  2.73it/s][A
Iteration:  59%|█████▉    | 158/268 [00:44<00:34,  3.16it/s][A
Iteration:  59%|█████▉    | 159/268 [00:44<00:30,  3.54it/s][A
Iteration:  60%|█████▉    | 160/268 [00:44<00:28,  3.80it/s][A
Iteration:  60%|██████    | 161/268 [00:45<00:25,  4.12it/s][A
Iteration:  60%|██████    | 162/268 [00:45<00:24,  4.34it/s][A
Iteration:  61%|██████    | 163/268 [00:45<00:22,  4.59it/s][A
Iteration:  61%|██████    | 164/268 [00:45<00:22,  4.68it/s][A
Iteration:  62%|██████▏   | 165/268 [00:45<00:21,  4.74it/s][A
Iteration:  62%|██████▏   | 166/268 [00:46<00:20,  4.89it/s][A
Iteration:  62%|██████▏   | 167/268 [00:46<00:20,  4.99it/s][A
Iteration:  63%|██████▎   | 168/268 [00:46<00:20,  4.89it/s][A
Iteration:  63%|██████▎   | 169/268 [00:46<00:19,  5.02it/s][A
Iteration:  63%|██████▎   | 170/268 [00:46<00:19,  4.96it/s][A
Iteration:  64%|██████▍   | 171/268 [00:47<00:19,  5.01it/s][A
Iteration:  64%|██████▍   | 172/268 [00:47<00:19,  4.99it/s][A
Iteration:  65%|██████▍   | 173/268 [00:47<00:18,  5.08it/s][A
Iteration:  65%|██████▍   | 174/268 [00:47<00:18,  5.00it/s][A
Iteration:  65%|██████▌   | 175/268 [00:47<00:18,  5.08it/s][A
Iteration:  66%|██████▌   | 176/268 [00:48<00:17,  5.14it/s][A
Iteration:  66%|██████▌   | 177/268 [00:48<00:17,  5.19it/s][A
Iteration:  66%|██████▋   | 178/268 [00:48<00:17,  5.09it/s][A
Iteration:  67%|██████▋   | 179/268 [00:48<00:17,  5.11it/s][A
Iteration:  67%|██████▋   | 180/268 [00:48<00:17,  5.15it/s][A
Iteration:  68%|██████▊   | 181/268 [00:49<00:16,  5.17it/s][A
Iteration:  68%|██████▊   | 182/268 [00:49<00:16,  5.16it/s][A
Iteration:  68%|██████▊   | 183/268 [00:49<00:16,  5.16it/s][A
Iteration:  69%|██████▊   | 184/268 [00:49<00:16,  5.17it/s][A
Iteration:  69%|██████▉   | 185/268 [00:49<00:16,  5.17it/s][A
Iteration:  69%|██████▉   | 186/268 [00:49<00:15,  5.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:50<00:15,  5.09it/s][A
Iteration:  70%|███████   | 188/268 [00:50<00:15,  5.11it/s][A
Iteration:  71%|███████   | 189/268 [00:50<00:15,  5.10it/s][A
Iteration:  71%|███████   | 190/268 [00:50<00:15,  5.11it/s][A
Iteration:  71%|███████▏  | 191/268 [00:51<00:15,  4.94it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:15,  4.88it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:14,  5.01it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:14,  5.06it/s][A
Iteration:  73%|███████▎  | 195/268 [00:51<00:14,  5.10it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:14,  5.14it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:13,  5.32it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:13,  5.33it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:13,  5.22it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:13,  5.20it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:12,  5.25it/s][A[INFO|trainer.py:570] 2024-04-30 10:26:45,019 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:26:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:26:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:26:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:26:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.68it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.67it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.78it/s]04/30/2024 10:26:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:26:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5084779139221436, 'eval_loss': 0.9345367, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1199, 1293, 1569, 1641, 1627, 1640, 1365, 1099, 503, 1844, 1310, 682], 'head_nums': [11, 7, 5, 11, 11, 11, 11, 9, 8, 4, 3, 8], 'pruned_params': 47318144, 'remaining_params': 37699456, 'pruned_model_sparsity': 0.5565688045769347, 'expected_sparsity': 0.54852, 'target_sparsity': 0.5405783582089552, 'step': 3150}


Iteration:  75%|███████▌  | 202/268 [00:56<01:21,  1.23s/it][A
Iteration:  76%|███████▌  | 203/268 [00:56<01:00,  1.08it/s][A
Iteration:  76%|███████▌  | 204/268 [00:56<00:45,  1.41it/s][A
Iteration:  76%|███████▋  | 205/268 [00:57<00:35,  1.79it/s][A
Iteration:  77%|███████▋  | 206/268 [00:57<00:27,  2.25it/s][A
Iteration:  77%|███████▋  | 207/268 [00:57<00:22,  2.69it/s][A
Iteration:  78%|███████▊  | 208/268 [00:57<00:19,  3.11it/s][A
Iteration:  78%|███████▊  | 209/268 [00:57<00:16,  3.53it/s][A
Iteration:  78%|███████▊  | 210/268 [00:58<00:14,  3.90it/s][A
Iteration:  79%|███████▊  | 211/268 [00:58<00:13,  4.24it/s][A
Iteration:  79%|███████▉  | 212/268 [00:58<00:12,  4.57it/s][A
Iteration:  79%|███████▉  | 213/268 [00:58<00:11,  4.69it/s][A
Iteration:  80%|███████▉  | 214/268 [00:58<00:11,  4.85it/s][A
Iteration:  80%|████████  | 215/268 [00:59<00:10,  4.97it/s][A
Iteration:  81%|████████  | 216/268 [00:59<00:10,  5.03it/s][A
Iteration:  81%|████████  | 217/268 [00:59<00:09,  5.17it/s][A
Iteration:  81%|████████▏ | 218/268 [00:59<00:09,  5.20it/s][A
Iteration:  82%|████████▏ | 219/268 [00:59<00:09,  5.00it/s][A
Iteration:  82%|████████▏ | 220/268 [01:00<00:09,  5.05it/s][A
Iteration:  82%|████████▏ | 221/268 [01:00<00:09,  5.12it/s][A
Iteration:  83%|████████▎ | 222/268 [01:00<00:08,  5.18it/s][A
Iteration:  83%|████████▎ | 223/268 [01:00<00:08,  5.11it/s][A
Iteration:  84%|████████▎ | 224/268 [01:00<00:08,  5.13it/s][A
Iteration:  84%|████████▍ | 225/268 [01:01<00:08,  5.03it/s][A
Iteration:  84%|████████▍ | 226/268 [01:01<00:08,  5.07it/s][A
Iteration:  85%|████████▍ | 227/268 [01:01<00:08,  5.08it/s][A
Iteration:  85%|████████▌ | 228/268 [01:01<00:07,  5.22it/s][A
Iteration:  85%|████████▌ | 229/268 [01:01<00:07,  5.21it/s][A
Iteration:  86%|████████▌ | 230/268 [01:02<00:07,  5.22it/s][A
Iteration:  86%|████████▌ | 231/268 [01:02<00:07,  5.20it/s][A
Iteration:  87%|████████▋ | 232/268 [01:02<00:06,  5.18it/s][A
Iteration:  87%|████████▋ | 233/268 [01:02<00:06,  5.12it/s][A
Iteration:  87%|████████▋ | 234/268 [01:02<00:06,  5.18it/s][A
Iteration:  88%|████████▊ | 235/268 [01:02<00:06,  5.20it/s][A
Iteration:  88%|████████▊ | 236/268 [01:03<00:06,  5.21it/s][A
Iteration:  88%|████████▊ | 237/268 [01:03<00:05,  5.25it/s][A
Iteration:  89%|████████▉ | 238/268 [01:03<00:05,  5.27it/s][A
Iteration:  89%|████████▉ | 239/268 [01:03<00:05,  5.35it/s][A
Iteration:  90%|████████▉ | 240/268 [01:03<00:05,  5.29it/s][A
Iteration:  90%|████████▉ | 241/268 [01:04<00:05,  5.25it/s][A
Iteration:  90%|█████████ | 242/268 [01:04<00:05,  5.18it/s][A
Iteration:  91%|█████████ | 243/268 [01:04<00:04,  5.17it/s][A
Iteration:  91%|█████████ | 244/268 [01:04<00:04,  5.27it/s][A
Iteration:  91%|█████████▏| 245/268 [01:04<00:04,  5.35it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:04,  5.32it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:04,  5.21it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:03,  5.24it/s][A
Iteration:  93%|█████████▎| 249/268 [01:05<00:03,  5.16it/s][A
Iteration:  93%|█████████▎| 250/268 [01:05<00:03,  5.20it/s][A
Iteration:  94%|█████████▎| 251/268 [01:06<00:03,  5.19it/s][A[INFO|trainer.py:570] 2024-04-30 10:26:58,106 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:26:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:26:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:26:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:26:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:27:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:27:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4999447014632779, 'eval_loss': 0.9300873, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1175, 1268, 1545, 1617, 1602, 1617, 1341, 1077, 491, 1801, 1263, 660], 'head_nums': [11, 7, 5, 10, 11, 11, 11, 9, 8, 4, 3, 8], 'pruned_params': 47825236, 'remaining_params': 37192364, 'pruned_model_sparsity': 0.5625333577988557, 'expected_sparsity': 0.55563, 'target_sparsity': 0.5494402985074626, 'step': 3200}


Iteration:  94%|█████████▍| 252/268 [01:09<00:19,  1.22s/it][A04/30/2024 10:27:01 - INFO - trainer.trainer_mod_2 - v4 Global step: 3200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  94%|█████████▍| 253/268 [01:09<00:13,  1.09it/s][A
Iteration:  95%|█████████▍| 254/268 [01:10<00:09,  1.43it/s][A
Iteration:  95%|█████████▌| 255/268 [01:10<00:07,  1.83it/s][A
Iteration:  96%|█████████▌| 256/268 [01:10<00:05,  2.30it/s][A
Iteration:  96%|█████████▌| 257/268 [01:10<00:03,  2.77it/s][A
Iteration:  96%|█████████▋| 258/268 [01:10<00:03,  3.18it/s][A
Iteration:  97%|█████████▋| 259/268 [01:11<00:02,  3.59it/s][A
Iteration:  97%|█████████▋| 260/268 [01:11<00:02,  3.93it/s][A
Iteration:  97%|█████████▋| 261/268 [01:11<00:01,  4.20it/s][A
Iteration:  98%|█████████▊| 262/268 [01:11<00:01,  4.39it/s][A
Iteration:  98%|█████████▊| 263/268 [01:11<00:01,  4.62it/s][A
Iteration:  99%|█████████▊| 264/268 [01:12<00:00,  4.70it/s][A
Iteration:  99%|█████████▉| 265/268 [01:12<00:00,  4.86it/s][A
Iteration:  99%|█████████▉| 266/268 [01:12<00:00,  4.90it/s][A
Iteration: 100%|█████████▉| 267/268 [01:12<00:00,  4.91it/s][A
Iteration: 100%|██████████| 268/268 [01:12<00:00,  5.38it/s][A04/30/2024 10:27:04 - INFO - trainer.trainer_mod_2 - Epoch 11 finished. Took 72.75 seconds.
Iteration: 100%|██████████| 268/268 [01:12<00:00,  3.68it/s]
Epoch:  12%|█▏        | 12/100 [14:10<1:44:40, 71.37s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:51,  5.15it/s][A
Iteration:   1%|          | 2/268 [00:00<00:51,  5.15it/s][A
Iteration:   1%|          | 3/268 [00:00<00:50,  5.21it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:50,  5.19it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.21it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:50,  5.21it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:51,  5.12it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:50,  5.13it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:50,  5.14it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:49,  5.25it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:48,  5.27it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:49,  5.14it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:49,  5.16it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:48,  5.27it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:48,  5.24it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:47,  5.34it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:48,  5.13it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:47,  5.31it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:47,  5.30it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:46,  5.37it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:47,  5.16it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:48,  5.09it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:48,  5.04it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:49,  4.88it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:49,  4.90it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:48,  4.97it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:47,  5.05it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:46,  5.13it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:47,  5.08it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:46,  5.11it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:45,  5.16it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:46,  5.09it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:45,  5.12it/s][A[INFO|trainer.py:570] 2024-04-30 10:27:11,224 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:27:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:27:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:27:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:27:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.65it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:27:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:27:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49911890185455493, 'eval_loss': 0.95936507, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1153, 1244, 1522, 1595, 1579, 1595, 1317, 1056, 480, 1758, 1217, 641], 'head_nums': [11, 7, 5, 10, 11, 11, 11, 9, 8, 4, 3, 8], 'pruned_params': 48119380, 'remaining_params': 36898220, 'pruned_model_sparsity': 0.5659931590635351, 'expected_sparsity': 0.56175, 'target_sparsity': 0.5583022388059701, 'step': 3250}


Iteration:  13%|█▎        | 34/268 [00:10<04:46,  1.22s/it][A
Iteration:  13%|█▎        | 35/268 [00:10<03:33,  1.09it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<02:42,  1.43it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<02:07,  1.81it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<01:42,  2.24it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<01:23,  2.73it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<01:12,  3.15it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<01:03,  3.57it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:57,  3.93it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:54,  4.15it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:52,  4.29it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:49,  4.51it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:47,  4.68it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:46,  4.78it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:44,  4.92it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:42,  5.10it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.14it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:40,  5.32it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:41,  5.25it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:42,  5.03it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:42,  5.06it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:41,  5.12it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:43,  4.85it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:42,  4.96it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:41,  5.07it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:40,  5.21it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:41,  5.04it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:41,  5.01it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:40,  5.05it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:39,  5.13it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:38,  5.26it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:39,  5.11it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:39,  5.12it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:38,  5.17it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:38,  5.17it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:37,  5.29it/s][A
Iteration:  26%|██▌       | 70/268 [00:17<00:38,  5.19it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:37,  5.22it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:37,  5.25it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:37,  5.22it/s][A
Iteration:  28%|██▊       | 74/268 [00:17<00:37,  5.18it/s][A
Iteration:  28%|██▊       | 75/268 [00:18<00:37,  5.10it/s][A
Iteration:  28%|██▊       | 76/268 [00:18<00:37,  5.15it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:36,  5.19it/s][A
Iteration:  29%|██▉       | 78/268 [00:18<00:36,  5.18it/s][A
Iteration:  29%|██▉       | 79/268 [00:18<00:36,  5.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:19<00:37,  5.03it/s][A
Iteration:  30%|███       | 81/268 [00:19<00:36,  5.10it/s][A
Iteration:  31%|███       | 82/268 [00:19<00:36,  5.13it/s][A
Iteration:  31%|███       | 83/268 [00:19<00:35,  5.25it/s][A[INFO|trainer.py:570] 2024-04-30 10:27:24,433 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:27:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:27:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:27:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:27:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:27:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:27:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5148604864718519, 'eval_loss': 0.9125888, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1131, 1221, 1501, 1572, 1557, 1573, 1294, 1036, 469, 1715, 1173, 622], 'head_nums': [11, 7, 5, 10, 11, 11, 11, 9, 8, 4, 3, 7], 'pruned_params': 48601960, 'remaining_params': 36415640, 'pruned_model_sparsity': 0.5716693955133996, 'expected_sparsity': 0.56743, 'target_sparsity': 0.5671641791044776, 'step': 3300}


Iteration:  31%|███▏      | 84/268 [00:23<03:46,  1.23s/it][A04/30/2024 10:27:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 3300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  32%|███▏      | 85/268 [00:23<02:47,  1.09it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<02:08,  1.42it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<01:40,  1.80it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<01:21,  2.22it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<01:06,  2.69it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:56,  3.14it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:49,  3.58it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:44,  3.91it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:42,  4.13it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:38,  4.48it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:37,  4.61it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:35,  4.78it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:35,  4.85it/s][A
Iteration:  37%|███▋      | 98/268 [00:25<00:34,  4.94it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:33,  5.05it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:32,  5.11it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:32,  5.08it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:31,  5.27it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:31,  5.21it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:31,  5.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:32,  5.07it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:32,  4.91it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:32,  4.90it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:31,  5.00it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:31,  4.99it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:32,  4.85it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:31,  5.05it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:30,  5.12it/s][A
Iteration:  42%|████▏     | 113/268 [00:28<00:30,  5.08it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:30,  5.04it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:29,  5.13it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:29,  5.07it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:29,  5.15it/s][A
Iteration:  44%|████▍     | 118/268 [00:29<00:30,  4.87it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:29,  5.07it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:29,  4.98it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:29,  4.96it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:29,  4.95it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:27,  5.18it/s][A
Iteration:  46%|████▋     | 124/268 [00:31<00:28,  5.12it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:27,  5.13it/s][A
Iteration:  47%|████▋     | 126/268 [00:31<00:27,  5.20it/s][A
Iteration:  47%|████▋     | 127/268 [00:31<00:27,  5.18it/s][A
Iteration:  48%|████▊     | 128/268 [00:31<00:27,  5.17it/s][A
Iteration:  48%|████▊     | 129/268 [00:32<00:26,  5.17it/s][A
Iteration:  49%|████▊     | 130/268 [00:32<00:26,  5.13it/s][A
Iteration:  49%|████▉     | 131/268 [00:32<00:27,  5.01it/s][A
Iteration:  49%|████▉     | 132/268 [00:32<00:27,  4.92it/s][A
Iteration:  50%|████▉     | 133/268 [00:32<00:27,  4.94it/s][A[INFO|trainer.py:570] 2024-04-30 10:27:37,726 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:27:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:27:37 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:27:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:27:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:27:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:27:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49380076678433954, 'eval_loss': 0.8452962, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1110, 1200, 1479, 1550, 1535, 1552, 1272, 1017, 460, 1672, 1128, 603], 'head_nums': [11, 7, 5, 10, 11, 11, 11, 8, 8, 4, 3, 7], 'pruned_params': 49072284, 'remaining_params': 35945316, 'pruned_model_sparsity': 0.5772014735772357, 'expected_sparsity': 0.5729, 'target_sparsity': 0.5760261194029851, 'step': 3350}


Iteration:  50%|█████     | 134/268 [00:36<02:44,  1.23s/it][A
Iteration:  50%|█████     | 135/268 [00:36<02:02,  1.09it/s][A
Iteration:  51%|█████     | 136/268 [00:36<01:32,  1.43it/s][A
Iteration:  51%|█████     | 137/268 [00:37<01:12,  1.81it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:57,  2.25it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:47,  2.69it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:41,  3.11it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:36,  3.45it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:32,  3.86it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:30,  4.09it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:28,  4.39it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:26,  4.57it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:25,  4.72it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:24,  4.89it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:23,  5.08it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:23,  5.09it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:23,  5.06it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:22,  5.20it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:22,  5.22it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.15it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:21,  5.18it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:21,  5.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:21,  5.19it/s][A
Iteration:  59%|█████▊    | 157/268 [00:41<00:21,  5.14it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:21,  5.20it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:20,  5.25it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:20,  5.20it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:20,  5.20it/s][A
Iteration:  60%|██████    | 162/268 [00:42<00:20,  5.05it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:20,  5.13it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:20,  5.08it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:20,  5.12it/s][A
Iteration:  62%|██████▏   | 166/268 [00:42<00:19,  5.19it/s][A
Iteration:  62%|██████▏   | 167/268 [00:42<00:19,  5.19it/s][A
Iteration:  63%|██████▎   | 168/268 [00:43<00:19,  5.20it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:18,  5.23it/s][A
Iteration:  63%|██████▎   | 170/268 [00:43<00:18,  5.26it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:17,  5.41it/s][A
Iteration:  64%|██████▍   | 172/268 [00:43<00:17,  5.36it/s][A
Iteration:  65%|██████▍   | 173/268 [00:44<00:17,  5.33it/s][A
Iteration:  65%|██████▍   | 174/268 [00:44<00:17,  5.39it/s][A
Iteration:  65%|██████▌   | 175/268 [00:44<00:17,  5.37it/s][A
Iteration:  66%|██████▌   | 176/268 [00:44<00:17,  5.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:44<00:17,  5.21it/s][A
Iteration:  66%|██████▋   | 178/268 [00:45<00:17,  5.23it/s][A
Iteration:  67%|██████▋   | 179/268 [00:45<00:17,  5.21it/s][A
Iteration:  67%|██████▋   | 180/268 [00:45<00:16,  5.20it/s][A
Iteration:  68%|██████▊   | 181/268 [00:45<00:16,  5.12it/s][A
Iteration:  68%|██████▊   | 182/268 [00:45<00:17,  5.04it/s][A
Iteration:  68%|██████▊   | 183/268 [00:46<00:16,  5.10it/s][A[INFO|trainer.py:570] 2024-04-30 10:27:50,848 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:27:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:27:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:27:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:27:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:27:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:27:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5008182856309368, 'eval_loss': 0.9349659, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1089, 1179, 1457, 1528, 1513, 1530, 1249, 996, 450, 1626, 1082, 584], 'head_nums': [10, 6, 5, 10, 11, 11, 11, 8, 8, 4, 3, 7], 'pruned_params': 49746364, 'remaining_params': 35271236, 'pruned_model_sparsity': 0.5851301848087925, 'expected_sparsity': 0.57886, 'target_sparsity': 0.5848880597014925, 'step': 3400}


Iteration:  69%|██████▊   | 184/268 [00:49<01:43,  1.23s/it][A04/30/2024 10:27:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 3400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  69%|██████▉   | 185/268 [00:49<01:16,  1.09it/s][A
Iteration:  69%|██████▉   | 186/268 [00:50<00:57,  1.44it/s][A
Iteration:  70%|██████▉   | 187/268 [00:50<00:44,  1.84it/s][A
Iteration:  70%|███████   | 188/268 [00:50<00:34,  2.29it/s][A
Iteration:  71%|███████   | 189/268 [00:50<00:28,  2.78it/s][A
Iteration:  71%|███████   | 190/268 [00:50<00:24,  3.22it/s][A
Iteration:  71%|███████▏  | 191/268 [00:50<00:21,  3.65it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:18,  4.07it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:17,  4.19it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:16,  4.54it/s][A
Iteration:  73%|███████▎  | 195/268 [00:51<00:15,  4.80it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:14,  4.94it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:14,  5.00it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:13,  5.16it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:13,  5.09it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:13,  5.15it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:12,  5.20it/s][A
Iteration:  75%|███████▌  | 202/268 [00:53<00:12,  5.19it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:12,  5.17it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:12,  5.19it/s][A
Iteration:  76%|███████▋  | 205/268 [00:53<00:11,  5.31it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:12,  5.09it/s][A
Iteration:  77%|███████▋  | 207/268 [00:54<00:11,  5.10it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:11,  5.25it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  5.33it/s][A
Iteration:  78%|███████▊  | 210/268 [00:54<00:10,  5.29it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:10,  5.26it/s][A
Iteration:  79%|███████▉  | 212/268 [00:54<00:10,  5.34it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:10,  5.13it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:10,  5.18it/s][A
Iteration:  80%|████████  | 215/268 [00:55<00:10,  5.11it/s][A
Iteration:  81%|████████  | 216/268 [00:55<00:10,  5.19it/s][A
Iteration:  81%|████████  | 217/268 [00:55<00:09,  5.18it/s][A
Iteration:  81%|████████▏ | 218/268 [00:56<00:09,  5.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:56<00:09,  5.08it/s][A
Iteration:  82%|████████▏ | 220/268 [00:56<00:09,  5.15it/s][A
Iteration:  82%|████████▏ | 221/268 [00:56<00:09,  5.20it/s][A
Iteration:  83%|████████▎ | 222/268 [00:56<00:09,  5.01it/s][A
Iteration:  83%|████████▎ | 223/268 [00:57<00:08,  5.04it/s][A
Iteration:  84%|████████▎ | 224/268 [00:57<00:08,  5.11it/s][A
Iteration:  84%|████████▍ | 225/268 [00:57<00:08,  5.12it/s][A
Iteration:  84%|████████▍ | 226/268 [00:57<00:08,  5.16it/s][A
Iteration:  85%|████████▍ | 227/268 [00:57<00:07,  5.28it/s][A
Iteration:  85%|████████▌ | 228/268 [00:58<00:07,  5.36it/s][A
Iteration:  85%|████████▌ | 229/268 [00:58<00:07,  5.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:58<00:07,  5.35it/s][A
Iteration:  86%|████████▌ | 231/268 [00:58<00:06,  5.29it/s][A
Iteration:  87%|████████▋ | 232/268 [00:58<00:06,  5.29it/s][A
Iteration:  87%|████████▋ | 233/268 [00:59<00:06,  5.25it/s][A[INFO|trainer.py:570] 2024-04-30 10:28:03,824 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:28:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:28:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:28:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:28:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:28:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:28:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5290419680495485, 'eval_loss': 0.8238643, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1068, 1157, 1435, 1506, 1491, 1507, 1226, 976, 440, 1577, 1035, 565], 'head_nums': [10, 6, 5, 10, 11, 11, 11, 8, 7, 4, 3, 7], 'pruned_params': 50225880, 'remaining_params': 34791720, 'pruned_model_sparsity': 0.5907703816621499, 'expected_sparsity': 0.58463, 'target_sparsity': 0.59375, 'step': 3450}


Iteration:  87%|████████▋ | 234/268 [01:02<00:41,  1.22s/it][A
Iteration:  88%|████████▊ | 235/268 [01:02<00:30,  1.10it/s][A
Iteration:  88%|████████▊ | 236/268 [01:03<00:22,  1.44it/s][A
Iteration:  88%|████████▊ | 237/268 [01:03<00:16,  1.84it/s][A
Iteration:  89%|████████▉ | 238/268 [01:03<00:13,  2.28it/s][A
Iteration:  89%|████████▉ | 239/268 [01:03<00:10,  2.75it/s][A
Iteration:  90%|████████▉ | 240/268 [01:03<00:08,  3.20it/s][A
Iteration:  90%|████████▉ | 241/268 [01:03<00:07,  3.67it/s][A
Iteration:  90%|█████████ | 242/268 [01:04<00:06,  4.02it/s][A
Iteration:  91%|█████████ | 243/268 [01:04<00:05,  4.27it/s][A
Iteration:  91%|█████████ | 244/268 [01:04<00:05,  4.50it/s][A
Iteration:  91%|█████████▏| 245/268 [01:04<00:04,  4.84it/s][A
Iteration:  92%|█████████▏| 246/268 [01:04<00:04,  4.86it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:04,  4.97it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:03,  5.05it/s][A
Iteration:  93%|█████████▎| 249/268 [01:05<00:03,  5.09it/s][A
Iteration:  93%|█████████▎| 250/268 [01:05<00:03,  5.15it/s][A
Iteration:  94%|█████████▎| 251/268 [01:05<00:03,  5.08it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:03,  5.04it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:02,  5.09it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:02,  5.11it/s][A
Iteration:  95%|█████████▌| 255/268 [01:06<00:02,  4.99it/s][A
Iteration:  96%|█████████▌| 256/268 [01:06<00:02,  5.04it/s][A
Iteration:  96%|█████████▌| 257/268 [01:07<00:02,  5.10it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:01,  5.12it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  5.16it/s][A
Iteration:  97%|█████████▋| 260/268 [01:07<00:01,  5.05it/s][A
Iteration:  97%|█████████▋| 261/268 [01:07<00:01,  5.11it/s][A
Iteration:  98%|█████████▊| 262/268 [01:08<00:01,  5.15it/s][A
Iteration:  98%|█████████▊| 263/268 [01:08<00:00,  5.18it/s][A
Iteration:  99%|█████████▊| 264/268 [01:08<00:00,  5.37it/s][A
Iteration:  99%|█████████▉| 265/268 [01:08<00:00,  5.49it/s][A
Iteration:  99%|█████████▉| 266/268 [01:08<00:00,  5.44it/s][A
Iteration: 100%|█████████▉| 267/268 [01:09<00:00,  4.88it/s][A
Iteration: 100%|██████████| 268/268 [01:09<00:00,  5.36it/s][A04/30/2024 10:28:13 - INFO - trainer.trainer_mod_2 - Epoch 12 finished. Took 69.17 seconds.
Iteration: 100%|██████████| 268/268 [01:09<00:00,  3.87it/s]
Epoch:  13%|█▎        | 13/100 [15:20<1:42:30, 70.70s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:50,  5.27it/s][A
Iteration:   1%|          | 2/268 [00:00<00:50,  5.26it/s][A
Iteration:   1%|          | 3/268 [00:00<00:49,  5.30it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:49,  5.30it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:49,  5.31it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:49,  5.25it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:51,  5.10it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:50,  5.17it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:51,  5.03it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:50,  5.07it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:51,  5.04it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:51,  5.00it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:50,  5.08it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:50,  4.99it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:50,  5.04it/s][A[INFO|trainer.py:570] 2024-04-30 10:28:16,916 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:28:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:28:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:28:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:28:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:28:20 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:28:20 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5198495348445403, 'eval_loss': 0.9116095, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1046, 1134, 1412, 1483, 1467, 1484, 1203, 955, 431, 1525, 985, 546], 'head_nums': [9, 6, 5, 10, 11, 11, 11, 8, 7, 4, 3, 7], 'pruned_params': 50714588, 'remaining_params': 34303012, 'pruned_model_sparsity': 0.5965186973050286, 'expected_sparsity': 0.58977, 'target_sparsity': 0.6026119402985075, 'step': 3500}


Iteration:   6%|▌         | 16/268 [00:06<05:09,  1.23s/it][A04/30/2024 10:28:20 - INFO - trainer.trainer_mod_2 - v4 Global step: 3500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   6%|▋         | 17/268 [00:06<03:50,  1.09it/s][A
Iteration:   7%|▋         | 18/268 [00:06<02:54,  1.43it/s][A
Iteration:   7%|▋         | 19/268 [00:07<02:17,  1.81it/s][A
Iteration:   7%|▋         | 20/268 [00:07<01:52,  2.21it/s][A
Iteration:   8%|▊         | 21/268 [00:07<01:34,  2.62it/s][A
Iteration:   8%|▊         | 22/268 [00:07<01:20,  3.05it/s][A
Iteration:   9%|▊         | 23/268 [00:07<01:10,  3.50it/s][A
Iteration:   9%|▉         | 24/268 [00:08<01:02,  3.88it/s][A
Iteration:   9%|▉         | 25/268 [00:08<00:57,  4.22it/s][A
Iteration:  10%|▉         | 26/268 [00:08<00:53,  4.49it/s][A
Iteration:  10%|█         | 27/268 [00:08<00:52,  4.56it/s][A
Iteration:  10%|█         | 28/268 [00:08<00:51,  4.69it/s][A
Iteration:  11%|█         | 29/268 [00:09<00:49,  4.79it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:48,  4.89it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:47,  5.00it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:46,  5.07it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:46,  5.05it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<00:45,  5.11it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:45,  5.12it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:44,  5.19it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:44,  5.20it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:43,  5.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<00:43,  5.29it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:43,  5.30it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:43,  5.21it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:44,  5.11it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:44,  5.05it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:44,  5.07it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:43,  5.14it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:43,  5.09it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:43,  5.04it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:42,  5.12it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<00:42,  5.15it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.08it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:43,  5.03it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:43,  4.93it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:43,  5.00it/s][A
Iteration:  20%|██        | 54/268 [00:14<00:42,  4.99it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:42,  5.00it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:42,  4.99it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:41,  5.09it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:41,  5.11it/s][A
Iteration:  22%|██▏       | 59/268 [00:15<00:40,  5.17it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:39,  5.22it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:40,  5.16it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:39,  5.18it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:39,  5.20it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:38,  5.24it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:38,  5.32it/s][A[INFO|trainer.py:570] 2024-04-30 10:28:30,127 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:28:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:28:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:28:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:28:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:28:33 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:28:33 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5183172956405748, 'eval_loss': 0.8917546, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [1022, 1109, 1387, 1457, 1440, 1458, 1176, 932, 421, 1468, 933, 526], 'head_nums': [9, 6, 5, 10, 11, 11, 11, 8, 7, 4, 3, 7], 'pruned_params': 51040904, 'remaining_params': 33976696, 'pruned_model_sparsity': 0.6003569143330322, 'expected_sparsity': 0.5951, 'target_sparsity': 0.6114738805970149, 'step': 3550}


Iteration:  25%|██▍       | 66/268 [00:19<04:06,  1.22s/it][A
Iteration:  25%|██▌       | 67/268 [00:19<03:02,  1.10it/s][A
Iteration:  25%|██▌       | 68/268 [00:20<02:18,  1.44it/s][A
Iteration:  26%|██▌       | 69/268 [00:20<01:47,  1.85it/s][A
Iteration:  26%|██▌       | 70/268 [00:20<01:26,  2.29it/s][A
Iteration:  26%|██▋       | 71/268 [00:20<01:11,  2.75it/s][A
Iteration:  27%|██▋       | 72/268 [00:20<01:01,  3.20it/s][A
Iteration:  27%|██▋       | 73/268 [00:21<00:54,  3.61it/s][A
Iteration:  28%|██▊       | 74/268 [00:21<00:48,  3.97it/s][A
Iteration:  28%|██▊       | 75/268 [00:21<00:45,  4.26it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<00:42,  4.53it/s][A
Iteration:  29%|██▊       | 77/268 [00:21<00:42,  4.54it/s][A
Iteration:  29%|██▉       | 78/268 [00:22<00:40,  4.71it/s][A
Iteration:  29%|██▉       | 79/268 [00:22<00:38,  4.86it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<00:37,  5.00it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:36,  5.06it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:36,  5.09it/s][A
Iteration:  31%|███       | 83/268 [00:23<00:35,  5.15it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:35,  5.15it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:35,  5.10it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:35,  5.11it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:36,  4.94it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:39,  4.58it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:37,  4.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:36,  4.93it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:35,  5.00it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:34,  5.05it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:34,  5.12it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:34,  5.11it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:33,  5.13it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:33,  5.16it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:33,  5.17it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:33,  5.07it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:32,  5.21it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:32,  5.19it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:32,  5.09it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:32,  5.15it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:31,  5.16it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:31,  5.16it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:32,  5.01it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:31,  5.07it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:31,  5.15it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:31,  5.11it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:30,  5.17it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:31,  5.05it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:31,  5.02it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:31,  5.03it/s][A
Iteration:  42%|████▏     | 113/268 [00:28<00:30,  5.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:30,  5.07it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:30,  5.00it/s][A[INFO|trainer.py:570] 2024-04-30 10:28:43,363 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:28:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:28:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:28:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:28:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.66it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.59it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.62it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.64it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:28:46 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:28:46 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5258867890805083, 'eval_loss': 0.9302042, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [996, 1083, 1360, 1429, 1412, 1430, 1148, 908, 411, 1406, 877, 506], 'head_nums': [9, 6, 5, 10, 11, 11, 11, 8, 6, 4, 3, 7], 'pruned_params': 51581700, 'remaining_params': 33435900, 'pruned_model_sparsity': 0.6067179031165312, 'expected_sparsity': 0.60061, 'target_sparsity': 0.6203358208955224, 'step': 3600}


Iteration:  43%|████▎     | 116/268 [00:33<03:06,  1.23s/it][A04/30/2024 10:28:46 - INFO - trainer.trainer_mod_2 - v4 Global step: 3600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  44%|████▎     | 117/268 [00:33<02:18,  1.09it/s][A
Iteration:  44%|████▍     | 118/268 [00:33<01:44,  1.43it/s][A
Iteration:  44%|████▍     | 119/268 [00:33<01:21,  1.83it/s][A
Iteration:  45%|████▍     | 120/268 [00:33<01:05,  2.28it/s][A
Iteration:  45%|████▌     | 121/268 [00:33<00:53,  2.75it/s][A
Iteration:  46%|████▌     | 122/268 [00:34<00:46,  3.17it/s][A
Iteration:  46%|████▌     | 123/268 [00:34<00:41,  3.50it/s][A
Iteration:  46%|████▋     | 124/268 [00:34<00:37,  3.87it/s][A
Iteration:  47%|████▋     | 125/268 [00:34<00:34,  4.16it/s][A
Iteration:  47%|████▋     | 126/268 [00:34<00:32,  4.38it/s][A
Iteration:  47%|████▋     | 127/268 [00:35<00:31,  4.52it/s][A
Iteration:  48%|████▊     | 128/268 [00:35<00:29,  4.73it/s][A
Iteration:  48%|████▊     | 129/268 [00:35<00:28,  4.95it/s][A
Iteration:  49%|████▊     | 130/268 [00:35<00:27,  5.01it/s][A
Iteration:  49%|████▉     | 131/268 [00:35<00:26,  5.09it/s][A
Iteration:  49%|████▉     | 132/268 [00:36<00:25,  5.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<00:25,  5.21it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:25,  5.21it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:25,  5.19it/s][A
Iteration:  51%|█████     | 136/268 [00:36<00:25,  5.14it/s][A
Iteration:  51%|█████     | 137/268 [00:37<00:25,  5.16it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:25,  5.19it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:25,  5.13it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:24,  5.14it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:24,  5.26it/s][A
Iteration:  53%|█████▎    | 142/268 [00:38<00:25,  4.94it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:24,  5.07it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:24,  5.02it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:24,  4.99it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:24,  5.06it/s][A
Iteration:  55%|█████▍    | 147/268 [00:39<00:24,  5.03it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:23,  5.17it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:23,  5.17it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:22,  5.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:22,  5.29it/s][A
Iteration:  57%|█████▋    | 152/268 [00:40<00:22,  5.09it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.12it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:22,  5.01it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:22,  5.04it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:21,  5.11it/s][A
Iteration:  59%|█████▊    | 157/268 [00:40<00:21,  5.05it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:21,  5.05it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:21,  5.13it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:20,  5.15it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:21,  5.07it/s][A
Iteration:  60%|██████    | 162/268 [00:41<00:20,  5.20it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:20,  5.15it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:19,  5.27it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:19,  5.28it/s][A[INFO|trainer.py:570] 2024-04-30 10:28:56,515 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:28:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:28:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:28:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:28:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.66it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:28:59 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:28:59 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4993098481666323, 'eval_loss': 0.90225846, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [969, 1055, 1330, 1399, 1380, 1400, 1118, 883, 400, 1337, 818, 485], 'head_nums': [9, 6, 5, 10, 11, 11, 11, 8, 6, 4, 3, 7], 'pruned_params': 51953976, 'remaining_params': 33063624, 'pruned_model_sparsity': 0.611096714092141, 'expected_sparsity': 0.60611, 'target_sparsity': 0.6291977611940298, 'step': 3650}


Iteration:  62%|██████▏   | 166/268 [00:46<02:04,  1.22s/it][A
Iteration:  62%|██████▏   | 167/268 [00:46<01:32,  1.09it/s][A
Iteration:  63%|██████▎   | 168/268 [00:46<01:09,  1.43it/s][A
Iteration:  63%|██████▎   | 169/268 [00:46<00:53,  1.83it/s][A
Iteration:  63%|██████▎   | 170/268 [00:46<00:43,  2.27it/s][A
Iteration:  64%|██████▍   | 171/268 [00:47<00:34,  2.78it/s][A
Iteration:  64%|██████▍   | 172/268 [00:47<00:30,  3.16it/s][A
Iteration:  65%|██████▍   | 173/268 [00:47<00:26,  3.58it/s][A
Iteration:  65%|██████▍   | 174/268 [00:47<00:23,  4.01it/s][A
Iteration:  65%|██████▌   | 175/268 [00:47<00:21,  4.30it/s][A
Iteration:  66%|██████▌   | 176/268 [00:48<00:20,  4.54it/s][A
Iteration:  66%|██████▌   | 177/268 [00:48<00:19,  4.74it/s][A
Iteration:  66%|██████▋   | 178/268 [00:48<00:18,  4.89it/s][A
Iteration:  67%|██████▋   | 179/268 [00:48<00:17,  4.98it/s][A
Iteration:  67%|██████▋   | 180/268 [00:48<00:17,  5.14it/s][A
Iteration:  68%|██████▊   | 181/268 [00:49<00:16,  5.18it/s][A
Iteration:  68%|██████▊   | 182/268 [00:49<00:17,  5.06it/s][A
Iteration:  68%|██████▊   | 183/268 [00:49<00:17,  4.95it/s][A
Iteration:  69%|██████▊   | 184/268 [00:49<00:16,  5.14it/s][A
Iteration:  69%|██████▉   | 185/268 [00:49<00:15,  5.27it/s][A
Iteration:  69%|██████▉   | 186/268 [00:49<00:15,  5.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:50<00:15,  5.26it/s][A
Iteration:  70%|███████   | 188/268 [00:50<00:15,  5.27it/s][A
Iteration:  71%|███████   | 189/268 [00:50<00:15,  5.23it/s][A
Iteration:  71%|███████   | 190/268 [00:50<00:14,  5.39it/s][A
Iteration:  71%|███████▏  | 191/268 [00:50<00:14,  5.32it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:14,  5.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:14,  5.30it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:14,  5.20it/s][A
Iteration:  73%|███████▎  | 195/268 [00:51<00:14,  5.20it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:13,  5.22it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:13,  5.26it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:13,  5.09it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:14,  4.93it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:13,  5.02it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:13,  4.92it/s][A
Iteration:  75%|███████▌  | 202/268 [00:53<00:13,  5.01it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:12,  5.08it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:12,  5.04it/s][A
Iteration:  76%|███████▋  | 205/268 [00:53<00:12,  5.12it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:12,  5.12it/s][A
Iteration:  77%|███████▋  | 207/268 [00:54<00:12,  5.08it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:11,  5.09it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  5.24it/s][A
Iteration:  78%|███████▊  | 210/268 [00:54<00:10,  5.27it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:10,  5.18it/s][A
Iteration:  79%|███████▉  | 212/268 [00:55<00:10,  5.18it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:10,  5.22it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:10,  5.22it/s][A
Iteration:  80%|████████  | 215/268 [00:55<00:10,  5.21it/s][A[INFO|trainer.py:570] 2024-04-30 10:29:09,578 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:29:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:29:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:29:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:29:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:29:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:29:13 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5255827322697563, 'eval_loss': 0.84074754, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [941, 1027, 1299, 1367, 1348, 1368, 1086, 856, 389, 1263, 756, 464], 'head_nums': [9, 6, 5, 10, 11, 11, 11, 8, 6, 4, 3, 7], 'pruned_params': 52341572, 'remaining_params': 32676028, 'pruned_model_sparsity': 0.615655723050286, 'expected_sparsity': 0.61278, 'target_sparsity': 0.6380597014925373, 'step': 3700}


Iteration:  81%|████████  | 216/268 [00:59<01:03,  1.22s/it][A04/30/2024 10:29:13 - INFO - trainer.trainer_mod_2 - v4 Global step: 3700, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  81%|████████  | 217/268 [00:59<00:46,  1.09it/s][A
Iteration:  81%|████████▏ | 218/268 [00:59<00:34,  1.43it/s][A
Iteration:  82%|████████▏ | 219/268 [00:59<00:26,  1.82it/s][A
Iteration:  82%|████████▏ | 220/268 [01:00<00:21,  2.27it/s][A
Iteration:  82%|████████▏ | 221/268 [01:00<00:16,  2.78it/s][A
Iteration:  83%|████████▎ | 222/268 [01:00<00:14,  3.22it/s][A
Iteration:  83%|████████▎ | 223/268 [01:00<00:12,  3.54it/s][A
Iteration:  84%|████████▎ | 224/268 [01:00<00:11,  3.87it/s][A
Iteration:  84%|████████▍ | 225/268 [01:00<00:10,  4.13it/s][A
Iteration:  84%|████████▍ | 226/268 [01:01<00:09,  4.40it/s][A
Iteration:  85%|████████▍ | 227/268 [01:01<00:08,  4.69it/s][A
Iteration:  85%|████████▌ | 228/268 [01:01<00:08,  4.82it/s][A
Iteration:  85%|████████▌ | 229/268 [01:01<00:07,  4.95it/s][A
Iteration:  86%|████████▌ | 230/268 [01:01<00:07,  5.05it/s][A
Iteration:  86%|████████▌ | 231/268 [01:02<00:07,  5.11it/s][A
Iteration:  87%|████████▋ | 232/268 [01:02<00:06,  5.18it/s][A
Iteration:  87%|████████▋ | 233/268 [01:02<00:06,  5.21it/s][A
Iteration:  87%|████████▋ | 234/268 [01:02<00:06,  5.14it/s][A
Iteration:  88%|████████▊ | 235/268 [01:02<00:06,  5.08it/s][A
Iteration:  88%|████████▊ | 236/268 [01:03<00:06,  5.09it/s][A
Iteration:  88%|████████▊ | 237/268 [01:03<00:05,  5.21it/s][A
Iteration:  89%|████████▉ | 238/268 [01:03<00:05,  5.32it/s][A
Iteration:  89%|████████▉ | 239/268 [01:03<00:05,  5.22it/s][A
Iteration:  90%|████████▉ | 240/268 [01:03<00:05,  5.02it/s][A
Iteration:  90%|████████▉ | 241/268 [01:04<00:05,  5.06it/s][A
Iteration:  90%|█████████ | 242/268 [01:04<00:05,  5.13it/s][A
Iteration:  91%|█████████ | 243/268 [01:04<00:04,  5.10it/s][A
Iteration:  91%|█████████ | 244/268 [01:04<00:04,  4.92it/s][A
Iteration:  91%|█████████▏| 245/268 [01:04<00:04,  4.98it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:04,  5.03it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:04,  5.00it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:03,  5.06it/s][A
Iteration:  93%|█████████▎| 249/268 [01:05<00:03,  4.96it/s][A
Iteration:  93%|█████████▎| 250/268 [01:05<00:03,  5.02it/s][A
Iteration:  94%|█████████▎| 251/268 [01:06<00:03,  5.02it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:03,  4.77it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:03,  4.89it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:02,  5.12it/s][A
Iteration:  95%|█████████▌| 255/268 [01:06<00:02,  5.16it/s][A
Iteration:  96%|█████████▌| 256/268 [01:07<00:02,  5.09it/s][A
Iteration:  96%|█████████▌| 257/268 [01:07<00:02,  5.04it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:01,  5.08it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  5.07it/s][A
Iteration:  97%|█████████▋| 260/268 [01:07<00:01,  5.13it/s][A
Iteration:  97%|█████████▋| 261/268 [01:08<00:01,  5.17it/s][A
Iteration:  98%|█████████▊| 262/268 [01:08<00:01,  5.17it/s][A
Iteration:  98%|█████████▊| 263/268 [01:08<00:00,  5.01it/s][A
Iteration:  99%|█████████▊| 264/268 [01:08<00:00,  5.05it/s][A
Iteration:  99%|█████████▉| 265/268 [01:08<00:00,  5.21it/s][A[INFO|trainer.py:570] 2024-04-30 10:29:22,791 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:29:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:29:22 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:29:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:29:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:29:26 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:29:26 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49920513654867127, 'eval_loss': 0.8681329, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [911, 997, 1265, 1332, 1313, 1333, 1053, 828, 379, 1184, 693, 443], 'head_nums': [9, 6, 5, 10, 11, 11, 11, 7, 6, 4, 3, 7], 'pruned_params': 52951308, 'remaining_params': 32066292, 'pruned_model_sparsity': 0.6228276027551942, 'expected_sparsity': 0.62177, 'target_sparsity': 0.6469216417910447, 'step': 3750}


Iteration:  99%|█████████▉| 266/268 [01:12<00:02,  1.22s/it][A
Iteration: 100%|█████████▉| 267/268 [01:12<00:00,  1.10it/s][A
Iteration: 100%|██████████| 268/268 [01:12<00:00,  1.47it/s][A04/30/2024 10:29:26 - INFO - trainer.trainer_mod_2 - Epoch 13 finished. Took 72.76 seconds.
Iteration: 100%|██████████| 268/268 [01:12<00:00,  3.68it/s]
Epoch:  14%|█▍        | 14/100 [16:32<1:42:13, 71.32s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:51,  5.17it/s][A
Iteration:   1%|          | 2/268 [00:00<00:50,  5.25it/s][A
Iteration:   1%|          | 3/268 [00:00<00:50,  5.24it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:50,  5.23it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.24it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:50,  5.24it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:49,  5.28it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:49,  5.23it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:49,  5.24it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:50,  5.14it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:49,  5.15it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:49,  5.21it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:48,  5.25it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:49,  5.10it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:49,  5.07it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:47,  5.27it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:46,  5.36it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:47,  5.30it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:46,  5.38it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:46,  5.37it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:44,  5.49it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:45,  5.45it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:46,  5.30it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:46,  5.23it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:46,  5.24it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:46,  5.17it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:46,  5.16it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:46,  5.12it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:46,  5.18it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:46,  5.10it/s][A
Iteration:  12%|█▏        | 31/268 [00:05<00:46,  5.07it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:47,  4.96it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:47,  4.91it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:46,  4.98it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:45,  5.07it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:44,  5.22it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:44,  5.23it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:43,  5.23it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:45,  5.04it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:44,  5.07it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:45,  5.04it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:44,  5.12it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:44,  5.07it/s][A
Iteration:  16%|█▋        | 44/268 [00:08<00:42,  5.32it/s][A
Iteration:  17%|█▋        | 45/268 [00:08<00:41,  5.33it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:41,  5.40it/s][A
Iteration:  18%|█▊        | 47/268 [00:09<00:41,  5.37it/s][A[INFO|trainer.py:570] 2024-04-30 10:29:35,779 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:29:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:29:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:29:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:29:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:29:39 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:29:39 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49921989581653686, 'eval_loss': 0.98703927, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [880, 966, 1231, 1295, 1277, 1297, 1019, 801, 368, 1102, 632, 423], 'head_nums': [9, 6, 5, 9, 10, 10, 11, 6, 5, 4, 3, 7], 'pruned_params': 54356152, 'remaining_params': 30661448, 'pruned_model_sparsity': 0.6393517577536887, 'expected_sparsity': 0.63283, 'target_sparsity': 0.6557835820895522, 'step': 3800}


Iteration:  18%|█▊        | 48/268 [00:12<04:28,  1.22s/it][A04/30/2024 10:29:39 - INFO - trainer.trainer_mod_2 - v4 Global step: 3800, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  18%|█▊        | 49/268 [00:12<03:20,  1.09it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<02:32,  1.43it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<01:58,  1.83it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<01:34,  2.28it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<01:18,  2.74it/s][A
Iteration:  20%|██        | 54/268 [00:13<01:06,  3.20it/s][A
Iteration:  21%|██        | 55/268 [00:13<00:57,  3.70it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:52,  4.02it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:49,  4.25it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:47,  4.45it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:45,  4.63it/s][A
Iteration:  22%|██▏       | 60/268 [00:14<00:43,  4.80it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:41,  4.94it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:41,  5.01it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:40,  5.08it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:39,  5.14it/s][A
Iteration:  24%|██▍       | 65/268 [00:15<00:39,  5.15it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:40,  4.99it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:40,  5.00it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:39,  5.10it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:38,  5.14it/s][A
Iteration:  26%|██▌       | 70/268 [00:16<00:38,  5.15it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:37,  5.28it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:37,  5.27it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:37,  5.24it/s][A
Iteration:  28%|██▊       | 74/268 [00:17<00:35,  5.40it/s][A
Iteration:  28%|██▊       | 75/268 [00:17<00:35,  5.46it/s][A
Iteration:  28%|██▊       | 76/268 [00:18<00:35,  5.41it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:35,  5.40it/s][A
Iteration:  29%|██▉       | 78/268 [00:18<00:35,  5.30it/s][A
Iteration:  29%|██▉       | 79/268 [00:18<00:36,  5.20it/s][A
Iteration:  30%|██▉       | 80/268 [00:18<00:36,  5.16it/s][A
Iteration:  30%|███       | 81/268 [00:19<00:37,  5.02it/s][A
Iteration:  31%|███       | 82/268 [00:19<00:37,  4.99it/s][A
Iteration:  31%|███       | 83/268 [00:19<00:37,  4.99it/s][A
Iteration:  31%|███▏      | 84/268 [00:19<00:36,  5.01it/s][A
Iteration:  32%|███▏      | 85/268 [00:19<00:36,  5.07it/s][A
Iteration:  32%|███▏      | 86/268 [00:19<00:35,  5.17it/s][A
Iteration:  32%|███▏      | 87/268 [00:20<00:35,  5.04it/s][A
Iteration:  33%|███▎      | 88/268 [00:20<00:35,  5.13it/s][A
Iteration:  33%|███▎      | 89/268 [00:20<00:34,  5.14it/s][A
Iteration:  34%|███▎      | 90/268 [00:20<00:33,  5.27it/s][A
Iteration:  34%|███▍      | 91/268 [00:20<00:33,  5.29it/s][A
Iteration:  34%|███▍      | 92/268 [00:21<00:33,  5.20it/s][A
Iteration:  35%|███▍      | 93/268 [00:21<00:33,  5.23it/s][A
Iteration:  35%|███▌      | 94/268 [00:21<00:33,  5.21it/s][A
Iteration:  35%|███▌      | 95/268 [00:21<00:32,  5.33it/s][A
Iteration:  36%|███▌      | 96/268 [00:21<00:31,  5.40it/s][A
Iteration:  36%|███▌      | 97/268 [00:22<00:32,  5.33it/s][A[INFO|trainer.py:570] 2024-04-30 10:29:48,826 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:29:48 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:29:48 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:29:48 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:29:48 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:29:52 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:29:52 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4939105407308262, 'eval_loss': 0.933019, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [849, 935, 1195, 1259, 1239, 1259, 985, 773, 357, 1020, 575, 403], 'head_nums': [9, 6, 5, 8, 10, 10, 11, 6, 5, 3, 3, 7], 'pruned_params': 55181900, 'remaining_params': 29835700, 'pruned_model_sparsity': 0.6490644290123457, 'expected_sparsity': 0.64256, 'target_sparsity': 0.6646455223880596, 'step': 3850}


Iteration:  37%|███▋      | 98/268 [00:25<03:27,  1.22s/it][A
Iteration:  37%|███▋      | 99/268 [00:25<02:33,  1.10it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<01:56,  1.44it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<01:31,  1.84it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<01:12,  2.27it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<01:00,  2.72it/s][A
Iteration:  39%|███▉      | 104/268 [00:26<00:51,  3.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:45,  3.61it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:41,  3.89it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:38,  4.24it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:34,  4.57it/s][A
Iteration:  41%|████      | 109/268 [00:27<00:33,  4.73it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:32,  4.88it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:31,  4.99it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:31,  4.97it/s][A
Iteration:  42%|████▏     | 113/268 [00:28<00:30,  5.05it/s][A
Iteration:  43%|████▎     | 114/268 [00:28<00:29,  5.19it/s][A
Iteration:  43%|████▎     | 115/268 [00:28<00:29,  5.20it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:29,  5.22it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:29,  5.13it/s][A
Iteration:  44%|████▍     | 118/268 [00:29<00:28,  5.26it/s][A
Iteration:  44%|████▍     | 119/268 [00:29<00:28,  5.29it/s][A
Iteration:  45%|████▍     | 120/268 [00:29<00:28,  5.20it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:29,  5.05it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:28,  5.07it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:28,  5.14it/s][A
Iteration:  46%|████▋     | 124/268 [00:30<00:28,  5.14it/s][A
Iteration:  47%|████▋     | 125/268 [00:30<00:27,  5.14it/s][A
Iteration:  47%|████▋     | 126/268 [00:31<00:27,  5.11it/s][A
Iteration:  47%|████▋     | 127/268 [00:31<00:28,  4.94it/s][A
Iteration:  48%|████▊     | 128/268 [00:31<00:27,  5.04it/s][A
Iteration:  48%|████▊     | 129/268 [00:31<00:28,  4.89it/s][A
Iteration:  49%|████▊     | 130/268 [00:31<00:27,  4.96it/s][A
Iteration:  49%|████▉     | 131/268 [00:32<00:26,  5.19it/s][A
Iteration:  49%|████▉     | 132/268 [00:32<00:26,  5.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:32<00:25,  5.27it/s][A
Iteration:  50%|█████     | 134/268 [00:32<00:25,  5.24it/s][A
Iteration:  50%|█████     | 135/268 [00:32<00:25,  5.22it/s][A
Iteration:  51%|█████     | 136/268 [00:33<00:25,  5.25it/s][A
Iteration:  51%|█████     | 137/268 [00:33<00:25,  5.18it/s][A
Iteration:  51%|█████▏    | 138/268 [00:33<00:24,  5.22it/s][A
Iteration:  52%|█████▏    | 139/268 [00:33<00:24,  5.21it/s][A
Iteration:  52%|█████▏    | 140/268 [00:33<00:24,  5.12it/s][A
Iteration:  53%|█████▎    | 141/268 [00:34<00:24,  5.14it/s][A
Iteration:  53%|█████▎    | 142/268 [00:34<00:24,  5.10it/s][A
Iteration:  53%|█████▎    | 143/268 [00:34<00:24,  5.13it/s][A
Iteration:  54%|█████▎    | 144/268 [00:34<00:24,  5.09it/s][A
Iteration:  54%|█████▍    | 145/268 [00:34<00:24,  5.11it/s][A
Iteration:  54%|█████▍    | 146/268 [00:35<00:23,  5.12it/s][A
Iteration:  55%|█████▍    | 147/268 [00:35<00:23,  5.07it/s][A[INFO|trainer.py:570] 2024-04-30 10:30:01,994 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:30:01 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:30:01 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:30:01 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:30:02 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:30:05 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:30:05 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5258867890805083, 'eval_loss': 0.89237654, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [819, 905, 1160, 1221, 1201, 1221, 951, 746, 347, 937, 522, 385], 'head_nums': [9, 6, 5, 8, 10, 10, 11, 6, 4, 3, 3, 7], 'pruned_params': 55806956, 'remaining_params': 29210644, 'pruned_model_sparsity': 0.6564165066997892, 'expected_sparsity': 0.65016, 'target_sparsity': 0.6735074626865671, 'step': 3900}


Iteration:  55%|█████▌    | 148/268 [00:38<02:28,  1.24s/it][A04/30/2024 10:30:05 - INFO - trainer.trainer_mod_2 - v4 Global step: 3900, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  56%|█████▌    | 149/268 [00:39<01:49,  1.09it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<01:22,  1.43it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<01:04,  1.80it/s][A
Iteration:  57%|█████▋    | 152/268 [00:39<00:51,  2.27it/s][A
Iteration:  57%|█████▋    | 153/268 [00:39<00:41,  2.77it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:35,  3.20it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:31,  3.61it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:29,  3.79it/s][A
Iteration:  59%|█████▊    | 157/268 [00:40<00:28,  3.83it/s][A
Iteration:  59%|█████▉    | 158/268 [00:40<00:26,  4.15it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:25,  4.32it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:23,  4.58it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:22,  4.74it/s][A
Iteration:  60%|██████    | 162/268 [00:41<00:21,  4.85it/s][A
Iteration:  61%|██████    | 163/268 [00:41<00:21,  4.94it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:21,  4.93it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:20,  5.00it/s][A
Iteration:  62%|██████▏   | 166/268 [00:42<00:20,  5.09it/s][A
Iteration:  62%|██████▏   | 167/268 [00:42<00:20,  4.97it/s][A
Iteration:  63%|██████▎   | 168/268 [00:42<00:19,  5.06it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:19,  5.09it/s][A
Iteration:  63%|██████▎   | 170/268 [00:43<00:19,  5.07it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:19,  4.96it/s][A
Iteration:  64%|██████▍   | 172/268 [00:43<00:19,  5.01it/s][A
Iteration:  65%|██████▍   | 173/268 [00:43<00:18,  5.05it/s][A
Iteration:  65%|██████▍   | 174/268 [00:44<00:18,  5.09it/s][A
Iteration:  65%|██████▌   | 175/268 [00:44<00:18,  5.06it/s][A
Iteration:  66%|██████▌   | 176/268 [00:44<00:17,  5.12it/s][A
Iteration:  66%|██████▌   | 177/268 [00:44<00:17,  5.25it/s][A
Iteration:  66%|██████▋   | 178/268 [00:44<00:17,  5.04it/s][A
Iteration:  67%|██████▋   | 179/268 [00:45<00:17,  5.08it/s][A
Iteration:  67%|██████▋   | 180/268 [00:45<00:17,  5.04it/s][A
Iteration:  68%|██████▊   | 181/268 [00:45<00:16,  5.19it/s][A
Iteration:  68%|██████▊   | 182/268 [00:45<00:16,  5.19it/s][A
Iteration:  68%|██████▊   | 183/268 [00:45<00:16,  5.23it/s][A
Iteration:  69%|██████▊   | 184/268 [00:45<00:16,  5.01it/s][A
Iteration:  69%|██████▉   | 185/268 [00:46<00:15,  5.23it/s][A
Iteration:  69%|██████▉   | 186/268 [00:46<00:15,  5.25it/s][A
Iteration:  70%|██████▉   | 187/268 [00:46<00:15,  5.23it/s][A
Iteration:  70%|███████   | 188/268 [00:46<00:15,  5.21it/s][A
Iteration:  71%|███████   | 189/268 [00:46<00:15,  5.23it/s][A
Iteration:  71%|███████   | 190/268 [00:47<00:14,  5.25it/s][A
Iteration:  71%|███████▏  | 191/268 [00:47<00:14,  5.28it/s][A
Iteration:  72%|███████▏  | 192/268 [00:47<00:14,  5.20it/s][A
Iteration:  72%|███████▏  | 193/268 [00:47<00:14,  5.24it/s][A
Iteration:  72%|███████▏  | 194/268 [00:47<00:14,  5.05it/s][A
Iteration:  73%|███████▎  | 195/268 [00:48<00:14,  5.04it/s][A
Iteration:  73%|███████▎  | 196/268 [00:48<00:14,  5.09it/s][A
Iteration:  74%|███████▎  | 197/268 [00:48<00:13,  5.12it/s][A[INFO|trainer.py:570] 2024-04-30 10:30:15,262 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:30:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:30:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:30:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:30:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.50it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.56it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.63it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.65it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.78it/s]04/30/2024 10:30:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:30:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4912021644550038, 'eval_loss': 0.92553806, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [790, 876, 1124, 1184, 1163, 1184, 918, 719, 337, 856, 473, 367], 'head_nums': [9, 6, 5, 8, 10, 10, 11, 6, 4, 3, 3, 7], 'pruned_params': 56229788, 'remaining_params': 28787812, 'pruned_model_sparsity': 0.6613899710177658, 'expected_sparsity': 0.6574, 'target_sparsity': 0.6823694029850745, 'step': 3950}


Iteration:  74%|███████▍  | 198/268 [00:52<01:26,  1.23s/it][A
Iteration:  74%|███████▍  | 199/268 [00:52<01:03,  1.09it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:47,  1.43it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:36,  1.84it/s][A
Iteration:  75%|███████▌  | 202/268 [00:52<00:28,  2.28it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:23,  2.75it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:19,  3.22it/s][A
Iteration:  76%|███████▋  | 205/268 [00:53<00:17,  3.63it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:15,  4.02it/s][A
Iteration:  77%|███████▋  | 207/268 [00:53<00:13,  4.38it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:13,  4.55it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:12,  4.75it/s][A
Iteration:  78%|███████▊  | 210/268 [00:54<00:12,  4.71it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:11,  4.85it/s][A
Iteration:  79%|███████▉  | 212/268 [00:54<00:11,  4.89it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:11,  4.90it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:10,  5.01it/s][A
Iteration:  80%|████████  | 215/268 [00:55<00:10,  5.04it/s][A
Iteration:  81%|████████  | 216/268 [00:55<00:10,  5.08it/s][A
Iteration:  81%|████████  | 217/268 [00:55<00:10,  4.98it/s][A
Iteration:  81%|████████▏ | 218/268 [00:56<00:10,  4.85it/s][A
Iteration:  82%|████████▏ | 219/268 [00:56<00:09,  4.97it/s][A
Iteration:  82%|████████▏ | 220/268 [00:56<00:09,  5.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:56<00:08,  5.36it/s][A
Iteration:  83%|████████▎ | 222/268 [00:56<00:08,  5.23it/s][A
Iteration:  83%|████████▎ | 223/268 [00:56<00:08,  5.11it/s][A
Iteration:  84%|████████▎ | 224/268 [00:57<00:08,  5.23it/s][A
Iteration:  84%|████████▍ | 225/268 [00:57<00:07,  5.39it/s][A
Iteration:  84%|████████▍ | 226/268 [00:57<00:07,  5.32it/s][A
Iteration:  85%|████████▍ | 227/268 [00:57<00:07,  5.32it/s][A
Iteration:  85%|████████▌ | 228/268 [00:57<00:07,  5.18it/s][A
Iteration:  85%|████████▌ | 229/268 [00:58<00:07,  5.22it/s][A
Iteration:  86%|████████▌ | 230/268 [00:58<00:07,  5.23it/s][A
Iteration:  86%|████████▌ | 231/268 [00:58<00:07,  5.20it/s][A
Iteration:  87%|████████▋ | 232/268 [00:58<00:07,  5.12it/s][A
Iteration:  87%|████████▋ | 233/268 [00:58<00:06,  5.13it/s][A
Iteration:  87%|████████▋ | 234/268 [00:59<00:06,  5.00it/s][A
Iteration:  88%|████████▊ | 235/268 [00:59<00:06,  5.05it/s][A
Iteration:  88%|████████▊ | 236/268 [00:59<00:06,  5.01it/s][A
Iteration:  88%|████████▊ | 237/268 [00:59<00:06,  5.10it/s][A
Iteration:  89%|████████▉ | 238/268 [00:59<00:05,  5.05it/s][A
Iteration:  89%|████████▉ | 239/268 [01:00<00:05,  5.13it/s][A
Iteration:  90%|████████▉ | 240/268 [01:00<00:05,  5.02it/s][A
Iteration:  90%|████████▉ | 241/268 [01:00<00:05,  5.24it/s][A
Iteration:  90%|█████████ | 242/268 [01:00<00:04,  5.21it/s][A
Iteration:  91%|█████████ | 243/268 [01:00<00:04,  5.20it/s][A
Iteration:  91%|█████████ | 244/268 [01:01<00:04,  5.21it/s][A
Iteration:  91%|█████████▏| 245/268 [01:01<00:04,  5.26it/s][A
Iteration:  92%|█████████▏| 246/268 [01:01<00:04,  5.27it/s][A
Iteration:  92%|█████████▏| 247/268 [01:01<00:04,  5.22it/s][A[INFO|trainer.py:570] 2024-04-30 10:30:28,349 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:30:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:30:28 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:30:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:30:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:30:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:30:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5212174394953254, 'eval_loss': 0.8454904, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [761, 846, 1089, 1146, 1125, 1146, 884, 693, 328, 778, 427, 350], 'head_nums': [9, 6, 5, 8, 10, 10, 11, 6, 4, 3, 3, 7], 'pruned_params': 56654152, 'remaining_params': 28363448, 'pruned_model_sparsity': 0.6663814551339958, 'expected_sparsity': 0.66532, 'target_sparsity': 0.6912313432835822, 'step': 4000}


Iteration:  93%|█████████▎| 248/268 [01:05<00:24,  1.22s/it][A04/30/2024 10:30:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 4000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  93%|█████████▎| 249/268 [01:05<00:17,  1.10it/s][A
Iteration:  93%|█████████▎| 250/268 [01:05<00:12,  1.43it/s][A
Iteration:  94%|█████████▎| 251/268 [01:05<00:09,  1.83it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:07,  2.26it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:05,  2.73it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:04,  3.13it/s][A
Iteration:  95%|█████████▌| 255/268 [01:06<00:03,  3.47it/s][A
Iteration:  96%|█████████▌| 256/268 [01:06<00:03,  3.81it/s][A
Iteration:  96%|█████████▌| 257/268 [01:07<00:02,  4.17it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:02,  4.45it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  4.57it/s][A
Iteration:  97%|█████████▋| 260/268 [01:07<00:01,  4.84it/s][A
Iteration:  97%|█████████▋| 261/268 [01:07<00:01,  4.93it/s][A
Iteration:  98%|█████████▊| 262/268 [01:07<00:01,  4.93it/s][A
Iteration:  98%|█████████▊| 263/268 [01:08<00:00,  5.05it/s][A
Iteration:  99%|█████████▊| 264/268 [01:08<00:00,  4.99it/s][A
Iteration:  99%|█████████▉| 265/268 [01:08<00:00,  4.98it/s][A
Iteration:  99%|█████████▉| 266/268 [01:08<00:00,  5.07it/s][A
Iteration: 100%|█████████▉| 267/268 [01:08<00:00,  5.09it/s][A
Iteration: 100%|██████████| 268/268 [01:09<00:00,  5.61it/s][A04/30/2024 10:30:35 - INFO - trainer.trainer_mod_2 - Epoch 14 finished. Took 69.1 seconds.
Iteration: 100%|██████████| 268/268 [01:09<00:00,  3.88it/s]
Epoch:  15%|█▌        | 15/100 [17:41<1:40:05, 70.65s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:51,  5.15it/s][A
Iteration:   1%|          | 2/268 [00:00<00:54,  4.84it/s][A
Iteration:   1%|          | 3/268 [00:00<00:52,  5.04it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:51,  5.10it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.17it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:51,  5.12it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:49,  5.25it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:48,  5.34it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:50,  5.13it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:50,  5.10it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:49,  5.16it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:50,  5.12it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:49,  5.13it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:50,  5.00it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:50,  5.00it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:51,  4.90it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:48,  5.14it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:48,  5.18it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:48,  5.09it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:49,  5.04it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:49,  5.00it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:50,  4.88it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:49,  4.99it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:48,  5.08it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:48,  4.98it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:47,  5.09it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:46,  5.15it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:46,  5.14it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:46,  5.14it/s][A[INFO|trainer.py:570] 2024-04-30 10:30:41,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:30:41 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:30:41 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:30:41 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:30:41 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.68it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:30:44 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:30:44 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.48312183684741317, 'eval_loss': 0.95473236, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [734, 817, 1053, 1109, 1087, 1108, 852, 667, 320, 704, 385, 334], 'head_nums': [8, 6, 5, 8, 10, 9, 11, 5, 4, 2, 3, 7], 'pruned_params': 57853708, 'remaining_params': 27163892, 'pruned_model_sparsity': 0.6804909571665161, 'expected_sparsity': 0.67545, 'target_sparsity': 0.7000932835820896, 'step': 4050}


Iteration:  11%|█         | 30/268 [00:09<04:52,  1.23s/it][A
Iteration:  12%|█▏        | 31/268 [00:09<03:37,  1.09it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<02:44,  1.44it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<02:07,  1.85it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<01:42,  2.28it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<01:24,  2.75it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<01:12,  3.21it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<01:04,  3.57it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:58,  3.95it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<00:53,  4.28it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:50,  4.54it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:48,  4.65it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:47,  4.74it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:47,  4.75it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:47,  4.73it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:45,  4.95it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:44,  4.93it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:44,  5.01it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:43,  5.08it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<00:42,  5.11it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:42,  5.16it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:41,  5.28it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:41,  5.17it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:41,  5.22it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:40,  5.23it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:41,  5.16it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:42,  4.99it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:44,  4.76it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:42,  4.89it/s][A
Iteration:  22%|██▏       | 59/268 [00:15<00:42,  4.94it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:41,  5.02it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:40,  5.09it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:41,  5.01it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:40,  5.06it/s][A
Iteration:  24%|██▍       | 64/268 [00:16<00:42,  4.80it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:41,  4.95it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:40,  5.04it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:39,  5.03it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:39,  5.11it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:37,  5.30it/s][A
Iteration:  26%|██▌       | 70/268 [00:17<00:37,  5.26it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:37,  5.21it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:37,  5.19it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:37,  5.18it/s][A
Iteration:  28%|██▊       | 74/268 [00:17<00:37,  5.21it/s][A
Iteration:  28%|██▊       | 75/268 [00:18<00:37,  5.20it/s][A
Iteration:  28%|██▊       | 76/268 [00:18<00:38,  5.01it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:37,  5.10it/s][A
Iteration:  29%|██▉       | 78/268 [00:18<00:36,  5.14it/s][A
Iteration:  29%|██▉       | 79/268 [00:18<00:37,  5.11it/s][A[INFO|trainer.py:570] 2024-04-30 10:30:54,767 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:30:54 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:30:54 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:30:54 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:30:54 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.67it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:30:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:30:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.499588865878389, 'eval_loss': 0.91298604, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [707, 789, 1018, 1073, 1049, 1071, 820, 642, 311, 635, 347, 320], 'head_nums': [8, 6, 5, 8, 10, 9, 10, 4, 4, 2, 3, 7], 'pruned_params': 58654944, 'remaining_params': 26362656, 'pruned_model_sparsity': 0.6899153116531165, 'expected_sparsity': 0.68734, 'target_sparsity': 0.7089552238805971, 'step': 4100}


Iteration:  30%|██▉       | 80/268 [00:22<03:49,  1.22s/it][A04/30/2024 10:30:58 - INFO - trainer.trainer_mod_2 - v4 Global step: 4100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  30%|███       | 81/268 [00:22<02:51,  1.09it/s][A
Iteration:  31%|███       | 82/268 [00:22<02:09,  1.43it/s][A
Iteration:  31%|███       | 83/268 [00:23<01:42,  1.81it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<01:21,  2.25it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<01:07,  2.71it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:57,  3.18it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:49,  3.62it/s][A
Iteration:  33%|███▎      | 88/268 [00:24<00:45,  3.98it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:42,  4.23it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:39,  4.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:37,  4.69it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:36,  4.82it/s][A
Iteration:  35%|███▍      | 93/268 [00:25<00:35,  4.93it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:34,  5.02it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:33,  5.18it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:33,  5.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:34,  4.96it/s][A
Iteration:  37%|███▋      | 98/268 [00:26<00:33,  5.04it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:34,  4.90it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:34,  4.91it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:32,  5.08it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:31,  5.22it/s][A
Iteration:  38%|███▊      | 103/268 [00:27<00:31,  5.20it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:31,  5.19it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:31,  5.23it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:31,  5.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:31,  5.18it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:30,  5.22it/s][A
Iteration:  41%|████      | 109/268 [00:28<00:30,  5.20it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:29,  5.37it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:29,  5.34it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:29,  5.28it/s][A
Iteration:  42%|████▏     | 113/268 [00:28<00:30,  5.11it/s][A
Iteration:  43%|████▎     | 114/268 [00:29<00:30,  5.06it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:30,  5.04it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:30,  5.03it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:29,  5.12it/s][A
Iteration:  44%|████▍     | 118/268 [00:29<00:29,  5.07it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:29,  5.10it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:28,  5.17it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:28,  5.21it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:28,  5.12it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:27,  5.25it/s][A
Iteration:  46%|████▋     | 124/268 [00:31<00:27,  5.23it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:27,  5.26it/s][A
Iteration:  47%|████▋     | 126/268 [00:31<00:26,  5.27it/s][A
Iteration:  47%|████▋     | 127/268 [00:31<00:26,  5.26it/s][A
Iteration:  48%|████▊     | 128/268 [00:31<00:26,  5.28it/s][A
Iteration:  48%|████▊     | 129/268 [00:32<00:26,  5.25it/s][A[INFO|trainer.py:570] 2024-04-30 10:31:07,856 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:31:07 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:31:07 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:31:07 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:31:07 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:31:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:31:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4608371202972188, 'eval_loss': 0.9620756, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [682, 763, 986, 1039, 1013, 1035, 790, 619, 304, 572, 315, 308], 'head_nums': [8, 6, 5, 8, 9, 8, 9, 4, 3, 2, 3, 7], 'pruned_params': 59820796, 'remaining_params': 25196804, 'pruned_model_sparsity': 0.703628378124059, 'expected_sparsity': 0.70128, 'target_sparsity': 0.7178171641791045, 'step': 4150}


Iteration:  49%|████▊     | 130/268 [00:35<02:47,  1.22s/it][A
Iteration:  49%|████▉     | 131/268 [00:35<02:04,  1.10it/s][A
Iteration:  49%|████▉     | 132/268 [00:36<01:34,  1.43it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<01:12,  1.85it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:58,  2.29it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:48,  2.75it/s][A
Iteration:  51%|█████     | 136/268 [00:36<00:41,  3.22it/s][A
Iteration:  51%|█████     | 137/268 [00:36<00:36,  3.56it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:34,  3.80it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:31,  4.08it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:29,  4.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:27,  4.61it/s][A
Iteration:  53%|█████▎    | 142/268 [00:37<00:26,  4.78it/s][A
Iteration:  53%|█████▎    | 143/268 [00:38<00:25,  4.88it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:25,  4.83it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:24,  5.03it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:23,  5.19it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<00:22,  5.28it/s][A
Iteration:  55%|█████▌    | 148/268 [00:39<00:22,  5.25it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:23,  5.09it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:22,  5.24it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:22,  5.22it/s][A
Iteration:  57%|█████▋    | 152/268 [00:39<00:22,  5.14it/s][A
Iteration:  57%|█████▋    | 153/268 [00:40<00:22,  5.20it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:21,  5.20it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:21,  5.19it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:21,  5.24it/s][A
Iteration:  59%|█████▊    | 157/268 [00:40<00:21,  5.19it/s][A
Iteration:  59%|█████▉    | 158/268 [00:41<00:21,  5.12it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:20,  5.26it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:20,  5.18it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:20,  5.13it/s][A
Iteration:  60%|██████    | 162/268 [00:41<00:20,  5.15it/s][A
Iteration:  61%|██████    | 163/268 [00:42<00:20,  5.19it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:19,  5.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:19,  5.26it/s][A
Iteration:  62%|██████▏   | 166/268 [00:42<00:19,  5.23it/s][A
Iteration:  62%|██████▏   | 167/268 [00:42<00:19,  5.15it/s][A
Iteration:  63%|██████▎   | 168/268 [00:42<00:19,  5.06it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:19,  5.11it/s][A
Iteration:  63%|██████▎   | 170/268 [00:43<00:19,  5.11it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:18,  5.15it/s][A
Iteration:  64%|██████▍   | 172/268 [00:43<00:18,  5.20it/s][A
Iteration:  65%|██████▍   | 173/268 [00:43<00:18,  5.23it/s][A
Iteration:  65%|██████▍   | 174/268 [00:44<00:17,  5.26it/s][A
Iteration:  65%|██████▌   | 175/268 [00:44<00:17,  5.29it/s][A
Iteration:  66%|██████▌   | 176/268 [00:44<00:17,  5.18it/s][A
Iteration:  66%|██████▌   | 177/268 [00:44<00:17,  5.17it/s][A
Iteration:  66%|██████▋   | 178/268 [00:44<00:17,  5.29it/s][A
Iteration:  67%|██████▋   | 179/268 [00:45<00:16,  5.25it/s][A[INFO|trainer.py:570] 2024-04-30 10:31:20,944 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:31:20 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:31:20 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:31:20 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:31:20 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.69it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:31:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:31:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.49816788996099576, 'eval_loss': 0.90816075, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [659, 738, 955, 1005, 979, 1000, 761, 597, 296, 516, 288, 297], 'head_nums': [7, 5, 5, 8, 9, 8, 8, 3, 3, 2, 3, 7], 'pruned_params': 60974392, 'remaining_params': 24043208, 'pruned_model_sparsity': 0.7171972862089732, 'expected_sparsity': 0.71435, 'target_sparsity': 0.726679104477612, 'step': 4200}


Iteration:  67%|██████▋   | 180/268 [00:48<01:47,  1.22s/it][A04/30/2024 10:31:24 - INFO - trainer.trainer_mod_2 - v4 Global step: 4200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  68%|██████▊   | 181/268 [00:48<01:19,  1.10it/s][A
Iteration:  68%|██████▊   | 182/268 [00:49<01:00,  1.43it/s][A
Iteration:  68%|██████▊   | 183/268 [00:49<00:46,  1.85it/s][A
Iteration:  69%|██████▊   | 184/268 [00:49<00:36,  2.31it/s][A
Iteration:  69%|██████▉   | 185/268 [00:49<00:30,  2.76it/s][A
Iteration:  69%|██████▉   | 186/268 [00:49<00:25,  3.20it/s][A
Iteration:  70%|██████▉   | 187/268 [00:50<00:22,  3.68it/s][A
Iteration:  70%|███████   | 188/268 [00:50<00:20,  3.99it/s][A
Iteration:  71%|███████   | 189/268 [00:50<00:18,  4.23it/s][A
Iteration:  71%|███████   | 190/268 [00:50<00:17,  4.49it/s][A
Iteration:  71%|███████▏  | 191/268 [00:50<00:16,  4.70it/s][A
Iteration:  72%|███████▏  | 192/268 [00:51<00:15,  4.77it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:15,  4.88it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:14,  4.99it/s][A
Iteration:  73%|███████▎  | 195/268 [00:51<00:14,  5.03it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:14,  5.11it/s][A
Iteration:  74%|███████▎  | 197/268 [00:52<00:14,  4.95it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:13,  5.01it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:13,  5.06it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:13,  5.14it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:12,  5.19it/s][A
Iteration:  75%|███████▌  | 202/268 [00:52<00:13,  5.05it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:12,  5.11it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:12,  5.06it/s][A
Iteration:  76%|███████▋  | 205/268 [00:53<00:12,  5.08it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:12,  5.00it/s][A
Iteration:  77%|███████▋  | 207/268 [00:53<00:12,  4.98it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:11,  5.03it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  4.95it/s][A
Iteration:  78%|███████▊  | 210/268 [00:54<00:11,  5.05it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:11,  5.13it/s][A
Iteration:  79%|███████▉  | 212/268 [00:54<00:10,  5.17it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:10,  5.21it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:10,  5.23it/s][A
Iteration:  80%|████████  | 215/268 [00:55<00:10,  5.15it/s][A
Iteration:  81%|████████  | 216/268 [00:55<00:10,  5.15it/s][A
Iteration:  81%|████████  | 217/268 [00:55<00:09,  5.18it/s][A
Iteration:  81%|████████▏ | 218/268 [00:56<00:09,  5.22it/s][A
Iteration:  82%|████████▏ | 219/268 [00:56<00:10,  4.75it/s][A
Iteration:  82%|████████▏ | 220/268 [00:56<00:09,  4.87it/s][A
Iteration:  82%|████████▏ | 221/268 [00:56<00:09,  4.97it/s][A
Iteration:  83%|████████▎ | 222/268 [00:56<00:08,  5.20it/s][A
Iteration:  83%|████████▎ | 223/268 [00:57<00:08,  5.32it/s][A
Iteration:  84%|████████▎ | 224/268 [00:57<00:08,  5.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:57<00:08,  5.26it/s][A
Iteration:  84%|████████▍ | 226/268 [00:57<00:07,  5.27it/s][A
Iteration:  85%|████████▍ | 227/268 [00:57<00:07,  5.24it/s][A
Iteration:  85%|████████▌ | 228/268 [00:58<00:07,  5.25it/s][A
Iteration:  85%|████████▌ | 229/268 [00:58<00:07,  5.22it/s][A[INFO|trainer.py:570] 2024-04-30 10:31:34,094 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:31:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:31:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:31:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:31:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.67it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.66it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.67it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.67it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:31:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:31:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5171064406591647, 'eval_loss': 0.8102379, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [638, 714, 926, 974, 947, 968, 734, 576, 289, 466, 265, 288], 'head_nums': [7, 5, 4, 8, 8, 8, 7, 3, 3, 2, 3, 6], 'pruned_params': 62101944, 'remaining_params': 22915656, 'pruned_model_sparsity': 0.7304598577235772, 'expected_sparsity': 0.72693, 'target_sparsity': 0.7355410447761194, 'step': 4250}


Iteration:  86%|████████▌ | 230/268 [01:01<00:46,  1.22s/it][A
Iteration:  86%|████████▌ | 231/268 [01:02<00:33,  1.09it/s][A
Iteration:  87%|████████▋ | 232/268 [01:02<00:25,  1.43it/s][A
Iteration:  87%|████████▋ | 233/268 [01:02<00:19,  1.82it/s][A
Iteration:  87%|████████▋ | 234/268 [01:02<00:15,  2.25it/s][A
Iteration:  88%|████████▊ | 235/268 [01:02<00:12,  2.71it/s][A
Iteration:  88%|████████▊ | 236/268 [01:03<00:10,  3.18it/s][A
Iteration:  88%|████████▊ | 237/268 [01:03<00:08,  3.56it/s][A
Iteration:  89%|████████▉ | 238/268 [01:03<00:07,  3.96it/s][A
Iteration:  89%|████████▉ | 239/268 [01:03<00:06,  4.28it/s][A
Iteration:  90%|████████▉ | 240/268 [01:03<00:06,  4.36it/s][A
Iteration:  90%|████████▉ | 241/268 [01:04<00:05,  4.68it/s][A
Iteration:  90%|█████████ | 242/268 [01:04<00:05,  4.70it/s][A
Iteration:  91%|█████████ | 243/268 [01:04<00:05,  4.86it/s][A
Iteration:  91%|█████████ | 244/268 [01:04<00:04,  4.88it/s][A
Iteration:  91%|█████████▏| 245/268 [01:04<00:04,  4.99it/s][A
Iteration:  92%|█████████▏| 246/268 [01:05<00:04,  5.08it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:04,  5.07it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:03,  5.14it/s][A
Iteration:  93%|█████████▎| 249/268 [01:05<00:03,  5.15it/s][A
Iteration:  93%|█████████▎| 250/268 [01:05<00:03,  5.16it/s][A
Iteration:  94%|█████████▎| 251/268 [01:05<00:03,  5.21it/s][A
Iteration:  94%|█████████▍| 252/268 [01:06<00:03,  5.20it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:02,  5.20it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:02,  5.00it/s][A
Iteration:  95%|█████████▌| 255/268 [01:06<00:02,  5.06it/s][A
Iteration:  96%|█████████▌| 256/268 [01:06<00:02,  5.03it/s][A
Iteration:  96%|█████████▌| 257/268 [01:07<00:02,  5.20it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:01,  5.24it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  5.22it/s][A
Iteration:  97%|█████████▋| 260/268 [01:07<00:01,  5.24it/s][A
Iteration:  97%|█████████▋| 261/268 [01:07<00:01,  5.15it/s][A
Iteration:  98%|█████████▊| 262/268 [01:08<00:01,  5.28it/s][A
Iteration:  98%|█████████▊| 263/268 [01:08<00:00,  5.29it/s][A
Iteration:  99%|█████████▊| 264/268 [01:08<00:00,  5.14it/s][A
Iteration:  99%|█████████▉| 265/268 [01:08<00:00,  5.26it/s][A
Iteration:  99%|█████████▉| 266/268 [01:08<00:00,  5.21it/s][A
Iteration: 100%|█████████▉| 267/268 [01:09<00:00,  5.20it/s][A
Iteration: 100%|██████████| 268/268 [01:09<00:00,  5.64it/s][A04/30/2024 10:31:44 - INFO - trainer.trainer_mod_2 - Epoch 15 finished. Took 69.2 seconds.
Iteration: 100%|██████████| 268/268 [01:09<00:00,  3.87it/s]
Epoch:  16%|█▌        | 16/100 [18:51<1:38:18, 70.21s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:52,  5.04it/s][A
Iteration:   1%|          | 2/268 [00:00<00:54,  4.86it/s][A
Iteration:   1%|          | 3/268 [00:00<00:52,  5.01it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:50,  5.23it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.20it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:49,  5.33it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:48,  5.33it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:49,  5.28it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:51,  5.04it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:53,  4.86it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:51,  4.98it/s][A[INFO|trainer.py:570] 2024-04-30 10:31:47,229 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:31:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:31:47 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:31:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:31:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:31:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:31:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.4665022636963934, 'eval_loss': 0.89125717, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [618, 693, 899, 944, 917, 937, 709, 556, 282, 423, 246, 279], 'head_nums': [6, 5, 4, 7, 8, 8, 7, 3, 3, 2, 3, 6], 'pruned_params': 62817388, 'remaining_params': 22200212, 'pruned_model_sparsity': 0.7388751035079795, 'expected_sparsity': 0.73743, 'target_sparsity': 0.7444029850746269, 'step': 4300}


Iteration:   4%|▍         | 12/268 [00:05<05:19,  1.25s/it][A04/30/2024 10:31:50 - INFO - trainer.trainer_mod_2 - v4 Global step: 4300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   5%|▍         | 13/268 [00:06<03:57,  1.07it/s][A
Iteration:   5%|▌         | 14/268 [00:06<02:58,  1.42it/s][A
Iteration:   6%|▌         | 15/268 [00:06<02:19,  1.82it/s][A
Iteration:   6%|▌         | 16/268 [00:06<01:50,  2.29it/s][A
Iteration:   6%|▋         | 17/268 [00:06<01:31,  2.73it/s][A
Iteration:   7%|▋         | 18/268 [00:06<01:19,  3.13it/s][A
Iteration:   7%|▋         | 19/268 [00:07<01:09,  3.61it/s][A
Iteration:   7%|▋         | 20/268 [00:07<01:02,  3.96it/s][A
Iteration:   8%|▊         | 21/268 [00:07<00:58,  4.23it/s][A
Iteration:   8%|▊         | 22/268 [00:07<00:53,  4.57it/s][A
Iteration:   9%|▊         | 23/268 [00:07<00:52,  4.64it/s][A
Iteration:   9%|▉         | 24/268 [00:08<00:51,  4.72it/s][A
Iteration:   9%|▉         | 25/268 [00:08<00:49,  4.88it/s][A
Iteration:  10%|▉         | 26/268 [00:08<00:49,  4.91it/s][A
Iteration:  10%|█         | 27/268 [00:08<00:49,  4.82it/s][A
Iteration:  10%|█         | 28/268 [00:08<00:48,  4.95it/s][A
Iteration:  11%|█         | 29/268 [00:09<00:48,  4.89it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:48,  4.94it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:47,  5.04it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:46,  5.12it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:45,  5.14it/s][A
Iteration:  13%|█▎        | 34/268 [00:10<00:45,  5.15it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:45,  5.08it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:46,  5.03it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:46,  5.01it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:46,  5.00it/s][A
Iteration:  15%|█▍        | 39/268 [00:11<00:45,  4.98it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:44,  5.08it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:44,  5.04it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:44,  5.14it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:43,  5.18it/s][A
Iteration:  16%|█▋        | 44/268 [00:12<00:43,  5.19it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:42,  5.22it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:43,  5.16it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:41,  5.30it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:40,  5.44it/s][A
Iteration:  18%|█▊        | 49/268 [00:13<00:41,  5.31it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:40,  5.39it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:39,  5.44it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:39,  5.40it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:40,  5.35it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:39,  5.41it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:39,  5.33it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:39,  5.34it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:39,  5.40it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:39,  5.37it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:39,  5.31it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:39,  5.24it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:40,  5.15it/s][A[INFO|trainer.py:570] 2024-04-30 10:32:00,297 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:32:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:32:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:32:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:32:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.66it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.68it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.68it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:32:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:32:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.5264763891845121, 'eval_loss': 0.76400113, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [599, 673, 873, 916, 889, 909, 686, 538, 276, 386, 230, 271], 'head_nums': [6, 4, 4, 7, 8, 8, 6, 3, 3, 2, 3, 6], 'pruned_params': 63509852, 'remaining_params': 21507748, 'pruned_model_sparsity': 0.7470200523185787, 'expected_sparsity': 0.74587, 'target_sparsity': 0.7532649253731343, 'step': 4350}


Iteration:  23%|██▎       | 62/268 [00:18<04:11,  1.22s/it][A
Iteration:  24%|██▎       | 63/268 [00:19<03:07,  1.09it/s][A
Iteration:  24%|██▍       | 64/268 [00:19<02:21,  1.44it/s][A
Iteration:  24%|██▍       | 65/268 [00:19<01:50,  1.85it/s][A
Iteration:  25%|██▍       | 66/268 [00:19<01:28,  2.29it/s][A
Iteration:  25%|██▌       | 67/268 [00:19<01:13,  2.75it/s][A
Iteration:  25%|██▌       | 68/268 [00:20<01:01,  3.24it/s][A
Iteration:  26%|██▌       | 69/268 [00:20<00:54,  3.67it/s][A
Iteration:  26%|██▌       | 70/268 [00:20<00:49,  4.03it/s][A
Iteration:  26%|██▋       | 71/268 [00:20<00:46,  4.26it/s][A
Iteration:  27%|██▋       | 72/268 [00:20<00:43,  4.53it/s][A
Iteration:  27%|██▋       | 73/268 [00:20<00:40,  4.81it/s][A
Iteration:  28%|██▊       | 74/268 [00:21<00:39,  4.94it/s][A
Iteration:  28%|██▊       | 75/268 [00:21<00:38,  4.96it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<00:38,  5.01it/s][A
Iteration:  29%|██▊       | 77/268 [00:21<00:36,  5.24it/s][A
Iteration:  29%|██▉       | 78/268 [00:21<00:36,  5.25it/s][A
Iteration:  29%|██▉       | 79/268 [00:22<00:35,  5.25it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<00:36,  5.20it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:34,  5.38it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:35,  5.30it/s][A
Iteration:  31%|███       | 83/268 [00:22<00:34,  5.39it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:34,  5.27it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:34,  5.29it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:34,  5.25it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:34,  5.28it/s][A
Iteration:  33%|███▎      | 88/268 [00:23<00:34,  5.28it/s][A
Iteration:  33%|███▎      | 89/268 [00:23<00:34,  5.20it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:34,  5.22it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:33,  5.23it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:33,  5.20it/s][A
Iteration:  35%|███▍      | 93/268 [00:24<00:34,  5.12it/s][A
Iteration:  35%|███▌      | 94/268 [00:24<00:33,  5.12it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:34,  5.07it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:33,  5.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:33,  5.09it/s][A
Iteration:  37%|███▋      | 98/268 [00:25<00:33,  5.13it/s][A
Iteration:  37%|███▋      | 99/268 [00:25<00:32,  5.14it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:32,  5.20it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:32,  5.18it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:31,  5.23it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:31,  5.21it/s][A
Iteration:  39%|███▉      | 104/268 [00:26<00:31,  5.22it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:31,  5.22it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:32,  5.00it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:31,  5.10it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:30,  5.25it/s][A
Iteration:  41%|████      | 109/268 [00:27<00:30,  5.15it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:30,  5.15it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:30,  5.19it/s][A[INFO|trainer.py:570] 2024-04-30 10:32:13,292 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:32:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:32:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:32:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:32:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.70it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.69it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.62it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.64it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.66it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.79it/s]04/30/2024 10:32:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:32:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.488445640649576, 'eval_loss': 0.93656063, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [582, 653, 850, 890, 863, 882, 664, 520, 269, 354, 218, 264], 'head_nums': [6, 4, 4, 7, 8, 8, 6, 2, 2, 2, 3, 5], 'pruned_params': 64383092, 'remaining_params': 20634508, 'pruned_model_sparsity': 0.7572913373230955, 'expected_sparsity': 0.75372, 'target_sparsity': 0.7621268656716418, 'step': 4400}


Iteration:  42%|████▏     | 112/268 [00:31<03:10,  1.22s/it][A04/30/2024 10:32:16 - INFO - trainer.trainer_mod_2 - v4 Global step: 4400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  42%|████▏     | 113/268 [00:32<02:21,  1.09it/s][A
Iteration:  43%|████▎     | 114/268 [00:32<01:47,  1.43it/s][A
Iteration:  43%|████▎     | 115/268 [00:32<01:23,  1.83it/s][A
Iteration:  43%|████▎     | 116/268 [00:32<01:06,  2.28it/s][A
Iteration:  44%|████▎     | 117/268 [00:32<00:56,  2.69it/s][A
Iteration:  44%|████▍     | 118/268 [00:33<00:47,  3.16it/s][A
Iteration:  44%|████▍     | 119/268 [00:33<00:41,  3.56it/s][A
Iteration:  45%|████▍     | 120/268 [00:33<00:37,  3.93it/s][A
Iteration:  45%|████▌     | 121/268 [00:33<00:34,  4.32it/s][A
Iteration:  46%|████▌     | 122/268 [00:33<00:32,  4.44it/s][A
Iteration:  46%|████▌     | 123/268 [00:34<00:30,  4.72it/s][A
Iteration:  46%|████▋     | 124/268 [00:34<00:28,  5.00it/s][A
Iteration:  47%|████▋     | 125/268 [00:34<00:28,  5.05it/s][A
Iteration:  47%|████▋     | 126/268 [00:34<00:28,  5.06it/s][A
Iteration:  47%|████▋     | 127/268 [00:34<00:27,  5.15it/s][A
Iteration:  48%|████▊     | 128/268 [00:34<00:27,  5.15it/s][A
Iteration:  48%|████▊     | 129/268 [00:35<00:26,  5.27it/s][A
Iteration:  49%|████▊     | 130/268 [00:35<00:26,  5.29it/s][A
Iteration:  49%|████▉     | 131/268 [00:35<00:25,  5.29it/s][A
Iteration:  49%|████▉     | 132/268 [00:35<00:25,  5.30it/s][A
Iteration:  50%|████▉     | 133/268 [00:35<00:25,  5.29it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:25,  5.16it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:25,  5.20it/s][A
Iteration:  51%|█████     | 136/268 [00:36<00:25,  5.18it/s][A
Iteration:  51%|█████     | 137/268 [00:36<00:25,  5.18it/s][A
Iteration:  51%|█████▏    | 138/268 [00:36<00:25,  5.19it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:24,  5.21it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:24,  5.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:24,  5.09it/s][A
Iteration:  53%|█████▎    | 142/268 [00:37<00:23,  5.27it/s][A
Iteration:  53%|█████▎    | 143/268 [00:37<00:23,  5.28it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:24,  5.06it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:24,  4.92it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:24,  5.01it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<00:23,  5.04it/s][A
Iteration:  55%|█████▌    | 148/268 [00:38<00:23,  5.06it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:23,  5.05it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:23,  5.09it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:23,  4.97it/s][A
Iteration:  57%|█████▋    | 152/268 [00:39<00:23,  4.99it/s][A
Iteration:  57%|█████▋    | 153/268 [00:39<00:22,  5.07it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:22,  5.11it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:21,  5.15it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:21,  5.18it/s][A
Iteration:  59%|█████▊    | 157/268 [00:40<00:21,  5.13it/s][A
Iteration:  59%|█████▉    | 158/268 [00:40<00:20,  5.33it/s][A
Iteration:  59%|█████▉    | 159/268 [00:40<00:20,  5.30it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:20,  5.29it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:19,  5.45it/s][A[INFO|trainer.py:570] 2024-04-30 10:32:26,368 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:32:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:32:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:32:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:32:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.67it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.68it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.69it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.70it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.69it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.68it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.68it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.69it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.69it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.69it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.80it/s]04/30/2024 10:32:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:32:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.48419799152198045, 'eval_loss': 0.7860896, 'head_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [565, 633, 827, 865, 838, 856, 643, 505, 263, 327, 209, 257], 'head_nums': [6, 4, 4, 7, 8, 8, 5, 2, 2, 2, 3, 5], 'pruned_params': 64851884, 'remaining_params': 20165716, 'pruned_model_sparsity': 0.7628053955886781, 'expected_sparsity': 0.76342, 'target_sparsity': 0.7709888059701492, 'step': 4450}


Iteration:  60%|██████    | 162/268 [00:44<02:09,  1.22s/it][A
Iteration:  61%|██████    | 163/268 [00:45<01:35,  1.10it/s][A
Iteration:  61%|██████    | 164/268 [00:45<01:11,  1.45it/s][A
Iteration:  62%|██████▏   | 165/268 [00:45<00:56,  1.84it/s][A
Iteration:  62%|██████▏   | 166/268 [00:45<00:44,  2.28it/s][A
Iteration:  62%|██████▏   | 167/268 [00:45<00:36,  2.74it/s][A
Iteration:  63%|██████▎   | 168/268 [00:46<00:31,  3.17it/s][A
Iteration:  63%|██████▎   | 169/268 [00:46<00:28,  3.49it/s][A
Iteration:  63%|██████▎   | 170/268 [00:46<00:25,  3.90it/s][A
Iteration:  64%|██████▍   | 171/268 [00:46<00:22,  4.24it/s][A
Iteration:  64%|██████▍   | 172/268 [00:46<00:21,  4.52it/s][A
Iteration:  65%|██████▍   | 173/268 [00:47<00:20,  4.62it/s][A
Iteration:  65%|██████▍   | 174/268 [00:47<00:19,  4.88it/s][A
Iteration:  65%|██████▌   | 175/268 [00:47<00:18,  4.90it/s][A
Iteration:  66%|██████▌   | 176/268 [00:47<00:17,  5.14it/s][A
Iteration:  66%|██████▌   | 177/268 [00:47<00:17,  5.08it/s][A
Iteration:  66%|██████▋   | 178/268 [00:48<00:17,  5.15it/s][A
Iteration:  67%|██████▋   | 179/268 [00:48<00:17,  5.15it/s][A
Iteration:  67%|██████▋   | 180/268 [00:48<00:17,  5.02it/s][A
Iteration:  68%|██████▊   | 181/268 [00:48<00:16,  5.16it/s][A
Iteration:  68%|██████▊   | 182/268 [00:48<00:17,  4.98it/s][A
Iteration:  68%|██████▊   | 183/268 [00:49<00:17,  4.98it/s][A
Iteration:  69%|██████▊   | 184/268 [00:49<00:16,  5.03it/s][A
Iteration:  69%|██████▉   | 185/268 [00:49<00:16,  5.09it/s][A
Iteration:  69%|██████▉   | 186/268 [00:49<00:15,  5.15it/s][A
Iteration:  70%|██████▉   | 187/268 [00:49<00:15,  5.34it/s][A
Iteration:  70%|███████   | 188/268 [00:49<00:15,  5.32it/s][A
Iteration:  71%|███████   | 189/268 [00:50<00:14,  5.40it/s][A
Iteration:  71%|███████   | 190/268 [00:50<00:14,  5.38it/s][A
Iteration:  71%|███████▏  | 191/268 [00:50<00:14,  5.17it/s][A
Iteration:  72%|███████▏  | 192/268 [00:50<00:14,  5.10it/s][A
Iteration:  72%|███████▏  | 193/268 [00:50<00:14,  5.15it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:14,  5.12it/s][A
Iteration:  73%|███████▎  | 195/268 [00:51<00:15,  4.84it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:14,  4.87it/s][A
Iteration:  74%|███████▎  | 197/268 [00:51<00:13,  5.09it/s][A
Iteration:  74%|███████▍  | 198/268 [00:51<00:13,  5.16it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:13,  5.21it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:13,  5.06it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:12,  5.21it/s][A
Iteration:  75%|███████▌  | 202/268 [00:52<00:12,  5.20it/s][A
Iteration:  76%|███████▌  | 203/268 [00:52<00:12,  5.12it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:12,  5.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:53<00:12,  5.23it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:11,  5.33it/s][A
Iteration:  77%|███████▋  | 207/268 [00:53<00:11,  5.32it/s][A
Iteration:  78%|███████▊  | 208/268 [00:53<00:11,  5.32it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  5.20it/s][A
Iteration:  78%|███████▊  | 210/268 [00:54<00:11,  5.15it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:11,  5.08it/s][A[INFO|trainer.py:570] 2024-04-30 10:32:39,471 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:32:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:32:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:32:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:32:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.70it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.83it/s]04/30/2024 10:32:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:32:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.42239354524181305, 'eval_loss': 0.9272198, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [550, 616, 806, 841, 814, 834, 624, 490, 257, 303, 200, 251], 'head_nums': [6, 4, 4, 7, 8, 8, 5, 2, 2, 2, 2, 4], 'pruned_params': 67062560, 'remaining_params': 17955040, 'pruned_model_sparsity': 0.7888079644685336, 'expected_sparsity': 0.77739, 'target_sparsity': 0.7798507462686567, 'step': 4500}


Iteration:  79%|███████▉  | 212/268 [00:58<01:08,  1.22s/it][A04/30/2024 10:32:42 - INFO - trainer.trainer_mod_2 - v4 Global step: 4500, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  79%|███████▉  | 213/268 [00:58<00:50,  1.10it/s][A
Iteration:  80%|███████▉  | 214/268 [00:58<00:37,  1.44it/s][A
Iteration:  80%|████████  | 215/268 [00:58<00:29,  1.82it/s][A
Iteration:  81%|████████  | 216/268 [00:58<00:22,  2.27it/s][A
Iteration:  81%|████████  | 217/268 [00:59<00:18,  2.71it/s][A
Iteration:  81%|████████▏ | 218/268 [00:59<00:15,  3.14it/s][A
Iteration:  82%|████████▏ | 219/268 [00:59<00:13,  3.56it/s][A
Iteration:  82%|████████▏ | 220/268 [00:59<00:12,  3.92it/s][A
Iteration:  82%|████████▏ | 221/268 [00:59<00:11,  4.26it/s][A
Iteration:  83%|████████▎ | 222/268 [01:00<00:10,  4.40it/s][A
Iteration:  83%|████████▎ | 223/268 [01:00<00:10,  4.27it/s][A
Iteration:  84%|████████▎ | 224/268 [01:00<00:09,  4.60it/s][A
Iteration:  84%|████████▍ | 225/268 [01:00<00:08,  4.86it/s][A
Iteration:  84%|████████▍ | 226/268 [01:00<00:08,  4.89it/s][A
Iteration:  85%|████████▍ | 227/268 [01:01<00:08,  4.99it/s][A
Iteration:  85%|████████▌ | 228/268 [01:01<00:07,  5.09it/s][A
Iteration:  85%|████████▌ | 229/268 [01:01<00:07,  5.08it/s][A
Iteration:  86%|████████▌ | 230/268 [01:01<00:07,  5.00it/s][A
Iteration:  86%|████████▌ | 231/268 [01:01<00:07,  5.08it/s][A
Iteration:  87%|████████▋ | 232/268 [01:01<00:07,  5.05it/s][A
Iteration:  87%|████████▋ | 233/268 [01:02<00:07,  4.89it/s][A
Iteration:  87%|████████▋ | 234/268 [01:02<00:07,  4.85it/s][A
Iteration:  88%|████████▊ | 235/268 [01:02<00:06,  4.97it/s][A
Iteration:  88%|████████▊ | 236/268 [01:02<00:06,  4.89it/s][A
Iteration:  88%|████████▊ | 237/268 [01:03<00:06,  5.02it/s][A
Iteration:  89%|████████▉ | 238/268 [01:03<00:05,  5.07it/s][A
Iteration:  89%|████████▉ | 239/268 [01:03<00:05,  5.14it/s][A
Iteration:  90%|████████▉ | 240/268 [01:03<00:05,  5.10it/s][A
Iteration:  90%|████████▉ | 241/268 [01:03<00:05,  5.17it/s][A
Iteration:  90%|█████████ | 242/268 [01:03<00:05,  5.18it/s][A
Iteration:  91%|█████████ | 243/268 [01:04<00:04,  5.17it/s][A
Iteration:  91%|█████████ | 244/268 [01:04<00:04,  5.05it/s][A
Iteration:  91%|█████████▏| 245/268 [01:04<00:04,  5.09it/s][A
Iteration:  92%|█████████▏| 246/268 [01:04<00:04,  5.07it/s][A
Iteration:  92%|█████████▏| 247/268 [01:04<00:04,  5.14it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:03,  5.20it/s][A
Iteration:  93%|█████████▎| 249/268 [01:05<00:03,  5.25it/s][A
Iteration:  93%|█████████▎| 250/268 [01:05<00:03,  5.18it/s][A
Iteration:  94%|█████████▎| 251/268 [01:05<00:03,  4.90it/s][A
Iteration:  94%|█████████▍| 252/268 [01:05<00:03,  4.99it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:02,  5.07it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:02,  5.10it/s][A
Iteration:  95%|█████████▌| 255/268 [01:06<00:02,  5.14it/s][A
Iteration:  96%|█████████▌| 256/268 [01:06<00:02,  5.18it/s][A
Iteration:  96%|█████████▌| 257/268 [01:06<00:02,  5.09it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:01,  5.12it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  5.05it/s][A
Iteration:  97%|█████████▋| 260/268 [01:07<00:01,  5.12it/s][A
Iteration:  97%|█████████▋| 261/268 [01:07<00:01,  5.16it/s][A[INFO|trainer.py:570] 2024-04-30 10:32:52,725 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:32:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:32:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:32:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:32:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.70it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.83it/s]04/30/2024 10:32:56 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:32:56 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3945360499798347, 'eval_loss': 0.88792586, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [536, 599, 786, 817, 791, 812, 606, 477, 252, 283, 193, 245], 'head_nums': [6, 4, 4, 7, 8, 8, 5, 2, 2, 2, 2, 3], 'pruned_params': 67497648, 'remaining_params': 17519952, 'pruned_model_sparsity': 0.7939255871725384, 'expected_sparsity': 0.78683, 'target_sparsity': 0.7887126865671641, 'step': 4550}


Iteration:  98%|█████████▊| 262/268 [01:11<00:07,  1.22s/it][A
Iteration:  98%|█████████▊| 263/268 [01:11<00:04,  1.10it/s][A
Iteration:  99%|█████████▊| 264/268 [01:11<00:02,  1.45it/s][A
Iteration:  99%|█████████▉| 265/268 [01:11<00:01,  1.83it/s][A
Iteration:  99%|█████████▉| 266/268 [01:12<00:00,  2.30it/s][A
Iteration: 100%|█████████▉| 267/268 [01:12<00:00,  2.74it/s][A
Iteration: 100%|██████████| 268/268 [01:12<00:00,  3.36it/s][A04/30/2024 10:32:57 - INFO - trainer.trainer_mod_2 - Epoch 16 finished. Took 72.39 seconds.
Iteration: 100%|██████████| 268/268 [01:12<00:00,  3.70it/s]
Epoch:  17%|█▋        | 17/100 [20:03<1:38:02, 70.87s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:50,  5.31it/s][A
Iteration:   1%|          | 2/268 [00:00<00:54,  4.88it/s][A
Iteration:   1%|          | 3/268 [00:00<00:52,  5.08it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:51,  5.13it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:52,  5.06it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:51,  5.09it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:51,  5.05it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:51,  5.09it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:50,  5.15it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:50,  5.16it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:49,  5.20it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:48,  5.23it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:48,  5.27it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:48,  5.20it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:49,  5.15it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:50,  5.02it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:51,  4.92it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:49,  5.00it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:48,  5.09it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:48,  5.14it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:47,  5.18it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:47,  5.18it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:46,  5.31it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:48,  5.06it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:47,  5.13it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:47,  5.15it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:46,  5.19it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:46,  5.12it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:46,  5.18it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:44,  5.37it/s][A
Iteration:  12%|█▏        | 31/268 [00:06<00:45,  5.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:46,  5.11it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:45,  5.12it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:44,  5.27it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:44,  5.19it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:44,  5.25it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:43,  5.26it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:43,  5.29it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:43,  5.31it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:42,  5.32it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:42,  5.31it/s][A
Iteration:  16%|█▌        | 42/268 [00:08<00:41,  5.40it/s][A
Iteration:  16%|█▌        | 43/268 [00:08<00:41,  5.36it/s][A[INFO|trainer.py:570] 2024-04-30 10:33:05,733 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:33:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:33:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:33:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:33:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.70it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.83it/s]04/30/2024 10:33:09 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:33:09 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.42727410372514657, 'eval_loss': 0.85798705, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [523, 583, 767, 796, 770, 792, 590, 465, 247, 266, 188, 240], 'head_nums': [6, 4, 4, 7, 8, 8, 5, 2, 2, 2, 2, 3], 'pruned_params': 67716724, 'remaining_params': 17300876, 'pruned_model_sparsity': 0.7965024183227943, 'expected_sparsity': 0.79287, 'target_sparsity': 0.7975746268656716, 'step': 4600}


Iteration:  16%|█▋        | 44/268 [00:11<04:32,  1.22s/it][A04/30/2024 10:33:09 - INFO - trainer.trainer_mod_2 - v4 Global step: 4600, Alignment: tensor([ 2,  5,  9, 11], device='cuda:0')

Iteration:  17%|█▋        | 45/268 [00:12<03:22,  1.10it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<02:33,  1.44it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<02:01,  1.82it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<01:38,  2.24it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<01:20,  2.73it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<01:08,  3.20it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<01:00,  3.60it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:53,  4.04it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:49,  4.33it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:47,  4.55it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:44,  4.74it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:43,  4.90it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:42,  4.92it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:41,  5.02it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:39,  5.23it/s][A
Iteration:  22%|██▏       | 60/268 [00:14<00:40,  5.11it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:41,  5.02it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:40,  5.10it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:39,  5.16it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:39,  5.21it/s][A
Iteration:  24%|██▍       | 65/268 [00:15<00:39,  5.14it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:39,  5.11it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:39,  5.07it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:40,  4.98it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:39,  5.08it/s][A
Iteration:  26%|██▌       | 70/268 [00:16<00:38,  5.10it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:38,  5.12it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:38,  5.08it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:37,  5.17it/s][A
Iteration:  28%|██▊       | 74/268 [00:17<00:37,  5.11it/s][A
Iteration:  28%|██▊       | 75/268 [00:17<00:38,  5.07it/s][A
Iteration:  28%|██▊       | 76/268 [00:18<00:37,  5.10it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:36,  5.29it/s][A
Iteration:  29%|██▉       | 78/268 [00:18<00:36,  5.17it/s][A
Iteration:  29%|██▉       | 79/268 [00:18<00:36,  5.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:18<00:36,  5.17it/s][A
Iteration:  30%|███       | 81/268 [00:19<00:35,  5.22it/s][A
Iteration:  31%|███       | 82/268 [00:19<00:35,  5.17it/s][A
Iteration:  31%|███       | 83/268 [00:19<00:35,  5.20it/s][A
Iteration:  31%|███▏      | 84/268 [00:19<00:35,  5.15it/s][A
Iteration:  32%|███▏      | 85/268 [00:19<00:35,  5.20it/s][A
Iteration:  32%|███▏      | 86/268 [00:20<00:34,  5.24it/s][A
Iteration:  32%|███▏      | 87/268 [00:20<00:34,  5.20it/s][A
Iteration:  33%|███▎      | 88/268 [00:20<00:34,  5.24it/s][A
Iteration:  33%|███▎      | 89/268 [00:20<00:33,  5.27it/s][A
Iteration:  34%|███▎      | 90/268 [00:20<00:33,  5.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:20<00:33,  5.27it/s][A
Iteration:  34%|███▍      | 92/268 [00:21<00:33,  5.29it/s][A
Iteration:  35%|███▍      | 93/268 [00:21<00:34,  5.11it/s][A[INFO|trainer.py:570] 2024-04-30 10:33:18,811 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:33:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:33:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:33:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:33:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.70it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.83it/s]04/30/2024 10:33:22 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:33:22 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.43591443951045983, 'eval_loss': 0.9134441, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [511, 568, 749, 774, 751, 773, 575, 453, 243, 251, 183, 235], 'head_nums': [5, 4, 4, 6, 8, 8, 5, 2, 2, 2, 2, 2], 'pruned_params': 68513364, 'remaining_params': 16504236, 'pruned_model_sparsity': 0.8058727134146342, 'expected_sparsity': 0.79929, 'target_sparsity': 0.806436567164179, 'step': 4650}


Iteration:  35%|███▌      | 94/268 [00:24<03:32,  1.22s/it][A
Iteration:  35%|███▌      | 95/268 [00:25<02:36,  1.10it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<01:58,  1.45it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<01:32,  1.84it/s][A
Iteration:  37%|███▋      | 98/268 [00:25<01:14,  2.29it/s][A
Iteration:  37%|███▋      | 99/268 [00:25<01:01,  2.75it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:53,  3.16it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:46,  3.58it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:44,  3.69it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:40,  4.06it/s][A
Iteration:  39%|███▉      | 104/268 [00:26<00:38,  4.29it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:35,  4.57it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:34,  4.68it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:32,  4.92it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:31,  5.04it/s][A
Iteration:  41%|████      | 109/268 [00:27<00:31,  4.99it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:31,  5.08it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:31,  5.05it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:31,  5.01it/s][A
Iteration:  42%|████▏     | 113/268 [00:28<00:30,  5.05it/s][A
Iteration:  43%|████▎     | 114/268 [00:28<00:30,  5.09it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:30,  4.97it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:29,  5.14it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:29,  5.11it/s][A
Iteration:  44%|████▍     | 118/268 [00:29<00:29,  5.16it/s][A
Iteration:  44%|████▍     | 119/268 [00:29<00:28,  5.15it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:29,  5.09it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:28,  5.15it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:28,  5.21it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:28,  5.13it/s][A
Iteration:  46%|████▋     | 124/268 [00:30<00:27,  5.19it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:27,  5.13it/s][A
Iteration:  47%|████▋     | 126/268 [00:31<00:27,  5.19it/s][A
Iteration:  47%|████▋     | 127/268 [00:31<00:27,  5.21it/s][A
Iteration:  48%|████▊     | 128/268 [00:31<00:26,  5.23it/s][A
Iteration:  48%|████▊     | 129/268 [00:31<00:26,  5.17it/s][A
Iteration:  49%|████▊     | 130/268 [00:31<00:26,  5.28it/s][A
Iteration:  49%|████▉     | 131/268 [00:32<00:25,  5.30it/s][A
Iteration:  49%|████▉     | 132/268 [00:32<00:25,  5.29it/s][A
Iteration:  50%|████▉     | 133/268 [00:32<00:25,  5.29it/s][A
Iteration:  50%|█████     | 134/268 [00:32<00:25,  5.19it/s][A
Iteration:  50%|█████     | 135/268 [00:32<00:25,  5.20it/s][A
Iteration:  51%|█████     | 136/268 [00:33<00:24,  5.30it/s][A
Iteration:  51%|█████     | 137/268 [00:33<00:24,  5.30it/s][A
Iteration:  51%|█████▏    | 138/268 [00:33<00:25,  5.07it/s][A
Iteration:  52%|█████▏    | 139/268 [00:33<00:25,  5.10it/s][A
Iteration:  52%|█████▏    | 140/268 [00:33<00:24,  5.14it/s][A
Iteration:  53%|█████▎    | 141/268 [00:34<00:25,  4.94it/s][A
Iteration:  53%|█████▎    | 142/268 [00:34<00:25,  5.03it/s][A
Iteration:  53%|█████▎    | 143/268 [00:34<00:24,  5.02it/s][A[INFO|trainer.py:570] 2024-04-30 10:33:31,974 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:33:31 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:33:31 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:33:31 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:33:32 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.70it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.83it/s]04/30/2024 10:33:35 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:33:35 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.42631677443771676, 'eval_loss': 0.8472484, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [500, 554, 733, 754, 732, 754, 560, 442, 239, 239, 179, 230], 'head_nums': [5, 4, 4, 5, 8, 8, 5, 2, 2, 2, 2, 2], 'pruned_params': 68907088, 'remaining_params': 16110512, 'pruned_model_sparsity': 0.8105038015657934, 'expected_sparsity': 0.80452, 'target_sparsity': 0.8152985074626866, 'step': 4700}


Iteration:  54%|█████▎    | 144/268 [00:38<02:31,  1.22s/it][A04/30/2024 10:33:35 - INFO - trainer.trainer_mod_2 - v4 Global step: 4700, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  54%|█████▍    | 145/268 [00:38<01:52,  1.09it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<01:25,  1.42it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<01:07,  1.80it/s][A
Iteration:  55%|█████▌    | 148/268 [00:38<00:55,  2.18it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:45,  2.64it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:38,  3.10it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:33,  3.53it/s][A
Iteration:  57%|█████▋    | 152/268 [00:39<00:30,  3.81it/s][A
Iteration:  57%|█████▋    | 153/268 [00:39<00:28,  4.09it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:26,  4.37it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:24,  4.62it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:23,  4.78it/s][A
Iteration:  59%|█████▊    | 157/268 [00:40<00:22,  4.93it/s][A
Iteration:  59%|█████▉    | 158/268 [00:40<00:21,  5.02it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:21,  5.03it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:21,  5.05it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:20,  5.11it/s][A
Iteration:  60%|██████    | 162/268 [00:41<00:21,  4.96it/s][A
Iteration:  61%|██████    | 163/268 [00:41<00:20,  5.06it/s][A
Iteration:  61%|██████    | 164/268 [00:42<00:20,  5.09it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:20,  5.14it/s][A
Iteration:  62%|██████▏   | 166/268 [00:42<00:20,  4.99it/s][A
Iteration:  62%|██████▏   | 167/268 [00:42<00:19,  5.08it/s][A
Iteration:  63%|██████▎   | 168/268 [00:42<00:19,  5.22it/s][A
Iteration:  63%|██████▎   | 169/268 [00:43<00:19,  5.03it/s][A
Iteration:  63%|██████▎   | 170/268 [00:43<00:19,  5.08it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:18,  5.21it/s][A
Iteration:  64%|██████▍   | 172/268 [00:43<00:18,  5.23it/s][A
Iteration:  65%|██████▍   | 173/268 [00:43<00:18,  5.26it/s][A
Iteration:  65%|██████▍   | 174/268 [00:44<00:17,  5.37it/s][A
Iteration:  65%|██████▌   | 175/268 [00:44<00:17,  5.31it/s][A
Iteration:  66%|██████▌   | 176/268 [00:44<00:18,  5.08it/s][A
Iteration:  66%|██████▌   | 177/268 [00:44<00:17,  5.10it/s][A
Iteration:  66%|██████▋   | 178/268 [00:44<00:18,  4.99it/s][A
Iteration:  67%|██████▋   | 179/268 [00:45<00:17,  5.05it/s][A
Iteration:  67%|██████▋   | 180/268 [00:45<00:17,  5.11it/s][A
Iteration:  68%|██████▊   | 181/268 [00:45<00:16,  5.26it/s][A
Iteration:  68%|██████▊   | 182/268 [00:45<00:16,  5.24it/s][A
Iteration:  68%|██████▊   | 183/268 [00:45<00:16,  5.23it/s][A
Iteration:  69%|██████▊   | 184/268 [00:45<00:16,  5.16it/s][A
Iteration:  69%|██████▉   | 185/268 [00:46<00:16,  5.17it/s][A
Iteration:  69%|██████▉   | 186/268 [00:46<00:15,  5.22it/s][A
Iteration:  70%|██████▉   | 187/268 [00:46<00:15,  5.24it/s][A
Iteration:  70%|███████   | 188/268 [00:46<00:15,  5.17it/s][A
Iteration:  71%|███████   | 189/268 [00:46<00:15,  5.18it/s][A
Iteration:  71%|███████   | 190/268 [00:47<00:15,  5.14it/s][A
Iteration:  71%|███████▏  | 191/268 [00:47<00:14,  5.27it/s][A
Iteration:  72%|███████▏  | 192/268 [00:47<00:14,  5.10it/s][A
Iteration:  72%|███████▏  | 193/268 [00:47<00:14,  5.08it/s][A[INFO|trainer.py:570] 2024-04-30 10:33:45,173 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:33:45 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:33:45 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:33:45 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:33:45 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.69it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.70it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.72it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.54it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.60it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.64it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.66it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.68it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.69it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.70it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.71it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.71it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.71it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.71it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.71it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.71it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.71it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.71it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.81it/s]04/30/2024 10:33:48 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:33:48 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3933365889550147, 'eval_loss': 0.85942477, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [489, 540, 716, 734, 715, 737, 546, 431, 236, 228, 176, 225], 'head_nums': [4, 4, 4, 5, 8, 8, 5, 2, 2, 2, 2, 2], 'pruned_params': 69293152, 'remaining_params': 15724448, 'pruned_model_sparsity': 0.815044790725685, 'expected_sparsity': 0.80821, 'target_sparsity': 0.824160447761194, 'step': 4750}


Iteration:  72%|███████▏  | 194/268 [00:51<01:30,  1.22s/it][A
Iteration:  73%|███████▎  | 195/268 [00:51<01:06,  1.09it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:50,  1.43it/s][A
Iteration:  74%|███████▎  | 197/268 [00:51<00:39,  1.82it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:31,  2.24it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:25,  2.70it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:21,  3.17it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:18,  3.65it/s][A
Iteration:  75%|███████▌  | 202/268 [00:52<00:16,  3.97it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:14,  4.35it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:14,  4.57it/s][A
Iteration:  76%|███████▋  | 205/268 [00:53<00:13,  4.68it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:12,  4.86it/s][A
Iteration:  77%|███████▋  | 207/268 [00:53<00:12,  4.96it/s][A
Iteration:  78%|███████▊  | 208/268 [00:54<00:11,  5.02it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  4.95it/s][A
Iteration:  78%|███████▊  | 210/268 [00:54<00:11,  4.91it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:11,  4.93it/s][A
Iteration:  79%|███████▉  | 212/268 [00:54<00:10,  5.17it/s][A
Iteration:  79%|███████▉  | 213/268 [00:55<00:10,  5.30it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:10,  5.30it/s][A
Iteration:  80%|████████  | 215/268 [00:55<00:10,  5.08it/s][A
Iteration:  81%|████████  | 216/268 [00:55<00:10,  5.07it/s][A
Iteration:  81%|████████  | 217/268 [00:55<00:10,  4.98it/s][A
Iteration:  81%|████████▏ | 218/268 [00:56<00:09,  5.15it/s][A
Iteration:  82%|████████▏ | 219/268 [00:56<00:09,  5.11it/s][A
Iteration:  82%|████████▏ | 220/268 [00:56<00:09,  5.18it/s][A
Iteration:  82%|████████▏ | 221/268 [00:56<00:08,  5.36it/s][A
Iteration:  83%|████████▎ | 222/268 [00:56<00:08,  5.35it/s][A
Iteration:  83%|████████▎ | 223/268 [00:56<00:08,  5.22it/s][A
Iteration:  84%|████████▎ | 224/268 [00:57<00:08,  5.20it/s][A
Iteration:  84%|████████▍ | 225/268 [00:57<00:08,  5.19it/s][A
Iteration:  84%|████████▍ | 226/268 [00:57<00:08,  5.18it/s][A
Iteration:  85%|████████▍ | 227/268 [00:57<00:07,  5.18it/s][A
Iteration:  85%|████████▌ | 228/268 [00:57<00:07,  5.14it/s][A
Iteration:  85%|████████▌ | 229/268 [00:58<00:07,  5.08it/s][A
Iteration:  86%|████████▌ | 230/268 [00:58<00:07,  5.15it/s][A
Iteration:  86%|████████▌ | 231/268 [00:58<00:07,  4.88it/s][A
Iteration:  87%|████████▋ | 232/268 [00:58<00:07,  4.97it/s][A
Iteration:  87%|████████▋ | 233/268 [00:58<00:06,  5.19it/s][A
Iteration:  87%|████████▋ | 234/268 [00:59<00:06,  5.13it/s][A
Iteration:  88%|████████▊ | 235/268 [00:59<00:06,  5.19it/s][A
Iteration:  88%|████████▊ | 236/268 [00:59<00:06,  5.09it/s][A
Iteration:  88%|████████▊ | 237/268 [00:59<00:06,  5.13it/s][A
Iteration:  89%|████████▉ | 238/268 [00:59<00:05,  5.17it/s][A
Iteration:  89%|████████▉ | 239/268 [01:00<00:05,  5.21it/s][A
Iteration:  90%|████████▉ | 240/268 [01:00<00:05,  5.20it/s][A
Iteration:  90%|████████▉ | 241/268 [01:00<00:05,  5.21it/s][A
Iteration:  90%|█████████ | 242/268 [01:00<00:04,  5.25it/s][A
Iteration:  91%|█████████ | 243/268 [01:00<00:04,  5.16it/s][A[INFO|trainer.py:570] 2024-04-30 10:33:58,291 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:33:58 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:33:58 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:33:58 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:33:58 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.69it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.83it/s]04/30/2024 10:34:01 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:34:01 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.38357375518005044, 'eval_loss': 0.9799303, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [479, 527, 700, 715, 698, 719, 532, 421, 233, 219, 173, 221], 'head_nums': [4, 4, 4, 5, 8, 8, 5, 2, 2, 2, 2, 2], 'pruned_params': 69476992, 'remaining_params': 15540608, 'pruned_model_sparsity': 0.8172071665161096, 'expected_sparsity': 0.81192, 'target_sparsity': 0.8330223880597015, 'step': 4800}


Iteration:  91%|█████████ | 244/268 [01:04<00:29,  1.22s/it][A04/30/2024 10:34:01 - INFO - trainer.trainer_mod_2 - v4 Global step: 4800, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  91%|█████████▏| 245/268 [01:04<00:20,  1.10it/s][A
Iteration:  92%|█████████▏| 246/268 [01:04<00:15,  1.45it/s][A
Iteration:  92%|█████████▏| 247/268 [01:05<00:11,  1.85it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:08,  2.30it/s][A
Iteration:  93%|█████████▎| 249/268 [01:05<00:06,  2.75it/s][A
Iteration:  93%|█████████▎| 250/268 [01:05<00:05,  3.24it/s][A
Iteration:  94%|█████████▎| 251/268 [01:05<00:04,  3.66it/s][A
Iteration:  94%|█████████▍| 252/268 [01:05<00:03,  4.01it/s][A
Iteration:  94%|█████████▍| 253/268 [01:06<00:03,  4.43it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:03,  4.64it/s][A
Iteration:  95%|█████████▌| 255/268 [01:06<00:02,  4.90it/s][A
Iteration:  96%|█████████▌| 256/268 [01:06<00:02,  4.92it/s][A
Iteration:  96%|█████████▌| 257/268 [01:06<00:02,  5.03it/s][A
Iteration:  96%|█████████▋| 258/268 [01:07<00:01,  5.12it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  5.13it/s][A
Iteration:  97%|█████████▋| 260/268 [01:07<00:01,  5.18it/s][A
Iteration:  97%|█████████▋| 261/268 [01:07<00:01,  5.23it/s][A
Iteration:  98%|█████████▊| 262/268 [01:07<00:01,  5.22it/s][A
Iteration:  98%|█████████▊| 263/268 [01:08<00:00,  5.31it/s][A
Iteration:  99%|█████████▊| 264/268 [01:08<00:00,  5.18it/s][A
Iteration:  99%|█████████▉| 265/268 [01:08<00:00,  5.24it/s][A
Iteration:  99%|█████████▉| 266/268 [01:08<00:00,  5.09it/s][A
Iteration: 100%|█████████▉| 267/268 [01:08<00:00,  5.13it/s][A
Iteration: 100%|██████████| 268/268 [01:08<00:00,  5.66it/s][A04/30/2024 10:34:06 - INFO - trainer.trainer_mod_2 - Epoch 17 finished. Took 68.96 seconds.
Iteration: 100%|██████████| 268/268 [01:08<00:00,  3.89it/s]
Epoch:  18%|█▊        | 18/100 [21:12<1:36:04, 70.30s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:47,  5.56it/s][A
Iteration:   1%|          | 2/268 [00:00<00:49,  5.34it/s][A
Iteration:   1%|          | 3/268 [00:00<00:50,  5.28it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:49,  5.30it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.25it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:50,  5.24it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:49,  5.26it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:49,  5.28it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:49,  5.26it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:49,  5.23it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:48,  5.26it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:53,  4.76it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:51,  4.93it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:50,  5.05it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:49,  5.10it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:48,  5.17it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:48,  5.21it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:48,  5.13it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:48,  5.16it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:48,  5.12it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:47,  5.19it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:48,  5.06it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:47,  5.11it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:45,  5.31it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:45,  5.29it/s][A[INFO|trainer.py:570] 2024-04-30 10:34:11,210 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:34:11 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:34:11 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:34:11 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:34:11 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.69it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.70it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.71it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.71it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.71it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.83it/s]04/30/2024 10:34:14 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:34:14 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.42915398713994973, 'eval_loss': 0.87026554, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [468, 513, 685, 697, 681, 702, 518, 410, 230, 211, 171, 217], 'head_nums': [4, 4, 4, 4, 8, 8, 5, 2, 2, 2, 2, 2], 'pruned_params': 69856928, 'remaining_params': 15160672, 'pruned_model_sparsity': 0.821676076482987, 'expected_sparsity': 0.81529, 'target_sparsity': 0.8418843283582089, 'step': 4850}


Iteration:  10%|▉         | 26/268 [00:08<04:53,  1.21s/it][A
Iteration:  10%|█         | 27/268 [00:08<03:39,  1.10it/s][A
Iteration:  10%|█         | 28/268 [00:08<02:46,  1.44it/s][A
Iteration:  11%|█         | 29/268 [00:09<02:09,  1.85it/s][A
Iteration:  11%|█         | 30/268 [00:09<01:44,  2.28it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<01:26,  2.75it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<01:13,  3.21it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<01:04,  3.63it/s][A
Iteration:  13%|█▎        | 34/268 [00:09<00:58,  4.00it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:53,  4.32it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:51,  4.54it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:49,  4.66it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:48,  4.74it/s][A
Iteration:  15%|█▍        | 39/268 [00:10<00:46,  4.88it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:45,  4.98it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:45,  5.04it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:43,  5.25it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:44,  5.06it/s][A
Iteration:  16%|█▋        | 44/268 [00:11<00:43,  5.10it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:44,  5.05it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:43,  5.10it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:44,  5.00it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:43,  5.01it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:44,  4.91it/s][A
Iteration:  19%|█▊        | 50/268 [00:13<00:44,  4.94it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:43,  4.96it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:43,  5.02it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:42,  5.11it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:41,  5.12it/s][A
Iteration:  21%|██        | 55/268 [00:14<00:41,  5.13it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:41,  5.10it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:40,  5.16it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:41,  5.11it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:40,  5.20it/s][A
Iteration:  22%|██▏       | 60/268 [00:15<00:41,  5.01it/s][A
Iteration:  23%|██▎       | 61/268 [00:15<00:40,  5.09it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:40,  5.05it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:40,  5.10it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:39,  5.13it/s][A
Iteration:  24%|██▍       | 65/268 [00:16<00:39,  5.14it/s][A
Iteration:  25%|██▍       | 66/268 [00:16<00:38,  5.19it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:39,  5.14it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:38,  5.20it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:38,  5.13it/s][A
Iteration:  26%|██▌       | 70/268 [00:17<00:38,  5.14it/s][A
Iteration:  26%|██▋       | 71/268 [00:17<00:38,  5.11it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:38,  5.15it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:39,  4.88it/s][A
Iteration:  28%|██▊       | 74/268 [00:17<00:39,  4.96it/s][A
Iteration:  28%|██▊       | 75/268 [00:18<00:38,  4.99it/s][A[INFO|trainer.py:570] 2024-04-30 10:34:24,412 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:34:24 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:34:24 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:34:24 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:34:24 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.70it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.72it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.83it/s]04/30/2024 10:34:27 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:34:27 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.43604933998123147, 'eval_loss': 0.78773403, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [459, 500, 669, 678, 665, 684, 505, 400, 227, 204, 169, 213], 'head_nums': [4, 4, 4, 4, 8, 8, 5, 2, 2, 2, 2, 2], 'pruned_params': 70036172, 'remaining_params': 14981428, 'pruned_model_sparsity': 0.823784392878651, 'expected_sparsity': 0.81887, 'target_sparsity': 0.8507462686567164, 'step': 4900}


Iteration:  28%|██▊       | 76/268 [00:21<03:54,  1.22s/it][A04/30/2024 10:34:27 - INFO - trainer.trainer_mod_2 - v4 Global step: 4900, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  29%|██▊       | 77/268 [00:21<02:54,  1.09it/s][A
Iteration:  29%|██▉       | 78/268 [00:22<02:12,  1.43it/s][A
Iteration:  29%|██▉       | 79/268 [00:22<01:42,  1.84it/s][A
Iteration:  30%|██▉       | 80/268 [00:22<01:22,  2.29it/s][A
Iteration:  30%|███       | 81/268 [00:22<01:08,  2.75it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:59,  3.11it/s][A
Iteration:  31%|███       | 83/268 [00:22<00:52,  3.55it/s][A
Iteration:  31%|███▏      | 84/268 [00:23<00:45,  4.03it/s][A
Iteration:  32%|███▏      | 85/268 [00:23<00:42,  4.30it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:40,  4.53it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:39,  4.54it/s][A
Iteration:  33%|███▎      | 88/268 [00:23<00:39,  4.60it/s][A
Iteration:  33%|███▎      | 89/268 [00:24<00:38,  4.64it/s][A
Iteration:  34%|███▎      | 90/268 [00:24<00:36,  4.89it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:35,  5.01it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:35,  4.94it/s][A
Iteration:  35%|███▍      | 93/268 [00:24<00:35,  4.96it/s][A
Iteration:  35%|███▌      | 94/268 [00:25<00:34,  5.05it/s][A
Iteration:  35%|███▌      | 95/268 [00:25<00:33,  5.11it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:33,  5.13it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:32,  5.26it/s][A
Iteration:  37%|███▋      | 98/268 [00:25<00:31,  5.36it/s][A
Iteration:  37%|███▋      | 99/268 [00:26<00:31,  5.36it/s][A
Iteration:  37%|███▋      | 100/268 [00:26<00:31,  5.35it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:31,  5.33it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:30,  5.40it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:29,  5.53it/s][A
Iteration:  39%|███▉      | 104/268 [00:27<00:30,  5.46it/s][A
Iteration:  39%|███▉      | 105/268 [00:27<00:30,  5.32it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:31,  5.21it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:30,  5.34it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:29,  5.34it/s][A
Iteration:  41%|████      | 109/268 [00:27<00:29,  5.30it/s][A
Iteration:  41%|████      | 110/268 [00:28<00:30,  5.18it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:30,  5.23it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:29,  5.24it/s][A
Iteration:  42%|████▏     | 113/268 [00:28<00:29,  5.27it/s][A
Iteration:  43%|████▎     | 114/268 [00:28<00:29,  5.25it/s][A
Iteration:  43%|████▎     | 115/268 [00:29<00:29,  5.22it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<00:28,  5.27it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:29,  5.15it/s][A
Iteration:  44%|████▍     | 118/268 [00:29<00:28,  5.21it/s][A
Iteration:  44%|████▍     | 119/268 [00:29<00:28,  5.15it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:27,  5.34it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:28,  5.21it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:28,  5.21it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:28,  5.13it/s][A
Iteration:  46%|████▋     | 124/268 [00:30<00:28,  5.00it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:28,  5.05it/s][A[INFO|trainer.py:570] 2024-04-30 10:34:37,470 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:34:37 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:34:37 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:34:37 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:34:37 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.70it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.71it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.72it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.73it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.72it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.73it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.73it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.72it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.72it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.72it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.72it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.72it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.83it/s]04/30/2024 10:34:40 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:34:40 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.38843429684891484, 'eval_loss': 0.89486516, 'head_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [449, 487, 654, 659, 650, 667, 491, 390, 224, 197, 167, 209], 'head_nums': [4, 4, 4, 4, 8, 8, 5, 2, 2, 2, 2, 2], 'pruned_params': 70213884, 'remaining_params': 14803716, 'pruned_model_sparsity': 0.8258746894760615, 'expected_sparsity': 0.82618, 'target_sparsity': 0.8596082089552238, 'step': 4950}


Iteration:  47%|████▋     | 126/268 [00:34<02:54,  1.23s/it][A
Iteration:  47%|████▋     | 127/268 [00:34<02:09,  1.09it/s][A
Iteration:  48%|████▊     | 128/268 [00:35<01:38,  1.43it/s][A
Iteration:  48%|████▊     | 129/268 [00:35<01:15,  1.83it/s][A
Iteration:  49%|████▊     | 130/268 [00:35<01:00,  2.28it/s][A
Iteration:  49%|████▉     | 131/268 [00:35<00:50,  2.72it/s][A
Iteration:  49%|████▉     | 132/268 [00:35<00:43,  3.15it/s][A
Iteration:  50%|████▉     | 133/268 [00:36<00:38,  3.52it/s][A
Iteration:  50%|█████     | 134/268 [00:36<00:34,  3.90it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:31,  4.23it/s][A
Iteration:  51%|█████     | 136/268 [00:36<00:28,  4.61it/s][A
Iteration:  51%|█████     | 137/268 [00:36<00:27,  4.78it/s][A
Iteration:  51%|█████▏    | 138/268 [00:37<00:26,  4.83it/s][A
Iteration:  52%|█████▏    | 139/268 [00:37<00:26,  4.93it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:25,  5.06it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:24,  5.13it/s][A
Iteration:  53%|█████▎    | 142/268 [00:37<00:24,  5.16it/s][A
Iteration:  53%|█████▎    | 143/268 [00:37<00:23,  5.31it/s][A
Iteration:  54%|█████▎    | 144/268 [00:38<00:23,  5.20it/s][A
Iteration:  54%|█████▍    | 145/268 [00:38<00:23,  5.14it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:23,  5.18it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<00:23,  5.22it/s][A
Iteration:  55%|█████▌    | 148/268 [00:38<00:22,  5.25it/s][A
Iteration:  56%|█████▌    | 149/268 [00:39<00:22,  5.18it/s][A
Iteration:  56%|█████▌    | 150/268 [00:39<00:23,  5.11it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:21,  5.36it/s][A
Iteration:  57%|█████▋    | 152/268 [00:39<00:22,  5.11it/s][A
Iteration:  57%|█████▋    | 153/268 [00:39<00:21,  5.25it/s][A
Iteration:  57%|█████▋    | 154/268 [00:40<00:21,  5.36it/s][A
Iteration:  58%|█████▊    | 155/268 [00:40<00:21,  5.21it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:21,  5.27it/s][A
Iteration:  59%|█████▊    | 157/268 [00:40<00:21,  5.27it/s][A
Iteration:  59%|█████▉    | 158/268 [00:40<00:20,  5.26it/s][A
Iteration:  59%|█████▉    | 159/268 [00:41<00:21,  5.18it/s][A
Iteration:  60%|█████▉    | 160/268 [00:41<00:21,  5.08it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:20,  5.15it/s][A
Iteration:  60%|██████    | 162/268 [00:41<00:21,  5.00it/s][A
Iteration:  61%|██████    | 163/268 [00:41<00:20,  5.25it/s][A
Iteration:  61%|██████    | 164/268 [00:41<00:19,  5.29it/s][A
Iteration:  62%|██████▏   | 165/268 [00:42<00:20,  5.06it/s][A
Iteration:  62%|██████▏   | 166/268 [00:42<00:19,  5.15it/s][A
Iteration:  62%|██████▏   | 167/268 [00:42<00:19,  5.09it/s][A
Iteration:  63%|██████▎   | 168/268 [00:42<00:19,  5.22it/s][A
Iteration:  63%|██████▎   | 169/268 [00:42<00:20,  4.93it/s][A
Iteration:  63%|██████▎   | 170/268 [00:43<00:19,  4.95it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:19,  5.06it/s][A
Iteration:  64%|██████▍   | 172/268 [00:43<00:19,  5.03it/s][A
Iteration:  65%|██████▍   | 173/268 [00:43<00:18,  5.18it/s][A
Iteration:  65%|██████▍   | 174/268 [00:43<00:18,  5.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:44<00:18,  5.13it/s][A[INFO|trainer.py:570] 2024-04-30 10:34:50,561 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:34:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:34:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:34:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:34:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.80it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.80it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.80it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.80it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:34:53 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:34:53 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.42168606106689804, 'eval_loss': 0.72876275, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [440, 475, 638, 640, 639, 650, 479, 380, 222, 191, 165, 205], 'head_nums': [4, 3, 4, 4, 8, 7, 5, 2, 2, 2, 2, 2], 'pruned_params': 72338768, 'remaining_params': 12678832, 'pruned_model_sparsity': 0.8508681496537187, 'expected_sparsity': 0.83813, 'target_sparsity': 0.8684701492537313, 'step': 5000}


Iteration:  66%|██████▌   | 176/268 [00:47<01:51,  1.22s/it][A04/30/2024 10:34:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 5000, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  66%|██████▌   | 177/268 [00:47<01:22,  1.10it/s][A
Iteration:  66%|██████▋   | 178/268 [00:48<01:02,  1.44it/s][A
Iteration:  67%|██████▋   | 179/268 [00:48<00:48,  1.83it/s][A
Iteration:  67%|██████▋   | 180/268 [00:48<00:38,  2.28it/s][A
Iteration:  68%|██████▊   | 181/268 [00:48<00:31,  2.75it/s][A
Iteration:  68%|██████▊   | 182/268 [00:48<00:26,  3.20it/s][A
Iteration:  68%|██████▊   | 183/268 [00:49<00:23,  3.59it/s][A
Iteration:  69%|██████▊   | 184/268 [00:49<00:21,  3.97it/s][A
Iteration:  69%|██████▉   | 185/268 [00:49<00:19,  4.30it/s][A
Iteration:  69%|██████▉   | 186/268 [00:49<00:18,  4.53it/s][A
Iteration:  70%|██████▉   | 187/268 [00:49<00:17,  4.57it/s][A
Iteration:  70%|███████   | 188/268 [00:50<00:16,  4.84it/s][A
Iteration:  71%|███████   | 189/268 [00:50<00:15,  4.99it/s][A
Iteration:  71%|███████   | 190/268 [00:50<00:15,  4.93it/s][A
Iteration:  71%|███████▏  | 191/268 [00:50<00:15,  4.95it/s][A
Iteration:  72%|███████▏  | 192/268 [00:50<00:14,  5.07it/s][A
Iteration:  72%|███████▏  | 193/268 [00:51<00:14,  5.10it/s][A
Iteration:  72%|███████▏  | 194/268 [00:51<00:14,  5.18it/s][A
Iteration:  73%|███████▎  | 195/268 [00:51<00:13,  5.22it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:14,  5.01it/s][A
Iteration:  74%|███████▎  | 197/268 [00:51<00:13,  5.11it/s][A
Iteration:  74%|███████▍  | 198/268 [00:52<00:13,  5.11it/s][A
Iteration:  74%|███████▍  | 199/268 [00:52<00:13,  5.16it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:13,  5.19it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:13,  5.14it/s][A
Iteration:  75%|███████▌  | 202/268 [00:52<00:12,  5.09it/s][A
Iteration:  76%|███████▌  | 203/268 [00:53<00:12,  5.01it/s][A
Iteration:  76%|███████▌  | 204/268 [00:53<00:12,  5.06it/s][A
Iteration:  76%|███████▋  | 205/268 [00:53<00:12,  5.16it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:11,  5.19it/s][A
Iteration:  77%|███████▋  | 207/268 [00:53<00:11,  5.22it/s][A
Iteration:  78%|███████▊  | 208/268 [00:53<00:11,  5.25it/s][A
Iteration:  78%|███████▊  | 209/268 [00:54<00:11,  5.23it/s][A
Iteration:  78%|███████▊  | 210/268 [00:54<00:11,  5.26it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:11,  5.11it/s][A
Iteration:  79%|███████▉  | 212/268 [00:54<00:10,  5.18it/s][A
Iteration:  79%|███████▉  | 213/268 [00:54<00:10,  5.32it/s][A
Iteration:  80%|███████▉  | 214/268 [00:55<00:10,  5.33it/s][A
Iteration:  80%|████████  | 215/268 [00:55<00:09,  5.32it/s][A
Iteration:  81%|████████  | 216/268 [00:55<00:09,  5.24it/s][A
Iteration:  81%|████████  | 217/268 [00:55<00:09,  5.34it/s][A
Iteration:  81%|████████▏ | 218/268 [00:55<00:09,  5.16it/s][A
Iteration:  82%|████████▏ | 219/268 [00:56<00:09,  5.18it/s][A
Iteration:  82%|████████▏ | 220/268 [00:56<00:09,  5.19it/s][A
Iteration:  82%|████████▏ | 221/268 [00:56<00:08,  5.24it/s][A
Iteration:  83%|████████▎ | 222/268 [00:56<00:08,  5.26it/s][A
Iteration:  83%|████████▎ | 223/268 [00:56<00:08,  5.19it/s][A
Iteration:  84%|████████▎ | 224/268 [00:57<00:08,  5.24it/s][A
Iteration:  84%|████████▍ | 225/268 [00:57<00:08,  5.18it/s][A[INFO|trainer.py:570] 2024-04-30 10:35:03,600 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:35:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:35:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:35:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:35:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.76it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.79it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:35:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:35:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3801819272175921, 'eval_loss': 0.7620812, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [430, 464, 622, 622, 634, 634, 467, 371, 219, 186, 164, 201], 'head_nums': [3, 3, 4, 4, 8, 7, 5, 2, 2, 2, 2, 2], 'pruned_params': 72680404, 'remaining_params': 12337196, 'pruned_model_sparsity': 0.8548865646642577, 'expected_sparsity': 0.84668, 'target_sparsity': 0.8773320895522387, 'step': 5050}


Iteration:  84%|████████▍ | 226/268 [01:00<00:50,  1.21s/it][A
Iteration:  85%|████████▍ | 227/268 [01:00<00:37,  1.10it/s][A
Iteration:  85%|████████▌ | 228/268 [01:01<00:27,  1.44it/s][A
Iteration:  85%|████████▌ | 229/268 [01:01<00:21,  1.85it/s][A
Iteration:  86%|████████▌ | 230/268 [01:01<00:16,  2.27it/s][A
Iteration:  86%|████████▌ | 231/268 [01:01<00:13,  2.72it/s][A
Iteration:  87%|████████▋ | 232/268 [01:01<00:11,  3.19it/s][A
Iteration:  87%|████████▋ | 233/268 [01:02<00:09,  3.64it/s][A
Iteration:  87%|████████▋ | 234/268 [01:02<00:08,  4.01it/s][A
Iteration:  88%|████████▊ | 235/268 [01:02<00:07,  4.39it/s][A
Iteration:  88%|████████▊ | 236/268 [01:02<00:07,  4.56it/s][A
Iteration:  88%|████████▊ | 237/268 [01:02<00:06,  4.75it/s][A
Iteration:  89%|████████▉ | 238/268 [01:03<00:06,  4.75it/s][A
Iteration:  89%|████████▉ | 239/268 [01:03<00:05,  4.91it/s][A
Iteration:  90%|████████▉ | 240/268 [01:03<00:05,  5.11it/s][A
Iteration:  90%|████████▉ | 241/268 [01:03<00:05,  5.15it/s][A
Iteration:  90%|█████████ | 242/268 [01:03<00:05,  5.01it/s][A
Iteration:  91%|█████████ | 243/268 [01:04<00:04,  5.08it/s][A
Iteration:  91%|█████████ | 244/268 [01:04<00:04,  5.12it/s][A
Iteration:  91%|█████████▏| 245/268 [01:04<00:04,  5.18it/s][A
Iteration:  92%|█████████▏| 246/268 [01:04<00:04,  5.11it/s][A
Iteration:  92%|█████████▏| 247/268 [01:04<00:04,  5.18it/s][A
Iteration:  93%|█████████▎| 248/268 [01:05<00:03,  5.24it/s][A
Iteration:  93%|█████████▎| 249/268 [01:05<00:03,  5.23it/s][A
Iteration:  93%|█████████▎| 250/268 [01:05<00:03,  5.15it/s][A
Iteration:  94%|█████████▎| 251/268 [01:05<00:03,  5.19it/s][A
Iteration:  94%|█████████▍| 252/268 [01:05<00:03,  5.23it/s][A
Iteration:  94%|█████████▍| 253/268 [01:05<00:02,  5.26it/s][A
Iteration:  95%|█████████▍| 254/268 [01:06<00:02,  5.28it/s][A
Iteration:  95%|█████████▌| 255/268 [01:06<00:02,  5.28it/s][A
Iteration:  96%|█████████▌| 256/268 [01:06<00:02,  5.14it/s][A
Iteration:  96%|█████████▌| 257/268 [01:06<00:02,  5.16it/s][A
Iteration:  96%|█████████▋| 258/268 [01:06<00:01,  5.20it/s][A
Iteration:  97%|█████████▋| 259/268 [01:07<00:01,  5.24it/s][A
Iteration:  97%|█████████▋| 260/268 [01:07<00:01,  5.35it/s][A
Iteration:  97%|█████████▋| 261/268 [01:07<00:01,  5.36it/s][A
Iteration:  98%|█████████▊| 262/268 [01:07<00:01,  5.31it/s][A
Iteration:  98%|█████████▊| 263/268 [01:07<00:00,  5.47it/s][A
Iteration:  99%|█████████▊| 264/268 [01:08<00:00,  5.44it/s][A
Iteration:  99%|█████████▉| 265/268 [01:08<00:00,  5.39it/s][A
Iteration:  99%|█████████▉| 266/268 [01:08<00:00,  5.37it/s][A
Iteration: 100%|█████████▉| 267/268 [01:08<00:00,  5.26it/s][A
Iteration: 100%|██████████| 268/268 [01:08<00:00,  5.78it/s][A04/30/2024 10:35:14 - INFO - trainer.trainer_mod_2 - Epoch 18 finished. Took 68.76 seconds.
Iteration: 100%|██████████| 268/268 [01:08<00:00,  3.90it/s]
Epoch:  19%|█▉        | 19/100 [22:21<1:34:16, 69.83s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:47,  5.58it/s][A
Iteration:   1%|          | 2/268 [00:00<00:48,  5.46it/s][A
Iteration:   1%|          | 3/268 [00:00<00:49,  5.34it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:49,  5.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:50,  5.26it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:50,  5.16it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:52,  4.94it/s][A[INFO|trainer.py:570] 2024-04-30 10:35:16,520 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:35:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:35:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:35:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:35:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.76it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:35:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:35:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.40899787176800695, 'eval_loss': 0.7775027, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [421, 453, 608, 604, 632, 617, 455, 362, 216, 182, 162, 198], 'head_nums': [3, 3, 4, 4, 8, 6, 5, 2, 2, 2, 2, 2], 'pruned_params': 73018976, 'remaining_params': 11998624, 'pruned_model_sparsity': 0.8588689400782896, 'expected_sparsity': 0.85302, 'target_sparsity': 0.8861940298507462, 'step': 5100}


Iteration:   3%|▎         | 8/268 [00:04<05:33,  1.28s/it][A04/30/2024 10:35:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 5100, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:   3%|▎         | 9/268 [00:05<04:04,  1.06it/s][A
Iteration:   4%|▎         | 10/268 [00:05<03:03,  1.41it/s][A
Iteration:   4%|▍         | 11/268 [00:05<02:21,  1.81it/s][A
Iteration:   4%|▍         | 12/268 [00:05<01:53,  2.25it/s][A
Iteration:   5%|▍         | 13/268 [00:05<01:32,  2.76it/s][A
Iteration:   5%|▌         | 14/268 [00:06<01:17,  3.26it/s][A
Iteration:   6%|▌         | 15/268 [00:06<01:08,  3.69it/s][A
Iteration:   6%|▌         | 16/268 [00:06<01:02,  4.05it/s][A
Iteration:   6%|▋         | 17/268 [00:06<00:57,  4.34it/s][A
Iteration:   7%|▋         | 18/268 [00:06<00:57,  4.35it/s][A
Iteration:   7%|▋         | 19/268 [00:07<00:54,  4.61it/s][A
Iteration:   7%|▋         | 20/268 [00:07<00:51,  4.82it/s][A
Iteration:   8%|▊         | 21/268 [00:07<00:48,  5.05it/s][A
Iteration:   8%|▊         | 22/268 [00:07<00:46,  5.27it/s][A
Iteration:   9%|▊         | 23/268 [00:07<00:46,  5.25it/s][A
Iteration:   9%|▉         | 24/268 [00:07<00:46,  5.25it/s][A
Iteration:   9%|▉         | 25/268 [00:08<00:47,  5.10it/s][A
Iteration:  10%|▉         | 26/268 [00:08<00:47,  5.08it/s][A
Iteration:  10%|█         | 27/268 [00:08<00:46,  5.13it/s][A
Iteration:  10%|█         | 28/268 [00:08<00:45,  5.28it/s][A
Iteration:  11%|█         | 29/268 [00:08<00:44,  5.31it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:46,  5.17it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:44,  5.37it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:43,  5.37it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:45,  5.20it/s][A
Iteration:  13%|█▎        | 34/268 [00:09<00:45,  5.13it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:44,  5.19it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:43,  5.32it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:42,  5.47it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:43,  5.30it/s][A
Iteration:  15%|█▍        | 39/268 [00:10<00:43,  5.28it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:44,  5.17it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:44,  5.13it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:42,  5.28it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:41,  5.39it/s][A
Iteration:  16%|█▋        | 44/268 [00:11<00:41,  5.34it/s][A
Iteration:  17%|█▋        | 45/268 [00:11<00:41,  5.35it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:40,  5.51it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:40,  5.46it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:41,  5.32it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:41,  5.34it/s][A
Iteration:  19%|█▊        | 50/268 [00:12<00:40,  5.42it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:40,  5.40it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:40,  5.36it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:41,  5.16it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:40,  5.22it/s][A
Iteration:  21%|██        | 55/268 [00:13<00:40,  5.25it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:39,  5.36it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:38,  5.43it/s][A[INFO|trainer.py:570] 2024-04-30 10:35:29,371 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:35:29 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:35:29 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:35:29 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:35:29 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.78it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:35:32 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:35:32 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3662967027248426, 'eval_loss': 0.8162073, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [412, 443, 593, 587, 631, 601, 443, 353, 213, 178, 160, 195], 'head_nums': [3, 3, 4, 4, 8, 6, 5, 2, 2, 2, 2, 2], 'pruned_params': 73158388, 'remaining_params': 11859212, 'pruned_model_sparsity': 0.8605087417193616, 'expected_sparsity': 0.85672, 'target_sparsity': 0.8950559701492536, 'step': 5150}


Iteration:  22%|██▏       | 58/268 [00:17<04:13,  1.21s/it][A
Iteration:  22%|██▏       | 59/268 [00:17<03:08,  1.11it/s][A
Iteration:  22%|██▏       | 60/268 [00:18<02:22,  1.46it/s][A
Iteration:  23%|██▎       | 61/268 [00:18<01:51,  1.86it/s][A
Iteration:  23%|██▎       | 62/268 [00:18<01:28,  2.31it/s][A
Iteration:  24%|██▎       | 63/268 [00:18<01:13,  2.79it/s][A
Iteration:  24%|██▍       | 64/268 [00:18<01:02,  3.24it/s][A
Iteration:  24%|██▍       | 65/268 [00:19<00:56,  3.62it/s][A
Iteration:  25%|██▍       | 66/268 [00:19<00:51,  3.93it/s][A
Iteration:  25%|██▌       | 67/268 [00:19<00:46,  4.34it/s][A
Iteration:  25%|██▌       | 68/268 [00:19<00:43,  4.59it/s][A
Iteration:  26%|██▌       | 69/268 [00:19<00:41,  4.79it/s][A
Iteration:  26%|██▌       | 70/268 [00:20<00:39,  4.96it/s][A
Iteration:  26%|██▋       | 71/268 [00:20<00:39,  5.04it/s][A
Iteration:  27%|██▋       | 72/268 [00:20<00:38,  5.13it/s][A
Iteration:  27%|██▋       | 73/268 [00:20<00:38,  5.10it/s][A
Iteration:  28%|██▊       | 74/268 [00:20<00:37,  5.19it/s][A
Iteration:  28%|██▊       | 75/268 [00:21<00:36,  5.30it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<00:36,  5.28it/s][A
Iteration:  29%|██▊       | 77/268 [00:21<00:36,  5.17it/s][A
Iteration:  29%|██▉       | 78/268 [00:21<00:36,  5.16it/s][A
Iteration:  29%|██▉       | 79/268 [00:21<00:36,  5.17it/s][A
Iteration:  30%|██▉       | 80/268 [00:21<00:36,  5.20it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:36,  5.12it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:35,  5.18it/s][A
Iteration:  31%|███       | 83/268 [00:22<00:36,  5.10it/s][A
Iteration:  31%|███▏      | 84/268 [00:22<00:36,  5.06it/s][A
Iteration:  32%|███▏      | 85/268 [00:22<00:35,  5.09it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:35,  5.17it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:35,  5.07it/s][A
Iteration:  33%|███▎      | 88/268 [00:23<00:35,  5.06it/s][A
Iteration:  33%|███▎      | 89/268 [00:23<00:35,  5.04it/s][A
Iteration:  34%|███▎      | 90/268 [00:23<00:34,  5.12it/s][A
Iteration:  34%|███▍      | 91/268 [00:24<00:34,  5.19it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:33,  5.22it/s][A
Iteration:  35%|███▍      | 93/268 [00:24<00:32,  5.36it/s][A
Iteration:  35%|███▌      | 94/268 [00:24<00:32,  5.36it/s][A
Iteration:  35%|███▌      | 95/268 [00:24<00:32,  5.35it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:32,  5.36it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:31,  5.35it/s][A
Iteration:  37%|███▋      | 98/268 [00:25<00:31,  5.32it/s][A
Iteration:  37%|███▋      | 99/268 [00:25<00:32,  5.21it/s][A
Iteration:  37%|███▋      | 100/268 [00:25<00:32,  5.15it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:32,  5.11it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:32,  5.17it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:31,  5.18it/s][A
Iteration:  39%|███▉      | 104/268 [00:26<00:32,  5.07it/s][A
Iteration:  39%|███▉      | 105/268 [00:26<00:32,  5.01it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:31,  5.18it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:31,  5.10it/s][A[INFO|trainer.py:570] 2024-04-30 10:35:42,402 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:35:42 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:35:42 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:35:42 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:35:42 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.76it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.80it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.79it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:35:45 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:35:45 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.38551404359712926, 'eval_loss': 0.82227784, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [403, 433, 579, 570, 630, 585, 432, 345, 210, 175, 159, 192], 'head_nums': [2, 3, 4, 4, 8, 6, 5, 2, 2, 2, 2, 1], 'pruned_params': 73685396, 'remaining_params': 11332204, 'pruned_model_sparsity': 0.8667075523185788, 'expected_sparsity': 0.86064, 'target_sparsity': 0.9039179104477612, 'step': 5200}


Iteration:  40%|████      | 108/268 [00:30<03:15,  1.22s/it][A04/30/2024 10:35:45 - INFO - trainer.trainer_mod_2 - v4 Global step: 5200, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  41%|████      | 109/268 [00:31<02:25,  1.09it/s][A
Iteration:  41%|████      | 110/268 [00:31<01:51,  1.42it/s][A
Iteration:  41%|████▏     | 111/268 [00:31<01:26,  1.82it/s][A
Iteration:  42%|████▏     | 112/268 [00:31<01:09,  2.26it/s][A
Iteration:  42%|████▏     | 113/268 [00:31<00:56,  2.73it/s][A
Iteration:  43%|████▎     | 114/268 [00:32<00:48,  3.19it/s][A
Iteration:  43%|████▎     | 115/268 [00:32<00:42,  3.56it/s][A
Iteration:  43%|████▎     | 116/268 [00:32<00:39,  3.86it/s][A
Iteration:  44%|████▎     | 117/268 [00:32<00:35,  4.20it/s][A
Iteration:  44%|████▍     | 118/268 [00:32<00:33,  4.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:32<00:32,  4.62it/s][A
Iteration:  45%|████▍     | 120/268 [00:33<00:30,  4.81it/s][A
Iteration:  45%|████▌     | 121/268 [00:33<00:30,  4.84it/s][A
Iteration:  46%|████▌     | 122/268 [00:33<00:29,  4.97it/s][A
Iteration:  46%|████▌     | 123/268 [00:33<00:29,  4.91it/s][A
Iteration:  46%|████▋     | 124/268 [00:33<00:29,  4.94it/s][A
Iteration:  47%|████▋     | 125/268 [00:34<00:28,  5.07it/s][A
Iteration:  47%|████▋     | 126/268 [00:34<00:27,  5.13it/s][A
Iteration:  47%|████▋     | 127/268 [00:34<00:27,  5.19it/s][A
Iteration:  48%|████▊     | 128/268 [00:34<00:26,  5.24it/s][A
Iteration:  48%|████▊     | 129/268 [00:34<00:26,  5.28it/s][A
Iteration:  49%|████▊     | 130/268 [00:35<00:26,  5.18it/s][A
Iteration:  49%|████▉     | 131/268 [00:35<00:26,  5.24it/s][A
Iteration:  49%|████▉     | 132/268 [00:35<00:26,  5.09it/s][A
Iteration:  50%|████▉     | 133/268 [00:35<00:26,  5.16it/s][A
Iteration:  50%|█████     | 134/268 [00:35<00:25,  5.20it/s][A
Iteration:  50%|█████     | 135/268 [00:36<00:25,  5.22it/s][A
Iteration:  51%|█████     | 136/268 [00:36<00:26,  5.04it/s][A
Iteration:  51%|█████     | 137/268 [00:36<00:25,  5.13it/s][A
Iteration:  51%|█████▏    | 138/268 [00:36<00:25,  5.17it/s][A
Iteration:  52%|█████▏    | 139/268 [00:36<00:24,  5.19it/s][A
Iteration:  52%|█████▏    | 140/268 [00:37<00:23,  5.37it/s][A
Iteration:  53%|█████▎    | 141/268 [00:37<00:24,  5.26it/s][A
Iteration:  53%|█████▎    | 142/268 [00:37<00:24,  5.19it/s][A
Iteration:  53%|█████▎    | 143/268 [00:37<00:23,  5.26it/s][A
Iteration:  54%|█████▎    | 144/268 [00:37<00:23,  5.29it/s][A
Iteration:  54%|█████▍    | 145/268 [00:37<00:22,  5.40it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:22,  5.34it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<00:22,  5.35it/s][A
Iteration:  55%|█████▌    | 148/268 [00:38<00:22,  5.28it/s][A
Iteration:  56%|█████▌    | 149/268 [00:38<00:22,  5.22it/s][A
Iteration:  56%|█████▌    | 150/268 [00:38<00:22,  5.22it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:22,  5.27it/s][A
Iteration:  57%|█████▋    | 152/268 [00:39<00:24,  4.80it/s][A
Iteration:  57%|█████▋    | 153/268 [00:39<00:23,  4.90it/s][A
Iteration:  57%|█████▋    | 154/268 [00:39<00:22,  4.98it/s][A
Iteration:  58%|█████▊    | 155/268 [00:39<00:22,  5.10it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:21,  5.17it/s][A
Iteration:  59%|█████▊    | 157/268 [00:40<00:21,  5.14it/s][A[INFO|trainer.py:570] 2024-04-30 10:35:55,489 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:35:55 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:35:55 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:35:55 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:35:55 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.76it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:35:58 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:35:58 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.391444810078911, 'eval_loss': 0.8207682, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [394, 424, 564, 553, 628, 569, 421, 337, 207, 172, 157, 190], 'head_nums': [2, 3, 4, 3, 8, 6, 4, 2, 2, 2, 2, 1], 'pruned_params': 74212404, 'remaining_params': 10805196, 'pruned_model_sparsity': 0.8729063629177959, 'expected_sparsity': 0.86395, 'target_sparsity': 0.9127798507462686, 'step': 5250}


Iteration:  59%|█████▉    | 158/268 [00:43<02:13,  1.21s/it][A
Iteration:  59%|█████▉    | 159/268 [00:44<01:39,  1.10it/s][A
Iteration:  60%|█████▉    | 160/268 [00:44<01:14,  1.45it/s][A
Iteration:  60%|██████    | 161/268 [00:44<00:57,  1.86it/s][A
Iteration:  60%|██████    | 162/268 [00:44<00:45,  2.32it/s][A
Iteration:  61%|██████    | 163/268 [00:44<00:37,  2.77it/s][A
Iteration:  61%|██████    | 164/268 [00:45<00:32,  3.24it/s][A
Iteration:  62%|██████▏   | 165/268 [00:45<00:28,  3.66it/s][A
Iteration:  62%|██████▏   | 166/268 [00:45<00:25,  4.04it/s][A
Iteration:  62%|██████▏   | 167/268 [00:45<00:23,  4.24it/s][A
Iteration:  63%|██████▎   | 168/268 [00:45<00:22,  4.52it/s][A
Iteration:  63%|██████▎   | 169/268 [00:46<00:21,  4.69it/s][A
Iteration:  63%|██████▎   | 170/268 [00:46<00:20,  4.88it/s][A
Iteration:  64%|██████▍   | 171/268 [00:46<00:19,  5.00it/s][A
Iteration:  64%|██████▍   | 172/268 [00:46<00:18,  5.09it/s][A
Iteration:  65%|██████▍   | 173/268 [00:46<00:18,  5.16it/s][A
Iteration:  65%|██████▍   | 174/268 [00:46<00:17,  5.35it/s][A
Iteration:  65%|██████▌   | 175/268 [00:47<00:17,  5.34it/s][A
Iteration:  66%|██████▌   | 176/268 [00:47<00:17,  5.23it/s][A
Iteration:  66%|██████▌   | 177/268 [00:47<00:17,  5.23it/s][A
Iteration:  66%|██████▋   | 178/268 [00:47<00:17,  5.24it/s][A
Iteration:  67%|██████▋   | 179/268 [00:47<00:17,  5.22it/s][A
Iteration:  67%|██████▋   | 180/268 [00:48<00:17,  5.15it/s][A
Iteration:  68%|██████▊   | 181/268 [00:48<00:16,  5.21it/s][A
Iteration:  68%|██████▊   | 182/268 [00:48<00:16,  5.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:48<00:16,  5.29it/s][A
Iteration:  69%|██████▊   | 184/268 [00:48<00:15,  5.28it/s][A
Iteration:  69%|██████▉   | 185/268 [00:49<00:15,  5.26it/s][A
Iteration:  69%|██████▉   | 186/268 [00:49<00:15,  5.26it/s][A
Iteration:  70%|██████▉   | 187/268 [00:49<00:15,  5.17it/s][A
Iteration:  70%|███████   | 188/268 [00:49<00:15,  5.22it/s][A
Iteration:  71%|███████   | 189/268 [00:49<00:15,  5.01it/s][A
Iteration:  71%|███████   | 190/268 [00:50<00:15,  5.00it/s][A
Iteration:  71%|███████▏  | 191/268 [00:50<00:15,  5.11it/s][A
Iteration:  72%|███████▏  | 192/268 [00:50<00:14,  5.15it/s][A
Iteration:  72%|███████▏  | 193/268 [00:50<00:14,  5.28it/s][A
Iteration:  72%|███████▏  | 194/268 [00:50<00:14,  5.18it/s][A
Iteration:  73%|███████▎  | 195/268 [00:50<00:14,  5.20it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:13,  5.22it/s][A
Iteration:  74%|███████▎  | 197/268 [00:51<00:13,  5.24it/s][A
Iteration:  74%|███████▍  | 198/268 [00:51<00:12,  5.43it/s][A
Iteration:  74%|███████▍  | 199/268 [00:51<00:12,  5.31it/s][A
Iteration:  75%|███████▍  | 200/268 [00:51<00:13,  5.10it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:12,  5.28it/s][A
Iteration:  75%|███████▌  | 202/268 [00:52<00:12,  5.19it/s][A
Iteration:  76%|███████▌  | 203/268 [00:52<00:12,  5.20it/s][A
Iteration:  76%|███████▌  | 204/268 [00:52<00:12,  5.24it/s][A
Iteration:  76%|███████▋  | 205/268 [00:52<00:12,  5.17it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:11,  5.18it/s][A
Iteration:  77%|███████▋  | 207/268 [00:53<00:11,  5.13it/s][A[INFO|trainer.py:570] 2024-04-30 10:36:08,443 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:36:08 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:36:08 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:36:08 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:36:08 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.80it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.77it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.76it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.77it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.77it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:36:11 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:36:11 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.37980780809871945, 'eval_loss': 0.79296935, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [385, 415, 550, 537, 627, 553, 410, 329, 205, 169, 156, 188], 'head_nums': [2, 3, 4, 3, 8, 6, 4, 2, 2, 2, 2, 1], 'pruned_params': 74342624, 'remaining_params': 10674976, 'pruned_model_sparsity': 0.8744380457693466, 'expected_sparsity': 0.8667, 'target_sparsity': 0.9216417910447761, 'step': 5300}


Iteration:  78%|███████▊  | 208/268 [00:56<01:12,  1.21s/it][A04/30/2024 10:36:11 - INFO - trainer.trainer_mod_2 - v4 Global step: 5300, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  78%|███████▊  | 209/268 [00:57<00:53,  1.10it/s][A
Iteration:  78%|███████▊  | 210/268 [00:57<00:40,  1.45it/s][A
Iteration:  79%|███████▊  | 211/268 [00:57<00:30,  1.87it/s][A
Iteration:  79%|███████▉  | 212/268 [00:57<00:24,  2.32it/s][A
Iteration:  79%|███████▉  | 213/268 [00:57<00:19,  2.79it/s][A
Iteration:  80%|███████▉  | 214/268 [00:57<00:16,  3.26it/s][A
Iteration:  80%|████████  | 215/268 [00:58<00:14,  3.61it/s][A
Iteration:  81%|████████  | 216/268 [00:58<00:13,  3.98it/s][A
Iteration:  81%|████████  | 217/268 [00:58<00:11,  4.31it/s][A
Iteration:  81%|████████▏ | 218/268 [00:58<00:10,  4.55it/s][A
Iteration:  82%|████████▏ | 219/268 [00:58<00:10,  4.76it/s][A
Iteration:  82%|████████▏ | 220/268 [00:59<00:09,  4.90it/s][A
Iteration:  82%|████████▏ | 221/268 [00:59<00:09,  4.94it/s][A
Iteration:  83%|████████▎ | 222/268 [00:59<00:09,  5.06it/s][A
Iteration:  83%|████████▎ | 223/268 [00:59<00:08,  5.14it/s][A
Iteration:  84%|████████▎ | 224/268 [00:59<00:08,  5.12it/s][A
Iteration:  84%|████████▍ | 225/268 [01:00<00:08,  5.09it/s][A
Iteration:  84%|████████▍ | 226/268 [01:00<00:08,  5.04it/s][A
Iteration:  85%|████████▍ | 227/268 [01:00<00:08,  5.12it/s][A
Iteration:  85%|████████▌ | 228/268 [01:00<00:07,  5.03it/s][A
Iteration:  85%|████████▌ | 229/268 [01:00<00:07,  5.14it/s][A
Iteration:  86%|████████▌ | 230/268 [01:01<00:07,  5.17it/s][A
Iteration:  86%|████████▌ | 231/268 [01:01<00:07,  5.08it/s][A
Iteration:  87%|████████▋ | 232/268 [01:01<00:07,  5.09it/s][A
Iteration:  87%|████████▋ | 233/268 [01:01<00:06,  5.08it/s][A
Iteration:  87%|████████▋ | 234/268 [01:01<00:06,  5.16it/s][A
Iteration:  88%|████████▊ | 235/268 [01:02<00:06,  5.10it/s][A
Iteration:  88%|████████▊ | 236/268 [01:02<00:06,  5.30it/s][A
Iteration:  88%|████████▊ | 237/268 [01:02<00:05,  5.19it/s][A
Iteration:  89%|████████▉ | 238/268 [01:02<00:05,  5.20it/s][A
Iteration:  89%|████████▉ | 239/268 [01:02<00:05,  5.22it/s][A
Iteration:  90%|████████▉ | 240/268 [01:03<00:05,  5.17it/s][A
Iteration:  90%|████████▉ | 241/268 [01:03<00:05,  5.33it/s][A
Iteration:  90%|█████████ | 242/268 [01:03<00:05,  5.12it/s][A
Iteration:  91%|█████████ | 243/268 [01:03<00:04,  5.09it/s][A
Iteration:  91%|█████████ | 244/268 [01:03<00:04,  4.99it/s][A
Iteration:  91%|█████████▏| 245/268 [01:04<00:04,  5.17it/s][A
Iteration:  92%|█████████▏| 246/268 [01:04<00:04,  5.19it/s][A
Iteration:  92%|█████████▏| 247/268 [01:04<00:04,  5.19it/s][A
Iteration:  93%|█████████▎| 248/268 [01:04<00:03,  5.21it/s][A
Iteration:  93%|█████████▎| 249/268 [01:04<00:03,  5.05it/s][A
Iteration:  93%|█████████▎| 250/268 [01:04<00:03,  5.00it/s][A
Iteration:  94%|█████████▎| 251/268 [01:05<00:03,  5.05it/s][A
Iteration:  94%|█████████▍| 252/268 [01:05<00:03,  5.21it/s][A
Iteration:  94%|█████████▍| 253/268 [01:05<00:02,  5.25it/s][A
Iteration:  95%|█████████▍| 254/268 [01:05<00:02,  5.25it/s][A
Iteration:  95%|█████████▌| 255/268 [01:05<00:02,  5.18it/s][A
Iteration:  96%|█████████▌| 256/268 [01:06<00:02,  5.20it/s][A
Iteration:  96%|█████████▌| 257/268 [01:06<00:02,  5.22it/s][A[INFO|trainer.py:570] 2024-04-30 10:36:21,468 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:36:21 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:36:21 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:36:21 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:36:21 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.76it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.78it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:36:24 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:36:24 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.41108108039451186, 'eval_loss': 0.7202496, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [377, 405, 536, 521, 626, 537, 400, 320, 202, 167, 155, 185], 'head_nums': [2, 3, 4, 3, 8, 5, 4, 2, 2, 2, 2, 1], 'pruned_params': 74670472, 'remaining_params': 10347128, 'pruned_model_sparsity': 0.8782942825956037, 'expected_sparsity': 0.87001, 'target_sparsity': 0.9305037313432835, 'step': 5350}


Iteration:  96%|█████████▋| 258/268 [01:09<00:12,  1.21s/it][A
Iteration:  97%|█████████▋| 259/268 [01:10<00:08,  1.11it/s][A
Iteration:  97%|█████████▋| 260/268 [01:10<00:05,  1.45it/s][A
Iteration:  97%|█████████▋| 261/268 [01:10<00:03,  1.84it/s][A
Iteration:  98%|█████████▊| 262/268 [01:10<00:02,  2.29it/s][A
Iteration:  98%|█████████▊| 263/268 [01:10<00:01,  2.77it/s][A
Iteration:  99%|█████████▊| 264/268 [01:11<00:01,  3.22it/s][A
Iteration:  99%|█████████▉| 265/268 [01:11<00:00,  3.65it/s][A
Iteration:  99%|█████████▉| 266/268 [01:11<00:00,  4.03it/s][A
Iteration: 100%|█████████▉| 267/268 [01:11<00:00,  4.28it/s][A
Iteration: 100%|██████████| 268/268 [01:11<00:00,  4.85it/s][A04/30/2024 10:36:26 - INFO - trainer.trainer_mod_2 - Epoch 19 finished. Took 71.77 seconds.
Iteration: 100%|██████████| 268/268 [01:11<00:00,  3.73it/s]
Epoch:  20%|██        | 20/100 [23:33<1:33:53, 70.42s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:50,  5.31it/s][A
Iteration:   1%|          | 2/268 [00:00<00:49,  5.34it/s][A
Iteration:   1%|          | 3/268 [00:00<00:49,  5.32it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:49,  5.29it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:49,  5.30it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:49,  5.30it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:49,  5.28it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:49,  5.20it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:49,  5.22it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:50,  5.15it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:50,  5.08it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:49,  5.13it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:48,  5.27it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:47,  5.32it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:47,  5.34it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:48,  5.24it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:46,  5.42it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:46,  5.37it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:47,  5.22it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:47,  5.25it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:47,  5.25it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:46,  5.28it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:47,  5.20it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:45,  5.35it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:46,  5.23it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:47,  5.15it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:46,  5.17it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:47,  5.04it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:45,  5.26it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:44,  5.37it/s][A
Iteration:  12%|█▏        | 31/268 [00:05<00:44,  5.33it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:44,  5.30it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:44,  5.29it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:42,  5.45it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:43,  5.37it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:43,  5.39it/s][A
Iteration:  14%|█▍        | 37/268 [00:07<00:43,  5.36it/s][A
Iteration:  14%|█▍        | 38/268 [00:07<00:42,  5.45it/s][A
Iteration:  15%|█▍        | 39/268 [00:07<00:41,  5.52it/s][A[INFO|trainer.py:570] 2024-04-30 10:36:34,313 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:36:34 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:36:34 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:36:34 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:36:34 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.76it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.78it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:36:37 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:36:37 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.3928456704665347, 'eval_loss': 0.7720947, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [369, 396, 522, 505, 624, 522, 389, 312, 200, 165, 154, 183], 'head_nums': [2, 3, 4, 3, 8, 5, 4, 2, 2, 2, 2, 1], 'pruned_params': 74797628, 'remaining_params': 10219972, 'pruned_model_sparsity': 0.8797899258506474, 'expected_sparsity': 0.87405, 'target_sparsity': 0.9393656716417911, 'step': 5400}


Iteration:  15%|█▍        | 40/268 [00:10<04:35,  1.21s/it][A04/30/2024 10:36:37 - INFO - trainer.trainer_mod_2 - v4 Global step: 5400, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  15%|█▌        | 41/268 [00:11<03:25,  1.11it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<02:35,  1.45it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<02:01,  1.85it/s][A
Iteration:  16%|█▋        | 44/268 [00:11<01:36,  2.32it/s][A
Iteration:  17%|█▋        | 45/268 [00:11<01:19,  2.79it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<01:08,  3.26it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:59,  3.70it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:55,  3.99it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:50,  4.30it/s][A
Iteration:  19%|█▊        | 50/268 [00:12<00:47,  4.58it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:45,  4.78it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:44,  4.91it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:42,  5.04it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:42,  5.04it/s][A
Iteration:  21%|██        | 55/268 [00:13<00:42,  4.98it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:42,  4.98it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:41,  5.08it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:41,  5.12it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:40,  5.15it/s][A
Iteration:  22%|██▏       | 60/268 [00:14<00:40,  5.19it/s][A
Iteration:  23%|██▎       | 61/268 [00:14<00:40,  5.12it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:39,  5.27it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:38,  5.30it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:38,  5.28it/s][A
Iteration:  24%|██▍       | 65/268 [00:15<00:38,  5.21it/s][A
Iteration:  25%|██▍       | 66/268 [00:15<00:38,  5.22it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:38,  5.18it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:39,  5.12it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:38,  5.19it/s][A
Iteration:  26%|██▌       | 70/268 [00:16<00:38,  5.11it/s][A
Iteration:  26%|██▋       | 71/268 [00:16<00:38,  5.09it/s][A
Iteration:  27%|██▋       | 72/268 [00:17<00:38,  5.15it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:38,  5.11it/s][A
Iteration:  28%|██▊       | 74/268 [00:17<00:37,  5.20it/s][A
Iteration:  28%|██▊       | 75/268 [00:17<00:36,  5.22it/s][A
Iteration:  28%|██▊       | 76/268 [00:17<00:36,  5.23it/s][A
Iteration:  29%|██▊       | 77/268 [00:18<00:35,  5.42it/s][A
Iteration:  29%|██▉       | 78/268 [00:18<00:35,  5.36it/s][A
Iteration:  29%|██▉       | 79/268 [00:18<00:35,  5.32it/s][A
Iteration:  30%|██▉       | 80/268 [00:18<00:35,  5.32it/s][A
Iteration:  30%|███       | 81/268 [00:18<00:35,  5.32it/s][A
Iteration:  31%|███       | 82/268 [00:18<00:35,  5.30it/s][A
Iteration:  31%|███       | 83/268 [00:19<00:35,  5.28it/s][A
Iteration:  31%|███▏      | 84/268 [00:19<00:36,  5.08it/s][A
Iteration:  32%|███▏      | 85/268 [00:19<00:36,  4.97it/s][A
Iteration:  32%|███▏      | 86/268 [00:19<00:36,  4.94it/s][A
Iteration:  32%|███▏      | 87/268 [00:20<00:36,  5.02it/s][A
Iteration:  33%|███▎      | 88/268 [00:20<00:35,  5.12it/s][A
Iteration:  33%|███▎      | 89/268 [00:20<00:35,  5.04it/s][A[INFO|trainer.py:570] 2024-04-30 10:36:47,316 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:36:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:36:47 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:36:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:36:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:36:50 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:36:50 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.35176067551880325, 'eval_loss': 0.8370152, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [361, 387, 508, 490, 623, 507, 379, 304, 198, 163, 153, 182], 'head_nums': [2, 3, 4, 3, 7, 4, 4, 2, 2, 2, 2, 1], 'pruned_params': 75117816, 'remaining_params': 9899784, 'pruned_model_sparsity': 0.8835560636856369, 'expected_sparsity': 0.8781, 'target_sparsity': 0.9482276119402985, 'step': 5450}


Iteration:  34%|███▎      | 90/268 [00:23<03:36,  1.21s/it][A
Iteration:  34%|███▍      | 91/268 [00:24<02:42,  1.09it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<02:03,  1.43it/s][A
Iteration:  35%|███▍      | 93/268 [00:24<01:34,  1.84it/s][A
Iteration:  35%|███▌      | 94/268 [00:24<01:15,  2.29it/s][A
Iteration:  35%|███▌      | 95/268 [00:24<01:02,  2.76it/s][A
Iteration:  36%|███▌      | 96/268 [00:25<00:53,  3.24it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:46,  3.66it/s][A
Iteration:  37%|███▋      | 98/268 [00:25<00:42,  3.96it/s][A
Iteration:  37%|███▋      | 99/268 [00:25<00:39,  4.28it/s][A
Iteration:  37%|███▋      | 100/268 [00:25<00:37,  4.53it/s][A
Iteration:  38%|███▊      | 101/268 [00:26<00:35,  4.74it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:33,  4.91it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:32,  5.05it/s][A
Iteration:  39%|███▉      | 104/268 [00:26<00:31,  5.15it/s][A
Iteration:  39%|███▉      | 105/268 [00:26<00:31,  5.14it/s][A
Iteration:  40%|███▉      | 106/268 [00:27<00:31,  5.09it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:31,  5.13it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:31,  5.10it/s][A
Iteration:  41%|████      | 109/268 [00:27<00:30,  5.17it/s][A
Iteration:  41%|████      | 110/268 [00:27<00:30,  5.20it/s][A
Iteration:  41%|████▏     | 111/268 [00:28<00:30,  5.16it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:30,  5.12it/s][A
Iteration:  42%|████▏     | 113/268 [00:28<00:30,  5.15it/s][A
Iteration:  43%|████▎     | 114/268 [00:28<00:30,  5.11it/s][A
Iteration:  43%|████▎     | 115/268 [00:28<00:29,  5.14it/s][A
Iteration:  43%|████▎     | 116/268 [00:28<00:29,  5.10it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<00:30,  4.96it/s][A
Iteration:  44%|████▍     | 118/268 [00:29<00:29,  5.16it/s][A
Iteration:  44%|████▍     | 119/268 [00:29<00:28,  5.16it/s][A
Iteration:  45%|████▍     | 120/268 [00:29<00:28,  5.22it/s][A
Iteration:  45%|████▌     | 121/268 [00:29<00:28,  5.15it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:28,  5.20it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:27,  5.21it/s][A
Iteration:  46%|████▋     | 124/268 [00:30<00:27,  5.15it/s][A
Iteration:  47%|████▋     | 125/268 [00:30<00:27,  5.20it/s][A
Iteration:  47%|████▋     | 126/268 [00:30<00:27,  5.24it/s][A
Iteration:  47%|████▋     | 127/268 [00:31<00:27,  5.17it/s][A
Iteration:  48%|████▊     | 128/268 [00:31<00:26,  5.22it/s][A
Iteration:  48%|████▊     | 129/268 [00:31<00:26,  5.22it/s][A
Iteration:  49%|████▊     | 130/268 [00:31<00:26,  5.25it/s][A
Iteration:  49%|████▉     | 131/268 [00:31<00:26,  5.18it/s][A
Iteration:  49%|████▉     | 132/268 [00:32<00:25,  5.31it/s][A
Iteration:  50%|████▉     | 133/268 [00:32<00:26,  5.05it/s][A
Iteration:  50%|█████     | 134/268 [00:32<00:26,  4.99it/s][A
Iteration:  50%|█████     | 135/268 [00:32<00:26,  5.06it/s][A
Iteration:  51%|█████     | 136/268 [00:32<00:25,  5.10it/s][A
Iteration:  51%|█████     | 137/268 [00:33<00:25,  5.14it/s][A
Iteration:  51%|█████▏    | 138/268 [00:33<00:24,  5.36it/s][A
Iteration:  52%|█████▏    | 139/268 [00:33<00:23,  5.46it/s][A[INFO|trainer.py:570] 2024-04-30 10:37:00,344 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:37:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:37:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:37:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:37:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.76it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.78it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.78it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:37:03 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:37:03 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.404971731205394, 'eval_loss': 0.60799366, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [353, 378, 495, 475, 621, 492, 370, 297, 196, 161, 153, 180], 'head_nums': [2, 3, 4, 3, 7, 4, 4, 2, 2, 2, 2, 1], 'pruned_params': 75237312, 'remaining_params': 9780288, 'pruned_model_sparsity': 0.8849616079494128, 'expected_sparsity': 0.88282, 'target_sparsity': 0.95, 'step': 5500}


Iteration:  52%|█████▏    | 140/268 [00:37<02:34,  1.21s/it][A04/30/2024 10:37:03 - INFO - trainer.trainer_mod_2 - v4 Global step: 5500, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  53%|█████▎    | 141/268 [00:37<01:54,  1.11it/s][A
Iteration:  53%|█████▎    | 142/268 [00:37<01:26,  1.46it/s][A
Iteration:  53%|█████▎    | 143/268 [00:37<01:07,  1.86it/s][A
Iteration:  54%|█████▎    | 144/268 [00:37<00:53,  2.31it/s][A
Iteration:  54%|█████▍    | 145/268 [00:37<00:44,  2.77it/s][A
Iteration:  54%|█████▍    | 146/268 [00:38<00:37,  3.24it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<00:32,  3.68it/s][A
Iteration:  55%|█████▌    | 148/268 [00:38<00:30,  3.96it/s][A
Iteration:  56%|█████▌    | 149/268 [00:38<00:28,  4.22it/s][A
Iteration:  56%|█████▌    | 150/268 [00:38<00:26,  4.39it/s][A
Iteration:  56%|█████▋    | 151/268 [00:39<00:25,  4.56it/s][A
Iteration:  57%|█████▋    | 152/268 [00:39<00:24,  4.74it/s][A
Iteration:  57%|█████▋    | 153/268 [00:39<00:24,  4.78it/s][A
Iteration:  57%|█████▋    | 154/268 [00:39<00:23,  4.89it/s][A
Iteration:  58%|█████▊    | 155/268 [00:39<00:22,  4.93it/s][A
Iteration:  58%|█████▊    | 156/268 [00:40<00:22,  4.97it/s][A
Iteration:  59%|█████▊    | 157/268 [00:40<00:21,  5.09it/s][A
Iteration:  59%|█████▉    | 158/268 [00:40<00:21,  5.14it/s][A
Iteration:  59%|█████▉    | 159/268 [00:40<00:21,  5.11it/s][A
Iteration:  60%|█████▉    | 160/268 [00:40<00:20,  5.15it/s][A
Iteration:  60%|██████    | 161/268 [00:41<00:20,  5.17it/s][A
Iteration:  60%|██████    | 162/268 [00:41<00:20,  5.21it/s][A
Iteration:  61%|██████    | 163/268 [00:41<00:19,  5.25it/s][A
Iteration:  61%|██████    | 164/268 [00:41<00:19,  5.28it/s][A
Iteration:  62%|██████▏   | 165/268 [00:41<00:19,  5.27it/s][A
Iteration:  62%|██████▏   | 166/268 [00:42<00:18,  5.38it/s][A
Iteration:  62%|██████▏   | 167/268 [00:42<00:19,  5.26it/s][A
Iteration:  63%|██████▎   | 168/268 [00:42<00:19,  5.19it/s][A
Iteration:  63%|██████▎   | 169/268 [00:42<00:19,  5.20it/s][A
Iteration:  63%|██████▎   | 170/268 [00:42<00:20,  4.77it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:19,  4.91it/s][A
Iteration:  64%|██████▍   | 172/268 [00:43<00:19,  4.92it/s][A
Iteration:  65%|██████▍   | 173/268 [00:43<00:18,  5.03it/s][A
Iteration:  65%|██████▍   | 174/268 [00:43<00:18,  5.21it/s][A
Iteration:  65%|██████▌   | 175/268 [00:43<00:17,  5.20it/s][A
Iteration:  66%|██████▌   | 176/268 [00:44<00:18,  5.07it/s][A
Iteration:  66%|██████▌   | 177/268 [00:44<00:17,  5.16it/s][A
Iteration:  66%|██████▋   | 178/268 [00:44<00:17,  5.29it/s][A
Iteration:  67%|██████▋   | 179/268 [00:44<00:17,  5.21it/s][A
Iteration:  67%|██████▋   | 180/268 [00:44<00:17,  5.17it/s][A
Iteration:  68%|██████▊   | 181/268 [00:44<00:16,  5.23it/s][A
Iteration:  68%|██████▊   | 182/268 [00:45<00:16,  5.25it/s][A
Iteration:  68%|██████▊   | 183/268 [00:45<00:16,  5.27it/s][A
Iteration:  69%|██████▊   | 184/268 [00:45<00:15,  5.30it/s][A
Iteration:  69%|██████▉   | 185/268 [00:45<00:15,  5.32it/s][A
Iteration:  69%|██████▉   | 186/268 [00:45<00:15,  5.33it/s][A
Iteration:  70%|██████▉   | 187/268 [00:46<00:15,  5.22it/s][A
Iteration:  70%|███████   | 188/268 [00:46<00:15,  5.08it/s][A
Iteration:  71%|███████   | 189/268 [00:46<00:15,  5.15it/s][A[INFO|trainer.py:570] 2024-04-30 10:37:13,421 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:37:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:37:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:37:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:37:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.75it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.79it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:37:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:37:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.36261112690943775, 'eval_loss': 0.75563323, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [346, 369, 482, 460, 619, 477, 361, 290, 194, 160, 152, 178], 'head_nums': [2, 3, 4, 3, 7, 4, 4, 2, 2, 2, 2, 1], 'pruned_params': 75355276, 'remaining_params': 9662324, 'pruned_model_sparsity': 0.8863491324149353, 'expected_sparsity': 0.88683, 'target_sparsity': 0.95, 'step': 5550}


Iteration:  71%|███████   | 190/268 [00:50<01:34,  1.21s/it][A
Iteration:  71%|███████▏  | 191/268 [00:50<01:09,  1.10it/s][A
Iteration:  72%|███████▏  | 192/268 [00:50<00:52,  1.44it/s][A
Iteration:  72%|███████▏  | 193/268 [00:50<00:40,  1.84it/s][A
Iteration:  72%|███████▏  | 194/268 [00:50<00:32,  2.29it/s][A
Iteration:  73%|███████▎  | 195/268 [00:51<00:26,  2.79it/s][A
Iteration:  73%|███████▎  | 196/268 [00:51<00:22,  3.19it/s][A
Iteration:  74%|███████▎  | 197/268 [00:51<00:19,  3.56it/s][A
Iteration:  74%|███████▍  | 198/268 [00:51<00:17,  4.01it/s][A
Iteration:  74%|███████▍  | 199/268 [00:51<00:16,  4.24it/s][A
Iteration:  75%|███████▍  | 200/268 [00:52<00:15,  4.50it/s][A
Iteration:  75%|███████▌  | 201/268 [00:52<00:14,  4.65it/s][A
Iteration:  75%|███████▌  | 202/268 [00:52<00:14,  4.70it/s][A
Iteration:  76%|███████▌  | 203/268 [00:52<00:13,  4.77it/s][A
Iteration:  76%|███████▌  | 204/268 [00:52<00:12,  5.00it/s][A
Iteration:  76%|███████▋  | 205/268 [00:52<00:12,  5.07it/s][A
Iteration:  77%|███████▋  | 206/268 [00:53<00:12,  5.14it/s][A
Iteration:  77%|███████▋  | 207/268 [00:53<00:11,  5.16it/s][A
Iteration:  78%|███████▊  | 208/268 [00:53<00:11,  5.35it/s][A
Iteration:  78%|███████▊  | 209/268 [00:53<00:11,  5.33it/s][A
Iteration:  78%|███████▊  | 210/268 [00:53<00:10,  5.33it/s][A
Iteration:  79%|███████▊  | 211/268 [00:54<00:10,  5.23it/s][A
Iteration:  79%|███████▉  | 212/268 [00:54<00:10,  5.44it/s][A
Iteration:  79%|███████▉  | 213/268 [00:54<00:10,  5.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:54<00:10,  5.31it/s][A
Iteration:  80%|████████  | 215/268 [00:54<00:09,  5.40it/s][A
Iteration:  81%|████████  | 216/268 [00:55<00:09,  5.49it/s][A
Iteration:  81%|████████  | 217/268 [00:55<00:09,  5.29it/s][A
Iteration:  81%|████████▏ | 218/268 [00:55<00:09,  5.18it/s][A
Iteration:  82%|████████▏ | 219/268 [00:55<00:09,  5.05it/s][A
Iteration:  82%|████████▏ | 220/268 [00:55<00:09,  5.22it/s][A
Iteration:  82%|████████▏ | 221/268 [00:56<00:08,  5.23it/s][A
Iteration:  83%|████████▎ | 222/268 [00:56<00:08,  5.16it/s][A
Iteration:  83%|████████▎ | 223/268 [00:56<00:09,  4.96it/s][A
Iteration:  84%|████████▎ | 224/268 [00:56<00:08,  4.97it/s][A
Iteration:  84%|████████▍ | 225/268 [00:56<00:08,  5.08it/s][A
Iteration:  84%|████████▍ | 226/268 [00:57<00:08,  5.11it/s][A
Iteration:  85%|████████▍ | 227/268 [00:57<00:07,  5.18it/s][A
Iteration:  85%|████████▌ | 228/268 [00:57<00:07,  5.13it/s][A
Iteration:  85%|████████▌ | 229/268 [00:57<00:07,  5.14it/s][A
Iteration:  86%|████████▌ | 230/268 [00:57<00:07,  5.17it/s][A
Iteration:  86%|████████▌ | 231/268 [00:57<00:06,  5.36it/s][A
Iteration:  87%|████████▋ | 232/268 [00:58<00:06,  5.33it/s][A
Iteration:  87%|████████▋ | 233/268 [00:58<00:06,  5.34it/s][A
Iteration:  87%|████████▋ | 234/268 [00:58<00:06,  5.19it/s][A
Iteration:  88%|████████▊ | 235/268 [00:58<00:06,  5.22it/s][A
Iteration:  88%|████████▊ | 236/268 [00:58<00:06,  5.27it/s][A
Iteration:  88%|████████▊ | 237/268 [00:59<00:06,  5.07it/s][A
Iteration:  89%|████████▉ | 238/268 [00:59<00:05,  5.13it/s][A
Iteration:  89%|████████▉ | 239/268 [00:59<00:05,  5.15it/s][A[INFO|trainer.py:570] 2024-04-30 10:37:26,440 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:37:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:37:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:37:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:37:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.77it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.78it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.79it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.80it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.80it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.79it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.78it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.79it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.79it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.78it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.79it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.79it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.90it/s]04/30/2024 10:37:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:37:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2850901164380653, 'eval_loss': 0.8562352, 'head_layers': [1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [338, 361, 469, 447, 617, 463, 353, 283, 191, 158, 152, 176], 'head_nums': [2, 3, 4, 3, 7, 4, 4, 2, 2, 2, 2, 1], 'pruned_params': 75468644, 'remaining_params': 9548956, 'pruned_model_sparsity': 0.8876825974856971, 'expected_sparsity': 0.89251, 'target_sparsity': 0.95, 'step': 5600}


Iteration:  90%|████████▉ | 240/268 [01:03<00:34,  1.22s/it][A04/30/2024 10:37:29 - INFO - trainer.trainer_mod_2 - v4 Global step: 5600, Alignment: tensor([ 2,  5,  8, 11], device='cuda:0')

Iteration:  90%|████████▉ | 241/268 [01:03<00:24,  1.09it/s][A
Iteration:  90%|█████████ | 242/268 [01:03<00:18,  1.43it/s][A
Iteration:  91%|█████████ | 243/268 [01:03<00:13,  1.83it/s][A
Iteration:  91%|█████████ | 244/268 [01:03<00:10,  2.28it/s][A
Iteration:  91%|█████████▏| 245/268 [01:04<00:08,  2.73it/s][A
Iteration:  92%|█████████▏| 246/268 [01:04<00:06,  3.19it/s][A
Iteration:  92%|█████████▏| 247/268 [01:04<00:05,  3.63it/s][A
Iteration:  93%|█████████▎| 248/268 [01:04<00:04,  4.01it/s][A
Iteration:  93%|█████████▎| 249/268 [01:04<00:04,  4.44it/s][A
Iteration:  93%|█████████▎| 250/268 [01:05<00:03,  4.66it/s][A
Iteration:  94%|█████████▎| 251/268 [01:05<00:03,  4.84it/s][A
Iteration:  94%|█████████▍| 252/268 [01:05<00:03,  4.89it/s][A
Iteration:  94%|█████████▍| 253/268 [01:05<00:02,  5.03it/s][A
Iteration:  95%|█████████▍| 254/268 [01:05<00:02,  5.12it/s][A
Iteration:  95%|█████████▌| 255/268 [01:05<00:02,  5.20it/s][A
Iteration:  96%|█████████▌| 256/268 [01:06<00:02,  5.14it/s][A
Iteration:  96%|█████████▌| 257/268 [01:06<00:02,  5.10it/s][A
Iteration:  96%|█████████▋| 258/268 [01:06<00:01,  5.18it/s][A
Iteration:  97%|█████████▋| 259/268 [01:06<00:01,  5.10it/s][A
Iteration:  97%|█████████▋| 260/268 [01:06<00:01,  5.14it/s][A
Iteration:  97%|█████████▋| 261/268 [01:07<00:01,  4.89it/s][A
Iteration:  98%|█████████▊| 262/268 [01:07<00:01,  5.00it/s][A
Iteration:  98%|█████████▊| 263/268 [01:07<00:00,  5.10it/s][A
Iteration:  99%|█████████▊| 264/268 [01:07<00:00,  5.14it/s][A
Iteration:  99%|█████████▉| 265/268 [01:07<00:00,  5.18it/s][A
Iteration:  99%|█████████▉| 266/268 [01:08<00:00,  5.13it/s][A
Iteration: 100%|█████████▉| 267/268 [01:08<00:00,  5.16it/s][A
Iteration: 100%|██████████| 268/268 [01:08<00:00,  5.62it/s][A04/30/2024 10:37:35 - INFO - trainer.trainer_mod_2 - Epoch 20 finished. Took 68.45 seconds.
Iteration: 100%|██████████| 268/268 [01:08<00:00,  3.92it/s]
Epoch:  21%|██        | 21/100 [24:41<1:31:56, 69.82s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:50,  5.28it/s][A
Iteration:   1%|          | 2/268 [00:00<00:50,  5.29it/s][A
Iteration:   1%|          | 3/268 [00:00<00:49,  5.30it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:48,  5.47it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:49,  5.33it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:49,  5.24it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:49,  5.30it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:49,  5.28it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:49,  5.28it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:49,  5.21it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:49,  5.21it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:49,  5.14it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:47,  5.34it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:46,  5.45it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:48,  5.27it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:49,  5.12it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:50,  5.01it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:50,  4.97it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:49,  5.06it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:48,  5.11it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:48,  5.11it/s][A[INFO|trainer.py:570] 2024-04-30 10:37:39,409 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:37:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:37:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:37:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:37:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.80it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.81it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.82it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.82it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.82it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.82it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.83it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.83it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.83it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.83it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.83it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.83it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.83it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.83it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.83it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.83it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.83it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.82it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.82it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.82it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.82it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.82it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.82it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.82it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.82it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.82it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.82it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.82it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.81it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.82it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.82it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.82it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.93it/s]04/30/2024 10:37:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:37:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.28001922242981464, 'eval_loss': 0.8491121, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [332, 354, 458, 434, 615, 450, 345, 277, 189, 157, 151, 175], 'head_nums': [2, 3, 4, 3, 7, 3, 4, 2, 2, 2, 2, 1], 'pruned_params': 76354140, 'remaining_params': 8663460, 'pruned_model_sparsity': 0.8980980408762421, 'expected_sparsity': 0.90006, 'target_sparsity': 0.95, 'step': 5650}


Iteration:   8%|▊         | 22/268 [00:07<04:57,  1.21s/it][A
Iteration:   9%|▊         | 23/268 [00:07<03:41,  1.11it/s][A
Iteration:   9%|▉         | 24/268 [00:07<02:48,  1.45it/s][A
Iteration:   9%|▉         | 25/268 [00:08<02:11,  1.85it/s][A
Iteration:  10%|▉         | 26/268 [00:08<01:45,  2.28it/s][A
Iteration:  10%|█         | 27/268 [00:08<01:28,  2.74it/s][A
Iteration:  10%|█         | 28/268 [00:08<01:15,  3.18it/s][A
Iteration:  11%|█         | 29/268 [00:08<01:07,  3.57it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:59,  3.97it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:54,  4.36it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:50,  4.68it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:48,  4.86it/s][A
Iteration:  13%|█▎        | 34/268 [00:09<00:46,  5.07it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:44,  5.23it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:43,  5.36it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:44,  5.17it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:43,  5.23it/s][A
Iteration:  15%|█▍        | 39/268 [00:10<00:44,  5.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:10<00:42,  5.40it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:42,  5.36it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:43,  5.14it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:44,  5.10it/s][A
Iteration:  16%|█▋        | 44/268 [00:11<00:43,  5.17it/s][A
Iteration:  17%|█▋        | 45/268 [00:11<00:42,  5.21it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:43,  5.08it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:43,  5.13it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:41,  5.28it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:41,  5.29it/s][A
Iteration:  19%|█▊        | 50/268 [00:12<00:39,  5.49it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:39,  5.46it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:40,  5.39it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:39,  5.39it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:39,  5.39it/s][A
Iteration:  21%|██        | 55/268 [00:13<00:39,  5.38it/s][A
Iteration:  21%|██        | 56/268 [00:14<00:39,  5.39it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:39,  5.36it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:39,  5.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:39,  5.34it/s][A
Iteration:  22%|██▏       | 60/268 [00:14<00:38,  5.35it/s][A
Iteration:  23%|██▎       | 61/268 [00:14<00:38,  5.36it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:38,  5.35it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:39,  5.23it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:38,  5.26it/s][A
Iteration:  24%|██▍       | 65/268 [00:15<00:39,  5.19it/s][A
Iteration:  25%|██▍       | 66/268 [00:15<00:38,  5.22it/s][A
Iteration:  25%|██▌       | 67/268 [00:16<00:39,  5.07it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:38,  5.14it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:38,  5.23it/s][A
Iteration:  26%|██▌       | 70/268 [00:16<00:37,  5.25it/s][A
Iteration:  26%|██▋       | 71/268 [00:16<00:37,  5.29it/s][A[INFO|trainer.py:570] 2024-04-30 10:37:52,245 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:37:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:37:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:37:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:37:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.84it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.85it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.86it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.87it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.87it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.87it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.87it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.87it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.87it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.86it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.86it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.86it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.97it/s]04/30/2024 10:37:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:37:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2546882060373589, 'eval_loss': 0.7950103, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [326, 347, 446, 422, 613, 440, 337, 272, 187, 156, 151, 173], 'head_nums': [2, 3, 4, 2, 7, 3, 4, 2, 2, 2, 2, 1], 'pruned_params': 77319300, 'remaining_params': 7698300, 'pruned_model_sparsity': 0.9094505137759711, 'expected_sparsity': 0.90648, 'target_sparsity': 0.95, 'step': 5700}


Iteration:  27%|██▋       | 72/268 [00:20<03:55,  1.20s/it][A04/30/2024 10:37:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 5700, Alignment: tensor([ 2,  4,  8, 11], device='cuda:0')

Iteration:  27%|██▋       | 73/268 [00:20<02:55,  1.11it/s][A
Iteration:  28%|██▊       | 74/268 [00:20<02:13,  1.46it/s][A
Iteration:  28%|██▊       | 75/268 [00:21<01:43,  1.86it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<01:22,  2.31it/s][A
Iteration:  29%|██▊       | 77/268 [00:21<01:08,  2.78it/s][A
Iteration:  29%|██▉       | 78/268 [00:21<00:58,  3.24it/s][A
Iteration:  29%|██▉       | 79/268 [00:21<00:51,  3.66it/s][A
Iteration:  30%|██▉       | 80/268 [00:21<00:46,  4.03it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:41,  4.46it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:40,  4.55it/s][A
Iteration:  31%|███       | 83/268 [00:22<00:38,  4.78it/s][A
Iteration:  31%|███▏      | 84/268 [00:22<00:36,  5.00it/s][A
Iteration:  32%|███▏      | 85/268 [00:22<00:36,  5.08it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:35,  5.12it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:33,  5.34it/s][A
Iteration:  33%|███▎      | 88/268 [00:23<00:33,  5.31it/s][A
Iteration:  33%|███▎      | 89/268 [00:23<00:33,  5.33it/s][A
Iteration:  34%|███▎      | 90/268 [00:23<00:33,  5.30it/s][A
Iteration:  34%|███▍      | 91/268 [00:23<00:32,  5.42it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:32,  5.41it/s][A
Iteration:  35%|███▍      | 93/268 [00:24<00:32,  5.40it/s][A
Iteration:  35%|███▌      | 94/268 [00:24<00:31,  5.52it/s][A
Iteration:  35%|███▌      | 95/268 [00:24<00:31,  5.48it/s][A
Iteration:  36%|███▌      | 96/268 [00:24<00:31,  5.42it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:31,  5.41it/s][A
Iteration:  37%|███▋      | 98/268 [00:25<00:32,  5.23it/s][A
Iteration:  37%|███▋      | 99/268 [00:25<00:31,  5.31it/s][A
Iteration:  37%|███▋      | 100/268 [00:25<00:31,  5.27it/s][A
Iteration:  38%|███▊      | 101/268 [00:25<00:32,  5.16it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:33,  4.92it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:33,  4.94it/s][A
Iteration:  39%|███▉      | 104/268 [00:26<00:32,  4.97it/s][A
Iteration:  39%|███▉      | 105/268 [00:26<00:32,  5.09it/s][A
Iteration:  40%|███▉      | 106/268 [00:26<00:30,  5.33it/s][A
Iteration:  40%|███▉      | 107/268 [00:27<00:30,  5.36it/s][A
Iteration:  40%|████      | 108/268 [00:27<00:30,  5.32it/s][A
Iteration:  41%|████      | 109/268 [00:27<00:30,  5.25it/s][A
Iteration:  41%|████      | 110/268 [00:27<00:29,  5.29it/s][A
Iteration:  41%|████▏     | 111/268 [00:27<00:30,  5.19it/s][A
Iteration:  42%|████▏     | 112/268 [00:28<00:30,  5.09it/s][A
Iteration:  42%|████▏     | 113/268 [00:28<00:30,  5.16it/s][A
Iteration:  43%|████▎     | 114/268 [00:28<00:30,  5.02it/s][A
Iteration:  43%|████▎     | 115/268 [00:28<00:29,  5.13it/s][A
Iteration:  43%|████▎     | 116/268 [00:28<00:29,  5.18it/s][A
Iteration:  44%|████▎     | 117/268 [00:28<00:29,  5.20it/s][A
Iteration:  44%|████▍     | 118/268 [00:29<00:28,  5.22it/s][A
Iteration:  44%|████▍     | 119/268 [00:29<00:28,  5.24it/s][A
Iteration:  45%|████▍     | 120/268 [00:29<00:28,  5.18it/s][A
Iteration:  45%|████▌     | 121/268 [00:29<00:28,  5.22it/s][A[INFO|trainer.py:570] 2024-04-30 10:38:05,116 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:38:05 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:38:05 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:38:05 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:38:05 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.83it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.84it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.85it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.84it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.83it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.83it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.84it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.84it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.96it/s]04/30/2024 10:38:08 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:38:08 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.28891422810003087, 'eval_loss': 0.6694049, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [321, 341, 435, 410, 611, 436, 329, 267, 186, 155, 150, 172], 'head_nums': [2, 3, 4, 2, 7, 3, 4, 2, 2, 2, 2, 1], 'pruned_params': 77392836, 'remaining_params': 7624764, 'pruned_model_sparsity': 0.9103154640921409, 'expected_sparsity': 0.90974, 'target_sparsity': 0.95, 'step': 5750}


Iteration:  46%|████▌     | 122/268 [00:33<02:55,  1.20s/it][A
Iteration:  46%|████▌     | 123/268 [00:33<02:10,  1.11it/s][A
Iteration:  46%|████▋     | 124/268 [00:33<01:38,  1.46it/s][A
Iteration:  47%|████▋     | 125/268 [00:33<01:17,  1.86it/s][A
Iteration:  47%|████▋     | 126/268 [00:34<01:01,  2.31it/s][A
Iteration:  47%|████▋     | 127/268 [00:34<00:49,  2.82it/s][A
Iteration:  48%|████▊     | 128/268 [00:34<00:43,  3.24it/s][A
Iteration:  48%|████▊     | 129/268 [00:34<00:37,  3.66it/s][A
Iteration:  49%|████▊     | 130/268 [00:34<00:33,  4.10it/s][A
Iteration:  49%|████▉     | 131/268 [00:35<00:31,  4.36it/s][A
Iteration:  49%|████▉     | 132/268 [00:35<00:29,  4.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:35<00:28,  4.78it/s][A
Iteration:  50%|█████     | 134/268 [00:35<00:27,  4.94it/s][A
Iteration:  50%|█████     | 135/268 [00:35<00:26,  5.06it/s][A
Iteration:  51%|█████     | 136/268 [00:35<00:26,  5.02it/s][A
Iteration:  51%|█████     | 137/268 [00:36<00:26,  4.98it/s][A
Iteration:  51%|█████▏    | 138/268 [00:36<00:25,  5.06it/s][A
Iteration:  52%|█████▏    | 139/268 [00:36<00:24,  5.23it/s][A
Iteration:  52%|█████▏    | 140/268 [00:36<00:24,  5.24it/s][A
Iteration:  53%|█████▎    | 141/268 [00:36<00:24,  5.25it/s][A
Iteration:  53%|█████▎    | 142/268 [00:37<00:23,  5.28it/s][A
Iteration:  53%|█████▎    | 143/268 [00:37<00:23,  5.39it/s][A
Iteration:  54%|█████▎    | 144/268 [00:37<00:23,  5.37it/s][A
Iteration:  54%|█████▍    | 145/268 [00:37<00:23,  5.23it/s][A
Iteration:  54%|█████▍    | 146/268 [00:37<00:23,  5.18it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<00:23,  5.06it/s][A
Iteration:  55%|█████▌    | 148/268 [00:38<00:24,  4.99it/s][A
Iteration:  56%|█████▌    | 149/268 [00:38<00:23,  5.11it/s][A
Iteration:  56%|█████▌    | 150/268 [00:38<00:23,  5.08it/s][A
Iteration:  56%|█████▋    | 151/268 [00:38<00:22,  5.19it/s][A
Iteration:  57%|█████▋    | 152/268 [00:39<00:22,  5.14it/s][A
Iteration:  57%|█████▋    | 153/268 [00:39<00:22,  5.18it/s][A
Iteration:  57%|█████▋    | 154/268 [00:39<00:21,  5.20it/s][A
Iteration:  58%|█████▊    | 155/268 [00:39<00:21,  5.38it/s][A
Iteration:  58%|█████▊    | 156/268 [00:39<00:20,  5.53it/s][A
Iteration:  59%|█████▊    | 157/268 [00:39<00:20,  5.48it/s][A
Iteration:  59%|█████▉    | 158/268 [00:40<00:20,  5.41it/s][A
Iteration:  59%|█████▉    | 159/268 [00:40<00:20,  5.28it/s][A
Iteration:  60%|█████▉    | 160/268 [00:40<00:20,  5.17it/s][A
Iteration:  60%|██████    | 161/268 [00:40<00:21,  5.09it/s][A
Iteration:  60%|██████    | 162/268 [00:40<00:21,  5.00it/s][A
Iteration:  61%|██████    | 163/268 [00:41<00:20,  5.06it/s][A
Iteration:  61%|██████    | 164/268 [00:41<00:20,  5.13it/s][A
Iteration:  62%|██████▏   | 165/268 [00:41<00:19,  5.20it/s][A
Iteration:  62%|██████▏   | 166/268 [00:41<00:19,  5.26it/s][A
Iteration:  62%|██████▏   | 167/268 [00:41<00:19,  5.14it/s][A
Iteration:  63%|██████▎   | 168/268 [00:42<00:19,  5.12it/s][A
Iteration:  63%|██████▎   | 169/268 [00:42<00:20,  4.72it/s][A
Iteration:  63%|██████▎   | 170/268 [00:42<00:20,  4.88it/s][A
Iteration:  64%|██████▍   | 171/268 [00:42<00:19,  4.94it/s][A[INFO|trainer.py:570] 2024-04-30 10:38:18,092 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:38:18 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:38:18 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:38:18 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:38:18 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.83it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.84it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.85it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.86it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.86it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.86it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.86it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.97it/s]04/30/2024 10:38:21 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:38:21 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2679866732900764, 'eval_loss': 0.6941124, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [316, 335, 425, 399, 609, 435, 322, 262, 184, 154, 150, 171], 'head_nums': [2, 3, 4, 2, 7, 3, 4, 2, 2, 2, 2, 1], 'pruned_params': 77463308, 'remaining_params': 7554292, 'pruned_model_sparsity': 0.9111443748118037, 'expected_sparsity': 0.91216, 'target_sparsity': 0.95, 'step': 5800}


Iteration:  64%|██████▍   | 172/268 [00:46<01:55,  1.21s/it][A04/30/2024 10:38:21 - INFO - trainer.trainer_mod_2 - v4 Global step: 5800, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  65%|██████▍   | 173/268 [00:46<01:25,  1.11it/s][A
Iteration:  65%|██████▍   | 174/268 [00:46<01:03,  1.47it/s][A
Iteration:  65%|██████▌   | 175/268 [00:46<00:49,  1.88it/s][A
Iteration:  66%|██████▌   | 176/268 [00:47<00:39,  2.34it/s][A
Iteration:  66%|██████▌   | 177/268 [00:47<00:32,  2.81it/s][A
Iteration:  66%|██████▋   | 178/268 [00:47<00:27,  3.29it/s][A
Iteration:  67%|██████▋   | 179/268 [00:47<00:24,  3.67it/s][A
Iteration:  67%|██████▋   | 180/268 [00:47<00:21,  4.06it/s][A
Iteration:  68%|██████▊   | 181/268 [00:47<00:19,  4.37it/s][A
Iteration:  68%|██████▊   | 182/268 [00:48<00:18,  4.57it/s][A
Iteration:  68%|██████▊   | 183/268 [00:48<00:17,  4.80it/s][A
Iteration:  69%|██████▊   | 184/268 [00:48<00:16,  4.98it/s][A
Iteration:  69%|██████▉   | 185/268 [00:48<00:16,  5.07it/s][A
Iteration:  69%|██████▉   | 186/268 [00:48<00:16,  5.05it/s][A
Iteration:  70%|██████▉   | 187/268 [00:49<00:15,  5.11it/s][A
Iteration:  70%|███████   | 188/268 [00:49<00:15,  5.22it/s][A
Iteration:  71%|███████   | 189/268 [00:49<00:15,  5.26it/s][A
Iteration:  71%|███████   | 190/268 [00:49<00:14,  5.33it/s][A
Iteration:  71%|███████▏  | 191/268 [00:49<00:14,  5.26it/s][A
Iteration:  72%|███████▏  | 192/268 [00:50<00:14,  5.30it/s][A
Iteration:  72%|███████▏  | 193/268 [00:50<00:14,  5.24it/s][A
Iteration:  72%|███████▏  | 194/268 [00:50<00:13,  5.42it/s][A
Iteration:  73%|███████▎  | 195/268 [00:50<00:13,  5.31it/s][A
Iteration:  73%|███████▎  | 196/268 [00:50<00:13,  5.32it/s][A
Iteration:  74%|███████▎  | 197/268 [00:50<00:13,  5.34it/s][A
Iteration:  74%|███████▍  | 198/268 [00:51<00:13,  5.35it/s][A
Iteration:  74%|███████▍  | 199/268 [00:51<00:13,  5.27it/s][A
Iteration:  75%|███████▍  | 200/268 [00:51<00:12,  5.32it/s][A
Iteration:  75%|███████▌  | 201/268 [00:51<00:12,  5.31it/s][A
Iteration:  75%|███████▌  | 202/268 [00:51<00:12,  5.36it/s][A
Iteration:  76%|███████▌  | 203/268 [00:52<00:12,  5.34it/s][A
Iteration:  76%|███████▌  | 204/268 [00:52<00:11,  5.34it/s][A
Iteration:  76%|███████▋  | 205/268 [00:52<00:11,  5.28it/s][A
Iteration:  77%|███████▋  | 206/268 [00:52<00:11,  5.22it/s][A
Iteration:  77%|███████▋  | 207/268 [00:52<00:11,  5.22it/s][A
Iteration:  78%|███████▊  | 208/268 [00:53<00:11,  5.27it/s][A
Iteration:  78%|███████▊  | 209/268 [00:53<00:11,  5.18it/s][A
Iteration:  78%|███████▊  | 210/268 [00:53<00:11,  5.23it/s][A
Iteration:  79%|███████▊  | 211/268 [00:53<00:10,  5.27it/s][A
Iteration:  79%|███████▉  | 212/268 [00:53<00:10,  5.29it/s][A
Iteration:  79%|███████▉  | 213/268 [00:53<00:10,  5.31it/s][A
Iteration:  80%|███████▉  | 214/268 [00:54<00:10,  5.23it/s][A
Iteration:  80%|████████  | 215/268 [00:54<00:10,  5.24it/s][A
Iteration:  81%|████████  | 216/268 [00:54<00:10,  5.18it/s][A
Iteration:  81%|████████  | 217/268 [00:54<00:09,  5.23it/s][A
Iteration:  81%|████████▏ | 218/268 [00:54<00:09,  5.34it/s][A
Iteration:  82%|████████▏ | 219/268 [00:55<00:09,  5.32it/s][A
Iteration:  82%|████████▏ | 220/268 [00:55<00:09,  5.01it/s][A
Iteration:  82%|████████▏ | 221/268 [00:55<00:09,  5.11it/s][A[INFO|trainer.py:570] 2024-04-30 10:38:30,909 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:38:30 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:38:30 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:38:30 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:38:30 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.84it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.84it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.87it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.87it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.87it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.87it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.86it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.86it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.97it/s]04/30/2024 10:38:34 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:38:34 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2642728584404981, 'eval_loss': 0.7068103, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [311, 329, 415, 389, 607, 434, 315, 258, 183, 153, 150, 170], 'head_nums': [2, 3, 4, 2, 7, 3, 3, 2, 2, 2, 2, 1], 'pruned_params': 77725280, 'remaining_params': 7292320, 'pruned_model_sparsity': 0.9142257603131587, 'expected_sparsity': 0.91532, 'target_sparsity': 0.95, 'step': 5850}


Iteration:  83%|████████▎ | 222/268 [00:59<00:55,  1.20s/it][A
Iteration:  83%|████████▎ | 223/268 [00:59<00:40,  1.11it/s][A
Iteration:  84%|████████▎ | 224/268 [00:59<00:30,  1.44it/s][A
Iteration:  84%|████████▍ | 225/268 [00:59<00:23,  1.83it/s][A
Iteration:  84%|████████▍ | 226/268 [00:59<00:18,  2.25it/s][A
Iteration:  85%|████████▍ | 227/268 [01:00<00:15,  2.73it/s][A
Iteration:  85%|████████▌ | 228/268 [01:00<00:12,  3.16it/s][A
Iteration:  85%|████████▌ | 229/268 [01:00<00:10,  3.59it/s][A
Iteration:  86%|████████▌ | 230/268 [01:00<00:09,  4.01it/s][A
Iteration:  86%|████████▌ | 231/268 [01:00<00:08,  4.43it/s][A
Iteration:  87%|████████▋ | 232/268 [01:01<00:07,  4.62it/s][A
Iteration:  87%|████████▋ | 233/268 [01:01<00:07,  4.74it/s][A
Iteration:  87%|████████▋ | 234/268 [01:01<00:07,  4.81it/s][A
Iteration:  88%|████████▊ | 235/268 [01:01<00:06,  4.98it/s][A
Iteration:  88%|████████▊ | 236/268 [01:01<00:06,  5.10it/s][A
Iteration:  88%|████████▊ | 237/268 [01:01<00:05,  5.19it/s][A
Iteration:  89%|████████▉ | 238/268 [01:02<00:05,  5.36it/s][A
Iteration:  89%|████████▉ | 239/268 [01:02<00:05,  5.26it/s][A
Iteration:  90%|████████▉ | 240/268 [01:02<00:05,  5.32it/s][A
Iteration:  90%|████████▉ | 241/268 [01:02<00:05,  5.33it/s][A
Iteration:  90%|█████████ | 242/268 [01:02<00:04,  5.28it/s][A
Iteration:  91%|█████████ | 243/268 [01:03<00:04,  5.45it/s][A
Iteration:  91%|█████████ | 244/268 [01:03<00:04,  5.45it/s][A
Iteration:  91%|█████████▏| 245/268 [01:03<00:04,  5.43it/s][A
Iteration:  92%|█████████▏| 246/268 [01:03<00:04,  5.40it/s][A
Iteration:  92%|█████████▏| 247/268 [01:03<00:03,  5.36it/s][A
Iteration:  93%|█████████▎| 248/268 [01:04<00:03,  5.36it/s][A
Iteration:  93%|█████████▎| 249/268 [01:04<00:03,  5.40it/s][A
Iteration:  93%|█████████▎| 250/268 [01:04<00:03,  5.41it/s][A
Iteration:  94%|█████████▎| 251/268 [01:04<00:03,  5.36it/s][A
Iteration:  94%|█████████▍| 252/268 [01:04<00:03,  5.28it/s][A
Iteration:  94%|█████████▍| 253/268 [01:04<00:02,  5.23it/s][A
Iteration:  95%|█████████▍| 254/268 [01:05<00:02,  5.19it/s][A
Iteration:  95%|█████████▌| 255/268 [01:05<00:02,  5.25it/s][A
Iteration:  96%|█████████▌| 256/268 [01:05<00:02,  5.21it/s][A
Iteration:  96%|█████████▌| 257/268 [01:05<00:02,  5.17it/s][A
Iteration:  96%|█████████▋| 258/268 [01:05<00:01,  5.20it/s][A
Iteration:  97%|█████████▋| 259/268 [01:06<00:01,  5.27it/s][A
Iteration:  97%|█████████▋| 260/268 [01:06<00:01,  5.26it/s][A
Iteration:  97%|█████████▋| 261/268 [01:06<00:01,  5.17it/s][A
Iteration:  98%|█████████▊| 262/268 [01:06<00:01,  5.24it/s][A
Iteration:  98%|█████████▊| 263/268 [01:06<00:00,  5.25it/s][A
Iteration:  99%|█████████▊| 264/268 [01:07<00:00,  5.25it/s][A
Iteration:  99%|█████████▉| 265/268 [01:07<00:00,  5.17it/s][A
Iteration:  99%|█████████▉| 266/268 [01:07<00:00,  5.13it/s][A
Iteration: 100%|█████████▉| 267/268 [01:07<00:00,  5.11it/s][A
Iteration: 100%|██████████| 268/268 [01:07<00:00,  5.65it/s][A04/30/2024 10:38:42 - INFO - trainer.trainer_mod_2 - Epoch 21 finished. Took 67.8 seconds.
Iteration: 100%|██████████| 268/268 [01:07<00:00,  3.95it/s]
Epoch:  22%|██▏       | 22/100 [25:49<1:29:59, 69.22s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:57,  4.64it/s][A
Iteration:   1%|          | 2/268 [00:00<00:53,  4.99it/s][A
Iteration:   1%|          | 3/268 [00:00<00:51,  5.13it/s][A[INFO|trainer.py:570] 2024-04-30 10:38:43,767 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:38:43 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:38:43 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:38:43 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:38:43 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.83it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.84it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.85it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.85it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.75it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.78it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.80it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.82it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.83it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.84it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.84it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.96it/s]04/30/2024 10:38:47 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:38:47 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.2606658277012911, 'eval_loss': 0.71574086, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [305, 324, 406, 379, 604, 434, 309, 254, 181, 152, 149, 169], 'head_nums': [2, 2, 4, 2, 7, 3, 3, 2, 2, 2, 2, 1], 'pruned_params': 77789624, 'remaining_params': 7227976, 'pruned_model_sparsity': 0.9149825918398072, 'expected_sparsity': 0.91721, 'target_sparsity': 0.95, 'step': 5900}


Iteration:   1%|▏         | 4/268 [00:04<06:42,  1.53s/it][A04/30/2024 10:38:47 - INFO - trainer.trainer_mod_2 - v4 Global step: 5900, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:   2%|▏         | 5/268 [00:04<04:34,  1.04s/it][A
Iteration:   2%|▏         | 6/268 [00:04<03:16,  1.33it/s][A
Iteration:   3%|▎         | 7/268 [00:04<02:27,  1.76it/s][A
Iteration:   3%|▎         | 8/268 [00:04<01:56,  2.23it/s][A
Iteration:   3%|▎         | 9/268 [00:05<01:35,  2.71it/s][A
Iteration:   4%|▎         | 10/268 [00:05<01:20,  3.20it/s][A
Iteration:   4%|▍         | 11/268 [00:05<01:09,  3.72it/s][A
Iteration:   4%|▍         | 12/268 [00:05<01:02,  4.12it/s][A
Iteration:   5%|▍         | 13/268 [00:05<00:58,  4.34it/s][A
Iteration:   5%|▌         | 14/268 [00:06<00:55,  4.59it/s][A
Iteration:   6%|▌         | 15/268 [00:06<00:52,  4.78it/s][A
Iteration:   6%|▌         | 16/268 [00:06<00:51,  4.92it/s][A
Iteration:   6%|▋         | 17/268 [00:06<00:50,  4.96it/s][A
Iteration:   7%|▋         | 18/268 [00:06<00:48,  5.11it/s][A
Iteration:   7%|▋         | 19/268 [00:06<00:48,  5.18it/s][A
Iteration:   7%|▋         | 20/268 [00:07<00:48,  5.16it/s][A
Iteration:   8%|▊         | 21/268 [00:07<00:48,  5.11it/s][A
Iteration:   8%|▊         | 22/268 [00:07<00:47,  5.15it/s][A
Iteration:   9%|▊         | 23/268 [00:07<00:48,  5.07it/s][A
Iteration:   9%|▉         | 24/268 [00:07<00:48,  5.04it/s][A
Iteration:   9%|▉         | 25/268 [00:08<00:47,  5.12it/s][A
Iteration:  10%|▉         | 26/268 [00:08<00:46,  5.19it/s][A
Iteration:  10%|█         | 27/268 [00:08<00:47,  5.11it/s][A
Iteration:  10%|█         | 28/268 [00:08<00:46,  5.15it/s][A
Iteration:  11%|█         | 29/268 [00:08<00:46,  5.19it/s][A
Iteration:  11%|█         | 30/268 [00:09<00:45,  5.23it/s][A
Iteration:  12%|█▏        | 31/268 [00:09<00:45,  5.26it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:45,  5.22it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:44,  5.23it/s][A
Iteration:  13%|█▎        | 34/268 [00:09<00:45,  5.15it/s][A
Iteration:  13%|█▎        | 35/268 [00:10<00:44,  5.21it/s][A
Iteration:  13%|█▎        | 36/268 [00:10<00:44,  5.22it/s][A
Iteration:  14%|█▍        | 37/268 [00:10<00:43,  5.27it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:44,  5.21it/s][A
Iteration:  15%|█▍        | 39/268 [00:10<00:44,  5.18it/s][A
Iteration:  15%|█▍        | 40/268 [00:11<00:43,  5.23it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<00:44,  5.07it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<00:45,  5.01it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:45,  4.94it/s][A
Iteration:  16%|█▋        | 44/268 [00:11<00:45,  4.96it/s][A
Iteration:  17%|█▋        | 45/268 [00:12<00:43,  5.09it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:43,  5.11it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:42,  5.21it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:41,  5.36it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:41,  5.27it/s][A
Iteration:  19%|█▊        | 50/268 [00:12<00:42,  5.16it/s][A
Iteration:  19%|█▉        | 51/268 [00:13<00:40,  5.42it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:39,  5.51it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:39,  5.47it/s][A[INFO|trainer.py:570] 2024-04-30 10:38:56,692 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:38:56 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:38:56 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:38:56 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:38:56 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.83it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.84it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.85it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.85it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.86it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.86it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.86it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.86it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.85it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.85it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.85it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.85it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00,  9.97it/s]04/30/2024 10:39:00 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:39:00 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.24826319717182585, 'eval_loss': 0.72858924, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [300, 319, 397, 370, 602, 433, 303, 250, 180, 152, 149, 168], 'head_nums': [2, 2, 4, 2, 7, 2, 2, 2, 2, 2, 2, 1], 'pruned_params': 78045468, 'remaining_params': 6972132, 'pruned_model_sparsity': 0.9179918981481482, 'expected_sparsity': 0.91999, 'target_sparsity': 0.95, 'step': 5950}


Iteration:  20%|██        | 54/268 [00:17<04:15,  1.20s/it][A
Iteration:  21%|██        | 55/268 [00:17<03:10,  1.12it/s][A
Iteration:  21%|██        | 56/268 [00:17<02:24,  1.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:17<01:53,  1.86it/s][A
Iteration:  22%|██▏       | 58/268 [00:17<01:30,  2.32it/s][A
Iteration:  22%|██▏       | 59/268 [00:18<01:14,  2.82it/s][A
Iteration:  22%|██▏       | 60/268 [00:18<01:03,  3.29it/s][A
Iteration:  23%|██▎       | 61/268 [00:18<00:56,  3.68it/s][A
Iteration:  23%|██▎       | 62/268 [00:18<00:50,  4.09it/s][A
Iteration:  24%|██▎       | 63/268 [00:18<00:46,  4.41it/s][A
Iteration:  24%|██▍       | 64/268 [00:18<00:42,  4.76it/s][A
Iteration:  24%|██▍       | 65/268 [00:19<00:41,  4.94it/s][A
Iteration:  25%|██▍       | 66/268 [00:19<00:40,  4.99it/s][A
Iteration:  25%|██▌       | 67/268 [00:19<00:38,  5.24it/s][A
Iteration:  25%|██▌       | 68/268 [00:19<00:38,  5.26it/s][A
Iteration:  26%|██▌       | 69/268 [00:19<00:38,  5.17it/s][A
Iteration:  26%|██▌       | 70/268 [00:20<00:36,  5.38it/s][A
Iteration:  26%|██▋       | 71/268 [00:20<00:36,  5.35it/s][A
Iteration:  27%|██▋       | 72/268 [00:20<00:36,  5.30it/s][A
Iteration:  27%|██▋       | 73/268 [00:20<00:36,  5.34it/s][A
Iteration:  28%|██▊       | 74/268 [00:20<00:36,  5.36it/s][A
Iteration:  28%|██▊       | 75/268 [00:20<00:35,  5.37it/s][A
Iteration:  28%|██▊       | 76/268 [00:21<00:35,  5.41it/s][A
Iteration:  29%|██▊       | 77/268 [00:21<00:35,  5.32it/s][A
Iteration:  29%|██▉       | 78/268 [00:21<00:35,  5.32it/s][A
Iteration:  29%|██▉       | 79/268 [00:21<00:35,  5.34it/s][A
Iteration:  30%|██▉       | 80/268 [00:21<00:35,  5.29it/s][A
Iteration:  30%|███       | 81/268 [00:22<00:35,  5.21it/s][A
Iteration:  31%|███       | 82/268 [00:22<00:34,  5.43it/s][A
Iteration:  31%|███       | 83/268 [00:22<00:34,  5.42it/s][A
Iteration:  31%|███▏      | 84/268 [00:22<00:33,  5.43it/s][A
Iteration:  32%|███▏      | 85/268 [00:22<00:34,  5.33it/s][A
Iteration:  32%|███▏      | 86/268 [00:23<00:33,  5.36it/s][A
Iteration:  32%|███▏      | 87/268 [00:23<00:34,  5.31it/s][A
Iteration:  33%|███▎      | 88/268 [00:23<00:34,  5.25it/s][A
Iteration:  33%|███▎      | 89/268 [00:23<00:33,  5.31it/s][A
Iteration:  34%|███▎      | 90/268 [00:23<00:33,  5.35it/s][A
Iteration:  34%|███▍      | 91/268 [00:23<00:33,  5.35it/s][A
Iteration:  34%|███▍      | 92/268 [00:24<00:33,  5.21it/s][A
Iteration:  35%|███▍      | 93/268 [00:24<00:33,  5.23it/s][A
Iteration:  35%|███▌      | 94/268 [00:24<00:33,  5.24it/s][A
Iteration:  35%|███▌      | 95/268 [00:24<00:32,  5.27it/s][A
Iteration:  36%|███▌      | 96/268 [00:24<00:32,  5.31it/s][A
Iteration:  36%|███▌      | 97/268 [00:25<00:32,  5.30it/s][A
Iteration:  37%|███▋      | 98/268 [00:25<00:31,  5.35it/s][A
Iteration:  37%|███▋      | 99/268 [00:25<00:31,  5.35it/s][A
Iteration:  37%|███▋      | 100/268 [00:25<00:31,  5.33it/s][A
Iteration:  38%|███▊      | 101/268 [00:25<00:31,  5.35it/s][A
Iteration:  38%|███▊      | 102/268 [00:26<00:31,  5.25it/s][A
Iteration:  38%|███▊      | 103/268 [00:26<00:32,  5.13it/s][A[INFO|trainer.py:570] 2024-04-30 10:39:09,451 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:39:09 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:39:09 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:39:09 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:39:09 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.86it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.87it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.88it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.89it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.89it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.89it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.89it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.00it/s]04/30/2024 10:39:12 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:39:12 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.19336517213467808, 'eval_loss': 0.6599269, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [294, 314, 389, 365, 600, 432, 297, 247, 179, 151, 149, 167], 'head_nums': [2, 2, 4, 2, 7, 2, 2, 2, 2, 2, 2, 1], 'pruned_params': 78656736, 'remaining_params': 6360864, 'pruned_model_sparsity': 0.9251817976513098, 'expected_sparsity': 0.92383, 'target_sparsity': 0.95, 'step': 6000}


Iteration:  39%|███▉      | 104/268 [00:29<03:17,  1.20s/it][A04/30/2024 10:39:12 - INFO - trainer.trainer_mod_2 - v4 Global step: 6000, Alignment: tensor([ 2,  3,  8, 11], device='cuda:0')

Iteration:  39%|███▉      | 105/268 [00:30<02:27,  1.11it/s][A
Iteration:  40%|███▉      | 106/268 [00:30<01:51,  1.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:30<01:27,  1.85it/s][A
Iteration:  40%|████      | 108/268 [00:30<01:10,  2.28it/s][A
Iteration:  41%|████      | 109/268 [00:30<00:57,  2.75it/s][A
Iteration:  41%|████      | 110/268 [00:30<00:49,  3.21it/s][A
Iteration:  41%|████▏     | 111/268 [00:31<00:42,  3.71it/s][A
Iteration:  42%|████▏     | 112/268 [00:31<00:37,  4.18it/s][A
Iteration:  42%|████▏     | 113/268 [00:31<00:34,  4.47it/s][A
Iteration:  43%|████▎     | 114/268 [00:31<00:34,  4.53it/s][A
Iteration:  43%|████▎     | 115/268 [00:31<00:32,  4.69it/s][A
Iteration:  43%|████▎     | 116/268 [00:32<00:31,  4.85it/s][A
Iteration:  44%|████▎     | 117/268 [00:32<00:30,  4.94it/s][A
Iteration:  44%|████▍     | 118/268 [00:32<00:28,  5.24it/s][A
Iteration:  44%|████▍     | 119/268 [00:32<00:28,  5.24it/s][A
Iteration:  45%|████▍     | 120/268 [00:32<00:27,  5.30it/s][A
Iteration:  45%|████▌     | 121/268 [00:33<00:27,  5.28it/s][A
Iteration:  46%|████▌     | 122/268 [00:33<00:26,  5.46it/s][A
Iteration:  46%|████▌     | 123/268 [00:33<00:26,  5.41it/s][A
Iteration:  46%|████▋     | 124/268 [00:33<00:27,  5.14it/s][A
Iteration:  47%|████▋     | 125/268 [00:33<00:27,  5.21it/s][A
Iteration:  47%|████▋     | 126/268 [00:33<00:26,  5.36it/s][A
Iteration:  47%|████▋     | 127/268 [00:34<00:26,  5.24it/s][A
Iteration:  48%|████▊     | 128/268 [00:34<00:27,  5.10it/s][A
Iteration:  48%|████▊     | 129/268 [00:34<00:27,  5.11it/s][A
Iteration:  49%|████▊     | 130/268 [00:34<00:26,  5.19it/s][A
Iteration:  49%|████▉     | 131/268 [00:34<00:26,  5.25it/s][A
Iteration:  49%|████▉     | 132/268 [00:35<00:26,  5.21it/s][A
Iteration:  50%|████▉     | 133/268 [00:35<00:24,  5.42it/s][A
Iteration:  50%|█████     | 134/268 [00:35<00:24,  5.41it/s][A
Iteration:  50%|█████     | 135/268 [00:35<00:25,  5.22it/s][A
Iteration:  51%|█████     | 136/268 [00:35<00:24,  5.29it/s][A
Iteration:  51%|█████     | 137/268 [00:36<00:25,  5.21it/s][A
Iteration:  51%|█████▏    | 138/268 [00:36<00:24,  5.23it/s][A
Iteration:  52%|█████▏    | 139/268 [00:36<00:24,  5.27it/s][A
Iteration:  52%|█████▏    | 140/268 [00:36<00:24,  5.28it/s][A
Iteration:  53%|█████▎    | 141/268 [00:36<00:24,  5.29it/s][A
Iteration:  53%|█████▎    | 142/268 [00:37<00:24,  5.17it/s][A
Iteration:  53%|█████▎    | 143/268 [00:37<00:24,  5.12it/s][A
Iteration:  54%|█████▎    | 144/268 [00:37<00:23,  5.19it/s][A
Iteration:  54%|█████▍    | 145/268 [00:37<00:23,  5.25it/s][A
Iteration:  54%|█████▍    | 146/268 [00:37<00:23,  5.17it/s][A
Iteration:  55%|█████▍    | 147/268 [00:38<00:23,  5.24it/s][A
Iteration:  55%|█████▌    | 148/268 [00:38<00:23,  5.07it/s][A
Iteration:  56%|█████▌    | 149/268 [00:38<00:22,  5.32it/s][A
Iteration:  56%|█████▌    | 150/268 [00:38<00:22,  5.34it/s][A
Iteration:  56%|█████▋    | 151/268 [00:38<00:21,  5.36it/s][A
Iteration:  57%|█████▋    | 152/268 [00:38<00:21,  5.39it/s][A
Iteration:  57%|█████▋    | 153/268 [00:39<00:21,  5.30it/s][A[INFO|trainer.py:570] 2024-04-30 10:39:22,315 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:39:22 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:39:22 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:39:22 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:39:22 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.87it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.88it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.89it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.89it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.89it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.00it/s]04/30/2024 10:39:25 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:39:25 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.18263563129600355, 'eval_loss': 0.71072406, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [289, 309, 381, 364, 597, 431, 292, 244, 179, 150, 149, 166], 'head_nums': [2, 2, 4, 2, 6, 2, 2, 2, 2, 2, 2, 1], 'pruned_params': 78696568, 'remaining_params': 6321032, 'pruned_model_sparsity': 0.9256503124059018, 'expected_sparsity': 0.92568, 'target_sparsity': 0.95, 'step': 6050}


Iteration:  57%|█████▋    | 154/268 [00:42<02:16,  1.20s/it][A
Iteration:  58%|█████▊    | 155/268 [00:42<01:41,  1.12it/s][A
Iteration:  58%|█████▊    | 156/268 [00:43<01:16,  1.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:43<00:59,  1.86it/s][A
Iteration:  59%|█████▉    | 158/268 [00:43<00:47,  2.30it/s][A
Iteration:  59%|█████▉    | 159/268 [00:43<00:39,  2.78it/s][A
Iteration:  60%|█████▉    | 160/268 [00:43<00:33,  3.26it/s][A
Iteration:  60%|██████    | 161/268 [00:44<00:29,  3.68it/s][A
Iteration:  60%|██████    | 162/268 [00:44<00:27,  3.91it/s][A
Iteration:  61%|██████    | 163/268 [00:44<00:24,  4.21it/s][A
Iteration:  61%|██████    | 164/268 [00:44<00:23,  4.51it/s][A
Iteration:  62%|██████▏   | 165/268 [00:44<00:21,  4.72it/s][A
Iteration:  62%|██████▏   | 166/268 [00:44<00:20,  4.93it/s][A
Iteration:  62%|██████▏   | 167/268 [00:45<00:19,  5.06it/s][A
Iteration:  63%|██████▎   | 168/268 [00:45<00:19,  5.13it/s][A
Iteration:  63%|██████▎   | 169/268 [00:45<00:19,  5.18it/s][A
Iteration:  63%|██████▎   | 170/268 [00:45<00:18,  5.25it/s][A
Iteration:  64%|██████▍   | 171/268 [00:45<00:18,  5.26it/s][A
Iteration:  64%|██████▍   | 172/268 [00:46<00:18,  5.25it/s][A
Iteration:  65%|██████▍   | 173/268 [00:46<00:17,  5.31it/s][A
Iteration:  65%|██████▍   | 174/268 [00:46<00:18,  5.22it/s][A
Iteration:  65%|██████▌   | 175/268 [00:46<00:17,  5.25it/s][A
Iteration:  66%|██████▌   | 176/268 [00:46<00:17,  5.31it/s][A
Iteration:  66%|██████▌   | 177/268 [00:47<00:17,  5.31it/s][A
Iteration:  66%|██████▋   | 178/268 [00:47<00:16,  5.31it/s][A
Iteration:  67%|██████▋   | 179/268 [00:47<00:16,  5.45it/s][A
Iteration:  67%|██████▋   | 180/268 [00:47<00:16,  5.43it/s][A
Iteration:  68%|██████▊   | 181/268 [00:47<00:15,  5.49it/s][A
Iteration:  68%|██████▊   | 182/268 [00:47<00:15,  5.44it/s][A
Iteration:  68%|██████▊   | 183/268 [00:48<00:15,  5.39it/s][A
Iteration:  69%|██████▊   | 184/268 [00:48<00:15,  5.41it/s][A
Iteration:  69%|██████▉   | 185/268 [00:48<00:15,  5.38it/s][A
Iteration:  69%|██████▉   | 186/268 [00:48<00:15,  5.30it/s][A
Iteration:  70%|██████▉   | 187/268 [00:48<00:15,  5.29it/s][A
Iteration:  70%|███████   | 188/268 [00:49<00:15,  5.29it/s][A
Iteration:  71%|███████   | 189/268 [00:49<00:14,  5.33it/s][A
Iteration:  71%|███████   | 190/268 [00:49<00:14,  5.42it/s][A
Iteration:  71%|███████▏  | 191/268 [00:49<00:14,  5.42it/s][A
Iteration:  72%|███████▏  | 192/268 [00:49<00:14,  5.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:50<00:14,  5.35it/s][A
Iteration:  72%|███████▏  | 194/268 [00:50<00:14,  5.25it/s][A
Iteration:  73%|███████▎  | 195/268 [00:50<00:13,  5.32it/s][A
Iteration:  73%|███████▎  | 196/268 [00:50<00:13,  5.31it/s][A
Iteration:  74%|███████▎  | 197/268 [00:50<00:12,  5.48it/s][A
Iteration:  74%|███████▍  | 198/268 [00:50<00:12,  5.49it/s][A
Iteration:  74%|███████▍  | 199/268 [00:51<00:12,  5.43it/s][A
Iteration:  75%|███████▍  | 200/268 [00:51<00:12,  5.24it/s][A
Iteration:  75%|███████▌  | 201/268 [00:51<00:12,  5.26it/s][A
Iteration:  75%|███████▌  | 202/268 [00:51<00:12,  5.29it/s][A
Iteration:  76%|███████▌  | 203/268 [00:51<00:12,  5.31it/s][A[INFO|trainer.py:570] 2024-04-30 10:39:35,105 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:39:35 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:39:35 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:39:35 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:39:35 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.87it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.88it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.89it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.89it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.89it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.89it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.89it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.00it/s]04/30/2024 10:39:38 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:39:38 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.15386832604628503, 'eval_loss': 0.7362653, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [284, 305, 374, 363, 595, 430, 287, 241, 177, 150, 149, 165], 'head_nums': [2, 2, 4, 2, 6, 2, 2, 2, 2, 2, 2, 1], 'pruned_params': 78736400, 'remaining_params': 6281200, 'pruned_model_sparsity': 0.9261188271604939, 'expected_sparsity': 0.92859, 'target_sparsity': 0.95, 'step': 6100}


Iteration:  76%|███████▌  | 204/268 [00:55<01:17,  1.20s/it][A04/30/2024 10:39:38 - INFO - trainer.trainer_mod_2 - v4 Global step: 6100, Alignment: tensor([ 2,  6,  8, 11], device='cuda:0')

Iteration:  76%|███████▋  | 205/268 [00:55<00:56,  1.11it/s][A
Iteration:  77%|███████▋  | 206/268 [00:55<00:42,  1.46it/s][A
Iteration:  77%|███████▋  | 207/268 [00:56<00:32,  1.86it/s][A
Iteration:  78%|███████▊  | 208/268 [00:56<00:26,  2.30it/s][A
Iteration:  78%|███████▊  | 209/268 [00:56<00:21,  2.78it/s][A
Iteration:  78%|███████▊  | 210/268 [00:56<00:17,  3.25it/s][A
Iteration:  79%|███████▊  | 211/268 [00:56<00:15,  3.78it/s][A
Iteration:  79%|███████▉  | 212/268 [00:56<00:13,  4.16it/s][A
Iteration:  79%|███████▉  | 213/268 [00:57<00:12,  4.45it/s][A
Iteration:  80%|███████▉  | 214/268 [00:57<00:11,  4.69it/s][A
Iteration:  80%|████████  | 215/268 [00:57<00:10,  4.89it/s][A
Iteration:  81%|████████  | 216/268 [00:57<00:10,  4.84it/s][A
Iteration:  81%|████████  | 217/268 [00:57<00:10,  4.99it/s][A
Iteration:  81%|████████▏ | 218/268 [00:58<00:09,  5.13it/s][A
Iteration:  82%|████████▏ | 219/268 [00:58<00:09,  5.18it/s][A
Iteration:  82%|████████▏ | 220/268 [00:58<00:09,  5.24it/s][A
Iteration:  82%|████████▏ | 221/268 [00:58<00:09,  5.19it/s][A
Iteration:  83%|████████▎ | 222/268 [00:58<00:08,  5.25it/s][A
Iteration:  83%|████████▎ | 223/268 [00:59<00:08,  5.20it/s][A
Iteration:  84%|████████▎ | 224/268 [00:59<00:08,  5.39it/s][A
Iteration:  84%|████████▍ | 225/268 [00:59<00:07,  5.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:59<00:07,  5.47it/s][A
Iteration:  85%|████████▍ | 227/268 [00:59<00:07,  5.41it/s][A
Iteration:  85%|████████▌ | 228/268 [00:59<00:07,  5.39it/s][A
Iteration:  85%|████████▌ | 229/268 [01:00<00:07,  5.37it/s][A
Iteration:  86%|████████▌ | 230/268 [01:00<00:07,  5.29it/s][A
Iteration:  86%|████████▌ | 231/268 [01:00<00:06,  5.36it/s][A
Iteration:  87%|████████▋ | 232/268 [01:00<00:06,  5.36it/s][A
Iteration:  87%|████████▋ | 233/268 [01:00<00:07,  4.84it/s][A
Iteration:  87%|████████▋ | 234/268 [01:01<00:06,  5.05it/s][A
Iteration:  88%|████████▊ | 235/268 [01:01<00:06,  5.02it/s][A
Iteration:  88%|████████▊ | 236/268 [01:01<00:06,  5.12it/s][A
Iteration:  88%|████████▊ | 237/268 [01:01<00:05,  5.38it/s][A
Iteration:  89%|████████▉ | 238/268 [01:01<00:05,  5.40it/s][A
Iteration:  89%|████████▉ | 239/268 [01:02<00:05,  5.34it/s][A
Iteration:  90%|████████▉ | 240/268 [01:02<00:05,  5.25it/s][A
Iteration:  90%|████████▉ | 241/268 [01:02<00:05,  5.31it/s][A
Iteration:  90%|█████████ | 242/268 [01:02<00:04,  5.34it/s][A
Iteration:  91%|█████████ | 243/268 [01:02<00:04,  5.32it/s][A
Iteration:  91%|█████████ | 244/268 [01:03<00:04,  5.17it/s][A
Iteration:  91%|█████████▏| 245/268 [01:03<00:04,  5.06it/s][A
Iteration:  92%|█████████▏| 246/268 [01:03<00:04,  5.14it/s][A
Iteration:  92%|█████████▏| 247/268 [01:03<00:03,  5.29it/s][A
Iteration:  93%|█████████▎| 248/268 [01:03<00:03,  5.44it/s][A
Iteration:  93%|█████████▎| 249/268 [01:03<00:03,  5.34it/s][A
Iteration:  93%|█████████▎| 250/268 [01:04<00:03,  5.28it/s][A
Iteration:  94%|█████████▎| 251/268 [01:04<00:03,  5.23it/s][A
Iteration:  94%|█████████▍| 252/268 [01:04<00:03,  5.28it/s][A
Iteration:  94%|█████████▍| 253/268 [01:04<00:02,  5.25it/s][A[INFO|trainer.py:570] 2024-04-30 10:39:47,914 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:39:47 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:39:47 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:39:47 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:39:47 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.87it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.88it/s][A[A

Evaluation:   9%|▉         | 3/33 [00:00<00:03,  9.89it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02,  9.89it/s][A[A

Evaluation:  15%|█▌        | 5/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  21%|██        | 7/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  27%|██▋       | 9/33 [00:00<00:02,  9.90it/s][A[A

Evaluation:  30%|███       | 10/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  33%|███▎      | 11/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  39%|███▉      | 13/33 [00:01<00:02,  9.90it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  45%|████▌     | 15/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  52%|█████▏    | 17/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01,  9.90it/s][A[A

Evaluation:  58%|█████▊    | 19/33 [00:01<00:01,  9.89it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  64%|██████▎   | 21/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.89it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.89it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.89it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.89it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00,  9.89it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.00it/s]04/30/2024 10:39:51 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:39:51 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.06558874629318973, 'eval_loss': 0.73510885, 'head_layers': [1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1], 'mlp_layers': [1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [279, 300, 367, 362, 592, 430, 283, 238, 176, 149, 148, 164], 'head_nums': [2, 2, 3, 2, 6, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 79166892, 'remaining_params': 5850708, 'pruned_model_sparsity': 0.931182390469738, 'expected_sparsity': 0.93715, 'target_sparsity': 0.95, 'step': 6150}


Iteration:  95%|█████████▍| 254/268 [01:08<00:16,  1.20s/it][A
Iteration:  95%|█████████▌| 255/268 [01:08<00:11,  1.11it/s][A
Iteration:  96%|█████████▌| 256/268 [01:08<00:08,  1.45it/s][A
Iteration:  96%|█████████▌| 257/268 [01:08<00:05,  1.86it/s][A
Iteration:  96%|█████████▋| 258/268 [01:09<00:04,  2.29it/s][A
Iteration:  97%|█████████▋| 259/268 [01:09<00:03,  2.77it/s][A
Iteration:  97%|█████████▋| 260/268 [01:09<00:02,  3.26it/s][A
Iteration:  97%|█████████▋| 261/268 [01:09<00:01,  3.71it/s][A
Iteration:  98%|█████████▊| 262/268 [01:09<00:01,  4.10it/s][A
Iteration:  98%|█████████▊| 263/268 [01:09<00:01,  4.40it/s][A
Iteration:  99%|█████████▊| 264/268 [01:10<00:00,  4.67it/s][A
Iteration:  99%|█████████▉| 265/268 [01:10<00:00,  4.94it/s][A
Iteration:  99%|█████████▉| 266/268 [01:10<00:00,  4.98it/s][A
Iteration: 100%|█████████▉| 267/268 [01:10<00:00,  5.07it/s][A
Iteration: 100%|██████████| 268/268 [01:10<00:00,  5.62it/s][A04/30/2024 10:39:53 - INFO - trainer.trainer_mod_2 - Epoch 22 finished. Took 70.88 seconds.
Iteration: 100%|██████████| 268/268 [01:10<00:00,  3.78it/s]
Epoch:  23%|██▎       | 23/100 [27:00<1:29:28, 69.72s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:49,  5.39it/s][A
Iteration:   1%|          | 2/268 [00:00<00:50,  5.22it/s][A
Iteration:   1%|          | 3/268 [00:00<00:55,  4.81it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:52,  5.05it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:52,  5.01it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:52,  5.01it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:51,  5.03it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:50,  5.12it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:49,  5.20it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:49,  5.24it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:49,  5.17it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:50,  5.10it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:52,  4.81it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:51,  4.92it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:50,  5.00it/s][A
Iteration:   6%|▌         | 16/268 [00:03<00:50,  5.04it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:49,  5.03it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:47,  5.25it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:48,  5.17it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:48,  5.13it/s][A
Iteration:   8%|▊         | 21/268 [00:04<00:46,  5.35it/s][A
Iteration:   8%|▊         | 22/268 [00:04<00:45,  5.37it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:46,  5.30it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:44,  5.45it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:44,  5.43it/s][A
Iteration:  10%|▉         | 26/268 [00:05<00:45,  5.33it/s][A
Iteration:  10%|█         | 27/268 [00:05<00:45,  5.24it/s][A
Iteration:  10%|█         | 28/268 [00:05<00:45,  5.31it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:44,  5.38it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:44,  5.38it/s][A
Iteration:  12%|█▏        | 31/268 [00:05<00:43,  5.39it/s][A
Iteration:  12%|█▏        | 32/268 [00:06<00:43,  5.37it/s][A
Iteration:  12%|█▏        | 33/268 [00:06<00:43,  5.43it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:43,  5.40it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:43,  5.40it/s][A[INFO|trainer.py:570] 2024-04-30 10:40:00,750 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:40:00 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:40:00 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:40:00 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:40:00 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   3%|▎         | 1/33 [00:00<00:03,  9.97it/s][A[A

Evaluation:   6%|▌         | 2/33 [00:00<00:03,  9.98it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.00it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.00it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.00it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.01it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.01it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.01it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.01it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.00it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.00it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01,  9.99it/s][A[A

Evaluation:  70%|██████▉   | 23/33 [00:02<00:01,  9.98it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00,  9.98it/s][A[A

Evaluation:  76%|███████▌  | 25/33 [00:02<00:00,  9.98it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00,  9.99it/s][A[A

Evaluation:  82%|████████▏ | 27/33 [00:02<00:00,  9.99it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00,  9.99it/s][A[A

Evaluation:  88%|████████▊ | 29/33 [00:02<00:00,  9.99it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:03<00:00,  9.99it/s][A[A

Evaluation:  94%|█████████▍| 31/33 [00:03<00:00,  9.99it/s][A[A

Evaluation: 100%|██████████| 33/33 [00:03<00:00, 10.91it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.11it/s]04/30/2024 10:40:04 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:40:04 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.1077683109552469, 'eval_loss': 0.7102668, 'head_layers': [1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [274, 296, 364, 362, 589, 429, 278, 235, 175, 149, 148, 163], 'head_nums': [2, 2, 3, 2, 5, 2, 2, 1, 2, 2, 2, 1], 'pruned_params': 80541096, 'remaining_params': 4476504, 'pruned_model_sparsity': 0.9473461495031616, 'expected_sparsity': 0.9477, 'target_sparsity': 0.95, 'step': 6200}


Iteration:  13%|█▎        | 36/268 [00:10<04:34,  1.18s/it][A04/30/2024 10:40:04 - INFO - trainer.trainer_mod_2 - v4 Global step: 6200, Alignment: tensor([ 1,  6,  8, 11], device='cuda:0')

Iteration:  14%|█▍        | 37/268 [00:10<03:24,  1.13it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<02:33,  1.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:10<01:59,  1.92it/s][A
Iteration:  15%|█▍        | 40/268 [00:10<01:36,  2.37it/s][A
Iteration:  15%|█▌        | 41/268 [00:11<01:18,  2.88it/s][A
Iteration:  16%|█▌        | 42/268 [00:11<01:07,  3.35it/s][A
Iteration:  16%|█▌        | 43/268 [00:11<00:59,  3.79it/s][A
Iteration:  16%|█▋        | 44/268 [00:11<00:54,  4.10it/s][A
Iteration:  17%|█▋        | 45/268 [00:11<00:49,  4.55it/s][A
Iteration:  17%|█▋        | 46/268 [00:12<00:46,  4.82it/s][A
Iteration:  18%|█▊        | 47/268 [00:12<00:45,  4.88it/s][A
Iteration:  18%|█▊        | 48/268 [00:12<00:43,  5.05it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:41,  5.29it/s][A
Iteration:  19%|█▊        | 50/268 [00:12<00:41,  5.21it/s][A
Iteration:  19%|█▉        | 51/268 [00:12<00:41,  5.21it/s][A
Iteration:  19%|█▉        | 52/268 [00:13<00:40,  5.28it/s][A
Iteration:  20%|█▉        | 53/268 [00:13<00:42,  5.06it/s][A
Iteration:  20%|██        | 54/268 [00:13<00:42,  5.06it/s][A
Iteration:  21%|██        | 55/268 [00:13<00:40,  5.24it/s][A
Iteration:  21%|██        | 56/268 [00:13<00:39,  5.32it/s][A
Iteration:  21%|██▏       | 57/268 [00:14<00:39,  5.33it/s][A
Iteration:  22%|██▏       | 58/268 [00:14<00:39,  5.28it/s][A
Iteration:  22%|██▏       | 59/268 [00:14<00:39,  5.33it/s][A
Iteration:  22%|██▏       | 60/268 [00:14<00:39,  5.23it/s][A
Iteration:  23%|██▎       | 61/268 [00:14<00:39,  5.28it/s][A
Iteration:  23%|██▎       | 62/268 [00:15<00:37,  5.48it/s][A
Iteration:  24%|██▎       | 63/268 [00:15<00:36,  5.59it/s][A
Iteration:  24%|██▍       | 64/268 [00:15<00:36,  5.64it/s][A
Iteration:  24%|██▍       | 65/268 [00:15<00:36,  5.62it/s][A
Iteration:  25%|██▍       | 66/268 [00:15<00:37,  5.45it/s][A
Iteration:  25%|██▌       | 67/268 [00:15<00:37,  5.33it/s][A
Iteration:  25%|██▌       | 68/268 [00:16<00:37,  5.32it/s][A
Iteration:  26%|██▌       | 69/268 [00:16<00:37,  5.38it/s][A
Iteration:  26%|██▌       | 70/268 [00:16<00:36,  5.40it/s][A
Iteration:  26%|██▋       | 71/268 [00:16<00:36,  5.41it/s][A
Iteration:  27%|██▋       | 72/268 [00:16<00:36,  5.41it/s][A
Iteration:  27%|██▋       | 73/268 [00:17<00:35,  5.42it/s][A
Iteration:  28%|██▊       | 74/268 [00:17<00:35,  5.43it/s][A
Iteration:  28%|██▊       | 75/268 [00:17<00:35,  5.47it/s][A
Iteration:  28%|██▊       | 76/268 [00:17<00:35,  5.45it/s][A
Iteration:  29%|██▊       | 77/268 [00:17<00:35,  5.36it/s][A
Iteration:  29%|██▉       | 78/268 [00:17<00:36,  5.23it/s][A
Iteration:  29%|██▉       | 79/268 [00:18<00:35,  5.29it/s][A
Iteration:  30%|██▉       | 80/268 [00:18<00:35,  5.35it/s][A
Iteration:  30%|███       | 81/268 [00:18<00:34,  5.37it/s][A
Iteration:  31%|███       | 82/268 [00:18<00:35,  5.25it/s][A
Iteration:  31%|███       | 83/268 [00:18<00:35,  5.27it/s][A
Iteration:  31%|███▏      | 84/268 [00:19<00:34,  5.34it/s][A
Iteration:  32%|███▏      | 85/268 [00:19<00:33,  5.52it/s][A[INFO|trainer.py:570] 2024-04-30 10:40:13,324 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:40:13 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:40:13 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:40:13 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:40:13 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.02it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.04it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.00it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.14it/s]04/30/2024 10:40:16 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:40:16 - INFO - trainer.trainer_mod_2 - Starting saving the best from epoch 23 and step 6250
04/30/2024 10:40:16 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6405147, 'head_layers': [1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [270, 291, 362, 361, 587, 428, 274, 233, 174, 149, 148, 162], 'head_nums': [2, 2, 3, 2, 5, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 81028272, 'remaining_params': 3989328, 'pruned_model_sparsity': 0.9530764453477868, 'expected_sparsity': 0.95322, 'target_sparsity': 0.95, 'step': 6250}


Iteration:  32%|███▏      | 86/268 [00:22<03:34,  1.18s/it][A
Iteration:  32%|███▏      | 87/268 [00:22<02:39,  1.14it/s][A
Iteration:  33%|███▎      | 88/268 [00:23<02:00,  1.49it/s][A
Iteration:  33%|███▎      | 89/268 [00:23<01:33,  1.91it/s][A
Iteration:  34%|███▎      | 90/268 [00:23<01:15,  2.37it/s][A
Iteration:  34%|███▍      | 91/268 [00:23<01:02,  2.85it/s][A
Iteration:  34%|███▍      | 92/268 [00:23<00:52,  3.33it/s][A
Iteration:  35%|███▍      | 93/268 [00:24<00:45,  3.83it/s][A
Iteration:  35%|███▌      | 94/268 [00:24<00:40,  4.31it/s][A
Iteration:  35%|███▌      | 95/268 [00:24<00:38,  4.55it/s][A
Iteration:  36%|███▌      | 96/268 [00:24<00:36,  4.73it/s][A
Iteration:  36%|███▌      | 97/268 [00:24<00:35,  4.87it/s][A
Iteration:  37%|███▋      | 98/268 [00:24<00:34,  4.94it/s][A
Iteration:  37%|███▋      | 99/268 [00:25<00:33,  5.10it/s][A
Iteration:  37%|███▋      | 100/268 [00:25<00:31,  5.33it/s][A
Iteration:  38%|███▊      | 101/268 [00:25<00:31,  5.37it/s][A
Iteration:  38%|███▊      | 102/268 [00:25<00:30,  5.42it/s][A
Iteration:  38%|███▊      | 103/268 [00:25<00:30,  5.42it/s][A
Iteration:  39%|███▉      | 104/268 [00:26<00:30,  5.35it/s][A
Iteration:  39%|███▉      | 105/268 [00:26<00:30,  5.37it/s][A
Iteration:  40%|███▉      | 106/268 [00:26<00:29,  5.45it/s][A
Iteration:  40%|███▉      | 107/268 [00:26<00:29,  5.37it/s][A
Iteration:  40%|████      | 108/268 [00:26<00:29,  5.38it/s][A
Iteration:  41%|████      | 109/268 [00:26<00:28,  5.52it/s][A
Iteration:  41%|████      | 110/268 [00:27<00:28,  5.53it/s][A
Iteration:  41%|████▏     | 111/268 [00:27<00:28,  5.53it/s][A
Iteration:  42%|████▏     | 112/268 [00:27<00:28,  5.50it/s][A
Iteration:  42%|████▏     | 113/268 [00:27<00:28,  5.51it/s][A
Iteration:  43%|████▎     | 114/268 [00:27<00:29,  5.31it/s][A
Iteration:  43%|████▎     | 115/268 [00:28<00:28,  5.36it/s][A
Iteration:  43%|████▎     | 116/268 [00:28<00:28,  5.42it/s][A
Iteration:  44%|████▎     | 117/268 [00:28<00:27,  5.51it/s][A
Iteration:  44%|████▍     | 118/268 [00:28<00:28,  5.35it/s][A
Iteration:  44%|████▍     | 119/268 [00:28<00:27,  5.34it/s][A
Iteration:  45%|████▍     | 120/268 [00:29<00:27,  5.29it/s][A
Iteration:  45%|████▌     | 121/268 [00:29<00:27,  5.30it/s][A
Iteration:  46%|████▌     | 122/268 [00:29<00:27,  5.37it/s][A
Iteration:  46%|████▌     | 123/268 [00:29<00:26,  5.37it/s][A
Iteration:  46%|████▋     | 124/268 [00:29<00:27,  5.28it/s][A
Iteration:  47%|████▋     | 125/268 [00:29<00:26,  5.32it/s][A
Iteration:  47%|████▋     | 126/268 [00:30<00:26,  5.39it/s][A
Iteration:  47%|████▋     | 127/268 [00:30<00:25,  5.53it/s][A
Iteration:  48%|████▊     | 128/268 [00:30<00:25,  5.39it/s][A
Iteration:  48%|████▊     | 129/268 [00:30<00:25,  5.39it/s][A
Iteration:  49%|████▊     | 130/268 [00:30<00:25,  5.43it/s][A
Iteration:  49%|████▉     | 131/268 [00:31<00:25,  5.28it/s][A
Iteration:  49%|████▉     | 132/268 [00:31<00:26,  5.23it/s][A
Iteration:  50%|████▉     | 133/268 [00:31<00:24,  5.42it/s][A
Iteration:  50%|█████     | 134/268 [00:31<00:24,  5.45it/s][A
Iteration:  50%|█████     | 135/268 [00:31<00:24,  5.46it/s][A[INFO|trainer.py:570] 2024-04-30 10:40:25,845 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:40:25 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:40:25 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:40:25 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:40:25 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.02it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.03it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.04it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.04it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.04it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.04it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.04it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.04it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.04it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.04it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.04it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.04it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.03it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.03it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.03it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.03it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.15it/s]04/30/2024 10:40:29 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:40:29 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6878153, 'head_layers': [1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [266, 287, 362, 361, 584, 427, 270, 231, 174, 149, 148, 162], 'head_nums': [2, 2, 3, 2, 5, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 81049720, 'remaining_params': 3967880, 'pruned_model_sparsity': 0.9533287225233363, 'expected_sparsity': 0.95576, 'target_sparsity': 0.95, 'step': 6300}


Iteration:  51%|█████     | 136/268 [00:35<02:35,  1.17s/it][A04/30/2024 10:40:29 - INFO - trainer.trainer_mod_2 - v4 Global step: 6300, Alignment: tensor([1, 1, 1, 6], device='cuda:0')

Iteration:  51%|█████     | 137/268 [00:35<01:54,  1.14it/s][A
Iteration:  51%|█████▏    | 138/268 [00:35<01:26,  1.50it/s][A
Iteration:  52%|█████▏    | 139/268 [00:35<01:08,  1.89it/s][A
Iteration:  52%|█████▏    | 140/268 [00:36<00:54,  2.36it/s][A
Iteration:  53%|█████▎    | 141/268 [00:36<00:44,  2.84it/s][A
Iteration:  53%|█████▎    | 142/268 [00:36<00:38,  3.27it/s][A
Iteration:  53%|█████▎    | 143/268 [00:36<00:33,  3.71it/s][A
Iteration:  54%|█████▎    | 144/268 [00:36<00:30,  4.10it/s][A
Iteration:  54%|█████▍    | 145/268 [00:36<00:27,  4.40it/s][A
Iteration:  54%|█████▍    | 146/268 [00:37<00:25,  4.70it/s][A
Iteration:  55%|█████▍    | 147/268 [00:37<00:24,  5.03it/s][A
Iteration:  55%|█████▌    | 148/268 [00:37<00:24,  4.99it/s][A
Iteration:  56%|█████▌    | 149/268 [00:37<00:23,  5.06it/s][A
Iteration:  56%|█████▌    | 150/268 [00:37<00:22,  5.21it/s][A
Iteration:  56%|█████▋    | 151/268 [00:38<00:22,  5.27it/s][A
Iteration:  57%|█████▋    | 152/268 [00:38<00:21,  5.45it/s][A
Iteration:  57%|█████▋    | 153/268 [00:38<00:21,  5.43it/s][A
Iteration:  57%|█████▋    | 154/268 [00:38<00:20,  5.46it/s][A
Iteration:  58%|█████▊    | 155/268 [00:38<00:21,  5.32it/s][A
Iteration:  58%|█████▊    | 156/268 [00:38<00:20,  5.51it/s][A
Iteration:  59%|█████▊    | 157/268 [00:39<00:20,  5.38it/s][A
Iteration:  59%|█████▉    | 158/268 [00:39<00:19,  5.54it/s][A
Iteration:  59%|█████▉    | 159/268 [00:39<00:20,  5.43it/s][A
Iteration:  60%|█████▉    | 160/268 [00:39<00:19,  5.43it/s][A
Iteration:  60%|██████    | 161/268 [00:39<00:19,  5.58it/s][A
Iteration:  60%|██████    | 162/268 [00:40<00:19,  5.57it/s][A
Iteration:  61%|██████    | 163/268 [00:40<00:19,  5.37it/s][A
Iteration:  61%|██████    | 164/268 [00:40<00:18,  5.50it/s][A
Iteration:  62%|██████▏   | 165/268 [00:40<00:18,  5.51it/s][A
Iteration:  62%|██████▏   | 166/268 [00:40<00:18,  5.64it/s][A
Iteration:  62%|██████▏   | 167/268 [00:40<00:17,  5.73it/s][A
Iteration:  63%|██████▎   | 168/268 [00:41<00:17,  5.71it/s][A
Iteration:  63%|██████▎   | 169/268 [00:41<00:17,  5.80it/s][A
Iteration:  63%|██████▎   | 170/268 [00:41<00:17,  5.61it/s][A
Iteration:  64%|██████▍   | 171/268 [00:41<00:17,  5.48it/s][A
Iteration:  64%|██████▍   | 172/268 [00:41<00:17,  5.54it/s][A
Iteration:  65%|██████▍   | 173/268 [00:42<00:17,  5.56it/s][A
Iteration:  65%|██████▍   | 174/268 [00:42<00:16,  5.56it/s][A
Iteration:  65%|██████▌   | 175/268 [00:42<00:17,  5.36it/s][A
Iteration:  66%|██████▌   | 176/268 [00:42<00:16,  5.47it/s][A
Iteration:  66%|██████▌   | 177/268 [00:42<00:16,  5.45it/s][A
Iteration:  66%|██████▋   | 178/268 [00:42<00:16,  5.57it/s][A
Iteration:  67%|██████▋   | 179/268 [00:43<00:16,  5.55it/s][A
Iteration:  67%|██████▋   | 180/268 [00:43<00:16,  5.45it/s][A
Iteration:  68%|██████▊   | 181/268 [00:43<00:16,  5.41it/s][A
Iteration:  68%|██████▊   | 182/268 [00:43<00:15,  5.46it/s][A
Iteration:  68%|██████▊   | 183/268 [00:43<00:15,  5.60it/s][A
Iteration:  69%|██████▊   | 184/268 [00:44<00:15,  5.53it/s][A
Iteration:  69%|██████▉   | 185/268 [00:44<00:15,  5.50it/s][A[INFO|trainer.py:570] 2024-04-30 10:40:38,275 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:40:38 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:40:38 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:40:38 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:40:38 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.05it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.06it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.07it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.07it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.08it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.08it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.08it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.08it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.07it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.07it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.07it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.07it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.07it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.07it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.07it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.07it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.18it/s]04/30/2024 10:40:41 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:40:41 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.67899084, 'head_layers': [0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [263, 284, 361, 360, 581, 426, 266, 228, 174, 148, 148, 161], 'head_nums': [2, 2, 3, 2, 5, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 81461828, 'remaining_params': 3555772, 'pruned_model_sparsity': 0.9581760482535381, 'expected_sparsity': 0.95847, 'target_sparsity': 0.95, 'step': 6350}


Iteration:  69%|██████▉   | 186/268 [00:47<01:36,  1.17s/it][A
Iteration:  70%|██████▉   | 187/268 [00:47<01:10,  1.14it/s][A
Iteration:  70%|███████   | 188/268 [00:48<00:52,  1.51it/s][A
Iteration:  71%|███████   | 189/268 [00:48<00:40,  1.93it/s][A
Iteration:  71%|███████   | 190/268 [00:48<00:32,  2.41it/s][A
Iteration:  71%|███████▏  | 191/268 [00:48<00:26,  2.90it/s][A
Iteration:  72%|███████▏  | 192/268 [00:48<00:22,  3.38it/s][A
Iteration:  72%|███████▏  | 193/268 [00:48<00:19,  3.85it/s][A
Iteration:  72%|███████▏  | 194/268 [00:49<00:18,  4.09it/s][A
Iteration:  73%|███████▎  | 195/268 [00:49<00:16,  4.41it/s][A
Iteration:  73%|███████▎  | 196/268 [00:49<00:15,  4.60it/s][A
Iteration:  74%|███████▎  | 197/268 [00:49<00:14,  4.85it/s][A
Iteration:  74%|███████▍  | 198/268 [00:49<00:13,  5.01it/s][A
Iteration:  74%|███████▍  | 199/268 [00:50<00:13,  4.99it/s][A
Iteration:  75%|███████▍  | 200/268 [00:50<00:13,  5.15it/s][A
Iteration:  75%|███████▌  | 201/268 [00:50<00:12,  5.22it/s][A
Iteration:  75%|███████▌  | 202/268 [00:50<00:12,  5.26it/s][A
Iteration:  76%|███████▌  | 203/268 [00:50<00:12,  5.33it/s][A
Iteration:  76%|███████▌  | 204/268 [00:51<00:11,  5.37it/s][A
Iteration:  76%|███████▋  | 205/268 [00:51<00:11,  5.45it/s][A
Iteration:  77%|███████▋  | 206/268 [00:51<00:11,  5.50it/s][A
Iteration:  77%|███████▋  | 207/268 [00:51<00:11,  5.29it/s][A
Iteration:  78%|███████▊  | 208/268 [00:51<00:11,  5.34it/s][A
Iteration:  78%|███████▊  | 209/268 [00:51<00:10,  5.46it/s][A
Iteration:  78%|███████▊  | 210/268 [00:52<00:10,  5.42it/s][A
Iteration:  79%|███████▊  | 211/268 [00:52<00:10,  5.36it/s][A
Iteration:  79%|███████▉  | 212/268 [00:52<00:10,  5.25it/s][A
Iteration:  79%|███████▉  | 213/268 [00:52<00:10,  5.29it/s][A
Iteration:  80%|███████▉  | 214/268 [00:52<00:09,  5.51it/s][A
Iteration:  80%|████████  | 215/268 [00:53<00:09,  5.49it/s][A
Iteration:  81%|████████  | 216/268 [00:53<00:09,  5.57it/s][A
Iteration:  81%|████████  | 217/268 [00:53<00:09,  5.52it/s][A
Iteration:  81%|████████▏ | 218/268 [00:53<00:09,  5.53it/s][A
Iteration:  82%|████████▏ | 219/268 [00:53<00:09,  5.39it/s][A
Iteration:  82%|████████▏ | 220/268 [00:53<00:08,  5.38it/s][A
Iteration:  82%|████████▏ | 221/268 [00:54<00:08,  5.38it/s][A
Iteration:  83%|████████▎ | 222/268 [00:54<00:08,  5.26it/s][A
Iteration:  83%|████████▎ | 223/268 [00:54<00:08,  5.30it/s][A
Iteration:  84%|████████▎ | 224/268 [00:54<00:08,  5.31it/s][A
Iteration:  84%|████████▍ | 225/268 [00:54<00:08,  5.27it/s][A
Iteration:  84%|████████▍ | 226/268 [00:55<00:08,  5.24it/s][A
Iteration:  85%|████████▍ | 227/268 [00:55<00:07,  5.28it/s][A
Iteration:  85%|████████▌ | 228/268 [00:55<00:07,  5.25it/s][A
Iteration:  85%|████████▌ | 229/268 [00:55<00:07,  5.43it/s][A
Iteration:  86%|████████▌ | 230/268 [00:55<00:06,  5.44it/s][A
Iteration:  86%|████████▌ | 231/268 [00:56<00:06,  5.59it/s][A
Iteration:  87%|████████▋ | 232/268 [00:56<00:06,  5.62it/s][A
Iteration:  87%|████████▋ | 233/268 [00:56<00:06,  5.66it/s][A
Iteration:  87%|████████▋ | 234/268 [00:56<00:06,  5.49it/s][A
Iteration:  88%|████████▊ | 235/268 [00:56<00:06,  5.49it/s][A[INFO|trainer.py:570] 2024-04-30 10:40:50,783 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:40:50 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:40:50 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:40:50 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:40:50 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.08it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.10it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.11it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.11it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.11it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.11it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.11it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.11it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.11it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.11it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.10it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.10it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.10it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.10it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.10it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.22it/s]04/30/2024 10:40:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:40:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6571951, 'head_layers': [0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [259, 280, 361, 360, 579, 425, 262, 226, 174, 148, 148, 161], 'head_nums': [1, 2, 3, 2, 4, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 81875468, 'remaining_params': 3142132, 'pruned_model_sparsity': 0.9630413937819934, 'expected_sparsity': 0.9622, 'target_sparsity': 0.95, 'step': 6400}


Iteration:  88%|████████▊ | 236/268 [01:00<00:37,  1.16s/it][A04/30/2024 10:40:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 6400, Alignment: tensor([0, 0, 1, 1], device='cuda:0')

Iteration:  88%|████████▊ | 237/268 [01:00<00:27,  1.14it/s][A
Iteration:  89%|████████▉ | 238/268 [01:00<00:20,  1.50it/s][A
Iteration:  89%|████████▉ | 239/268 [01:00<00:15,  1.92it/s][A
Iteration:  90%|████████▉ | 240/268 [01:00<00:11,  2.40it/s][A
Iteration:  90%|████████▉ | 241/268 [01:01<00:09,  2.85it/s][A
Iteration:  90%|█████████ | 242/268 [01:01<00:07,  3.30it/s][A
Iteration:  91%|█████████ | 243/268 [01:01<00:06,  3.73it/s][A
Iteration:  91%|█████████ | 244/268 [01:01<00:05,  4.13it/s][A
Iteration:  91%|█████████▏| 245/268 [01:01<00:05,  4.51it/s][A
Iteration:  92%|█████████▏| 246/268 [01:02<00:04,  4.80it/s][A
Iteration:  92%|█████████▏| 247/268 [01:02<00:04,  5.07it/s][A
Iteration:  93%|█████████▎| 248/268 [01:02<00:03,  5.18it/s][A
Iteration:  93%|█████████▎| 249/268 [01:02<00:03,  5.35it/s][A
Iteration:  93%|█████████▎| 250/268 [01:02<00:03,  5.52it/s][A
Iteration:  94%|█████████▎| 251/268 [01:02<00:03,  5.35it/s][A
Iteration:  94%|█████████▍| 252/268 [01:03<00:02,  5.35it/s][A
Iteration:  94%|█████████▍| 253/268 [01:03<00:02,  5.45it/s][A
Iteration:  95%|█████████▍| 254/268 [01:03<00:02,  5.49it/s][A
Iteration:  95%|█████████▌| 255/268 [01:03<00:02,  5.54it/s][A
Iteration:  96%|█████████▌| 256/268 [01:03<00:02,  5.60it/s][A
Iteration:  96%|█████████▌| 257/268 [01:04<00:01,  5.56it/s][A
Iteration:  96%|█████████▋| 258/268 [01:04<00:01,  5.74it/s][A
Iteration:  97%|█████████▋| 259/268 [01:04<00:01,  5.61it/s][A
Iteration:  97%|█████████▋| 260/268 [01:04<00:01,  5.62it/s][A
Iteration:  97%|█████████▋| 261/268 [01:04<00:01,  5.58it/s][A
Iteration:  98%|█████████▊| 262/268 [01:04<00:01,  5.61it/s][A
Iteration:  98%|█████████▊| 263/268 [01:05<00:00,  5.66it/s][A
Iteration:  99%|█████████▊| 264/268 [01:05<00:00,  5.52it/s][A
Iteration:  99%|█████████▉| 265/268 [01:05<00:00,  5.51it/s][A
Iteration:  99%|█████████▉| 266/268 [01:05<00:00,  5.52it/s][A
Iteration: 100%|█████████▉| 267/268 [01:05<00:00,  5.60it/s][A
Iteration: 100%|██████████| 268/268 [01:05<00:00,  5.85it/s][A04/30/2024 10:40:59 - INFO - trainer.trainer_mod_2 - Epoch 23 finished. Took 65.96 seconds.
Iteration: 100%|██████████| 268/268 [01:05<00:00,  4.06it/s]
Epoch:  24%|██▍       | 24/100 [28:06<1:26:52, 68.59s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:45,  5.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:46,  5.74it/s][A
Iteration:   1%|          | 3/268 [00:00<00:47,  5.59it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:49,  5.30it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:48,  5.39it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:47,  5.49it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:47,  5.52it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:48,  5.39it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:47,  5.46it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:48,  5.28it/s][A
Iteration:   4%|▍         | 11/268 [00:02<00:49,  5.24it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:47,  5.36it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:47,  5.40it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:47,  5.32it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:48,  5.25it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:47,  5.31it/s][A
Iteration:   6%|▋         | 17/268 [00:03<00:44,  5.58it/s][A[INFO|trainer.py:570] 2024-04-30 10:41:03,131 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:41:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:41:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:41:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:41:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.12it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.14it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.14it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.15it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.15it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.15it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.15it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.15it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.15it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.15it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.15it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.15it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.14it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.14it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.14it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.14it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.26it/s]04/30/2024 10:41:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:41:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6726372, 'head_layers': [0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [256, 277, 361, 359, 576, 424, 260, 224, 174, 148, 147, 160], 'head_nums': [1, 2, 3, 2, 4, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 82289108, 'remaining_params': 2728492, 'pruned_model_sparsity': 0.9679067393104487, 'expected_sparsity': 0.96761, 'target_sparsity': 0.95, 'step': 6450}


Iteration:   7%|▋         | 18/268 [00:06<04:51,  1.16s/it][A
Iteration:   7%|▋         | 19/268 [00:06<03:36,  1.15it/s][A
Iteration:   7%|▋         | 20/268 [00:06<02:43,  1.52it/s][A
Iteration:   8%|▊         | 21/268 [00:07<02:07,  1.94it/s][A
Iteration:   8%|▊         | 22/268 [00:07<01:41,  2.41it/s][A
Iteration:   9%|▊         | 23/268 [00:07<01:24,  2.92it/s][A
Iteration:   9%|▉         | 24/268 [00:07<01:11,  3.42it/s][A
Iteration:   9%|▉         | 25/268 [00:07<01:01,  3.95it/s][A
Iteration:  10%|▉         | 26/268 [00:07<00:55,  4.39it/s][A
Iteration:  10%|█         | 27/268 [00:08<00:51,  4.71it/s][A
Iteration:  10%|█         | 28/268 [00:08<00:47,  5.01it/s][A
Iteration:  11%|█         | 29/268 [00:08<00:48,  4.94it/s][A
Iteration:  11%|█         | 30/268 [00:08<00:48,  4.94it/s][A
Iteration:  12%|█▏        | 31/268 [00:08<00:46,  5.10it/s][A
Iteration:  12%|█▏        | 32/268 [00:09<00:44,  5.31it/s][A
Iteration:  12%|█▏        | 33/268 [00:09<00:43,  5.42it/s][A
Iteration:  13%|█▎        | 34/268 [00:09<00:42,  5.52it/s][A
Iteration:  13%|█▎        | 35/268 [00:09<00:41,  5.61it/s][A
Iteration:  13%|█▎        | 36/268 [00:09<00:41,  5.61it/s][A
Iteration:  14%|█▍        | 37/268 [00:09<00:40,  5.69it/s][A
Iteration:  14%|█▍        | 38/268 [00:10<00:39,  5.76it/s][A
Iteration:  15%|█▍        | 39/268 [00:10<00:39,  5.80it/s][A
Iteration:  15%|█▍        | 40/268 [00:10<00:40,  5.65it/s][A
Iteration:  15%|█▌        | 41/268 [00:10<00:39,  5.77it/s][A
Iteration:  16%|█▌        | 42/268 [00:10<00:39,  5.74it/s][A
Iteration:  16%|█▌        | 43/268 [00:10<00:38,  5.86it/s][A
Iteration:  16%|█▋        | 44/268 [00:11<00:37,  5.92it/s][A
Iteration:  17%|█▋        | 45/268 [00:11<00:39,  5.71it/s][A
Iteration:  17%|█▋        | 46/268 [00:11<00:39,  5.69it/s][A
Iteration:  18%|█▊        | 47/268 [00:11<00:39,  5.59it/s][A
Iteration:  18%|█▊        | 48/268 [00:11<00:39,  5.53it/s][A
Iteration:  18%|█▊        | 49/268 [00:12<00:40,  5.47it/s][A
Iteration:  19%|█▊        | 50/268 [00:12<00:39,  5.48it/s][A
Iteration:  19%|█▉        | 51/268 [00:12<00:38,  5.57it/s][A
Iteration:  19%|█▉        | 52/268 [00:12<00:38,  5.57it/s][A
Iteration:  20%|█▉        | 53/268 [00:12<00:38,  5.64it/s][A
Iteration:  20%|██        | 54/268 [00:12<00:38,  5.57it/s][A
Iteration:  21%|██        | 55/268 [00:13<00:37,  5.67it/s][A
Iteration:  21%|██        | 56/268 [00:13<00:37,  5.64it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<00:37,  5.59it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:38,  5.46it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:38,  5.49it/s][A
Iteration:  22%|██▏       | 60/268 [00:14<00:37,  5.49it/s][A
Iteration:  23%|██▎       | 61/268 [00:14<00:38,  5.32it/s][A
Iteration:  23%|██▎       | 62/268 [00:14<00:39,  5.28it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:38,  5.39it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:37,  5.45it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:36,  5.52it/s][A
Iteration:  25%|██▍       | 66/268 [00:15<00:37,  5.36it/s][A
Iteration:  25%|██▌       | 67/268 [00:15<00:36,  5.45it/s][A[INFO|trainer.py:570] 2024-04-30 10:41:15,355 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:41:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:41:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:41:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:41:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.16it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.19it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.19it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.15it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.16it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.17it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.17it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.17it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.18it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.29it/s]04/30/2024 10:41:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:41:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6684072, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [253, 273, 360, 359, 573, 423, 259, 222, 174, 148, 147, 160], 'head_nums': [1, 2, 3, 2, 3, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 82695088, 'remaining_params': 2322512, 'pruned_model_sparsity': 0.9726819858476362, 'expected_sparsity': 0.97192, 'target_sparsity': 0.95, 'step': 6500}


Iteration:  25%|██▌       | 68/268 [00:18<03:52,  1.16s/it][A04/30/2024 10:41:18 - INFO - trainer.trainer_mod_2 - v4 Global step: 6500, Alignment: tensor([5, 5, 5, 5], device='cuda:0')

Iteration:  26%|██▌       | 69/268 [00:19<02:53,  1.14it/s][A
Iteration:  26%|██▌       | 70/268 [00:19<02:11,  1.50it/s][A
Iteration:  26%|██▋       | 71/268 [00:19<01:42,  1.93it/s][A
Iteration:  27%|██▋       | 72/268 [00:19<01:21,  2.40it/s][A
Iteration:  27%|██▋       | 73/268 [00:19<01:07,  2.89it/s][A
Iteration:  28%|██▊       | 74/268 [00:19<00:57,  3.37it/s][A
Iteration:  28%|██▊       | 75/268 [00:20<00:50,  3.86it/s][A
Iteration:  28%|██▊       | 76/268 [00:20<00:45,  4.25it/s][A
Iteration:  29%|██▊       | 77/268 [00:20<00:41,  4.58it/s][A
Iteration:  29%|██▉       | 78/268 [00:20<00:38,  4.88it/s][A
Iteration:  29%|██▉       | 79/268 [00:20<00:38,  4.90it/s][A
Iteration:  30%|██▉       | 80/268 [00:20<00:36,  5.15it/s][A
Iteration:  30%|███       | 81/268 [00:21<00:35,  5.33it/s][A
Iteration:  31%|███       | 82/268 [00:21<00:33,  5.50it/s][A
Iteration:  31%|███       | 83/268 [00:21<00:33,  5.51it/s][A
Iteration:  31%|███▏      | 84/268 [00:21<00:33,  5.56it/s][A
Iteration:  32%|███▏      | 85/268 [00:21<00:32,  5.58it/s][A
Iteration:  32%|███▏      | 86/268 [00:22<00:33,  5.40it/s][A
Iteration:  32%|███▏      | 87/268 [00:22<00:32,  5.51it/s][A
Iteration:  33%|███▎      | 88/268 [00:22<00:32,  5.54it/s][A
Iteration:  33%|███▎      | 89/268 [00:22<00:31,  5.62it/s][A
Iteration:  34%|███▎      | 90/268 [00:22<00:32,  5.52it/s][A
Iteration:  34%|███▍      | 91/268 [00:22<00:31,  5.61it/s][A
Iteration:  34%|███▍      | 92/268 [00:23<00:31,  5.53it/s][A
Iteration:  35%|███▍      | 93/268 [00:23<00:31,  5.60it/s][A
Iteration:  35%|███▌      | 94/268 [00:23<00:31,  5.59it/s][A
Iteration:  35%|███▌      | 95/268 [00:23<00:29,  5.78it/s][A
Iteration:  36%|███▌      | 96/268 [00:23<00:29,  5.84it/s][A
Iteration:  36%|███▌      | 97/268 [00:23<00:29,  5.86it/s][A
Iteration:  37%|███▋      | 98/268 [00:24<00:30,  5.62it/s][A
Iteration:  37%|███▋      | 99/268 [00:24<00:29,  5.64it/s][A
Iteration:  37%|███▋      | 100/268 [00:24<00:29,  5.69it/s][A
Iteration:  38%|███▊      | 101/268 [00:24<00:29,  5.71it/s][A
Iteration:  38%|███▊      | 102/268 [00:24<00:28,  5.74it/s][A
Iteration:  38%|███▊      | 103/268 [00:25<00:29,  5.59it/s][A
Iteration:  39%|███▉      | 104/268 [00:25<00:30,  5.42it/s][A
Iteration:  39%|███▉      | 105/268 [00:25<00:29,  5.49it/s][A
Iteration:  40%|███▉      | 106/268 [00:25<00:28,  5.61it/s][A
Iteration:  40%|███▉      | 107/268 [00:25<00:28,  5.66it/s][A
Iteration:  40%|████      | 108/268 [00:25<00:28,  5.66it/s][A
Iteration:  41%|████      | 109/268 [00:26<00:27,  5.74it/s][A
Iteration:  41%|████      | 110/268 [00:26<00:26,  5.91it/s][A
Iteration:  41%|████▏     | 111/268 [00:26<00:26,  5.88it/s][A
Iteration:  42%|████▏     | 112/268 [00:26<00:26,  5.97it/s][A
Iteration:  42%|████▏     | 113/268 [00:26<00:26,  5.91it/s][A
Iteration:  43%|████▎     | 114/268 [00:26<00:26,  5.87it/s][A
Iteration:  43%|████▎     | 115/268 [00:27<00:26,  5.73it/s][A
Iteration:  43%|████▎     | 116/268 [00:27<00:26,  5.68it/s][A
Iteration:  44%|████▎     | 117/268 [00:27<00:26,  5.64it/s][A[INFO|trainer.py:570] 2024-04-30 10:41:27,488 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:41:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:41:27 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:41:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:41:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.16it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.19it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.19it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.19it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.19it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.19it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.18it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.30it/s]04/30/2024 10:41:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:41:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.67583746, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [250, 270, 360, 358, 571, 422, 258, 220, 174, 148, 147, 159], 'head_nums': [1, 2, 3, 2, 3, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 82707344, 'remaining_params': 2310256, 'pruned_model_sparsity': 0.9728261442336645, 'expected_sparsity': 0.97297, 'target_sparsity': 0.95, 'step': 6550}


Iteration:  44%|████▍     | 118/268 [00:30<02:53,  1.16s/it][A
Iteration:  44%|████▍     | 119/268 [00:31<02:08,  1.16it/s][A
Iteration:  45%|████▍     | 120/268 [00:31<01:37,  1.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:31<01:15,  1.95it/s][A
Iteration:  46%|████▌     | 122/268 [00:31<01:02,  2.34it/s][A
Iteration:  46%|████▌     | 123/268 [00:31<00:50,  2.86it/s][A
Iteration:  46%|████▋     | 124/268 [00:32<00:43,  3.30it/s][A
Iteration:  47%|████▋     | 125/268 [00:32<00:37,  3.77it/s][A
Iteration:  47%|████▋     | 126/268 [00:32<00:33,  4.23it/s][A
Iteration:  47%|████▋     | 127/268 [00:32<00:29,  4.72it/s][A
Iteration:  48%|████▊     | 128/268 [00:32<00:29,  4.75it/s][A
Iteration:  48%|████▊     | 129/268 [00:32<00:28,  4.94it/s][A
Iteration:  49%|████▊     | 130/268 [00:33<00:27,  5.08it/s][A
Iteration:  49%|████▉     | 131/268 [00:33<00:25,  5.29it/s][A
Iteration:  49%|████▉     | 132/268 [00:33<00:25,  5.39it/s][A
Iteration:  50%|████▉     | 133/268 [00:33<00:24,  5.44it/s][A
Iteration:  50%|█████     | 134/268 [00:33<00:23,  5.62it/s][A
Iteration:  50%|█████     | 135/268 [00:33<00:23,  5.64it/s][A
Iteration:  51%|█████     | 136/268 [00:34<00:23,  5.65it/s][A
Iteration:  51%|█████     | 137/268 [00:34<00:22,  5.71it/s][A
Iteration:  51%|█████▏    | 138/268 [00:34<00:22,  5.66it/s][A
Iteration:  52%|█████▏    | 139/268 [00:34<00:22,  5.77it/s][A
Iteration:  52%|█████▏    | 140/268 [00:34<00:22,  5.70it/s][A
Iteration:  53%|█████▎    | 141/268 [00:35<00:22,  5.65it/s][A
Iteration:  53%|█████▎    | 142/268 [00:35<00:22,  5.68it/s][A
Iteration:  53%|█████▎    | 143/268 [00:35<00:22,  5.68it/s][A
Iteration:  54%|█████▎    | 144/268 [00:35<00:22,  5.59it/s][A
Iteration:  54%|█████▍    | 145/268 [00:35<00:22,  5.56it/s][A
Iteration:  54%|█████▍    | 146/268 [00:35<00:21,  5.67it/s][A
Iteration:  55%|█████▍    | 147/268 [00:36<00:21,  5.70it/s][A
Iteration:  55%|█████▌    | 148/268 [00:36<00:21,  5.66it/s][A
Iteration:  56%|█████▌    | 149/268 [00:36<00:20,  5.73it/s][A
Iteration:  56%|█████▌    | 150/268 [00:36<00:21,  5.60it/s][A
Iteration:  56%|█████▋    | 151/268 [00:36<00:21,  5.55it/s][A
Iteration:  57%|█████▋    | 152/268 [00:37<00:20,  5.61it/s][A
Iteration:  57%|█████▋    | 153/268 [00:37<00:20,  5.63it/s][A
Iteration:  57%|█████▋    | 154/268 [00:37<00:19,  5.75it/s][A
Iteration:  58%|█████▊    | 155/268 [00:37<00:19,  5.81it/s][A
Iteration:  58%|█████▊    | 156/268 [00:37<00:19,  5.86it/s][A
Iteration:  59%|█████▊    | 157/268 [00:37<00:19,  5.76it/s][A
Iteration:  59%|█████▉    | 158/268 [00:38<00:19,  5.68it/s][A
Iteration:  59%|█████▉    | 159/268 [00:38<00:19,  5.65it/s][A
Iteration:  60%|█████▉    | 160/268 [00:38<00:19,  5.62it/s][A
Iteration:  60%|██████    | 161/268 [00:38<00:20,  5.32it/s][A
Iteration:  60%|██████    | 162/268 [00:38<00:19,  5.44it/s][A
Iteration:  61%|██████    | 163/268 [00:38<00:19,  5.42it/s][A
Iteration:  61%|██████    | 164/268 [00:39<00:18,  5.49it/s][A
Iteration:  62%|██████▏   | 165/268 [00:39<00:18,  5.62it/s][A
Iteration:  62%|██████▏   | 166/268 [00:39<00:18,  5.45it/s][A
Iteration:  62%|██████▏   | 167/268 [00:39<00:18,  5.46it/s][A[INFO|trainer.py:570] 2024-04-30 10:41:39,688 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:41:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:41:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:41:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:41:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.16it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.19it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.19it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.19it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.18it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.30it/s]04/30/2024 10:41:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:41:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.65980047, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [248, 267, 359, 358, 568, 422, 258, 218, 174, 147, 147, 159], 'head_nums': [1, 2, 3, 2, 3, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 82718068, 'remaining_params': 2299532, 'pruned_model_sparsity': 0.9729522828214393, 'expected_sparsity': 0.97344, 'target_sparsity': 0.95, 'step': 6600}


Iteration:  63%|██████▎   | 168/268 [00:43<01:55,  1.16s/it][A04/30/2024 10:41:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 6600, Alignment: tensor([0, 0, 0, 1], device='cuda:0')

Iteration:  63%|██████▎   | 169/268 [00:43<01:25,  1.16it/s][A
Iteration:  63%|██████▎   | 170/268 [00:43<01:04,  1.51it/s][A
Iteration:  64%|██████▍   | 171/268 [00:43<00:49,  1.96it/s][A
Iteration:  64%|██████▍   | 172/268 [00:43<00:39,  2.45it/s][A
Iteration:  65%|██████▍   | 173/268 [00:43<00:31,  2.97it/s][A
Iteration:  65%|██████▍   | 174/268 [00:44<00:26,  3.50it/s][A
Iteration:  65%|██████▌   | 175/268 [00:44<00:23,  3.91it/s][A
Iteration:  66%|██████▌   | 176/268 [00:44<00:21,  4.23it/s][A
Iteration:  66%|██████▌   | 177/268 [00:44<00:20,  4.53it/s][A
Iteration:  66%|██████▋   | 178/268 [00:44<00:18,  4.80it/s][A
Iteration:  67%|██████▋   | 179/268 [00:45<00:17,  5.03it/s][A
Iteration:  67%|██████▋   | 180/268 [00:45<00:16,  5.28it/s][A
Iteration:  68%|██████▊   | 181/268 [00:45<00:16,  5.28it/s][A
Iteration:  68%|██████▊   | 182/268 [00:45<00:15,  5.41it/s][A
Iteration:  68%|██████▊   | 183/268 [00:45<00:15,  5.44it/s][A
Iteration:  69%|██████▊   | 184/268 [00:45<00:15,  5.55it/s][A
Iteration:  69%|██████▉   | 185/268 [00:46<00:14,  5.58it/s][A
Iteration:  69%|██████▉   | 186/268 [00:46<00:14,  5.56it/s][A
Iteration:  70%|██████▉   | 187/268 [00:46<00:14,  5.50it/s][A
Iteration:  70%|███████   | 188/268 [00:46<00:14,  5.41it/s][A
Iteration:  71%|███████   | 189/268 [00:46<00:14,  5.63it/s][A
Iteration:  71%|███████   | 190/268 [00:47<00:13,  5.78it/s][A
Iteration:  71%|███████▏  | 191/268 [00:47<00:13,  5.78it/s][A
Iteration:  72%|███████▏  | 192/268 [00:47<00:13,  5.82it/s][A
Iteration:  72%|███████▏  | 193/268 [00:47<00:12,  5.84it/s][A
Iteration:  72%|███████▏  | 194/268 [00:47<00:12,  5.86it/s][A
Iteration:  73%|███████▎  | 195/268 [00:47<00:12,  5.71it/s][A
Iteration:  73%|███████▎  | 196/268 [00:48<00:12,  5.84it/s][A
Iteration:  74%|███████▎  | 197/268 [00:48<00:11,  5.94it/s][A
Iteration:  74%|███████▍  | 198/268 [00:48<00:11,  6.00it/s][A
Iteration:  74%|███████▍  | 199/268 [00:48<00:12,  5.73it/s][A
Iteration:  75%|███████▍  | 200/268 [00:48<00:11,  5.78it/s][A
Iteration:  75%|███████▌  | 201/268 [00:48<00:11,  5.82it/s][A
Iteration:  75%|███████▌  | 202/268 [00:49<00:11,  5.71it/s][A
Iteration:  76%|███████▌  | 203/268 [00:49<00:11,  5.78it/s][A
Iteration:  76%|███████▌  | 204/268 [00:49<00:11,  5.64it/s][A
Iteration:  76%|███████▋  | 205/268 [00:49<00:11,  5.62it/s][A
Iteration:  77%|███████▋  | 206/268 [00:49<00:10,  5.70it/s][A
Iteration:  77%|███████▋  | 207/268 [00:49<00:10,  5.60it/s][A
Iteration:  78%|███████▊  | 208/268 [00:50<00:10,  5.57it/s][A
Iteration:  78%|███████▊  | 209/268 [00:50<00:10,  5.64it/s][A
Iteration:  78%|███████▊  | 210/268 [00:50<00:10,  5.47it/s][A
Iteration:  79%|███████▊  | 211/268 [00:50<00:10,  5.61it/s][A
Iteration:  79%|███████▉  | 212/268 [00:50<00:09,  5.66it/s][A
Iteration:  79%|███████▉  | 213/268 [00:51<00:09,  5.62it/s][A
Iteration:  80%|███████▉  | 214/268 [00:51<00:09,  5.71it/s][A
Iteration:  80%|████████  | 215/268 [00:51<00:09,  5.61it/s][A
Iteration:  81%|████████  | 216/268 [00:51<00:09,  5.65it/s][A
Iteration:  81%|████████  | 217/268 [00:51<00:08,  5.68it/s][A[INFO|trainer.py:570] 2024-04-30 10:41:51,740 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:41:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:41:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:41:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:41:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.16it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.19it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.19it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.18it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.19it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.18it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.30it/s]04/30/2024 10:41:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:41:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.66505355, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [245, 264, 359, 357, 565, 421, 258, 217, 174, 147, 147, 159], 'head_nums': [1, 2, 3, 2, 3, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 82728792, 'remaining_params': 2288808, 'pruned_model_sparsity': 0.9730784214092141, 'expected_sparsity': 0.97366, 'target_sparsity': 0.95, 'step': 6650}


Iteration:  81%|████████▏ | 218/268 [00:55<00:57,  1.15s/it][A
Iteration:  82%|████████▏ | 219/268 [00:55<00:42,  1.17it/s][A
Iteration:  82%|████████▏ | 220/268 [00:55<00:31,  1.53it/s][A
Iteration:  82%|████████▏ | 221/268 [00:55<00:24,  1.94it/s][A
Iteration:  83%|████████▎ | 222/268 [00:55<00:18,  2.42it/s][A
Iteration:  83%|████████▎ | 223/268 [00:56<00:15,  2.94it/s][A
Iteration:  84%|████████▎ | 224/268 [00:56<00:12,  3.50it/s][A
Iteration:  84%|████████▍ | 225/268 [00:56<00:10,  3.98it/s][A
Iteration:  84%|████████▍ | 226/268 [00:56<00:10,  4.17it/s][A
Iteration:  85%|████████▍ | 227/268 [00:56<00:09,  4.51it/s][A
Iteration:  85%|████████▌ | 228/268 [00:56<00:08,  4.71it/s][A
Iteration:  85%|████████▌ | 229/268 [00:57<00:07,  5.00it/s][A
Iteration:  86%|████████▌ | 230/268 [00:57<00:07,  5.15it/s][A
Iteration:  86%|████████▌ | 231/268 [00:57<00:07,  5.17it/s][A
Iteration:  87%|████████▋ | 232/268 [00:57<00:06,  5.37it/s][A
Iteration:  87%|████████▋ | 233/268 [00:57<00:06,  5.58it/s][A
Iteration:  87%|████████▋ | 234/268 [00:58<00:06,  5.66it/s][A
Iteration:  88%|████████▊ | 235/268 [00:58<00:06,  5.46it/s][A
Iteration:  88%|████████▊ | 236/268 [00:58<00:05,  5.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:58<00:05,  5.47it/s][A
Iteration:  89%|████████▉ | 238/268 [00:58<00:05,  5.53it/s][A
Iteration:  89%|████████▉ | 239/268 [00:58<00:05,  5.54it/s][A
Iteration:  90%|████████▉ | 240/268 [00:59<00:05,  5.44it/s][A
Iteration:  90%|████████▉ | 241/268 [00:59<00:04,  5.52it/s][A
Iteration:  90%|█████████ | 242/268 [00:59<00:04,  5.50it/s][A
Iteration:  91%|█████████ | 243/268 [00:59<00:04,  5.41it/s][A
Iteration:  91%|█████████ | 244/268 [00:59<00:04,  5.47it/s][A
Iteration:  91%|█████████▏| 245/268 [01:00<00:04,  5.56it/s][A
Iteration:  92%|█████████▏| 246/268 [01:00<00:03,  5.55it/s][A
Iteration:  92%|█████████▏| 247/268 [01:00<00:03,  5.43it/s][A
Iteration:  93%|█████████▎| 248/268 [01:00<00:03,  5.39it/s][A
Iteration:  93%|█████████▎| 249/268 [01:00<00:03,  5.35it/s][A
Iteration:  93%|█████████▎| 250/268 [01:00<00:03,  5.48it/s][A
Iteration:  94%|█████████▎| 251/268 [01:01<00:03,  5.48it/s][A
Iteration:  94%|█████████▍| 252/268 [01:01<00:02,  5.58it/s][A
Iteration:  94%|█████████▍| 253/268 [01:01<00:02,  5.57it/s][A
Iteration:  95%|█████████▍| 254/268 [01:01<00:02,  5.66it/s][A
Iteration:  95%|█████████▌| 255/268 [01:01<00:02,  5.73it/s][A
Iteration:  96%|█████████▌| 256/268 [01:02<00:02,  5.50it/s][A
Iteration:  96%|█████████▌| 257/268 [01:02<00:01,  5.60it/s][A
Iteration:  96%|█████████▋| 258/268 [01:02<00:01,  5.69it/s][A
Iteration:  97%|█████████▋| 259/268 [01:02<00:01,  5.65it/s][A
Iteration:  97%|█████████▋| 260/268 [01:02<00:01,  5.71it/s][A
Iteration:  97%|█████████▋| 261/268 [01:02<00:01,  5.59it/s][A
Iteration:  98%|█████████▊| 262/268 [01:03<00:01,  5.70it/s][A
Iteration:  98%|█████████▊| 263/268 [01:03<00:00,  5.72it/s][A
Iteration:  99%|█████████▊| 264/268 [01:03<00:00,  5.72it/s][A
Iteration:  99%|█████████▉| 265/268 [01:03<00:00,  5.78it/s][A
Iteration:  99%|█████████▉| 266/268 [01:03<00:00,  5.82it/s][A
Iteration: 100%|█████████▉| 267/268 [01:03<00:00,  5.85it/s][A[INFO|trainer.py:570] 2024-04-30 10:42:03,888 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:42:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:42:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:42:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:42:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.16it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.17it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.18it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.18it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.18it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.29it/s]04/30/2024 10:42:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:42:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6523107, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [242, 260, 359, 357, 563, 420, 258, 215, 174, 147, 147, 158], 'head_nums': [1, 2, 3, 2, 2, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 82742580, 'remaining_params': 2275020, 'pruned_model_sparsity': 0.973240599593496, 'expected_sparsity': 0.97394, 'target_sparsity': 0.95, 'step': 6700}


Iteration: 100%|██████████| 268/268 [01:07<00:00,  1.14s/it][A04/30/2024 10:42:07 - INFO - trainer.trainer_mod_2 - Epoch 24 finished. Took 67.33 seconds.
Iteration: 100%|██████████| 268/268 [01:07<00:00,  3.98it/s]
Epoch:  25%|██▌       | 25/100 [29:13<1:25:15, 68.21s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A04/30/2024 10:42:07 - INFO - trainer.trainer_mod_2 - v4 Global step: 6700, Alignment: tensor([0, 0, 0, 1], device='cuda:0')

Iteration:   0%|          | 1/268 [00:00<00:48,  5.54it/s][A
Iteration:   1%|          | 2/268 [00:00<00:47,  5.62it/s][A
Iteration:   1%|          | 3/268 [00:00<00:46,  5.71it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:45,  5.79it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:47,  5.54it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:46,  5.67it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:44,  5.82it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:47,  5.52it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:44,  5.78it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:45,  5.68it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:44,  5.71it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:44,  5.81it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:43,  5.87it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:43,  5.85it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:43,  5.80it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:44,  5.71it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:43,  5.75it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:43,  5.70it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:43,  5.71it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:45,  5.40it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:46,  5.34it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:45,  5.38it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:45,  5.42it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:44,  5.42it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:43,  5.56it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:43,  5.61it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:42,  5.68it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:41,  5.75it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:41,  5.70it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:42,  5.66it/s][A
Iteration:  12%|█▏        | 31/268 [00:05<00:42,  5.61it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:41,  5.67it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:41,  5.65it/s][A
Iteration:  13%|█▎        | 34/268 [00:06<00:41,  5.68it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:40,  5.69it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:41,  5.60it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:41,  5.57it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:41,  5.50it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:40,  5.69it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:40,  5.70it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:41,  5.51it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:41,  5.44it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:40,  5.58it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:39,  5.66it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:38,  5.74it/s][A
Iteration:  17%|█▋        | 46/268 [00:08<00:38,  5.73it/s][A
Iteration:  18%|█▊        | 47/268 [00:08<00:37,  5.82it/s][A
Iteration:  18%|█▊        | 48/268 [00:08<00:37,  5.85it/s][A
Iteration:  18%|█▊        | 49/268 [00:08<00:38,  5.71it/s][A[INFO|trainer.py:570] 2024-04-30 10:42:15,987 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:42:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:42:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:42:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:42:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.16it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.04it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.11it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.14it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.16it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.17it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.18it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.18it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.18it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.18it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.28it/s]04/30/2024 10:42:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:42:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6851789, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [239, 257, 358, 356, 560, 419, 257, 213, 174, 147, 147, 158], 'head_nums': [1, 2, 3, 2, 2, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 82754836, 'remaining_params': 2262764, 'pruned_model_sparsity': 0.9733847579795243, 'expected_sparsity': 0.97454, 'target_sparsity': 0.95, 'step': 6750}


Iteration:  19%|█▊        | 50/268 [00:12<04:11,  1.15s/it][A
Iteration:  19%|█▉        | 51/268 [00:12<03:06,  1.17it/s][A
Iteration:  19%|█▉        | 52/268 [00:12<02:21,  1.53it/s][A
Iteration:  20%|█▉        | 53/268 [00:12<01:49,  1.97it/s][A
Iteration:  20%|██        | 54/268 [00:12<01:27,  2.45it/s][A
Iteration:  21%|██        | 55/268 [00:12<01:11,  2.99it/s][A
Iteration:  21%|██        | 56/268 [00:13<01:01,  3.47it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<00:54,  3.89it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:48,  4.34it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:44,  4.66it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:43,  4.79it/s][A
Iteration:  23%|██▎       | 61/268 [00:14<00:41,  4.93it/s][A
Iteration:  23%|██▎       | 62/268 [00:14<00:39,  5.16it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:38,  5.36it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:37,  5.45it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:38,  5.30it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:36,  5.48it/s][A
Iteration:  25%|██▌       | 67/268 [00:15<00:36,  5.55it/s][A
Iteration:  25%|██▌       | 68/268 [00:15<00:36,  5.49it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:36,  5.42it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:35,  5.53it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:35,  5.58it/s][A
Iteration:  27%|██▋       | 72/268 [00:16<00:34,  5.66it/s][A
Iteration:  27%|██▋       | 73/268 [00:16<00:34,  5.73it/s][A
Iteration:  28%|██▊       | 74/268 [00:16<00:34,  5.56it/s][A
Iteration:  28%|██▊       | 75/268 [00:16<00:34,  5.58it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:34,  5.63it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:33,  5.63it/s][A
Iteration:  29%|██▉       | 78/268 [00:17<00:34,  5.50it/s][A
Iteration:  29%|██▉       | 79/268 [00:17<00:33,  5.58it/s][A
Iteration:  30%|██▉       | 80/268 [00:17<00:33,  5.69it/s][A
Iteration:  30%|███       | 81/268 [00:17<00:32,  5.73it/s][A
Iteration:  31%|███       | 82/268 [00:17<00:31,  5.87it/s][A
Iteration:  31%|███       | 83/268 [00:17<00:31,  5.87it/s][A
Iteration:  31%|███▏      | 84/268 [00:18<00:32,  5.72it/s][A
Iteration:  32%|███▏      | 85/268 [00:18<00:31,  5.79it/s][A
Iteration:  32%|███▏      | 86/268 [00:18<00:32,  5.64it/s][A
Iteration:  32%|███▏      | 87/268 [00:18<00:31,  5.73it/s][A
Iteration:  33%|███▎      | 88/268 [00:18<00:32,  5.53it/s][A
Iteration:  33%|███▎      | 89/268 [00:18<00:31,  5.77it/s][A
Iteration:  34%|███▎      | 90/268 [00:19<00:31,  5.69it/s][A
Iteration:  34%|███▍      | 91/268 [00:19<00:30,  5.78it/s][A
Iteration:  34%|███▍      | 92/268 [00:19<00:31,  5.59it/s][A
Iteration:  35%|███▍      | 93/268 [00:19<00:30,  5.76it/s][A
Iteration:  35%|███▌      | 94/268 [00:19<00:30,  5.78it/s][A
Iteration:  35%|███▌      | 95/268 [00:20<00:29,  5.83it/s][A
Iteration:  36%|███▌      | 96/268 [00:20<00:29,  5.76it/s][A
Iteration:  36%|███▌      | 97/268 [00:20<00:30,  5.69it/s][A
Iteration:  37%|███▋      | 98/268 [00:20<00:29,  5.77it/s][A
Iteration:  37%|███▋      | 99/268 [00:20<00:29,  5.65it/s][A[INFO|trainer.py:570] 2024-04-30 10:42:28,089 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:42:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:42:28 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:42:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:42:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.20it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.21it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.22it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.22it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.22it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.22it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.22it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.22it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.22it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.22it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.22it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.21it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.21it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.33it/s]04/30/2024 10:42:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:42:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.7100451, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [237, 254, 358, 355, 557, 418, 257, 212, 174, 147, 147, 157], 'head_nums': [1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 82960124, 'remaining_params': 2057476, 'pruned_model_sparsity': 0.9757994109454984, 'expected_sparsity': 0.97558, 'target_sparsity': 0.95, 'step': 6800}


Iteration:  37%|███▋      | 100/268 [00:24<03:14,  1.16s/it][A04/30/2024 10:42:31 - INFO - trainer.trainer_mod_2 - v4 Global step: 6800, Alignment: tensor([1, 1, 1, 1], device='cuda:0')

Iteration:  38%|███▊      | 101/268 [00:24<02:23,  1.16it/s][A
Iteration:  38%|███▊      | 102/268 [00:24<01:48,  1.53it/s][A
Iteration:  38%|███▊      | 103/268 [00:24<01:23,  1.97it/s][A
Iteration:  39%|███▉      | 104/268 [00:24<01:06,  2.45it/s][A
Iteration:  39%|███▉      | 105/268 [00:25<00:54,  2.97it/s][A
Iteration:  40%|███▉      | 106/268 [00:25<00:46,  3.51it/s][A
Iteration:  40%|███▉      | 107/268 [00:25<00:40,  3.97it/s][A
Iteration:  40%|████      | 108/268 [00:25<00:35,  4.45it/s][A
Iteration:  41%|████      | 109/268 [00:25<00:33,  4.76it/s][A
Iteration:  41%|████      | 110/268 [00:25<00:31,  5.07it/s][A
Iteration:  41%|████▏     | 111/268 [00:26<00:29,  5.26it/s][A
Iteration:  42%|████▏     | 112/268 [00:26<00:29,  5.37it/s][A
Iteration:  42%|████▏     | 113/268 [00:26<00:28,  5.39it/s][A
Iteration:  43%|████▎     | 114/268 [00:26<00:28,  5.44it/s][A
Iteration:  43%|████▎     | 115/268 [00:26<00:27,  5.48it/s][A
Iteration:  43%|████▎     | 116/268 [00:26<00:27,  5.58it/s][A
Iteration:  44%|████▎     | 117/268 [00:27<00:26,  5.65it/s][A
Iteration:  44%|████▍     | 118/268 [00:27<00:25,  5.84it/s][A
Iteration:  44%|████▍     | 119/268 [00:27<00:25,  5.76it/s][A
Iteration:  45%|████▍     | 120/268 [00:27<00:25,  5.80it/s][A
Iteration:  45%|████▌     | 121/268 [00:27<00:25,  5.78it/s][A
Iteration:  46%|████▌     | 122/268 [00:27<00:24,  5.96it/s][A
Iteration:  46%|████▌     | 123/268 [00:28<00:25,  5.63it/s][A
Iteration:  46%|████▋     | 124/268 [00:28<00:25,  5.69it/s][A
Iteration:  47%|████▋     | 125/268 [00:28<00:25,  5.61it/s][A
Iteration:  47%|████▋     | 126/268 [00:28<00:25,  5.65it/s][A
Iteration:  47%|████▋     | 127/268 [00:28<00:24,  5.66it/s][A
Iteration:  48%|████▊     | 128/268 [00:29<00:24,  5.74it/s][A
Iteration:  48%|████▊     | 129/268 [00:29<00:24,  5.61it/s][A
Iteration:  49%|████▊     | 130/268 [00:29<00:24,  5.61it/s][A
Iteration:  49%|████▉     | 131/268 [00:29<00:24,  5.63it/s][A
Iteration:  49%|████▉     | 132/268 [00:29<00:23,  5.68it/s][A
Iteration:  50%|████▉     | 133/268 [00:29<00:23,  5.71it/s][A
Iteration:  50%|█████     | 134/268 [00:30<00:23,  5.78it/s][A
Iteration:  50%|█████     | 135/268 [00:30<00:23,  5.75it/s][A
Iteration:  51%|█████     | 136/268 [00:30<00:23,  5.59it/s][A
Iteration:  51%|█████     | 137/268 [00:30<00:23,  5.50it/s][A
Iteration:  51%|█████▏    | 138/268 [00:30<00:23,  5.60it/s][A
Iteration:  52%|█████▏    | 139/268 [00:30<00:22,  5.70it/s][A
Iteration:  52%|█████▏    | 140/268 [00:31<00:22,  5.77it/s][A
Iteration:  53%|█████▎    | 141/268 [00:31<00:21,  5.88it/s][A
Iteration:  53%|█████▎    | 142/268 [00:31<00:21,  5.90it/s][A
Iteration:  53%|█████▎    | 143/268 [00:31<00:21,  5.74it/s][A
Iteration:  54%|█████▎    | 144/268 [00:31<00:21,  5.87it/s][A
Iteration:  54%|█████▍    | 145/268 [00:31<00:20,  5.88it/s][A
Iteration:  54%|█████▍    | 146/268 [00:32<00:21,  5.59it/s][A
Iteration:  55%|█████▍    | 147/268 [00:32<00:21,  5.69it/s][A
Iteration:  55%|█████▌    | 148/268 [00:32<00:20,  5.78it/s][A
Iteration:  56%|█████▌    | 149/268 [00:32<00:21,  5.66it/s][A[INFO|trainer.py:570] 2024-04-30 10:42:40,041 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:42:40 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:42:40 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:42:40 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:42:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.19it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.21it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.22it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.22it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.22it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.22it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.22it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.22it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.22it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.22it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.22it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.22it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.21it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.21it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.21it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.22it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.33it/s]04/30/2024 10:42:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:42:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.65102863, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [235, 251, 357, 355, 554, 417, 257, 210, 174, 147, 147, 157], 'head_nums': [1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 1], 'pruned_params': 82970848, 'remaining_params': 2046752, 'pruned_model_sparsity': 0.9759255495332732, 'expected_sparsity': 0.97756, 'target_sparsity': 0.95, 'step': 6850}


Iteration:  56%|█████▌    | 150/268 [00:36<02:15,  1.15s/it][A
Iteration:  56%|█████▋    | 151/268 [00:36<01:40,  1.17it/s][A
Iteration:  57%|█████▋    | 152/268 [00:36<01:15,  1.54it/s][A
Iteration:  57%|█████▋    | 153/268 [00:36<00:58,  1.96it/s][A
Iteration:  57%|█████▋    | 154/268 [00:36<00:46,  2.43it/s][A
Iteration:  58%|█████▊    | 155/268 [00:37<00:38,  2.95it/s][A
Iteration:  58%|█████▊    | 156/268 [00:37<00:32,  3.44it/s][A
Iteration:  59%|█████▊    | 157/268 [00:37<00:28,  3.90it/s][A
Iteration:  59%|█████▉    | 158/268 [00:37<00:25,  4.28it/s][A
Iteration:  59%|█████▉    | 159/268 [00:37<00:22,  4.77it/s][A
Iteration:  60%|█████▉    | 160/268 [00:37<00:21,  5.05it/s][A
Iteration:  60%|██████    | 161/268 [00:38<00:20,  5.12it/s][A
Iteration:  60%|██████    | 162/268 [00:38<00:20,  5.14it/s][A
Iteration:  61%|██████    | 163/268 [00:38<00:20,  5.20it/s][A
Iteration:  61%|██████    | 164/268 [00:38<00:19,  5.40it/s][A
Iteration:  62%|██████▏   | 165/268 [00:38<00:18,  5.55it/s][A
Iteration:  62%|██████▏   | 166/268 [00:38<00:18,  5.62it/s][A
Iteration:  62%|██████▏   | 167/268 [00:39<00:17,  5.69it/s][A
Iteration:  63%|██████▎   | 168/268 [00:39<00:17,  5.69it/s][A
Iteration:  63%|██████▎   | 169/268 [00:39<00:17,  5.63it/s][A
Iteration:  63%|██████▎   | 170/268 [00:39<00:17,  5.71it/s][A
Iteration:  64%|██████▍   | 171/268 [00:39<00:17,  5.59it/s][A
Iteration:  64%|██████▍   | 172/268 [00:40<00:17,  5.62it/s][A
Iteration:  65%|██████▍   | 173/268 [00:40<00:16,  5.65it/s][A
Iteration:  65%|██████▍   | 174/268 [00:40<00:16,  5.72it/s][A
Iteration:  65%|██████▌   | 175/268 [00:40<00:16,  5.59it/s][A
Iteration:  66%|██████▌   | 176/268 [00:40<00:16,  5.61it/s][A
Iteration:  66%|██████▌   | 177/268 [00:40<00:16,  5.59it/s][A
Iteration:  66%|██████▋   | 178/268 [00:41<00:16,  5.58it/s][A
Iteration:  67%|██████▋   | 179/268 [00:41<00:16,  5.46it/s][A
Iteration:  67%|██████▋   | 180/268 [00:41<00:16,  5.42it/s][A
Iteration:  68%|██████▊   | 181/268 [00:41<00:15,  5.45it/s][A
Iteration:  68%|██████▊   | 182/268 [00:41<00:15,  5.50it/s][A
Iteration:  68%|██████▊   | 183/268 [00:41<00:15,  5.61it/s][A
Iteration:  69%|██████▊   | 184/268 [00:42<00:15,  5.49it/s][A
Iteration:  69%|██████▉   | 185/268 [00:42<00:15,  5.48it/s][A
Iteration:  69%|██████▉   | 186/268 [00:42<00:14,  5.61it/s][A
Iteration:  70%|██████▉   | 187/268 [00:42<00:14,  5.54it/s][A
Iteration:  70%|███████   | 188/268 [00:42<00:14,  5.57it/s][A
Iteration:  71%|███████   | 189/268 [00:43<00:13,  5.78it/s][A
Iteration:  71%|███████   | 190/268 [00:43<00:14,  5.56it/s][A
Iteration:  71%|███████▏  | 191/268 [00:43<00:13,  5.64it/s][A
Iteration:  72%|███████▏  | 192/268 [00:43<00:13,  5.73it/s][A
Iteration:  72%|███████▏  | 193/268 [00:43<00:12,  5.82it/s][A
Iteration:  72%|███████▏  | 194/268 [00:43<00:12,  5.71it/s][A
Iteration:  73%|███████▎  | 195/268 [00:44<00:13,  5.33it/s][A
Iteration:  73%|███████▎  | 196/268 [00:44<00:13,  5.44it/s][A
Iteration:  74%|███████▎  | 197/268 [00:44<00:12,  5.55it/s][A
Iteration:  74%|███████▍  | 198/268 [00:44<00:12,  5.64it/s][A
Iteration:  74%|███████▍  | 199/268 [00:44<00:12,  5.46it/s][A[INFO|trainer.py:570] 2024-04-30 10:42:52,195 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:42:52 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:42:52 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:42:52 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:42:52 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.27it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.28it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.29it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.41it/s]04/30/2024 10:42:55 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:42:55 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6578459, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [233, 249, 357, 354, 552, 416, 257, 209, 174, 147, 147, 156], 'head_nums': [1, 2, 2, 2, 2, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83690888, 'remaining_params': 1326712, 'pruned_model_sparsity': 0.984394854712436, 'expected_sparsity': 0.98096, 'target_sparsity': 0.95, 'step': 6900}


Iteration:  75%|███████▍  | 200/268 [00:48<01:18,  1.15s/it][A04/30/2024 10:42:55 - INFO - trainer.trainer_mod_2 - v4 Global step: 6900, Alignment: tensor([0, 0, 0, 0], device='cuda:0')

Iteration:  75%|███████▌  | 201/268 [00:48<00:57,  1.17it/s][A
Iteration:  75%|███████▌  | 202/268 [00:48<00:42,  1.54it/s][A
Iteration:  76%|███████▌  | 203/268 [00:48<00:32,  1.98it/s][A
Iteration:  76%|███████▌  | 204/268 [00:48<00:26,  2.45it/s][A
Iteration:  76%|███████▋  | 205/268 [00:49<00:22,  2.82it/s][A
Iteration:  77%|███████▋  | 206/268 [00:49<00:18,  3.36it/s][A
Iteration:  77%|███████▋  | 207/268 [00:49<00:15,  3.87it/s][A
Iteration:  78%|███████▊  | 208/268 [00:49<00:13,  4.32it/s][A
Iteration:  78%|███████▊  | 209/268 [00:49<00:12,  4.65it/s][A
Iteration:  78%|███████▊  | 210/268 [00:50<00:11,  4.98it/s][A
Iteration:  79%|███████▊  | 211/268 [00:50<00:11,  5.01it/s][A
Iteration:  79%|███████▉  | 212/268 [00:50<00:10,  5.26it/s][A
Iteration:  79%|███████▉  | 213/268 [00:50<00:10,  5.46it/s][A
Iteration:  80%|███████▉  | 214/268 [00:50<00:09,  5.51it/s][A
Iteration:  80%|████████  | 215/268 [00:50<00:09,  5.68it/s][A
Iteration:  81%|████████  | 216/268 [00:51<00:09,  5.72it/s][A
Iteration:  81%|████████  | 217/268 [00:51<00:09,  5.64it/s][A
Iteration:  81%|████████▏ | 218/268 [00:51<00:08,  5.71it/s][A
Iteration:  82%|████████▏ | 219/268 [00:51<00:08,  5.65it/s][A
Iteration:  82%|████████▏ | 220/268 [00:51<00:08,  5.71it/s][A
Iteration:  82%|████████▏ | 221/268 [00:51<00:08,  5.64it/s][A
Iteration:  83%|████████▎ | 222/268 [00:52<00:08,  5.71it/s][A
Iteration:  83%|████████▎ | 223/268 [00:52<00:07,  5.64it/s][A
Iteration:  84%|████████▎ | 224/268 [00:52<00:07,  5.70it/s][A
Iteration:  84%|████████▍ | 225/268 [00:52<00:07,  5.91it/s][A
Iteration:  84%|████████▍ | 226/268 [00:52<00:07,  5.92it/s][A
Iteration:  85%|████████▍ | 227/268 [00:52<00:07,  5.85it/s][A
Iteration:  85%|████████▌ | 228/268 [00:53<00:06,  5.88it/s][A
Iteration:  85%|████████▌ | 229/268 [00:53<00:06,  6.02it/s][A
Iteration:  86%|████████▌ | 230/268 [00:53<00:06,  5.83it/s][A
Iteration:  86%|████████▌ | 231/268 [00:53<00:06,  5.87it/s][A
Iteration:  87%|████████▋ | 232/268 [00:53<00:06,  5.86it/s][A
Iteration:  87%|████████▋ | 233/268 [00:54<00:05,  5.89it/s][A
Iteration:  87%|████████▋ | 234/268 [00:54<00:05,  5.88it/s][A
Iteration:  88%|████████▊ | 235/268 [00:54<00:05,  5.77it/s][A
Iteration:  88%|████████▊ | 236/268 [00:54<00:05,  5.80it/s][A
Iteration:  88%|████████▊ | 237/268 [00:54<00:05,  5.72it/s][A
Iteration:  89%|████████▉ | 238/268 [00:54<00:05,  5.77it/s][A
Iteration:  89%|████████▉ | 239/268 [00:55<00:05,  5.70it/s][A
Iteration:  90%|████████▉ | 240/268 [00:55<00:04,  5.72it/s][A
Iteration:  90%|████████▉ | 241/268 [00:55<00:04,  5.61it/s][A
Iteration:  90%|█████████ | 242/268 [00:55<00:04,  5.69it/s][A
Iteration:  91%|█████████ | 243/268 [00:55<00:04,  5.76it/s][A
Iteration:  91%|█████████ | 244/268 [00:55<00:04,  5.81it/s][A
Iteration:  91%|█████████▏| 245/268 [00:56<00:03,  5.90it/s][A
Iteration:  92%|█████████▏| 246/268 [00:56<00:03,  5.88it/s][A
Iteration:  92%|█████████▏| 247/268 [00:56<00:03,  5.82it/s][A
Iteration:  93%|█████████▎| 248/268 [00:56<00:03,  5.56it/s][A
Iteration:  93%|█████████▎| 249/268 [00:56<00:03,  5.53it/s][A[INFO|trainer.py:570] 2024-04-30 10:43:04,126 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:43:04 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:43:04 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:43:04 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:43:04 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.26it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.28it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.41it/s]04/30/2024 10:43:07 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:43:07 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.7262299, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [231, 247, 356, 354, 549, 415, 257, 208, 173, 147, 147, 156], 'head_nums': [1, 2, 2, 2, 2, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83697016, 'remaining_params': 1320584, 'pruned_model_sparsity': 0.9844669339054501, 'expected_sparsity': 0.98222, 'target_sparsity': 0.95, 'step': 6950}


Iteration:  93%|█████████▎| 250/268 [01:00<00:20,  1.14s/it][A
Iteration:  94%|█████████▎| 251/268 [01:00<00:14,  1.18it/s][A
Iteration:  94%|█████████▍| 252/268 [01:00<00:10,  1.55it/s][A
Iteration:  94%|█████████▍| 253/268 [01:00<00:07,  1.98it/s][A
Iteration:  95%|█████████▍| 254/268 [01:00<00:05,  2.46it/s][A
Iteration:  95%|█████████▌| 255/268 [01:01<00:04,  3.02it/s][A
Iteration:  96%|█████████▌| 256/268 [01:01<00:03,  3.53it/s][A
Iteration:  96%|█████████▌| 257/268 [01:01<00:02,  3.99it/s][A
Iteration:  96%|█████████▋| 258/268 [01:01<00:02,  4.23it/s][A
Iteration:  97%|█████████▋| 259/268 [01:01<00:01,  4.59it/s][A
Iteration:  97%|█████████▋| 260/268 [01:01<00:01,  4.85it/s][A
Iteration:  97%|█████████▋| 261/268 [01:02<00:01,  5.13it/s][A
Iteration:  98%|█████████▊| 262/268 [01:02<00:01,  5.23it/s][A
Iteration:  98%|█████████▊| 263/268 [01:02<00:00,  5.41it/s][A
Iteration:  99%|█████████▊| 264/268 [01:02<00:00,  5.34it/s][A
Iteration:  99%|█████████▉| 265/268 [01:02<00:00,  5.47it/s][A
Iteration:  99%|█████████▉| 266/268 [01:03<00:00,  5.58it/s][A
Iteration: 100%|█████████▉| 267/268 [01:03<00:00,  5.69it/s][A
Iteration: 100%|██████████| 268/268 [01:03<00:00,  6.20it/s][A04/30/2024 10:43:10 - INFO - trainer.trainer_mod_2 - Epoch 25 finished. Took 63.3 seconds.
Iteration: 100%|██████████| 268/268 [01:03<00:00,  4.23it/s]
Epoch:  26%|██▌       | 26/100 [30:16<1:22:18, 66.74s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:45,  5.92it/s][A
Iteration:   1%|          | 2/268 [00:00<00:46,  5.73it/s][A
Iteration:   1%|          | 3/268 [00:00<00:46,  5.68it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:44,  5.87it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:44,  5.87it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:44,  5.84it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:43,  5.95it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:44,  5.91it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:43,  5.98it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:43,  6.00it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:43,  5.86it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:44,  5.72it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:44,  5.77it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:43,  5.83it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:44,  5.67it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:45,  5.56it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:42,  5.84it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:42,  5.91it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:42,  5.83it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:42,  5.89it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:43,  5.70it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:43,  5.70it/s][A
Iteration:   9%|▊         | 23/268 [00:03<00:42,  5.71it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:44,  5.52it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:43,  5.57it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:43,  5.61it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:42,  5.63it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:42,  5.70it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:41,  5.73it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:41,  5.67it/s][A
Iteration:  12%|█▏        | 31/268 [00:05<00:41,  5.75it/s][A[INFO|trainer.py:570] 2024-04-30 10:43:16,012 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:43:16 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:43:16 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:43:16 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:43:16 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.27it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.19it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.24it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.26it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.27it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.28it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.29it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.29it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.29it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.29it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.29it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.40it/s]04/30/2024 10:43:19 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:43:19 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6855985, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [229, 245, 356, 353, 547, 414, 257, 208, 173, 147, 147, 156], 'head_nums': [1, 2, 2, 2, 2, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83703144, 'remaining_params': 1314456, 'pruned_model_sparsity': 0.9845390130984644, 'expected_sparsity': 0.9827, 'target_sparsity': 0.95, 'step': 7000}


Iteration:  12%|█▏        | 32/268 [00:08<04:30,  1.14s/it][A04/30/2024 10:43:19 - INFO - trainer.trainer_mod_2 - v4 Global step: 7000, Alignment: tensor([ 8,  8,  8, 11], device='cuda:0')

Iteration:  12%|█▏        | 33/268 [00:08<03:21,  1.17it/s][A
Iteration:  13%|█▎        | 34/268 [00:09<02:33,  1.52it/s][A
Iteration:  13%|█▎        | 35/268 [00:09<01:59,  1.95it/s][A
Iteration:  13%|█▎        | 36/268 [00:09<01:34,  2.45it/s][A
Iteration:  14%|█▍        | 37/268 [00:09<01:17,  3.00it/s][A
Iteration:  14%|█▍        | 38/268 [00:09<01:07,  3.43it/s][A
Iteration:  15%|█▍        | 39/268 [00:10<00:58,  3.89it/s][A
Iteration:  15%|█▍        | 40/268 [00:10<00:52,  4.34it/s][A
Iteration:  15%|█▌        | 41/268 [00:10<00:48,  4.71it/s][A
Iteration:  16%|█▌        | 42/268 [00:10<00:45,  5.00it/s][A
Iteration:  16%|█▌        | 43/268 [00:10<00:43,  5.12it/s][A
Iteration:  16%|█▋        | 44/268 [00:10<00:43,  5.18it/s][A
Iteration:  17%|█▋        | 45/268 [00:11<00:41,  5.38it/s][A
Iteration:  17%|█▋        | 46/268 [00:11<00:40,  5.43it/s][A
Iteration:  18%|█▊        | 47/268 [00:11<00:41,  5.39it/s][A
Iteration:  18%|█▊        | 48/268 [00:11<00:39,  5.54it/s][A
Iteration:  18%|█▊        | 49/268 [00:11<00:39,  5.59it/s][A
Iteration:  19%|█▊        | 50/268 [00:11<00:38,  5.72it/s][A
Iteration:  19%|█▉        | 51/268 [00:12<00:37,  5.79it/s][A
Iteration:  19%|█▉        | 52/268 [00:12<00:38,  5.62it/s][A
Iteration:  20%|█▉        | 53/268 [00:12<00:38,  5.63it/s][A
Iteration:  20%|██        | 54/268 [00:12<00:37,  5.64it/s][A
Iteration:  21%|██        | 55/268 [00:12<00:37,  5.65it/s][A
Iteration:  21%|██        | 56/268 [00:13<00:36,  5.79it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<00:36,  5.81it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:36,  5.74it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:35,  5.83it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:35,  5.87it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:35,  5.85it/s][A
Iteration:  23%|██▎       | 62/268 [00:14<00:35,  5.81it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:35,  5.83it/s][A
Iteration:  24%|██▍       | 64/268 [00:14<00:34,  5.86it/s][A
Iteration:  24%|██▍       | 65/268 [00:14<00:34,  5.84it/s][A
Iteration:  25%|██▍       | 66/268 [00:14<00:34,  5.88it/s][A
Iteration:  25%|██▌       | 67/268 [00:14<00:34,  5.86it/s][A
Iteration:  25%|██▌       | 68/268 [00:15<00:33,  6.00it/s][A
Iteration:  26%|██▌       | 69/268 [00:15<00:33,  5.98it/s][A
Iteration:  26%|██▌       | 70/268 [00:15<00:33,  5.88it/s][A
Iteration:  26%|██▋       | 71/268 [00:15<00:34,  5.78it/s][A
Iteration:  27%|██▋       | 72/268 [00:15<00:34,  5.71it/s][A
Iteration:  27%|██▋       | 73/268 [00:15<00:33,  5.80it/s][A
Iteration:  28%|██▊       | 74/268 [00:16<00:36,  5.27it/s][A
Iteration:  28%|██▊       | 75/268 [00:16<00:36,  5.26it/s][A
Iteration:  28%|██▊       | 76/268 [00:16<00:36,  5.31it/s][A
Iteration:  29%|██▊       | 77/268 [00:16<00:35,  5.41it/s][A
Iteration:  29%|██▉       | 78/268 [00:16<00:33,  5.63it/s][A
Iteration:  29%|██▉       | 79/268 [00:17<00:34,  5.56it/s][A
Iteration:  30%|██▉       | 80/268 [00:17<00:32,  5.70it/s][A
Iteration:  30%|███       | 81/268 [00:17<00:32,  5.71it/s][A[INFO|trainer.py:570] 2024-04-30 10:43:28,023 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:43:28 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:43:28 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:43:28 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:43:28 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.27it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.29it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.29it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.30it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.30it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.30it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.30it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.29it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.29it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.41it/s]04/30/2024 10:43:31 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:43:31 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.68055946, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [227, 243, 356, 353, 544, 413, 256, 208, 173, 147, 147, 156], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83709272, 'remaining_params': 1308328, 'pruned_model_sparsity': 0.9846110922914785, 'expected_sparsity': 0.98321, 'target_sparsity': 0.95, 'step': 7050}


Iteration:  31%|███       | 82/268 [00:20<03:32,  1.14s/it][A
Iteration:  31%|███       | 83/268 [00:20<02:37,  1.17it/s][A
Iteration:  31%|███▏      | 84/268 [00:21<01:59,  1.54it/s][A
Iteration:  32%|███▏      | 85/268 [00:21<01:33,  1.96it/s][A
Iteration:  32%|███▏      | 86/268 [00:21<01:14,  2.45it/s][A
Iteration:  32%|███▏      | 87/268 [00:21<01:00,  3.00it/s][A
Iteration:  33%|███▎      | 88/268 [00:21<00:52,  3.44it/s][A
Iteration:  33%|███▎      | 89/268 [00:22<00:45,  3.93it/s][A
Iteration:  34%|███▎      | 90/268 [00:22<00:40,  4.38it/s][A
Iteration:  34%|███▍      | 91/268 [00:22<00:39,  4.52it/s][A
Iteration:  34%|███▍      | 92/268 [00:22<00:36,  4.82it/s][A
Iteration:  35%|███▍      | 93/268 [00:22<00:34,  5.11it/s][A
Iteration:  35%|███▌      | 94/268 [00:22<00:33,  5.27it/s][A
Iteration:  35%|███▌      | 95/268 [00:23<00:32,  5.34it/s][A
Iteration:  36%|███▌      | 96/268 [00:23<00:32,  5.34it/s][A
Iteration:  36%|███▌      | 97/268 [00:23<00:31,  5.48it/s][A
Iteration:  37%|███▋      | 98/268 [00:23<00:30,  5.54it/s][A
Iteration:  37%|███▋      | 99/268 [00:23<00:29,  5.77it/s][A
Iteration:  37%|███▋      | 100/268 [00:23<00:29,  5.78it/s][A
Iteration:  38%|███▊      | 101/268 [00:24<00:28,  5.91it/s][A
Iteration:  38%|███▊      | 102/268 [00:24<00:27,  5.93it/s][A
Iteration:  38%|███▊      | 103/268 [00:24<00:28,  5.86it/s][A
Iteration:  39%|███▉      | 104/268 [00:24<00:27,  5.88it/s][A
Iteration:  39%|███▉      | 105/268 [00:24<00:27,  5.85it/s][A
Iteration:  40%|███▉      | 106/268 [00:24<00:28,  5.70it/s][A
Iteration:  40%|███▉      | 107/268 [00:25<00:28,  5.71it/s][A
Iteration:  40%|████      | 108/268 [00:25<00:27,  5.74it/s][A
Iteration:  41%|████      | 109/268 [00:25<00:28,  5.59it/s][A
Iteration:  41%|████      | 110/268 [00:25<00:28,  5.57it/s][A
Iteration:  41%|████▏     | 111/268 [00:25<00:28,  5.55it/s][A
Iteration:  42%|████▏     | 112/268 [00:26<00:27,  5.68it/s][A
Iteration:  42%|████▏     | 113/268 [00:26<00:26,  5.77it/s][A
Iteration:  43%|████▎     | 114/268 [00:26<00:25,  5.93it/s][A
Iteration:  43%|████▎     | 115/268 [00:26<00:26,  5.80it/s][A
Iteration:  43%|████▎     | 116/268 [00:26<00:26,  5.73it/s][A
Iteration:  44%|████▎     | 117/268 [00:26<00:26,  5.71it/s][A
Iteration:  44%|████▍     | 118/268 [00:27<00:25,  5.78it/s][A
Iteration:  44%|████▍     | 119/268 [00:27<00:25,  5.85it/s][A
Iteration:  45%|████▍     | 120/268 [00:27<00:25,  5.74it/s][A
Iteration:  45%|████▌     | 121/268 [00:27<00:25,  5.81it/s][A
Iteration:  46%|████▌     | 122/268 [00:27<00:26,  5.61it/s][A
Iteration:  46%|████▌     | 123/268 [00:27<00:25,  5.64it/s][A
Iteration:  46%|████▋     | 124/268 [00:28<00:25,  5.75it/s][A
Iteration:  47%|████▋     | 125/268 [00:28<00:25,  5.71it/s][A
Iteration:  47%|████▋     | 126/268 [00:28<00:24,  5.85it/s][A
Iteration:  47%|████▋     | 127/268 [00:28<00:24,  5.72it/s][A
Iteration:  48%|████▊     | 128/268 [00:28<00:23,  5.85it/s][A
Iteration:  48%|████▊     | 129/268 [00:28<00:23,  5.84it/s][A
Iteration:  49%|████▊     | 130/268 [00:29<00:23,  5.80it/s][A
Iteration:  49%|████▉     | 131/268 [00:29<00:24,  5.68it/s][A[INFO|trainer.py:570] 2024-04-30 10:43:39,976 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:43:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:43:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:43:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:43:40 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.31it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.45it/s]04/30/2024 10:43:43 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:43:43 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.69493824, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [224, 241, 355, 352, 542, 412, 256, 208, 173, 147, 147, 155], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83913028, 'remaining_params': 1104572, 'pruned_model_sparsity': 0.987007725459199, 'expected_sparsity': 0.98371, 'target_sparsity': 0.95, 'step': 7100}


Iteration:  49%|████▉     | 132/268 [00:32<02:35,  1.14s/it][A04/30/2024 10:43:43 - INFO - trainer.trainer_mod_2 - v4 Global step: 7100, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  50%|████▉     | 133/268 [00:32<01:54,  1.18it/s][A
Iteration:  50%|█████     | 134/268 [00:33<01:27,  1.54it/s][A
Iteration:  50%|█████     | 135/268 [00:33<01:07,  1.98it/s][A
Iteration:  51%|█████     | 136/268 [00:33<00:53,  2.48it/s][A
Iteration:  51%|█████     | 137/268 [00:33<00:43,  3.00it/s][A
Iteration:  51%|█████▏    | 138/268 [00:33<00:36,  3.54it/s][A
Iteration:  52%|█████▏    | 139/268 [00:33<00:32,  4.03it/s][A
Iteration:  52%|█████▏    | 140/268 [00:34<00:28,  4.47it/s][A
Iteration:  53%|█████▎    | 141/268 [00:34<00:26,  4.81it/s][A
Iteration:  53%|█████▎    | 142/268 [00:34<00:24,  5.10it/s][A
Iteration:  53%|█████▎    | 143/268 [00:34<00:23,  5.32it/s][A
Iteration:  54%|█████▎    | 144/268 [00:34<00:22,  5.48it/s][A
Iteration:  54%|█████▍    | 145/268 [00:34<00:21,  5.59it/s][A
Iteration:  54%|█████▍    | 146/268 [00:35<00:21,  5.76it/s][A
Iteration:  55%|█████▍    | 147/268 [00:35<00:21,  5.66it/s][A
Iteration:  55%|█████▌    | 148/268 [00:35<00:20,  5.85it/s][A
Iteration:  56%|█████▌    | 149/268 [00:35<00:20,  5.80it/s][A
Iteration:  56%|█████▌    | 150/268 [00:35<00:20,  5.84it/s][A
Iteration:  56%|█████▋    | 151/268 [00:35<00:19,  5.98it/s][A
Iteration:  57%|█████▋    | 152/268 [00:36<00:19,  6.05it/s][A
Iteration:  57%|█████▋    | 153/268 [00:36<00:19,  6.02it/s][A
Iteration:  57%|█████▋    | 154/268 [00:36<00:19,  5.97it/s][A
Iteration:  58%|█████▊    | 155/268 [00:36<00:19,  5.90it/s][A
Iteration:  58%|█████▊    | 156/268 [00:36<00:19,  5.85it/s][A
Iteration:  59%|█████▊    | 157/268 [00:36<00:18,  5.85it/s][A
Iteration:  59%|█████▉    | 158/268 [00:37<00:18,  5.97it/s][A
Iteration:  59%|█████▉    | 159/268 [00:37<00:18,  5.83it/s][A
Iteration:  60%|█████▉    | 160/268 [00:37<00:18,  5.85it/s][A
Iteration:  60%|██████    | 161/268 [00:37<00:17,  5.95it/s][A
Iteration:  60%|██████    | 162/268 [00:37<00:18,  5.70it/s][A
Iteration:  61%|██████    | 163/268 [00:38<00:18,  5.66it/s][A
Iteration:  61%|██████    | 164/268 [00:38<00:17,  5.85it/s][A
Iteration:  62%|██████▏   | 165/268 [00:38<00:17,  5.91it/s][A
Iteration:  62%|██████▏   | 166/268 [00:38<00:16,  6.01it/s][A
Iteration:  62%|██████▏   | 167/268 [00:38<00:17,  5.87it/s][A
Iteration:  63%|██████▎   | 168/268 [00:38<00:16,  5.90it/s][A
Iteration:  63%|██████▎   | 169/268 [00:39<00:16,  5.85it/s][A
Iteration:  63%|██████▎   | 170/268 [00:39<00:16,  5.84it/s][A
Iteration:  64%|██████▍   | 171/268 [00:39<00:16,  5.88it/s][A
Iteration:  64%|██████▍   | 172/268 [00:39<00:16,  5.81it/s][A
Iteration:  65%|██████▍   | 173/268 [00:39<00:16,  5.83it/s][A
Iteration:  65%|██████▍   | 174/268 [00:39<00:16,  5.77it/s][A
Iteration:  65%|██████▌   | 175/268 [00:40<00:16,  5.60it/s][A
Iteration:  66%|██████▌   | 176/268 [00:40<00:16,  5.67it/s][A
Iteration:  66%|██████▌   | 177/268 [00:40<00:15,  5.70it/s][A
Iteration:  66%|██████▋   | 178/268 [00:40<00:16,  5.61it/s][A
Iteration:  67%|██████▋   | 179/268 [00:40<00:15,  5.68it/s][A
Iteration:  67%|██████▋   | 180/268 [00:40<00:15,  5.68it/s][A
Iteration:  68%|██████▊   | 181/268 [00:41<00:15,  5.74it/s][A[INFO|trainer.py:570] 2024-04-30 10:43:51,740 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:43:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:43:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:43:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:43:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.30it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.45it/s]04/30/2024 10:43:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:43:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.68738, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [222, 240, 355, 352, 539, 411, 256, 208, 173, 147, 147, 155], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83917624, 'remaining_params': 1099976, 'pruned_model_sparsity': 0.9870617848539597, 'expected_sparsity': 0.98395, 'target_sparsity': 0.95, 'step': 7150}


Iteration:  68%|██████▊   | 182/268 [00:44<01:37,  1.14s/it][A
Iteration:  68%|██████▊   | 183/268 [00:44<01:12,  1.17it/s][A
Iteration:  69%|██████▊   | 184/268 [00:44<00:54,  1.54it/s][A
Iteration:  69%|██████▉   | 185/268 [00:45<00:42,  1.98it/s][A
Iteration:  69%|██████▉   | 186/268 [00:45<00:33,  2.45it/s][A
Iteration:  70%|██████▉   | 187/268 [00:45<00:27,  2.95it/s][A
Iteration:  70%|███████   | 188/268 [00:45<00:22,  3.48it/s][A
Iteration:  71%|███████   | 189/268 [00:45<00:20,  3.93it/s][A
Iteration:  71%|███████   | 190/268 [00:45<00:17,  4.36it/s][A
Iteration:  71%|███████▏  | 191/268 [00:46<00:16,  4.75it/s][A
Iteration:  72%|███████▏  | 192/268 [00:46<00:14,  5.09it/s][A
Iteration:  72%|███████▏  | 193/268 [00:46<00:14,  5.27it/s][A
Iteration:  72%|███████▏  | 194/268 [00:46<00:13,  5.34it/s][A
Iteration:  73%|███████▎  | 195/268 [00:46<00:13,  5.45it/s][A
Iteration:  73%|███████▎  | 196/268 [00:46<00:12,  5.55it/s][A
Iteration:  74%|███████▎  | 197/268 [00:47<00:12,  5.67it/s][A
Iteration:  74%|███████▍  | 198/268 [00:47<00:12,  5.69it/s][A
Iteration:  74%|███████▍  | 199/268 [00:47<00:11,  5.77it/s][A
Iteration:  75%|███████▍  | 200/268 [00:47<00:12,  5.64it/s][A
Iteration:  75%|███████▌  | 201/268 [00:47<00:11,  5.71it/s][A
Iteration:  75%|███████▌  | 202/268 [00:47<00:11,  5.77it/s][A
Iteration:  76%|███████▌  | 203/268 [00:48<00:11,  5.79it/s][A
Iteration:  76%|███████▌  | 204/268 [00:48<00:11,  5.77it/s][A
Iteration:  76%|███████▋  | 205/268 [00:48<00:10,  5.73it/s][A
Iteration:  77%|███████▋  | 206/268 [00:48<00:10,  5.78it/s][A
Iteration:  77%|███████▋  | 207/268 [00:48<00:10,  5.63it/s][A
Iteration:  78%|███████▊  | 208/268 [00:49<00:10,  5.70it/s][A
Iteration:  78%|███████▊  | 209/268 [00:49<00:10,  5.64it/s][A
Iteration:  78%|███████▊  | 210/268 [00:49<00:10,  5.59it/s][A
Iteration:  79%|███████▊  | 211/268 [00:49<00:10,  5.70it/s][A
Iteration:  79%|███████▉  | 212/268 [00:49<00:09,  5.72it/s][A
Iteration:  79%|███████▉  | 213/268 [00:49<00:09,  5.72it/s][A
Iteration:  80%|███████▉  | 214/268 [00:50<00:09,  5.78it/s][A
Iteration:  80%|████████  | 215/268 [00:50<00:09,  5.82it/s][A
Iteration:  81%|████████  | 216/268 [00:50<00:09,  5.67it/s][A
Iteration:  81%|████████  | 217/268 [00:50<00:08,  5.68it/s][A
Iteration:  81%|████████▏ | 218/268 [00:50<00:08,  5.60it/s][A
Iteration:  82%|████████▏ | 219/268 [00:50<00:08,  5.68it/s][A
Iteration:  82%|████████▏ | 220/268 [00:51<00:08,  5.83it/s][A
Iteration:  82%|████████▏ | 221/268 [00:51<00:07,  5.94it/s][A
Iteration:  83%|████████▎ | 222/268 [00:51<00:07,  5.88it/s][A
Iteration:  83%|████████▎ | 223/268 [00:51<00:07,  5.81it/s][A
Iteration:  84%|████████▎ | 224/268 [00:51<00:07,  5.79it/s][A
Iteration:  84%|████████▍ | 225/268 [00:52<00:07,  5.48it/s][A
Iteration:  84%|████████▍ | 226/268 [00:52<00:07,  5.52it/s][A
Iteration:  85%|████████▍ | 227/268 [00:52<00:07,  5.56it/s][A
Iteration:  85%|████████▌ | 228/268 [00:52<00:07,  5.65it/s][A
Iteration:  85%|████████▌ | 229/268 [00:52<00:06,  5.63it/s][A
Iteration:  86%|████████▌ | 230/268 [00:52<00:06,  5.63it/s][A
Iteration:  86%|████████▌ | 231/268 [00:53<00:06,  5.58it/s][A[INFO|trainer.py:570] 2024-04-30 10:44:03,712 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:44:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:44:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:44:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:44:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.31it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.44it/s]04/30/2024 10:44:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:44:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.67909527, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [220, 238, 354, 351, 537, 410, 256, 208, 173, 147, 147, 154], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83923752, 'remaining_params': 1093848, 'pruned_model_sparsity': 0.9871338640469738, 'expected_sparsity': 0.98409, 'target_sparsity': 0.95, 'step': 7200}


Iteration:  87%|████████▋ | 232/268 [00:56<00:41,  1.14s/it][A04/30/2024 10:44:06 - INFO - trainer.trainer_mod_2 - v4 Global step: 7200, Alignment: tensor([2, 2, 2, 2], device='cuda:0')

Iteration:  87%|████████▋ | 233/268 [00:56<00:30,  1.17it/s][A
Iteration:  87%|████████▋ | 234/268 [00:56<00:22,  1.53it/s][A
Iteration:  88%|████████▊ | 235/268 [00:57<00:16,  1.96it/s][A
Iteration:  88%|████████▊ | 236/268 [00:57<00:13,  2.44it/s][A
Iteration:  88%|████████▊ | 237/268 [00:57<00:10,  2.88it/s][A
Iteration:  89%|████████▉ | 238/268 [00:57<00:08,  3.40it/s][A
Iteration:  89%|████████▉ | 239/268 [00:57<00:07,  3.89it/s][A
Iteration:  90%|████████▉ | 240/268 [00:57<00:06,  4.30it/s][A
Iteration:  90%|████████▉ | 241/268 [00:58<00:05,  4.65it/s][A
Iteration:  90%|█████████ | 242/268 [00:58<00:05,  4.96it/s][A
Iteration:  91%|█████████ | 243/268 [00:58<00:04,  5.23it/s][A
Iteration:  91%|█████████ | 244/268 [00:58<00:04,  5.35it/s][A
Iteration:  91%|█████████▏| 245/268 [00:58<00:04,  5.47it/s][A
Iteration:  92%|█████████▏| 246/268 [00:58<00:04,  5.39it/s][A
Iteration:  92%|█████████▏| 247/268 [00:59<00:03,  5.53it/s][A
Iteration:  93%|█████████▎| 248/268 [00:59<00:03,  5.42it/s][A
Iteration:  93%|█████████▎| 249/268 [00:59<00:03,  5.51it/s][A
Iteration:  93%|█████████▎| 250/268 [00:59<00:03,  5.57it/s][A
Iteration:  94%|█████████▎| 251/268 [00:59<00:03,  5.51it/s][A
Iteration:  94%|█████████▍| 252/268 [01:00<00:02,  5.63it/s][A
Iteration:  94%|█████████▍| 253/268 [01:00<00:02,  5.52it/s][A
Iteration:  95%|█████████▍| 254/268 [01:00<00:02,  5.58it/s][A
Iteration:  95%|█████████▌| 255/268 [01:00<00:02,  5.57it/s][A
Iteration:  96%|█████████▌| 256/268 [01:00<00:02,  5.67it/s][A
Iteration:  96%|█████████▌| 257/268 [01:00<00:01,  5.69it/s][A
Iteration:  96%|█████████▋| 258/268 [01:01<00:01,  5.78it/s][A
Iteration:  97%|█████████▋| 259/268 [01:01<00:01,  5.75it/s][A
Iteration:  97%|█████████▋| 260/268 [01:01<00:01,  5.76it/s][A
Iteration:  97%|█████████▋| 261/268 [01:01<00:01,  5.83it/s][A
Iteration:  98%|█████████▊| 262/268 [01:01<00:01,  5.87it/s][A
Iteration:  98%|█████████▊| 263/268 [01:01<00:00,  5.79it/s][A
Iteration:  99%|█████████▊| 264/268 [01:02<00:00,  5.85it/s][A
Iteration:  99%|█████████▉| 265/268 [01:02<00:00,  5.79it/s][A
Iteration:  99%|█████████▉| 266/268 [01:02<00:00,  5.86it/s][A
Iteration: 100%|█████████▉| 267/268 [01:02<00:00,  5.78it/s][A
Iteration: 100%|██████████| 268/268 [01:02<00:00,  6.32it/s][A04/30/2024 10:44:13 - INFO - trainer.trainer_mod_2 - Epoch 26 finished. Took 62.76 seconds.
Iteration: 100%|██████████| 268/268 [01:02<00:00,  4.27it/s]
Epoch:  27%|██▋       | 27/100 [31:19<1:19:44, 65.55s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:44,  5.96it/s][A
Iteration:   1%|          | 2/268 [00:00<00:44,  6.02it/s][A
Iteration:   1%|          | 3/268 [00:00<00:44,  5.91it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:45,  5.83it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:45,  5.75it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:45,  5.72it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:45,  5.78it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:46,  5.65it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:45,  5.74it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:44,  5.74it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:44,  5.79it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:44,  5.76it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:43,  5.83it/s][A[INFO|trainer.py:570] 2024-04-30 10:44:15,646 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:44:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:44:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:44:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:44:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.31it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.28it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.30it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.31it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.32it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.44it/s]04/30/2024 10:44:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:44:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.68835825, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [219, 237, 354, 350, 534, 410, 256, 208, 173, 146, 147, 154], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83926816, 'remaining_params': 1090784, 'pruned_model_sparsity': 0.9871699036434809, 'expected_sparsity': 0.9842, 'target_sparsity': 0.95, 'step': 7250}


Iteration:   5%|▌         | 14/268 [00:05<04:51,  1.15s/it][A
Iteration:   6%|▌         | 15/268 [00:05<03:35,  1.17it/s][A
Iteration:   6%|▌         | 16/268 [00:05<02:42,  1.55it/s][A
Iteration:   6%|▋         | 17/268 [00:06<02:05,  1.99it/s][A
Iteration:   7%|▋         | 18/268 [00:06<01:40,  2.49it/s][A
Iteration:   7%|▋         | 19/268 [00:06<01:23,  3.00it/s][A
Iteration:   7%|▋         | 20/268 [00:06<01:09,  3.55it/s][A
Iteration:   8%|▊         | 21/268 [00:06<01:00,  4.09it/s][A
Iteration:   8%|▊         | 22/268 [00:06<00:54,  4.48it/s][A
Iteration:   9%|▊         | 23/268 [00:07<00:50,  4.84it/s][A
Iteration:   9%|▉         | 24/268 [00:07<00:47,  5.09it/s][A
Iteration:   9%|▉         | 25/268 [00:07<00:47,  5.16it/s][A
Iteration:  10%|▉         | 26/268 [00:07<00:45,  5.37it/s][A
Iteration:  10%|█         | 27/268 [00:07<00:44,  5.44it/s][A
Iteration:  10%|█         | 28/268 [00:08<00:44,  5.45it/s][A
Iteration:  11%|█         | 29/268 [00:08<00:42,  5.59it/s][A
Iteration:  11%|█         | 30/268 [00:08<00:42,  5.62it/s][A
Iteration:  12%|█▏        | 31/268 [00:08<00:42,  5.54it/s][A
Iteration:  12%|█▏        | 32/268 [00:08<00:41,  5.64it/s][A
Iteration:  12%|█▏        | 33/268 [00:08<00:41,  5.71it/s][A
Iteration:  13%|█▎        | 34/268 [00:09<00:40,  5.79it/s][A
Iteration:  13%|█▎        | 35/268 [00:09<00:39,  5.83it/s][A
Iteration:  13%|█▎        | 36/268 [00:09<00:39,  5.81it/s][A
Iteration:  14%|█▍        | 37/268 [00:09<00:40,  5.70it/s][A
Iteration:  14%|█▍        | 38/268 [00:09<00:40,  5.68it/s][A
Iteration:  15%|█▍        | 39/268 [00:09<00:41,  5.58it/s][A
Iteration:  15%|█▍        | 40/268 [00:10<00:40,  5.69it/s][A
Iteration:  15%|█▌        | 41/268 [00:10<00:39,  5.77it/s][A
Iteration:  16%|█▌        | 42/268 [00:10<00:38,  5.83it/s][A
Iteration:  16%|█▌        | 43/268 [00:10<00:37,  5.94it/s][A
Iteration:  16%|█▋        | 44/268 [00:10<00:37,  5.92it/s][A
Iteration:  17%|█▋        | 45/268 [00:10<00:38,  5.86it/s][A
Iteration:  17%|█▋        | 46/268 [00:11<00:39,  5.64it/s][A
Iteration:  18%|█▊        | 47/268 [00:11<00:40,  5.50it/s][A
Iteration:  18%|█▊        | 48/268 [00:11<00:39,  5.61it/s][A
Iteration:  18%|█▊        | 49/268 [00:11<00:37,  5.80it/s][A
Iteration:  19%|█▊        | 50/268 [00:11<00:37,  5.85it/s][A
Iteration:  19%|█▉        | 51/268 [00:12<00:36,  5.89it/s][A
Iteration:  19%|█▉        | 52/268 [00:12<00:37,  5.78it/s][A
Iteration:  20%|█▉        | 53/268 [00:12<00:36,  5.82it/s][A
Iteration:  20%|██        | 54/268 [00:12<00:36,  5.81it/s][A
Iteration:  21%|██        | 55/268 [00:12<00:35,  5.92it/s][A
Iteration:  21%|██        | 56/268 [00:12<00:36,  5.76it/s][A
Iteration:  21%|██▏       | 57/268 [00:13<00:36,  5.77it/s][A
Iteration:  22%|██▏       | 58/268 [00:13<00:36,  5.78it/s][A
Iteration:  22%|██▏       | 59/268 [00:13<00:35,  5.84it/s][A
Iteration:  22%|██▏       | 60/268 [00:13<00:35,  5.84it/s][A
Iteration:  23%|██▎       | 61/268 [00:13<00:35,  5.78it/s][A
Iteration:  23%|██▎       | 62/268 [00:13<00:36,  5.66it/s][A
Iteration:  24%|██▎       | 63/268 [00:14<00:36,  5.58it/s][A[INFO|trainer.py:570] 2024-04-30 10:44:27,516 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:44:27 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:44:27 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:44:27 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:44:27 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.30it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.44it/s]04/30/2024 10:44:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:44:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.673141, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [217, 236, 353, 350, 532, 409, 255, 208, 173, 146, 147, 154], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83931412, 'remaining_params': 1086188, 'pruned_model_sparsity': 0.9872239630382414, 'expected_sparsity': 0.98429, 'target_sparsity': 0.95, 'step': 7300}


Iteration:  24%|██▍       | 64/268 [00:17<03:53,  1.14s/it][A04/30/2024 10:44:30 - INFO - trainer.trainer_mod_2 - v4 Global step: 7300, Alignment: tensor([3, 3, 3, 3], device='cuda:0')

Iteration:  24%|██▍       | 65/268 [00:17<02:52,  1.18it/s][A
Iteration:  25%|██▍       | 66/268 [00:17<02:10,  1.54it/s][A
Iteration:  25%|██▌       | 67/268 [00:18<01:41,  1.99it/s][A
Iteration:  25%|██▌       | 68/268 [00:18<01:21,  2.47it/s][A
Iteration:  26%|██▌       | 69/268 [00:18<01:06,  2.99it/s][A
Iteration:  26%|██▌       | 70/268 [00:18<00:56,  3.49it/s][A
Iteration:  26%|██▋       | 71/268 [00:18<00:49,  3.98it/s][A
Iteration:  27%|██▋       | 72/268 [00:18<00:43,  4.47it/s][A
Iteration:  27%|██▋       | 73/268 [00:19<00:40,  4.82it/s][A
Iteration:  28%|██▊       | 74/268 [00:19<00:39,  4.87it/s][A
Iteration:  28%|██▊       | 75/268 [00:19<00:37,  5.09it/s][A
Iteration:  28%|██▊       | 76/268 [00:19<00:37,  5.18it/s][A
Iteration:  29%|██▊       | 77/268 [00:19<00:35,  5.31it/s][A
Iteration:  29%|██▉       | 78/268 [00:19<00:34,  5.49it/s][A
Iteration:  29%|██▉       | 79/268 [00:20<00:34,  5.49it/s][A
Iteration:  30%|██▉       | 80/268 [00:20<00:33,  5.67it/s][A
Iteration:  30%|███       | 81/268 [00:20<00:32,  5.77it/s][A
Iteration:  31%|███       | 82/268 [00:20<00:31,  5.94it/s][A
Iteration:  31%|███       | 83/268 [00:20<00:30,  5.97it/s][A
Iteration:  31%|███▏      | 84/268 [00:20<00:32,  5.73it/s][A
Iteration:  32%|███▏      | 85/268 [00:21<00:32,  5.72it/s][A
Iteration:  32%|███▏      | 86/268 [00:21<00:32,  5.68it/s][A
Iteration:  32%|███▏      | 87/268 [00:21<00:31,  5.70it/s][A
Iteration:  33%|███▎      | 88/268 [00:21<00:32,  5.61it/s][A
Iteration:  33%|███▎      | 89/268 [00:21<00:30,  5.79it/s][A
Iteration:  34%|███▎      | 90/268 [00:22<00:30,  5.80it/s][A
Iteration:  34%|███▍      | 91/268 [00:22<00:30,  5.74it/s][A
Iteration:  34%|███▍      | 92/268 [00:22<00:30,  5.71it/s][A
Iteration:  35%|███▍      | 93/268 [00:22<00:30,  5.72it/s][A
Iteration:  35%|███▌      | 94/268 [00:22<00:29,  5.92it/s][A
Iteration:  35%|███▌      | 95/268 [00:22<00:29,  5.94it/s][A
Iteration:  36%|███▌      | 96/268 [00:23<00:29,  5.92it/s][A
Iteration:  36%|███▌      | 97/268 [00:23<00:28,  5.90it/s][A
Iteration:  37%|███▋      | 98/268 [00:23<00:29,  5.79it/s][A
Iteration:  37%|███▋      | 99/268 [00:23<00:29,  5.64it/s][A
Iteration:  37%|███▋      | 100/268 [00:23<00:30,  5.48it/s][A
Iteration:  38%|███▊      | 101/268 [00:23<00:29,  5.59it/s][A
Iteration:  38%|███▊      | 102/268 [00:24<00:28,  5.73it/s][A
Iteration:  38%|███▊      | 103/268 [00:24<00:28,  5.69it/s][A
Iteration:  39%|███▉      | 104/268 [00:24<00:29,  5.62it/s][A
Iteration:  39%|███▉      | 105/268 [00:24<00:29,  5.53it/s][A
Iteration:  40%|███▉      | 106/268 [00:24<00:28,  5.65it/s][A
Iteration:  40%|███▉      | 107/268 [00:24<00:28,  5.74it/s][A
Iteration:  40%|████      | 108/268 [00:25<00:27,  5.77it/s][A
Iteration:  41%|████      | 109/268 [00:25<00:27,  5.88it/s][A
Iteration:  41%|████      | 110/268 [00:25<00:26,  5.92it/s][A
Iteration:  41%|████▏     | 111/268 [00:25<00:26,  5.91it/s][A
Iteration:  42%|████▏     | 112/268 [00:25<00:26,  5.88it/s][A
Iteration:  42%|████▏     | 113/268 [00:26<00:26,  5.77it/s][A[INFO|trainer.py:570] 2024-04-30 10:44:39,404 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:44:39 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:44:39 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:44:39 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:44:39 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.31it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.30it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.31it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.31it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.44it/s]04/30/2024 10:44:42 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:44:42 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6847358, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [215, 234, 353, 349, 530, 408, 255, 208, 173, 146, 147, 153], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83937540, 'remaining_params': 1080060, 'pruned_model_sparsity': 0.9872960422312557, 'expected_sparsity': 0.98438, 'target_sparsity': 0.95, 'step': 7350}


Iteration:  43%|████▎     | 114/268 [00:29<02:55,  1.14s/it][A
Iteration:  43%|████▎     | 115/268 [00:29<02:09,  1.18it/s][A
Iteration:  43%|████▎     | 116/268 [00:29<01:38,  1.55it/s][A
Iteration:  44%|████▎     | 117/268 [00:29<01:16,  1.98it/s][A
Iteration:  44%|████▍     | 118/268 [00:30<01:00,  2.47it/s][A
Iteration:  44%|████▍     | 119/268 [00:30<00:49,  2.99it/s][A
Iteration:  45%|████▍     | 120/268 [00:30<00:42,  3.52it/s][A
Iteration:  45%|████▌     | 121/268 [00:30<00:36,  4.00it/s][A
Iteration:  46%|████▌     | 122/268 [00:30<00:33,  4.42it/s][A
Iteration:  46%|████▌     | 123/268 [00:30<00:30,  4.81it/s][A
Iteration:  46%|████▋     | 124/268 [00:31<00:28,  5.10it/s][A
Iteration:  47%|████▋     | 125/268 [00:31<00:26,  5.35it/s][A
Iteration:  47%|████▋     | 126/268 [00:31<00:26,  5.41it/s][A
Iteration:  47%|████▋     | 127/268 [00:31<00:25,  5.55it/s][A
Iteration:  48%|████▊     | 128/268 [00:31<00:24,  5.64it/s][A
Iteration:  48%|████▊     | 129/268 [00:31<00:25,  5.54it/s][A
Iteration:  49%|████▊     | 130/268 [00:32<00:24,  5.71it/s][A
Iteration:  49%|████▉     | 131/268 [00:32<00:23,  5.73it/s][A
Iteration:  49%|████▉     | 132/268 [00:32<00:23,  5.73it/s][A
Iteration:  50%|████▉     | 133/268 [00:32<00:23,  5.69it/s][A
Iteration:  50%|█████     | 134/268 [00:32<00:23,  5.71it/s][A
Iteration:  50%|█████     | 135/268 [00:33<00:23,  5.74it/s][A
Iteration:  51%|█████     | 136/268 [00:33<00:22,  5.78it/s][A
Iteration:  51%|█████     | 137/268 [00:33<00:22,  5.73it/s][A
Iteration:  51%|█████▏    | 138/268 [00:33<00:22,  5.71it/s][A
Iteration:  52%|█████▏    | 139/268 [00:33<00:21,  5.89it/s][A
Iteration:  52%|█████▏    | 140/268 [00:33<00:21,  5.83it/s][A
Iteration:  53%|█████▎    | 141/268 [00:34<00:21,  5.84it/s][A
Iteration:  53%|█████▎    | 142/268 [00:34<00:22,  5.71it/s][A
Iteration:  53%|█████▎    | 143/268 [00:34<00:22,  5.60it/s][A
Iteration:  54%|█████▎    | 144/268 [00:34<00:21,  5.73it/s][A
Iteration:  54%|█████▍    | 145/268 [00:34<00:21,  5.73it/s][A
Iteration:  54%|█████▍    | 146/268 [00:34<00:21,  5.69it/s][A
Iteration:  55%|█████▍    | 147/268 [00:35<00:21,  5.65it/s][A
Iteration:  55%|█████▌    | 148/268 [00:35<00:21,  5.60it/s][A
Iteration:  56%|█████▌    | 149/268 [00:35<00:20,  5.71it/s][A
Iteration:  56%|█████▌    | 150/268 [00:35<00:20,  5.71it/s][A
Iteration:  56%|█████▋    | 151/268 [00:35<00:20,  5.78it/s][A
Iteration:  57%|█████▋    | 152/268 [00:35<00:19,  5.81it/s][A
Iteration:  57%|█████▋    | 153/268 [00:36<00:19,  5.78it/s][A
Iteration:  57%|█████▋    | 154/268 [00:36<00:19,  5.74it/s][A
Iteration:  58%|█████▊    | 155/268 [00:36<00:19,  5.72it/s][A
Iteration:  58%|█████▊    | 156/268 [00:36<00:20,  5.46it/s][A
Iteration:  59%|█████▊    | 157/268 [00:36<00:20,  5.53it/s][A
Iteration:  59%|█████▉    | 158/268 [00:37<00:19,  5.66it/s][A
Iteration:  59%|█████▉    | 159/268 [00:37<00:19,  5.67it/s][A
Iteration:  60%|█████▉    | 160/268 [00:37<00:18,  5.77it/s][A
Iteration:  60%|██████    | 161/268 [00:37<00:18,  5.94it/s][A
Iteration:  60%|██████    | 162/268 [00:37<00:17,  5.97it/s][A
Iteration:  61%|██████    | 163/268 [00:37<00:17,  5.95it/s][A[INFO|trainer.py:570] 2024-04-30 10:44:51,273 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:44:51 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:44:51 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:44:51 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:44:51 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.31it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.45it/s]04/30/2024 10:44:54 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:44:54 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.70186067, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [214, 233, 353, 349, 527, 407, 255, 208, 173, 146, 147, 153], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83940604, 'remaining_params': 1076996, 'pruned_model_sparsity': 0.9873320818277628, 'expected_sparsity': 0.98446, 'target_sparsity': 0.95, 'step': 7400}


Iteration:  61%|██████    | 164/268 [00:41<01:58,  1.13s/it][A04/30/2024 10:44:54 - INFO - trainer.trainer_mod_2 - v4 Global step: 7400, Alignment: tensor([ 1,  1,  1, 11], device='cuda:0')

Iteration:  62%|██████▏   | 165/268 [00:41<01:26,  1.19it/s][A
Iteration:  62%|██████▏   | 166/268 [00:41<01:05,  1.56it/s][A
Iteration:  62%|██████▏   | 167/268 [00:41<00:50,  2.02it/s][A
Iteration:  63%|██████▎   | 168/268 [00:41<00:40,  2.49it/s][A
Iteration:  63%|██████▎   | 169/268 [00:42<00:32,  3.01it/s][A
Iteration:  63%|██████▎   | 170/268 [00:42<00:28,  3.46it/s][A
Iteration:  64%|██████▍   | 171/268 [00:42<00:24,  3.92it/s][A
Iteration:  64%|██████▍   | 172/268 [00:42<00:21,  4.37it/s][A
Iteration:  65%|██████▍   | 173/268 [00:42<00:20,  4.74it/s][A
Iteration:  65%|██████▍   | 174/268 [00:42<00:18,  5.06it/s][A
Iteration:  65%|██████▌   | 175/268 [00:43<00:17,  5.20it/s][A
Iteration:  66%|██████▌   | 176/268 [00:43<00:17,  5.37it/s][A
Iteration:  66%|██████▌   | 177/268 [00:43<00:16,  5.37it/s][A
Iteration:  66%|██████▋   | 178/268 [00:43<00:16,  5.50it/s][A
Iteration:  67%|██████▋   | 179/268 [00:43<00:16,  5.53it/s][A
Iteration:  67%|██████▋   | 180/268 [00:44<00:15,  5.61it/s][A
Iteration:  68%|██████▊   | 181/268 [00:44<00:15,  5.71it/s][A
Iteration:  68%|██████▊   | 182/268 [00:44<00:15,  5.73it/s][A
Iteration:  68%|██████▊   | 183/268 [00:44<00:14,  5.69it/s][A
Iteration:  69%|██████▊   | 184/268 [00:44<00:14,  5.70it/s][A
Iteration:  69%|██████▉   | 185/268 [00:44<00:14,  5.80it/s][A
Iteration:  69%|██████▉   | 186/268 [00:45<00:14,  5.84it/s][A
Iteration:  70%|██████▉   | 187/268 [00:45<00:13,  5.87it/s][A
Iteration:  70%|███████   | 188/268 [00:45<00:13,  5.83it/s][A
Iteration:  71%|███████   | 189/268 [00:45<00:13,  5.85it/s][A
Iteration:  71%|███████   | 190/268 [00:45<00:13,  5.86it/s][A
Iteration:  71%|███████▏  | 191/268 [00:45<00:12,  5.94it/s][A
Iteration:  72%|███████▏  | 192/268 [00:46<00:12,  5.87it/s][A
Iteration:  72%|███████▏  | 193/268 [00:46<00:12,  5.85it/s][A
Iteration:  72%|███████▏  | 194/268 [00:46<00:12,  5.89it/s][A
Iteration:  73%|███████▎  | 195/268 [00:46<00:12,  5.90it/s][A
Iteration:  73%|███████▎  | 196/268 [00:46<00:12,  5.91it/s][A
Iteration:  74%|███████▎  | 197/268 [00:46<00:12,  5.87it/s][A
Iteration:  74%|███████▍  | 198/268 [00:47<00:11,  5.96it/s][A
Iteration:  74%|███████▍  | 199/268 [00:47<00:11,  5.79it/s][A
Iteration:  75%|███████▍  | 200/268 [00:47<00:11,  5.81it/s][A
Iteration:  75%|███████▌  | 201/268 [00:47<00:11,  5.86it/s][A
Iteration:  75%|███████▌  | 202/268 [00:47<00:11,  5.91it/s][A
Iteration:  76%|███████▌  | 203/268 [00:47<00:10,  5.92it/s][A
Iteration:  76%|███████▌  | 204/268 [00:48<00:10,  5.93it/s][A
Iteration:  76%|███████▋  | 205/268 [00:48<00:10,  5.85it/s][A
Iteration:  77%|███████▋  | 206/268 [00:48<00:10,  5.88it/s][A
Iteration:  77%|███████▋  | 207/268 [00:48<00:10,  5.85it/s][A
Iteration:  78%|███████▊  | 208/268 [00:48<00:10,  5.87it/s][A
Iteration:  78%|███████▊  | 209/268 [00:48<00:10,  5.78it/s][A
Iteration:  78%|███████▊  | 210/268 [00:49<00:10,  5.77it/s][A
Iteration:  79%|███████▊  | 211/268 [00:49<00:09,  5.81it/s][A
Iteration:  79%|███████▉  | 212/268 [00:49<00:09,  5.72it/s][A
Iteration:  79%|███████▉  | 213/268 [00:49<00:09,  5.69it/s][A[INFO|trainer.py:570] 2024-04-30 10:45:03,075 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:45:03 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:45:03 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:45:03 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:45:03 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.31it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.34it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.34it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.33it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.45it/s]04/30/2024 10:45:06 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:45:06 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6516677, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [212, 232, 352, 348, 525, 406, 255, 208, 173, 146, 147, 153], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83945200, 'remaining_params': 1072400, 'pruned_model_sparsity': 0.9873861412225233, 'expected_sparsity': 0.98453, 'target_sparsity': 0.95, 'step': 7450}


Iteration:  80%|███████▉  | 214/268 [00:53<01:01,  1.14s/it][A
Iteration:  80%|████████  | 215/268 [00:53<00:44,  1.18it/s][A
Iteration:  81%|████████  | 216/268 [00:53<00:33,  1.55it/s][A
Iteration:  81%|████████  | 217/268 [00:53<00:25,  1.98it/s][A
Iteration:  81%|████████▏ | 218/268 [00:53<00:20,  2.48it/s][A
Iteration:  82%|████████▏ | 219/268 [00:53<00:16,  3.01it/s][A
Iteration:  82%|████████▏ | 220/268 [00:54<00:13,  3.53it/s][A
Iteration:  82%|████████▏ | 221/268 [00:54<00:12,  3.78it/s][A
Iteration:  83%|████████▎ | 222/268 [00:54<00:10,  4.24it/s][A
Iteration:  83%|████████▎ | 223/268 [00:54<00:09,  4.62it/s][A
Iteration:  84%|████████▎ | 224/268 [00:54<00:08,  4.90it/s][A
Iteration:  84%|████████▍ | 225/268 [00:55<00:08,  5.09it/s][A
Iteration:  84%|████████▍ | 226/268 [00:55<00:07,  5.26it/s][A
Iteration:  85%|████████▍ | 227/268 [00:55<00:07,  5.38it/s][A
Iteration:  85%|████████▌ | 228/268 [00:55<00:07,  5.57it/s][A
Iteration:  85%|████████▌ | 229/268 [00:55<00:07,  5.57it/s][A
Iteration:  86%|████████▌ | 230/268 [00:55<00:06,  5.66it/s][A
Iteration:  86%|████████▌ | 231/268 [00:56<00:06,  5.76it/s][A
Iteration:  87%|████████▋ | 232/268 [00:56<00:06,  5.82it/s][A
Iteration:  87%|████████▋ | 233/268 [00:56<00:05,  5.87it/s][A
Iteration:  87%|████████▋ | 234/268 [00:56<00:06,  5.64it/s][A
Iteration:  88%|████████▊ | 235/268 [00:56<00:05,  5.59it/s][A
Iteration:  88%|████████▊ | 236/268 [00:56<00:05,  5.69it/s][A
Iteration:  88%|████████▊ | 237/268 [00:57<00:05,  5.79it/s][A
Iteration:  89%|████████▉ | 238/268 [00:57<00:05,  5.91it/s][A
Iteration:  89%|████████▉ | 239/268 [00:57<00:04,  5.91it/s][A
Iteration:  90%|████████▉ | 240/268 [00:57<00:04,  5.79it/s][A
Iteration:  90%|████████▉ | 241/268 [00:57<00:04,  5.65it/s][A
Iteration:  90%|█████████ | 242/268 [00:57<00:04,  5.70it/s][A
Iteration:  91%|█████████ | 243/268 [00:58<00:04,  5.73it/s][A
Iteration:  91%|█████████ | 244/268 [00:58<00:04,  5.91it/s][A
Iteration:  91%|█████████▏| 245/268 [00:58<00:03,  5.84it/s][A
Iteration:  92%|█████████▏| 246/268 [00:58<00:03,  5.90it/s][A
Iteration:  92%|█████████▏| 247/268 [00:58<00:03,  5.91it/s][A
Iteration:  93%|█████████▎| 248/268 [00:58<00:03,  5.89it/s][A
Iteration:  93%|█████████▎| 249/268 [00:59<00:03,  5.77it/s][A
Iteration:  93%|█████████▎| 250/268 [00:59<00:03,  5.81it/s][A
Iteration:  94%|█████████▎| 251/268 [00:59<00:03,  5.61it/s][A
Iteration:  94%|█████████▍| 252/268 [00:59<00:02,  5.74it/s][A
Iteration:  94%|█████████▍| 253/268 [00:59<00:02,  5.78it/s][A
Iteration:  95%|█████████▍| 254/268 [01:00<00:02,  5.57it/s][A
Iteration:  95%|█████████▌| 255/268 [01:00<00:02,  5.68it/s][A
Iteration:  96%|█████████▌| 256/268 [01:00<00:02,  5.72it/s][A
Iteration:  96%|█████████▌| 257/268 [01:00<00:01,  5.62it/s][A
Iteration:  96%|█████████▋| 258/268 [01:00<00:01,  5.65it/s][A
Iteration:  97%|█████████▋| 259/268 [01:00<00:01,  5.65it/s][A
Iteration:  97%|█████████▋| 260/268 [01:01<00:01,  5.67it/s][A
Iteration:  97%|█████████▋| 261/268 [01:01<00:01,  5.77it/s][A
Iteration:  98%|█████████▊| 262/268 [01:01<00:01,  5.77it/s][A
Iteration:  98%|█████████▊| 263/268 [01:01<00:00,  5.69it/s][A[INFO|trainer.py:570] 2024-04-30 10:45:15,011 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:45:15 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:45:15 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:45:15 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:45:15 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.30it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.32it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.32it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.32it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.32it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.32it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.44it/s]04/30/2024 10:45:18 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:45:18 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.6801538, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [211, 231, 352, 348, 523, 405, 255, 208, 173, 146, 147, 152], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83948264, 'remaining_params': 1069336, 'pruned_model_sparsity': 0.9874221808190304, 'expected_sparsity': 0.98461, 'target_sparsity': 0.95, 'step': 7500}


Iteration:  99%|█████████▊| 264/268 [01:05<00:04,  1.14s/it][A04/30/2024 10:45:18 - INFO - trainer.trainer_mod_2 - v4 Global step: 7500, Alignment: tensor([2, 2, 2, 2], device='cuda:0')

Iteration:  99%|█████████▉| 265/268 [01:05<00:02,  1.17it/s][A
Iteration:  99%|█████████▉| 266/268 [01:05<00:01,  1.53it/s][A
Iteration: 100%|█████████▉| 267/268 [01:05<00:00,  1.96it/s][A
Iteration: 100%|██████████| 268/268 [01:05<00:00,  2.53it/s][A04/30/2024 10:45:18 - INFO - trainer.trainer_mod_2 - Epoch 27 finished. Took 65.68 seconds.
Iteration: 100%|██████████| 268/268 [01:05<00:00,  4.08it/s]
Epoch:  28%|██▊       | 28/100 [32:25<1:18:42, 65.59s/it]
Iteration:   0%|          | 0/268 [00:00<?, ?it/s][A
Iteration:   0%|          | 1/268 [00:00<00:44,  5.94it/s][A
Iteration:   1%|          | 2/268 [00:00<00:46,  5.71it/s][A
Iteration:   1%|          | 3/268 [00:00<00:45,  5.78it/s][A
Iteration:   1%|▏         | 4/268 [00:00<00:46,  5.68it/s][A
Iteration:   2%|▏         | 5/268 [00:00<00:45,  5.72it/s][A
Iteration:   2%|▏         | 6/268 [00:01<00:45,  5.77it/s][A
Iteration:   3%|▎         | 7/268 [00:01<00:44,  5.81it/s][A
Iteration:   3%|▎         | 8/268 [00:01<00:44,  5.78it/s][A
Iteration:   3%|▎         | 9/268 [00:01<00:46,  5.63it/s][A
Iteration:   4%|▎         | 10/268 [00:01<00:45,  5.73it/s][A
Iteration:   4%|▍         | 11/268 [00:01<00:44,  5.78it/s][A
Iteration:   4%|▍         | 12/268 [00:02<00:43,  5.90it/s][A
Iteration:   5%|▍         | 13/268 [00:02<00:43,  5.91it/s][A
Iteration:   5%|▌         | 14/268 [00:02<00:42,  5.96it/s][A
Iteration:   6%|▌         | 15/268 [00:02<00:43,  5.88it/s][A
Iteration:   6%|▌         | 16/268 [00:02<00:46,  5.40it/s][A
Iteration:   6%|▋         | 17/268 [00:02<00:46,  5.46it/s][A
Iteration:   7%|▋         | 18/268 [00:03<00:44,  5.60it/s][A
Iteration:   7%|▋         | 19/268 [00:03<00:45,  5.42it/s][A
Iteration:   7%|▋         | 20/268 [00:03<00:44,  5.55it/s][A
Iteration:   8%|▊         | 21/268 [00:03<00:44,  5.59it/s][A
Iteration:   8%|▊         | 22/268 [00:03<00:43,  5.71it/s][A
Iteration:   9%|▊         | 23/268 [00:04<00:43,  5.60it/s][A
Iteration:   9%|▉         | 24/268 [00:04<00:42,  5.68it/s][A
Iteration:   9%|▉         | 25/268 [00:04<00:42,  5.70it/s][A
Iteration:  10%|▉         | 26/268 [00:04<00:42,  5.75it/s][A
Iteration:  10%|█         | 27/268 [00:04<00:40,  5.90it/s][A
Iteration:  10%|█         | 28/268 [00:04<00:40,  5.90it/s][A
Iteration:  11%|█         | 29/268 [00:05<00:42,  5.69it/s][A
Iteration:  11%|█         | 30/268 [00:05<00:43,  5.50it/s][A
Iteration:  12%|█▏        | 31/268 [00:05<00:43,  5.49it/s][A
Iteration:  12%|█▏        | 32/268 [00:05<00:42,  5.50it/s][A
Iteration:  12%|█▏        | 33/268 [00:05<00:42,  5.56it/s][A
Iteration:  13%|█▎        | 34/268 [00:05<00:40,  5.73it/s][A
Iteration:  13%|█▎        | 35/268 [00:06<00:39,  5.85it/s][A
Iteration:  13%|█▎        | 36/268 [00:06<00:40,  5.74it/s][A
Iteration:  14%|█▍        | 37/268 [00:06<00:41,  5.62it/s][A
Iteration:  14%|█▍        | 38/268 [00:06<00:39,  5.79it/s][A
Iteration:  15%|█▍        | 39/268 [00:06<00:39,  5.76it/s][A
Iteration:  15%|█▍        | 40/268 [00:07<00:39,  5.74it/s][A
Iteration:  15%|█▌        | 41/268 [00:07<00:39,  5.75it/s][A
Iteration:  16%|█▌        | 42/268 [00:07<00:38,  5.81it/s][A
Iteration:  16%|█▌        | 43/268 [00:07<00:39,  5.72it/s][A
Iteration:  16%|█▋        | 44/268 [00:07<00:38,  5.77it/s][A
Iteration:  17%|█▋        | 45/268 [00:07<00:37,  5.89it/s][A[INFO|trainer.py:570] 2024-04-30 10:45:26,939 >> The following columns in the evaluation set  don't have a corresponding argument in `CoFiBertForSequenceClassification.forward` and have been ignored: sentence, idx. If sentence, idx are not expected by `CoFiBertForSequenceClassification.forward`,  you can safely ignore this message.
04/30/2024 10:45:26 - INFO - trainer.trainer_mod_2 - ***** Running Evaluation *****
04/30/2024 10:45:26 - INFO - trainer.trainer_mod_2 -   Num examples = 1043
04/30/2024 10:45:26 - INFO - trainer.trainer_mod_2 -   Batch size = 32


Evaluation:   0%|          | 0/33 [00:00<?, ?it/s][A[A04/30/2024 10:45:26 - INFO - trainer.trainer_mod_2 - Putting zs dict_keys(['head_z', 'intermediate_z', 'hidden_z', 'mlp_z', 'head_layer_z']) into inputs:


Evaluation:   6%|▌         | 2/33 [00:00<00:03, 10.30it/s][A[A

Evaluation:  12%|█▏        | 4/33 [00:00<00:02, 10.32it/s][A[A

Evaluation:  18%|█▊        | 6/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  24%|██▍       | 8/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  30%|███       | 10/33 [00:00<00:02, 10.33it/s][A[A

Evaluation:  36%|███▋      | 12/33 [00:01<00:02, 10.33it/s][A[A

Evaluation:  42%|████▏     | 14/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  48%|████▊     | 16/33 [00:01<00:01, 10.34it/s][A[A

Evaluation:  55%|█████▍    | 18/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  61%|██████    | 20/33 [00:01<00:01, 10.33it/s][A[A

Evaluation:  67%|██████▋   | 22/33 [00:02<00:01, 10.33it/s][A[A

Evaluation:  73%|███████▎  | 24/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  79%|███████▉  | 26/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  85%|████████▍ | 28/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  91%|█████████ | 30/33 [00:02<00:00, 10.33it/s][A[A

Evaluation:  97%|█████████▋| 32/33 [00:03<00:00, 10.32it/s][A[AEvaluation: 100%|██████████| 33/33 [00:03<00:00, 10.44it/s]04/30/2024 10:45:30 - INFO - datasets.metric - Removing /scratch/network/hw8161/.cache/huggingface/metrics/glue/cola/default_experiment-1-0.arrow
04/30/2024 10:45:30 - INFO - trainer.trainer_mod_2 - Evaluating: {'matthews_correlation': 0.0, 'eval_loss': 0.66886544, 'head_layers': [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0], 'mlp_layers': [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'hidden_dims': 766, 'intermediate_dims': [210, 230, 351, 347, 521, 404, 255, 207, 173, 146, 147, 152], 'head_nums': [1, 2, 2, 2, 1, 1, 2, 1, 2, 1, 1, 1], 'pruned_params': 83951328, 'remaining_params': 1066272, 'pruned_model_sparsity': 0.9874582204155374, 'expected_sparsity': 0.98468, 'target_sparsity': 0.95, 'step': 7550}


Iteration:  17%|█▋        | 46/268 [00:11<04:11,  1.13s/it][A
Iteration:  18%|█▊        | 47/268 [00:11<03:08,  1.17it/s][A
Iteration:  18%|█▊        | 48/268 [00:11<02:22,  1.54it/s][A/home/conda/feedstock_root/build_artifacts/pytorch-recipe_1670037904586/work/aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [0,0,0], thread: [0,0,0] Assertion `index >= -sizes[i] && index < sizes[i] && "index out of bounds"` failed.
/home/conda/feedstock_root/build_artifacts/pytorch-recipe_1670037904586/work/aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [0,0,0], thread: [1,0,0] Assertion `index >= -sizes[i] && index < sizes[i] && "index out of bounds"` failed.
/home/conda/feedstock_root/build_artifacts/pytorch-recipe_1670037904586/work/aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [0,0,0], thread: [2,0,0] Assertion `index >= -sizes[i] && index < sizes[i] && "index out of bounds"` failed.
/home/conda/feedstock_root/build_artifacts/pytorch-recipe_1670037904586/work/aten/src/ATen/native/cuda/IndexKernel.cu:92: operator(): block: [0,0,0], thread: [3,0,0] Assertion `index >= -sizes[i] && index < sizes[i] && "index out of bounds"` failed.
Traceback (most recent call last):
  File "/scratch/network/hw8161/CoFiPruning/run_glue_prune_mod_2.py", line 401, in <module>
    main()
  File "/scratch/network/hw8161/CoFiPruning/run_glue_prune_mod_2.py", line 392, in main
    trainer.train()
  File "/scratch/network/hw8161/CoFiPruning/trainer/trainer_mod_2.py", line 286, in train
    loss_terms = self.training_step(model, inputs)
  File "/scratch/network/hw8161/CoFiPruning/trainer/trainer_mod_2.py", line 708, in training_step
    loss.backward()
  File "/home/hw8161/.conda/envs/torch-env3.8/lib/python3.8/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home/hw8161/.conda/envs/torch-env3.8/lib/python3.8/site-packages/torch/autograd/__init__.py", line 197, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Epoch:  28%|██▊       | 28/100 [32:37<1:23:52, 69.90s/it]
Iteration:  18%|█▊        | 48/268 [00:11<00:54,  4.01it/s]